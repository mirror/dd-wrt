2010-02-24 09:54  castaglia

	* NEWS, RELEASE_NOTES, contrib/dist/rpm/proftpd.spec,
	  include/version.h:
	  Preparing for release of 1.3.3-stable.

2010-02-24 09:25  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2010-02-24 09:24  castaglia

	* NEWS, RELEASE_NOTES, contrib/dist/rpm/proftpd.spec,
	  include/version.h:
	  Preparing for release of 1.3.2e.

2010-02-24 08:48  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Quell Perl interpreter warnings about redeclared variables.

2010-02-24 08:46  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Quell some Perl interpreter warnings about redeclared variables.

2010-02-24 08:20  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Quell Perl interpreter warning about "useless use of private
	  variable in void context".

2010-02-23 10:01  castaglia

	* NEWS, modules/mod_core.c, src/dirtree.c,
	  tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Bug#3397 - HideFiles none does not work properly on a per-user
	  basis.

2010-02-23 09:06  castaglia

	* modules/mod_ls.c:
	  Make sure that the pluralization of "paths" matches the count
	  displayed in the log message.

2010-02-22 09:01  castaglia

	* NEWS, contrib/mod_ban.c:
	  Bug#3389 - Cannot create mod_ban whitelists using <Class> and
	  <IfClass> sections.

2010-02-22 08:55  castaglia

	* src/bindings.c:
	  If "SocketBindTight on" is in effect, then the fix for Bug#3306
	  would cause problems for non-IPv6-enabled builds.  The fix for
	  Bug#3306 was not making a proper deep copy of the pr_netaddr_t
	  object for its linked list; the shallow copy (just a pointer)
	  would later point to memory whose contents had changed.  This
	  lead to a getnameinfo(3) failure (EAI_FAMILY, specifically), the
	  attempt to create a new listening socket, and a collision with an
	  existing socket.

	  The solution to this is simple: make a deep copy.

2010-02-21 14:34  castaglia

	* contrib/mod_sftp/rfc4716.c:
	  Support use of FIFOs as SFTPAuthorized{Host,User}Keys files.

2010-02-21 11:51  castaglia

	* src/inet.c:
	  Log if getsockname(2) returns an error.

2010-02-21 10:04  castaglia

	* src/dirtree.c:
	  Handle an edge case/regression from the fix for Bug#3337.

2010-02-21 10:04  castaglia

	* src/dirtree.c:
	  Handle an edge case/regression from Bug#3337.

2010-02-19 10:23  castaglia

	* contrib/mod_tls.c:
	  Slightly better logging of SSL session reuse for data
	  connections.

2010-02-19 09:57  castaglia

	* contrib/mod_sftp/mod_sftp.c:
	  Fix another compiler warning (this one specific to the
	  pedantically stupid idiosyncrasis of gcc-4.4) in mod_sftp, per
	  Bug#3394.

2010-02-19 09:47  castaglia

	* contrib/mod_sftp/fxp.c:
	  Fix some of the compiler warnings mentioned in Bug#3394.

2010-02-17 10:06  castaglia

	* contrib/mod_sftp/mod_sftp.c:
	  Rather than log (and ignore) any badly formatted version exchange
	  strings from clients, log the client-sent string and then
	  disconnect the client.  This is what OpenSSH does, and it's a
	  more draconian and more efficient way of dealing with such
	  ill-behaved clients.

2010-02-17 08:07  castaglia

	* doc/howto/Limit.html:
	  Add blocking of STAT to "blind directory" example, per Bug#3391.

2010-02-15 15:28  castaglia

	* doc/howto/SQL.html:
	  Add SQL FAQ about encrypting the connections between mod_sql and
	  the backend database server.

2010-02-15 14:03  castaglia

	* contrib/mod_sftp/mod_sftp.c, contrib/mod_sftp/packet.c,
	  contrib/mod_sftp/packet.h,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Make sure that mod_sftp can handle clients which don't send
	  properly formatted protocol version strings, as well as clients
	  which do not send the proper protocol version string within a
	  configured TimeoutLogin period.

2010-02-15 11:32  castaglia

	* configure:
	  Updated configure.

2010-02-15 11:22  castaglia

	* configure.in:
	  The various library directories need to be included in the
	  `proftpd -V' output as well.

2010-02-15 09:45  castaglia

	* NEWS, modules/mod_core.c:
	  Backport the fix for Bug#3342.

2010-02-15 08:36  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Add regression test for using %S in SQLNamedQuery statements in
	  combination with a SQLLog ERR_* configuration.

2010-02-13 16:36  castaglia

	* src/table.c, tests/api/table.c:
	  When using a pr_table_t allocated with the USE_CACHE flag (none
	  are, currently), the pr_table_get()/pr_table_kget() functions
	  would incorrectly return the previously looked up entry, every
	  time, instead of iterating properly to the next entry in the
	  linked list.

2010-02-13 16:19  castaglia

	* src/modules.c:
	  Comment corrections.

2010-02-12 17:45  castaglia

	* include/version.h:
	  Updated version for CVS.

2010-02-12 17:09  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2010-02-12 17:08  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Updates for the 1.3.3rc4 release.

2010-02-12 16:53  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2010-02-12 16:52  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Updates for 1.3.2d release.

2010-02-12 16:37  castaglia

	* RELEASE_NOTES:
	  Preparing release notes for another RC.

2010-02-12 16:13  castaglia

	* RELEASE_NOTES:
	  Start updating the 1.3.2 release notes for a maintenance release.

2010-02-11 14:44  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Limit/Anonymous.pm:
	  Add unit test for an <Anonymous> login which uses a <Limit LOGIN>
	  rule based on a DSN name (hint: "UseReverseDNS on" is required
	  for the rule to work as expected).

2010-02-11 14:36  castaglia

	* src/dirtree.c:
	  Minor code style cleanup, no functional change.

2010-02-11 14:35  castaglia

	* src/netacl.c:
	  More trace logging of comparison of netacls.

2010-02-10 22:30  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add regression tests for uploading and downloading zero-length
	  files via SFTP and SCP.

2010-02-10 15:29  castaglia

	* contrib/mod_sftp/keys.c:
	  Fix an issue in mod_sftp where, similar to in mod_tls, a file
	  descriptor on a key file can be opened during SIGHUP where the fd
	  is 0, 1, or 2.  This causes problems because the prompt-related
	  fd fiddling changes these fds to deal with input from the admin.
	  The fix, as in mod_tls, is to use pr_fsio_get_usable_fd() to get
	  an fd value that isn't one of the big three for that key file.

2010-02-10 13:45  castaglia

	* modules/mod_xfer.c:
	  If "UseSendfile off" appears in the config but some other
	  condition prevents the use of sendfile(), it's a little odd to
	  see some other "declining use of sendfile" message in the logs.

2010-02-10 12:54  castaglia

	* include/trace.h, modules/mod_core.c, src/trace.c:
	  Make the default trace channel name of "DEFAULT" a macro, to keep
	  it in sync in the various files which use that string.

2010-02-10 12:50  castaglia

	* modules/mod_core.c:
	  The mod_core module had not been updated to use the "DEFAULT"
	  trace keyword rather than the "ALL" keyword.	This keyword should
	  be made into a public macro.

2010-02-10 11:39  castaglia

	* doc/howto/Compiling.html:
	  Slightly better/fuller example.

2010-02-10 11:24  castaglia

	* configure:
	  Updated configure.

2010-02-10 11:21  castaglia

	* configure.in:
	  Expand the list of modules which cannot be built as shared
	  modules; allow some of the core modules to be built as shared
	  modules (e.g. mod_delay, mod_auth_file, mod_ident, mod_auth_pam,
	  etc).

2010-02-10 11:20  castaglia

	* modules/mod_delay.c:
	  Quell compiler warning about unreachable code.  Prepare mod_delay
	  for acting properly when compiled as a DSO module.

2010-02-10 11:19  castaglia

	* modules/mod_facl.c:
	  Remove duplicate registration of module unload listener in
	  mod_facl.

2010-02-10 11:12  castaglia

	* doc/howto/Compiling.html:
	  Add FAQ about the "source file './modules/d_auth_pam.c' cannot be
	  found" configure error that is sometimes reported.

2010-02-10 10:34  castaglia

	* contrib/mod_sftp/: interop.c, interop.h, keystore.c, keystore.h,
	  mod_sftp.c, rfc4716.c, rfc4716.h:
	  Make sure that mod_sftp unregisters callbacks on module unload
	  properly, as well as freeing up any allocated regular expressions
	  on module unload.

2010-02-10 10:31  castaglia

	* contrib/: mod_wrap2_file.c, mod_wrap2_sql.c,
	  mod_wrap2/mod_wrap2.c, mod_wrap2/mod_wrap2.h.in:
	  Provide a wrap2_unregister() API, so that wrap2 submodules can
	  unregister their backends on e.g. module unload.  Update the
	  wrap2 submodules to use this new API.

2010-02-10 10:27  castaglia

	* contrib/mod_tls.c:
	  Quell some compiler warnings about unreachable code.

2010-02-10 10:26  castaglia

	* contrib/mod_sql.c:
	  Unregister the registered authtype handlers upon module unload.

2010-02-10 10:24  castaglia

	* contrib/mod_quotatab.c:
	  Set the prev pointer properly when registering a quotatab
	  backend.

2010-02-10 09:29  castaglia

	* contrib/mod_rewrite.c:
	  When mod_rewrite is a DSO module and is being unloaded (as during
	  a restart), free any allocated regexes and prevent a memory leak.

2010-02-09 18:16  castaglia

	* src/bindings.c:
	  When getting a listening connection, handle cases where an IP
	  address string can't be returned for some reason.

2010-02-09 17:05  castaglia

	* contrib/mod_dynmasq.c:
	  Forgot to update the copyright date on this file, since it's been
	  modified this year.

2010-02-09 17:03  castaglia

	* NEWS, contrib/mod_ban.c, contrib/mod_dynmasq.c:
	  Backport of Bug#3387 to the 1.3.2 branch for mod_ban and
	  mod_dynmasq.

2010-02-09 17:01  castaglia

	* NEWS, contrib/mod_ban.c, contrib/mod_dynmasq.c,
	  contrib/mod_shaper.c:
	  Bug#3387 - SIGHUP will eventually cause certain modules (as DSO
	  modules) to segfault.

	  Register timers in the daemon process via a 'core.postparse'
	  listener rather than a 'core.startup' listenver, and remove the
	  registered timers in a 'core.restart' listener.  Otherwise, the
	  previous registered timer can point to invalid memory if the
	  registering module is a DSO module; SIGHUPs cause DSO modules to
	  be unloaded/reloaded.

2010-02-09 12:08  castaglia

	* src/timers.c:
	  Paranoid checking for NULL parameters for a trace message in the
	  Timers API.

2010-02-09 07:53  castaglia

	* include/bindings.h, src/bindings.c:
	  Pass the port number to use as an argument to pr_ipbind_create(),
	  rather than assuming that the port in the given server_rec should
	  be used.  There are cases where this may not be true (e.g. in
	  mod_autohost's uses).

2010-02-08 15:12  castaglia

	* contrib/mod_sftp/fxp.c:
	  Handle another case where we weren't checking for a NULL result
	  from calling dir_canonical_vpath() when handling REALPATH
	  requests.

2010-02-08 15:01  castaglia

	* contrib/mod_sftp/fxp.c:
	  If there are troubles in resolving the paths given in a SYMLINK
	  request (e.g. because of ENAMETOOLONG), handle the error
	  gracefully rather than segfaulting.

2010-02-08 13:54  castaglia

	* src/fsio.c:
	  More defensive programming: check for cases where
	  lookup_fs_file() returns NULL, and Do The Right Thing(tm).

2010-02-08 13:27  castaglia

	* src/fsio.c:
	  Check for cases where we fail to lookup the FSIO object for a
	  path because of an error like ENAMETOOLONG.  Without this,
	  segfaults because of null pointer dereferences would occur.

2010-02-08 13:14  castaglia

	* contrib/mod_sftp/fxp.c:
	  Handle the case where dir_canonical_path() returns NULL (e.g. for
	  ENAMETOOLONG) in the REMOVE handler in order to prevent null
	  pointer dereference segfault.

2010-02-08 12:00  castaglia

	* contrib/mod_sftp/fxp.c:
	  Handle cases where dir_canonical_vpath() might return NULL (such
	  as when the input name is too long); without this, a segfault due
	  to null pointer dereference ensues.

2010-02-08 11:45  castaglia

	* src/trace.c:
	  Prevent long trace log lines from trampling each other by
	  truncating and adding a terminating newline properly.

2010-02-08 09:28  castaglia

	* contrib/mod_sftp/packet.c:
	  Make sure we don't try to read in more data than can fit in our
	  packet buffer.

2010-02-07 10:50  castaglia

	* configure:
	  Updated configure.

2010-02-07 10:45  castaglia

	* configure.in:
	  Make sure that compiler optimizations are disabled when
	  --enable-devel is used.

2010-02-07 10:36  castaglia

	* include/support.h, src/support.c:
	  Add a pr_strtime2() function, which allows callers the choice of
	  whether the returned timestamp string is in GMT or in local time;
	  the existing pr_strtime() function is hardcoded to always use
	  local time.

2010-02-05 17:38  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Make sure that config_write() can handle Anonymous sections which
	  contain nested Directory or Limit sections.

2010-02-04 16:32  castaglia

	* src/event.c:
	  Include the memory address of the event callback being invoked in
	  the trace message about event handling.

2010-02-04 11:26  castaglia

	* doc/contrib/mod_sftp_sql.html:
	  Update the schema examples for storing SSH keys; include indices
	  in the example schema.

2010-02-04 09:24  castaglia

	* src/pool.c:
	  Make the name of the oom pool walking function be 'oom_printf',
	  just to be very clear.

2010-02-04 09:14  castaglia

	* include/pool.h, src/main.c, src/pool.c:
	  Checking in some handy code I used yesterday to track down a
	  memory leak in mod_sftp.

	  If proftpd is compiled using --enable-devel, AND if it is started
	  using the -n/--nodaemon command-line option, then if an
	  out-of-memory condition is encountered, proftpd will try to dump
	  the memory pool statistics to stderr.  This is what showed me
	  where all of the memory was being used in the mod_sftp case.

2010-02-03 20:08  castaglia

	* contrib/mod_sftp/channel.c:
	  Undo the previous change regarding the calling of
	  destroy_channel() and the setting of the recvd_close flag.  Turns
	  out that the previous arrangement was the way it was for a good
	  reason.

	  Left myself a comment to this effect, so that I'm not tempted to
	  make the same mistake again in the future.

2010-02-03 20:02  castaglia

	* contrib/mod_sftp/scp.c:
	  Only handle aborted SCP transfers if there is actually a non-zero
	  count of open file handles when the session is closed.

2010-02-03 20:00  castaglia

	* contrib/mod_sftp/channel.c:
	  No need to call destroy_channel() twice.  Also be sure to set the
	  recvd_close flag *before* calling send_channel_done(), so that
	  the channel will be properly closed when destroy_channel() is
	  called on it.

2010-02-03 19:42  castaglia

	* contrib/mod_sftp/channel.c:
	  Guard against sending CHANNEL_EOF and/or CHANNEL_CLOSE twice.
	  Some clients rightfully treat this as a protocol error.  I
	  noticed this when testing scp downloads using OpenSSH, and saw
	  "protocol error: close rcvd twice".

2010-02-03 19:23  castaglia

	* NEWS, contrib/mod_sftp/scp.c:
	  Bug#3386 - Downloading via SCP can stall due to rekeying.

2010-02-03 19:12  castaglia

	* contrib/mod_sftp/scp.c:
	  Typo.

2010-02-03 18:46  castaglia

	* contrib/mod_sftp/scp.c:
	  Add some minor logging of the progress being made on the sending
	  of data for a file via SCP.

	  Fix some cases where even though a file may have been downloaded
	  successfully, the SCP may still have been handled as a failure by
	  mod_sftp because of bad logic.

2010-02-03 18:15  castaglia

	* NEWS, contrib/mod_sftp/channel.c:
	  Bug#3385 - Memory leak during SCP download.

2010-02-03 17:03  castaglia

	* contrib/mod_sftp/scp.c:
	  When we've sent the last chunk of data when downloading via SCP,
	  don't require the client to send one more SSH message.  Not sure
	  why that was there.  Also, when writing SCP download data, spin
	  on a zero window size *after* the channel data has been written,
	  not before.

	  With these two changes, downloading via SCP a largish (700 MB)
	  file finally worked, without hanging the scp(1) OpenSSH client.

2010-02-03 15:42  castaglia

	* contrib/mod_sftp/tap.c:
	  Make "SFTPTrafficPolicy none" work; it was hanging if that
	  setting had been explicitly configured in the proftpd.conf.

	  Also make "SFTPTrafficPolicy none" override the automatic use of
	  the 'rogaway' policy.  This makes it possible to test transfers
	  of data without having the IGNORE messages bloat the data
	  transferred.

2010-02-03 13:45  castaglia

	* src/child.c:
	  If sending a signal to the child/session process fails, log the
	  reason via trace logging.

2010-02-03 13:31  castaglia

	* contrib/mod_sftp/channel.c:
	  When freeing an unclosed channel, log the number of pending bytes
	  that that channel might have.

2010-02-03 11:11  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/PathDenyFilter.pm:
	  We don't want a bare '.' character in these regexes, just the '.'
	  regex pattern meaning "match any character".

2010-02-03 09:15  castaglia

	* contrib/mod_sftp/fxp.c:
	  Quell compiler warnings about unused return values.

2010-02-02 16:56  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/PathDenyFilter.pm:
	  Add unit tests where PathDenyFilter is used to prevent names with
	  a single leading (or trailing) space character (or both).

2010-02-02 16:29  castaglia

	* contrib/mod_sftp/keys.c:
	  Quell compiler warnings about unreachable code; no functional
	  change.

2010-02-02 15:06  jwm

	* contrib/mod_ldap.c: revno: 93 message:   add ssh public key
	  support (for mod_sftp_ldap) from TJ Saunders	 <tj@castaglia.org>

2010-02-02 15:02  jwm

	* contrib/mod_ldap.c: v2.8.22

	  * Disable the LDAPUseSSL directive, instead logging a warning so
	  existing   configurations do not cause ProFTPD startup failure.
	  Previous versions   enabled TLS when this directive was enabled.
	  This behavior was incorrect,	 since the intended behavior was to
	  enable LDAPS/LDAP over SSL. To use   LDAPS, specify the ldaps://
	  protocol in the LDAPServerURL URL(s).

	    If you wish to continue using TLS, you must modify your
	  configuration to
	    specify the ldap:// scheme in the LDAPServerURL URL and add the
	  directive
	    'LDAPUseTLS on' to your configuration.
	  * Add support for quota profiles. If a user entry doesn't have an
	  ftpQuota   attribute, search for the DN contained in the user's
	  ftpQuotaProfileDN   attribute (if present) and use the ftpQuota
	  attribute present on that DN.    (Bug #2617)	* Fix segfaults in
	  debug logging on platforms whose printf() does not   gracefully
	  handle NULL string pointers. (Bug #3346) * Escape LDAP filter
	  metacharacters in inserted values when interpolating	 filter
	  templates.  * Emit a debug warning when an LDAP URL is specified
	  without an explicit	search scope.  * Bug 2922 locks
	  authentication for an account to the same module that   fetched
	  the original account information. Remove the kludge wherein	"*"
	  is passed to pr_auth_check() if we're doing auth binds to prevent
	    other modules from processing authentication. This has the
	  convenient   side effect of making the UserPassword directive
	  work with LDAP-sourced   accounts. Bump the required ProFTPD
	  version to 1.3.1rc3.	* Emit correct LDAP timeout in debug
	  message, accounting for the default if   none was specified.
	  Reported by Nikos Voutsinas <nvoutsin@noc.uoa.gr>.

	  ------------------------------------------------------------
	  revno: 92 message:   nuke unused variable
	  ------------------------------------------------------------
	  revno: 91 message:   release 2.8.22
	  ------------------------------------------------------------
	  revno: 90 message:   * Add support for quota profiles. If a user
	  entry doesn't have an ftpQuota     attribute, search for the DN
	  contained in the user's ftpQuotaProfileDN	attribute (if
	  present) and use the ftpQuota attribute present on that DN.
	  (Bug #2617)
	  ------------------------------------------------------------
	  revno: 89 message:   * Fix segfaults in debug logging on
	  platforms whose printf() does not	gracefully handle NULL
	  string pointers. (Bug #3346)
	  ------------------------------------------------------------
	  revno: 88 message:   cast ldap_querytimeout_tp.tv_sec to quell a
	  compiler warning
	  ------------------------------------------------------------
	  revno: 87 message:   * Emit correct LDAP timeout in debug
	  message, accounting for the default if     none was specified.
	  Reported by Nikos Voutsinas <nvoutsin@noc.uoa.gr>.
	  ------------------------------------------------------------
	  revno: 86 message:   thanks to Bug 2922 (Auth API allows one auth
	  module to authenticate user	data provided by a different auth
	  module), we don't need to worry about   passing a locked crypted
	  password ("*") to pr_auth_check(), since our authz   handler will
	  only be called if we supplied the original user information.

	    as a result, if the UserPassword directive is in effect, we
	  need to avoid
	    doing auth binds and fall through to verifying the crypted
	  password
	    ourselves instead of declining the authz request and letting
	  mod_auth_unix
	    handle it.

	    bump the required proftpd version to 1.3.1rc3, since #2922 was
	  resolved in
	    that version. this seems reasonable, since nobody ought to be
	  running
	    1.2.10rc2 any more and 1.3.1rc3 has been available for almost
	  2.5y now.
	  ------------------------------------------------------------
	  revno: 85 message:   add intermediary #ifdefs instead of
	  littering the code with ldap api version-   and openldap-specific
	  preprocessor directives
	  ------------------------------------------------------------
	  revno: 84 message:   use a common pr_ldap_search() to avoid
	  duplicate code in *_lookup()
	  ------------------------------------------------------------
	  revno: 82 message:   - cached_quota should be declared static   -
	  return PR_HANDLED() in stub LDAPUseSSL config directive handler
	  ------------------------------------------------------------
	  revno: 81 message:   emit a debug warning if the search scope is
	  'base'. ldap urls default to this   scope, and specifying:

	      LDAPServer ldap://127.0.0.1/

	    has bitten me several times when I forget that the search scope
	  is 'base',
	    not 'sub'.
	  ------------------------------------------------------------
	  revno: 80 message:   re-add a stub for LDAPUseSSL that only logs
	  a notice that it's been removed, so	older configurations don't
	  fail to start.

	    [followon to r75]
	  ------------------------------------------------------------
	  revno: 79 message:   quell a discarded-const compiler warning
	  ------------------------------------------------------------
	  revno: 76 message:   only allow ldaps:// url schemes if we have
	  ldap_initialize()
	  ------------------------------------------------------------
	  revno: 75 message:   remove the LDAPUseSSL directive, as it
	  wasn't having the intended effect   (enable LDAP over SSL, aka
	  LDAPS). LDAP_OPT_X_TLS_HARD is for having the   connection fail
	  hard on TLS errors. afaict, the only way to specify LDAPS
	  connections is by passing a URL with the ldaps:// scheme to
	  ldap_initialize().
	  ------------------------------------------------------------
	  revno: 74 message:   better debug message when no entries are
	  found for a search
	  ------------------------------------------------------------
	  revno: 73 message:   dunno what i was thinking with the last
	  round of filter interpolation   changes, but it was completely
	  wrong. use proftpd's sreplace() instead of   doing the string
	  manipulation ourselves, and check
	  pr_ldap_interpolate_filter()'s return value for NULL.
	  ------------------------------------------------------------
	  revno: 72   escape filter characters mentioned in RFC 2254

2010-02-01 14:14  castaglia

	* doc/contrib/mod_sql.html:
	  In the SQLShowInfo description, mention which section in RFC959
	  defines the list of acceptable response codes for each FTP
	  command.

2010-02-01 14:09  castaglia

	* RELEASE_NOTES:
	  Update the release notes; it's almost time for release.

2010-02-01 11:30  castaglia

	* doc/contrib/mod_sql_passwd.html:
	  Updating mod_sql_passwd docs with description of new
	  SQLPasswordUserSalt directive.

2010-02-01 11:20  castaglia

	* NEWS, contrib/mod_sql_passwd.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_passwd.pm:
	  Bug#3380 - Support user-specific salts in encoded passwords.

2010-02-01 10:40  castaglia

	* NEWS, contrib/mod_radius.c:
	  Bug#3381 - RADIUS authentication broken on 64-bit platforms.

2010-01-31 13:12  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add unit test for downloading an empty file over FTPS, to go with
	  the just-added test for uploading an empty file over FTPS.

2010-01-31 13:06  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add unit test for uploading an empty file via FTPS.  Saw a bug
	  report for an FTPS client for such an issue; the reporter wasn't
	  sure whether it was a client or a server issue.  This test shows
	  that it isn't an issue with mod_tls.

2010-01-31 12:34  castaglia

	* contrib/: mod_sftp/crypto.c, mod_tls.c:
	  Be paranoid and meticulous, and clean up the state of the OpenSSL
	  RNG when we're the daemon process and we're shutting down.

2010-01-29 11:00  castaglia

	* NEWS, modules/mod_log.c,
	  tests/t/lib/ProFTPD/Tests/Logging/ExtendedLog.pm:
	  Bug#3383 - ExtendedLog variables for protocol and version not
	  handled properly.

2010-01-29 10:56  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Add a function for getting the version of the current proftpd
	  (using `proftpd -V').

2010-01-26 15:59  castaglia

	* src/support.c:
	  Add a counter for signal blocking/unblocking, to handle nested
	  calls.  Also added trace logging for signal blocking/unblocking.

2010-01-26 11:50  castaglia

	* src/timers.c:
	  Use proper pluralization in the timer trace messages.

2010-01-26 08:51  castaglia

	* contrib/mod_sql.c:
	  Remove a lot of code duplication in mod_sql's handling of SQLLog
	  directives by refactoring all of that code into a single new
	  process_sqllog() function.

2010-01-26 08:41  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Add unit test for a "SQLLog EXIT" configuration.

2010-01-23 13:43  castaglia

	* configure:
	  Update configure.

2010-01-23 13:39  castaglia

	* configure.in, src/main.c:
	  Define a PR_DEVEL_PROFILE macro if the --enable-devel=profile
	  configure option is used.  This macro is needed to tell proftpd
	  whether it should use _exit(2) or exit(2) when exiting a session
	  process.  The gmon.out profile data file is only written when
	  exit(2) is used; proftpd by default wants to use _exit(2).

2010-01-23 11:29  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  Make sure that mod_wrap2 honors suffix patterns, as per
	  hosts_access(5), in the table entries as well.

2010-01-23 10:42  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_wrap2_file.pm:
	  Adding more regression tests for mod_wrap2/mod_wrap2_file.

2010-01-23 10:42  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  Fix bug where mod_wrap2 would attempt to resolve a table entry
	  like "127.0." as a DNS name.	According to the hosts_access(5)
	  man page, an entry which ends in a '.' should be treated as an IP
	  address prefix, and matched as such.

2010-01-23 10:31  castaglia

	* src/netaddr.c:
	  When resolving names to addresses via getaddrinfo(3), give
	  getaddrinfo() the hint that we're only interested in TCP, not
	  UDP.

2010-01-22 14:16  castaglia

	* src/netaddr.c:
	  Make sure that the errno value is preserved in failure cases in
	  pr_netaddr_get_addr().

2010-01-21 09:37  castaglia

	* doc/howto/Upgrade.html:
	  Update the Upgrade howto to use -d10 rather than -d9; more
	  information is better when testing a version for upgrading.

2010-01-20 10:11  castaglia

	* contrib/mod_ban.c:
	  Removed some unnecessary logging.

2010-01-19 10:59  castaglia

	* NEWS, contrib/mod_wrap2/mod_wrap2.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_wrap2_sql.pm:
	  Bug#3377 - mod_wrap2 attempts to resolve 'ALL' keyword as an IP
	  address.

2010-01-19 08:52  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3375 - Minor SIGHUP-based memory leak in mod_tls.

2010-01-19 08:43  castaglia

	* doc/contrib/mod_sftp_sql.html:
	  The mod_sftp_sql module should now be much easier to use; getting
	  your SSH keys into the SQL tables no longer requires the Perl
	  script for extracting just the base64 key data (although the
	  module still supports that, too).

2010-01-19 08:37  castaglia

	* NEWS, contrib/mod_sftp_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp_sql.pm:
	  Bug#3376 - Handle the full RFC4716 formatted keys in SQL values.

2010-01-18 16:03  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_sftp_sql.pm,
	  t/modules/mod_sftp_sql.t:
	  Add unit tests for mod_sftp_sql.

2010-01-16 18:49  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_wrap2_sql.pm:
	  Fix the mod_wrap2_sql unit tests so that the SQLNamedQuery
	  directives are resolved as expected.	Also increase the default
	  TimeoutIdle, to handle running the testsuite on a machine which
	  may take a little longer to resolve DNS names.

2010-01-16 17:38  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/: mod_wrap2_file.pm,
	  mod_wrap2_sql.pm:
	  Adding unit tests for the mod_wrap2 modules which show that both
	  the file- and sql-based modules can handle multiple rows, each
	  with multiple entries, and with entries that are separated by
	  commas, commas and whitespace, or just whitespace.

2010-01-15 14:08  castaglia

	* NEWS, contrib/mod_radius.c:
	  Backported fix for Bug#3372 to the 1.3.2 branch.

2010-01-15 14:05  castaglia

	* contrib/mod_radius.c:
	  Update the copyright dates in mod_radius.c, since the code has
	  changed.

2010-01-15 14:05  castaglia

	* NEWS, contrib/mod_radius.c:
	  Bug#3372 - ProFTPD crashes when retrying a failed login with
	  mod_radius being used.

2010-01-11 07:57  castaglia

	* doc/contrib/mod_sftp_sql.html:
	  Use HTML entity encoding for angle brackets; more browsers like
	  this.

2010-01-10 17:16  castaglia

	* src/scoreboard.c:
	  Minor optimization to the fix for Bug#3370: when scrubbing the
	  ScoreboardFile, call getpgrp() to get the current process group
	  only once, rather than potentially once per entry.  The current
	  process group does not change during the lifetime of the scrub.

2010-01-10 13:50  castaglia

	* src/scoreboard.c:
	  Whitespace/coding style change, no functional change.  Update the
	  copyright date.

2010-01-10 13:49  castaglia

	* src/scoreboard.c:
	  Whitespace/style change, no functional change.

2010-01-10 13:10  castaglia

	* configure:
	  Updated configure.

2010-01-10 13:05  castaglia

	* NEWS, config.h.in, configure.in, contrib/mod_ban.c,
	  contrib/mod_ctrls_admin.c, include/scoreboard.h,
	  src/scoreboard.c:
	  Backported fix for Bug#3370 to 1.3.2 branch.

2010-01-10 12:08  castaglia

	* src/scoreboard.c:
	  Use a variable name of 'curr_pgrp', as it is more accurate; we
	  are checking that the process group of the scoreboard entry
	  matches our own process group, not the process group of the
	  daemon.  While these should all be the same process group, the
	  value returned by getpgrp(2) is not the parent process group, but
	  the current process group.  All part of Bug#3370.

2010-01-10 12:06  castaglia

	* configure:
	  Updated configure.

2010-01-10 12:01  castaglia

	* NEWS, config.h.in, configure.in, contrib/mod_ban.c,
	  contrib/mod_ctrls_admin.c, include/scoreboard.h,
	  src/scoreboard.c:
	  Bug#3370 - Lack of PID protection in ScoreboardFile.

2010-01-08 10:53  castaglia

	* contrib/mod_ban.c:
	  Changed my mind; having the SID reported in the BanLog isn't
	  helpful without knowing which SID maps to which vhost -- and
	  that's more information than can easily fit in a small BanLog log
	  message.

2010-01-08 10:20  castaglia

	* modules/mod_delay.c:
	  Fix a small bug in mod_delay where the POST_CMD_ERR handler for
	  the PASS command was closing the DelayTable.	This meant that any
	  future USER/PASS commands sent by the client (say, if the
	  password was entered wrong) would not be tracked in the
	  DelayTable.  The same handler is used for both the POST_CMD and
	  POST_CMD_ERR phases of the PASS command; the handler simply
	  needed to close the DelayTable only for the POST_CMD phase.

2010-01-08 10:03  castaglia

	* contrib/mod_ban.c:
	  Report the server ID for a ban entry in the BanLog; it helps
	  differentiate what would otherwise look like duplicates.

2010-01-07 14:45  castaglia

	* src/dirtree.c:
	  Backport the fix for the "find_config() can return wrong
	  config_rec" bug from trunk.

2010-01-07 11:59  castaglia

	* contrib/mod_tls.c:
	  When reading in key files, make sure that the fd used is not one
	  of the big three (stdin, stdout, stderr).  Under some conditions,
	  the fopen(3) call that was used would return an fd of 2, which
	  would then be overwritten by the fd games played by
	  set_prompt_fds().  OpenSSL, though, used the FILE * returned by
	  fopen(), which still had the old fd -- and the loading of the key
	  would fail "mysteriously", giving an error like "unable to read
	  passphrase: (unknown)".

2010-01-07 11:22  castaglia

	* src/dirtree.c:
	  Fix a rather subtle and nasty bug in proftpd's config directive
	  lookup code.	The short version of the bug is that find_config()
	  could possibly return the wrong config_rec.  The cause is related
	  to Bug#2535, and the assigning and lookup of the config IDs.
	  When looking up an ID, the string used was not dup'd from the
	  input, which means that the lookup key could change unexpectedly.

	  The rest of this change simply alters the coding style to make
	  future debugging in that section of code easier.

2010-01-06 15:30  castaglia

	* doc/contrib/mod_ctrls_admin.html:
	  Add example of using new 'ftpdctl restart count' functionality.

2010-01-06 15:24  castaglia

	* contrib/mod_ctrls_admin.c:
	  Use 'ftpdctl restart count' now to ask the server, via ftpdctl,
	  how many times it has been restarted (via SIGHUP) since the
	  server was started.

2010-01-06 15:05  castaglia

	* contrib/mod_sql.c:
	  Clean up the coding style around handling SQLLog and SQLShowInfo
	  directives; hopefully no functional changes.	Also explicitly
	  initialized some pointers which are used for pointer arithmetic,
	  just to be safe.

2010-01-05 16:41  castaglia

	* doc/contrib/mod_sftp.html:
	  Add SFTP FAQ about <Limit SITE_CHMOD> and SFTP uploads.

2010-01-05 15:17  castaglia

	* NEWS, modules/mod_auth.c,
	  tests/t/lib/ProFTPD/Tests/Config/MaxLoginAttempts.pm:
	  Bug#3362 - Regression in handling of MaxLoginAttempts in
	  1.3.3rc1.

2010-01-04 10:16  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  Fix broken checks added yesterday.  Also quell compiler warnings
	  about unreachable code.

2010-01-04 09:58  castaglia

	* doc/howto/Authentication.html:
	  Updated Authentication howto, removing mention of deprecated
	  AuthPAMAuthoritative directive and updating URLs to point to the
	  www.proftpd.org docs.

2010-01-03 13:08  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  Cleanup of some of the coding style in mod_wrap2 to be more
	  legible.

2010-01-03 13:05  castaglia

	* contrib/mod_wrap2_file.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_wrap2_file.pm:
	  Fix bug in mod_wrap2_file where the module was not correctly
	  parsing the "options" portion of a table.  This was leading to
	  allowing of connections which should have been denied.

2009-12-28 12:32  castaglia

	* doc/contrib/mod_tls.html:
	  Add cert chain caveat that using the NoCertRequest means that
	  mod_tls won't bother to use the cert chain file.

2009-12-28 12:12  castaglia

	* doc/howto/TLS.html:
	  Fix typos.

2009-12-23 15:46  castaglia

	* doc/contrib/mod_wrap.html:
	  The libnsl library isn't needed for mod_wrap on Mac OSX, either.

2009-12-19 17:19  castaglia

	* src/fsio.c:
	  Rather than testing for CYGWIN to use the O_BINARY flag, just
	  test for the O_BINARY flag directly.

2009-12-18 09:40  castaglia

	* contrib/mod_tls_shmcache.c:
	  Fix compiler warning.

	  Rename the 'core.exit' event listener to be more accurate (it's a
	  shutdown listener in some cases, not a session-exit listener).

2009-12-18 09:36  castaglia

	* NEWS, contrib/mod_tls_shmcache.c:
	  Bug#3359 - mod_tls_shmcache segfaults during syntax check.

2009-12-15 15:24  castaglia

	* Makefile.in, NEWS:
	  Bug#3356 - Build timestamp using date(1) can fail depending on
	  environment.

2009-12-15 14:31  castaglia

	* NEWS, contrib/mod_sftp/fxp.c:
	  Bug#3357 - mod_sftp fails to compile on AIX.

2009-12-15 10:56  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3358 - mod_tls doesn't compile with pre-0.9.7 openssl.

2009-12-14 22:22  castaglia

	* modules/mod_xfer.c:
	  Typo.

2009-12-14 17:13  castaglia

	* contrib/mod_shaper.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_shaper.pm:
	  Fix a problem in mod_shaper, noted in this forums post:

	    http://forums.proftpd.org/smf/index.php/topic,1628.0.html

	  where the queue used by mod_shaper could become "clogged", full
	  of old stale messages.  The fix, as noted as well, is to clear
	  the queue of any messages for the destination process before
	  sending a new message to that process.

	  Added a regression test to reproduce the behavior; it required a
	  manual change to the mod_shaper code in order to fill up the
	  queue in the time of the test.  Good enough for now.

2009-12-14 16:37  castaglia

	* contrib/mod_shaper.c:
	  Fix compiler warnings about unreachable code, and rename an event
	  listener to be more appropriately named.

2009-12-14 13:29  castaglia

	* doc/contrib/mod_wrap.html:
	  Adding more examples of paranoid libwrap log messages.

2009-12-14 12:48  castaglia

	* doc/howto/TLS.html:
	  Another SSL/TLS FAQ.

2009-12-14 10:53  castaglia

	* contrib/mod_tls.c:
	  Log a warning if mod_tls has been configured with no server certs
	  (via TLSRSACertificateFile, TLSDSACertificateFile, or
	  TLSPKCS12File) for a given session.  Without a server cert,
	  mod_tls cannot support SSL/TLS sessions.

2009-12-14 10:39  castaglia

	* contrib/mod_tls.c:
	  Clear up compiler warnings about unreachable code in mod_tls.  No
	  functional change.

2009-12-14 09:37  castaglia

	* doc/howto/Stopping.html:
	  Fixing up the Stopping howto, and adding an example Mac OSX
	  launchd plist config.

2009-12-13 12:17  castaglia

	* utils/ftptop.c:
	  Quell compiler warnings about unreachable code.

2009-12-13 11:31  castaglia

	* contrib/mod_tls.c:
	  Drat.  Forgot one of the SSL/TLS renegotiation backport changes
	  from trunk.  Without this, data transfers might be improperly
	  detected as renegotiations and denied.

2009-12-11 16:47  castaglia

	* contrib/mod_sftp/auth.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Subtle tweaks to mod_sftp's handling and enforcement of the
	  MaxLoginAttempts directive; it should now work more as users
	  would expect.

	  Added a unit test to catch regressions on this, as well as a unit
	  test showing the mod_sftp's handling of MaxLoginAttempts, in
	  combination with a mod_ban rule for MaxLoginAttempts, works
	  properly.

2009-12-11 15:09  castaglia

	* src/table.c:
	  Clean up some "code will never be executed" warnings.

2009-12-11 15:03  castaglia

	* NEWS, contrib/mod_ban.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_ban.pm:
	  Bug#3355 - mod_ban should support BanEngine in <VirtualHost>
	  config sections.

2009-12-10 20:44  castaglia

	* doc/howto/: Versioning.html, index.html:
	  Finally got around to writing up the version naming conventions
	  that are currently used for ProFTPD releases.

2009-12-10 19:16  castaglia

	* contrib/mod_tls.c:
	  Be a little more verbose in the error messages logged for
	  SSL_accept() failures.

2009-12-10 17:06  castaglia

	* doc/modules/mod_lang.html:
	  Typo.

2009-12-10 15:06  castaglia

	* include/version.h:
	  Update the CVS version.

2009-12-10 14:49  castaglia

	* doc/contrib/mod_sql.html:
	  Typo.

2009-12-10 12:04  castaglia

	* ChangeLog:
	  Update the ChangeLog.

2009-12-10 12:03  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing to release 1.3.3rc3 today.

2009-12-10 10:34  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2009-12-10 10:33  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing to release 1.3.2c today.

2009-12-10 10:24  castaglia

	* NEWS, contrib/mod_sftp/auth.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Bug#3352 - mod_sftp does not reject/close connections that have
	  been rejected by mod_wrap.

2009-12-10 09:59  castaglia

	* contrib/mod_wrap.c:
	  Specify the module version data in the module structure for
	  mod_wrap.

2009-12-10 09:45  castaglia

	* NEWS, modules/mod_auth.c, modules/mod_auth_file.c:
	  Backported fixes for Bug#3347 and Bug#3351.

2009-12-10 09:45  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#3351 - Nonchrooted logins on HPUX do not get proper UID/GID.

2009-12-10 09:40  castaglia

	* NEWS, modules/mod_auth_file.c, tests/tests.pl,
	  tests/t/config/authgroupfile.t,
	  tests/t/lib/ProFTPD/Tests/Config/AuthGroupFile.pm:
	  Bug#3347 - mod_auth_file handles 'getgroups' request incorrectly.

2009-12-10 08:26  castaglia

	* src/: support.c:
	  Updated fix for Bug#3350.

2009-12-10 07:52  castaglia

	* NEWS, src/support.c:
	  Bug#3350 - Segfault caused by scrubbing zero-length portion of
	  memory.

2009-12-09 15:45  castaglia

	* src/expr.c:
	  Fix the logic for iterating over the session.groups list, and
	  handling NULL names, in the pr_expr_eval_group_or() function as
	  well.

2009-12-09 15:44  castaglia

	* src/expr.c:
	  Fix the logic for iterating over session.groups, and handling
	  NULL names, in the pr_expr_eval_group_or() function as well.

2009-12-09 15:41  castaglia

	* src/expr.c, tests/api/expr.c:
	  Fix segfault uncovered by Michael, where the
	  pr_expr_eval_group_and() function would not handling NULL names
	  in the session.groups list.  This also makes the code which
	  iterates over the session.groups list look much saner.

2009-12-09 15:40  castaglia

	* src/expr.c, tests/api/expr.c:
	  Fix a segfault uncovered by Michael, where the
	  pr_expr_eval_group_and() function didn't handle a NULL group name
	  in the middle of the session.groups list.

2009-12-09 13:39  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3349 - SSL_SESSION_cmp not available in OpenSSL 1.0.0 betas.

2009-12-09 11:55  castaglia

	* contrib/mod_tls.c:
	  Backport of a mod_tls fix to handle checking of "is this a
	  renegotiation" only for control connections, not data
	  connections.

2009-12-09 11:52  castaglia

	* contrib/mod_tls.c:
	  Found another place where we want to do the "is this a
	  renegotiation" check only for control connections, not for data
	  connections.

	  Also quell a compiler warning using a typecast;
	  OpenSSL-1.0.0-betaN uses more const'd types than previously.

2009-12-09 11:49  castaglia

	* contrib/mod_tls.c:
	  Make sure that mod_tls can compile against OpenSSL-1.0.0-betaN,
	  which does not have the UNSAFE_LEGACY_RENEGOTIATION flag (it uses
	  something different).

2009-12-09 09:25  castaglia

	* contrib/mod_tls.c:
	  Make sure that mod_tls can be compiled using OpenSSL-1.0.0-betaN;
	  the UNSAFE_LEGACY_RENEGOTIATONS flag was changed after
	  OpenSSL-0.9.8l.

2009-12-08 16:51  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add unit test using a combined mod_sftp+mod_wrap2 configuration,
	  for use in preventing regressions in the interactions between
	  these modules.

2009-12-07 16:24  castaglia

	* doc/contrib/mod_ban.html:
	  Add a FAQ about creating whitelists for mod_ban.

2009-12-07 15:24  castaglia

	* modules/mod_xfer.c:
	  Additional change necessary for fixing Bug#3345.  Use of trace
	  logging (or not) affects the errno value, and we need to make
	  sure that the original errno value is preserved.

2009-12-07 15:02  castaglia

	* tests/t/lib/ProFTPD/Tests/: Commands/ALLO.pm, Commands/APPE.pm,
	  Commands/CDUP.pm, Commands/EPRT.pm, Commands/EPSV.pm,
	  Commands/MDTM.pm, Commands/MODE.pm, Commands/NOOP.pm,
	  Commands/PASS.pm, Commands/PASV.pm, Commands/PWD.pm,
	  Commands/QUIT.pm, Commands/RNFR.pm, Commands/RNTO.pm,
	  Commands/SIZE.pm, Commands/STOU.pm, Commands/STRU.pm,
	  Config/DeleteAbortedStores.pm, Config/FTPAccess/DELE.pm,
	  Commands/SYST.pm, Commands/TYPE.pm, Commands/USER.pm:
	  Updating more testsuite tests to use the consistent `tests.log'
	  log file.

2009-12-07 14:33  castaglia

	* tests/t/lib/ProFTPD/Tests/: Config/AllowOverwrite.pm,
	  Config/GroupOwner.pm, Config/MaxInstances.pm,
	  Config/MaxRetrieveFileSize.pm, Config/MaxStoreFileSize.pm,
	  Config/Order.pm, Config/RequireValidShell.pm,
	  Config/StoreUniquePrefix.pm, Config/TimeoutNoTransfer.pm,
	  Config/TimeoutSession.pm, Config/TimeoutStalled.pm,
	  Config/UseFtpUsers.pm, Config/UserOwner.pm, Signals/ABRT.pm,
	  Signals/HUP.pm, Signals/SEGV.pm, Signals/TERM.pm:
	  Updating more of the testsuite tests to use `tests.log' as their
	  output logging file, for consistency.

2009-12-07 08:44  castaglia

	* RELEASE_NOTES:
	  Work on preparing the release notes for 1.3.3rc3.

2009-12-07 08:20  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Correct the %description sections in proftpd.spec.

2009-12-06 09:19  castaglia

	* src/auth.c:
	  When resolving '~' paths, the lookup is done via getpwnam(), not
	  by using getpwuid().	Thus there is little gain (and there is a
	  cost in terms of performance, since getpwuid() is used when
	  listing directories) in calling pr_auth_get_home() from
	  pr_auth_getpwuid().

2009-12-06 09:08  castaglia

	* NEWS, modules/mod_auth.c, src/auth.c,
	  tests/t/lib/ProFTPD/Tests/Config/RewriteHome.pm:
	  Bug#3348 - Rewriting of home directories via RewriteHome does not
	  work for chrooted sessions.

2009-12-05 15:48  castaglia

	* doc/contrib/mod_sql_passwd.html:
	  Updated the mod_sql_passwd doc to mention support of SHA256 and
	  SHA512 passwords.

2009-12-05 15:46  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql_passwd.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_passwd.pm:
	  Bug#3344 - Support SHA256, SHA512 passwords in databases.

2009-12-03 13:45  castaglia

	* utils/scoreboard.c:
	  Fix an "unreachable code" compiler warning, and clean up the code
	  stylistically.

2009-12-02 19:57  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add unit tests showing that even when using SSL/TLS, resuming
	  downloads of
	  >2GB/4GB files via REST works properly.

2009-12-02 19:30  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/REST.pm:
	  Add a test for resuming downloads of >4GB files as well.

2009-12-02 18:49  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/REST.pm:
	  Add unit test for FileZilla's REST behavior over 2GB.

	  Modify all tests to output to the 'tests.log' file.

2009-12-01 20:45  castaglia

	* modules/mod_xfer.c:
	  Typos.

2009-12-01 20:38  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_ban.pm:
	  Fix broken mod_ban+mod_ifsession test.

2009-12-01 19:59  castaglia

	* src/display.c:
	  The displaying of multiline Display files was leaving off the
	  last line in the file; now fixed.

2009-12-01 19:56  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/DELE.pm:
	  Fix the DELE unit tests to handle different strerror(3) strings.

2009-12-01 11:39  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RMD.pm:
	  Fix broken RMD test.	Rename the output log file to the
	  'tests.log' that is being used elsewhere in the testsuite.

2009-12-01 10:10  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/FTP.pm, Tests/Commands/RMD.pm,
	  Tests/Config/HideFiles.pm:
	  Make the TestSuite::FTP client default to using passive data
	  transfers, not active data transfers.  Fix up some warnings in
	  the testsuite.

2009-11-30 09:26  castaglia

	* contrib/mod_sftp/channel.c, doc/contrib/mod_sftp.html:
	  Handle multiple SFTPAcceptEnv directives if configured.

	  Add docs for the SFTPAcceptEnv directive.

2009-11-26 11:18  castaglia

	* contrib/mod_sftp/fxp.c:
	  Include EINVAL in the list of errno values we expect to see from
	  PRE_CMD handlers.

2009-11-26 10:47  castaglia

	* modules/mod_xfer.c:
	  Make sure that the PRE_CMD handlers for RETR, APPE, and STOR set
	  appropriate errno values.

	  Remove some code that would never be executed.

2009-11-26 10:38  castaglia

	* NEWS, contrib/mod_sftp/fxp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Bug#3345 - mod_sftp returns EACCES rather than ENOENT for an OPEN
	  request for a nonexistent file.

2009-11-24 09:29  castaglia

	* contrib/mod_sftp/channel.c, contrib/mod_sftp/mod_sftp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Added SFTPAcceptEnv directive, for configuring which environment
	  variables can be set by the client.

2009-11-23 14:35  castaglia

	* src/dirtree.c:
	  Added note for myself for the future, about why <Directory>
	  patterns aren't matching as I had assumed they would.

2009-11-22 14:18  castaglia

	* contrib/mod_sftp/compress.c:
	  Rejigger the zlib inflate() code so that it doesn't use a switch
	  statement inside of a while loop; the 'break' statement is used
	  in both, and it can be confusing from which block you are trying
	  to escape.

	  This also fixes a warning about unreachable code, and adds a
	  preemptive guard against trying to call memcpy(2) with a zero
	  length.

2009-11-22 13:46  castaglia

	* contrib/mod_sftp/: kex.c, mod_sftp.c, packet.c:
	  Close the SFTPLog descriptor at session exit.  Initialize some
	  buffers (keeps Valgrind from whining about them).

2009-11-22 13:44  castaglia

	* modules/mod_auth.c:
	  Close the scoreboard descriptor at session exit.

2009-11-22 13:30  castaglia

	* contrib/mod_sftp/kex.c:
	  Forgot the return statement.

2009-11-22 11:46  castaglia

	* contrib/mod_sftp/: kex.c, kex.h, mod_sftp.c:
	  Fix another file descriptor leak in mod_sftp: the
	  SFTPDHParamsFile is opened for the session (and has to remain
	  open for the duration of the session, in order to be available
	  for rekeying), but is not closed.  Now it is closed at session
	  exit.

2009-11-22 11:34  castaglia

	* modules/mod_delay.c:
	  While running mod_sftp through Valgrind, I found that mod_delay
	  leaks an fd: it never closes the fd to the DelayTable, even after
	  the table has been unloaded from memory.  Fix this.

2009-11-20 20:55  castaglia

	* contrib/mod_tls.c, tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Fix up some issues found in mod_tls when running its test cases.

	  First, as per Bug#3325, make the TLSRequired/AllowPerUser check a
	  little smarter, so that the published AllowPerUser example in the
	  TLS howto works properly, but the check still retains its
	  validity.

	  When checking for client-initiated renegotiations, make sure we
	  don't punish the client for *new* sessions for *data*
	  connections.

	  Make sure that "TLSRequired auth" is enforced properly if the
	  client is NOT using SSL/TLS.

	  Include MLSD in the list of commands which can trigger data
	  transfers, and thus fall under the "TLSRequired data" checks.

2009-11-20 06:40  jwm

	* contrib/mod_ldap.c: release 2.8.21, with backports from bzr
	  trunk:

	  CHANGES: * Implement an internal failover mechanism instead of
	  relying on the LDAP	SDK's built-in failover (if any). Fixes
	  failover regression introduced   in v2.8.19 when
	  ldap_initialize() was first used.  * Multiple LDAP URL arguments
	  may now be passed to LDAPServer:

	    LDAPServer ldap://127.0.0.1/??sub ldap://172.16.0.1/??sub
	  * When setting whether to dereference LDAP aliases after
	  connecting to   the LDAP server, treat failure as a hard failure
	  and refuse to continue   with that LDAP server. Previously,
	  failure when specifying whether to   dereference aliases would be
	  logged but the connection to that server   would continue.

	  bzr r71:   - only log that we've successfully unbound if we've
	  successfully unbound	 - pr_ldap_connect() should always unbind
	  on failure   - treat dereference option set failure in
	  pr_ldap_connect() as a   - connection     failure; don't warn and
	  keep plowing on

	  bzr r77, r78:   Bug 3301 -  LDAP server failover does not work
	  when ldap_initialize() is   available

	    fix LDAP server failover by implementing our own failover
	  mechanism instead
	    of relying on the LDAP SDK's.

	    ldap server failover (space-separated list of hostnames in the
	  argument to
	    LDAPServer) has been broken since 2.8.19 when ldap_init() was
	  replaced with
	    ldap_initialize(), if available. as of that commit, a LDAP URL
	  is
	    constructed if simple hostname(s) are passed to LDAPServer, so:

	      'LDAPServer "127.0.0.1 172.16.0.5"

	    was passed to ldap_initailize() as:

	      ldap://127.0.0.1 172.16.0.5/

	    Unfortunately, ldap_url_parse() treats this as a valid URL, but
	    ldap_intiailize() will not fail over to subsequent LDAP servers
	    should the first be unreachable.

	    ldap_initialize() *will* take a whitespace-separated list of
	  LDAP URLs and
	    will fail over successfully, just not when whitespace-separated
	  hostname
	    are passed to a *single* url (even if the whitespace in the
	  hostname
	    portion of the URL is urlencoded as %20).

	    forget all of this SDK-based failover and implement our own
	  failover support,
	    since afaict Sun's ancient LDAP SDK doesn't implement failover
	  and it's nice
	    to be able to control it ourselves.

	    for that matter, we *need* to control it ourselves since we
	  need to use the
	    search scope indicated by the URL at hand. chances are, the
	  search scope
	    will be the same for all URLs passed to LDAPServer, but to be
	  completely
	    correct, we should use the scope corresponding to the current
	  URL and
	    ldap_initialize() provides no way to tell what URL it wound up
	  connecting
	    to.

2009-11-19 21:10  castaglia

	* modules/mod_ls.c, tests/t/lib/ProFTPD/Tests/Commands/LIST.pm:
	  Revisit the fix put in place for Bug#2367.  First, add the test
	  case to the LIST testsuite, for regressions.	Then look at a
	  different fix, a simpler one: remove the GLOB_PERIOD flag from
	  the flags used when globbing.  This causes the test case to pass.

	  This is done in order to make possible another case: list a
	  directory whose name legitimately contains a glob character ('['
	  in the case of one of the users in the online forums).  The
	  previous fix for Bug#2367 prevented the proper listing of such a
	  directory.  The newer, simpler fix handles this legitimate
	  directory name properly, while still preserving behavior which
	  matches that of the shell.

2009-11-19 20:53  castaglia

	* modules/mod_ls.c:
	  Fix up some of the code style in mod_ls.

	  Add handling of signals in the while() loops which iterate over
	  globbed paths.

	  Removed the '{' character from the glob character checks; it is
	  not a glob(3) character.

2009-11-19 15:09  castaglia

	* doc/contrib/mod_sftp.html:
	  Try to make the requirement of using ssh-keygen to convert public
	  keys to RFC4716 format clearer.

2009-11-19 10:55  castaglia

	* NEWS, src/bindings.c:
	  Bug#3306 - ECONNREFUSED while handling SIGHUP.

2009-11-18 21:29  castaglia

	* lib/libltdl/.cvsignore:
	  More auto-generated files to ignore.

2009-11-18 19:04  castaglia

	* configure:
	  Updated configure.

2009-11-18 18:58  castaglia

	* configure.in:
	  Handle empty CONFIG_SHELL values.

2009-11-18 18:47  castaglia

	* configure:
	  Updated configure.

2009-11-18 18:45  castaglia

	* configure.in:
	  Although it looks like LTDL_INIT(convenience) and
	  LTDL_CONVENIENCE are the same, they are not.	So we need to use
	  both.

2009-11-18 18:18  castaglia

	* Makefile.in:
	  Comment out the target that might cause the machine to re-run
	  autoconf.

2009-11-18 17:47  castaglia

	* configure:
	  Updated configure.

2009-11-18 17:40  castaglia

	* configure.in:
	  More libtool-2.2.4 tweaking fun.

2009-11-18 17:33  castaglia

	* configure:
	  Updated configure.

2009-11-18 17:30  castaglia

	* lib/libltdl/m4/ltdl.m4:
	  In order to avoid the very, very annoying error of:

	    configure: error: conditional "INSTALL_LTDL" was never defined.
	    Usually this means that the macro was only invoked
	  conditionally.

	  I am manually removing the whole m4 support of _LT_ENABLE_INSTALL
	  in the bundled libltdl.  ProFTPD is never going to make/provide
	  an installable libltdl library.

2009-11-18 13:51  castaglia

	* configure:
	  Updated configure.

2009-11-18 13:48  castaglia

	* Make.rules.in, configure.in:
	  More libtool-2.2.4 tweaks, with help from Bob Friesenhahn.

2009-11-18 13:46  castaglia

	* aclocal.m4:
	  Re-create our aclocal.m4 using the aclocal tool.

2009-11-18 09:48  castaglia

	* configure:
	  Updated configure.

2009-11-18 09:45  castaglia

	* configure.in, modules/Makefile.in:
	  Export the LTDLINCL variable from the configure script, so that
	  we are no longer hardcoding the path to the directory containing
	  the ltdl.h header.

2009-11-18 09:39  castaglia

	* Makefile.in, configure.in:
	  More wrestling with libtool-2.2.4.  I am *really* not liking this
	  2.2.x release series.

2009-11-17 23:01  castaglia

	* contrib/mod_sftp/fxp.c:
	  Quelling compiler warnings.

2009-11-17 22:38  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#3342 - FEAT response contains LF without preceding CR.

2009-11-17 20:08  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Config/Limit/RMD.pm,
	  t/config/limit/rmd.t:
	  Add regression test demonstrating how to make an undeletable
	  directory using the <Limit> + Filter approach.

2009-11-17 16:52  castaglia

	* doc/contrib/mod_sftp.html:
	  Update mod_sftp doc so that it's hopefully less confusing.

2009-11-17 14:55  castaglia

	* NEWS, contrib/mod_wrap2/mod_wrap2.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_wrap2_sql.pm:
	  Bug#3341 - mod_wrap2 segfaults when a valid user retries the USER
	  command.

2009-11-17 11:28  castaglia

	* NEWS:
	  Bug#3331 - Update bundled libtool to 2.2.4.

2009-11-17 11:27  castaglia

	* configure:
	  Updated configure.

2009-11-17 11:20  castaglia

	* Makefile.in, configure.in, modules/Makefile.in:
	  More tweaks to the build files to make sure that mod_dso builds
	  properly with the new version of libltdl/libtool.

2009-11-17 11:19  castaglia

	* lib/libltdl/.cvsignore:
	  One more libtool file to ignore.

2009-11-17 11:18  castaglia

	* lib/libltdl/.cvsignore:
	  More files to ignore with this new version of libtool.

2009-11-17 10:46  castaglia

	* lib/libltdl/ltdl.c:
	  Backport the patch for the bugs found in libtool-2.2.6 to this
	  2.2.4 version.

2009-11-17 10:44  castaglia

	* lib/libltdl/: Makefile.in, acinclude.m4, argz.c, config.guess,
	  config.sub, install-sh, ltmain.sh, missing:
	  Bug#3331 - Update bundled libtool to 2.2.4.

2009-11-17 10:33  castaglia

	* configure:
	  Updated configure.

2009-11-17 10:25  castaglia

	* lib/libltdl/Makefile.am, lib/libltdl/Makefile.in,
	  lib/libltdl/README, lib/libltdl/aclocal.m4, lib/libltdl/argz_.h,
	  lib/libltdl/config-h.in, lib/libltdl/configure,
	  lib/libltdl/configure.ac, lib/libltdl/lt__alloc.c,
	  lib/libltdl/lt__dirent.c, lib/libltdl/lt__strl.c,
	  lib/libltdl/lt_dlloader.c, lib/libltdl/lt_error.c,
	  lib/libltdl/ltdl.c, lib/libltdl/ltdl.h, lib/libltdl/slist.c,
	  lib/libltdl/config/compile, lib/libltdl/config/config.guess,
	  lib/libltdl/config/config.sub, lib/libltdl/config/depcomp,
	  lib/libltdl/config/install-sh, lib/libltdl/config/ltmain.sh,
	  lib/libltdl/config/missing, lib/libltdl/libltdl/lt__alloc.h,
	  lib/libltdl/libltdl/lt__dirent.h,
	  lib/libltdl/libltdl/lt__glibc.h,
	  lib/libltdl/libltdl/lt__private.h,
	  lib/libltdl/libltdl/lt__strl.h,
	  lib/libltdl/libltdl/lt_dlloader.h,
	  lib/libltdl/libltdl/lt_error.h, lib/libltdl/libltdl/lt_system.h,
	  lib/libltdl/libltdl/slist.h, lib/libltdl/loaders/dld_link.c,
	  lib/libltdl/loaders/dlopen.c, lib/libltdl/loaders/dyld.c,
	  lib/libltdl/loaders/load_add_on.c,
	  lib/libltdl/loaders/loadlibrary.c, lib/libltdl/loaders/preopen.c,
	  lib/libltdl/loaders/shl_load.c, lib/libltdl/m4/argz.m4,
	  lib/libltdl/m4/libtool.m4, lib/libltdl/m4/ltdl.m4,
	  lib/libltdl/m4/ltoptions.m4, lib/libltdl/m4/ltsugar.m4,
	  lib/libltdl/m4/ltversion.m4, lib/libltdl/m4/lt~obsolete.m4,
	  aclocal.m4, ltmain.sh, configure.in, modules/mod_dso.c:
	  Bug#3331 - Update bundled libtool to 2.2.4.

2009-11-17 10:12  castaglia

	* config.guess, config.sub:
	  Updating the config.guess and config.sub helper scripts.

2009-11-17 10:01  castaglia

	* install-sh:
	  Updated the install-sh script.

2009-11-17 09:36  castaglia

	* doc/howto/Timestamps.html:
	  Mention MFMT in the Timestamps howto.

2009-11-16 20:38  castaglia

	* doc/contrib/mod_sftp.html:
	  Add the SFTP Extensions Draft to the list.

2009-11-15 22:12  castaglia

	* contrib/mod_sftp/channel.c:
	  Locking down more environment variables from SSH2 client
	  tweaking.

2009-11-15 21:48  castaglia

	* contrib/mod_sftp/channel.c:
	  Add more barred environment variables to the list.

2009-11-15 21:41  castaglia

	* contrib/mod_sftp/channel.c:
	  Don't allow SSH2 clients to change the TZ environment variable,
	  either.

2009-11-15 21:40  castaglia

	* contrib/mod_sftp/channel.c:
	  Add a few more environment variables that SSH2 clients are barred
	  from sending/overriding in their session.

2009-11-15 21:16  castaglia

	* contrib/mod_sftp/fxp.c:
	  Adding some notes for my future self.

2009-11-15 21:14  castaglia

	* contrib/mod_sftp/fxp.c:
	  Make sure to advertise that the client can use the 'vendor-id'
	  extension in the supported2 extension to the VERSION response.

2009-11-15 19:56  castaglia

	* src/dirtree.c:
	  Simpler fix for Bug#3337.

2009-11-15 12:18  castaglia

	* contrib/mod_sftp/fxp.c:
	  If the client sends the 'check-file' extension, do not disconnect
	  the session if the requested checksum algorithm is not supported;
	  simply send the failure STATUS message back.

2009-11-15 12:13  castaglia

	* contrib/mod_sftp/scp.c:
	  Include the sticky bit when sending/receiving files/directories.

2009-11-14 16:27  castaglia

	* NEWS, src/dirtree.c:
	  Bug#3337 - <Directory> sections with a trailing directory name of
	  one character have <Limit> problems.	This is a regression caused
	  by Bug#3146.

2009-11-14 16:23  castaglia

	* NEWS, src/dirtree.c,
	  tests/t/lib/ProFTPD/Tests/Config/Directory/Limits.pm:
	  Bug#3337 - <Directory> sections with a trailing directory name of
	  one character have <Limit> problems.	This is a regression caused
	  by Bug#3146.

2009-11-14 15:29  castaglia

	* contrib/mod_sftp/fxp.c:
	  Check for READ/WRITE <Limit> sections pertaining to files being
	  read/written for the 'check-file' and 'copy-file' SFTP
	  extensions.

2009-11-14 14:57  castaglia

	* contrib/mod_sftp/fxp.c:
	  Slightly nicer way of dealing with using O_NONBLOCK for open(3)
	  when handling OPEN requests.	This way, we don't have to clear
	  the O_NONBLOCK flag later.

2009-11-14 12:40  castaglia

	* configure:
	  Updated configure script.

2009-11-14 12:37  castaglia

	* configure.in:
	  Add use of the -Wunreachable-code compiler flag, where supported,
	  when --enable-devel is used.

	  Make the use of the AC_DEFINE macro more consistent by providing
	  the optional message in more places.

2009-11-14 12:13  castaglia

	* m4/proftpd.m4:
	  Try to make the use of the AC_DEFINE macro more consistent with
	  other occurrences by supplying a message.

2009-11-14 11:15  castaglia

	* contrib/mod_sftp/fxp.c:
	  Fix regression where SFTP downloads were not being logged via
	  TransferLog; caused by the addition of the O_NONBLOCK to the
	  fh_flags per Bug#3314.  Reported by Bernd Lommerzheim.

2009-11-14 10:23  castaglia

	* modules/mod_core.c:
	  Add trace logging of the pr_netacl_t objects created via other
	  config directives.

2009-11-13 17:16  castaglia

	* m4/proftpd.m4:
	  Separate out the proftpd-specific autoconf macros from aclocal.m4
	  into this file.  Makes it easier to recreate a new aclocal.m4
	  file, containing macros from many different sources.

2009-11-13 10:59  castaglia

	* doc/contrib/mod_sql.html:
	  Fix typo in mod_sql docs.

	  Add description of the interaction between the
	  useNormalizedGroupSchema SQLOption and custom SQLGroupInfo
	  queries.

2009-11-13 10:29  castaglia

	* contrib/mod_sql_mysql.c:
	  Typo.

2009-11-13 10:26  castaglia

	* NEWS, contrib/mod_sql_mysql.c:
	  Bug#3333 - mod_sql_mysql should support calling stored procedures
	  better.

2009-11-13 09:19  castaglia

	* NEWS, contrib/mod_wrap.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_wrap.pm:
	  Bug#3332 - Segfault in mod_wrap when TCPAccessFiles do not exist
	  and client sends USER for account which does not exist.

2009-11-13 07:56  castaglia

	* contrib/mod_sftp/fxp.c:
	  Use defined constants rather than "magic" numbers.  Log any
	  client-sent vendor information in the SFTPLog, rather than the
	  TraceLog.

2009-11-12 23:34  castaglia

	* contrib/mod_sftp/fxp.c:
	  Make sure that we only send defined flag values in the
	  statvfs@openssh.com extension response.

2009-11-12 18:29  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sftp/fxp.c,
	  contrib/mod_sftp/fxp.h, contrib/mod_sftp/mod_sftp.c,
	  doc/contrib/mod_sftp.html:
	  Bug#3329 - Support the "vendor-id" SFTP extension.

2009-11-12 09:24  castaglia

	* doc/contrib/mod_ban.html:
	  Adding a mod_ban FAQ, cleaning up a minor nit.

2009-11-11 09:51  castaglia

	* doc/contrib/mod_sql.html:
	  Make a note in the description of the Crypt SQLAuthType that
	  crypt(3) only uses the first 8 characters of a password; this can
	  have some surprising (depressing?) consequences for the unwary.

2009-11-10 09:32  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Limit/SubDirectories.pm:
	  Add more tests for the fix for Bug#3077.

2009-11-10 09:23  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#3307 - Transparently handle the X-variant commands when
	  checking <Limit> permissions.  The fix for this issue has been
	  reimplemented to be more transparent; some existing
	  configurations were broken by the previous implementation.

2009-11-09 22:11  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  For completeness, add a mod_quotatab unit test for RETR and the
	  files_out limit.

2009-11-09 21:02  castaglia

	* contrib/mod_site_misc.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_site_misc.pm:
	  Make sure that SITE SYMLINK fails if the source path does not
	  exist on the filesystem.  I thought that the symlink(2) system
	  call would handle this for us, but apparently not (at least it
	  doesn't on Mac OSX 10.4, and thus potentially other platforms).

2009-11-09 17:08  castaglia

	* contrib/mod_quotatab.c:
	  Add comment for my future self about why the have_quota_update
	  flag is cleared before writing to the tally table, instead of
	  after.

2009-11-09 17:03  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#3328 - Failed database transaction can cause mod_quotatab to
	  loop endlessly.

2009-11-09 16:40  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Add mod_quotatab test for RETR byte limits.

2009-11-09 14:09  castaglia

	* src/main.c:
	  Make sure that the LC_NUMERIC locale category is always "C",
	  regardless of what's in the environment when proftpd starts.

2009-11-09 10:34  castaglia

	* contrib/mod_sftp/fxp.c:
	  Fix some compiler warnings about signedness mismatches, and avoid
	  an explicit cast, by redefining the buffer to use char, not
	  unsigned char.

2009-11-09 09:26  castaglia

	* contrib/mod_tls.c:
	  Backport the change to mod_tls that removes the daemon-exit
	  listener from the session process.

2009-11-08 22:46  castaglia

	* contrib/mod_quotatab.c:
	  Before a copy, apply any QuotaExcludeFilter to the source path;
	  the destination may not exist.  After a copy, apply any
	  QuotaExcludeFilter to the destination path.  It's a little odd,
	  but I think it makes sense this way.

2009-11-08 22:41  castaglia

	* contrib/: mod_quotatab.c, mod_sftp/fxp.c:
	  Give mod_quotatab the ability to track (and enforce) quota
	  changes due to the copying of files now possible via mod_sftp's
	  copy-file SFTP extension.  For testing this, I had to use a SITE
	  COPY implementation.

2009-11-08 20:40  castaglia

	* contrib/mod_site_misc.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_site_misc.pm:
	  Advertise the supported SITE commands provided by mod_site_misc
	  in the FEAT response.

2009-11-08 19:51  castaglia

	* contrib/mod_quotatab.c:
	  In the pre-APPE handler, make sure to exclude files which match
	  any configured QuotaExcludeFilter before checking the quota
	  limits/tallies; if a file is excluded by the filter, it shouldn't
	  run afoul of those limits/tallies.

2009-11-08 19:47  castaglia

	* contrib/mod_quotatab.c:
	  Add checking of the path against a QuotaExcludeFilter in a few
	  more places.	Add the setting of HAVE_WRITE_UPDATE in the
	  pre-APPE handler, just as is done in the pre-STOR handler.

2009-11-08 18:18  castaglia

	* contrib/mod_tls.c:
	  Remove the daemon-exit listener for the 'core.exit' event in the
	  session process; when the session process exits, it shouldn't
	  send a 'core.exit' event to the daemon-exit listener.

2009-11-08 17:27  castaglia

	* RELEASE_NOTES, doc/contrib/mod_sftp.html:
	  Mention the new SFTP extensions, and the SFTPExtensions
	  directive, in the release notes.

	  Update the mod_sftp doc to cover the SFTPExtensions directive.

2009-11-08 16:50  castaglia

	* modules/mod_core.c:
	  Fix minor issue where DELE on a symlink would cause the wrong
	  size to be logged (the size of the target file, not the symlink,
	  would be logged).

2009-11-08 16:48  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/DELE.pm:
	  Add unit test for DELEs on symlinks.

2009-11-08 13:23  castaglia

	* contrib/mod_sftp/: fxp.c, fxp.h, mod_sftp.c:
	  With the addition of various SFTP extensions to mod_sftp, it's a
	  good idea to have a mechanism for disabling support for
	  individual extensions as desired.  This will also come in handy
	  later, for extensions which might be useful, but which need to be
	  selectively enabled.

	  Thus this patch introduces a new SFTPExtensions directive.

2009-11-08 12:43  castaglia

	* doc/contrib/mod_sftp.html:
	  Update the list of SFTP extensions supported by mod_sftp.

2009-11-08 12:37  castaglia

	* NEWS, contrib/mod_sftp/fxp.c:
	  Bug#3320 - Support the "copy-file" SFTP extension.

2009-11-08 12:25  castaglia

	* contrib/mod_sftp/fxp.c:
	  Use a better errno value (EACCES) and remove redundant logging
	  when Path{Allow,Deny}Filter settings apply to paths sent by the
	  SFTP client.

2009-11-08 11:58  castaglia

	* src/fsio.c:
	  Fix some issues found in pr_fs_copy_file():	- return an error
	  if closing the destination file returned an error   - use
	  nonblocking opens, in case the source/destination paths are FIFOs

	  Also some stylistic changes.

2009-11-08 11:20  castaglia

	* NEWS, contrib/mod_sftp/fxp.c:
	  Bug#3321 - Support the "check-file-name" and "check-file-handle"
	  SFTP extensions.

2009-11-07 19:41  castaglia

	* contrib/mod_sftp/configure:
	  Updated mod_sftp's configure script.

2009-11-07 19:28  castaglia

	* contrib/mod_sftp/: configure.in, mod_sftp.h.in:
	  Add checks for support for SHA256 and SHA512 in OpenSSL to
	  mod_sftp's configure script.

2009-11-07 14:41  castaglia

	* contrib/mod_sftp/fxp.c:
	  Skip adding version 1 to the 'versions' list; it's not allowed by
	  Section 4.6 of the SFTP Draft.

2009-11-07 14:40  castaglia

	* contrib/mod_sftp/fxp.c:
	  Minor refinement to the version-select SFTP extension
	  implementation.

2009-11-07 14:34  castaglia

	* NEWS, contrib/mod_sftp/fxp.c:
	  Bug#3322 - Support the "version-select" SFTP extension.

2009-11-07 12:11  castaglia

	* NEWS, contrib/mod_tls_shmcache.c:
	  Bug#3326 - Shared memory segment used for session cache should be
	  protected via mlock(2).

2009-11-07 11:46  castaglia

	* NEWS, contrib/mod_tls_shmcache.c:
	  Bug#3327 - Clear external SSL session caches on server
	  restart/shutdown.

2009-11-07 10:46  castaglia

	* contrib/mod_sftp/fxp.c:
	  Ignore any size attribute that the SFTP client may send in an
	  OPEN request; attempting to honor the suggested size by
	  truncating the file during the OPEN can cause problems.  Size
	  attributes sent in SETSTAT/FSETSTAT requests are still honored.

2009-11-06 19:45  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_tls.c:
	  Bug#3324 - Vulnerability in SSL/TLS protocol during renegotiation
	  (CVE-2009-3555).

2009-11-06 19:44  castaglia

	* RELEASE_NOTES:
	  Typo.

2009-11-06 19:41  castaglia

	* doc/contrib/mod_tls.html:
	  Mention that server-initiated SSL session renegotiations are
	  still honored when possible.

2009-11-06 19:39  castaglia

	* configure:
	  Updated configure for Bug#3311.  Also added automatic detection
	  of build requests for mod_sql_passwd, so that the USE_OPENSSL
	  flag can be automatically set when that module is requested, just
	  as is done for mod_tls and mod_sftp.

2009-11-06 19:36  castaglia

	* NEWS, configure.in:
	  Bug#3311 - configure script should automatically detect when -ldl
	  is needed by OpenSSL.

2009-11-06 18:42  castaglia

	* contrib/mod_tls.c:
	  Add the changes from Bug#3324 to deal with server-initiated
	  session renegotiations when using OpenSSL 0.9.8l or later.

2009-11-06 18:01  castaglia

	* contrib/mod_tls.c:
	  Handle signals in the diagnostic callback.

2009-11-06 17:52  castaglia

	* contrib/mod_tls.c:
	  More work towards Bug#3324 - allow server-initiated session
	  renegotiations whilst rejecting client-initiated session
	  renegotiations.

2009-11-06 17:11  castaglia

	* doc/contrib/mod_tls.html:
	  Document the new AllowClientRenegotiations TLSOption.

2009-11-06 17:06  castaglia

	* RELEASE_NOTES:
	  Update the release notes.

2009-11-06 16:55  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3324 - Vulnerability in SSL/TLS protocol during renegotiation
	  (CVE-2009-3555).

2009-11-06 16:53  castaglia

	* doc/howto/TLS.html:
	  Add a TLS FAQ, inspired by Bug#3247 (and its ensuing duplicates).

2009-11-06 10:57  castaglia

	* contrib/mod_tls.c, doc/howto/TLS.html:
	  Remove the "TLSRenegotiate off" synonym; I had simply confused
	  myself with the bad example config I'd written in the TLS howto
	  (now fixed as well).

2009-11-06 10:52  castaglia

	* contrib/mod_tls.c:
	  Allow "TLSRenegotiate off" as a synonym for "TLSRenegotiate
	  none".

2009-11-06 10:46  castaglia

	* contrib/mod_tls.c:
	  Include in the end-of-session EnableDiags-enabled stats the
	  number of times a session was removed from the cache because the
	  cache size was exceeded.

2009-11-06 10:12  castaglia

	* contrib/mod_tls.c:
	  Ignore EAGAIN errors when the EnableDiags TLSOption is used; they
	  just clutter up the TLSLog.

2009-11-06 07:47  castaglia

	* contrib/mod_tls.c:
	  Remove spurious ""SSL_shutdown error: ZERO_RETURN" logging; it is
	  not actually an error to encounter an SSL_ERROR_ZERO_RETURN value
	  when shutting down the SSL/TLS session.

2009-11-05 17:56  castaglia

	* contrib/mod_sftp/fxp.c:
	  Add empty stubs of functions which will add the "standard" SFTP
	  extensions to mod_sftp's VERSION response to SFTP clients.

2009-11-05 16:09  castaglia

	* contrib/mod_tls.c:
	  Minor reordering of the logged SSL/TLS end-of-connection stats;
	  this way the cache-related stats appear together.

2009-11-05 10:24  castaglia

	* modules/mod_ls.c:
	  Make sure that we can handle symlinks whose target paths are long
	  (e.g.  longer than 1K).

2009-11-05 09:46  castaglia

	* contrib/mod_sql_passwd.c, contrib/mod_sftp/fxp.c,
	  contrib/mod_sftp/keys.c, contrib/mod_sftp/scp.c, include/fsio.h,
	  modules/mod_auth.c, modules/mod_log.c, src/fsio.c, src/log.c,
	  src/xferlog.c:
	  Switch to using nonblocking open(2) calls in many places,
	  especially when handling log files.  This is to deal with the
	  case where the log files configured are actually FIFOs; if the
	  other end of the FIFO is not running, then a blocking open(2)
	  would block indefinitely.  For example, configuring a FIFO for
	  TransferLog, and not having the FIFO reader running, would hang
	  the client session.  Now by using nonblocking open(2), we can
	  detect such cases and handle them.  The opened fds are returned
	  to blocking mode, assuming a successful open.

2009-11-05 09:40  castaglia

	* contrib/: mod_sftp_pam.c, mod_sftp/auth.h, mod_sftp/keystore.c,
	  mod_sftp/mod_sftp.h.in:
	  Clean up a few warts and warnings.

2009-11-04 21:37  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/LIST.pm:
	  Adding unit test for LIST output of a symlink when ShowSymlinks
	  is enabled.

2009-11-04 18:19  castaglia

	* modules/mod_core.c, src/class.c, src/netacl.c:
	  Add more trace logging about how <Class> rules are parsed and
	  compared.  Fix some rule parsing cases which were not being
	  handled properly.

2009-11-04 18:17  castaglia

	* tests/: tests.pl, t/config/classes.t,
	  t/lib/ProFTPD/Tests/Config/Classes.pm:
	  Adding unit tests for various <Class> configurations and rules.

2009-11-04 15:24  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/UserPassword.pm:
	  Add regression test for using UserPassword in an <Anonymous>
	  section to create an effectively virtual user account.

2009-11-04 15:02  castaglia

	* RELEASE_NOTES, doc/modules/mod_cap.html, modules/mod_cap.c:
	  Support adding the CAP_FOWNER capability.

2009-11-04 13:09  castaglia

	* RELEASE_NOTES:
	  Mention support for the OpenSSH extensions in the release notes.

2009-11-04 13:07  castaglia

	* contrib/mod_sftp/fxp.c, doc/contrib/mod_sftp.html:
	  Added support for the posix-rename@openssh.com OpenSSH SFTP
	  extension.

2009-11-04 12:51  castaglia

	* contrib/mod_sftp/fxp.c:
	  When handling RENAME SFTP requests, make sure to update the
	  scoreboard with the name of "RENAME", not "REALPATH".  Sheesh.

2009-11-04 12:27  castaglia

	* doc/howto/Chroot.html:
	  Add an example of constructing symlinks using relative paths;
	  these types of symlinks stand a better chance of working properly
	  within chrooted sessions.

2009-11-04 12:19  castaglia

	* NEWS, contrib/mod_wrap.c, include/log.h, src/log.c:
	  Bug#3317 - mod_wrap/libwrap should honor SyslogFacility setting.

2009-11-04 11:07  castaglia

	* doc/contrib/mod_sftp.html:
	  Update the mod_sftp doc to mention that the most up-to-date
	  version is distributed with the ProFTPD source code.

	  Mention the support for OpenSSH's "statvfs@openssh.com" and
	  "fstatvfs@openssh.com" SFTP extensions.

2009-11-04 10:49  castaglia

	* doc/contrib/mod_sftp.html:
	  Document the use of the SSH_CONNECTION environment variable.

2009-11-04 10:48  castaglia

	* contrib/mod_sftp/mod_sftp.c:
	  Set the SSH_CONNECTION environment variable, using the same
	  format as OpenSSH.

2009-11-04 10:01  castaglia

	* contrib/mod_sftp/auth.c:
	  Make sure that callers can't use the new sftp_auth_send_banner()
	  function to send USERAUTH_BANNER messages to the client after it
	  has authenticated; this is not allowed by RFC4252.

2009-11-04 09:50  castaglia

	* NEWS, contrib/mod_sftp_pam.c, contrib/mod_sftp/auth.c,
	  contrib/mod_sftp/auth.h:
	  Bug#3316 - Messages from PAM modules are ignored when
	  authenticating SSH clients via 'keyboard-interactive'.

2009-11-03 11:12  castaglia

	* doc/contrib/mod_sftp.html:
	  Mention the %u variable in the SFTPAuthorizedUserKeys directive
	  description.

2009-11-03 11:03  castaglia

	* NEWS, contrib/mod_sftp/keystore.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Bug#3315 - Support the %u variable in SFTPAuthorizedUserKeys
	  paths.

2009-11-03 10:15  castaglia

	* configure:
	  Updated configure.

2009-11-03 10:09  castaglia

	* configure.in:
	  Add some more gcc warning flags to the list when --enable-devel
	  is used, specifically -Wformat-security, -Wstack-protector, and
	  -fstack-protector-all.

2009-11-03 00:09  castaglia

	* contrib/mod_sftp/: fxp.c, fxp.h:
	  Added support for the statvfs@openss.com and fstatvfs@openssh.com
	  OpenSSH SFTP extensions.

2009-11-02 22:39  castaglia

	* NEWS:
	  Pedantic correction: lseek(2), not lseek(3).

2009-11-02 22:37  castaglia

	* NEWS, contrib/mod_sftp/scp.c, modules/mod_xfer.c:
	  Bug#3314 - Downloading from FIFOs via SFTP/SCP fails.

2009-11-02 22:35  castaglia

	* NEWS, contrib/mod_sftp/fxp.c:
	  Bug#3313 - Uploading via SFTP to FIFOs fails due to illegal
	  lseek(3), truncate(2) calls.

2009-11-02 22:32  castaglia

	* NEWS, contrib/mod_sftp/fxp.c, contrib/mod_sftp/scp.c:
	  Bug#3312 - Uploading via SFTP/SCP to FIFO whose reader is closed
	  causes session to hang.

2009-11-02 22:28  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  On some platforms, ENXIO has a string representation of "Device
	  not configured".

2009-11-02 20:10  castaglia

	* contrib/mod_sftp/packet.c:
	  Adding reminder notes/comments for my future self.

2009-11-02 19:53  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Remove duplicate unit test entry from the list.

2009-11-02 19:48  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add regression test proving that setting a mode which contains
	  S{G,U}ID bits is properly supported via SFTP.

2009-11-02 19:22  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Adding unit tests for Bug#3314.  These tests rely on having a
	  FIFO-writing program open at /tmp/test.fifo, and thus do not run
	  automatically as part of the testsuite.

2009-11-02 19:01  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Adding unit tests for Bug#3313.  These particular tests are a
	  little odd in that they will have to be run manually; they
	  require a FIFO-reading process to be running at /tmp/test.fifo
	  (and I didn't feel like wrestling with Perl in order to fork off
	  more processes in these tests).

2009-11-02 18:31  castaglia

	* contrib/mod_sftp/fxp.c:
	  Fix a segfault where a reason string was not being returned for
	  an errno value which we were not expecting/handling.

2009-11-02 17:28  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Adding regression tests for Bug#3312.  Note that I still need to
	  run these tests on other platforms (Solaris, FreeBSD, Mac OSX),
	  as I suspect that the errno value returned from a failed open(2)
	  of a FIFO will vary quite a bit across the platforms.

2009-11-02 16:26  castaglia

	* modules/mod_xfer.c:
	  Allow uploading to /dev/full on Linux; this is useful for testing
	  how clients handle out-of-disk situations/errors.

2009-11-02 16:26  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add unit test for uploading to /dev/full (Linux only), to
	  simulate an out-of-disk situation.  (Turns out that Net::SSH2
	  does not propagate the WRITE/CLOSE error to the calling code; I
	  need to file a bug with the module maintainer about this.)

2009-11-02 16:25  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Add support for os_* tags to tests, so that certain tests can be
	  targeted for specific OS/platforms (as determined by Perl's $^O
	  variable).

2009-10-30 16:36  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_wrap.pm:
	  Adding unit tests for more of mod_wrap's directives.

2009-10-30 15:37  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_wrap.pm,
	  t/modules/mod_wrap.t:
	  Start of unit tests for the mod_wrap module.

2009-10-30 10:30  castaglia

	* locale/fr_FR.po:
	  Bug#3309 - Fix whitespace in MLST response when using the fr_FR
	  locale.

2009-10-29 09:53  castaglia

	* RELEASE_NOTES, locale/Makefile.in, locale/zh_TW.po:
	  Wei-Lun Chao contributed a Taiwan translation for proftpd.

2009-10-29 09:52  castaglia

	* RELEASE_NOTES:
	  Mention new Taiwan translation in release notes.

2009-10-29 09:52  castaglia

	* locale/: Makefile.in, zh_TW.po:
	  Wei-Lun Chao contributed a Taiwanese translation for proftpd.

2009-10-29 08:24  castaglia

	* contrib/mod_sftp/cipher.c:
	  Quell compiler warnings about mismatched data types.

2009-10-28 14:48  castaglia

	* src/auth.c:
	  Fixing another part of Bug#3307.

2009-10-28 14:46  castaglia

	* tests/t/lib/ProFTPD/Tests/Logins.pm:
	  Adding more regression tests (and improving existing tests) for
	  Bug#3307.

2009-10-27 09:45  castaglia

	* NEWS, src/auth.c, tests/t/lib/ProFTPD/Tests/Logins.pm:
	  Bug#3307 - All FTP logins treated as anonymous logins.

2009-10-26 16:01  castaglia

	* contrib/mod_sql.c, modules/mod_log.c:
	  Increasing the size of a couple more buffers in order to avoid
	  inadvertently truncating file names.

2009-10-26 15:12  castaglia

	* modules/mod_log.c:
	  Add some additional room for other ExtendedLog data.

2009-10-26 15:09  castaglia

	* modules/mod_log.c, src/log.c, src/main.c:
	  Make the buffers used for logging and for reading client data
	  depend on PR_TUNABLE_PATH_MAX, which in turn depends on
	  MAXPATHLEN (if defined by the OS).  This makes sure that the
	  buffers are at least large enough to deal with the longest path
	  supported by the OS (e.g. 4K on a Linux 2.6 kernel).

2009-10-26 08:39  castaglia

	* doc/howto/: Nonroot.html, index.html:
	  Add the nonroot howto to the collection.

2009-10-23 09:28  castaglia

	* NEWS, lib/pr-syslog.c:
	  Bug#3305 - Emulate Solaris 10 syslog "header" on Solaris 10
	  servers.

2009-10-23 09:16  castaglia

	* src/main.c:
	  Initialize the xerrno variable, to quell a compiler warning.

2009-10-21 17:40  castaglia

	* src/inet.c:
	  Pedantic comment typo correction.

2009-10-21 10:26  castaglia

	* tests/: tests.pl, t/config/hidenoaccess.t,
	  t/lib/ProFTPD/Tests/Config/HideNoAccess.pm:
	  Add unit test for the HideNoAccess directive.

2009-10-21 09:42  castaglia

	* doc/howto/Scoreboard.html:
	  Add scoreboard FAQ about "bad version (too old)" errors.

2009-10-21 09:39  castaglia

	* doc/contrib/mod_sftp.html:
	  Added mod_sftp FAQ about ListOptions.

2009-10-21 08:05  castaglia

	* contrib/mod_tls.c:
	  Cleanly shutdown the SSL/TLS session (if there is one) for
	  TimeoutLogin as well.

2009-10-20 18:41  castaglia

	* src/main.c:
	  Stash the errno value if select(), in the main loop, returns -1;
	  this makes for better errno logging/reporting.  Also avoid trying
	  to accept(2) a connection if the select() return value is -1.

2009-10-20 17:24  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3303 - FileZilla reports "Server did not properly shut down
	  TLS connection" after TimeoutIdle triggered..

2009-10-20 14:58  castaglia

	* doc/contrib/mod_tls.html:
	  Markup error.

2009-10-20 14:47  castaglia

	* include/version.h:
	  Bumped version to what will become 1.3.3rc3.

2009-10-20 14:13  castaglia

	* contrib/dist/rpm/proftpd.spec, include/version.h:
	  Getting versions ready for 1.3.3rc2 release.

2009-10-20 14:11  castaglia

	* NEWS:
	  Mention the release date for 1.3.3rc2.

2009-10-20 11:52  castaglia

	* RELEASE_NOTES:
	  Typos, corrections.

2009-10-20 11:46  castaglia

	* ChangeLog:
	  Updated the ChangeLog.

2009-10-20 10:58  castaglia

	* ChangeLog:
	  Updated the ChangeLog.

2009-10-20 10:30  castaglia

	* NEWS, RELEASE_NOTES, contrib/dist/rpm/proftpd.spec,
	  include/version.h:
	  Readying the release of 1.3.2b.

2009-10-20 10:03  castaglia

	* RELEASE_NOTES:
	  Adding more to the release notes, getting them ready for the
	  release of RC2.

2009-10-19 18:11  castaglia

	* contrib/mod_sql_postgres.c:
	  Minor tweaks to the Postgres NLS/encoding code.

2009-10-19 17:19  castaglia

	* RELEASE_NOTES:
	  Point out a potential hazard with the delayed-open database
	  connection policy and logging-only database configs.

2009-10-19 15:07  castaglia

	* contrib/mod_sql_postgres.c:
	  The get_postgres_encoding() function is specific to
	  mod_sql_postgres; no need to have its symbol be exported/visible
	  outside of this file.

2009-10-19 14:58  castaglia

	* contrib/mod_sql_postgres.c:
	  Quell minor compiler warning about the get_postgres_encoding()
	  function when --enable-nls is used by providing a function
	  prototype.

2009-10-19 14:08  castaglia

	* doc/howto/NAT.html:
	  Fixed URL to IP Masquerade howto doc.

2009-10-14 16:45  castaglia

	* modules/mod_facts.c, tests/t/lib/ProFTPD/Tests/Commands/MLSD.pm:
	  Make sure that mod_facts uses 'cdir' or 'pdir' as the type in a
	  MLSD response, rather than just 'dir', where appropriate.

2009-10-14 11:49  castaglia

	* modules/mod_auth_unix.c:
	  Helps if we provide the data type for variables.

2009-10-14 11:35  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/MLSD.pm:
	  Add a test for when a session is chrooted, and fix the regexes
	  used throughout these tests.

2009-10-14 11:31  castaglia

	* modules/mod_facts.c:
	  Do a little resolution on the given MLSD path, trying to find a
	  fuller, better path.	(This is particularly important for
	  mod_vroot to function properly.)

2009-10-14 10:54  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/MLSD.pm:
	  Fixing quietly broken MLSD unit tests; they were using the wrong
	  regex.

2009-10-13 08:30  castaglia

	* modules/: mod_core.c, mod_xfer.c:
	  Found a few more cases where errno could be trampled by
	  pr_trace_msg(), and thus requires brief caching.

2009-10-12 16:52  jwm

	* contrib/mod_ldap.c: mod_ldap bzr r70:   2.8.20 release

2009-10-12 16:51  jwm

	* contrib/mod_ldap.c: mod_ldap bzr r68:   ldap_server and ldap_port
	  should be defined in the !(openldap	LDAP_VENDOR_VERSION >= 192)
	  case

	  mod_ldap bzr r67:   bump version date

	  mod_ldap bzr r66:   fix reversed logic when keeping server/port
	  settings for	 non-ldap_initialize() SDKs.

	  mod_ldap bzr r65:   looks like ldap_{initialize,unbind_ext_s} are
	  openldap-specific. spleunk in   the openldap cvs repo and only
	  use these functions when building against   openldap and the
	  vendor version is at least that in which each of these
	  functions was introduced.

	  mod_ldap bzr r64:   id tag doesn't make much sense with bazaar,
	  but we'll keep it there for	when mod_ldap is committed to
	  proftpd cvs

2009-10-12 16:11  castaglia

	* modules/mod_lang.c:
	  When a locale is set, make sure to set it for the LC_COLLATE,
	  LC_CTYPE, and LC_MONETARY categories as well.

2009-10-07 13:38  castaglia

	* NEWS, modules/mod_auth_unix.c:
	  Bug#3300 - Support disabling use of S_RLOGIN when calling AIX
	  loginrestrictions().

2009-10-07 11:37  castaglia

	* doc/contrib/mod_sftp.html:
	  Add a little more description of the sftpUTF8ProtocolVersion
	  config setting.

2009-10-06 08:44  castaglia

	* doc/howto/ServerType.html:
	  Add a FAQ about another cause of slow/timed out logins.

2009-10-05 16:26  castaglia

	* contrib/mod_sql.c:
	  Add more info to the mod_sql logs when handling (and looking up)
	  named queries.

2009-10-05 15:52  castaglia

	* contrib/mod_sql.c:
	  When processing named queries, log the named query being
	  processed.

2009-10-05 15:47  castaglia

	* contrib/: mod_shaper.c, mod_rewrite.c:
	  Quell compiler warnings.

2009-10-05 15:23  castaglia

	* modules/mod_lang.c:
	  Prevent segfault on second SIGHUP because the lang_aliases table
	  was allocated out of a pool which no longer exists.  The fix is
	  simple: when the memory pool is cleared, make sure to reset the
	  lang_aliases pointer as well.

2009-10-05 14:21  castaglia

	* modules/mod_core.c:
	  Just to be defensive, make sure that the EISDIR errno value
	  exists before using it.

2009-10-05 14:07  castaglia

	* modules/mod_core.c, tests/t/lib/ProFTPD/Tests/Commands/DELE.pm:
	  If a client tries to use DELE to remove a directory, return a
	  better error message than "Opermation not permitted", i.e. use
	  EISDIR.

2009-10-05 13:57  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_file.pm:
	  Uncomment line to delete log file.

2009-10-05 09:59  castaglia

	* src/main.c:
	  Fix the settings displayed so that we show either ncurses or
	  ncursesw, but not both (related to Bug#3213).

2009-10-05 09:52  castaglia

	* contrib/mod_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  If the %T variable is used in a SQLLog query, AND the command in
	  question uses session.xfer.p BUT does not involve a data transfer
	  (e.g. RNFR), then a bad time value would be used.  Fix this.

2009-10-04 18:06  castaglia

	* modules/mod_facts.c:
	  The recent change to using pr_response_add() for the MLST
	  response lines means that we no longer need to explicitly add a
	  leading space; that is handled automatically in the Response API.

2009-10-04 12:52  castaglia

	* NEWS, src/scoreboard.c, utils/ftptop.c:
	  Bug#3214 - ftpwho/ftptop truncate UTF8 strings due to byte,
	  versus character, lengths.

2009-10-04 12:51  castaglia

	* configure:
	  Updated configure (for Bug#3213).

2009-10-04 12:47  castaglia

	* NEWS, config.h.in, configure.in, src/main.c:
	  Bug#3213 - Use locale-sensitive libncursesw library for ftptop
	  where available.

2009-10-03 17:54  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add unit test for the iPAddressRequired TLSOption.

2009-10-03 17:41  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add a unit test demonstrating that when an FTPS client offers a
	  cert, and the StdEnvVars TLSOption is used, the expected
	  TLS_CLIENT_ environment variables are populated.

2009-10-03 17:23  castaglia

	* modules/mod_log.c:
	  When parsing any potential log class names in an ExtendedLog
	  directive, parse the names at parse time, rather than at
	  connection time.  This way if there are unknown names configured,
	  we can flag it as a configuration error, rather than (relatively)
	  silently logging and ignoring the misconfiguration.

2009-10-03 12:46  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add a unit test for the StdEnvVars TLSOption.

2009-10-03 12:35  castaglia

	* modules/mod_log.c:
	  Fix a minor bug where mod_log would skip a character if the
	  LogFormat looked like a variable, but was in fact not one.  (I
	  tried using "%{env:FOO}" instead of "%{FOO}e", and noticed that a
	  character was being skipped in the handling of that
	  "%{env:FOO}".)

2009-10-03 12:03  castaglia

	* modules/mod_log.c:
	  Found a potential NULL pointer dereference when handling the
	  ExtendedLog directive; added some signal handling and clarified
	  the code while I was there.

2009-10-03 09:35  castaglia

	* contrib/mod_sql_passwd.c:
	  Quell compiler warnings, too.

2009-10-03 09:34  castaglia

	* contrib/mod_sql_passwd.c:
	  Typo.

2009-10-02 16:38  castaglia

	* NEWS, contrib/mod_ban.c, modules/mod_auth.c, src/main.c,
	  src/scoreboard.c, tests/t/lib/ProFTPD/Tests/Modules/mod_ban.pm:
	  Bug#3281 - TimeoutLogin not handled properly by mod_ban.

2009-10-02 14:26  castaglia

	* RELEASE_NOTES, doc/contrib/mod_sql.html:
	  Update docs to reflect Bug#3290.

2009-10-02 14:22  castaglia

	* NEWS, contrib/mod_sql.c, contrib/mod_sql.h,
	  contrib/mod_sql_mysql.c, contrib/mod_sql_odbc.c,
	  contrib/mod_sql_postgres.c, contrib/mod_sql_sqlite.c:
	  Bug#3290 - Change default mod_sql connection policy to open
	  database connection on first use.

2009-10-01 14:38  castaglia

	* doc/contrib/mod_ban.html:
	  Forgot to mention MaxLoginAttempts as one of the events handled
	  by BanOnEvent.

2009-10-01 09:18  castaglia

	* doc/contrib/mod_quotatab.html:
	  Clarify the string to which a configured QuotaExcludeFilter is
	  applied.

2009-10-01 09:13  castaglia

	* NEWS, contrib/mod_quotatab.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Bug#3298 - QuotaExcludeFilter directive ignored by mod_quotatab.

2009-10-01 08:45  castaglia

	* doc/contrib/mod_quotatab.html:
	  Typo.

2009-10-01 08:25  castaglia

	* contrib/mod_sql_passwd.c, doc/contrib/mod_sql_passwd.html,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_passwd.pm:
	  While thinking about the salt last night, I decided that using
	  "prepend" vs "append" as the config parameter names are a little
	  clearer than "prefix" vs "suffix".  Time and users will tell how
	  wise/clueless this was.

2009-09-30 17:33  castaglia

	* locale/files.txt:
	  Remove a few duplicates (caused by symlinks and a working copy)
	  from the list.

2009-09-30 17:26  castaglia

	* locale/: Makefile.in, files.txt:
	  Updated locale/files.txt.

2009-09-30 17:12  castaglia

	* contrib/mod_rewrite.c:
	  Quell compiler warning.

2009-09-30 15:23  castaglia

	* doc/contrib/mod_sql_passwd.html:
	  Provide an example config using a salt file in the Usage section.

2009-09-30 15:21  castaglia

	* contrib/mod_sql_passwd.c:
	  Fix bad grammar in a comment.

2009-09-30 15:18  castaglia

	* contrib/mod_sql_passwd.c, doc/contrib/mod_sql_passwd.html,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_passwd.pm:
	  Make the use of a salt configurable in terms of whether the salt
	  is used as a prefix or a suffix of the data to be hashed.

2009-09-30 14:05  castaglia

	* doc/contrib/mod_sql_passwd.html:
	  Document the SQLPasswordSaltFile directive.

2009-09-30 13:51  castaglia

	* contrib/mod_sql_passwd.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_passwd.pm:
	  Add a SQLPasswordSaltFile directive to the new mod_sql_passwd
	  module; it is used to configure salts for the hashed passwords
	  that mod_sql_passwd handles.	Doc update coming next.

2009-09-30 11:03  castaglia

	* contrib/mod_tls.c:
	  Make sure that mod_tls does not cleanup OpenSSL if mod_sql_passwd
	  is in use.

2009-09-29 14:46  castaglia

	* NEWS, contrib/mod_quotatab.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Bug#3296 - mod_quotatab should reject an upload via APPE if the
	  quota is already exceeded.

2009-09-29 13:53  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/CWD.pm:
	  Update regression test function names to match the names listed.

2009-09-29 13:50  castaglia

	* NEWS, src/fsio.c:
	  Bug#3297 - Symlinks to directories which end in trailing slashes
	  may not be handled properly.

2009-09-29 13:49  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/CWD.pm:
	  Regression tests for Bug#3297.

2009-09-29 10:09  castaglia

	* doc/howto/Timestamps.html:
	  Attempt to highlight that unexpected timestamps in directory
	  listings are affected by the TimesGMT directive, not by chrooted
	  processes.

2009-09-28 14:27  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#3295 - proftpd segfaults when STAT is used with ListOptions
	  "-1".

2009-09-28 14:24  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Commands/STAT.pm,
	  t/commands/stat.t:
	  Adding unit tests for the STAT command.

2009-09-28 14:22  castaglia

	* modules/mod_auth.c:
	  If we have trouble resolving the chroot path, make sure we log
	  the reason why.

2009-09-28 13:38  castaglia

	* contrib/mod_sftp/scp.c:
	  Some SCP clients will quote the paths they send in their scp
	  command, on the assumption that the handling server will use a
	  shell for the scp command, and that shell will Do The Right
	  Thing(tm) with regard to quoting.  This is not the case for
	  mod_sftp, so we have to try to detect and remove such quotations
	  ourselves.

2009-09-28 11:55  castaglia

	* contrib/mod_sftp/fxp.c:
	  When handling an OPEN SFTP request, mod_sftp was not getting the
	  "best" path for the requested path.  This meant that mod_sftp was
	  using the relative path provided by the client as-is -- and the
	  FSIO API assumes that the requested paths will be absolute paths.
	  (This change is needed for mod_md5 to work properly when SFTP is
	  used.)

2009-09-28 10:07  castaglia

	* contrib/mod_sftp/crypto.c:
	  Update the 3des-ctr implementation to use OpenSSL's
	  DES_encrypt3() function, which does the encrypt-decrypt-encrypt
	  cycle in a single function.

2009-09-26 16:52  castaglia

	* contrib/mod_sftp/crypto.c:
	  Make the 3des-ctr cipher work properly on big-endian machines.
	  Turns out that OpenSSL's DES_encrypt1() function (which seems to
	  be the one necessary to use in order to be interoperable with
	  PuTTy's 3des-ctr cipher implementation) expects to operate on
	  *little-endian data*.  On a little-endian machine, this happens
	  automatically.  But on big-endian machines, we need to swap the
	  bytes of the data -- and the usual ntohl() functions don't work
	  on big-endian machines (they're no-ops).  So I had to use my own
	  byte-swapping function, and add a test for the machine
	  endian-ness.

2009-09-24 17:42  castaglia

	* doc/contrib/mod_sftp.html:
	  Mention the 3des-ctr cipher in the SFTPCiphers doc.

2009-09-24 17:25  castaglia

	* contrib/mod_sftp/: crypto.c, mod_sftp.h.in:
	  Add support for the 3des-ctr cipher; tested using PuTTy-0.60.

2009-09-23 09:19  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/MLST.pm:
	  Add unit test for the MLST command using an example of Greek
	  letters, from one of the online forums threads.

2009-09-23 09:01  castaglia

	* RELEASE_NOTES:
	  Mention custom HiddenStores prefixes in the release notes.

2009-09-23 09:00  castaglia

	* NEWS, modules/mod_xfer.c,
	  tests/t/lib/ProFTPD/Tests/Config/HiddenStores.pm:
	  Bug#3294 - Support configurable HiddenStores prefixes.

2009-09-22 09:23  castaglia

	* contrib/mod_sftp/crypto.c:
	  Fixed the Blowfish CTR code to handle endianness issues; now I
	  can use the "blowfish-ctr" cipher using PuTTy-0.60 on my Intel
	  machine.

2009-09-21 16:50  castaglia

	* src/inet.c:
	  Pre-emptively update the code for Mac OSX 10.6 machines.

2009-09-21 15:55  castaglia

	* modules/mod_facts.c:
	  Use pr_response_add() instead of pr_response_send_raw(), and let
	  the Response API handle the multi-line formatting of the
	  response, rather than having to do it ourselves in mod_facts.

2009-09-21 14:06  castaglia

	* src/main.c:
	  In the `proftpd -V' output, use two different strings to
	  differentiate between the cases where uname(2) is not available
	  on the platform, and where uname(2) returns an error for some
	  reason (e.g. EPERM on virtualized servers).

2009-09-18 14:15  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Cut-n-pasto.

2009-09-17 14:33  castaglia

	* tests/: tests.pl, t/config/limit/anonymous.t,
	  t/lib/ProFTPD/Tests/Config/Limit/Anonymous.pm:
	  Add some unit tests for an <Anonymous> configuration using <Limit
	  WRITE>; a forums post suggested that the limit might not be being
	  applied as expected.

2009-09-17 13:54  castaglia

	* doc/howto/Chroot.html:
	  Add FAQ about using multiple DefaultRoot directives at the same
	  time.

2009-09-17 10:30  castaglia

	* contrib/mod_sftp/crypto.c:
	  Disable the blowfish-ctr cipher for now.  It appeared to work
	  properly last night on my PPC Mac OSX 10.4 box, but this morning
	  on my Ubuntu 9.04 Intel machine, it doesn't.	I suspect
	  endian-ness issues.

2009-09-17 10:16  castaglia

	* contrib/mod_sftp/mod_sftp.h.in:
	  Forgot to include the blowfish header.

2009-09-16 22:57  castaglia

	* doc/contrib/mod_sftp.html:
	  Make sure that blowfish-ctr is listed in the docs.

2009-09-16 22:54  castaglia

	* contrib/mod_sftp/crypto.c:
	  Add support for the blowfish-ctr cipher from RFC4344.

2009-09-16 20:57  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Add support for issuing the HOST command in the testsuite client.

2009-09-16 13:51  castaglia

	* contrib/mod_sftp/: cipher.c, keys.c, mac.c:
	  Clean up some minor compiler warnings.

2009-09-16 13:47  castaglia

	* contrib/mod_sftp/cipher.c:
	  Some ciphers do not have IVs (e.g. RC4); make sure to handle this
	  case properly.  (Without this, I was seeing strange memory
	  corruption/errors.)

2009-09-16 10:26  castaglia

	* NEWS, contrib/mod_sftp/cipher.c, contrib/mod_sftp/crypto.c,
	  contrib/mod_sftp/crypto.h, contrib/mod_sftp/mod_sftp.c:
	  Bug#3293 - SFTPCipher arcfour256 does not work properly.

2009-09-16 09:32  castaglia

	* src/privs.c:
	  Make the "SETUP PRIVS" log message be at DEBUG9, like the other
	  debug log messages generated when manipulating privs.

2009-09-16 08:09  castaglia

	* NEWS, contrib/mod_sftp/crypto.c:
	  Fix bug in mod_sftp's handling of AES CTR ciphers when an OpenSSL
	  version between 0.9.7a and 0.9.7d is used; those versions of
	  OpenSSL had buggy handling of the IV for the AES CTR (i.e. the IV
	  was not handled in a big-endian fashion).

2009-09-15 23:18  castaglia

	* contrib/mod_sftp/crypto.c:
	  Pedantic comment typo correction.

2009-09-15 23:12  castaglia

	* configure:
	  Updated configure.

2009-09-15 23:09  castaglia

	* Make.rules.in, configure.in, contrib/mod_sftp/Makefile.in:
	  Create an ADDL_CPPFLAGS variable in Make.rules, specifically so
	  that contrib modules' Makefiles (for those contrib modules which
	  have their own Makefile) can use any CPPFLAGS that may have been
	  specified via environment variable.  Without this new variable, a
	  contrib module Makefile would end up having duplicated/redundant
	  CPPFLAGS values, or wouldn't have those CPPFLAGS propagated
	  properly for the contrib module code.

2009-09-15 17:12  castaglia

	* contrib/mod_sftp/: cipher.c, mac.c:
	  Minor adjustment to the debug logging of packet dumps, so that
	  they are easier to pick out of the SFTPLog file.

2009-09-15 16:18  castaglia

	* modules/mod_core.c, src/dirtree.c, src/modules.c:
	  Various stylistic cleanups generated while pursuing strange
	  segfault.

2009-09-15 16:10  castaglia

	* src/auth.c:
	  The previous change to populate the pool and tmp_pool fields for
	  the cmd_rec that's dispatched to Auth callbacks had subtle and
	  bad side effects.  Instead of using the given pool as that pool,
	  create a subpool.

2009-09-15 08:17  castaglia

	* src/auth.c:
	  Make sure that cmd->pool and cmd->tmp_pool are not NULL for the
	  cmd_rec that is dispatched for the Auth callbacks.

2009-09-14 23:28  castaglia

	* tests/t/: commands/host.t, lib/ProFTPD/Tests/Commands/HOST.pm:
	  Start working on unit tests for the HOST command, as part of
	  Bug#3289.

2009-09-14 13:44  castaglia

	* src/session.c:
	  When marking a session as idle, make sure that session.user is
	  non-NULL; if not, using "(authenticating)".

2009-09-14 11:58  castaglia

	* src/dirtree.c, tests/t/lib/ProFTPD/Tests/Config/Limit/Filters.pm:

	  Set the errno appropriately for implicit denies.

2009-09-14 10:46  castaglia

	* doc/howto/Filters.html:
	  Add example config for using AllowFilter to only allow specific
	  filename extensions in a directory.

2009-09-14 10:15  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Limit/Filters.pm:
	  Fix the broken AllowFilter unit test.  To make this particular
	  config work, the Order directive is needed.

2009-09-11 22:05  castaglia

	* modules/mod_dso.c:
	  Add more trace logging to help debug failed loading of DSO
	  modules where the module symbol does not match the expected
	  symbol name.

2009-09-09 16:44  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Limit/Filters.pm:
	  Add a unit test for the AllowFilter functionality that is
	  <Limit>-section specific.  This unit test tests the STOR command,
	  and a <Limit> section within a <Directory> section -- and the
	  test fails.  So I still need to fix this before releasing
	  1.3.3rc2.

2009-09-09 16:27  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Looks like newer libssh2 versions have addressed some issues,
	  though not all.

2009-09-09 14:15  castaglia

	* doc/contrib/mod_sql_passwd.html:
	  Be sure to list the additional SQLAuthTypes provided by
	  mod_sql_passwd.

2009-09-09 11:47  castaglia

	* RELEASE_NOTES, doc/contrib/mod_sql_passwd.html:
	  Adding documentation for mod_sql_passwd.

2009-09-09 11:45  castaglia

	* doc/contrib/mod_sql.html:
	  Adding the required notice for using OpenSSL.

2009-09-09 11:22  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_sql_passwd.pm,
	  t/modules/mod_sql_passwd.t:
	  Added unit tests for the mod_sql_passwd module.

2009-09-09 11:17  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql.c, contrib/mod_sql.h,
	  contrib/mod_sql_passwd.c:
	  Bug#2368 -  Allow contrib modules to extend mod_sql's
	  SQLAuthTypes.  This also includes a new mod_sql_passwd contrib
	  module which can handle hex- and base64-encoded MD5 and SHA1
	  passwords, without the leading "{digest}" prefix required by the
	  mod_sql OpenSSL SQLAuthType.

2009-09-08 13:48  castaglia

	* contrib/mod_sftp/auth.c:
	  Add trace logging of the list of SSH2 authentication methods that
	  are offered to the client.

2009-09-08 13:39  castaglia

	* contrib/mod_sftp_pam.c:
	  Remove the mod_auth_pam module from the auth-only module list
	  before we add mod_sftp_pam to that list, to ensure that
	  mod_sftp_pam is the module that is used.

2009-09-08 13:35  castaglia

	* modules/mod_auth.c:
	  Clear the auth-only module list after authentication has
	  succeeded.

2009-09-08 13:34  castaglia

	* include/auth.h, src/auth.c:
	  Add functions for removing a module from the auth-only module
	  list, and for clearing the entire auth-only module list.

2009-09-08 11:39  castaglia

	* src/bindings.c:
	  The fix for Bug#2680 checks for DefaultServer too early; we want
	  to check for any INADDR_ANY vhosts first, before resorting to
	  using the DefaultServer (if configured).

2009-09-08 10:38  castaglia

	* contrib/mod_sftp/utf8.c:
	  Simply mod_sftp's UTF8 handling code, bringing it in sync with
	  the recent changes to the core Encode API.  Specifically, do NOT
	  call setlocale(), as it is already done elsewhere.  Also, use the
	  new pr_encode_get_local_charset() instead of duplicating code
	  from the Encode API.

2009-09-08 10:28  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_lang.pm:
	  Add unit tests to ensure than the use of ".UTF-8" aliases work
	  properly for the LangDefault directive (and thus, by extension,
	  for the LANG command).

2009-09-08 10:25  castaglia

	* modules/mod_lang.c:
	  Skip the "." and ".." directory entries when scanning the
	  LangPath directory.

2009-09-07 15:21  castaglia

	* NEWS:
	  Forgot to update the NEWS file.

2009-09-07 15:20  castaglia

	* src/inet.c:
	  Don't re-declare a variable that's already in scope.

	  Be paranoid, and only avoid ENOPROTOOPT errors if that errno is
	  actually defined on the system.

2009-09-07 15:17  castaglia

	* src/inet.c:
	  Needed to revert the fix for Bug#3237, as it was causing a
	  regression on FreeBSD.  Instead, I opted to ignore the
	  ENOPROTOOPT error, which was the original cause of the reporting
	  of Bug#3237.

2009-09-06 19:03  castaglia

	* contrib/mod_quotatab.c:
	  Quell a few compiler printf warnings by using explicit typecasts.

2009-09-06 18:37  castaglia

	* include/encode.h, modules/mod_lang.c, src/encode.c, src/main.c:
	  Bug#3229 - LangDefault does not accept any setting on FreeBSD.

	  There were multiple issues involved in this one.  First, mod_lang
	  needed to handle setlocale(3) where the translated files shipped
	  with proftpd (which do not have ".UTF-8" in their names) did not
	  match the languages accepted by setlocale() on the platform (e.g.
	  where setlocale() expected names which *did* end in ".UTF-8");
	  this is handled by populating a table of language aliases.

	  Second, the initial setlocale(LC_ALL, "") call, to pick up/honor
	  the various environment variables as one would expect from a Unix
	  program, was happening in quite a few places in mod_lang.  Not
	  good.  So this was moved into the main() function, as part of the
	  initial startup.  And yes, it does check that the setlocale()
	  function call succeeds, and warns about badly configured
	  environment variables if not.

	  Last, we had to always set the LANG environment variable, in
	  order to ensure that gettext used the translated files of the
	  language to which we had switched.  While the old code would work
	  on Linux (and on Solaris...I think), it would NOT work on FreeBSD
	  (and possibly other BSD-related platforms).  It was a long
	  arduous slog to finding that using LANG was required.  Ugh.

2009-09-06 18:24  castaglia

	* contrib/mod_sql_mysql.c:
	  In the midst of investigating/fixing Bug#3229, I found out why
	  MySQL never seemed to use anything other than 'latin1' as its
	  character set name.  Mostly it was due to bugs in the proftpd
	  Encode API, but it was also partly caused by an API impedance
	  mismatch in mod_sql_mysql.  This change fixes that (and yes, I've
	  tested it using a UTF-8 language setting, and saw that MySQL
	  reported using a 'utf8' character set).

2009-09-04 22:39  castaglia

	* src/encode.c:
	  Need to set the LC_NUMERIC locale back to "C" after calling
	  setlocale() using LC_ALL.

2009-09-04 22:35  castaglia

	* src/encode.c:
	  Make sure we do an explicit setlocale() call before calling
	  nl_langinfo().  This needs to happen in the parent/daemon process
	  (i.e. when encode_init() is first called), since the child
	  processes will inherit the pointers in memory to the retrieved
	  nl_langinfo string.

2009-09-04 15:26  castaglia

	* doc/howto/ConfigFile.html:
	  Specifically mention that proftpd switches to the UID/GID of the
	  logged-in user.

2009-09-04 15:02  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_lang.pm:
	  Add unit test proving that the FEAT output does not include UTF8
	  if the LangEngine directive is set to 'off'.

2009-09-04 15:01  castaglia

	* src/encode.c:
	  Fix segfault found by the mod_lang unit tests.

2009-09-04 10:16  castaglia

	* RELEASE_NOTES:
	  Update release notes with note about scoreboard format change;
	  need to expand on this at release time, of course.

2009-09-04 10:13  castaglia

	* NEWS, contrib/mod_sftp/auth.c, contrib/mod_sftp/mod_sftp.c,
	  contrib/mod_sftp/scp.c, include/scoreboard.h, modules/mod_auth.c,
	  src/scoreboard.c, src/session.c, utils/ftptop.1.in,
	  utils/ftptop.c, utils/ftpwho.c, utils/utils.h:
	  Bug#2013 - Track RFC2228 sessions in scoreboard.  The scoreboard
	  entry format now has a 'protocol' field, for tracking 'ftp' and
	  'ftps'.

	  Bug#3286 - Client command field in scoreboard entry too short for
	  SSH2/SFTP commands.

	  These changes are combined in one change, in order to rev the
	  scoreboard format version only once for these format changes.

2009-09-02 15:30  castaglia

	* contrib/mod_sftp/scp.c:
	  When handling SCP uploads/downloads, be sure to update the
	  scorboard entry appropriately.  Since SCP doesn't have "commands"
	  or "requests" (unlike FTP and SFTP), the scoreboard entry is
	  updated with the quasi-commands "SCP_RETR" and "SCP_STOR".

2009-09-02 11:13  castaglia

	* contrib/mod_sftp/packet.c:
	  Fix the logic for determining the random length of data to read,
	  after a packet has been determined to be malformed.

2009-09-02 10:58  castaglia

	* contrib/mod_sftp/auth.c, contrib/mod_sftp/packet.c,
	  include/proftpd.h, include/session.h, modules/mod_auth.c,
	  src/data.c, src/main.c, src/session.c:
	  Move the session_set_idle() into the session.c file, and make it
	  a pr_ function.  This also updates mod_sftp to automatically mark
	  the session as "idle" whenever it is waiting to read the next
	  SSH2 message.

2009-09-01 11:39  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#3287 - MaxTransfersPerHost, MaxTransfersPerUser directives
	  not supported properly.

2009-09-01 10:18  castaglia

	* doc/contrib/mod_sftp.html:
	  Add SFTP FAQ about CBC cipher mode attacks.

2009-09-01 10:04  castaglia

	* contrib/mod_sftp/: mod_sftp.h.in, packet.c, ssh2.h:
	  Implement the recommended countermeasure for mitigating the SSH2
	  plaintext recovery attack against CBC mode ciphers described in
	  CPNI-957037:

	    http://www.cpni.gov.uk/Docs/Vulnerability_Advisory_SSH.txt

	  This also fixes a redeclaration of the SFTP_MAX_PACKET_LEN macro
	  (it was being defined in both mod_sftp.h and ssh2.h).

2009-08-31 13:40  castaglia

	* doc/howto/Controls.html:
	  Updating URLs and such in Controls howto.

2009-08-31 11:47  castaglia

	* contrib/mod_sftp/packet.c:
	  Handle ESHUTDOWN, and add a comment about why we disconnect the
	  client for these errors, rather than sending a DISCONNECT message
	  first.

2009-08-31 11:43  castaglia

	* contrib/mod_sftp/packet.c:
	  Handle a few more types of errors that we might encounter while
	  reading from a socket.

2009-08-30 11:49  castaglia

	* src/session.c:
	  Getting ready to support the "publickey" SSH2 subsystem
	  (RFC4819).

2009-08-28 10:33  castaglia

	* NEWS, RELEASE_NOTES, src/dirtree.c:
	  Bug#3279 - .ftpaccess configurations not merged properly with
	  existing configuration.

2009-08-28 09:20  castaglia

	* contrib/mod_sftp/mod_sftp.c:
	  Be a little clearer in the TOO_MANY_CONNECTIONS disconnect
	  message (but do NOT necessarily specify exactly whether it is too
	  many connections for the user, or the host...we don't want to
	  leak too much information).

2009-08-28 09:14  castaglia

	* contrib/mod_sftp/disconnect.c, contrib/mod_sftp/disconnect.h,
	  contrib/mod_sftp/mod_sftp.c, modules/mod_auth.c:
	  Make sure that mod_sftp registers event listeners for the various
	  MaxClients and MaxConnections directive.  That way, just before
	  mod_auth breaks the TCP connection, mod_sftp can send an SSH2
	  message to the client about the reason for the disconnection.

2009-08-28 07:50  castaglia

	* doc/contrib/mod_sftp.html:
	  Typos, updating wording about channel window sizes (I now know
	  why SSH2 has its own built-in flow control mechanisms, in
	  addition to TCP's flow control).

2009-08-27 11:46  castaglia

	* src/inet.c:
	  Update the copyright year range, since we just updated this file.

2009-08-27 11:45  castaglia

	* NEWS, src/inet.c:
	  Bug#3284 - Slower transfers of multiple small file transfers
	  after upgrade from 1.3.0a to 1.3.2a.

2009-08-27 11:38  castaglia

	* NEWS, src/inet.c:
	  Bug#3284 - Slower transfers of multiple small file transfers
	  after upgrade from 1.3.0a to 1.3.2a.

2009-08-26 10:23  castaglia

	* contrib/mod_sftp/: channel.c, channel.h:
	  Make sure that we do NOT increase the window size above the max
	  possible window size of 2^32-1 bytes, as per RFC4254 Section 5.2.

2009-08-25 22:23  castaglia

	* contrib/mod_sftp/: packet.c, tap.c, tap.h:
	  Make sure that if a TAP packet is sent, it appears in the same
	  TCP packet as the following "real" packet when possible.  I.e.
	  make sure that the data for both the TAP packet and the real
	  packet appear in the same writev(2) call, rather than having
	  separate writev(2) calls (which ends up being separate TCP
	  packets, which negates the whole purpose of trying to mitigate
	  TCP traffic analysis via TAP packets).

2009-08-25 09:59  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/STOR.pm:
	  Add unit test showing that using STOR to upload a file whose name
	  contains multiple consecutive periods does indeed work as
	  expected.  A user in the online forums is having an issue with
	  this scenario; I suspect it is due to something in the
	  proftpd.conf.

2009-08-25 08:59  castaglia

	* contrib/mod_sftp/: kex.c, tap.c, tap.h:
	  Rename the 'cbc-mode' TAP policy to 'rogaway', to be more clear
	  (and interesting).

2009-08-24 22:07  castaglia

	* contrib/mod_sftp/: kex.c, mod_sftp.c, tap.c, tap.h:
	  Protect against the Rogaway CBC mode attack (see RFC4251, Section
	  9.3.1) by sending IGNORE messages before every outgoing message
	  if a CBC mode cipher is chosen for server-to-client messages.

2009-08-24 17:24  castaglia

	* contrib/mod_sftp/scp.c:
	  Adding comment/note to myself for future tweaking.

2009-08-23 19:16  castaglia

	* contrib/mod_sftp/: channel.c, channel.h, scp.c:
	  Fix a rather egregious bug in the SCP download code.	We were
	  reading the entire file being downloaded into memory, and sending
	  (or buffering) the data for it BEFORE returning back to handling
	  any messages which may have been sent by the client while we were
	  reading.  If the file is larger than the default/initial window
	  size, then we end up buffering.  We only drain that buffered data
	  once the file had been read in its entirety, and we go back and
	  handle any WINDOW_ADJUST messages, which then open the window
	  again and we can drain our data.

	  Now imagine if that file is large, say, >4GB.  The client sends
	  its WINDOW_ADJUST messages, but mod_sftp never gets around to
	  listening to them for quite a while.	Not good.  The fix, then,
	  is to have the SCP download code check the window size
	  periodically.  If the window closes, then handle enough messages
	  from the client until the window opens again.

2009-08-23 16:58  castaglia

	* src/pidfile.c:
	  In the mod_sftp unit test for handling SIGTERM, I noticed that
	  one of the configured SFTPHostKey files kept disappearing (as in,
	  being deleted) once the server was shut down.  Another mod_sftp
	  user has reported seeing the same symptoms, only intermittently.
	  I was finally able to track down the cause.

	  Turns that the PidFile handling code was not being very careful
	  about making sure that the static pidfile_path pointer kept
	  pointing to the same memory.	The pointer used for looking up the
	  PidFile directive was the same pointer; and if the lookup
	  failed/changed, the pointer could change.  And, say, point at
	  some other file.  Then, when the server shut down and deleted its
	  PidFile, well, that other file might be deleted.  Not desirable
	  behavior.

2009-08-21 19:57  castaglia

	* contrib/mod_sftp/channel.c:
	  When mod_sftp is calculating the amount of data it can send in
	  CHANNEL_DATA messages, it was taking the 9 bytes of header data
	  (packet type, channel ID, payload len) into account when it
	  should not.  For very large data transfers, it means that
	  mod_sftp's idea of the open channel window size could get out of
	  sync with the client.  And if the client didn't send a
	  WINDOW_ADJUST message in time, it could lead to deadlock.  Let's
	  hope this fixes that deadlock situation.

2009-08-19 14:20  castaglia

	* contrib/mod_sftp/auth.c:
	  The mod_sftp module was looking up any DefaultChdir config
	  directive, but was not honoring it properly.

2009-08-19 14:18  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add unit test for DefaultChdir config in mod_sftp.

2009-08-19 11:30  castaglia

	* NEWS, contrib/mod_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Bug#3282 - With "SQLNegativeCache on", mod_sql will look up wrong
	  cached user value for subsequent USER commands.

2009-08-14 19:55  castaglia

	* tests/: tests.pl, t/config/ftpaccess/merging.t,
	  t/lib/ProFTPD/Tests/Config/FTPAccess/Empty.pm,
	  t/lib/ProFTPD/Tests/Config/FTPAccess/Merging.pm:
	  Adding unit tests derived from investigations into Bug#3279.

2009-08-14 19:43  castaglia

	* src/dirtree.c:
	  Sigh; fix the spacing in these HideFiles log messages again.

2009-08-14 18:57  castaglia

	* modules/mod_ls.c:
	  The tweaks to mod_ls' option parsing code for Bug#3268 were not
	  quite sufficient; they would cause erroneous errors (e.g. on PPC
	  machines) in some cases.

2009-08-14 08:46  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Add another unit test related to Bug#3276, this one demonstrating
	  that "HideFiles none" works as expected.

2009-08-14 07:36  castaglia

	* src/dirtree.c:
	  Fix the spacing of the log messages about negated (or not)
	  HideFiles directives.

2009-08-13 14:31  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Add another unit test for Bug#3276, this one using DefaultRoot
	  and a LIST command which doesn't specify the target directory
	  (i.e. list the current directory).

2009-08-13 14:12  castaglia

	* NEWS, contrib/mod_radius.c, modules/mod_xfer.c, src/data.c:
	  Bug#3278 - Aborted data transfers not reflected in RADIUS
	  accounting.

2009-08-13 13:54  castaglia

	* tests/t/: lib/ProFTPD/Tests/Modules/mod_radius.pm,
	  modules/mod_radius.t:
	  Add unit tests for mod_radius.  I won't add these to the default
	  testsuite (i.e. when mod_radius is enabled in the built proftpd),
	  since they currently require that you're running a RADIUS server
	  (e.g. FreeRADIUS).  But these help for when I need to work on
	  mod_radius.

2009-08-13 12:09  castaglia

	* contrib/mod_radius.c:
	  Fix compiler warnings about signedness mismatches.

2009-08-12 15:16  castaglia

	* modules/mod_core.c, src/dirtree.c:
	  Add some additional debug logging of handling of HideFiles
	  directive, and include the negation flag in the logging.
	  (Switched to using 'negated' rather than 'inverted'; the former
	  is more applicable, I think.)

2009-08-12 15:13  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Add HideFiles test using negation; used this test when
	  investigating a HideFiles issue reported on forums.proftpd.org
	  which is quite similar to Bug#3276.

2009-08-12 14:16  castaglia

	* doc/contrib/mod_sftp.html:
	  Remove mention of the GB/MB suffixes for channelPacketSize; this
	  size cannot exceed the protocol maximum of 35000 bytes.

2009-08-11 08:27  castaglia

	* doc/howto/Authentication.html:
	  Orthographic correction.

2009-08-10 10:05  castaglia

	* NEWS:
	  Had the bug number wrong; should be Bug#3252, not Bug#3272.

2009-08-10 10:01  castaglia

	* NEWS, src/fsio.c:
	  Bug#3272 - %F/%f Display variables can report wrong size on
	  64-bit systems.

2009-08-06 13:48  castaglia

	* contrib/mod_sftp/rfc4716.c:
	  Quibble, quibble.

2009-08-06 11:17  castaglia

	* contrib/mod_sftp/rfc4716.c:
	  Thinko.

2009-08-06 10:27  castaglia

	* contrib/mod_tls.c:
	  Add a function to get a printable version of a suspicious dNSName
	  value; related to Bug#3275.

2009-08-06 09:58  castaglia

	* NEWS, contrib/mod_tls.c,
	  tests/t/etc/modules/mod_tls/ca-nul-subjaltname.pem,
	  tests/t/etc/modules/mod_tls/cert-nul-subjaltname.pem,
	  tests/t/etc/modules/mod_tls/key-nul-subjaltname.pem,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Bug#3275 - Improper SSL/TLS certificate subjectAltName
	  verification.

2009-08-05 15:08  castaglia

	* src/encode.c:
	  When comparing the local and remote charsets, in some cases we
	  don't need to check for null pointers (already checked earlier in
	  the function in those cases), and in other cases we *do* need to
	  check for null pointers.

2009-08-05 15:03  castaglia

	* src/encode.c: [no log message]

2009-08-05 14:03  castaglia

	* modules/mod_lang.c:
	  Try to make for better, more informative error messages if we
	  fail to set the locale.

2009-08-05 10:31  castaglia

	* src/data.c:
	  We handle signals in pr_data_xfer() when writiing; we should do
	  the same when reading.

2009-08-05 08:07  castaglia

	* modules/mod_lang.c:
	  Declaring the curr_locale variable in the right scope helps to
	  make the code actually compile properly.

2009-08-05 06:34  castaglia

	* modules/mod_lang.c:
	  When scanning the LangPath directory, we don't need to
	  save/restore the current locale on each file found in the
	  directory.  Just do the save/restore once for the entire scan
	  loop.

2009-08-04 10:34  castaglia

	* doc/contrib/mod_sql.html:
	  Document the new "noReconnect" SQLOption added as part of
	  Bug#3270.

2009-08-04 10:32  castaglia

	* NEWS, contrib/mod_sql.c, contrib/mod_sql.h,
	  contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c:
	  Bug#3270 - Lost connections to databases not correctly handled.

2009-08-04 08:59  castaglia

	* NEWS, contrib/mod_sftp/utf8.c, src/encode.c:
	  Bug#3272 - Avoid encoding if to/from charsets are the same.

2009-08-04 08:53  castaglia

	* NEWS, src/support.c:
	  Bug#3274 - Timestamp formatting in TransferLog needs padded
	  day-of-month.

2009-08-02 15:08  castaglia

	* contrib/mod_sql_postgres.c:
	  Log the Postgres client version to the SQLLogFile, and log it at
	  the same time as we log the server version.  This will make
	  finding/reporting these versions easier.

2009-08-02 14:44  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Report on the database client and server versions, when known.

2009-07-30 09:03  castaglia

	* contrib/mod_sftp/fxp.c:
	  Fix compilation error on AIX5.

2009-07-29 13:59  castaglia

	* NEWS, modules/mod_ls.c, src/fsio.c,
	  tests/t/lib/ProFTPD/Tests/Commands/NLST.pm:
	  Bug#3254 - NLST/LIST and symbolic link problem.

2009-07-28 21:41  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/LIST.pm:
	  Add unit test for LIST command for Bug#3254.

2009-07-28 09:20  castaglia

	* contrib/mod_sftp/fxp.c:
	  Some errno values are defined to be the same on AIX, which is
	  causing mod_sftp not to compile properly:

	    http://forums.proftpd.org/smf/index.php/topic,3971.0.html

	  Hopefully this change works around the issue and still preserves
	  the desired functionality.

2009-07-27 08:29  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Fix unit test which broke due to changes in mod_sftp's SCP
	  support for the %F variable.	(The test code was broken, not the
	  source code.)

2009-07-27 08:25  castaglia

	* contrib/mod_sftp/channel.c:
	  Missed one change from the weekend's mod_sftp hacking.

2009-07-26 18:00  castaglia

	* contrib/mod_sftp/: channel.c, channel.h, fxp.c, fxp.h,
	  mod_sftp.h.in, scp.c, scp.h:
	  Added an API by which a module, outside of mod_sftp, can register
	  handlers for an 'exec' command.  This allows other modules to use
	  SSH2 as the transport, and to implement whatever logic they wish
	  outside of mod_sftp.	(There is an issue of code load order and
	  link-time symbol resolution; for now, I'm punting on this issue.)

2009-07-25 20:16  castaglia

	* contrib/mod_sftp/channel.c:
	  It's possible for an SSH2 client to open a channel, and then send
	  an 'exec' request which mod_sftp does not support.  We send a
	  failure message in such cases, but the channel remains open.	So
	  if the client ignores our error message and then sends channel
	  data to the exec'd command, well...the process might wander off
	  into the weeds.  Not desirable behavior.  To catch this case, we
	  simply need to make sure that a channel data handler has been
	  registered.  If not, reject the packet.

2009-07-24 10:31  castaglia

	* contrib/mod_sql.c:
	  To help find out why configurations may not work as expected, log
	  when we search for a SQLNamedQuery and don't find it.  I just saw
	  a config which had mismatched names between the configured
	  SQLNamedQuery, and the name used in a SQLShowInfo parameter.

2009-07-23 10:45  castaglia

	* modules/mod_delay.c:
	  Add a long explanatory comment about the DELAY_NPROTO value.
	  Also, the value of 4 was too high; we currently only support
	  three protocols in the DelayTable: ftp, ftps, and ssh2.  No need
	  to allocate empty rows in the table.

2009-07-23 08:18  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Fix the broken test for Bug#3164 by adding a slight delay, to
	  give our out-of-band update to the SQLite database time to be
	  applied.

2009-07-23 08:07  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Add unit test for handling of DELE in mod_quotatab.

2009-07-23 08:04  castaglia

	* doc/howto/Quotas.html:
	  Add another quota FAQ.

2009-07-23 07:37  castaglia

	* contrib/mod_rewrite.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Clean up dead code in mod_rewrite.c.	Check for bad/unknown
	  RewriteCondition flags, and handle them as a configuration error.

	  Add unit test for the "[NC]" RewriteCondition flags.

2009-07-22 20:11  castaglia

	* NEWS, contrib/mod_rewrite.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Bug#3269 - RewriteCondition OR/ornext flag does not work.

2009-07-22 19:34  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Add a unit test showing that mod_rewrite's handling of
	  RewriteConditions's OR flag is broken.

2009-07-22 14:37  castaglia

	* src/display.c:
	  Fix a regression in the 1.3.3rc1 code, where a DisplayConnect
	  file would be sent to the client -- and then an extra line with a
	  220 response code would be sent.  This, in addition to the 220
	  line with the normal banner.	The extra 220 response line was
	  confusing some clients (and rightly so).

2009-07-22 09:57  castaglia

	* modules/mod_delay.c:
	  Add paranoid check that an array pointer is non-null before we
	  use it.

2009-07-21 16:38  castaglia

	* contrib/mod_sql.c:
	  Add handling of signals in the loops which process the various
	  info directives (e.g. SQLShowInfo, SQLLog, etc).  Also use
	  check_response() more throughout the code; this function checks
	  for unrecoverable backend errors and -- depending on the config
	  -- will disconnect the session if such an error occurs.

2009-07-21 16:21  castaglia

	* contrib/mod_sql.c:
	  Make sure that mod_sql logs the corresponding "leaving func"
	  message in some cases; it wasn't doing so.

2009-07-21 15:20  castaglia

	* contrib/mod_sftp/scp.c:
	  Update the session.xfer.path field, when handling uploads via
	  SCP, when we have received enough information from the client to
	  know the full path.

2009-07-21 15:06  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  If mod_sftp is built using the RPM .spec file, then we need to
	  take into account some of the config files that mod_sftp includes
	  (e.g. blacklist.dat and dhparams.pem).

2009-07-21 15:01  castaglia

	* contrib/mod_sftp/mod_sftp.h.in:
	  Bump the mod_sftp version in CVS, to differentiate it from the
	  version of mod_sftp available on castaglia.org.  The CVS version
	  is vastly improved.

2009-07-21 09:26  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Attempt to add support for mod_sftp to the .spec file.

2009-07-21 08:47  castaglia

	* NEWS, RELEASE_NOTES, modules/mod_log.c,
	  tests/t/lib/ProFTPD/Tests/Logging/ExtendedLog.pm:
	  Bug#1908 - ExtendedLog to work properly in <Anonymous> context.

2009-07-20 21:58  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add a unit test for the %f/%F LogFormat variables when used for
	  an SCP upload; I'm trying to reproduce a reported issue when
	  using these variables and uploading via SCP, but to no avail as
	  yet.

2009-07-20 21:32  castaglia

	* NEWS, modules/mod_ls.c,
	  tests/t/lib/ProFTPD/Tests/Commands/LIST.pm,
	  tests/t/lib/ProFTPD/Tests/Commands/NLST.pm:
	  Bug#3268 - Files whose names start with whitespace are not listed
	  properly.

2009-07-20 17:25  castaglia

	* contrib/mod_sftp/fxp.c:
	  More explanatory comments, for my future reference.

2009-07-20 17:19  castaglia

	* contrib/mod_sftp/fxp.c:
	  Add comment describing the implementation of the RENAME handler,
	  and how it is technically nonconformant in particular cases.

2009-07-20 17:11  castaglia

	* contrib/mod_sftp/fxp.c:
	  Still trying to properly map the V5 OPEN flags/bitmasks to
	  open(2) flags.

2009-07-20 14:07  castaglia

	* contrib/mod_sftp/fxp.c, doc/contrib/mod_sftp.html:
	  The STAT, FSTAT, and LSTAT SFTP requests are no longer limited
	  when using <Limit READ>.  Instead, each of these requests can be
	  limited by using the request name directly.

2009-07-20 11:43  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add a unit test using the %s LogFormat variable for write
	  requests in an SFTP session; this complements the existing %s
	  LogFormat variable test for SFTP read requests.

2009-07-20 11:33  castaglia

	* contrib/mod_sftp/fxp.c:
	  Clear the response lists before dispatching the STOR cmd_rec when
	  handling aborted upload file handles in an SFTP session.

2009-07-20 11:22  castaglia

	* contrib/mod_sftp/fxp.c:
	  If the SFTP client left a directory handle open, then we need to
	  handle it as a *directory*, not as a file, in the aborted-handles
	  code.  Otherwise, segfaults will happen.

2009-07-20 08:41  castaglia

	* doc/contrib/mod_sftp.html:
	  Removed duplicated text.

2009-07-19 19:37  castaglia

	* contrib/mod_sftp/keys.c:
	  Update the handling of the SFTPPassPhraseProvider config with
	  tweaks found from working on mod_exec.

2009-07-19 18:13  castaglia

	* tests/tests.pl:
	  Add support for a --verbose command-line option to the tests.pl
	  testsuite driver.  Using --verbose will set the TEST_VERBOSE
	  environment variable.  This is particularly useful when running
	  the testsuite (or individual test files) as root using sudo; sudo
	  (depending on the version) prevents environment variables from
	  being communicated to the executed program.

2009-07-19 17:18  castaglia

	* NEWS, src/auth.c:
	  Bug#2070 - AuthAliasOnly off in <Global> section kills anonymous
	  logins.

2009-07-19 17:17  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_exec.pm:
	  Fix up minor issues in the test code found by the Perl
	  interpreter in strict mode.

2009-07-19 17:08  castaglia

	* tests/t/lib/ProFTPD/Tests/: Config/Limit/SubDirectories.pm,
	  Logging/ExtendedLog.pm:
	  Fix variable redeclarations, and soothe the savage Perl
	  interpreter beast.

2009-07-19 16:35  castaglia

	* tests/: tests.pl, t/config/authaliasonly.t,
	  t/lib/ProFTPD/Tests/Config/AuthAliasOnly.pm:
	  Add unit tests for the AuthAliasOnly directive, including a test
	  which reproduces Bug#2070.

2009-07-19 15:23  castaglia

	* tests/: tests.pl, t/config/authusingalias.t,
	  t/lib/ProFTPD/Tests/Config/AuthUsingAlias.pm:
	  Add unit tests for the AuthUsingAlias directive.

2009-07-19 14:24  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Utils/ftpwho.pm,
	  t/utils/ftpwho.t:
	  Start adding unit tests for the ftpwho utility.

2009-07-19 13:18  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Utils/ftpcount.pm,
	  t/utils/ftpcount.t:
	  Start of unit tests for the ftpcount utility.

2009-07-19 12:11  castaglia

	* contrib/mod_exec.c:
	  When executing the command and the 'useStdin' ExecOption has been
	  used, we should at least provide the first command-line argument,
	  which, by convention, is the name of the file being executed.

2009-07-19 12:07  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_exec.pm:
	  Add unit test for the ExecOnRestart directive.

2009-07-19 12:06  castaglia

	* contrib/mod_exec.c:
	  Add handling of signals to some while() loops.

2009-07-18 15:58  castaglia

	* contrib/mod_exec.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_exec.pm:
	  Added unit tests for the various ExecOptions values.	Along the
	  way, I found (and fixed) several bugs in mod_exec.  Three cheers
	  for testing!

2009-07-18 12:50  castaglia

	* doc/contrib/mod_exec.html:
	  Fix typos, update mod_exec doc to point to local copy of Logging
	  howto.

2009-07-18 12:38  castaglia

	* tests/: tests.pl, t/config/useglobbing.t,
	  t/lib/ProFTPD/Tests/Config/UseGlobbing.pm:
	  Add unit test for the UseGlobbing directive.

2009-07-18 12:29  castaglia

	* tests/: tests.pl, t/config/userpassword.t,
	  t/lib/ProFTPD/Tests/Config/UserPassword.pm:
	  Add unit test for the UserPassword directive.

2009-07-17 18:51  castaglia

	* doc/howto/TLS.html:
	  Update the TLS howto FAQ regarding implicit FTPS to reflect the
	  addition of implicit FTPS support (in Bug#3266).

2009-07-17 18:48  castaglia

	* NEWS, contrib/mod_tls.c, doc/contrib/mod_tls.html,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Bug#3266 - Support "implicit" FTPS.

2009-07-17 09:35  castaglia

	* modules/mod_dso.c:
	  If mod_dso can't load a module because the module doesn't exist
	  in the expected ModulePath, it emits a warn.	Log that at the
	  INFO level, rather than at a DEBUG level.

2009-07-16 18:16  castaglia

	* modules/mod_ctrls.c:
	  If ControlsEngine is set to 'off', then we should not try to
	  listen on the ControlsSocket.

2009-07-16 18:10  castaglia

	* modules/mod_dso.c:
	  Improve on the errors reported by mod_dso when a module can't be
	  loaded.  The cause of the infamous "error loading ...: Permission
	  denied" error is actually most likely to be a ModulePath that is
	  an empty directory, but you would have no way of knowing/guessing
	  that from the emitted error.

2009-07-16 14:28  castaglia

	* configure:
	  Forgot to check in the updated configure script.

2009-07-16 13:47  castaglia

	* doc/howto/Umask.html:
	  Add a FAQ to the Umask howto explaining why proftpd does not
	  allow uploading of files with execute permissions.

2009-07-16 11:15  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_shaper.pm,
	  t/modules/mod_shaper.t:
	  Start adding unit/regression tests for the mod_shaper module.

2009-07-16 10:52  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/CreateHome.pm:
	  Add unit test for CreateHome's 'dirmode' parameter.

2009-07-15 14:59  castaglia

	* config.h.in, configure.in, src/main.c:
	  Add an autoconf check for the uname() function, in case the
	  platform does not actually provide one.  (Handy for older and/or
	  more esoteric platforms).

2009-07-15 14:41  castaglia

	* contrib/mod_sftp/fxp.c:
	  Use the SFTP session's pool, rather than the Response API pool,
	  for adding our status codes.

2009-07-15 14:25  castaglia

	* src/main.c:
	  Use uname(2) to get more platform details (OS and version,
	  machine/CPU type) for the -V settings.  Easier than asking people
	  about the platform they're running proftpd on; just ask for the
	  -V output.

2009-07-15 09:37  castaglia

	* contrib/mod_sftp/fxp.c:
	  Simplify the obtaining of proper open(2) flags when handling
	  version 5 (and higher) SFTP OPEN requests.

2009-07-14 22:59  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_exec.pm:
	  Add unit test demonstrating, via mod_exec, a use of the new
	  %{bytes_xfer} variable.

2009-07-14 22:58  castaglia

	* modules/mod_core.c:
	  Add support for a %{bytes_xfer} variable.  Similar to the
	  existing %{total_bytes_xfer} variable, only this new variable
	  only shows the number of bytes in the recent data transfer (if
	  any), rather than the cumulated count of bytes transferred during
	  the lifetime of the session.

2009-07-14 15:40  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add unit test for the %s LogFormat variable in ExtendedLogs for
	  SFTP requests.

2009-07-14 14:31  castaglia

	* contrib/mod_sftp/fxp.c:
	  Dispatch to the correct POST_CMD/LOG_CMD (or
	  POST_CMD_ERR/LOG_CMD_ERR) handlers.  Specifically, do NOT
	  dispatch EOF errors (when reading) to _ERR handlers; the way that
	  SFTP reads work, this is normal.

2009-07-14 11:46  castaglia

	* contrib/mod_exec.c:
	  Handle signals/interruptions in the potentially
	  long/time-consuming loop as we close any open file descriptors
	  before exec'ing the configured command.

2009-07-14 09:27  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Add a quote() method to the TestSuite::FTP class, for quoting
	  raw/arbitrary commands to send to the server.

2009-07-09 00:18  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_exec.pm:
	  Add unit tests for ExecOnError.

2009-07-09 00:17  castaglia

	* contrib/mod_exec.c:
	  Guard against having getrlimit(2) return an obscenely high number
	  of maximum open file descriptions (e.g. RLIMIT_INFINITY); this
	  was causing mod_exec to not work as expected on Mac OSX 10.4.

2009-07-08 18:32  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_exec.pm:
	  Add unit test for ExecOnExit.

2009-07-08 18:29  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_exec.pm:
	  Adding more mod_exec unit tests, including one for the "%{...}"
	  variable support.

2009-07-08 18:27  castaglia

	* contrib/mod_exec.c:
	  Add support for the Variables API-style "%{...}" variables to
	  mod_exec's variable interpolation.  For example, you could now
	  do:

	    ExecOnExit /bin/bash -c "echo %{total_bytes_out} >>
	  bytes-downloaded.txt"

	  and it would work properly.

2009-07-08 18:12  castaglia

	* contrib/mod_exec.c:
	  Fix off-by-one error which caused mod_exec to log all but the
	  last parameter when calling exec.

2009-07-08 18:11  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_exec.pm,
	  t/modules/mod_exec.t:
	  Start working on unit tests for the mod_exec module.

2009-07-08 16:43  castaglia

	* lib/sstrncpy.c:
	  Catch a possible null pointer exception in sstrncpy(), if the src
	  pointer provided by the caller is null.

2009-07-08 13:29  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Allow the Port that appears in the testsuite proftpd.conf files
	  to be settable directly by the unit test.

2009-07-08 11:16  castaglia

	* contrib/mod_sftp/fxp.c:
	  Oops.  We only want to set the O_RDONLY flag, not to obliterate
	  any other bits/flags set to only have O_RDONLY.

2009-07-08 11:06  castaglia

	* contrib/mod_sftp/fxp.c:
	  Attempt to work around bugs in SFTP clients using protocol
	  version 5 or higher whose OPEN requests do not include the proper
	  bits set for indicating whether O_RDONLY, O_RDWR, or O_WRONLY
	  should be used.  The workaround is to attempt to infer which of
	  the O_ flags to use from the other bits the client might have
	  provided.

2009-07-06 08:28  castaglia

	* NEWS, src/dirtree.c:
	  Bug#3221 - Fixed regression causing command-line -D/--define
	  options not to work.

2009-07-05 20:13  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2758 - ProFTPD doesn't always pay attention to AccessDenyMsg.

2009-07-05 20:11  castaglia

	* tests/: tests.pl, t/config/accessdenymsg.t,
	  t/lib/ProFTPD/Tests/Config/AccessDenyMsg.pm:
	  Add unit tests for the AccessDenyMsg config directive.

2009-07-05 19:35  castaglia

	* tests/: tests.pl, t/config/accessgrantmsg.t,
	  t/lib/ProFTPD/Tests/Config/AccessGrantMsg.pm:
	  Add unit tests for the AccessGrantMsg config directive.

2009-07-05 19:15  castaglia

	* tests/: tests.pl, t/config/useralias.t,
	  t/lib/ProFTPD/Tests/Config/UserAlias.pm:
	  Add unit tests for the UserAlias config directive.

2009-07-05 12:36  castaglia

	* contrib/mod_sftp/fxp.c:
	  Handle the NAMED_ATTRS read and write flags in a SFTP open
	  request, protocol version 5 or later.  Also be sure to handle the
	  case where the client may send desired access flags which seem to
	  be read-only, but also send open flags which indicate append.

2009-07-04 19:02  castaglia

	* contrib/mod_sftp/fxp.c:
	  Make sure to dispatch {POST,LOG}_CMD_ERR commands for aborted
	  SFTP files, so that modules like mod_exec's ExecOnError can work
	  properly.

2009-07-04 18:48  castaglia

	* contrib/mod_sftp/scp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  The mod_sftp module was not honoring a configuration like:

	    <Limit WRITE>
	      DenyAll
	    </Limit>

	    <Directory ~/*/*>
	      <Limit STOR>
		AllowAll
	      </Limit>
	    </Directory>

	  the same way between SFTP and SCP uploads.  SFTP uploads were
	  allowed properly, but SCP uploads were not.  Turned out to be a
	  problem with the path that was being used in the dir_check()
	  calls in the SCP code; the full path was not being used as it
	  should.

	  Also fixed a problem where an SCP client might send duplicate
	  filename info (once in the channel request, once in the fileinfo
	  control message).

2009-07-03 18:33  castaglia

	* src/main.c:
	  Install our signal handlers earlier in the startup process.  The
	  driving force behind this change is to get our SIGSEGV handler
	  installed prior to parsing the config file; this way if a
	  segfault occurs AND --enable-devel=stacktrace has been used, we
	  can get the stack trace for a parsing segfault.

	  By the time the signal handlers were being installed (i.e. after
	  parsing) this would not have been possible.

2009-07-03 18:02  castaglia

	* doc/howto/Filters.html:
	  When compiling POSIX regular expressions using patterns which
	  include character classes like 'blank' et al, you DO need to use
	  two square brackets, not just one.

2009-07-03 17:34  castaglia

	* NEWS, contrib/mod_sftp/auth.c, contrib/mod_sftp/channel.c,
	  contrib/mod_sftp/fxp.c, contrib/mod_sftp/kex.c,
	  contrib/mod_sftp/service.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Bug#3265 - SFTP requests are logged to ExtendedLog without regard
	  to classes.

	  The cmd_rec.class field needed to be set on the SSH2 and SFTP
	  cmd_recs used.

2009-07-03 16:02  castaglia

	* NEWS, contrib/mod_sftp/mod_sftp.c:
	  Bug#3263 - Supplying optional SFTPRekey timeout parameter causes
	  segmentation fault.

2009-07-01 11:18  castaglia

	* doc/contrib/mod_sql.html:
	  Mention that --enable-openssl can be used to enable the OpenSSL
	  SQLAuthType.

2009-06-30 20:22  castaglia

	* include/version.h:
	  Update the version.h file for the next RC release.

2009-06-30 19:50  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2009-06-30 19:50  castaglia

	* NEWS, RELEASE_NOTES, contrib/dist/rpm/proftpd.spec,
	  include/version.h:
	  Updating the files for the release of 1.3.3rc1.

2009-06-30 18:43  castaglia

	* ChangeLog:
	  Updated change log for 1.3.2a.

2009-06-30 18:41  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Update the version in the RPM spec file.

2009-06-30 18:38  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Update mod_tls unit tests to reflect behavior of newer
	  Net::FTPSSL Perl module.

2009-06-30 18:29  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Quell Perl interpreter warnings about redeclared variables.

2009-06-30 18:29  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Remove unit test for bug not fixed in this release.  Quell Perl
	  interpreter warnings about redeclared variables.

2009-06-30 18:17  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  More handling of spelling differences across systems.

2009-06-30 18:03  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/TimeoutLogin.pm:
	  Cleanup of these older tests.

2009-06-30 17:58  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/MaxStoreFileSize.pm:
	  Account for spelling differences among different systems.

2009-06-30 17:57  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/ABOR.pm:
	  Fix the use of regexes in the unit tests; I was comparing the two
	  operands in the wrong order.

2009-06-30 17:49  castaglia

	* modules/mod_auth.c,
	  tests/t/lib/ProFTPD/Tests/Config/MaxLoginAttempts.pm:
	  Setting "MaxLoginAttempts 1" would cause even the first login to
	  fail, which is not the desired behavior.  (The auth_tries
	  variable was incremented using a prefix operator, rather than
	  postfix operator.)

	  The code was also not properly honoring the seldom-used
	  "MaxLoginAttempts none".

	  Adjust MaxLoginAttempts unit tests accordingly.

2009-06-30 17:27  castaglia

	* modules/mod_xfer.c:
	  Backport of segfault fix when a data transfer is aborted by a
	  client.

2009-06-30 17:27  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/ABOR.pm:
	  Modify ABOR tests to handle different response codes/messages
	  depending on the particular timing of the handling of the ABOR by
	  proftpd.

2009-06-30 17:26  castaglia

	* modules/mod_xfer.c:
	  Fix possible segfault (picked up by a unit test) when a data
	  transfer is aborted.

2009-06-30 16:55  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/ABOR.pm:
	  Typo.

2009-06-30 16:45  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/HELP.pm:
	  Update the HELP unit test to work properly in the case where
	  mod_tls is present.

2009-06-30 16:43  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Typo.

2009-06-30 16:31  castaglia

	* src/help.c:
	  Actually make the code do what the comment (correctly) says it
	  does.

2009-06-30 15:46  castaglia

	* RELEASE_NOTES:
	  Updating release notes for 1.3.2a maintenance release.

2009-06-30 15:38  castaglia

	* RELEASE_NOTES:
	  Mention the support for TimeoutLogin for the BanOnEvent
	  directive.

2009-06-30 14:20  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Correct the unit test which defines custom SQLGroupInfo queries;
	  the group lookup by member query was incorrect.

2009-06-30 14:05  castaglia

	* RELEASE_NOTES, doc/contrib/mod_sql.html:
	  Working on documentation for new/changed features for the
	  upcoming 1.3.3rc1 release.

2009-06-30 10:22  castaglia

	* NEWS, modules/mod_auth.c, modules/mod_core.c, src/dirtree.c:
	  Bug#3243 - Broken support for AllowOverride per user/group/class
	  conditionals.

2009-06-30 10:09  castaglia

	* modules/mod_cap.c:
	  Use pr_module_exists() consistently; it more accurately describes
	  the check that is being made.

2009-06-30 10:00  castaglia

	* NEWS, doc/modules/mod_cap.html, modules/mod_cap.c:
	  Bug#3257 - CAP_AUDIT_WRITE capability needed for some PAM
	  modules.

2009-06-30 09:53  castaglia

	* NEWS, doc/modules/mod_cap.html, modules/mod_cap.c:
	  Bug#3257 - CAP_AUDIT_WRITE capability needed for some PAM
	  modules.

2009-06-30 09:48  castaglia

	* contrib/mod_sql_sqlite.c:
	  Backport the SQLite fix for mod_sql_sqlite, so that if a new
	  enough version of SQLite is used, mod_sql_sqlite will be able to
	  support SQLLog directives in a chrooted session.

2009-06-30 09:44  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_odbc.c, mod_sql_postgres.c,
	  mod_sql_sqlite.c:
	  Bug#3259 - Adding second database connection causes segfault.

2009-06-30 09:42  castaglia

	* contrib/mod_sql_odbc.c:
	  Fix some compiler warnings about shadowed variables in
	  mod_sql_odbc.

2009-06-30 09:41  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_odbc.c, mod_sql_postgres.c,
	  mod_sql_sqlite.c:
	  Bug#3259 - Adding second database connection causes segfault.
	  The array_header containing the conn_entry_t objects was
	  allocated using the incorrect data size.

2009-06-30 09:04  castaglia

	* tests/: tests.pl, t/config/limit/subdirs.t,
	  t/lib/ProFTPD/Tests/Config/Limit/SubDirectories.pm:
	  Add unit test demonstrating how Bug#3077 can cause some
	  unexpected <Limit> configurations, due to need to handle the
	  X-variant commands.

2009-06-29 17:50  castaglia

	* NEWS, contrib/mod_tls.c, modules/mod_xfer.c, src/main.c:
	  Bug#3256 - "SO_OOBINLINE" error occuring again.  This is a
	  regression of Bug#2332 caused by code movement in 1.3.2.

	  Bug#3258 - Log cluttered with "using sendfile capability"
	  messages.

	  Bug#3261 - Badly formatted TLSRenegotiate directive causes
	  proftpd to hang.

2009-06-29 17:33  castaglia

	* contrib/mod_tls.c:
	  Fix a bug in mod_tls' parsing of the TLSRenegotiate directive, as
	  per:

	    https://bugzilla.redhat.com/show_bug.cgi?id=476847

	  No one was nice enough to report that bug in the ProFTPD
	  Bugzilla, though.

2009-06-29 16:02  castaglia

	* contrib/: mod_sql.c, mod_sql_postgres.c:
	  Bug#3251 - mod_sql_postgres should be more verbose when failing
	  the "Backend" SQLAuthType check.

2009-06-29 13:36  castaglia

	* contrib/mod_sql_mysql.c:
	  Stylistic nits; no functional change.

2009-06-29 10:18  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#3258 - Log cluttered with "using sendfile capability"
	  messages.

2009-06-29 10:10  castaglia

	* doc/contrib/mod_sql_sqlite.html:
	  Mention that SQLite-3.6.5 or later is required for mod_sql_sqlite
	  to properly support SQLLog directives for chrooted processes.

2009-06-28 22:31  castaglia

	* contrib/mod_sql_sqlite.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Fix mod_sql_sqlite to work properly, with regard to SQLLog
	  updates, in a chrooted process.  Note that this only works for
	  SQLite-3.6.5 and later.  Also add slightly more information if
	  the database file for mod_sql_sqlite cannot be opened, or when
	  the SQLLog query fails because the file cannot be opened.

	  Add an accompanying unit test for the chrooted behavior of
	  mod_sql_sqlite.

2009-06-25 13:35  castaglia

	* doc/howto/SQL.html:
	  Replace the URLs to castaglia.org with URLs to proftpd.org.

2009-06-24 16:44  castaglia

	* src/main.c:
	  If --enable-devel=stacktrace is used, then an asynchronous
	  handler for SIGSEGV is installed.  That handler doesn't go
	  through pr_signals_handle(), so we need to make sure that the
	  table code knows that it's still in a signal-handling state for
	  this SIGSEGV handler.

2009-06-23 16:15  castaglia

	* RELEASE_NOTES:
	  Update the release notes; I still need to flesh out the
	  descriptions more before doing the 1.3.3rc1 release.

2009-06-22 13:54  castaglia

	* NEWS, src/main.c:
	  Bug#3256 - "SO_OOBINLINE" error occuring again.  This is a
	  regression of Bug#2332, caused by code movement in 1.3.2.

2009-06-22 11:10  castaglia

	* src/fsio.c:
	  The bug in pr_fsio_futimes(), where we were not calling the
	  proper futimes() handler, occurred in pr_fsio_faccess() as well;
	  it would result in another segfault, if the registered FS did not
	  provide a faccess() handler.

2009-06-22 10:54  castaglia

	* contrib/mod_sftp/fxp.c:
	  If no DeleteAbortedStores appears in the proftpd.conf, then the
	  callback which closes any open filehandles could segfault, trying
	  to deference a null pointer.	Check for this, and handle it
	  appropriately.

2009-06-22 10:48  castaglia

	* src/fsio.c:
	  If pr_fsio_utimes() or pr_fsio_futimes() succeeds, clear the
	  statcache; the file metadata is now stale, and needs to be
	  refreshed.

	  In pr_fsio_futimes(), we were calling the wrong futimes()
	  handler.  Use the right one, i.e. the one found by the while()
	  loop.

2009-06-22 10:44  castaglia

	* src/fsio.c:
	  Include utimes(2), futimes(3) in the debug output for a
	  registered FS object.

2009-06-22 09:54  castaglia

	* doc/howto/Limit.html:
	  Mention that the parsing rules for AllowUser pertain to DenyUser
	  as well.

2009-06-21 12:19  castaglia

	* NEWS, contrib/mod_tls.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Bug#3247 - "TLSRequired auth" and "TLSOptions AllowPerUser" are
	  incompatible.

2009-06-21 12:14  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Turns out that using the exit code from the `proftpd' binary for
	  determining successful/failure of server startup is not that
	  reliably, sadly.  So now the PidFile is used for sending a signal
	  to the server; if that succeeds, then the server has started
	  successfully.

2009-06-21 12:05  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  If the server fails to start, throw an exception, rather than
	  letting the caller assume that the server started successfully.

2009-06-21 11:57  castaglia

	* tests/: tests.pl, t/config/ftpaccess/empty.t,
	  t/lib/ProFTPD/Tests/Config/FTPAccess/Empty.pm:
	  Add unit test for an empty .ftpaccess file, for
	  investigating/regressing Bug#3240.

2009-06-20 19:24  castaglia

	* NEWS, contrib/mod_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Bug#3253 - Support for %S variable in SQL queries.

2009-06-20 14:49  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Allow unit tests to specify the User, Group names to use in the
	  generated config file, if needs be.

2009-06-20 13:33  castaglia

	* src/fsio.c:
	  Check for an ENOSYS errno when using futimes(2), in case the
	  platform provides a stub which does not actually do anything.
	  Fallback to using utimes(2) if this happens.

2009-06-20 11:42  castaglia

	* contrib/mod_sftp/mod_sftp.c:
	  When mod_sftp handles a restart, it needs to clear any
	  passphrases held in memory.

2009-06-19 17:54  castaglia

	* contrib/mod_sql.c:
	  Adjust the ordering of the custom SQLNamedQuery optional queries
	  which can be used for customizing SQLUserInfo.  In particular, we
	  need to add the ability to specify the query to look up a user
	  given a UID; this is useful for modules like mod_quotatab, which
	  may need to find the owner user/group for a file based on that
	  file's owner UID/GID.

2009-06-19 17:29  castaglia

	* contrib/mod_sftp/fxp.c:
	  Fix format warning about data type mismatches; this warning only
	  occurs on 64-bit machines.  An explicit cast to the supported
	  off_t type (or its nearest equivalent) is all that's needed here.

2009-06-19 17:15  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_cap.pm,
	  t/modules/mod_cap.t:
	  Start on unit tests for the mod_cap module.

2009-06-19 11:55  castaglia

	* tests/: tests.pl, t/config/allowoverwrite.t,
	  t/lib/ProFTPD/Tests/Config/AllowOverwrite.pm: Add unit tests for
	  the AllowOverwrite directive.

2009-06-18 17:32  castaglia

	* contrib/mod_sftp/fxp.c:
	  When setting attributes on a file, make sure that we check the
	  client-sent attribute flags in the same way as when we parse
	  those attribute values (i.e. be sure to be protocol
	  version-specific when necessary).  Otherwise we might do the
	  wrong thing if the client sends a badly flagged request.

2009-06-10 14:48  castaglia

	* configure:
	  Updated configure.

2009-06-10 14:44  castaglia

	* configure.in:
	  Trying to compile proftpd using "--enable-nls
	  --with-shared=mod_lang", in order to build mod_lang as a shared
	  module, was causing the configure script to complain of duplicate
	  build requests.  Fix this.

2009-06-10 09:18  castaglia

	* NEWS, contrib/mod_ban.c, doc/contrib/mod_ban.html:
	  Bug#3249 - mod_ban support for TimeoutLogin.

2009-06-09 09:07  castaglia

	* modules/mod_core.c:
	  If the SITE CHGRP/CHMOD commands are denied by <Limit> sections,
	  set errno to EACCES, so that hopefully the user's client can
	  receive a more helpful error response code.

2009-06-09 09:05  castaglia

	* modules/mod_core.c:
	  Add debug logging when the SITE CHMOD/CHGRP commands are denied
	  because of <Limit> sections in the configuration.

2009-06-03 11:42  castaglia

	* contrib/mod_sftp/auth.c:
	  Make sure that any configured SFTPDisplayBanner is only sent once
	  to the connecting client.

2009-06-03 10:28  castaglia

	* contrib/mod_sftp/keys.c:
	  Add a missing PRIVS_RELINQUISH call.	Adjust spacing in that same
	  area, so that the formatting is consistent.

2009-05-28 13:13  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add test case to make sure that RootLogin works properly in
	  mod_sftp.

2009-05-27 16:10  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Fix typo in mod_rewrite PORT rewriting config.

2009-05-27 16:09  castaglia

	* doc/howto/Rewrite.html:
	  Fix typo/omission in Rewrite howto.

2009-05-27 11:31  castaglia

	* contrib/mod_sftp/auth.c:
	  Properly honor RootLogin (and its absence) in mod_sftp.  This
	  includes generating the 'mod_auth.root-login' event, just as
	  mod_auth does.

2009-05-27 09:14  castaglia

	* contrib/dist/rpm/proftpd.logrotate:
	  Bug#3245 - proftpd.logrotate assumes location of `kill' command.
	  Simply rely on PATH to find the appropriate location.

2009-05-22 14:15  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RETR.pm:
	  Add test showing that a file with leading whitespace in its name
	  can be downloaded.

2009-05-22 10:35  castaglia

	* tests/t/lib/ProFTPD/Tests/Logging/ExtendedLog.pm:
	  Yet more redundant variables removed.

2009-05-22 10:34  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/FTPAccess/RETR.pm:
	  More redundant variables removed.

2009-05-22 10:28  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/DirFakeMode.pm:
	  Remove another redundant variable declaration.

2009-05-22 10:22  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/PORT.pm:
	  Remove redundant variable declaration.

2009-05-20 14:00  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/STOR.pm:
	  Add unit test demonstrating that upload a file whose name begins
	  with whitespace is possible.

	  Update all tests to use 'tests.log' as the logfile name.

2009-05-19 14:38  castaglia

	* tests/t/: lib/ProFTPD/Tests/Modules/mod_ifsession.pm,
	  modules/mod_ifsession.t:
	  Start working on unit tests for mod_ifsession's functionality.
	  This first test is inspired/used for verifying Bug#3243.

2009-05-19 14:36  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Allow tests to request to NOT have default configs used.  This is
	  handy when dealing with mod_ifsession tests, for example.

2009-05-19 09:23  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Had a request to use the %{dist} variable in the RPM Release tag
	  as well.  Makes no never mind to me.

2009-05-18 14:16  castaglia

	* Make.rules.in, Makefile.in, utils/ftpcount.1.in,
	  utils/ftpscrub.8.in, utils/ftptop.1.in, utils/ftpwho.1.in:
	  Fix Bug#3242, which is a follow-up to Bug#2613.  Modify the
	  utility man pages to reflect the changed path to the default
	  scoreboard file, and remove the now-redundant $(rundir) Make
	  variable.

2009-05-18 09:11  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Martin Edlman contributed RPM .spec patch to handle empty
	  static_modules variable when the mod_facl module is not
	  requested.

2009-05-14 17:29  castaglia

	* tests/t/lib/ProFTPD/Tests/Logins.pm:
	  Add regression test showing that multiple attempts to send USER
	  (i.e. after the first attempt fails) will succeed as expected.

2009-05-14 17:19  castaglia

	* contrib/mod_sftp/scp.c:
	  I have no clue how this code was compiling/working for my tests
	  earlier today, but it certainly needs to be fixed.  Weird.

2009-05-14 14:51  castaglia

	* contrib/mod_sftp/: fxp.c, scp.c:
	  Fix the DeleteAbortedStores support.	I did have it such that
	  only HiddenStores files would be deleted if DeleteAbortedStores
	  was enabled.	Then, for aborted sessions, deleted _all_ open
	  filehandles.	Which is not correct either (we don't want to
	  delete files that were being downloaded, for example).  This
	  changes the DeleteAbortedStores so that we only delete aborted
	  _uploaded_ files.  Hopefully.

2009-05-14 14:46  castaglia

	* contrib/mod_sftp/: fxp.c, scp.c: [no log message]

2009-05-14 12:22  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add unit test for HiddenStores directive using SCP.  The test is
	  not as thorough as I would like; the Net::SSH2 SCP interface is
	  not as flexible.  Still, it does the trick.

2009-05-14 12:21  castaglia

	* contrib/mod_sftp/scp.c:
	  This adds support for HiddenStores, DeleteAbortedStores, and
	  'incomplete' TransferLog entries to SCP.

2009-05-14 12:18  castaglia

	* contrib/mod_sftp/fxp.c:
	  Cut-n-paste error.

2009-05-14 11:48  castaglia

	* contrib/mod_sftp/fxp.c:
	  Add a trace message for renaming of a HiddenStores file.

2009-05-14 09:56  castaglia

	* doc/contrib/mod_sftp.html:
	  HiddenStores is now supported by mod_sftp.

2009-05-14 09:48  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Added unit tests for 'incomplete' TransferLog entries via SFTP.

2009-05-14 09:44  castaglia

	* contrib/mod_sftp/fxp.c:
	  Write 'incomplete' TransferLog entries for downloads/uploads that
	  have been aborted (i.e. not closed by the client before the
	  channel was closed/session ended).

	  Also fixes a bug introduced yesterday with the
	  DeleteAbortedStores support, where a config which did not have
	  DeleteAbortedStores would segfault (or the process would wander
	  off into the memory weeds, depending on your arch).

2009-05-13 16:19  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Added regression tests for HiddenStores and DeleteAbortedStores
	  via SFTP uploads.

2009-05-13 16:18  castaglia

	* contrib/mod_sftp/: channel.c, channel.h, fxp.c, mod_sftp.c:
	  Added support for the HiddenStores and DeleteAbortedStores
	  directives for SFTP.

2009-05-13 11:13  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add tests for TransferLog entries generated from
	  downloading/uploading via SCP.

2009-05-13 09:41  castaglia

	* contrib/mod_sftp/fxp.c:
	  Make sure that the TransferLog entry for a file deleted via SFTP
	  in a chrooted session is still the absolute path of the file,
	  regardless of the chroot.

2009-05-13 09:41  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add test for the TransferLog entry generated when deleting a file
	  via SFTP in a chrooted session.

2009-05-13 09:31  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_site_misc.pm:
	  Add regression test for the 14-digit version of the SITE UTIME
	  command.

2009-05-11 11:58  castaglia

	* RELEASE_NOTES:
	  Warn of the change to the values in the service-name field of the
	  TransferLog.

2009-05-11 11:07  castaglia

	* tests/api/scoreboard.c:
	  If the API testsuite is run with root privs, then one of the
	  scoreboard tests will fail with a different errno value; check
	  for this, and handle it as appropriate.

2009-05-11 10:33  castaglia

	* tests/Makefile.in:
	  Make sure the privs.o code is linked into the API tests.

2009-05-11 10:18  castaglia

	* tests/Makefile.in:
	  Separate the API and the running tests into two separate make
	  targets.

2009-05-11 09:59  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add regression test for the TransferLog delete file entries for
	  SFTP.

2009-05-11 09:58  castaglia

	* contrib/mod_sftp/fxp.c:
	  Make sure that deleting a file via SFTP generates the proper
	  TransferLog entry.

2009-05-09 10:02  castaglia

	* contrib/mod_sftp/scp.c:
	  Wolfgang Breyha correctly pointed out that these path-trimming
	  loops should have a "pathlen > 1" check, not "pathlen > 0".  This
	  was causing problems when trying to use scp to upload to '/';
	  eventually a segfault would ensue.

2009-05-08 16:14  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Added unit test for the TransferLog generated by downloading a
	  file via sftp.

2009-05-08 16:13  castaglia

	* contrib/mod_sftp/auth.c, src/xferlog.c:
	  Support TransferLogs in mod_sftp.  This required a tweak to the
	  TransferLog code so that it wrote the proper service name (e.g.
	  "ftp", "sftp", etc); it had been hardcoded to "ftp".

2009-05-06 10:38  castaglia

	* contrib/mod_sftp/packet.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Make sure that mod_sftp sends a disconnect message when it does
	  not handle the client request.  For example, if a client requests
	  an SSH2 channel before it has authenticated, mod_sftp considers
	  it an "unsupported protocol sequence".  But it was not sending
	  the disconnect message to the client when this happened; this has
	  been fixed. Added a unit test to prevent regressions.

2009-05-04 16:31  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RETR.pm:
	  Add regression test demonstrating that downloading a file from a
	  directory whose name contains a space works as expected.

2009-05-03 13:13  castaglia

	* contrib/mod_sftp/scp.c:
	  Fix the handling of recursive uploads of directories via SCP; it
	  was completely broken.

2009-05-03 12:18  castaglia

	* contrib/mod_sftp/auth.c:
	  Be sure to dispatch the USER cmd_rec to the POST_CMD/LOG_CMD
	  handlers *before* calling the PASS PRE_CMD handler.  Otherwise,
	  mod_delay might see longer delays for both USER and PASS commands
	  when handling SSH2 connections when it isn't necessary.

2009-05-02 16:15  castaglia

	* contrib/mod_sftp/mod_sftp.c:
	  If we receive an EOF while reading the banner, don't try to use
	  strerror(), as it will result in a misleading log message.

2009-05-02 11:48  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Added unit tests for the 'OpenSSL' SQLAuthType.

2009-05-01 08:47  castaglia

	* doc/howto/ListOptions.html:
	  Mention the new -B ListOption.

2009-05-01 08:42  castaglia

	* modules/mod_ls.c, tests/t/lib/ProFTPD/Tests/Commands/LIST.pm,
	  tests/t/lib/ProFTPD/Tests/Commands/NLST.pm:
	  Modify the fix for Bug#3032 even more.  Instead of replacing
	  non-printable characters with '?' in the non-NLS case, add
	  support for a -B ListOption (defaults to off).  Some users noted
	  that the previous fix broke things for them, as they _assumed_
	  that proftpd would not alter a UTF8 path (even for the non-NLS
	  case).  By supporting a -B ListOption, sites which do want to see
	  the non-printable characters can request that behavior.  The -B
	  ListOption is not supported if NLS support is enabled.

2009-04-30 14:18  castaglia

	* src/main.c:
	  Add trace logging for when the 'requires_auth' check fails.

2009-04-30 14:10  castaglia

	* modules/mod_cap.c, src/main.c:
	  Make mod_cap's POST_CMD PASS handler be like every other modules,
	  and NOT require that the client be authenticated.  That
	  particular check is handled earlier in the session lifecycle.

2009-04-30 11:54  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/PORT.pm:
	  A proftpd user in the forums mentioned encountering the "Cannot
	  assign requested address" error when attempting active data
	  transfers.  Add a unit test which demonstrates how this error can
	  occur (usually because of badly behaved FTP clients which do not
	  cleanly close the data connection once done with it).

2009-04-29 22:50  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  If we need to explicitly specify the PORT argument, then make
	  sure that we open an appropriate listening socket based on that
	  argument; Net::FTP does not do this for us.  Sigh.

2009-04-29 16:32  castaglia

	* contrib/mod_tls.c:
	  OpenSSL-0.9.8j enables TLS extensions by default.  This includes,
	  among other things, SSL/TLS tickets.	However, some older clients
	  do not interoperate well with TLS extensions like this enabled.
	  So to preserve the principle of least surprise, disable the use
	  of SSL/TLS tickets.

2009-04-29 11:14  castaglia

	* contrib/mod_sftp/mod_sftp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  After a restart, mod_sftp needs to re-allocate and re-compile the
	  regexes for known client versions with bugs; the compiled regex
	  memory pool is cleared during a restart.  Failure to do this can
	  result in a segfault after the restart.  Add an accompanying unit
	  test.

2009-04-29 09:09  castaglia

	* modules/mod_ls.c:
	  Quell compiler warnings about unused variables when --enable-nls
	  is used.

2009-04-28 15:53  castaglia

	* include/version.h:
	  Update the version number and string, and mark this as a
	  maintenance branch/version.

2009-04-28 15:50  castaglia

	* NEWS, locale/Makefile.in, locale/bg_BG.po, locale/fr_FR.po,
	  locale/ko_KR.po:
	  Added Bulgarian, French, Korean translations.

2009-04-28 15:44  castaglia

	* NEWS, src/ctrls.c, src/event.c:
	  Backport fix for Bug#3179.

2009-04-28 15:33  castaglia

	* NEWS, include/dirtree.h, modules/mod_core.c, src/dirtree.c,
	  src/main.c:
	  Backport fix for Bug#3221.

2009-04-28 15:26  castaglia

	* doc/contrib/mod_exec.html:
	  Include the %w variable in the mentioned list of supported
	  variables.

2009-04-28 15:24  castaglia

	* doc/contrib/: mod_exec.html, mod_shaper.html:
	  Update the mod_exec and mod_shaper docs.

2009-04-28 15:22  castaglia

	* contrib/mod_exec.c:
	  The mod_exec module was not registering for the proper event name
	  for handling the unloading of the module.

2009-04-28 15:20  castaglia

	* NEWS, contrib/mod_sql.c:
	  Backport fix for Bug#3203.

2009-04-28 15:18  castaglia

	* NEWS, README.modules, RELEASE_NOTES, contrib/mod_exec.c,
	  doc/contrib/mod_exec.html:
	  Added mod_exec to contrib modules.

2009-04-28 14:52  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Backport fix for Bug#3196.

2009-04-28 14:49  castaglia

	* NEWS, contrib/mod_wrap2_sql.c:
	  Backport fix for Bug#3215.

2009-04-28 14:34  castaglia

	* NEWS, contrib/mod_tls.c:
	  Backport fix for Bug#3234.

2009-04-28 14:17  castaglia

	* NEWS, modules/mod_facts.c:
	  Backported fix for Bug#3190.

2009-04-28 14:11  castaglia

	* NEWS, src/dirtree.c:
	  Backport fixes for Bug#3184.

2009-04-28 14:04  castaglia

	* NEWS, modules/mod_auth.c, src/main.c:
	  Backport fix for Bug#3183.

2009-04-28 13:22  castaglia

	* NEWS, src/prxs.in:
	  Backported fix for Bug#3188.

2009-04-28 13:10  castaglia

	* NEWS, contrib/mod_sql_postgres.c:
	  Backported fix for Bug#3176.

2009-04-28 12:58  castaglia

	* NEWS, contrib/mod_sql_postgres.c:
	  Backported fix for Bug#3123.

2009-04-28 12:45  castaglia

	* src/main.c:
	  Backporting bugfixes:

	    + Handle restart parsing errors better.
	    + Clear the signal bitflag before processing the signal, not
	  after.  This
	      was causing some crashes due to endless loops during a
	  restart.

2009-04-28 12:41  castaglia

	* src/auth.c:
	  Backport the fix for the first UID/GID lookup failing to return
	  the name.

2009-04-28 11:35  castaglia

	* modules/mod_core.c, modules/mod_ls.c, src/dirtree.c:
	  Backporting bugfixes from trunk; these particular changes do not
	  have an associated bug number.

2009-04-27 23:34  castaglia

	* doc/howto/TLS.html:
	  Add TLS FAQ about whether FTPS protects both control and data
	  connections (it does).

2009-04-27 23:26  castaglia

	* doc/contrib/mod_sftp.html:
	  Added SFTP FAQ about having an SFTP-only proftpd.

2009-04-27 23:22  castaglia

	* tests/tests.pl:
	  Run the DisplayQuit tests as part of the testsuite.

2009-04-27 23:21  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/DisplayQuit.pm:
	  Adding tests for the DisplayQuit directive.

2009-04-27 16:10  castaglia

	* NEWS, README.modules, RELEASE_NOTES, contrib/mod_shaper.c,
	  doc/contrib/mod_shaper.html:
	  Add mod_shaper to the contrib/ modules.

2009-04-25 14:25  castaglia

	* contrib/mod_rewrite.c:
	  Fix rewrite_log() so that it uses pr_log_vwritefile().  Make
	  rewrite_openlog() handle the WRITABLE_DIR and SYMLINK return
	  values from pr_log_openfile().

2009-04-25 14:14  castaglia

	* modules/mod_xfer.c, src/display.c, tests/t/config/displayquit.t,
	  tests/t/lib/ProFTPD/Tests/Config/DisplayConnect.pm,
	  tests/t/lib/ProFTPD/Tests/Config/DisplayFileTransfer.pm,
	  tests/t/lib/ProFTPD/Tests/Config/DisplayLogin.pm:
	  Fix handling of multiline Display files.  Update the handling of
	  DisplayFileTransfer files such that they replace the 226 response
	  message, rather than prepending to it.

2009-04-24 13:48  castaglia

	* modules/mod_core.c:
	  Fix another unsafe use of sizeof() on a pointer.

2009-04-24 13:45  castaglia

	* src/dirtree.c:
	  Fix unsafe sizeof(); it was being used on a pointer, not on a
	  static buffer.

2009-04-24 10:38  castaglia

	* contrib/mod_sftp/fxp.c:
	  Increase the allocated buffer size for a READDIR response, and
	  try to be smarter about the buffer size.

2009-04-24 10:18  castaglia

	* modules/mod_cap.c:
	  Refine the criteria for using CAP_SETUID/CAP_SETGID.	In addition
	  to checking for the mod_sftp and mod_exec modules, make sure that
	  those modules are enabled via their respective Engine directives.
	  This is to handle cases where the modules might be present in
	  the executable but not enabled via config.

2009-04-24 09:55  castaglia

	* contrib/mod_sftp/utf8.c:
	  If UTF8 encoding/decoding of a string fails, log the error and
	  return the original string (instead of returning NULL).

2009-04-24 09:48  castaglia

	* contrib/mod_sftp/auth.c:
	  No need to acquire root privs explicitly before dropping them.

2009-04-24 09:44  castaglia

	* modules/mod_cap.c:
	  On Linux, the mod_cap module will interfere with modules/code
	  that wishes to drop root privs completely, e.g. mod_exec (when
	  executing scripts), mod_sftp (after authenticating), or when the
	  RootRevoke directive is used.  The problem is that the CAP_SETUID
	  and CAP_SETGID capabilties, needed for dropping root privs, are
	  not enabled by mod_cap.

	  This change adds the CAP_SETUID and CAP_SETGID capabilities if
	  mod_exec or mod_sftp is present, or if "RootRevoke on" is found
	  in the config.

	  Minor stylistic cleanup is also part of this change.

2009-04-24 08:46  castaglia

	* modules/mod_ls.c:
	  When generating directory listings, set the ASCII flag after the
	  data connection has been successfully opened consistently.  Some
	  places were setting the flag before the data connection open,
	  some after.

2009-04-23 17:31  castaglia

	* configure:
	  Updated configure.

2009-04-23 17:24  castaglia

	* configure.in:
	  Automatically set the PR_USE_OPENSSL define if mod_sftp is
	  requested, just as we do when mod_tls is requested.

2009-04-23 16:57  castaglia

	* contrib/mod_ctrls_admin.c:
	  Quell a compiler warning about a declared but not used variable.

2009-04-23 15:02  castaglia

	* contrib/mod_quotatab.c:
	  The mod_quotatab module really should report when it fails to
	  open the configured QuotaLog for any reason.

2009-04-22 22:40  castaglia

	* contrib/mod_sftp/fxp.c:
	  Fix minor case in the handling of the 'sftpUTF8ProtocolVersion'
	  SFTPClientMatch attribute where the path description for a
	  READDIR request may need to be encoded, depending on the chosen
	  SFTP UTF8 protocol version.

2009-04-22 22:26  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/: LIST.pm, NLST.pm:
	  Update the unit tests for Bug#3032 to only run if NLS support is
	  not enabled.

2009-04-22 21:40  castaglia

	* modules/mod_ls.c:
	  Forgot to add the NLS conditional to the handling of NLST as
	  well.

2009-04-22 21:24  castaglia

	* modules/mod_ls.c:
	  Modify the fix for Bug#3032 so that it is only used of NLS
	  support is not being used; the encoding can cause problems for
	  the isprint(3) function.

2009-04-22 20:25  castaglia

	* NEWS, src/inet.c:
	  Bug#3237 - "error setting IPV6_V6ONLY: Protocol not available"
	  message filling up log file.

	  The change was to not try to set the IPV6_V6ONLY socket option on
	  an IPv4-mapped IPv6 address.

2009-04-21 16:45  castaglia

	* contrib/mod_sftp/fxp.c:
	  Quell more compiler warnings about possbily using variables
	  before they have been initialized.

2009-04-21 16:31  castaglia

	* contrib/mod_quotatab.c:
	  Make sure that the trace message is based on the actual lock
	  type, not on the type as passed in by the caller.

2009-04-21 16:30  castaglia

	* contrib/mod_quotatab.c:
	  Actually use the lock type given by the caller.  Ouch.

2009-04-21 16:20  castaglia

	* contrib/mod_sftp/kex.c:
	  Handle "SFTPCompression off" properly.

2009-04-21 16:01  castaglia

	* contrib/mod_quotatab.c:
	  More changes to the QuotaLock lock operation handling, trying to
	  avoid spinning in a loop too tightly.

2009-04-21 15:21  castaglia

	* contrib/mod_sftp/fxp.c:
	  Make sure that the variables are initialised, when handling
	  REALPATH requests, before a permissions check.

2009-04-21 14:59  castaglia

	* contrib/mod_quotatab.c:
	  Retry the lock operation on the QuotaLock for EAGAIN as well.

2009-04-20 20:26  castaglia

	* tests/: tests.pl, t/config/displayfiletransfer.t,
	  t/lib/ProFTPD/Tests/Config/DisplayFileTransfer.pm:
	  Add unit tests for the DisplayFileTransfer directive.

2009-04-20 15:11  castaglia

	* src/dirtree.c:
	  Make sure that we ONLY use the PR_TUNABLE_XFER_BUFFER_SIZE (which
	  IS set in include/options.h) in the case where we cannot
	  determine the best sizes automatically from the kernel.

2009-04-20 09:55  castaglia

	* doc/contrib/mod_sftp.html:
	  Document the sftpUTF8ProtocolVersion SFTPClientMatch attribute.

2009-04-20 09:52  castaglia

	* contrib/mod_sftp/: fxp.c, fxp.h, interop.c, mod_sftp.c:
	  Added support for a 'sftpUTF8ProtcolVersion' SFTPClientMatch
	  attribute.  This attribute can be used to switch the SFTP
	  protocol version at which mod_sftp uses UTF8 encoding; the normal
	  protocol version at which this happens is 4 (and above).  Some
	  clients may need the UTF8 encoding when using protocol version 3,
	  however.

2009-04-17 16:19  castaglia

	* doc/contrib/mod_sftp.html:
	  Clarify when the various SSH2 authentication methods are offered.
	  Fix a typo.

2009-04-17 11:51  castaglia

	* contrib/mod_sftp/channel.c:
	  Update the trace log message about the size of the CHANNEL_DATA
	  sent to use just the payload size, not the packet size.

2009-04-16 17:51  castaglia

	* contrib/mod_sftp/channel.c:
	  Fix the calculation of the remote channel window size by NOT
	  including the length of the "header" fields (9 bytes) in the
	  amount to decrement for the remote window size.  This was causing
	  mod_sftp to see the remote window "close" prematurely (depending
	  on the amount of data transferred and the initial client window
	  size).

2009-04-15 14:03  castaglia

	* doc/howto/Filters.html:
	  Add the example PathAllowFilter that only allows printable
	  characters.

2009-04-15 13:57  castaglia

	* doc/howto/Filters.html,
	  tests/t/lib/ProFTPD/Tests/Config/PathDenyFilter.pm:
	  Update the doc, and unit test, to reflect the proper pattern to
	  use.

2009-04-15 11:20  castaglia

	* doc/howto/Filters.html:
	  Give an example of using PathDenyFilter to prevent filenames
	  which contain non-printable characters.

2009-04-15 11:15  castaglia

	* NEWS, modules/mod_ls.c,
	  tests/t/lib/ProFTPD/Tests/Commands/LIST.pm,
	  tests/t/lib/ProFTPD/Tests/Commands/MLSD.pm,
	  tests/t/lib/ProFTPD/Tests/Commands/MLST.pm,
	  tests/t/lib/ProFTPD/Tests/Commands/NLST.pm,
	  tests/t/lib/ProFTPD/Tests/Config/PathDenyFilter.pm:
	  Bug#3032 - CR character allowed in filename but not shown.

2009-04-14 11:53  castaglia

	* doc/howto/Tracing.html, src/trace.c:
	  Remove the 'privs' channel from the default channels; it is not
	  as productive to see the privs messages as the other channels in
	  the default group.

2009-04-14 11:47  castaglia

	* modules/mod_delay.c:
	  Make sure a pointer is initialized to NULL, so that if a matching
	  protocol row is not found, a segfault will occur.  (It's better
	  than reading off into some random stack memory address.)

2009-04-14 11:45  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#3230 - Differentiate among protocol connections in
	  DelayTable.

2009-04-14 11:39  castaglia

	* doc/contrib/mod_sftp.html:
	  Update the list of config directives that are not supported by
	  mod_sftp.

2009-04-14 11:38  castaglia

	* contrib/mod_sftp/fxp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add SFTP unit tests to ensure that mod_sftp honors the
	  AllowOverwrite, HideFiles, and Path*Filter directives.  Note that
	  similar tests are needed for the SCP code paths as well.

2009-04-13 11:49  castaglia

	* configure:
	  Updated configure.

2009-04-13 11:47  castaglia

	* configure.in:
	  Add a check for --with-modules=mod_dso, and warn the admin to use
	  --enable-dso instead.

2009-04-10 08:58  castaglia

	* configure:
	  Updated configure.

2009-04-10 08:55  castaglia

	* configure.in:
	  Typo.

2009-04-09 08:59  castaglia

	* modules/mod_facts.c:
	  Use cmd->arg, rather than concatenating cmd->argv[] ourselves, in
	  order to deal with paths with spaces.  This is a better approach,
	  given that NLS encoding of paths might cause the concatenation we
	  were doing to do the wrong thing.

2009-04-09 08:44  castaglia

	* modules/mod_facts.c:
	  Clean up some of the logging when opendir(3) fails when handling
	  MLSD.

2009-04-09 08:33  castaglia

	* src/timers.c:
	  Add trace logging when timers are reset.

2009-04-08 22:06  castaglia

	* contrib/mod_sftp/fxp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  mod_sftp now honors DirFakeMode.

2009-04-08 20:48  castaglia

	* tests/: tests.pl, t/config/dirfakemode.t,
	  t/lib/ProFTPD/Tests/Config/DirFakeMode.pm:
	  Add unit test for the DirFakeMode directive.

2009-04-08 20:27  castaglia

	* contrib/mod_sftp/: fxp.c, scp.c:
	  Set the session.xfer.direction variable when using SFTP or SCP.

2009-04-08 11:56  castaglia

	* contrib/mod_sftp/fxp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Make mod_sftp honor HideNoAccess (and other <Directory> config
	  directives).

2009-04-07 19:48  castaglia

	* contrib/mod_sftp/scp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add the checking for valid paths, handling of open() failures,
	  PRE_CMD errors, etc when uploading via SCP into the recv_finfo()
	  function.  The problem was that those checks were happening
	  *after* recv_finfo() had sent the "OK" message back to the SCP
	  client; the client would then commence uploading.  Any errors of
	  these sorts need to send a "NOT OK" message to the SCP client
	  before the upload occurs.

2009-04-07 18:44  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Directory/: Limits.pm, Umask.pm:

	  Fix more unit tests to run properly as root.

2009-04-07 10:15  castaglia

	* contrib/mod_tls.c:
	  Typo/bug.

2009-04-07 08:42  castaglia

	* src/ftpdctl.c:
	  Include the privs.h header so as to avoid compiler warnings about
	  the pr_privs* functions not being previously declared.

2009-04-07 08:41  castaglia

	* contrib/mod_ctrls_admin.c:
	  Use the proper number of arguments for pr_ctrls_log(), and avoid
	  pedantic compiler warnings/errors.

2009-04-06 17:11  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/FTPAccess/RETR.pm:
	  Another set of tests to clean up so that they run properly when
	  root.

2009-04-06 17:03  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/: HideFiles.pm, Limit/XMKD.pm:
	  More cleanup of unit tests that don't work properly when run as
	  root.

2009-04-06 17:03  castaglia

	* modules/mod_core.c:
	  Fix bug introduced by the patch for Bug#2067.  Style cleanup
	  there, too.

2009-04-06 16:18  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/: Order.pm, PathAllowFilter.pm,
	  PathDenyFilter.pm, ServerIdent.pm, TimeoutIdle.pm:
	  Fixup more test cases so run properly when run as root.

2009-04-06 16:08  castaglia

	* src/privs.c:
	  The testsuite found that the privs.c code was blocking signals,
	  and then not unblocking them in certain cases.  This is a Bad
	  Thing.  Fix the bug.

2009-04-06 15:47  castaglia

	* contrib/mod_sftp/channel.c:
	  Make sure that the max data payload we can send is larger than
	  the header length.  Otherwise, we would have bombed out due to
	  bad logic on my part.

2009-04-06 15:41  castaglia

	* doc/howto/Tracing.html, src/trace.c:
	  Add the "privs" logging channel to the default list of channels.

2009-04-06 15:32  castaglia

	* Make.rules.in, include/privs.h, modules/mod_ctrls.c,
	  modules/mod_delay.c, modules/mod_log.c, src/ftpdctl.c,
	  src/privs.c:
	  Do what should have been done long ago, and move the PRIVS macros
	  into functions, and into their own .c file.

	  The main driving reason for this is that the PRIVS macros need to
	  be nestable, to avoid recurrences of bugs like Bug#2242.  The
	  privs.c file adds nestable PRIVS invocations, and so far
	  everything looks like it's still working properly.

2009-04-06 15:28  castaglia

	* tests/t/lib/ProFTPD/Tests/: Logging/ExtendedLog.pm,
	  Modules/mod_ctrls.pm:
	  Fix a few more tests which fail when run with root privs.

2009-04-06 15:22  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/: MFF.pm, MFMT.pm:
	  Add some unit tests for the MFF and MFMT commands, proving that
	  using relative paths in the commands in a chrooted session work
	  as expected.

2009-04-06 15:13  castaglia

	* tests/t/lib/ProFTPD/Tests/: Logins.pm, Commands/ABOR.pm,
	  Commands/FEAT.pm, Commands/HELP.pm, Commands/MFF.pm,
	  Commands/MFMT.pm, Config/Directory/Umask.pm,
	  Logging/ExtendedLog.pm:
	  Fix some of the unit tests which fail when run with root privs.
	  Update some that simply needed to be updated to match the current
	  code.  Quell Perl warnings about redeclared variables in some
	  cases.

2009-04-05 10:56  castaglia

	* contrib/mod_sftp/auth.c:
	  Update mod_sftp to use session.notes for the original user name
	  sent by the client, just as the mod_auth module does.

2009-04-05 10:47  castaglia

	* RELEASE_NOTES, contrib/mod_ban.c, contrib/mod_radius.c,
	  contrib/mod_rewrite.c, contrib/mod_sql.c, contrib/mod_wrap.c,
	  contrib/mod_wrap2/mod_wrap2.c, modules/mod_auth.c,
	  modules/mod_log.c, src/display.c, src/main.c,
	  tests/t/lib/ProFTPD/Tests/Logging/ExtendedLog.pm:
	  Finish Bug#2715, and have the original USER value stashed in, and
	  retrieved from, the session.notes table.  Make note of this
	  change in the release notes as well, as it could impact module
	  developers.

2009-04-05 09:34  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_rewrite.c, contrib/mod_sql.c,
	  modules/mod_core.c, modules/mod_log.c,
	  tests/t/lib/ProFTPD/Tests/Logging/ExtendedLog.pm,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Bug#3029 - Support a RewriteCondition variable for renames.

	  Add a %w variable for the source path of a rename (mnemonic:
	  "whence" the rename came); this variable is only valid for the
	  RNTO command.  Support for the %w variable is also in LogFormat
	  and the SQLLog directives; the mod_exec module will support it as
	  well.

2009-04-03 21:42  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Added a mod_quotatab_sql unit test for Bug#3086.  The generated
	  log file shows that the use of QuotaLock does indeed protect the
	  calls to quotatab_lookup() and quotatab_create().  In fact, this
	  use of QuotaLock perfectly exercises the fixed quotatab locking
	  in terms of lock nesting, as the quotatab_create() function
	  itself uses write-locks (and, in the case of mod_quotatab_sql,
	  uses the same fd for locking).

2009-04-03 21:38  castaglia

	* NEWS, contrib/mod_quotatab.c, contrib/mod_quotatab.h,
	  contrib/mod_quotatab_sql.c:
	  Bug#3086 - mod_quotatab write locking is ineffective.

2009-04-03 16:04  castaglia

	* contrib/: mod_ban.c, mod_tls.c, mod_sftp/scp.c:
	  If we are calling getopt(3) again in a proftpd process (i.e.
	  after the initial call to getopt(3) when the daemon starts up),
	  then we need make sure that the POSIXLY_CORRECT environment
	  variable is set.

	  A segfault in mod_sftp was occurring because of getopt(3)
	  rearranging the array of strings; on a 64-bit machine whose
	  pointer sizes are different than what is expected, strange things
	  happen.  Setting POSIXLY_CORRECT tells getopt(3) not to rearrange
	  the array of strings.

2009-04-03 14:23  castaglia

	* doc/howto/Compiling.html:
	  Mention the --with-lastlog configure option, and use an unordered
	  list for the main/popular configure options.

2009-04-03 14:03  castaglia

	* contrib/mod_sftp/mod_sftp.c:
	  Stupid Solaris prints "Not owner", instead of "Operation not
	  permitted", for the EPERM errno.  Grr.  So instead of using
	  EPERM, switch to using EACCES.

2009-04-03 10:09  castaglia

	* contrib/mod_sftp/scp.c:
	  Catch a few places in the SCP upload code where confirmation
	  errors were not being properly written back to the client at the
	  right times.

2009-04-03 07:30  castaglia

	* modules/mod_auth_unix.c:
	  Fix compilation errors when HAVE_LOGINRESTRICTIONS (AIX platform,
	  mostly) is defined.

2009-04-01 16:09  castaglia

	* NEWS, src/dirtree.c:
	  Bug#3233 - Dynamic config causes many copies of static configs to
	  be merged.

2009-04-01 15:41  castaglia

	* contrib/mod_tls.c:
	  Actually match the code to the comment, and return the connection
	  to blocking mode if it had been so prior to the SSL_accept()
	  call.

2009-04-01 15:36  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3234 - SSL connections can cause 100% CPU usage.

	  In a nonblocking loop around SSL_accept(), make sure we delay a
	  bit (using select()) before retrying the SSL_accept() call.
	  Without the delay, the loop spins too quickly, consuming CPU.

2009-03-31 07:45  castaglia

	* contrib/mod_sftp/scp.c:
	  Make the SCP uploading code use dir_canonical_vpath(), just as
	  the SFTP code does (specifically the REALPATH SFTP request
	  handler), to be consistent.  (And, hopefully, to fix some
	  reported segfaults seen when uploading via SCP.)

2009-03-30 23:34  castaglia

	* Make.rules.in:
	  Fix a link ordering problem on Mac OSX; if the GNU gettext
	  library is used (e.g. using --enable-nls), then libc is linked
	  before libsupp.  This causes a problem for proftpd, since libsupp
	  contains, among other things, our own particular glob(3)
	  implementation.  If we use our glibc-glob.h header, but use the
	  system glob(3) implementation, strange things happen.  So make
	  sure that our libraries are linked before the other libraries.

	  Hopefully this does not cause other strange library/link
	  order-related issues.

2009-03-30 20:27  castaglia

	* modules/mod_lang.c:
	  Missed a dir_check() call which needs to pass the cmd_rec
	  pointer, not just the command name.

2009-03-30 16:16  castaglia

	* src/log.c:
	  Add some sane errno values if pr_log_openfile() fails in some
	  cases.

2009-03-30 11:43  castaglia

	* NEWS, include/fsio.h, modules/mod_ctrls.c, src/fsio.c,
	  src/ftpdctl.c, src/log.c, src/trace.c:
	  Bug#3225 - Opening of files during restart can inappropriately
	  use stdin/stdout/stderr descriptors, leading to bad behavior.

	  This patch adds a new pr_fsio_get_usable_fd() function, for
	  obtaining an fd (via dup(2)) which is NOT stdin/stdout/stderr.
	  It is to be used by functions which can be called in the daemon
	  process during startup/restart to ensure that the obtained
	  descriptor will not cause other issues (i.e.	with other code
	  which assumes the use of stdin/stdout/stderr).  I suspect that
	  this has been the underlying cause of several inexplicable
	  crashes/ log messages during restarts.

2009-03-30 11:31  castaglia

	* doc/howto/Rewrite.html:
	  Another good mod_rewrite example.

2009-03-28 17:51  castaglia

	* NEWS, contrib/mod_wrap.c, contrib/mod_wrap2/mod_wrap2.c:
	  Bug#3209 - mod_wrap2 should support the 'spawn' feature (or
	  equivalent) of tcpwrappers.

	  Add event generation to the mod_wrap and mod_wrap2 modules when a
	  connection is refused.  The mod_exec module can register
	  listeners for this event, and execute a command (e.g.
	  blockhosts/denyhosts/fail2ban) in response.

2009-03-28 17:39  castaglia

	* doc/contrib/mod_wrap.html:
	  Add mod_wrap FAQ about Bugs #2629, #2787, #3209.

2009-03-28 12:26  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_tls.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Bug#2178 - Extend TLSRequired for <Directory> and .ftpaccess
	  contexts.

2009-03-27 11:44  castaglia

	* contrib/mod_sftp/scp.c:
	  More futzing with the path resolution for SCP uploading.

2009-03-27 10:26  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Bug#3043 - SQLGroupInfo should allow custom queries.

2009-03-27 10:23  castaglia

	* configure:
	  Updated configure.

2009-03-27 10:15  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_auth_unix.c:
	  Bug#3231 - Use getgrset(3) on AIX to emulate getgrouplist(3).

2009-03-26 13:20  castaglia

	* NEWS, modules/mod_ls.c, src/dirtree.c,
	  tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Bug#3226 - HideFiles directive not working properly in
	  <Anonymous> sections.

2009-03-26 09:44  castaglia

	* doc/contrib/mod_sftp.html:
	  Typo.

2009-03-25 22:18  castaglia

	* RELEASE_NOTES:
	  Another note about use of the %{protocol} variable.

2009-03-25 18:47  castaglia

	* contrib/mod_sftp/scp.c:
	  Fix SCP uploading to handle an OpenSSH scp client invocations
	  like:

	    scp <file> <addr>:
	    scp <file> <addr>:.

	  These were being blocked on the STOR PRE_CMD handler because
	  mod_xfer only saw '.' as the file being uploaded, and would
	  complain about "not a regular file".

2009-03-25 09:02  castaglia

	* doc/howto/SQL.html:
	  Mention that the discussion about userset/usersetfast holds true
	  for groupset/groupsetfast as well.

2009-03-24 23:37  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Update the mod_tls unit tests to reflect changes in the recently
	  released Net::FTPSSL-0.08.  Still can't reuse the SSL session
	  from the control connection on a data connection, though.  (It's
	  a limitation in the fact that Net::FTPSSL uses
	  Net::SSLeay::Handle for the data connections, and
	  Net::SSLeay::Handle does not have a way to pass in a SSL_CTX to
	  use.	Sigh.)

2009-03-24 23:08  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Fix the test case for Bug#3149 slightly, to avoid any DNS issues.

2009-03-24 23:05  castaglia

	* src/bindings.c:
	  Modify the fix for Bug#2680 slightly, to avoid breaking
	  configurations which rely on the current behavior regarding
	  "DefaultServer on".  Now, if there is a vhost with "DefaultServer
	  on", that will be used in favor of a vhost listening on the
	  wildcard address.

2009-03-24 22:41  castaglia

	* doc/howto/SQL.html:
	  Add a SQL FAQ about the 'userset' and 'usersetfast'
	  SQLAuthenticate options.

2009-03-24 22:30  castaglia

	* RELEASE_NOTES, doc/contrib/mod_sql.html:
	  Update the SQLUserInfo docs to mention the fix for Bug#2434.
	  Mention this in the release notes as well.

2009-03-24 22:03  castaglia

	* NEWS, contrib/mod_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Bug#2434 - Buggy interaction between custom SQLUserInfo and
	  'userset' SQLAuthenticate parameter.

	  Fixing this required supporting a couple of other SQLNamedQuery
	  names, optional, to handle the 'userset' and 'usersetfast' cases.

2009-03-24 10:50  castaglia

	* RELEASE_NOTES:
	  Don't forget to mention the new %{protocol} variable in the
	  release notes.

2009-03-23 23:23  castaglia

	* NEWS, contrib/mod_quotatab.c, contrib/mod_ratio.c,
	  contrib/mod_site_misc.c, contrib/mod_tls.c,
	  contrib/mod_sftp/auth.c, contrib/mod_sftp/fxp.c,
	  contrib/mod_sftp/scp.c, include/dirtree.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_facts.c, modules/mod_ls.c,
	  modules/mod_xfer.c, src/dirtree.c, tests/tests.pl,
	  tests/t/config/limit/filters.t,
	  tests/t/lib/ProFTPD/Tests/Config/Limit/Filters.pm:
	  Bug#2067 - Allow/Deny Filters should be supported in the <Limit>
	  context.

2009-03-23 14:27  castaglia

	* NEWS, contrib/mod_quotatab.c, contrib/mod_quotatab.h,
	  contrib/mod_quotatab_file.c, contrib/mod_quotatab_ldap.c,
	  contrib/mod_quotatab_radius.c, contrib/mod_quotatab_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Bug#3161 - Updating tallies for deleted files should occur based
	  on file ownership.

	  Fixing this bug required changing the mod_quotatab API such that
	  the limit and tally objects into which data is read/written (from
	  the backend modules) are part of the API calls, rather than using
	  globals.  That's why there's so much code churn for this
	  particular fix.  But it's a Good Thing; these changes make fixing
	  other types of quota bugs much easier now.

2009-03-22 19:04  castaglia

	* doc/contrib/mod_rewrite.html:
	  Update the mod_rewrite docs to mention the Bug#3028 fix.

2009-03-22 18:59  castaglia

	* NEWS, contrib/mod_rewrite.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Bug#3028 - Unable to escape special characters in RewriteRule
	  substitution string.

2009-03-22 18:15  castaglia

	* modules/mod_ls.c:
	  When handling the LIST output, the outputfiles() function used to
	  do 4 sorts, linearly scanning the list of files built up using
	  addfile().  Ostensibly this list is used for sorting 1) a la -t
	  or -S, and 2) for supporting -C.  These 4 sorts are needed only
	  for -C, which is not used that often.  Thus it is now
	  conditional.

	  In the future, the entire use of the struct filename structure
	  (and the allocations out of the fpool pool which need to be freed
	  after all of the sorting) can be avoided for every case _except_
	  when -C, -S, or -t is used.  This too can add some performance
	  gains to the perceived LIST response time.

2009-03-22 18:12  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/LIST.pm:
	  Add a unit test for Bug#2821 for the LIST command as well.  It
	  is/can be useful for diagnosing/tuning the performance of the
	  time needed to free all of the struct filename structures
	  allocated for LIST entries (needed for the potential -C sorting).
	   Further gains can be done by *only allocating* these structures
	  if the -C option is used.

	  Add a unit test using LIST -C, also for such tests.

2009-03-22 11:46  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Directory/Lookups.pm:
	  More work on the <Directory>-related performance tests.

2009-03-21 21:47  castaglia

	* src/: cmd.c, main.c:
	  Fix the code in pr_cmd_get_displayable_str() to be a little
	  easier to follow in my head.	(Also easier to debug.)

	  If we are going to be truncating an incoming FTP command because
	  of the CommandBufferSize, log about this.  Silent truncations are
	  annoying to track down.

2009-03-21 21:13  castaglia

	* modules/mod_core.c:
	  There is no reason to mark absolute paths in <Directory> sections
	  for deferred resolution; it only adds to the login time (due to
	  the running time of the resolve_deferred_dirs() function)
	  needlessly.

2009-03-21 20:31  castaglia

	* src/main.c:
	  Quell compiler warning.

2009-03-21 18:38  castaglia

	* doc/howto/Globbing.html:
	  Updating the Globbing howto to mention the tunable name
	  changes/additions.

2009-03-21 18:30  castaglia

	* include/options.h, lib/glibc-glob.c, src/main.c:
	  Add new PR_TUNABLE_GLOBBING_MAX_MATCHES tunable, as part of
	  Bug#2821.

2009-03-21 18:27  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Commands/LIST.pm,
	  t/lib/ProFTPD/Tests/Commands/NLST.pm:
	  Add a test case used for tracking down part of Bug#2821.  It's a
	  slow test, so make sure that it is not run as part of the default
	  testsuite.

2009-03-21 18:11  castaglia

	* modules/mod_ls.c:
	  Set the GLOB_NOSORT flag, by default, for NLST globs.  This can
	  help to speed up the glob(3) call by not requiring that the
	  results be sorted.  This can be changed via NLST options (and the
	  ListOptions directive).

	  Add some debug logging on the number of matched paths found by
	  glob(3), to aid in debugging cases where glibc's glob limits are
	  encountered, e.g. Bug#2821.

2009-03-21 16:08  castaglia

	* modules/mod_ls.c:
	  Improve NLST performance by NOT telling sendline() to flush
	  _after each NLST line added_.  That defeats the whole purpose of
	  having a buffer for sending lines in batches.

2009-03-20 21:01  castaglia

	* src/pool.c:
	  Optimize for the most common case; this is frequently called
	  function.

2009-03-20 16:03  castaglia

	* contrib/mod_sftp/scp.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Make sure that scp uploading a file into a nonexistent subdir a)
	  fails, and b) does NOT cause a disconnect.

2009-03-20 16:02  castaglia

	* contrib/mod_sftp/: disconnect.c, disconnect.h:
	  Clean up the disconnect trace log message a little when the
	  __FUNC__ (or equivalent) macro is not supported by the compiler.

2009-03-20 12:01  castaglia

	* NEWS, include/dirtree.h, modules/mod_core.c, src/dirtree.c,
	  src/main.c:
	  Bug#3221 - Command line defines (-D/--define) are lost on SIGHUP.

2009-03-20 09:58  castaglia

	* doc/howto/ASCII.html:
	  Add a FAQ about why the ASCII mode restriction was placed on the
	  SIZE command.

2009-03-19 17:03  castaglia

	* modules/mod_core.c:
	  Make sure that any stat cache is cleared when answering a SIZE
	  command.

2009-03-19 10:09  castaglia

	* contrib/mod_sftp/configure:
	  Updated mod_sftp's configure.

2009-03-19 10:02  castaglia

	* contrib/mod_sftp/: configure.in, crypto.c, mod_sftp.h.in:
	  Add an autoconf check for the EVP_aes_{192,256}_cbc() symbols in
	  OpenSSL.  Solaris 10 shipped a crippled OpenSSL for a while,
	  where AES support for bit lengths greater than 128 were removed.

2009-03-18 23:04  castaglia

	* contrib/mod_sftp/: auth-hostbased.c, auth-kbdint.c,
	  auth-password.c, auth-publickey.c, auth.c, auth.h:
	  Rewriting the user name in SSH2 authentication is a little bit
	  trickier, since we need to track both the original user name sent
	  by the client (for signature verification and such) as well as
	  the (possibly rewritten) user name, for
	  authentication/authorization.

2009-03-18 22:51  castaglia

	* contrib/mod_sftp/auth.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Make sure that mod_rewrite can be used to rewrite the user names
	  given during SSH2 authentication as well.

2009-03-18 22:39  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add unit tests for the SCP+mod_rewrite cases.

2009-03-18 22:39  castaglia

	* contrib/mod_sftp/: channel.c, fxp.c, scp.c:
	  Make sure that mod_rewrite can be applied to SCP commands as
	  well.

2009-03-18 22:00  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Unit tests validating the use of mod_rewrite to rewrite SFTP
	  requests.

2009-03-18 21:58  castaglia

	* contrib/mod_rewrite.c:
	  Add a comment about why there's a test for a SYMLINK command in
	  mod_rewrite.

2009-03-18 21:57  castaglia

	* contrib/: mod_rewrite.c, mod_sftp/fxp.c:
	  The handling of SFTP requests now honors PRE_CMD handlers such as
	  mod_rewrite; this means you can use mod_rewrite on SFTP requests,
	  just like you would on FTP commands.

2009-03-18 18:40  castaglia

	* doc/howto/Compiling.html:
	  Match the example configure options to their surrounding text.

2009-03-18 16:48  castaglia

	* doc/contrib/mod_rewrite.html:
	  Updated mod_rewrite docs to cover the %{ENV:var} syntax.

2009-03-18 16:32  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_rewrite.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Bug#3219 - Support environment variable substitutions in
	  mod_rewrite rules.

2009-03-18 11:08  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Directory/Umask.pm:
	  Add unit test for globbing <Directory> with Umask, trying
	  unsuccessfully to reproduce an issue reported on the users
	  mailing list.

2009-03-18 09:03  castaglia

	* NEWS, contrib/mod_ban.c:
	  Bug#3187 - Inconsistent mod_ban logging and display when using
	  "BanEngine off" in an <IfClass> configuration.

2009-03-18 09:01  castaglia

	* contrib/mod_sftp/rfc4716.c:
	  Add a reminder comment for admins, should there be trouble
	  parsing an AuthorizedKeys file, to make sure that the file is in
	  the correct format.

2009-03-17 22:34  castaglia

	* src/bindings.c:
	  Enhance the patch for Bug#2680 even further, to properly handle
	  connections to an IPv6 socket, and still looking for vhosts
	  configured for the IPv4 wildcard address before finally falling
	  back to DefaultServer.

2009-03-17 17:23  castaglia

	* doc/howto/Limit.html:
	  Should include the EPRT and EPSV commands in the example for
	  specifying only one kind of data transfer (active or passive).

2009-03-17 16:47  castaglia

	* doc/howto/Limit.html:
	  Update the Limit docs to mention MLSD and MLST.

2009-03-16 23:09  castaglia

	* contrib/mod_sftp/fxp.c:
	  The reading of ATTRS for SFTP protocol versions greater than 3
	  was using the old file attribute flag values.

2009-03-16 22:36  castaglia

	* src/dirtree.c:
	  Fix another possible cause of Bug#3184: rewind to the start of
	  the /etc/protocols file via a call to setprotoent(3), if
	  available.

2009-03-16 17:16  castaglia

	* NEWS, RELEASE_NOTES, src/bindings.c:
	  Bug#2680 - Add support for <VirtualHost 0.0.0.0>.

2009-03-16 16:26  castaglia

	* contrib/mod_sql.c, modules/mod_log.c:
	  Make sure that %V gets resolved to the DNS name of the IP address
	  to which the client connected.  This can differ from what is
	  expected, e.g. when DefaultServer marks a vhost (which is for a
	  different IP address) that handles the connection.

2009-03-16 09:47  castaglia

	* modules/mod_facts.c, tests/t/lib/ProFTPD/Tests/Commands/MLSD.pm:
	  The MLSD command, as per RFC, does not support glob characters.
	  However, this does not mean that we should error out on an MLSD
	  command which does contain glob characters; there could be a
	  valid directory with such characters in the path.

2009-03-14 10:59  castaglia

	* contrib/mod_sftp/rfc4716.c:
	  When parsing RFC4716 formatted keys, make sure the input buffer
	  is large enough to handle the longest allowable line: 72 bytes +
	  CRLF + NUL = 75 bytes.  And if the line is "too long", log that
	  length.

2009-03-13 13:38  castaglia

	* doc/howto/Quotas.html:
	  Another common cause of quota tallies not being updated.

2009-03-13 08:55  castaglia

	* src/inet.c:
	  Jess Alastruey pointed out there was an off-by-one bug in the
	  handling of the PassivePorts port selection code.  The highest
	  port number was not being properly shuffled.

2009-03-12 15:20  castaglia

	* configure:
	  Updated configure.

2009-03-12 15:17  castaglia

	* configure.in:
	  Guard against empty --with-FOO arguments; these lead to strange
	  build failures such as:

	    configure: error: source file './modules/d_ident.c' cannot be
	  found -- aborting

2009-03-12 10:43  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Return the %preun RPM build state to its previous implementation;
	  no need to futz with it for Bug#2613.

2009-03-12 10:23  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Updating the proftpd.spec to match Bug#2613.

2009-03-12 10:13  castaglia

	* configure:
	  Updated configure.

2009-03-12 10:11  castaglia

	* NEWS, RELEASE_NOTES, configure.in:
	  Bug#2613 - Configure script should not append '/proftpd' to the
	  --localstatedir.

2009-03-11 20:36  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add unit tests for the SSL session reuse requirement for data
	  transfers, and that using the NoSessionReuseRequired TLSOption
	  does in fact relax this requirement properly.

2009-03-11 19:57  castaglia

	* modules/mod_xfer.c:
	  If pr_data_sendfile() fails because of EOVERFLOW, fall back to
	  transmitting the data normally.  Less distracting for admins this
	  way.

2009-03-11 19:55  castaglia

	* contrib/mod_tls.c:
	  Fix stale pointer segfault caused when an FTPS client fails to
	  reuse the SSL session from the control connection for a data
	  transfer, and the SSL session has to be shut down.

2009-03-11 09:34  castaglia

	* contrib/mod_tls.c:
	  Stylistic cleanups in tls_verify_crl().

2009-03-11 09:33  castaglia

	* tests/t/: etc/modules/mod_tls/ca-crl.pem,
	  etc/modules/mod_tls/client-cert.pem,
	  lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add a unit test for TLSCARevocationFile.  Note that this
	  currently requires a hacked version of Net::FTPSSL; I am
	  contributing the patch to the upstream author.  (The patch is
	  necessary to configure the client cert that a Net::FTPSSL client
	  will present when talking to an FTPS server.)

2009-03-11 07:59  castaglia

	* doc/howto/Compiling.html:
	  Note the additional behavior when --enable-devel=coredump is used
	  (and emphasis why this is a Bad Idea unless you really know what
	  you're doing).

2009-03-10 21:52  castaglia

	* doc/contrib/mod_wrap2_sql.html:
	  Fix the mod_wrap2_sql documentation, thanks to Szymon Juraszczyk.

2009-03-10 21:50  castaglia

	* contrib/mod_wrap2_file.c, contrib/mod_wrap2_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_wrap2_file.pm,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_wrap2_sql.pm:
	  Further improvements to the fix for Bug#3048 and Bug#3215 from
	  Szymon Juraszczyk.

2009-03-10 16:26  castaglia

	* NEWS, contrib/mod_wrap2_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_wrap2_sql.pm:
	  Bug#3215 - mod_wrap2_sql should support comma-delimited lists of
	  clients.

2009-03-10 09:59  castaglia

	* contrib/mod_ban.c, contrib/mod_ctrls_admin.c, contrib/mod_tls.c,
	  include/compat.h, include/ctrls.h, include/mod_ctrls.h,
	  modules/mod_ctrls.c, modules/mod_delay.c, modules/mod_dso.c,
	  src/ctrls.c, src/ftpdctl.c:
	  Bug#3211 - Compile error when using --enable-ctrls
	  --with-shared=mod_ctrls.

2009-03-10 00:00  castaglia

	* RELEASE_NOTES, doc/contrib/mod_tls_shmcache.html:
	  Added docs for mod_tls_shmcache.html.

2009-03-09 23:53  castaglia

	* contrib/mod_tls_shmcache.c:
	  Forgot to include the $Libraries$ hint for mod_tls_shmcache.c.
	  Useful for when it is compiled as a shared modulel via prxs.

2009-03-09 23:52  castaglia

	* doc/contrib/mod_tls.html:
	  Typo.

2009-03-09 23:28  castaglia

	* RELEASE_NOTES, doc/contrib/mod_tls.html:
	  Add docs for the NoSessionReuseRequired TLSOption added in
	  Bug#3210.

2009-03-09 23:26  castaglia

	* contrib/mod_tls.c:
	  Typo.

2009-03-09 23:17  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_tls.c:
	  Bug#3210 - Data transfers protected by SSL/TLS should reuse the
	  control connection SSL session.

2009-03-09 23:06  castaglia

	* RELEASE_NOTES:
	  Mention the new directives and module.  Fuller descriptions will
	  be added later.

2009-03-09 23:04  castaglia

	* doc/contrib/mod_tls.html:
	  Update the mod_tls docs to include TLSControlsACLs,
	  TLSSessionCache, and the new mod_tls ftpdctl actions.

2009-03-09 23:02  castaglia

	* contrib/mod_tls.c:
	  Include the name of the external session cache in the 'clear' and
	  'remove' action outputs.

2009-03-09 22:55  castaglia

	* contrib/mod_tls_shmcache.c:
	  Add some identifying information about the module itself in the
	  status output.

2009-03-09 22:28  castaglia

	* contrib/mod_tls.c:
	  Make the default external SSL session cache timeout 30 minutes.
	  FTPS sessions are longer than HTTPS requests, hence why our
	  default session timeout is longer than OpenSSL's default (which
	  is 5 minutes).

2009-03-09 22:13  castaglia

	* contrib/mod_tls_shmcache.c:
	  Add new contrib module, mod_tls_shmcache, which provides a
	  shared-memory (SysV IPC shared memory) implementation for SSL
	  session caching among multiple processes.  Need at least one
	  implementation of an external SSL session cache for Bug#3207.

2009-03-09 22:10  castaglia

	* NEWS, contrib/mod_tls.c, contrib/mod_tls.h:
	  Bug#3207 - Support for SSL/TLS session caching across
	  processes/machines.

2009-03-09 20:11  castaglia

	* contrib/mod_tls.c:
	  Once we know the vhost handling the connection, use that vhost
	  pointer as the "session ID context" for SSL/TLS sessions.  This
	  ensures that SSL sessions to different vhosts (which may have
	  different SSL security policies configured) end up in different
	  groups (i.e. no chance of session ID collision between sessions
	  to two different vhosts).

2009-03-09 19:47  castaglia

	* doc/howto/Limit.html:
	  Add another example <Limit> config, for a read-only account.

2009-03-09 16:04  castaglia

	* contrib/mod_ban.c:
	  Pedantic ANSI C compilers might complain about the trailing
	  comma.

2009-03-09 10:26  castaglia

	* contrib/mod_tls.c:
	  If TLSCACertificatePath is configured, properly skip the "." and
	  ".." directories.  The code was there, but it was not doing this
	  properly (it was trying to read "." and ".." as filenames in that
	  directory, and thus littering the TLSLog with ugly, unnecessary
	  messages).

2009-03-09 09:26  castaglia

	* doc/howto/Limit.html:
	  Example <Limit> config of making a directory undeletable, but
	  allowing its subdirectories to be deletable.

2009-03-09 09:07  castaglia

	* src/proftpd.8.in, utils/ftpcount.1.in, utils/ftpscrub.8.in,
	  utils/ftptop.1.in, utils/ftpwho.1.in:
	  Bug#3212 - Duplicate '/run/' in manpages.

2009-03-08 18:43  castaglia

	* contrib/mod_tls.c:
	  Typo.

2009-03-08 18:29  castaglia

	* contrib/mod_tls.c:
	  If the EnableDiags TLSOption is enabled, log some SSL session
	  stats when the session ends.

2009-03-07 19:16  castaglia

	* contrib/mod_ban.c:
	  Typo.

2009-03-06 22:12  castaglia

	* contrib/mod_sftp/kbdint.c:
	  Need to return -1, not zero, if we fail to unregister a
	  'keyboard-interactive' driver for some reason.

2009-03-06 19:49  castaglia

	* contrib/mod_sftp_pam.c:
	  Add the same macro for const-ness (or not) for the pam_conv
	  function prototype as done in mod_auth_pam to mod_sftp_pam.

2009-03-06 18:00  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Bug#2652 - Installing standard RPM fails when /home mounted from
	  NFS filesystem on root_squashed host.  Add support for `rpmbuild
	  --define 'nohome 1' ...' in the provided proftpd.spec.

2009-03-06 16:25  castaglia

	* NEWS, RELEASE_NOTES, contrib/dist/rpm/proftpd.spec:
	  Bug#2985 - Newest .spec file requires relatively current version
	  of RPM.

2009-03-06 12:10  castaglia

	* contrib/mod_tls.c:
	  If we get to the point that we need to generate our own random
	  seed data for OpenSSL's PRNG, then allocate some uninitialized
	  memory off the heap and use that for the seed.  This complements
	  the existing use of uninitialized stack data as part of the
	  generated seed.

2009-03-05 15:17  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Added a unit test for the case where mod_sftp and mod_vroot are
	  used, and the SFTP client sends an OPENDIR request to a path
	  which happens to be a symlink to a path which lies outside of the
	  vroot area.  What a mess.

2009-03-05 15:16  castaglia

	* doc/contrib/mod_sftp.html:
	  The mod_sftp modules DOES support UseLastlog now.

2009-03-05 15:15  castaglia

	* contrib/mod_sftp/fxp.c:
	  When handling an OPENDIR request, resolve the given path to the
	  best local path before calling pr_fsio_opendir().  In most cases,
	  this is not important.  But when using mod_vroot and the path
	  being opened is a symlink to another directory, it IS important.

	  Also log to the "fileperms" log channel if pr_fsio_readlink()
	  fails when handling a READLINK request.

2009-03-05 13:29  castaglia

	* src/dirtree.c:
	  Minor stylistic cleanups.

2009-03-05 13:18  castaglia

	* contrib/mod_sftp/auth.c, modules/mod_auth.c:
	  Update mod_sftp to use the new pr_auth_get_home() function (for
	  honoring any RewriteHome configuration).

	  Change the timing of the call to pr_auth_get_home() in mod_auth,
	  so that it happens *before* any substitution of variables (e.g.
	  '%u') in the home dir.  This allows the rewritten home directory
	  to contain variables like '%u'.

2009-03-05 13:13  castaglia

	* RELEASE_NOTES:
	  Updated release notes with info about RewriteHome.

2009-03-05 13:09  castaglia

	* tests/: tests.pl, t/config/rewritehome.t,
	  t/lib/ProFTPD/Tests/Config/RewriteHome.pm:
	  Added unit test for the new RewriteHome configuration directive.

2009-03-05 10:56  castaglia

	* NEWS, contrib/mod_rewrite.c, include/auth.h, modules/mod_auth.c,
	  src/auth.c:
	  Bug#3167 - Support rewriting of home directories.

2009-03-04 23:08  castaglia

	* modules/mod_core.c:
	  Tell the admin to allocate a larger PassivePorts range, when we
	  encounter the case where a port in the defined PassivePorts range
	  cannot be used because all PassivePorts ports are in use.

2009-03-04 22:01  castaglia

	* contrib/mod_rewrite.c, contrib/mod_wrap2_file.c,
	  contrib/mod_sftp/rfc4716.c, include/fsio.h, src/display.c,
	  src/fsio.c, modules/mod_facts.c, src/netio.c, src/parser.c,
	  modules/mod_ls.c:
	  Replace the use of static buffers of size PR_TUNABLE_BUFFER_SIZE
	  in many placese with dynamically allocated buffers of more
	  optimal sizes.  See Bug#3206 for more details.

2009-03-04 21:24  castaglia

	* modules/mod_auth_pam.c:
	  Make extra sure that our PAM_CONST macro doesn't collide with any
	  system macro of the same name by calling it PR_PAM_CONST.

2009-03-04 20:57  castaglia

	* modules/mod_auth_pam.c:
	  I finally got tired of seeing this compiler warning:

	    mod_auth_pam.c:88: warning: function declaration isn't a
	  prototype

	  because mod_auth_pam used K&R style (for some reason) in one
	  place.  So fix it up to be ANSI style, and deal with the
	  platform-specific const-ness of one of the arguments.

2009-03-04 16:33  castaglia

	* contrib/mod_sftp/fxp.c:
	  Clients using later SFTP protocol versions can include attribute
	  flags in the stat (STAT, FSTAT, LSTAT) requests to indicate the
	  specific attributes in which the client is interested.  Even
	  though mod_sftp does not honor these hints, it now logs the text
	  version of those flags; previously it was simply logging the raw
	  value.  As a bitmask, this logged number was not especially
	  enlightening.

	  Also added logging of the textified flags which are unsupported,
	  in the case of an OPEN request which is rejected because of
	  unsupported flags in the request.

2009-03-04 12:15  castaglia

	* src/dirtree.c:
	  Corrected stale/misleading comment.

2009-03-04 10:44  castaglia

	* modules/mod_auth_unix.c, src/auth.c:
	  Fix the implementation of pr_auth_authorize().  Now,
	  mod_auth_unix (the only known 'authorize' handler at present)
	  will explicitly return ERROR to the 'authorize' call if the user
	  is not authorized.  This way, an 'authorize' dispatch which gets
	  a result of HANDLED or DECLINED treats the user as "authorized".
	  The DECLINED case means that a user can be authenticated via e.g.
	  mod_sql (which does NOT provide an 'authorize' handler), and be
	  successfully authorized as well.

2009-03-04 10:30  castaglia

	* contrib/mod_sftp/interop.c:
	  Include the SSH2 client version info in the TraceLog.

2009-03-04 10:10  castaglia

	* contrib/mod_sftp/keys.c:
	  Add trace logging for channel "ssh2", level 17, of reasons why
	  key mismatches occur.

2009-03-04 09:42  castaglia

	* contrib/mod_sftp_sql.c:
	  Be a little more clear when logging why a key comparison failed
	  (i.e.  differentiate between "comparison failure" and "key
	  mismatch").

2009-03-04 09:41  castaglia

	* contrib/mod_sftp/: crypto.c, kex.c, mac.c:
	  Make mod_sftp compile properly when dealing with older versions
	  of OpenSSL (e.g. OpenSSL versions older than 0.9.7).

2009-03-04 08:21  castaglia

	* NEWS, src/prxs.in:
	  Bug#3204 - Better support for installation and libs in prxs.

2009-03-03 22:47  castaglia

	* contrib/mod_sftp/: channel.c, fxp.c:
	  Include more info in the dispatched cmd_recs, e.g. channel IDs.

2009-03-03 22:11  castaglia

	* doc/howto/ServerType.html:
	  Add a real xinetd config example to the ServerType howto, rather
	  than having the broken UserGuide link.

2009-03-03 22:06  castaglia

	* contrib/mod_sql.c, modules/mod_auth.c, modules/mod_log.c:
	  More work towards Bug#2715.  This moves the storage of the
	  anonymous password to the session.notes table, and out of the
	  config tree.

2009-03-03 16:57  castaglia

	* doc/modules/mod_delay.html:
	  Add some mod_delay FAQs.

2009-03-03 15:41  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#3203 - Missing SQL backend modules can lead to null pointer
	  segfault in mod_sql.

2009-03-03 10:29  castaglia

	* src/Makefile.in, utils/Makefile.in:
	  Turns out that deleting files (via 'make clean) generated at
	  configure time, rather than at compile time, is a bad idea.  You
	  can do several 'make clean && make install' invocations with one
	  configure invocation; the install step complains about missing
	  files (i.e. the generated ones) after they've been deleted
	  unnecessarily.

2009-03-03 09:06  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  String formatting fixed, as per Bug#3197.

2009-03-02 23:59  castaglia

	* contrib/mod_quotatab_file.c:
	  Remove the log messages about EOF; they proved to be too annoying
	  and not as helpful as one would like.

2009-03-02 23:59  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#3196 - mod_quotatab does not honor last group in supplemental
	  group list.

2009-03-02 23:47  castaglia

	* tests/: tests.pl,
	  t/etc/modules/mod_quotatab_file/ftpquota.limittab,
	  t/etc/modules/mod_quotatab_file/ftpquota.tallytab,
	  t/lib/ProFTPD/Tests/Modules/mod_quotatab_file.pm,
	  t/modules/mod_quotatab_file.t:
	  Add a unit test for mod_quotatab_file.

2009-03-02 15:48  castaglia

	* modules/mod_facts.c, tests/t/lib/ProFTPD/Tests/Commands/MLSD.pm,
	  tests/t/lib/ProFTPD/Tests/Commands/MLST.pm:
	  Make sure that the MLST and MLSD command handlers can handle
	  paths with spaces in them.  This is essentially the same bug as
	  Bug#3142; the fix for that bug was not properly extended to the
	  MLST and MLSD commands.

2009-03-02 09:56  castaglia

	* include/support.h:
	  Remove the declaration of the now-obsolete set_protocol_name()
	  function.

2009-03-02 09:22  castaglia

	* RELEASE_NOTES:
	  Mention the Korean translation.

2009-03-02 09:21  castaglia

	* locale/: Makefile.in, ko_KR.po:
	  Bug#3194 - Add Korean translation.

2009-03-02 09:21  castaglia

	* locale/ko_KR.po: file ko_KR.po was added on branch B1_3_2 on
	  2009-04-28 22:50:22 +0000

2009-02-27 14:32  castaglia

	* contrib/mod_sftp/kex.c:
	  Copy the client-sent language lists out of the kex pool, not out
	  of the packet pool.

2009-02-26 16:23  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Add unit tests for the one-hostkey-only mod_sftp configurations.

2009-02-26 16:22  castaglia

	* doc/contrib/mod_sftp.html:
	  Update the mod_sftp docs to mention that only one SFTPHostKey is
	  now required.

2009-02-26 16:20  castaglia

	* contrib/mod_sftp/: kex.c, keys.c, keys.h, mod_sftp.c:
	  Fix bug when handling language lists; I forgot to initialize the
	  server's language list, even if it is to the empty string.

	  Also make mod_sftp more lenient with regard to host keys.  It
	  will now function if only one host key, be it RSA or DSA, is
	  configured.

2009-02-26 15:14  castaglia

	* contrib/mod_sftp/kex.c:
	  Start implementing support for negotiated languages in the key
	  exchange.  For now, actually read (and log) the list of languages
	  sent by the client.

2009-02-26 14:35  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sftp.pm:
	  Fix the permissions on the test hostkey files so that mod_sftp
	  won't complain about them.

2009-02-26 14:04  castaglia

	* locale/fr_FR.po:
	  Updated French translation from the translator.

2009-02-26 14:04  castaglia

	* locale/fr_FR.po: file fr_FR.po was added on branch B1_3_2 on
	  2009-04-28 22:50:22 +0000

2009-02-26 13:43  castaglia

	* contrib/mod_sftp/channel.c:
	  When sending WINDOW_ADJUST messages to the client, mod_sftp needs
	  to use the (possibly) SFTPClientMatch adjusted window size, not
	  the default window size.

2009-02-26 12:31  castaglia

	* modules/mod_facts.c:
	  The response to MLST was sending the info, and terminating the
	  line with an extra LF, e.g. "dataLFCRLF", rather than just a
	  normal CRLF.

2009-02-21 18:49  castaglia

	* contrib/mod_sftp/fxp.c:
	  Update mod_sftp so that it too uses the new
	  pr_filter_allow_path() function.

2009-02-21 18:48  castaglia

	* contrib/mod_sftp/utf8.c:
	  Fix the compilation of mod_sftp when --enable-nls is NOT used.

2009-02-21 17:51  castaglia

	* modules/mod_core.c, modules/mod_xfer.c,
	  tests/t/lib/ProFTPD/Tests/Config/PathAllowFilter.pm,
	  tests/t/lib/ProFTPD/Tests/Config/PathDenyFilter.pm:
	  Updated mod_core so that it uses pr_filter_allow_path(), rather
	  than looking up and comparing against the
	  PathAllowFilter/PathDenyFilter directives directly.  Provide
	  accompanying tests to show that no functionality has been broken
	  in this refactoring.

2009-02-21 16:28  castaglia

	* Make.rules.in, include/conf.h, include/filter.h,
	  modules/mod_xfer.c, src/filter.c:
	  Consolidate the checking of a path against the PathAllowFilter
	  and PathDenyFilter directives into a common
	  pr_filter_allow_path() function, rather than having the checking
	  of those directives repeatedly done throughout the code.

	  Right now, only the STOR handler in mod_xfer has been updated to
	  use this new pr_filter_allow_path() function; more updates for
	  the rest of the core code will be coming.

2009-02-21 16:24  castaglia

	* utils/.cvsignore:
	  Ignore the generated ftpscrub.8 man page in CVS commands.

2009-02-21 16:22  castaglia

	* src/log.c:
	  Implement pr_log_writefile() so that it calls
	  pr_log_vwritefile(), just like the other module logging functions
	  do.

2009-02-21 16:09  castaglia

	* tests/: tests.pl, t/config/pathallowfilter.t,
	  t/config/pathdenyfilter.t,
	  t/lib/ProFTPD/Tests/Config/PathAllowFilter.pm,
	  t/lib/ProFTPD/Tests/Config/PathDenyFilter.pm:
	  Added unit tests for the PathAllowFilter and PathDenyFilter
	  directives.  Will be adding more tests for this directives,
	  involving other FTP commands, soon.

2009-02-20 22:19  castaglia

	* contrib/mod_quotatab.c, contrib/mod_quotatab.h,
	  contrib/mod_radius.c, contrib/mod_sql.c, contrib/mod_tls.c,
	  contrib/mod_wrap2/mod_wrap2.c, contrib/mod_wrap2/mod_wrap2.h.in,
	  include/log.h, include/mod_ctrls.h, modules/mod_ctrls.c,
	  src/log.c:
	  The changes to the logging functions made earlier today pointed
	  out to me the fact that many of the contrib modules -- and even
	  mod_ctrls -- had functionally duplicative logging functions as
	  the core pr_log_writefile() function.  And why have duplicated
	  code when it isn't necessary?

	  To address this, a new pr_log_vwritefile() function has been
	  added.  This function, rather than be a varargs-style function
	  like pr_log_writefile(), takes a va_list parameter.  This makes
	  it suitable for calling by the contrib modules' own logging
	  functions, which themselves are varargs-style functions.

	  While I was at it, I made sure that these logging functions are
	  checked via gcc's __attribute__ pragma (where it wasn't already
	  being done), and cleaned up the resulting compiler warnings.

2009-02-20 22:14  castaglia

	* contrib/mod_sql.c:
	  Fix a stylistic nit in sql_addgroup.	The cnt variable had an
	  unnecessarily large scope, and the gr_mem array of strings should
	  be terminated with a NULL, not a '\0' (NUL character).

2009-02-20 22:11  castaglia

	* .cvsignore:
	  Add the new ftpscrub utility to the cvs ignore list.

2009-02-20 17:13  castaglia

	* contrib/mod_tls.c:
	  Be a little paranoid, and keep X509_NAME_oneline() from using the
	  entire buffer; reserve one character for NUL.

2009-02-20 14:47  castaglia

	* contrib/mod_quotatab.c, contrib/mod_radius.c, contrib/mod_sql.c,
	  contrib/mod_tls.c, contrib/mod_wrap2/mod_wrap2.c,
	  modules/mod_ctrls.c, src/log.c:
	  Fix the logging functions to handle long log messages properly.

2009-02-20 09:19  castaglia

	* NEWS, modules/mod_facts.c,
	  tests/t/lib/ProFTPD/Tests/Commands/MLSD.pm,
	  tests/t/lib/ProFTPD/Tests/Commands/MLST.pm:
	  Bug#3190 - MLSD/MLST do not honor <Limit> configurations.

2009-02-19 09:45  castaglia

	* src/ftpscrub.c, utils/ftpscrub.c:
	  Forgot to move the ftpscrub.c source from from src/ to utils/,
	  along with the its man pages and build rules.

2009-02-19 09:34  castaglia

	* contrib/mod_sftp/: mod_sftp.c, utf8.c, utf8.h:
	  Make mod_sftp honor the UseEncoding directive iff it has been
	  used in the two-argument form.  In this particular case, the
	  client encoding is dictated by the IETF Draft for SFTP to be
	  UTF8, but the admin can now use UseEncoding to set the local
	  charset that mod_sftp should use.

2009-02-18 13:55  castaglia

	* RELEASE_NOTES, doc/howto/Scoreboard.html:
	  Mention the ScoreboardScrub directive in the release notes, and
	  update the Scoreboard howto to mention this new directive.

2009-02-18 13:40  castaglia

	* configure:
	  Updated configure.

2009-02-18 13:40  castaglia

	* src/Makefile.in, src/ftpscrub.8.in, utils/Makefile.in,
	  utils/ftpscrub.8.in:
	  Put the ftpscrub.8.in man page template in the wrong directory;
	  should have been in utils/, not in src/.

2009-02-18 13:33  castaglia

	* NEWS, Make.rules.in, Makefile.in, configure.in,
	  modules/mod_core.c, src/Makefile.in, src/ftpscrub.8.in,
	  src/ftpscrub.c, utils/Makefile.in, utils/scoreboard.c,
	  utils/utils.h:
	  Bug#3129 - Support configurable scoreboard scrubbing.

2009-02-18 13:24  castaglia

	* contrib/mod_sql_postgres.c:
	  Minor OCD reordering.

2009-02-18 10:54  castaglia

	* contrib/mod_sftp/disconnect.h:
	  Helps if the comment matches the code.

2009-02-18 10:53  castaglia

	* contrib/mod_sftp/disconnect.h:
	  Handle the lack of __FUNCTION__ (a gcc extension) better.  Try to
	  use __func__ if present (Sun compilers use this), and have a
	  fallback of "(unknown)" for other cases.

2009-02-18 10:24  castaglia

	* src/wtmp.c:
	  Finally get rid of these compiler warnings:

	    wtmp.c:38: warning: unused variable `ut'
	    wtmp.c:39: warning: unused variable `fd'

	  on Solaris systems.

2009-02-18 10:01  castaglia

	* NEWS, contrib/mod_sql_postgres.c:
	  Bug#3176 - Postgres chokes on standard charset names.

2009-02-17 10:26  castaglia

	* Makefile.in, NEWS:
	  Bug#3189 - Linker errors occur when using "make -j" parallel
	  builds.

2009-02-17 09:06  castaglia

	* lib/libltdl/Makefile.in:
	  Forgot to re-apply the libltdl modifications to disable the
	  actions that try to use autoheader and automake.  These aren't
	  installed on every system, and we don't really use them.

2009-02-16 21:59  castaglia

	* RELEASE_NOTES, doc/contrib/mod_tls.html:
	  Update the docs for the new PKCS#12 file support in mod_tls.

2009-02-16 21:51  castaglia

	* NEWS, contrib/mod_tls.c,
	  tests/t/etc/modules/mod_tls/server-cert.p12,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Bug#3111 - Support SSL/TLS server certificates stored in PKCS#12
	  files.

2009-02-16 21:30  castaglia

	* NEWS, configure:
	  Bug#3154 - Update bundled libtool version.  The bundled libltdl
	  version has been updated to libtool-1.5.26.

2009-02-16 21:27  castaglia

	* aclocal.m4, ltmain.sh:
	  More towards Bug#3154.

2009-02-16 21:26  castaglia

	* lib/libltdl/configure:
	  Update configure, so that make doesn't think it needs to
	  regenerate the configure file.  (The configure file needs a newer
	  timestamp than the configure.ac file, otherwise the Makefile will
	  try to make a new configure.)

2009-02-16 21:22  castaglia

	* lib/libltdl/: COPYING.LIB, Makefile.am, Makefile.in,
	  acinclude.m4, aclocal.m4, config.guess, config.sub, configure,
	  configure.ac, install-sh, ltdl.c, ltdl.h, ltmain.sh, missing:
	  Bug#3154 - Update bundled libtool version.

2009-02-16 21:07  castaglia

	* src/Makefile.in:
	  Clean up the other generated files from the src directory (i.e.
	  the man pages).

2009-02-16 20:13  castaglia

	* src/Makefile.in:
	  Clean up the generated prxs script.

2009-02-16 17:29  castaglia

	* doc/contrib/mod_sftp.html:
	  Add hrefs to the individual SFTP FAQs.

	  Added FAQ about using mod_sftp as an OpenSSH subsystem.

2009-02-16 10:45  castaglia

	* src/prxs.in:
	  Give the prxs tool a --help option.

2009-02-16 10:32  castaglia

	* NEWS, src/prxs.in:
	  Bug#3188 - prxs broken due to typo.

2009-02-16 09:46  castaglia

	* contrib/: mod_load/.cvsignore, mod_sftp/.cvsignore,
	  mod_wrap2/.cvsignore:
	  Ignore libtool object files (*.lo) in CVS commands.

2009-02-15 19:14  castaglia

	* contrib/mod_sftp/auth.c, contrib/mod_sftp/channel.c,
	  contrib/mod_sftp/fxp.c, contrib/mod_sftp/kex.c,
	  contrib/mod_sftp/packet.c, contrib/mod_sftp/scp.c,
	  contrib/mod_sftp/service.c, include/cmd.h, src/main.c:
	  Work towards supporting the %S/%s LogFormat variables for SFTP
	  responses.  Doing so required changing the
	  pr_cmd_dispatch_phase() function so that it takes a flag
	  argument, rather than just a Boolean, and updating all of the
	  callers (most of which are in mod_sftp).

2009-02-15 18:51  castaglia

	* include/support.h:
	  Forgot to remove the old make_arg_str() declaration.

2009-02-15 16:44  castaglia

	* contrib/mod_sftp/fxp.c:
	  Support use of the TEXT mode flag in SFTP OPEN requests from
	  clients using SFTP protocol version 4 and later.  Since we send
	  the 'newline' extension telling the client that the "canonical"
	  newline sequence is a simple LF, supporting TEXT mode for files
	  is the same as non-TEXT mode for Unix.

	  However, against the recommendations of the SFTP Draft, mod_sftp
	  will NOT support a "text-seek" request; the computational cost of
	  supporting such a thing is not worth it.

2009-02-15 15:34  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_ban.pm:
	  Add regression tests for the BanEngine behavior added in
	  Bug#3186.

2009-02-15 15:32  castaglia

	* NEWS, contrib/mod_ban.c:
	  Bug#3186 - Support use of <IfClass> directive with mod_ban.

2009-02-14 19:15  castaglia

	* NEWS, contrib/mod_wrap2/mod_wrap2.c:
	  Bug#3185 - mod_wrap2 does not honour partial DNS name in access
	  files.

2009-02-14 16:27  castaglia

	* Make.rules.in, contrib/mod_rewrite.c, include/cmd.h,
	  include/conf.h, include/dirtree.h, include/inet.h,
	  include/modules.h, src/cmd.c, src/dirtree.c, src/main.c,
	  src/support.c:
	  Try consolidating some of the pr_cmd_* functions into their own
	  file (and give them their own header).

	  Replaced make_arg_str() with pr_cmd_get_displayable_str(), which
	  caches the resulting string of decoded arguments (to avoid
	  needless re-decoding on every command dispatch).

2009-02-14 15:35  castaglia

	* contrib/mod_sftp/auth-hostbased.c,
	  contrib/mod_sftp/auth-publickey.c, include/auth.h,
	  modules/mod_auth_unix.c, src/auth.c:
	  Add a new pr_auth_authorize() API, for checking that a user is
	  authorized to login.	This is different from
	  pr_auth_authenticate(), which authenticates the user using the
	  given password.  The authorization checks do not need a password.

	  This function is particularly needed by mod_sftp, which can
	  authenticate a client via non-password means (e.g. hostbased,
	  keyboard-interactive, and publickey authentication); the
	  authorization of the logging-in user still needs to occur in
	  those cases.

2009-02-14 14:33  castaglia

	* contrib/: mod_quotatab.c, mod_radius.c, mod_sql.c, mod_tls.c,
	  mod_sftp/mod_sftp.c, mod_wrap2/mod_wrap2.c:
	  When unloading modules which can have their own logs, make sure
	  that those log descriptors are closed.

2009-02-14 13:16  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/: mod_wrap2_file.pm,
	  mod_wrap2_sql.pm:
	  Add separate mod_wrap2 deny table tests for IP addresses and DNS
	  names.

2009-02-13 22:02  castaglia

	* src/session.c:
	  Use a plain unadorned "ssh" as the TTY name in case of SSH
	  sessions.

2009-02-13 21:06  castaglia

	* Make.rules.in, contrib/mod_sftp/auth.c, include/log.h, src/log.c,
	  src/wtmp.c:
	  Separate out log_wtmp() into its own source file.

	  Update mod_sftp to honor WtmpLog and UseLastlog.

2009-02-13 21:01  castaglia

	* contrib/mod_sql.c:
	  Constify one of the functions, and deal with the consequences.

2009-02-13 19:59  castaglia

	* Make.rules.in, contrib/mod_sql.c, contrib/mod_tls.c,
	  contrib/mod_sftp/fxp.c, contrib/mod_sftp/mod_sftp.c,
	  contrib/mod_sftp/scp.c, include/conf.h, include/log.h,
	  include/session.h, modules/mod_auth.c, modules/mod_log.c,
	  src/log.c, src/main.c, src/session.c,
	  tests/t/lib/ProFTPD/Tests/Logging/ExtendedLog.pm:
	  Added new Session API.  The data for the session are stashed in
	  the session.notes table, but these accessors can perform some
	  intelligent transformation on the stashed value.

	  Bug#3183 proved that the construction of the pseudo-ttyname, used
	  in WtmpLog and PAM authentication, should be consolidated, and
	  this has been done.

	  Also used the Session API to implement a %{protocol} LogFormat
	  (and SQLNamedQuery) variable.  This will resolve to "ftp",
	  "ftps", "ssh2", "sftp", or "scp" as appropriate.  A unit test for
	  regressions of this feature is included.

2009-02-13 15:43  castaglia

	* contrib/: mod_sftp_pam.c, mod_sftp_sql.c:
	  Update the copyright dates for these modules.

2009-02-13 15:41  castaglia

	* contrib/mod_sftp/: auth-hostbased.c, auth-kbdint.c,
	  auth-password.c, auth-publickey.c, auth.c, auth.h, blacklist.c,
	  blacklist.h, channel.c, channel.h, cipher.c, cipher.h,
	  compress.c, compress.h, crypto.c, crypto.h, disconnect.c,
	  disconnect.h, fxp.c, fxp.h, interop.c, interop.h, kbdint.c,
	  kbdint.h, kex.c, kex.h, keys.c, keys.h, keystore.c, keystore.h,
	  mac.c, mac.h, mod_sftp.c, mod_sftp.h.in, msg.c, msg.h, packet.c,
	  packet.h, rfc4716.c, rfc4716.h, scp.c, scp.h, service.c,
	  service.h, session.c, session.h, ssh2.h, tap.c, tap.h, utf8.c,
	  utf8.h:
	  Add the Id keyword to the source files.

2009-02-13 15:09  castaglia

	* src/netaddr.c:
	  Quell a compiler warning about const-ness.

2009-02-13 15:07  castaglia

	* contrib/mod_sftp/: keys.c, keys.h:
	  Forgot the keys.[ch] files for mod_sftp.

2009-02-13 14:20  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_sftp.pm,
	  t/modules/mod_sftp.t:
	  Adding the mod_sftp testsuite.

2009-02-13 14:17  castaglia

	* tests/t/etc/modules/mod_sftp/: authorized_dsa_keys,
	  authorized_rsa_keys, ssh_host_dsa_key, ssh_host_dsa_key.pub,
	  ssh_host_rsa_key, ssh_host_rsa_key.pub, test_dsa_key,
	  test_dsa_key.pub, test_rsa_key, test_rsa_key.pub:
	  Adding some of the files used by the mod_sftp unit tests.

2009-02-13 14:03  castaglia

	* contrib/mod_sftp/mod_sftp.c:
	  Make sure that, when unloaded, mod_sftp unregisters all event
	  handlers, and scrubs any keys from memory.

2009-02-13 13:51  castaglia

	* NEWS, README.modules, RELEASE_NOTES:
	  Add mention of the added mod_sftp et al modules.

2009-02-13 13:45  castaglia

	* contrib/mod_sftp_pam.c, contrib/mod_sftp_sql.c,
	  doc/contrib/mod_sftp.html, doc/contrib/mod_sftp_pam.html,
	  doc/contrib/mod_sftp_sql.html:
	  Adding mod_sftp_pam, mod_sftp_sql to the contrib modules.

	  Adding docs for mod_sftp, mod_sftp_pam, and mod_sftp_sql.

2009-02-13 13:43  castaglia

	* contrib/mod_sftp/: .cvsignore, Makefile.in, auth-hostbased.c,
	  auth-kbdint.c, auth-password.c, auth-publickey.c, auth.c, auth.h,
	  blacklist.c, blacklist.dat, blacklist.h, channel.c, channel.h,
	  cipher.c, cipher.h, compress.c, compress.h, config.guess,
	  config.sub, configure, configure.in, crypto.c, crypto.h,
	  dhparams.pem, disconnect.c, disconnect.h, fxp.c, fxp.h,
	  install-sh, interop.c, interop.h, kbdint.c, kbdint.h, kex.c,
	  kex.h, keystore.c, keystore.h, mac.c, mac.h, mod_sftp.c,
	  mod_sftp.h.in, msg.c, msg.h, packet.c, packet.h, rfc4716.c,
	  rfc4716.h, scp.c, scp.h, service.c, service.h, session.c,
	  session.h, ssh2.h, tap.c, tap.h, utf8.c, utf8.h:
	  Adding mod_sftp to the contrib modules.

2009-02-13 09:11  castaglia

	* contrib/mod_tls.c:
	  Move the installation of the control channel NetIO handler from
	  the startup event handler to the postparse event handler, and
	  make the NetIO handler installer be smarter.	We only want to
	  install a NetIO handler for the control channel if we have not
	  already done so.  We want to do this at postparse time, so that
	  if mod_tls is a DSO module and is unloaded (as during a restart),
	  then the NetIO handler will be installed again properly.
	  Previously, the NetIO handler was only installed on startup.	If
	  mod_tls is a DSO module, and proftpd is restarted, then the
	  unload event handler in mod_tls unregisters the control channel
	  NetIO handler, and that handler is never reinstalled.  A segfault
	  later occurs because of a null pointer dereference.

2009-02-13 08:04  castaglia

	* NEWS, src/dirtree.c:
	  Bug#3184 - When started in a chroot, proftpd fails to set
	  transfer buffer size.

2009-02-12 14:41  castaglia

	* doc/howto/DNS.html:
	  Mention the new -S command-line option in the DNS howto's FAQ
	  section.

2009-02-12 14:32  castaglia

	* NEWS, RELEASE_NOTES, include/netaddr.h, modules/mod_core.c,
	  src/main.c, src/netaddr.c, src/proftpd.8.in:
	  Bug#2608 - DNS should not be used for "server config" address
	  discovery.

2009-02-12 13:36  castaglia

	* contrib/mod_quotatab_file.c:
	  Handle possible interruptions of readv(2) and writev(2) in
	  mod_quotatab_file.

2009-02-12 12:13  castaglia

	* contrib/mod_ctrls_admin.c, include/compat.h, include/inet.h,
	  modules/mod_core.c, modules/mod_ident.c, src/bindings.c,
	  src/data.c, src/dirtree.c, src/inet.c, src/main.c, src/netaddr.c:

	  Renamed the Inet "connection" functions to "conn"; no need to
	  have function names that are that verbose.  Updated the attendant
	  callers, and added compatibility macros in compat.h.

	  Removed older compatibility macros for the log functions from
	  compat.h.

	  Added handling of the case where fixup_servers() can return -1
	  after a restart.  One user was somehow encountering a case where
	  proftpd could resolve the hostname on startup, but failed to
	  resolve the hostname after a restart.  This lead to a segfault
	  because the main_server pointer, after this failure, pointed to
	  old/stale memory.

2009-02-12 12:02  castaglia

	* .cvsignore, contrib/.cvsignore, contrib/mod_load/.cvsignore,
	  contrib/mod_wrap2/.cvsignore:
	  Minor refinement of the .libs exclusion.

2009-02-12 12:01  castaglia

	* .cvsignore, contrib/.cvsignore, contrib/mod_load/.cvsignore,
	  contrib/mod_wrap2/.cvsignore:
	  Ignore .la files and the .libs/ directory.

2009-02-12 11:13  castaglia

	* NEWS, modules/mod_auth.c, src/main.c:
	  Bug#3183 - Incorrect logging to wtmp.

2009-02-11 22:47  castaglia

	* tests/: tests.pl, t/config/hidegroup.t, t/config/hideuser.t,
	  t/lib/ProFTPD/Tests/Config/HideGroup.pm,
	  t/lib/ProFTPD/Tests/Config/HideUser.pm:
	  Adding testcases for the HideUser and HideGroup directives.

2009-02-11 22:46  castaglia

	* NEWS, modules/mod_core.c, src/dirtree.c:
	  Bug#2720 - HideUser/HideGroup should be more flexible.

2009-02-11 21:31  castaglia

	* NEWS, src/ctrls.c, src/event.c:
	  Bug#3179 - Restarted proftpd using mod_shaper will segfault.

2009-02-11 21:04  castaglia

	* src/auth.c:
	  The first id2name lookup was always returning the numeric ID,
	  even if the lookup succeed.  Fix this so that the looked-up name
	  is properly returned even for the first lookup.

2009-02-11 12:03  castaglia

	* contrib/mod_ban.c:
	  Avoid unsightly error messages like this when shutting down a
	  proftpd using mod_ban:

	    mod_ban/0.5.3: error removing shmid -1: No such file or
	  directory

	  by actually checking that the shmid is greater than -1 before
	  attempting to remove it.

2009-02-11 11:49  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Add a testcase for the SQLLog directive and the handling of the
	  %{time} variable.

2009-02-11 10:44  castaglia

	* NEWS, contrib/mod_wrap2/mod_wrap2.c:
	  Bug#3178 - mod_wrap2 does not handle IPv4-mapped IPv6 addresses.

2009-02-10 22:56  castaglia

	* modules/mod_auth.c, src/display.c,
	  tests/t/lib/ProFTPD/Tests/Config/DisplayConnect.pm:
	  Work towards Bug#2715.  With this change, the config tree is no
	  longer used for storing client count and class client count using
	  the "CURRENT-CLIENTS" and "CURRENT-CLIENTS-CLASS" config_rec
	  names.  These values are now stored (and retrieved) using the
	  session.notes table.

2009-02-10 21:57  castaglia

	* NEWS, src/main.c,
	  tests/t/lib/ProFTPD/Tests/Config/ServerIdent.pm:
	  Bug#2728 - Support for variables in ServerIdent directive.

2009-02-10 13:57  castaglia

	* RELEASE_NOTES, sample-configurations/PFTEST.conf.in,
	  sample-configurations/complex-virtual.conf:
	  Update the release notes to mention that the IdentLookups
	  directive is handled by the mod_ident module, and thus should be
	  appropriately guarded in the proftpd.conf using <IfModule>.

	  Update the distributed sample configs to use <IfModule> guards
	  around IdentLookups.

2009-02-09 16:39  castaglia

	* contrib/mod_tls.c:
	  If we can't set the certificate-related environment variables,
	  log the reason why.

2009-02-09 16:31  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#3170 - RewriteMap unescape URL encoding broken by
	  RewriteCondition backreference handling.

2009-02-09 16:05  castaglia

	* src/main.c:
	  Fix a few cases where the signal-presence bit was not cleared in
	  pr_signals_handle(), prior to calling some other function.
	  Failure to do so can lead to endless loops, for that called
	  function can itself call pr_signals_handle(), which sees the
	  signal-presence bit, which then calls the function, etc.  Such a
	  loop results in a segfault, when the stack has been exhausted.

2009-02-09 15:27  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/HiddenStores.pm:
	  Add regression test for Bug#3156.

2009-02-09 15:27  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#3156 - Allow resumed downloads when HiddenStore is in effect.

2009-02-09 10:51  castaglia

	* modules/mod_auth.c:
	  In the scoreboard entry for a session, record the IP address/port
	  to which the client connected.  In some cases, this can be
	  different from the IP address/port on which the server config,
	  which handles the connection, is listening.  In the DefaultServer
	  case, for example.

2009-02-09 09:58  castaglia

	* RELEASE_NOTES, locale/Makefile.in, locale/bg_BG.po:
	  Added Bulgarian translation, courtesy of Georgi D. Sotirov.

2009-02-09 09:58  castaglia

	* locale/bg_BG.po: file bg_BG.po was added on branch B1_3_2 on
	  2009-04-28 22:50:22 +0000

2009-02-09 09:21  castaglia

	* contrib/mod_sql_postgres.c:
	  Fix compile error.

2009-02-05 15:19  castaglia

	* locale/en_US.po:
	  Updated English translation.

2009-02-05 14:52  castaglia

	* doc/modules/mod_cap.html:
	  Another mod_cap-related FAQ.

2009-02-05 14:41  castaglia

	* modules/mod_core.c:
	  Remove vestigal IdentLookups handling left by mistake in
	  mod_core.

2009-02-05 14:40  castaglia

	* NEWS, RELEASE_NOTES, modules/mod_ident.c:
	  Bug#3155 - Change the IdentLookups default to 'off'.

2009-02-05 14:33  castaglia

	* NEWS, contrib/mod_sql_sqlite.c, doc/contrib/mod_sql_sqlite.html:
	  Bug#3128 - mod_sql_sqlite should use transactions for
	  INSERT/UPDATE statements.

2009-02-05 14:26  castaglia

	* NEWS, modules/mod_facts.c:
	  Bug#3133 - mod_facts should advertise TVFS support in the FEAT
	  response.

2009-02-05 14:23  castaglia

	* NEWS, contrib/mod_sql_postgres.c:
	  Bug#3123 - Use PQescapeStringConn() rather than PQescapeString().

2009-02-05 14:06  castaglia

	* NEWS, RELEASE_NOTES, modules/mod_auth.c, src/auth.c:
	  Bug#2894 - Deprecate the AnonymousGroup directive.

2009-02-05 13:49  castaglia

	* NEWS, contrib/mod_sql_mysql.c, contrib/mod_sql_odbc.c,
	  contrib/mod_sql_postgres.c, contrib/mod_sql_sqlite.c:
	  Bug#1801 - Faulty SQLConnectInfo PERCALL policy - connections not
	  closed after each call.

2009-02-05 13:36  castaglia

	* locale/: Makefile.in, proftpd.pot:
	  Updated the `find' command used to create the files.txt input for
	  creating a new .pot.	Updated the current proftpd.pot.

2009-02-05 12:18  castaglia

	* locale/: Makefile.in, fr_FR.po:
	  Added French translation.

2009-02-05 11:39  castaglia

	* include/version.h:
	  On to the 1.3.3 release cycle!

2009-02-05 10:59  castaglia

	* ChangeLog:
	  Updating ChangeLog for 1.3.2.

2009-02-05 10:58  castaglia

	* contrib/dist/rpm/proftpd.spec, include/version.h:
	  Updating versions for the 1.3.2 release.

2009-02-05 10:56  castaglia

	* RELEASE_NOTES:
	  Updating release notes.

2009-02-05 10:53  castaglia

	* NEWS, contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c:
	  Bug#3173 - Encoding-dependent SQL injection vulnerability.

2009-02-03 09:43  castaglia

	* tests/t/lib/ProFTPD/Tests/Logging/ExtendedLog.pm:
	  Added testcase for Bug#3171.

2009-02-03 09:42  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#3171 - ExtendedLog should log full SITE command using %m.

2009-02-02 11:47  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Added testcase for Bug#3170.

2009-02-02 11:46  castaglia

	* doc/howto/Rewrite.html:
	  Give examples for handling non-ASCII characters in RewriteRule
	  expressions.

2009-02-02 10:46  castaglia

	* doc/contrib/mod_rewrite.html:
	  Clarify exactly what type of encoding is unescaped by
	  mod_rewrite's unescape RewriteMap.

2009-02-02 10:35  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  Added testcase for Bug#3169.

2009-02-02 10:34  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#3169 - Multiple RewriteRules for the same RewriteCondition
	  not processed properly.

2009-01-30 09:58  castaglia

	* contrib/mod_sql.c:
	  Used the wrong pool when retrieving environment variables; when
	  handling %{env} tags in a SQLUserWhereClause, this would cause
	  the environment variable to not be retrieved properly.

2009-01-29 16:14  castaglia

	* tests/api/pool.c:
	  Fix a test that was failing due to a thinko.

2009-01-29 08:40  castaglia

	* include/options.h:
	  The changes for Bug#2874 erroneously removed the
	  PR_TUNABLE_XFER_BUFFER_SIZE macro.  The transfer buffer sizes are
	  now determined at runtime, but we still need a fallback (and some
	  contrib modules still use this macro).

2009-01-28 09:56  castaglia

	* modules/mod_auth.c:
	  Missed a few places in need of translation.

2009-01-27 16:19  castaglia

	* src/encode.c:
	  If the conversion handles are invalid for some reason, don't
	  cause segfaults by returning null; just return a dup of the input
	  string, and log the error.

2009-01-27 15:29  castaglia

	* src/scoreboard.c:
	  Missed a spot.

2009-01-27 15:23  castaglia

	* src/scoreboard.c:
	  Cache the errno value when using pr_trace_msg(), since that
	  function can change the errno value.

2009-01-26 13:56  castaglia

	* modules/mod_lang.c:
	  When "UseEncoding off" is configured, *really* disable encoding.

2009-01-26 12:57  castaglia

	* doc/howto/TLS.html:
	  Finally got around to adding more substance to the "TLS
	  Debugging" section, including examples using openssl s_client and
	  ssldump.  Very useful tools.

	  Added a FAQ about TLSCertificateChainFile, mostly for my own
	  reference; it's a bit confusing as to when such a thing is
	  useful.

2009-01-26 09:35  castaglia

	* contrib/mod_tls.c:
	  Fix two minor issues in mod_tls:

	  1. The TLSCACertificateFile can contain multiple certificates to
	  use when    verifying client certs.  However, when requesting the
	  client's cert    and sending the list of acceptable client CAs,
	  mod_tls was only using    the *first* cert contained in the
	  TLSCACertificateFile, rather than    using *all* certs which
	  might be in this file.  (Usually there is only    one cert
	  anyway, so this is not a huge problem.)

	  2. The list of acceptable client CAs, sent to the client when
	  requesting	the client's cert, is built up from
	  TLSCACertificateFile and all of the	 certs in
	  TLSCACertificatePath.  However, for some strange reason, if	 a
	  TLSCertificateChainFile was configured, mod_tls was NOT sending
	  the	 certs in TLSCACertificatePath.  (I suspect it was a
	  misunderstanding on	 my part about the role that the
	  certificate chain file plays in SSL/TLS;    now I understand it.)

2009-01-24 19:24  jwm

	* contrib/mod_ldap.c: mod_ldap bzr r62: * Retrieve all LDAP
	  attributes when calling pr_ldap_user_lookup() since	it will
	  need various attributes (to perform home directory generation,
	  for one). Thanks to Nikos Voutsinas <nvoutsin@noc.uoa.gr>.
	  http://forums.proftpd.org/smf/index.php/topic,3562.0.html

2009-01-23 15:52  castaglia

	* include/version.h:
	  Back to a CVS version.

2009-01-23 15:02  castaglia

	* ChangeLog:
	  Updating ChangeLog for 1.3.2rc4.

2009-01-23 14:59  castaglia

	* NEWS, RELEASE_NOTES:
	  Updating NEWS, release notes for 1.3.2rc4.

2009-01-23 14:58  castaglia

	* contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for 1.3.2rc4.

2009-01-23 09:30  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Fixup some tests which were failing because the default config
	  changed the value of AllowOverride.

2009-01-22 11:25  castaglia

	* doc/contrib/mod_sql.html:
	  Add some links for easier cross-referencing.

2009-01-21 16:30  castaglia

	* src/support.c:
	  Make pr_gmtime() behave like pr_localtime() with regard to the
	  use of the given memory pool.

	  Increase the buffer size used in pr_strtime(), just to be certain
	  that we have enough room.

2009-01-16 18:10  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Add a test case for reproducing Bug#3164.  I think, however, that
	  it is not really a bug -- as long as the admin configures
	  mod_quotatab_sql properly.  Hmm.

2009-01-15 23:10  castaglia

	* RELEASE_NOTES:
	  Mention the Compiling howto.

2009-01-15 23:09  castaglia

	* doc/howto/: Compiling.html, index.html:
	  Finally finished a howto on compiling proftpd.

2009-01-15 18:53  castaglia

	* INSTALL:
	  Typos.

2009-01-14 13:44  castaglia

	* doc/contrib/mod_tls.html:
	  Typo.

2009-01-14 09:39  castaglia

	* src/main.c:
	  Use "microsecs", as it is less confusing to admins.

2009-01-13 09:38  castaglia

	* src/main.c:
	  Copy the signo of a terminating signal a little earlierin the
	  handler.

2009-01-12 15:41  castaglia

	* doc/howto/Vhost.html:
	  Add another vhost FAQ.

2009-01-12 09:47  castaglia

	* src/fsio.c:
	  Add trace logging of any statvfs()/statfs() errors.

2009-01-08 18:30  castaglia

	* src/main.c:
	  Log segfaults in the TraceLog using the 'signal' channel.

2009-01-08 12:21  castaglia

	* src/dirtree.c:
	  Don't forget to append the "*" glob character after the path when
	  that path is just "/".  This was an edge case we weren't
	  handling.

2009-01-07 23:36  castaglia

	* contrib/mod_sql.c:
	  Typo.

2009-01-07 23:32  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_ctrls.pm:
	  Add testcase showing that AuthOrder does not affect mod_ctrl's
	  ability to honor/use system user names in controls ACLs.

2009-01-07 10:25  castaglia

	* src/auth.c:
	  Rather than showing "(?)" whenever the uid2name or gid2name
	  lookup for an ID fails, show the stringified numeric ID value
	  instead.  This makes proftpd behave more like ls(1) et al.

2009-01-06 10:51  castaglia

	* src/auth.c:
	  Typo.

2009-01-05 20:20  castaglia

	* contrib/mod_tls.c, tests/t/lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Do not allow FTPS clients to send AUTH after they have already
	  sent AUTH.  If clients wish to change the SSL/TLS session
	  parameters, they need to either use the session renegotiation
	  facilities within SSL/TLS, or disconnect and start a new session.
	  This is an allowable server behavior according to RFC2228.

2009-01-05 17:35  castaglia

	* doc/howto/Vhost.html:
	  I realized that the Vhost howto didn't mention the "already in
	  use" warning message, and should.

2009-01-05 09:29  castaglia

	* contrib/: mod_ldap.c, mod_sql.c:
	  Initialize the buffer that will be used to store the
	  base64-encoded hash value, so that the ensuing strcmp(3) will
	  work as expected (just making sure of this).

2009-01-03 18:10  castaglia

	* contrib/: mod_ldap.c, mod_sql.c:
	  The RATS code analysis tool correctly pointed out that the output
	  buffer for OpenSSL's EVP_EncodeBlock() function needs to account
	  for base64-encoding expansion.  Specifically, the output buffer
	  should be 4/3 the size of the input buffer.  I played it safe,
	  and made the output buffers twice the size of the input buffers.

2009-01-03 17:14  castaglia

	* contrib/mod_quotatab.c, contrib/mod_sql.c, contrib/mod_tls.c,
	  modules/mod_delay.c, modules/mod_xfer.c, src/ctrls.c,
	  src/proctitle.c:
	  I ran proftpd through David Wheeler's flawfinder(1) script.
	  Based on that, I replaced the occurrences of sprintf(3) with
	  snprintf(3), strcpy(3) with sstrncpy(), and strcat(3) with
	  sstrcat().

2009-01-02 11:38  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm:
	  While investigating Bug#3160, I wrote a mod_rewrite unit test
	  which turned out to be the regression test for Bug#3027 (as
	  Bug#3160 turned out to be a duplicate of Bug#3027).  As such,
	  that test should be added to the collection.

2009-01-01 16:31  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/MKD.pm:
	  Added two MKD tests, one for directories with spaces in the name,
	  and one for a UTF8-encoded directory name.

2008-12-31 11:51  castaglia

	* contrib/mod_tls.c:
	  Remove unnecessary character.

2008-12-31 09:53  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#3159 - mod_rewrite build fails due to missing mode argument
	  in open(2) call.

2008-12-30 17:02  castaglia

	* modules/mod_xfer.c:
	  Prevent a segfault due to aborted downloads in some cases by
	  checking for a non-null session.d value before attempting to use
	  it.  Aborting a download can cause that session.d value to become
	  null in the middle of the download call stack.

2008-12-30 13:39  castaglia

	* doc/howto/NAT.html:
	  Update NAT howto with ipf example.

2008-12-30 13:32  castaglia

	* contrib/mod_ctrls_admin.c:
	  Since the mem_printf() function is only called when
	  --enable-devel is used, guard the mem_printf() definition with
	  the same macros (and avoid compiler warnings about the unused
	  function).

2008-12-24 00:05  castaglia

	* modules/mod_lang.c, src/encode.c:
	  When mod_lang uses the environment variables in a setlocale(3)
	  call, it needs to reset the Encode API to use the
	  possibly-changed encoding.

2008-12-23 15:34  castaglia

	* contrib/mod_tls.c:
	  ERR_get_error() returns a long, not an int.  Update
	  tls_fatal_error() to take a long error code as a result.  Also
	  filter out ENOSYS errors on SSL_shutdown(); there's not much we
	  can do about them anyway.

2008-12-23 11:46  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_lang.pm:
	  Add test verifying that mod_lang picks up and handles the LANG
	  environment variable properly.

2008-12-23 11:29  castaglia

	* modules/mod_lang.c:
	  The ANSI C standard says that every process starts out in the C
	  locale, regardless of LANG and other environment variables.  To
	  switch the process to using the locales specified by those
	  environment variables, you need an explicit:

	    setlocale(LC_ALL, "");

	  call.  Make sure that mod_lang does this, prior to any other
	  setlocale(3) calls.  Also, when using setlocale(3) to query for a
	  locale, make a copy of the returned string, instead of just
	  stashing the pointer.  The library may return a pointer whose
	  value changes later, i.e. by subsequent setlocale(3) calls.

2008-12-22 22:41  castaglia

	* contrib/mod_tls.c:
	  Actually mod_sftp_sql can't be used without mod_sftp, so having
	  it on the list of OpenSSL-using modules is not really useful.

2008-12-22 22:29  castaglia

	* contrib/mod_tls.c:
	  Add mod_sftp_sql to the list of OpenSSL-using modules.  Also log
	  the OpenSSL error stack to the logs for a shutdown issue; it can
	  help shed more light on a particular issue one user is seeing.

2008-12-22 09:25  castaglia

	* contrib/mod_tls.c:
	  Explicit cast to quell compiler warnings about signedness
	  differences.

2008-12-21 15:25  castaglia

	* src/encode.c:
	  Try to reduce confusion when we didn't detect iconv() (no
	  HAVE_ICONV), but we did detect <iconv.h>.

2008-12-21 14:17  castaglia

	* doc/howto/Quotas.html:
	  Add FAQ about how mod_quotatab handles file overwrites/appends.

2008-12-21 11:53  castaglia

	* src/auth.c:
	  The key comparators for the UID/GID cache tables need to return
	  zero if the keys match, not 1.  Oops.

2008-12-21 00:57  castaglia

	* src/auth.c:
	  Fixed the caching of UIDs and GIDs in tables in the Auth API; the
	  keys were not being copied before stashing in the respective
	  tables, which meant that the key comparisons were being done on
	  stale pointers, and thus the cached values were never found.
	  Also fixed the key comparators to be even more efficient (i.e. no
	  need to use memcmp(3) for comparing values like uid_t, gid_t).

2008-12-20 16:55  castaglia

	* src/table.c:
	  Fix some edge cases that could lead to segfaults.

2008-12-18 15:05  castaglia

	* src/dirtree.c:
	  Make sure that the cmd_rec returned by pr_cmd_alloc() has an
	  instantiated cmd->notes table.

2008-12-18 10:00  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Fix typos.

2008-12-17 15:44  castaglia

	* src/encode.c:
	  Workaround buggy nl_langinfo(3) implementations which return
	  "646" as a way of indicating "US-ASCII".  The former is not
	  acceptable to iconv_open(3), but the latter is.  Go figure.

2008-12-17 14:20  castaglia

	* contrib/mod_quotatab.c:
	  It's not necessarily safe to use equality comparisons with
	  floats; better to use less-than/greater-than instead.

2008-12-17 10:18  castaglia

	* doc/howto/TLS.html:
	  Add a FAQ about the OpenSSL header/library version mismatch
	  warning.

2008-12-17 09:46  castaglia

	* NEWS, modules/mod_facl.c:
	  Bug#3150 - mod_facl erroneously assumes no permissions, rather
	  than all permissions, in some cases.

2008-12-16 19:37  castaglia

	* src/encode.c:
	  Guard the set_supports_telnet_iac() function in HAVE_ICONV
	  macros, as that is the only time when the function is called.  On
	  systems which have the iconv.h header but NOT the iconv
	  function() (though I think this is an autoconf issue), the
	  compiler will warn about this function being declared but not
	  used.

2008-12-16 16:24  castaglia

	* doc/contrib/mod_wrap2_file.html:
	  Clean up the example mod_wrap2_file configs a little.

2008-12-16 15:47  castaglia

	* locale/Makefile.in:
	  Use -f instead of -e when checking for .po/.mo files.  It's more
	  exact and, better, it works properly in Solaris' sh(1).  (I'm
	  still not sure why -e did not work as expected in Solaris' sh(1),
	  though.)

2008-12-16 15:43  castaglia

	* src/: log.c, trace.c:
	  Quell some compiler warnings on Solaris by using explicit casts,
	  and by explicitly encompassing the tertiary expressions for those
	  casts.

2008-12-15 22:23  castaglia

	* src/dirtree.c:
	  Forgot to handle the case, in build_dyn_config(), where the path
	  was just "/".

2008-12-15 17:38  castaglia

	* src/dirtree.c:
	  A better fix for build_dyn_config()'s sending of empty strings to
	  dir_match_path(); the previous solution could easily lead to
	  segfaults.

2008-12-15 16:37  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/MFMT.pm:
	  Add unit test for the handling of decimal point (i.e. unsupported
	  precision) in an MFMT command.

2008-12-15 16:36  castaglia

	* modules/mod_facts.c:
	  Make sure that we restore the original timestamp argument of an
	  MFMT command if we have changed it.  This is necessary for any
	  POST_CMD/LOG_CMD handlers which may want to log the full argument
	  sent by the client.

2008-12-14 14:51  castaglia

	* doc/howto/Tracing.html:
	  Mention the trick of disabling some of the default trace
	  channels.

2008-12-14 14:48  castaglia

	* modules/mod_facts.c:
	  Fix the response strings in some cases such that the original
	  input parameter is reflected in the response message.  Make sure
	  that if we change the value of a character in a string (say from
	  ';' to '\0'), we change it back before returning.

2008-12-13 22:45  castaglia

	* doc/howto/Sendfile.html:
	  Correct the grammar.

2008-12-12 23:46  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Directory/Lookups.pm:
	  Add another test, one for a creating deep directory layout (with
	  corresponding <Directory> sections).	Like the wide layout, this
	  test fails, timing out during the login process.  But I wanted to
	  get this checked in, for future research.

2008-12-12 23:12  castaglia

	* src/auth.c:
	  Make a note for my future self, when researching slow logins with
	  configs with many <Directory> sections, where the slowness occurs
	  (and why).

2008-12-12 20:49  castaglia

	* src/dirtree.c:
	  Add handling of signals in a potentially long-running while loop
	  (especially if recursion is requested).

2008-12-12 18:20  castaglia

	* NEWS, contrib/mod_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Bug#3149 - Bad handling of %p, %V, and %v variables in mod_sql.

2008-12-12 13:30  castaglia

	* doc/contrib/mod_sql.html:
	  Fix the text for better legibility.

2008-12-12 13:26  castaglia

	* doc/contrib/mod_sql.html:
	  Mention that the SQL{Group,User}WhereClause directives support
	  the same variables as SQLNamedQuery.

2008-12-12 11:41  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Added test for the SQLUserWhereClause directive.

2008-12-12 08:45  castaglia

	* contrib/mod_tls.c:
	  The SSL_library_init() function registers SSL algorithms, but we
	  might want to deal with other algorithms (as when dealing with
	  PKCS#12 files).  Thus we need to OpenSSL_add_all_algorithms() to
	  get the remaining algorithms registered.

2008-12-12 08:41  castaglia

	* tests/t/: config/directory.t, config/directory/lookups.t,
	  lib/ProFTPD/Tests/Config/Directory.pm,
	  lib/ProFTPD/Tests/Config/Directory/Lookups.pm:
	  Renamed the <Directory> lookups test code to Directory::Lookups.

2008-12-11 17:07  castaglia

	* tests/t/: config/directory.t,
	  lib/ProFTPD/Tests/Config/Directory.pm:
	  Starting a collection of cases that I'll be using for testing
	  proftpd's <Directory> lookup code, particularly in the case of
	  many (i.e. hundreds) of <Directory> sections and wide and/or deep
	  directory layouts.  (I suspect there's quite a bit of lookup
	  speed performance to be gained in this part of the code.)

2008-12-11 12:52  castaglia

	* src/dirtree.c:
	  Add more commentary to build_dyn_config(), and add a paranoia
	  check, in case we should be dealing with a path with absolutely
	  no path separators.

2008-12-11 12:45  castaglia

	* src/dirtree.c:
	  When build_dyn_config() is walking up the components of the given
	  path (assuming the recurse flag is 'true'), it has a problem when
	  it gets to "/".  Specifically, it will send the empty string to
	  dir_match_path(), rather than "/".  Fix this case.

2008-12-11 12:41  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/FTPAccess/RETR.pm:
	  Fix Perl warnings about redeclared variables.

2008-12-11 12:25  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/Utils.pm,
	  Tests/Config/FTPAccess/DELE.pm, Tests/Config/FTPAccess/RETR.pm:
	  Disable handling of .ftpaccess files by default in the testsuite;
	  those tests which handle .ftpaccess files need to use
	  "AllowOverride on" explicitly in their configs.

2008-12-11 12:22  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Directory/Umask.pm:
	  Update the code here.  (By the way, it looks like Bug#2677 may
	  still be present in the code, and fixing it involves a fair
	  amount of code change.)

2008-12-11 12:19  castaglia

	* modules/mod_core.c:
	  Style cleanups in the <Directory> config handler.

2008-12-11 10:59  castaglia

	* modules/mod_lang.c:
	  Correct a few more LANG issues (mostly dealing with
	  transformations of hyphens to underscores, population of the
	  current and default languages everywhere, etc).

2008-12-11 10:42  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/FTPAccess/RETR.pm:
	  Quell some Perl warnings about redeclared variables.

2008-12-10 22:40  castaglia

	* modules/mod_lang.c:
	  Stupid thinko: If "OPTS UTF8 on" is sent, do not disable encoding
	  by the FS functions.

2008-12-10 22:33  castaglia

	* modules/mod_lang.c:
	  Fix some of the problems found in mod_lang using the testsuite.

2008-12-10 22:33  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/FEAT.pm,
	  t/lib/ProFTPD/Tests/Modules/mod_lang.pm, t/modules/mod_lang.t:
	  Added tests for the commands provided by mod_lang.  This involved
	  adding the lang() and opts() methods to the testsuite FTP class,
	  and in fixing up the FEAT tests.

2008-12-10 21:44  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/FEAT.pm:
	  Make sure that the FEAT test can handle subtle differences in the
	  underlying iconv/setlocale implementations.

2008-12-10 20:49  castaglia

	* modules/mod_core.c:
	  Stylistic nit cleanup.

2008-12-10 20:41  castaglia

	* modules/mod_delay.c:
	  Clean up some stylistic nits in mod_delay.

2008-12-10 20:33  castaglia

	* modules/mod_core.c, src/main.c:
	  Fixed a bug with the handling of RLimitMemory: any 'hard' memory
	  limits were not actually being set.

	  Set session resource limits _before_ module session init, not
	  after.  This means that session resource limits will apply to the
	  modules during session init (as they should).

	  Favor RLIMIT_DATA over RLIMIT_AS.

2008-12-10 14:40  castaglia

	* doc/howto/Directory.html:
	  Add another FAQ for the Directory howto, covering preventing a
	  directory from being renamed.

2008-12-10 14:28  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Directory/Limits.pm:
	  Some cases where directory/file renaming works (as expected) or
	  is denied (as expected).

2008-12-10 14:03  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Add a couple of test cases for HideFiles, using the per-user
	  parameters.

2008-12-10 13:43  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_unique_id.pm,
	  t/modules/mod_unique_id.t:
	  Added test for the mod_unique_id module.

2008-12-10 11:50  castaglia

	* doc/howto/Chroot.html:
	  Add FAQ about DefaultRoot and NFS mounts.

2008-12-10 11:25  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/: GroupOwner.pm, UserOwner.pm:
	  Switch these tests to use the new 'norootprivs' test class,
	  rather than having the tests do that check themselves.

2008-12-10 11:23  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Add a 'norootprivs' test class, similar to the 'rootprivs' test
	  class: any test marked as a 'norootprivs' class will be skipped
	  if the testsuite is being run with root privs.

2008-12-10 11:17  castaglia

	* tests/: tests.pl, t/config/order.t,
	  t/lib/ProFTPD/Tests/Config/Order.pm:
	  Added tests for the Order directive.

2008-12-10 11:07  castaglia

	* tests/: tests.pl, t/config/storeuniqueprefix.t,
	  t/lib/ProFTPD/Tests/Config/StoreUniquePrefix.pm:
	  Added test for the StoreUniquePrefix directive.

2008-12-10 10:57  castaglia

	* doc/howto/Scoreboard.html:
	  Mention the "ScoreboardFile /dev/null" trick.

2008-12-10 10:49  castaglia

	* tests/: tests.pl, t/config/deleteabortedstores.t,
	  t/lib/ProFTPD/Tests/Config/DeleteAbortedStores.pm:
	  Added test for the DeleteAbortedStores directive.

2008-12-10 10:46  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/HiddenStores.pm:
	  Remove debugging cruft.

2008-12-10 10:43  castaglia

	* tests/: tests.pl, t/config/hiddenstores.t,
	  t/lib/ProFTPD/Tests/Config/HiddenStores.pm,
	  t/lib/ProFTPD/Tests/Config/Directory/Limits.pm:
	  Added unit test for the HiddenStores functionality.  Added more
	  <Limit> cases.

2008-12-09 23:26  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_ctrls.pm,
	  t/modules/mod_ctrls.t:
	  Start on tests for mod_ctrls.

2008-12-09 22:54  castaglia

	* contrib/mod_site_misc.c:
	  Avoid descriptor leak by closing the directory descriptor before
	  returning from site_misc_delete_dir().

2008-12-09 22:53  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_site_misc.pm,
	  t/modules/mod_site_misc.t:
	  Added basic tests for the various SITE commands offered by
	  mod_site_misc.

2008-12-09 22:35  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Pass along any other arguments for custom SITE commands.

2008-12-09 22:13  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/TestSuite/Utils.pm:
	  With these changes, it is now possible to use this tests.pl
	  script, and the ProFTPD testsuite library of Perl modules, to run
	  tests for a third-party module.  For example:

	    # cd /path/to/mod_sftp/tests
	    # perl ~/path/to/proftpd/tests.pl t/modules/mod_sftp.t

	  This will help (me, anyway) when developing new modules, without
	  having to write the new module test code in the proftpd source
	  tree.

2008-12-09 14:58  castaglia

	* modules/mod_core.c:
	  Remove redundant "<Directory>:" in error message displayed when
	  proftpd detects a duplicate <Directory> configuration.

2008-12-09 14:56  castaglia

	* doc/howto/Directory.html:
	  Add FAQ about matching multiple <Directory> sections to the same
	  path, and which section wins.

2008-12-09 14:14  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Directory/Limits.pm:
	  Regression tests for Bug#3147.

2008-12-09 14:13  castaglia

	* NEWS, modules/mod_core.c, src/dirtree.c:
	  Bug#3147 - Comma-delimited commands in <Limit> sections not
	  handled properly.

2008-12-09 11:11  castaglia

	* doc/howto/Tracing.html:
	  Mention the "directory" log channel, added as part of the fix for
	  Bug#3146.

2008-12-09 11:09  castaglia

	* tests/: tests.pl, t/config/directory/limits.t,
	  t/lib/ProFTPD/Tests/Config/Directory/Limits.pm:
	  Added regression tests for Bug#3146.

2008-12-09 11:08  castaglia

	* NEWS, src/dirtree.c:
	  Bug#3146 - <Directory> paths using glob characters may not match
	  as expected.

2008-12-09 09:32  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Add checks of the tally values for more of the upload quotatab
	  tests.

2008-12-08 17:22  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Add function for checking on the current tally; need to use this
	  in more of the existing tests, for ensuring the mod_quotatab is
	  updating the tallies properly.

2008-12-08 16:42  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Added mod_quotatab_sql tests for uploads and the 'all' limit.

2008-12-08 16:18  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Added mod_quotatab_sql tests for uploads and class quota.

2008-12-08 12:20  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm:
	  Added mod_quotatab_sql tests for uploads and group quota.

2008-12-08 11:25  castaglia

	* tests/: tests.pl,
	  t/lib/ProFTPD/Tests/Modules/mod_quotatab_sql.pm,
	  t/modules/mod_quotatab_sql.t:
	  Start of some tests for mod_quotatab_sql; there are *many* more
	  tests for this module to come.

2008-12-08 09:54  castaglia

	* tests/: tests.pl, t/config/groupowner.t,
	  t/lib/ProFTPD/Tests/Config/GroupOwner.pm:
	  Added tests for the GroupOwner directive.

2008-12-08 09:53  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Allow zero IDs in the AuthUserFile and AuthGroupFile files.

2008-12-08 09:32  castaglia

	* tests/: tests.pl, t/config/userowner.t,
	  t/lib/ProFTPD/Tests/Config/UserOwner.pm:
	  Added tests for the UserOwner directive.

2008-12-08 09:26  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  When writing out AuthUserFiles and AuthGroupFiles, append to any
	  file which may already be present.  This allows for the writing
	  of multiple entries in those files.

2008-12-08 07:48  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Handle arrayrefs within hashrefs properly when writing out the
	  config.

2008-12-07 21:00  castaglia

	* src/main.c:
	  When handling SIGABRT, shut down properly.  Also include the
	  signal number (as it can vary across platforms) for each signal
	  in the trace logging.

2008-12-07 20:59  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Signals/ABRT.pm,
	  t/lib/ProFTPD/Tests/Signals/SEGV.pm, t/signals/abrt.t,
	  t/signals/segv.t:
	  Added unit tests for the handling of SIGABRT and SIGSEGV in the
	  daemon process.

2008-12-07 20:35  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Permit empty usernames, passwords (useful for certain tests).

2008-12-07 20:00  castaglia

	* doc/howto/TLS.html:
	  Update the TLSProtocol example in light of Bug#3107.

2008-12-07 19:27  castaglia

	* tests/t/lib/ProFTPD/Tests/: Commands/MKD.pm, Commands/MLST.pm,
	  Commands/USER.pm, Config/HideFiles.pm:
	  Cleaning up some test cases so that all pass when run as root,
	  and that there are no Perl compiler warnings.

2008-12-07 19:05  castaglia

	* src/dirtree.c:
	  Loosen the paranoid parameter sanity check in dir_hide_file() a
	  little.

2008-12-07 19:01  castaglia

	* NEWS, modules/mod_ls.c, src/dirtree.c,
	  tests/t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Bug#2020 - HideFiles sometimes fails.  The accompanying unit
	  tests prove that the fix works as intended.

2008-12-07 17:57  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/FTPAccess/RETR.pm:
	  Adding regression test for Bug#2461.

2008-12-07 17:20  castaglia

	* NEWS, locale/Makefile.in, locale/ru_RU.po:
	  Bug#3065 - Russian translation for proftpd.

2008-12-07 16:47  castaglia

	* tests/: tests.pl, t/config/directory/umask.t,
	  t/lib/ProFTPD/TestSuite/Utils.pm,
	  t/lib/ProFTPD/Tests/Config/Directory/Umask.pm:
	  Add regression tests/reproduction cases for Bug#2677.  This
	  involved updating the config_write() function so that it can
	  properly handled nested <Directory> and <Limit> sections.

2008-12-07 15:59  castaglia

	* doc/howto/Directory.html:
	  Update the Directory howto to mention that <Directory> sections
	  apply recursively (see Bug#2677).

2008-12-07 15:41  castaglia

	* tests/: tests.pl, t/config/ftpaccess/dele.t,
	  t/lib/ProFTPD/Tests/Config/FTPAccess/DELE.pm:
	  Add regression tests for Bug#2321.

2008-12-07 15:07  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/FTPAccess/RETR.pm:
	  More refinements to the Bug#2038 regression tests, proving that
	  the .ftpaccess file is being honored as intended.

2008-12-07 14:55  castaglia

	* tests/: tests.pl, t/config/ftpaccess/retr.t,
	  t/lib/ProFTPD/Tests/Config/FTPAccess/RETR.pm:
	  Added regression tests for Bug#2038, which doesn't seem to happen
	  anymore.

2008-12-07 12:56  castaglia

	* contrib/mod_tls.c:
	  Use a better context identifier for cached session IDs; the
	  module name and version is much better than a simple "1" string.

2008-12-07 12:54  castaglia

	* tests/tests.pl:
	  Add the mod_tls testcase to the testsuite.

2008-12-07 12:54  castaglia

	* tests/t/: etc/modules/mod_tls/ca-cert.pem,
	  etc/modules/mod_tls/server-cert.pem,
	  lib/ProFTPD/Tests/Modules/mod_tls.pm:
	  Add the required CA and server certs for the mod_tls tests.
	  These certs are good for 5 years.

2008-12-07 12:31  castaglia

	* doc/howto/TLS.html:
	  Fix typos in TLS howto.

2008-12-07 12:16  castaglia

	* tests/t/: lib/ProFTPD/Tests/Modules/mod_tls.pm,
	  modules/mod_tls.t:
	  Start a collection of mod_tls tests.	This doesn't really work
	  just yet; I need to generate a proper cert for use by the
	  testsuite.

2008-12-06 19:38  castaglia

	* doc/howto/CreateHome.html:
	  Update the CreateHome howto with an example of the feature added
	  by Bug#3040.

2008-12-06 19:31  castaglia

	* tests/: tests.pl, t/config/createhome.t,
	  t/lib/ProFTPD/Tests/Config/CreateHome.pm:
	  Add tests verifying the fix for Bug#3040; more CreateHome tests
	  are needed.

2008-12-06 19:29  castaglia

	* NEWS, modules/mod_auth.c, src/mkhome.c:
	  Bug#3040 - Support for CreateHome parent directories owned by
	  user.

2008-12-06 18:50  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql.pm:
	  Update the set_up(), tear_down() methods in this file.  Even
	  though it's currently empty, I use it as a template for new
	  module testcase files.

2008-12-06 16:35  castaglia

	* RELEASE_NOTES:
	  Mention the Sendfile, Rewrite howtos in the release notes.

2008-12-06 16:33  castaglia

	* doc/howto/Rewrite.html:
	  Remove extraneous header.

2008-12-06 16:24  castaglia

	* doc/howto/Rewrite.html:
	  Make the URLs in the doc be relative to the rest of the docs.

2008-12-06 16:19  castaglia

	* doc/howto/: Rewrite.html, index.html:
	  Adding a rewrite howto to the collection.

2008-12-06 14:12  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Logging/TransferLog.pm,
	  t/logging/transferlog.t:
	  Added unit tests for the TransferLog format.

2008-12-04 14:01  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/Limit/XMKD.pm:
	  Added more test cases to try to reproduce Bug#3138, to no avail.
	  Still useful to have these use cases in the testsuite.

2008-12-04 13:45  castaglia

	* NEWS, contrib/mod_dynmasq.c:
	  Bug#3144 - mod_dynmasq returns same IP address, even though
	  actual IP address has changed.

2008-12-04 13:35  castaglia

	* src/inet.c:
	  After closing a connection, make sure the various fields are
	  reset to NULL/-1 as appropriate.

2008-12-03 22:55  castaglia

	* modules/mod_core.c:
	  Add a little bit of logging for the MKD/XMKD command, when it is
	  denied because of a <Limit> config.  Also cache an errno value,
	  so that the actual error reason is properly logged.

2008-12-03 22:45  castaglia

	* doc/howto/Directory.html:
	  Update the Directory howto with the tip about using a <Directory>
	  section to refer to a specific file, rather than just to a
	  directory (Bug#3140).

2008-12-03 21:49  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/Utils.pm,
	  Tests/Config/Limit/XMKD.pm:
	  Add more <Limit> test cases from the Bug#3138 investigation.
	  This involved adding support for <Class> sections in the testcase
	  config files.

2008-12-03 09:58  castaglia

	* modules/mod_xfer.c:
	  Cache the errno value for an aborted download, so that it can be
	  reported properly.  This came out of investigating the cause for
	  Bug#3143.

2008-12-03 00:41  castaglia

	* tests/: tests.pl, t/commands/mff.t, t/commands/mfmt.t,
	  t/lib/ProFTPD/Tests/Commands/MFF.pm,
	  t/lib/ProFTPD/Tests/Commands/MFMT.pm:
	  Add some tests (not exhaustive) for the MFMT and MFF commands.

2008-12-03 00:40  castaglia

	* NEWS, modules/mod_facts.c:
	  Bug#3142 - "Invalid number of arguments MFMT" due to spaces in
	  path argument.

2008-12-03 00:14  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Support use of <Limit> sections in the testcase config files.

2008-12-03 00:10  castaglia

	* tests/: tests.pl, t/config/limit/xmkd.t,
	  t/lib/ProFTPD/Tests/Config/Limit/XMKD.pm:
	  Begin the collection of unit tests for various <Limit>
	  configurations.

2008-12-03 00:06  castaglia

	* doc/modules/mod_facts.html:
	  Updated URL to Draft for MFF/MFMT commands.

2008-12-02 21:09  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Logging/ExtendedLog.pm,
	  t/logging/extendedlog.t:
	  Add regression tests for Bug#3137.

2008-12-02 21:06  castaglia

	* NEWS, modules/mod_xfer.c, src/data.c:
	  Bug#3137 - ProFTPD does not log filename %f for uploaded files.

2008-11-26 09:21  castaglia

	* tests/: tests.pl, t/commands/mlsd.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/MLSD.pm:
	  Adding tests for the MLSD command.

2008-11-26 09:18  castaglia

	* modules/mod_facts.c:
	  Be able to distinguish failure responses for MLSD for using
	  globs, versus something to do with the file itself (e.g.
	  permissions, existence, etc).

2008-11-24 16:41  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Add the methods for the MLSD, MLST, MFF, MFMT commands.

2008-11-24 16:39  castaglia

	* tests/: tests.pl, t/commands/mlst.t,
	  t/lib/ProFTPD/Tests/Commands/MLST.pm:
	  Adding tests for the MLST command.

2008-11-24 14:37  castaglia

	* tests/: tests.pl, t/config/maxinstances.t,
	  t/lib/ProFTPD/TestSuite/Utils.pm,
	  t/lib/ProFTPD/Tests/Config/MaxInstances.pm:
	  Added test for the MaxInstances directive.

2008-11-22 15:23  castaglia

	* modules/mod_lang.c:
	  Make sure that, if no languages are explicitly configured, at
	  least the default one (obtained via environment variables) is
	  listed properly in the FEAT response.

2008-11-22 08:25  castaglia

	* src/fsio.c:
	  Add signal handling in the potentially long-running while loops
	  of the filesystem path resolution functions.

2008-11-21 23:07  castaglia

	* NEWS, contrib/mod_ratio.c:
	  Bug#1636 - GroupRatio does not check user's supplemental group
	  membership.

2008-11-21 20:45  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_rewrite.pm,
	  t/modules/mod_rewrite.t:
	  Added some unit tests for the mod_rewrite module.  There will be
	  many more to come for this module.

2008-11-21 20:44  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#2915 - mod_rewrite does not work well for SITE commands.

2008-11-21 19:12  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Add a site() method, for sending arbitrary SITE commands.

2008-11-21 17:31  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Add some nice features to the testsuite.  First, configs can be
	  defined using arrayrefs, in addition to hashrefs, so that the
	  ordering of config directives in the test config file can be
	  detected (important in some cases).  Second, the location of the
	  `proftpd' being tested can be defined using the PROFTPD_TEST_BIN
	  environment variable; useful (though not necessarily recommended)
	  if you want to run the testsuite using an existing proftpd.

2008-11-21 16:57  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Signals/HUP.pm,
	  t/lib/ProFTPD/Tests/Signals/TERM.pm, t/signals/hup.t:
	  Add unit tests for the HUP signal, at least for the daemon
	  process.

2008-11-21 16:11  castaglia

	* doc/howto/: Sendfile.html, index.html:
	  Adding doc covering sendfile and its issues.

2008-11-20 21:54  castaglia

	* NEWS, contrib/mod_sql.c,
	  tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Bug#2045 - SQLShowInfo should not be displayed when query returns
	  no data.

2008-11-20 15:17  castaglia

	* include/version.h:
	  Updating version for CVS.

2008-11-20 14:28  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2008-11-20 14:26  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for RC3 release.

2008-11-20 14:23  castaglia

	* RELEASE_NOTES:
	  Updating release notes, preparing for release.

2008-11-20 13:59  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Use the two-argument form of the Net::FTP constructor -- it works
	  better with older Perls.

2008-11-20 11:50  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/Utils.pm,
	  Tests/Modules/mod_wrap2_file.pm, Tests/Modules/mod_wrap2_sql.pm,
	  Tests/Signals/TERM.pm:
	  Get rid of a few places where we needed to use sleep() to delay
	  between server shutdown and server startup, in order to make sure
	  that the new server's PidFile and ScoreboardFile weren't deleted
	  by the previous server while it was shutting down.  Instead, the
	  server_stop() function will not return until it sees that the
	  PidFile has been deleted.

2008-11-20 01:11  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_ban.pm,
	  t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm,
	  t/lib/ProFTPD/Tests/Modules/mod_wrap2_file.pm,
	  t/lib/ProFTPD/Tests/Modules/mod_wrap2_sql.pm:
	  Retrofit the module-specific unit tests to use test-specific
	  scratch directories.	That should be all of the existing tests.

2008-11-20 00:27  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/ABOR.pm:
	  Quell Perl warnings about redeclared variables.

2008-11-20 00:18  castaglia

	* tests/t/lib/ProFTPD/Tests/: Logins.pm, Commands/ABOR.pm,
	  Commands/APPE.pm, Commands/LIST.pm, Commands/NLST.pm,
	  Commands/RETR.pm, Commands/STOR.pm, Commands/STOU.pm,
	  Config/DisplayConnect.pm, Config/DisplayLogin.pm,
	  Config/HideFiles.pm, Config/MaxLoginAttempts.pm,
	  Config/MaxRetrieveFileSize.pm, Config/MaxStoreFileSize.pm,
	  Config/RequireValidShell.pm, Config/ServerIdent.pm,
	  Config/TimeoutIdle.pm, Config/TimeoutLogin.pm,
	  Config/TimeoutNoTransfer.pm, Config/TimeoutSession.pm,
	  Config/TimeoutStalled.pm, Config/UseFtpUsers.pm, Signals/TERM.pm:

	  Retrofitted more of the testsuite to use more individualized
	  per-test scratch directories.

2008-11-19 20:19  castaglia

	* contrib/mod_ban.c:
	  Minor nits and improvements to mod_ban; no real functional
	  changes.

2008-11-19 16:35  castaglia

	* tests/t/lib/ProFTPD/Tests/: Logins.pm, Commands/ALLO.pm,
	  Commands/CDUP.pm, Commands/CWD.pm, Commands/DELE.pm,
	  Commands/EPRT.pm, Commands/EPSV.pm, Commands/FEAT.pm,
	  Commands/HELP.pm, Commands/MDTM.pm, Commands/MKD.pm,
	  Commands/MODE.pm, Commands/NOOP.pm, Commands/PASS.pm,
	  Commands/PASV.pm, Commands/PORT.pm, Commands/PWD.pm,
	  Commands/QUIT.pm, Commands/REST.pm, Commands/RMD.pm,
	  Commands/RNFR.pm, Commands/RNTO.pm, Commands/SIZE.pm,
	  Commands/STRU.pm, Commands/SYST.pm, Commands/TYPE.pm,
	  Commands/USER.pm:
	  Update some (but not all, yet) of the tests to use the new
	  scratch directory function.  Will need to finish the rest later
	  tonight.

2008-11-19 11:13  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/Utils.pm, Tests/Commands/ABOR.pm:

	  By fixing the daemon shutdown bug, I introduced some race
	  conditions into the unit tests.  Each unit test would use the
	  same 'tmp/' directory; and sometimes the next test would have
	  started (and used the same path for PidFile, ScoreboardFile)
	  before the server may have removed those files.

	  To address this, each unit test will get its own unique scratch
	  directory whose name will include the PID and a counter.  This
	  will require retrofitting most of the existing tests, but is
	  cleaner in the long run.

2008-11-19 10:21  castaglia

	* tests/t/lib/ProFTPD/Tests/Signals/TERM.pm:
	  Slight tweak to the shutdown test, to ensure that the server has
	  enough time between startup and shutdown to write out the
	  appropriate files.

2008-11-19 10:07  castaglia

	* NEWS, src/data.c:
	  Bug#3135 - Aborting a download can lead to segfault in some
	  cases.

2008-11-19 01:44  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_ban.pm,
	  t/modules/mod_ban.t:
	  Added start of unit tests for the mod_ban module.

2008-11-19 01:42  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Provide a function for obtaining the reason, given by the server,
	  why the initial connection might be denied.

2008-11-19 01:13  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Signals/TERM.pm,
	  t/signals/term.t:
	  Add a test for the SIGTERM signal handling of the daemon process,
	  to ensure that the shutdown procedures (PidFile removal,
	  ScoreboardFile removal) are indeed happening properly.

2008-11-19 00:58  castaglia

	* src/main.c:
	  While working on unit tests for mod_ban, I noticed that mod_ban's
	  shared memory segments were not being cleaned up.  I tracked it
	  down to the fact that the check to see if you're the "master"
	  process (assuming a ServerType of 'standalone') was failing,
	  because the cached "master PID" value was for the process _prior
	  to daemonizing_.  I suspect that many shutdown cleanups, such as
	  PidFile removal and such, have not been happening for a while.

2008-11-18 19:54  castaglia

	* configure:
	  Updated configure.

2008-11-18 19:51  castaglia

	* Make.rules.in, Makefile.in, configure.in, locale/Makefile.in:
	  Properly honor the --localedir configure option.

2008-11-18 19:31  castaglia

	* src/encode.c:
	  Comment typo.

2008-11-18 11:29  castaglia

	* src/encode.c:
	  Check in some of the fixes found while investigating Bug#3134,
	  particularly ones which can cause segfaults (e.g. on FreeBSD)
	  when an iconv_t handle is closed multiple times erroneously.

2008-11-17 09:31  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/ABOR.pm:
	  Be sure to clean up the generated log file.

2008-11-17 08:59  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Commands/ABOR.pm:
	  After all the work done on Bug#3131, these ABOR unit tests should
	  definitely be checked in and added to the testsuite.

2008-11-16 18:32  castaglia

	* NEWS:
	  Remove duplicate bug entry.

2008-11-16 17:49  castaglia

	* tests/tests.pl:
	  Don't add the 'testsuite_empty_test' to the list of files, if
	  that is what is returned by filtering for feature-based test
	  files.

2008-11-16 17:42  castaglia

	* src/netio.c:
	  Fix uploads; it had been inadvertently broken when trace logging
	  of EOF was added.  The testsuite caught this regression; the
	  testsuite is coming in handy!

2008-11-16 12:35  castaglia

	* NEWS, src/main.c:
	  Bug#3073 - Command arguments not decoded properly in some places.

2008-11-15 14:53  castaglia

	* configure:
	  Updated configure.

2008-11-15 14:37  castaglia

	* RELEASE_NOTES:
	  Mention the change in TimeoutLinger default value in the release
	  notes.

2008-11-15 14:34  castaglia

	* configure.in, include/options.h:
	  Change the default linger timeout from 1.5 minutes (180 secs) to
	  30 secs.  Many command-line FTP clients have a timeout of 60
	  secs, after which they think the server has timed out, and will
	  close the control connection.  We want to make sure that
	  proftpd's lingering closes do not linger past that 60 secs mark.

2008-11-14 20:26  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/: EPRT.pm, EPSV.pm:
	  Make sure the EPRT tests are sensitive to whether the built
	  proftpd supports IPv6.  Did the same for the EPSV tests, and
	  added more tests for the optional EPSV arguments.

2008-11-14 20:23  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Allow the epsv() method to take an optional protocol number, as
	  allowed in the EPSV command.

2008-11-14 19:31  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Apply the same Net::FTP internals muck to the epsv() and eprt()
	  methods as used in the pasv() and port() methods.

2008-11-14 19:23  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Quell Perl warning about redeclared variable.

2008-11-14 19:21  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Make the pasv() and port() methods actually cause the client to
	  use passive and active data transfers, respectively, rather than
	  having to rely on a constructor-time setting.  Yuck.

2008-11-14 18:01  castaglia

	* NEWS, src/data.c, src/netio.c:
	  Bug#3131 - Session process uses 100% CPU after aborted transfer.

2008-11-14 14:40  castaglia

	* tests/Makefile.in:
	  Fix typo.

2008-11-14 11:58  castaglia

	* modules/mod_lang.c:
	  When calling setlocale(3) to get the LANG to advertise in the
	  FEAT response, use LC_MESSAGES rather than LC_ALL; the latter can
	  result in a string which includes the locales for every category
	  when we just want the LC_MESSAGES category.

2008-11-14 11:35  castaglia

	* NEWS, src/main.c:
	  Bug#3132 - Handling of SIGABRT signal leads to endless loop.

2008-11-14 10:25  castaglia

	* src/: main.c, netio.c:
	  Add trace logging of the handling of EOF, i.e. when a client
	  closes (or shuts down) its control connection, causing proftpd to
	  close that connection.

	  Also make the implementation of the poll callback a little nicer;
	  rather than calling select(2) on an empty fd_set, pass NULL if
	  that fd_set is empty.

2008-11-13 12:00  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Fix the feature-checking code so that tests using a "feature_X"
	  class are properly handled.

2008-11-13 00:15  castaglia

	* tests/t/: commands/abor.t, lib/ProFTPD/Tests/Commands/ABOR.pm:
	  Check in some of the in-progress unit tests on the ABOR command
	  (being driven by investigations for Bug#3131).  The tests are not
	  part of the full testsuite yet.

2008-11-12 08:33  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_wrap2_sql.pm,
	  t/modules/mod_wrap2_sql.t:
	  Added unit tests for mod_wrap2_sql.

2008-11-11 22:45  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/Tests/Modules/mod_wrap2_file.pm,
	  t/modules/mod_wrap2_file.t:
	  Add unit tests for mod_wrap2_file.

2008-11-11 09:42  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Add routine for checking the enabled features in the proftpd
	  build.  Use this for disabling IPv6 support in the unit tests, if
	  IPv6 support is enabled, unless explicitly requested otherwise in
	  the test.

2008-11-11 09:25  castaglia

	* tests/t/lib/ProFTPD/Tests/: Logins.pm, Commands/ALLO.pm,
	  Commands/APPE.pm, Commands/CDUP.pm, Commands/CWD.pm,
	  Commands/DELE.pm, Commands/EPRT.pm, Commands/EPSV.pm,
	  Commands/FEAT.pm, Commands/HELP.pm, Commands/LIST.pm,
	  Commands/MDTM.pm, Commands/MKD.pm, Commands/MODE.pm,
	  Commands/NOOP.pm, Commands/PASS.pm, Commands/PASV.pm,
	  Commands/PORT.pm, Commands/PWD.pm, Commands/QUIT.pm,
	  Commands/REST.pm, Commands/RNFR.pm, Commands/SIZE.pm,
	  Commands/STRU.pm, Commands/SYST.pm, Commands/TYPE.pm,
	  Commands/USER.pm, Config/DisplayConnect.pm,
	  Config/DisplayLogin.pm, Config/MaxLoginAttempts.pm,
	  Config/ServerIdent.pm:
	  Remove unnecessary import of module-related functions.

2008-11-10 21:35  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  Fix bug, found by unit tests, with evaluation of conditions for
	  applying WrapGroupTables directive.  The logic was incorrectly
	  inverted.

2008-11-10 14:14  castaglia

	* tests/tests.pl:
	  If there are no additional feature/module-specific test files to
	  add, then don't add them, not even the 'testsuite_empty_test'
	  stub test.

2008-11-10 14:13  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/: MaxRetrieveFileSize.pm,
	  MaxStoreFileSize.pm:
	  Quell Perl compiler warnings about re-declared variables.

2008-11-08 14:56  castaglia

	* tests/: tests.pl, t/config/maxretrievefilesize.t,
	  t/config/maxstorefilesize.t,
	  t/lib/ProFTPD/Tests/Config/MaxRetrieveFileSize.pm,
	  t/lib/ProFTPD/Tests/Config/MaxStoreFileSize.pm:
	  Added unit tests for the MaxRetrieveFileSize and MaxStoreFileSize
	  directives.

2008-11-08 13:32  castaglia

	* tests/: tests.pl, t/config/requirevalidshell.t,
	  t/config/useftpusers.t,
	  t/lib/ProFTPD/Tests/Config/RequireValidShell.pm,
	  t/lib/ProFTPD/Tests/Config/UseFtpUsers.pm:
	  Added unit tests for the RequireValidShell and UseFtpUsers
	  directives.

2008-11-08 12:58  castaglia

	* tests/: tests.pl, t/config/timeoutidle.t,
	  t/config/timeoutlogin.t, t/config/timeoutnotransfer.t,
	  t/config/timeoutsession.t, t/config/timeoutstalled.t,
	  t/lib/ProFTPD/Tests/Config/TimeoutIdle.pm,
	  t/lib/ProFTPD/Tests/Config/TimeoutLogin.pm,
	  t/lib/ProFTPD/Tests/Config/TimeoutNoTransfer.pm,
	  t/lib/ProFTPD/Tests/Config/TimeoutSession.pm,
	  t/lib/ProFTPD/Tests/Config/TimeoutStalled.pm:
	  Added unit tests for the various Timeout directives.

2008-11-07 15:31  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RETR.pm:
	  Minor adjustment to make a RETR test pass; the
	  File::Spec::rel2abs() Perl function can take *a lot* longer to
	  run, than expected, in some cases.  Not sure why yet.

2008-11-07 15:25  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/STOU.pm:
	  The STOU tests now pass when run both as root and as non-root.

2008-11-07 15:21  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/STOR.pm:
	  Update the STOR tests to pass when run as root and as non-root.

2008-11-07 15:17  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RNTO.pm:
	  Make sure the RNTO tests pass when run as root and as non-root.

2008-11-07 15:13  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RMD.pm:
	  Adjust the RMD tests to pass when run as root and as non-root.

2008-11-07 15:10  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RETR.pm:
	  Make the RETR tests pass when run as both root and non-root.

2008-11-07 15:06  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/NLST.pm:
	  Update the NLST tests to pass when run as root and as non-root.

2008-11-07 15:00  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/MKD.pm:
	  Adjust the MKD tests so that using root and non-root users work,
	  and the tests pass.

2008-11-07 14:57  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/LIST.pm:
	  Adjust the LIST tests so that they pass when run both as root and
	  as non-root.

2008-11-07 14:50  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/DELE.pm:
	  Rework the DELE unit tests so that they pass when run both as
	  root and as non-root.

2008-11-07 14:43  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/APPE.pm:
	  Rework the APPE tests so that they always pass, whether run as
	  root or not.

2008-11-07 11:35  castaglia

	* doc/howto/Testing.html:
	  Mention that some integration tests are skipped if not run with
	  root privs.

2008-11-07 11:23  castaglia

	* tests/t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm:
	  Add a regression test for Bug#2922.

2008-11-07 10:37  castaglia

	* tests/t/: lib/ProFTPD/TestSuite/FTP.pm,
	  lib/ProFTPD/TestSuite/Utils.pm,
	  lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm,
	  modules/mod_sql_sqlite.t:
	  Adding some regressions tests for Bugs #3116, #3124, and #3126.

2008-11-06 13:47  castaglia

	* NEWS, src/dirtree.c:
	  Bug#3130 - HideFiles can cause segfault.

2008-11-06 13:46  castaglia

	* tests/: tests.pl, t/config/hidefiles.t,
	  t/lib/ProFTPD/TestSuite/Utils.pm,
	  t/lib/ProFTPD/Tests/Config/HideFiles.pm:
	  Added unit test for reproducing Bug#3130 (and preventing
	  regressions).

2008-11-05 23:46  castaglia

	* tests/: tests.pl, t/lib/ProFTPD/TestSuite/Utils.pm,
	  t/lib/ProFTPD/Tests/Modules/mod_sql.pm,
	  t/lib/ProFTPD/Tests/Modules/mod_sql_sqlite.pm,
	  t/modules/mod_sql.t, t/modules/mod_sql_sqlite.t:
	  Make the tests.pl script "interrogate" the compiled proftpd, and
	  start adding tests based on the compiled features (e.g. modules
	  included, features enabled, etc).

	  Add stub module files for mod_sql and mod_sql_sqlite; these will
	  be the first module-specific test files; they will be
	  demonstrations/examples for creating test files for other
	  modules.

2008-11-05 18:46  castaglia

	* doc/howto/Testing.html:
	  Update the Testing howto to reflect changes made to the 'make
	  check' target.

2008-11-05 18:45  castaglia

	* tests/: .cvsignore, Makefile.in, t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/STOU.pm:
	  Run the integration tests after the API tests, as part of the
	  'make check' target.

	  Fix some Perl warnings in the STOU tests.  Make sure that the cvs
	  commands ignore all generated log files (e.g. cvs diff won't
	  complain about unknown .log files).

2008-11-05 18:28  castaglia

	* doc/howto/index.html:
	  Add a link to the Testing howto in the howto index.

2008-11-05 18:27  castaglia

	* doc/howto/Testing.html:
	  The Testing howto is now in a mostly usable form.

2008-11-05 18:23  castaglia

	* modules/mod_xfer.c, src/data.c:
	  Fix a problem with the handling of STOU.  This problem was
	  detected by the testsuite, as it should.

2008-11-05 17:38  castaglia

	* tests/api/tests.c:
	  Make sure that the testsuite log name is kept in sync with what
	  is displayed in the error message.

2008-11-03 11:27  castaglia

	* contrib/mod_sql_sqlite.c:
	  Explain why sqlite3_shutdown() is not called when the
	  mod_sql_sqlite module is being unloaded.

2008-11-03 10:46  castaglia

	* contrib/mod_sql_sqlite.c:
	  Stylistic nits; no functional change.

2008-11-03 09:55  castaglia

	* NEWS, contrib/mod_sql_sqlite.c:
	  Bug#3126 - Segfault in mod_sql_sqlite when user belongs to
	  multiple groups.

2008-10-31 13:15  castaglia

	* NEWS, contrib/mod_ldap.c, contrib/mod_sql.c, src/log.c:
	  Bug#2767 - gcc 4.0/amd64 warnings.

2008-10-31 10:38  castaglia

	* NEWS, include/fsio.h, src/fsio.c:
	  Bug#3092 - FSIO API needs mechanism for allowing registered FS
	  handlers to permit atomic renames.

2008-10-30 16:38  castaglia

	* modules/mod_xfer.c, src/data.c:
	  Turns out that not _all_ data connections are allocated from
	  session.xfer.p; some are allocated from session.pool.  The
	  previous changes had inadvertently broken passive data transfers.
	   For passive data transfers, then, use session.pool for
	  allocating the connection object (session.d), rather than
	  session.xfer.p; thus making consistent the pool that is used for
	  allocating session.d.

	  Also clean up some of the error responses for failed uploads;
	  they might have referenced NULL pointers, which would
	  subsequently cause segfaults/crashes on platforms whose printf(3)
	  functions don't handle the case well.

2008-10-29 15:07  castaglia

	* RELEASE_NOTES:
	  Start prepping the RC3 release notes.

2008-10-28 10:22  castaglia

	* contrib/mod_sql.c:
	  Add a comment about why the nested sql_prepare_where() function
	  calls are the way they are (to prevent future developers from
	  regressing Bug#3124).

2008-10-28 10:19  castaglia

	* include/data.h, modules/mod_xfer.c, src/data.c:
	  Improve on the fix for Bug#3089 by creating a new function
	  specifically to clear the session.xfer.p pool and any associated
	  structures; this function refactors all of the associated code
	  into a single location.

2008-10-27 18:02  castaglia

	* doc/howto/Testing.html:
	  Adding slightly more substance to the Testing howto; hopefully I
	  can muster the motivation to finish it later tonight.

2008-10-27 17:48  castaglia

	* NEWS, modules/mod_xfer.c, src/data.c, src/inet.c:
	  Bug#3089 - Memory pool double-free on session exit after aborted
	  data transfer.

2008-10-27 17:46  castaglia

	* include/inet.h, src/inet.c:
	  Remove the pr_inet_associate() function; nothing was using it.

2008-10-27 15:35  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#3124 - mod_sql improperly substitutes variables in user/group
	  names.

2008-10-21 11:03  castaglia

	* configure:
	  Updated configure.

2008-10-21 11:01  castaglia

	* NEWS, config.h.in, configure.in, src/encode.c:
	  Bug#3122: iconv() not detected properly on FreeBSD when
	  --enable-nls is used.

2008-10-20 09:08  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/PASS.pm:
	  Make sure that the PASS unit tests expected the proper response
	  message.

2008-10-20 08:14  castaglia

	* include/glibc-glob.h:
	  Fix compiler detection to deal with other compilers.

2008-10-19 17:45  castaglia

	* tests/: tests.pl, t/config/maxloginattempts.t,
	  t/lib/ProFTPD/Tests/Config/MaxLoginAttempts.pm:
	  Added unit tests for the MaxLoginAttempts directive.

2008-10-19 17:02  castaglia

	* locale/: en_US.po, it_IT.po, proftpd.pot, zh_CN.po:
	  Removing redundant (and now absent) entry for "Login incorrect";
	  there is already a "Login incorrect." (note the period) entry.

2008-10-19 17:01  castaglia

	* contrib/mod_ban.c:
	  Make mod_ban use the same "Login incorrect." string, including
	  period, like the rest of mod_auth.  Inconsistencies in responses
	  constitute information leaks, albeit minor.

2008-10-19 16:59  castaglia

	* modules/mod_auth.c:
	  Fixed failed login message to be consistent with other instances
	  of the "Login incorrect" string.

2008-10-19 16:41  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/: EPSV.pm, PASV.pm:
	  Make the regexes tigher for checking the expected EPSV and PASV
	  responses.

2008-10-19 12:48  castaglia

	* tests/: tests.pl, t/commands/eprt.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/EPRT.pm:
	  Added tests for the EPRT command.

2008-10-19 12:31  castaglia

	* tests/: tests.pl, t/commands/epsv.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/EPSV.pm:
	  Added tests for the EPSV command.

2008-10-19 12:23  castaglia

	* tests/: tests.pl, t/commands/feat.t, t/commands/help.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/FEAT.pm,
	  t/lib/ProFTPD/Tests/Commands/HELP.pm:
	  Added tests for the FEAT and HELP commands.

2008-10-19 12:02  castaglia

	* tests/: tests.pl, t/commands/pass.t, t/commands/user.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/PASS.pm,
	  t/lib/ProFTPD/Tests/Commands/USER.pm:
	  Added tests for the USER and PASS commands.

2008-10-19 11:36  castaglia

	* tests/: tests.pl, t/config/displaylogin.t,
	  t/lib/ProFTPD/Tests/Config/DisplayLogin.pm:
	  Added tests for the DisplayLogin directive.

2008-10-18 19:04  castaglia

	* tests/t/lib/ProFTPD/Tests/Config/DisplayConnect.pm:
	  Forgot to clean up a test file that's outside of the tmp/
	  directory.

2008-10-18 18:50  castaglia

	* tests/: tests.pl, t/config/displayconnect.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Config/DisplayConnect.pm:
	  Added tests for the DisplayConnect directive.

2008-10-18 17:38  castaglia

	* tests/: tests.pl, t/config/serverident.t,
	  t/lib/ProFTPD/Tests/Config/ServerIdent.pm:
	  Added first unit tests for config directives; we're starting with
	  ServerIdent.

2008-10-18 16:20  castaglia

	* tests/: tests.pl, t/commands/appe.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/APPE.pm:
	  Added tests for the APPE command.

2008-10-18 16:12  castaglia

	* tests/: tests.pl, t/commands/stou.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/LIST.pm,
	  t/lib/ProFTPD/Tests/Commands/NLST.pm,
	  t/lib/ProFTPD/Tests/Commands/RETR.pm,
	  t/lib/ProFTPD/Tests/Commands/STOR.pm,
	  t/lib/ProFTPD/Tests/Commands/STOU.pm:
	  Added tests for the STOU command.  Cleaned up handling of FTP
	  response messages.

2008-10-18 14:58  castaglia

	* tests/: tests.pl, t/commands/stor.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/STOR.pm:
	  Added some tests for the STOR command.

2008-10-18 14:48  castaglia

	* modules/mod_xfer.c:
	  Preserve the error code for a failing to open the file to be
	  uploaded; errno was being overwritten by subsequent function
	  calls before being reported back to the client.

2008-10-18 13:43  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RETR.pm:
	  Remove copy-n-pasted code from the RETR tests, and make them work
	  more reliably.

2008-10-18 12:59  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Quell some annoying Perl warnings (coming from Net::Cmd and
	  Net::FTP) by providing an initialized default value.	Makes
	  running the testsuite using tests.pl much prettier.

2008-10-17 17:24  castaglia

	* tests/: tests.pl, t/commands/retr.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/LIST.pm,
	  t/lib/ProFTPD/Tests/Commands/NLST.pm,
	  t/lib/ProFTPD/Tests/Commands/RETR.pm:
	  Add some basic tests of the RETR command.

2008-10-17 14:27  castaglia

	* tests/: tests.pl, t/commands/list.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm, t/lib/ProFTPD/TestSuite/Utils.pm,
	  t/lib/ProFTPD/Tests/Commands/LIST.pm:
	  Start of tests for the LIST command; expect more in the future.

2008-10-17 08:25  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  Fix Bug#3120 for the WrapGroupTables and WrapUserTables
	  directives as well.

2008-10-17 08:16  castaglia

	* NEWS, contrib/mod_wrap2/mod_wrap2.c:
	  Bug#3120 - WrapTables not allowed in <Anonymous> context.

2008-10-15 19:04  castaglia

	* tests/t/lib/ProFTPD/Tests/: Logins.pm, Commands/ALLO.pm,
	  Commands/CDUP.pm, Commands/CWD.pm, Commands/DELE.pm,
	  Commands/MDTM.pm, Commands/MKD.pm, Commands/MODE.pm,
	  Commands/NOOP.pm, Commands/PASV.pm, Commands/PORT.pm,
	  Commands/PWD.pm, Commands/QUIT.pm, Commands/REST.pm,
	  Commands/RMD.pm, Commands/SIZE.pm, Commands/STRU.pm,
	  Commands/SYST.pm, Commands/TYPE.pm:
	  Updated tests to use server_wait().

2008-10-15 16:55  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/FTP.pm, TestSuite/Utils.pm,
	  Tests/Commands/NLST.pm, Tests/Commands/RNFR.pm,
	  Tests/Commands/RNTO.pm:
	  Retrofit some of the test classes to use server_wait().  Fixed up
	  some of the NLST tests (due to the vagaries of the Perl Net::FTP
	  class).

2008-10-15 10:18  castaglia

	* configure:
	  Updated configure.

2008-10-15 10:12  castaglia

	* NEWS, config.h.in, configure.in:
	  Bug#3119 - Search for libcap2 in addition to libcap for mod_cap
	  support.

2008-10-15 09:31  castaglia

	* doc/modules/mod_cap.html:
	  Mention the fact that some Linux distros use a package name of
	  "libcap2-dev" as well as (or instead of) "libcap2".

2008-10-14 16:23  castaglia

	* modules/mod_dso.c:
	  Log, at debug level 7, when we are loading a module.	This
	  message is symmetric with the similar message when a module is
	  unloaded.

2008-10-14 15:28  castaglia

	* contrib/mod_ifsession.c:
	  Fix compilation error.

2008-10-13 23:24  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RNTO.pm:
	  Revert the response message check changes made earlier; the
	  discrepancy was caused by stale source code, not by
	  platform/version differences.

2008-10-13 23:20  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  As per the Net::FTP documentation, the use of PASV vs PORT is
	  done at instantiation time, oddly enough.  Make sure this feature
	  is exposed in the testsuite.

2008-10-13 23:03  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Add a function that encapsulates the server-wait part of the
	  tests, including a timeout.

2008-10-13 21:25  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands/RNTO.pm:
	  Looks like some of the errno strings differ across platforms and
	  versions.

2008-10-13 18:11  castaglia

	* tests/: tests.pl, t/commands/nlst.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/NLST.pm:
	  Added tests for NLST; still more tests to be added.

2008-10-13 17:35  castaglia

	* tests/t/lib/ProFTPD/TestSuite/Utils.pm:
	  Make sure that lingering processes, if not killed properly, are
	  timed out quickly.

2008-10-13 16:24  castaglia

	* tests/: tests.pl, t/commands/rest.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/REST.pm:
	  Added tests for the REST command.

2008-10-13 16:06  castaglia

	* tests/: tests.pl, t/commands/quit.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/QUIT.pm:
	  Added test for the QUIT command.

2008-10-13 15:52  castaglia

	* tests/: tests.pl, t/commands/rnfr.t, t/commands/rnto.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/RNFR.pm,
	  t/lib/ProFTPD/Tests/Commands/RNTO.pm:
	  Added tests for the RNFR, RNTO commands.

2008-10-13 15:36  castaglia

	* modules/mod_core.c:
	  Preserve the actual errno value if the renaming fails; it was
	  getting trounced in subsequent function calls.

2008-10-13 14:57  castaglia

	* tests/: tests.pl, t/commands/noop.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/NOOP.pm:
	  Added test for the NOOP command.

2008-10-13 14:50  castaglia

	* tests/: tests.pl, t/commands/port.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/PORT.pm:
	  Add tests for the PORT command.

2008-10-13 13:05  castaglia

	* tests/t/lib/ProFTPD/TestSuite/FTP.pm:
	  Fixed regex matching of ALLO response code leading digit.

2008-10-13 13:02  castaglia

	* tests/: tests.pl, t/commands/allo.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/ALLO.pm:
	  Added test for the ALLO command.

2008-10-13 12:38  castaglia

	* tests/: tests.pl, t/commands/stru.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/STRU.pm:
	  Added tests for the STRU command.

2008-10-13 10:59  castaglia

	* tests/: tests.pl, t/commands/mode.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/MODE.pm:
	  Add tests for the MODE command.

2008-10-13 10:13  castaglia

	* tests/: tests.pl, t/commands/pasv.t,
	  t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/Tests/Commands/PASV.pm:
	  Added tests for the PASV command.

2008-10-13 08:49  castaglia

	* tests/: tests.pl, t/commands.t, t/commands/cdup.t,
	  t/commands/cwd.t, t/commands/dele.t, t/commands/mdtm.t,
	  t/commands/mkd.t, t/commands/pwd.t, t/commands/rmd.t,
	  t/commands/size.t, t/commands/syst.t, t/commands/type.t,
	  t/lib/ProFTPD/Tests/Commands.pm,
	  t/lib/ProFTPD/Tests/Commands/CDUP.pm,
	  t/lib/ProFTPD/Tests/Commands/CWD.pm,
	  t/lib/ProFTPD/Tests/Commands/DELE.pm,
	  t/lib/ProFTPD/Tests/Commands/MDTM.pm,
	  t/lib/ProFTPD/Tests/Commands/MKD.pm,
	  t/lib/ProFTPD/Tests/Commands/PWD.pm,
	  t/lib/ProFTPD/Tests/Commands/RMD.pm,
	  t/lib/ProFTPD/Tests/Commands/SIZE.pm,
	  t/lib/ProFTPD/Tests/Commands/SYST.pm,
	  t/lib/ProFTPD/Tests/Commands/TYPE.pm:
	  Split the unit tests for FTP commands into separate files, one
	  file per set of tests of a command.  The previous files were
	  getting too large and unwieldy.

2008-10-12 18:03  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/FTP.pm, Tests/Commands.pm:
	  Added tests for the TYPE, MDTM, and SIZE commands.

2008-10-12 17:07  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/FTP.pm, Tests/Commands.pm:
	  Added tests for the DELE command.

2008-10-12 16:55  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/FTP.pm, Tests/Commands.pm,
	  Tests/Logins.pm:
	  Added command test cases where failures (for different reasons)
	  are expected.

2008-10-12 15:27  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/FTP.pm, Tests/Commands.pm:
	  Added tests for the MKD, XMKD, RMD, and XRMD commands.

2008-10-12 15:14  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/FTP.pm, TestSuite/Utils.pm,
	  Tests/Commands.pm, Tests/Logins.pm:
	  Added tests for CDUP, XCUP, and SYST commands.  Added better
	  error messages (with location now) for failed assertions.  Fixed
	  cases where failed login tests might allow the server to continue
	  running.

2008-10-12 14:00  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/FTP.pm, Tests/Commands.pm:
	  Fixed use of assertions when checking response codes and
	  messages.

	  Added tests for the XPWD, CWD, and XCWD commands.

2008-10-12 13:30  castaglia

	* tests/t/lib/ProFTPD/Tests/Commands.pm:
	  Fix the PWD test so that it actually checks that the FTP response
	  code and message are as expected, not just that they exist.

2008-10-12 13:18  castaglia

	* tests/: tests.pl, t/commands.t, t/lib/ProFTPD/TestSuite/FTP.pm,
	  t/lib/ProFTPD/TestSuite/Utils.pm,
	  t/lib/ProFTPD/Tests/Commands.pm:
	  Start of test cases for the various FTP commands; PWD is simple,
	  so it was first.

	  Also add support for writing AuthUserFiles and AuthGroupFiles;
	  this makes it easier to log into the running proftpd without
	  requiring root privs.

2008-10-12 12:12  castaglia

	* tests/t/lib/ProFTPD/TestSuite/: FTP.pm, Utils.pm:
	  Fix the anonymous login unit test such that it passes (requires
	  root privs).	Fix the FTP client wrapper so that it properly
	  retrieves the FTP response code and message.	Update Utils so
	  that the server identity (User/Group) retrieved are always
	  non-root accounts.

2008-10-11 14:35  castaglia

	* tests/t/lib/ProFTPD/: TestSuite/Utils.pm, Tests/Logins.pm:
	  Fix the anonymous login test (it should fail, unless run with
	  root privs).

	  Have defaults for the common config directives.  Exclude tests
	  which require root privs unless we are being run with root privs.

2008-10-11 13:37  castaglia

	* tests/: tests.pl, t/logins.t, t/lib/ProFTPD/TestSuite/Child.pm,
	  t/lib/ProFTPD/TestSuite/FTP.pm, t/lib/ProFTPD/TestSuite/Utils.pm,
	  t/lib/ProFTPD/Tests/Logins.pm:
	  Start of a collection of unit tests against a running proftpd
	  server, using Perl.

2008-10-11 08:58  castaglia

	* modules/mod_facts.c:
	  Fixed bug handling the MFMT command; found by a user in the
	  online forums.

2008-10-08 09:55  castaglia

	* doc/howto/: Translations.html, index.html:
	  Adding a Translation mini-howto.

2008-10-07 15:48  castaglia

	* doc/modules/mod_lang.html:
	  Typo.

2008-10-07 10:43  castaglia

	* tests/: .cvsignore, Makefile.in, api/.cvsignore, api/tests.c:
	  Rename the executable used for testing the API (and the log file
	  that executable generates) to be "api-tests", to differentiate it
	  from the other tests I am working on.

2008-10-07 10:10  castaglia

	* tests/api/.cvsignore:
	  Add .cvsignore file for the new tests/api/ directory.

2008-10-06 23:17  castaglia

	* src/main.c:
	  Need to use exit(), rather than end_login().	Something about the
	  latter makes it impossible to read stdout programmatically when
	  using -vv.

2008-10-06 11:36  castaglia

	* modules/mod_auth_pam.c:
	  Make mod_auth_pam reject the connection if it is unable to
	  register itself as an auth-only module with the Auth API.  This
	  check would have caught the Bug#2922 regression much earlier.
	  Ah, hindsight.

2008-10-06 11:16  castaglia

	* tests/: Makefile.in, array.c, class.c, env.c, event.c, expr.c,
	  feat.c, modules.c, netacl.c, netaddr.c, pool.c, regexp.c,
	  scoreboard.c, sets.c, str.c, stubs.c, table.c, tests.c, tests.h,
	  timers.c, var.c, version.c, api/array.c, api/class.c, api/env.c,
	  api/event.c, api/expr.c, api/feat.c, api/modules.c, api/netacl.c,
	  api/netaddr.c, api/pool.c, api/regexp.c, api/scoreboard.c,
	  api/sets.c, api/str.c, api/stubs.c, api/table.c, api/tests.c,
	  api/tests.h, api/timers.c, api/var.c, api/version.c:
	  Moving the current API unit test source files into an api/
	  directory, to make room for a directory for integration unit
	  tests (i.e. login tests, command tests, configuration tests, etc)
	  which require an FTP client and a running proftpd.

2008-10-06 10:20  castaglia

	* NEWS, src/auth.c:
	  Bug#3117 - Authentication improperly allowed (Bug#2922
	  regression).

2008-10-06 08:54  castaglia

	* contrib/mod_sql_sqlite.c:
	  Add a header-vs-lib version check to mod_sql_sqlite, similar to
	  the one that is in mod_tls.  Hopefully any discrepancies will get
	  sysadmins to correct the software installations on their system.

2008-10-06 08:47  castaglia

	* contrib/mod_ldap.c:
	  When mod_ldap is initialized, print out the LDAP vendor and LDAP
	  API version.

2008-10-06 08:19  jwm

	* contrib/mod_ldap.c: mod_ldap bzr r58:   typo

2008-10-06 08:11  jwm

	* contrib/mod_ldap.c: mod_ldap bzr r57:   * Prevent the use of
	  LDAPSearchScope or LDAPUseSSL when LDAPServer     specifies a
	  URL. Instead, the desired search scope and SSL setting     should
	  be specified by the URL.

	  mod_ldap bzr r56:   - remove extraneous includes   - free the
	  LDAPURLDesc in ldap_getconf(), since we don't attach it to
	  the configuration directive any more

2008-10-05 18:44  castaglia

	* src/dirtree.c:
	  Reduce the size of the pool allocated for config_recs; should
	  reduce the memory footprint more without (hopefully) any adverse
	  side effects.

2008-10-04 18:48  castaglia

	* modules/mod_auth_pam.c:
	  Correct some of the terms in the trace messages from the PAM
	  conversation callback.

2008-10-04 16:55  castaglia

	* modules/mod_auth_pam.c:
	  Be less strict about AuthPAMOptions, and use case-insensitive
	  checks.

2008-10-04 16:23  castaglia

	* modules/mod_core.c:
	  Fix typo which made for a rather confusing comment.

2008-10-04 15:15  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#3116 - SQLNegativeCache with no group info can cause
	  segfault.

2008-10-04 10:14  castaglia

	* src/: main.c, netio.c:
	  Apply a tag to the one unnamed subpool of permanent_pool.  Add
	  comments about why that subpool (which isn't needed in the daemon
	  process) is allocated.

2008-10-03 22:43  castaglia

	* src/class.c:
	  Tag any pools allocated for class definitions.

2008-10-03 22:38  castaglia

	* src/pool.c:
	  Fix the mechanism used to count the number of sub-pools in a
	  pool; it was not recursing properly.

2008-10-03 22:23  castaglia

	* src/timers.c:
	  It's high time the Timers API had its own memory pool, rather
	  than using permanent_pool directly.

2008-10-03 22:03  castaglia

	* contrib/mod_ctrls_admin.c:
	  Check in the control action which helps me to find pool use
	  misbehaviors.  If proftpd is compiled using --enable-devel, and
	  the mod_ctrs_admin module is used (which itself requires
	  --enable-ctrls), then a 'debug memory' control action (via
	  ftpdctl) is supported.

2008-10-03 22:01  castaglia

	* src/pool.c:
	  Prettify, and update, the messages emitted when debugging pool
	  usage.

2008-10-03 22:00  castaglia

	* src/main.c:
	  Fix an egregious memory leak in the daemon process (but not in
	  session processes).  On startup, proftpd would allocate a memory
	  pool for the Netaddr API.  This pool was used, but never cleared.
	  And every restart would cause more allocations (for the netaddr
	  objects used in the bindings) from this pool.  Thus a
	  long-running proftpd, restarted occasionally (as is done for log
	  rolling) would gradually leak quite a bit.  Slowly, to be sure,
	  but noticeable for long-lived daemons.

2008-10-03 21:53  castaglia

	* src/modules.c:
	  Reduce the size of the sub-pool used for symbols in the stash.
	  This reduces the memory footprint of the proftpd daemon process
	  (and session processes) by quite a bit, given that there are
	  quite a few symbols allocated.  Hopefully this won't cause any
	  issues.

2008-10-03 21:01  castaglia

	* src/help.c:
	  Minor label nit.

2008-10-03 18:10  castaglia

	* contrib/mod_sql.c:
	  Allow the SQLEngine directive to be processed even if, for some
	  reason, the user name config_rec can't be found.

2008-10-03 16:10  castaglia

	* doc/modules/mod_lang.html:
	  Add a Usage section containing, for now, a description of the
	  Cyrillic/Telnet issue, and how to use mod_lang to work around it.

2008-10-02 13:53  castaglia

	* modules/mod_auth.c:
	  Minor change to test SourceForge's commit mail.

2008-10-02 10:06  castaglia

	* modules/mod_auth.c:
	  Generate a few new events: one for when a root login is
	  attempted, and one containing the authentication code value.
	  These events are added first for the use by mod_audit, a
	  third-party module for auditing certain application events.

2008-10-01 16:30  castaglia

	* contrib/mod_tls.c:
	  Minor tweaks to allow TLSPassPhraseProvider to work properly on
	  Mac OSX.  Shouldn't harm anything.

2008-09-30 22:49  castaglia

	* contrib/mod_tls.c:
	  When handling the exit event in the daemon process, the TLSLog is
	  not open.  Thus use pr_log_pri() and pr_log_debug() rather than
	  tls_log() there.

2008-09-30 13:43  castaglia

	* src/: main.c, trace.c:
	  Add trace logging of when the various signals are handled.

	  When handling a restart, be sure to close any open trace log fd.
	  Also, to prevent issues with Solaris' stupid stdio fd limit of
	  256, make sure that the fallback fd used for the TraceLog is 255.

2008-09-30 01:00  castaglia

	* contrib/mod_dynmasq.c:
	  Reduce the log verbosity of mod_dynmasq more, as per user
	  request.

2008-09-29 16:02  castaglia

	* src/support.c: [no log message]

2008-09-29 09:07  castaglia

	* contrib/mod_dynmasq.c:
	  Change the logging of mod_dynmasq slightly, so that it does not
	  spam the system log with messages.

2008-09-26 13:57  castaglia

	* src/response.c:
	  Add trace logging of the responses that are added, not just when
	  the responses are flushed to the client.

2008-09-25 15:24  castaglia

	* src/main.c:
	  Include the version status (e.g. "CVS", "devel", "stable") in the
	  -V output, as well as the build timestamp.

2008-09-22 22:52  castaglia

	* INSTALL:
	  Update the mailing list info in the INSTALL file.

2008-09-22 21:40  castaglia

	* tests/array.c:
	  Add unit test for the clear_array() function added in 1.3.2rc2.

2008-09-20 13:18  castaglia

	* NEWS, src/main.c, src/netio.c:
	  Bug#3115 - Cross-site request forgery.

2008-09-19 08:39  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#3114 - Bad handling of uid/gid parameters for CreateHome.

2008-09-17 14:45  castaglia

	* contrib/mod_sql.c:
	  Quell a few more compiler warnings about signedness.

2008-09-17 11:36  castaglia

	* include/version.h:
	  Bump to RC3 in CVS.

2008-09-17 09:48  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2008-09-17 09:47  castaglia

	* NEWS:
	  Update release date in NEWS.

2008-09-17 09:46  castaglia

	* contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for the release of 1.3.2rc2.

2008-09-16 17:15  castaglia

	* RELEASE_NOTES:
	  Update the release notes with the highlights of the upcoming RC2
	  release.

2008-09-12 10:35  castaglia

	* modules/mod_auth.c:
	  Minor formatting nit; I prefer to have strings from clients (e.g.
	  user names) enclosed in quotes.

2008-09-12 10:08  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#3112 - Uploaded files are not removed if close() fails.

2008-09-10 23:12  castaglia

	* contrib/mod_tls.c:
	  Stir in some additional entropy, using the secret passphrases of
	  certs as sources.

2008-09-10 19:00  castaglia

	* src/mkhome.c:
	  When scanning a skel directory, there's no need to build up the
	  full paths (and using memory from the pool) if we're going to
	  skip those paths.

2008-09-10 18:20  castaglia

	* contrib/mod_ban.c:
	  Turns out that Mac OSX has the same semantics, with regard to
	  reuse of getopt(3), as FreeBSD.

2008-09-08 23:24  castaglia

	* modules/Makefile.in:
	  Cycle through a single combined list of subdirectories in which
	  to invoke the `install' target, rather than two separate lists.

2008-09-08 21:00  castaglia

	* doc/howto/DSO.html:
	  Update the example Makefile in the DSO howto, since the `install'
	  target may be called even if the module is built as a static
	  module (i.e. no .la file produced).

2008-09-08 16:49  castaglia

	* src/data.c:
	  With the fix for Bug#2920 comes the possibility that clients can
	  send NOOP commands on the control connection, while a data
	  transfer is occurring.  This would cause the data transfer
	  initiating command recorded in the scoreboard to be overwritten
	  with the NOOP command.  While technically correct, this is
	  probably not what the admins want.  So make proftpd handle such
	  commands politely, responding 200 to them, without actually
	  dispatching the command through the handlers.

2008-09-08 13:56  castaglia

	* Makefile.in, contrib/mod_load/Makefile.in,
	  contrib/mod_wrap2/Makefile.in, modules/Makefile.in:
	  Make sure that the `install' target is called for static modules
	  that are built in their own directories, just as is done for
	  shared modules.

2008-09-08 13:54  castaglia

	* contrib/mod_tls.c:
	  Avoid cleaning up OpenSSL state if mod_sftp is present as well.

2008-09-08 12:51  jwm

	* contrib/mod_ldap.c: mod_ldap bzr r55:   high time for a 2.8.19
	  release

2008-09-08 12:40  jwm

	* contrib/mod_ldap.c: mod_ldap bzr r54:   log message wording fix

2008-09-08 12:26  jwm

	* contrib/mod_ldap.c: mod_ldap bzr r53: * Fixed missing ldap_init()
	  -> ldap_initialize() when updating for latest   LDAP C API. Fixes
	  segfaults on (some?) 64-bit systems. (Bug #3046)

2008-09-07 23:52  castaglia

	* include/pool.h, src/pool.c:
	  Add a clear_array() function, for clearing/resetting an
	  array_header.

2008-09-07 17:47  castaglia

	* src/main.c:
	  Try to give different sessions more different random seeds by
	  multiplying the system time (was being used) with the PID.  Bonus
	  points for having the unsigned int value wrap around.

2008-09-07 16:58  castaglia

	* contrib/mod_tls.c:
	  Refresh the builtin 2048-bit DH group.

2008-09-07 16:42  castaglia

	* contrib/mod_tls.c:
	  Refresh the builtin DH groups in mod_tls.  Note that the 2048-bit
	  DH group still needs to be updated.

2008-09-07 16:40  castaglia

	* src/main.c:
	  Quell some compiler complaints about formatting.

2008-09-04 09:42  castaglia

	* src/encode.c:
	  If the selected locale does not support the Telnet IAC character,
	  be sure that the toggled setting is not overwritten.

2008-09-04 09:27  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#3109 - Errors with file uploads logged but not reported to
	  clients.

2008-09-03 18:49  castaglia

	* src/parser.c:
	  Get rid of small function that is only used in one place; simply
	  move the code into the calling function.

2008-09-03 17:30  castaglia

	* src/: inet.c, log.c, main.c, scoreboard.c, trace.c:
	  Change a few more places to using the cached session.pid, if
	  available.

2008-09-03 11:19  castaglia

	* include/fsio.h, src/fsio.c:
	  Remove the pr_find_fs() function; it was a bad idea.	Even if a
	  caller could retrieve a registered FS object by name, that caller
	  would not be able to do much with the FS.  The various callbacks
	  are usually declared as static to the file defining them, which
	  means that the caller probably won't have access to the memory
	  addresses of the callbacks.

2008-09-03 09:49  castaglia

	* include/fsio.h, src/fsio.c:
	  Add a pr_find_fs() function, for retrieving a registered FS
	  object by name.

2008-09-02 09:00  castaglia

	* configure:
	  Updated configure.

2008-09-02 08:54  castaglia

	* config.h.in, configure.in, modules/mod_ls.c:
	  If the dirfd() function is available, use that instead of poking
	  around the internals of a DIR structure.

2008-09-01 14:10  castaglia

	* include/proftpd.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_xfer.c, src/data.c, src/main.c, src/throttle.c:
	  Make fewer getpid() system calls by caching the values (it's not
	  going to change), and using the cached value for the
	  pr_scoreboard_entry_update() calls.

2008-09-01 12:26  castaglia

	* doc/howto/DSO.html:
	  Updated DSO howto with mention of prxs.

2008-09-01 12:05  castaglia

	* NEWS, doc/modules/mod_facts.html, modules/mod_facts.c:
	  Bug#3108 - Support removing MLST from FEAT list.

2008-08-29 17:11  castaglia

	* contrib/mod_tls.c:
	  Prettify some of the error messages emitted if the configuration
	  is not correct.

2008-08-29 17:06  castaglia

	* contrib/mod_tls.c:
	  Fix typos in fix for Bug#3107.

2008-08-29 17:04  castaglia

	* NEWS, contrib/mod_tls.c, doc/contrib/mod_tls.html:
	  Bug#3107 - TLSProtocol supports misleading "SSLv23" parameter.

2008-08-29 10:44  castaglia

	* Makefile.in:
	  When installing prxs, do not ever attempt to strip it.  It is a
	  Perl script, not a compiled binary, and strip(1) will complain
	  about the file type.

2008-08-27 17:47  castaglia

	* configure:
	  Updated configure.

2008-08-27 17:06  castaglia

	* include/data.h:
	  Update copyright dates in just-modified header.

2008-08-27 17:05  castaglia

	* NEWS, config.h.in, configure.in, include/data.h, src/data.c:
	  Bug#3106 - Add support for Mac OSX 10.5 sendfile.

2008-08-27 14:31  castaglia

	* locale/Makefile.in:
	  Do not remove the .po files when cleaning the locale/ directory.

2008-08-27 10:09  jwm

	* contrib/mod_ldap.c:	having to hand-edit mod_ldap.c to enable
	  tls support is silly; switch
	    based on LDAP_OPT_X_TLS, which is the best thing i've found
	  given that i
	    can't find an ldap sdk that support tls other than openldap
	  (sun's
	    doesn't; are there any other major players around?)

2008-08-27 10:09  jwm

	* contrib/mod_ldap.c:	fix LDAPServer url handling by re-parsing
	  the ldap url in each session
	    rather than trying to keep track of the LDAPURLDesc struct

	    proftpd bug 3097

2008-08-27 10:08  jwm

	* contrib/mod_ldap.c: use the configured ldap_port in
	  "connected..." debug message, not LDAP_PORT

2008-08-27 10:08  jwm

	* contrib/mod_ldap.c:	* Define LDAP_SCOPE_DEFAULT if not defined
	  by the SDK, fixing compilation
	      with (recent?) Sun LDAP headers.

2008-08-27 10:08  jwm

	* contrib/mod_ldap.c:	* Fix compilation with old LDAP SDKs
	  (LDAP_API_VERSION < 2000). Thanks to
	      Saju Paul <saju.paul@messageway.com>.

2008-08-25 19:47  castaglia

	* src/prxs.in:
	  Add license to prxs.	Support use of LIBTOOL environment variable
	  to direct prxs to use a different libtool, if necessary.

2008-08-25 15:32  castaglia

	* src/inet.c:
	  Extend the hack used for active ports to Mac OS 10.5 as well.

2008-08-25 15:22  castaglia

	* configure:
	  Updated configure.

2008-08-25 15:19  castaglia

	* Makefile.in, NEWS, configure.in, src/.cvsignore, src/prxs.in:
	  Bug#2991 - Need a `prxs' (ProFTPD Extensions) command-line tool
	  for building shared modules without proftpd source.

2008-08-25 15:16  castaglia

	* lib/pr-syslog.c:
	  Extend the fix for Bug#3104 to Mac OS 10.5 (i.e. DARWIN9) as
	  well.

2008-08-24 12:57  castaglia

	* lib/Makefile.in:
	  Turns out that the libsupp library does NOT need to be installed,
	  as part of a proftpd installation, in order to support DSO
	  modules built outside of proftpd's source tree.  All of the
	  symbols of the libsupp library are statically linked into the
	  proftpd binary, thus a dynamically loaded module which uses those
	  symbols should have the symbols resolved successfuly at load
	  time, without need to explicitly link against libsupp.  The
	  installation of libsupp was added as part of Bug #2991.

2008-08-23 17:30  castaglia

	* NEWS, lib/pr-syslog.c:
	  Bug#3104 - Syslog logging does not work on Mac OS X.

2008-08-23 17:23  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2564 - Improper logging of "max connections per host".

2008-08-23 13:05  castaglia

	* NEWS, contrib/mod_sql.c, doc/contrib/mod_sql.html:
	  Bug#2537 - mod_sql does not support %{...}t variable.

2008-08-22 19:57  castaglia

	* NEWS, doc/howto/DisplayFiles.html, src/display.c:
	  Bug#3055 - Support Display variable for specifying the timestamp
	  format.  See doc/howto/DisplayFiles.html for more details.

2008-08-22 19:49  castaglia

	* lib/libcap/libcap.h:
	  Fix typo (missing backslash).

2008-08-22 18:18  castaglia

	* src/display.c:
	  A temporary pool was being allocated from session.pool for each
	  Display file, and was not being cleaned up.  Tsk.

2008-08-22 09:35  castaglia

	* lib/libcap/libcap.h:
	  Try to handle the change in Linux capability version macro names
	  for older kernels (which don't define/use the new names).

2008-08-21 00:03  castaglia

	* NEWS, src/log.c:
	  Bug#3098 - Socket descriptor leak when using syslog logging,
	  especially at SyslogLevel 'notice' or higher.

2008-08-20 11:23  castaglia

	* contrib/mod_site_misc.c:
	  Add signal handling to a while() loop.

2008-08-20 11:02  castaglia

	* contrib/mod_load/Makefile.in:
	  Make the mod_load Makefile consistent with other contrib module
	  Makefiles.

2008-08-20 11:00  castaglia

	* NEWS, contrib/mod_load/Makefile.in,
	  contrib/mod_wrap2/Makefile.in:
	  Bug#3101 - mod_wrap2 does not compile on FreeBSD with custom
	  includes.  The fix was also needed in the mod_load Makefile.

2008-08-18 15:05  castaglia

	* NEWS, modules/mod_core.c, modules/mod_xfer.c:
	  Bug#3030 - GroupOwner should work for all groups.

2008-08-18 13:55  castaglia

	* contrib/ftpmail:
	  Forgot to add descriptions of the --ignore-users/--watch-users
	  command-line options to the --help output, as part of the fix for
	  Bug#3100.

2008-08-18 13:50  castaglia

	* NEWS, contrib/ftpmail, doc/contrib/ftpmail.html:
	  Bug#3100 - Support ftpmail options for sending emails only for
	  specific users.

2008-08-18 11:52  castaglia

	* doc/howto/Tracing.html:
	  Mention the new "fileperms" trace log channel in the Trace
	  logging howto.

2008-08-18 11:48  castaglia

	* NEWS, modules/mod_core.c, modules/mod_xfer.c:
	  Bug#3099 - Add trace logging of filesystem permission errors.

2008-08-18 11:46  castaglia

	* contrib/mod_wrap2/.cvsignore:
	  Ignore autoconf-generated cache file.

2008-08-15 22:26  castaglia

	* src/fsio.c:
	  If we are out of memory, then we should exit as soon as possible,
	  and skip any sending of events on the topic.

2008-08-15 20:56  castaglia

	* modules/mod_xfer.c:
	  If we decline to use sendfile() for any reason, log this only
	  once per RETR command.  Otherwise, the debug logs get spammed.

2008-08-15 16:41  castaglia

	* src/throttle.c:
	  Include signal.h, for the signal-masking function declarations.

2008-08-15 15:16  castaglia

	* doc/contrib/: index.html, mod_ldap.html:
	  Start a doc covering the mod_ldap directives.

2008-08-15 13:15  castaglia

	* configure:
	  Updated configure.

2008-08-15 13:13  castaglia

	* configure.in:
	  Be sure to include all of the libraries that the proftpd
	  executable is linked against in the `proftpd -V' output.

2008-08-15 11:18  castaglia

	* contrib/mod_sql_sqlite.c:
	  Log if there was an error closing the SQLite database as well.

2008-08-15 11:12  castaglia

	* contrib/mod_sql_sqlite.c:
	  Log the error, if there is one, when opening the SQLite database
	  file.

2008-08-15 09:14  castaglia

	* contrib/mod_sql_sqlite.c:
	  Be sure to log the error string returned from SQLite when a query
	  fails.  Otherwise, debugging issues is a lot harder.

2008-08-14 14:23  castaglia

	* contrib/mod_tls.c:
	  Turns out that prompting for passphrases for protected SSL key
	  files MUST happen during the 'core.postparse' event, and NOT
	  during the 'core.startup' event.  The passphrase prompting
	  requires use of the TTY, and by the time the 'core.startup' event
	  occurs, the process may have daemonized itself away from the TTY.

2008-08-12 17:51  castaglia

	* contrib/mod_tls.c:
	  The change of timing of initializing the OpenSSL library, in
	  order to better handle FIPS mode, broke the TLSPassphraseProvider
	  functionality.  The problem is that using the OpenSSL library for
	  loading certs/keys using passphrases, before the OpenSSL library
	  has been initialized, does not work so well.	With this change,
	  the loading of passphrase-protected certs/keys now happens in the
	  'core.startup' event handler, after OpenSSL has been initialized;
	  this means there is no more need for a 'core.postparse' event
	  handler.

2008-08-12 13:56  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3095 - TLSPassphraseProvider port number truncated.  Fixed by
	  using 'sizeof(nbuf)', not 'sizeof(buf)', in the snprintf() call.

2008-08-12 11:54  castaglia

	* Makefile.in:
	  If using the pkgconfig info to compile and link modules, it is
	  not necessary to link against the libsupp library.  This library
	  is statically linked into the proftpd executable, which means
	  that DSO modules that use any libsupp symbols will have those
	  symbols successfully resolved at module load time.

2008-08-11 13:52  castaglia

	* src/pool.c:
	  Change the "Attempt to free already freed" message, when clearing
	  a pool, so that it logs the name of the pool being cleared; this
	  will aid in debugging such occurrences.

2008-08-11 11:39  castaglia

	* configure:
	  Updated configure.

2008-08-11 11:33  castaglia

	* Make.rules.in, Makefile.in, NEWS, configure.in:
	  Bug#3074 - Support configure option for pkgconfig .pc file
	  install location.

2008-08-10 12:02  castaglia

	* contrib/mod_sql_sqlite.c:
	  Use root privs when opening the file configured for SQLite use.

2008-08-10 11:37  castaglia

	* configure:
	  Updated configure.

2008-08-10 11:29  castaglia

	* configure.in:
	  The use of the -Wno-long-double compiler flag is only needed on
	  Mac machines; and using that flag on non-Mac, newer gcc versions
	  causes problems.  The configure script thus will only check to
	  see if that flag should be used if the compiling platform is a
	  Mac.

2008-08-06 11:00  castaglia

	* contrib/mod_tls.c:
	  Quell a compiler warning about signedness with an explicit cast.

2008-08-06 10:00  castaglia

	* NEWS, lib/libcap/cap_alloc.c, lib/libcap/cap_proc.c,
	  lib/libcap/libcap.h:
	  Bug#3096 - libcap version errors on newer Linux kernel.  Newer
	  Linux kernels have a _LINUX_CAPABILITY_VERSION_2 macro, and
	  redefine the old _LINUX_CAPABILITY_VERSION macro.  To play better
	  with such kernels, redefine the bundled libcap to use
	  _LINUX_CAPABILITY_VERSION_1.

2008-08-06 09:57  castaglia

	* configure:
	  Updated configure.

2008-08-06 09:55  castaglia

	* config.h.in, configure.in:
	  Fix issue where configure script was detecting the presence of a
	  linux/capability.h header, but was not defining the
	  HAVE_LINUX_CAPABILITY_H macro in the config.h file.  (It's a
	  matter of using AC_CHECK_HEADERS vs AC_CHECK_HEADER; easy to
	  miss, and insidious.)

2008-07-30 09:37  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3094 - Perform unidirectional SSL/TLS shutdown on data
	  connections.

2008-07-17 14:01  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#3036 - Quota information not persisted if session ends
	  abruptly.

2008-07-17 13:51  castaglia

	* contrib/mod_quotatab.h:
	  Remove stale and misleading comment; confstreams were an
	  interesting idea, but will not be added.

2008-07-16 14:38  castaglia

	* doc/modules/mod_cap.html:
	  Add a FAQ about the libcap1 warning (regarding 32-bit
	  capabilities), and how to address the warning.

2008-06-18 20:22  castaglia

	* modules/mod_auth.c:
	  Replace the specific "FTP login timed out" with the more generic
	  "Session timed out".

2008-06-18 10:29  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#3077 - Transparently handle the X-variant commands when
	  checking <Limit> permissions.

2008-06-16 18:01  castaglia

	* include/compat.h:
	  Minor formatting change, no functional change.

2008-06-16 14:56  castaglia

	* src/main.c:
	  If PR_DEVEL_COREDUMP support is enabled, then call abort() in the
	  SIGABRT handler, rather than in the synchronously-handled
	  handle_abort().  It works much better this way.

2008-06-16 09:43  castaglia

	* src/main.c:
	  Always remove the scoreboard entry when handling a termination
	  signal, not just when we receive SIGSEGV.

2008-06-16 09:25  castaglia

	* include/compat.h:
	  Add comments noting when compat macros were added; these will be
	  used for determining when the compat macros should be dropped.

2008-06-16 09:21  castaglia

	* contrib/mod_ban.c:
	  Update to use newer PR_LOG_ macros.

2008-06-13 19:40  castaglia

	* contrib/mod_ctrls_admin.c, include/dirtree.h, include/str.h,
	  src/dirtree.c, src/str.c, tests/str.c:
	  Refactor the pr_is_boolean() function into pr_str_is_boolean(),
	  and place it in str.c with the other pr_str_*() functions.  Add
	  an accompanying unit test.

2008-06-13 18:26  castaglia

	* tests/str.c:
	  Add unit test for the pr_str_get_word() function.

2008-06-13 18:13  castaglia

	* include/dirtree.h, include/str.h, src/dirtree.c, src/str.c:
	  Refactor the pr_str_get_word() function from dirtree.c to str.c,
	  along with the other pr_str_*() functions.

2008-06-13 17:28  castaglia

	* tests/: modules.c, tests.h:
	  Fill in unit tests for the Module API functions.

2008-06-13 17:27  castaglia

	* src/modules.c:
	  Clean up a few more style nits, and guard against bad arguments,
	  in the Module API.

2008-06-13 16:23  castaglia

	* tests/modules.c:
	  Add unit tests for the Stash API.

2008-06-13 16:22  castaglia

	* src/modules.c:
	  Fix a few minor bugs and nits in the Stash API, discovered while
	  writing unit tests for those functions.

2008-06-13 11:36  castaglia

	* tests/: .cvsignore, Makefile.in:
	  Fix the dependency on the core proftpd object files in the
	  Makefile.  Change the name of the testsuite executable to
	  'tests', as it is more accurate.

2008-06-13 11:34  castaglia

	* tests/tests.c:
	  Add support for running check in nonforking mode, using the
	  PR_TEST_NOFORK environment variable.	This makes tracking down of
	  segfaults tickled by unit tests easier (I can use gdb now when
	  they happen).

2008-06-12 18:30  castaglia

	* tests/: Makefile.in, modules.c, stubs.c, tests.c, tests.h:
	  Add stubs for units tests for the APIs (stash, module) in the
	  modules.c source file.

2008-06-12 15:57  castaglia

	* contrib/mod_quotatab_ldap.c, contrib/mod_quotatab_radius.c,
	  contrib/mod_quotatab_sql.c, contrib/mod_ratio.c,
	  contrib/mod_wrap2_sql.c, include/compat.h, include/modules.h,
	  modules/mod_core.c, modules/mod_site.c, src/auth.c, src/main.c,
	  src/modules.c, src/parser.c:
	  Since the call_module() function is used by contrib modules, it
	  should be placed in the public API namespace.  Thus call_module()
	  is now pr_module_call().  A macro redefining old code to use the
	  new function has been added to compat.h.

2008-06-12 14:29  castaglia

	* tests/scoreboard.c:
	  Fill in the remaining unit tests for the Scoreboard API.

2008-06-12 14:19  castaglia

	* src/scoreboard.c:
	  Prevent errors in the scoreboard by preventing multiple entries
	  from being added via pr_scoreboard_entry_add(); only one entry at
	  a time.  At the same time, make sure that
	  pr_scoreboard_entry_del() only removes the active entry (if
	  present).

2008-06-12 10:05  castaglia

	* contrib/mod_load/: .cvsignore, mod_load.c.in:
	  Fix function definition.  Add more entries of autogenerated
	  files, to be ignored by CVS.

2008-06-10 20:48  castaglia

	* tests/.cvsignore:
	  More files to be ignored by CVS in the tests/ directory.

2008-06-10 20:48  castaglia

	* tests/scoreboard.c:
	  Fill in more of the unit tests for the Scoreboard API.

2008-06-10 20:47  castaglia

	* src/scoreboard.c:
	  Fix some minor bugs found in the Scoreboard API while working on
	  unit tests.

2008-06-10 09:29  castaglia

	* NEWS, doc/howto/Classes.html:
	  Update the Classes howto to mention that "Satisfy all" is needed
	  for Class definitions with multiple "not" rules.  Add Bug#3083 to
	  NEWS.

2008-06-05 17:47  castaglia

	* src/scoreboard.c:
	  Add better argument checking in pr_set_scoreboard().

2008-06-05 17:46  castaglia

	* tests/: Makefile.in, scoreboard.c, stubs.c, tests.c, tests.h:
	  Start writing unit tests for the Scoreboard API.

2008-06-05 17:43  castaglia

	* tests/sets.c:
	  Avoid a compiler warning about a shadowed variable in the
	  testsuite.

2008-06-05 14:34  castaglia

	* include/expr.h, src/expr.c, tests/expr.c:
	  Fill in the Expression API unit tests, and fix the minor bugs in
	  the API that were uncovered during the writing of the tests.

2008-06-05 09:48  castaglia

	* tests/stubs.c:
	  Forgot to include these variables for unit tests.

2008-06-05 01:02  castaglia

	* tests/str.c:
	  Add unit tests for the newly added functions to the String API.

2008-06-05 01:01  castaglia

	* Make.rules.in, contrib/mod_ifsession.c, include/conf.h,
	  include/dirtree.h, include/expr.h, include/str.h,
	  include/support.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_ident.c, modules/mod_xfer.c, src/auth.c,
	  src/dirtree.c, src/expr.c, src/str.c, src/support.c:
	  Refactoring work.  First, move the pr_expr_* functions into their
	  own expr.c file.  Second, move some of the string-related
	  functions from support.c into the str.c file.

2008-06-05 00:48  castaglia

	* src/throttle.c:
	  Make sure to explicit require a TRUE return value from the
	  pr_expr_* calls.

2008-06-05 00:42  castaglia

	* tests/: Makefile.in, expr.c, regexp.c, tests.c, tests.h:
	  Add unit tests for the Regexp API, and unit test stubs for the
	  Expression API.

2008-06-04 21:13  castaglia

	* src/: class.c, netacl.c:
	  Bug#3083 - Multiple issues with handling of <Class> definitions.

2008-06-04 21:11  castaglia

	* tests/: Makefile.in, class.c, netacl.c, tests.c, tests.h:
	  Added unit tests for the NetACL and Class APIs.

2008-06-04 21:02  castaglia

	* doc/howto/Classes.html:
	  Add more material to the Classes howto, covering the Satisfy
	  directive and giving some examples.

2008-06-04 20:00  castaglia

	* tests/Makefile.in:
	  Have different targets for creating the testsuite executable,
	  versus running the testsuite executable.  It was getting tedious,
	  having the testsuite executable re-linked every time I wanted to
	  run a particular suite of tests.

2008-06-04 18:57  castaglia

	* src/netacl.c:
	  When destroying the temporary pool in pr_netacl_match(), make
	  sure we do it only when we're about to return from the function
	  (and not before then).

2008-06-04 15:43  castaglia

	* src/netacl.c:
	  Correct several nits in the NetACL API: free up the temporary
	  pool that's allocated in pr_netacl_match(), make sure that
	  pr_netacl_get_str() returns the same string for ALL/NONE ACLs,
	  regardess of the casing of the ALL/NONE strings, clean up some of
	  the string representations, etc.

2008-06-02 15:29  castaglia

	* NEWS, doc/howto/Tracing.html, src/trace.c:
	  Bug#3082 - Use "DEFAULT" keyword instead of "ALL" for Trace
	  directive.

2008-05-20 07:35  castaglia

	* contrib/mod_tls.c:
	  Update mod_tls to properly enable FIPS mode (see Bug #3050) for
	  both inetd and standalone modes.  The timing of when to call
	  FIPS_mode_set() is a little tricky.

2008-05-17 13:05  castaglia

	* src/throttle.c:
	  Make sure that the signal-handling functions (e.g. sigemptyset())
	  can be properly found on some platforms (e.g. Solaris).

2008-05-14 19:51  castaglia

	* modules/mod_core.c:
	  Make sure that we honor the TimeoutIdle directive *before*
	  authentication, as well as after.

2008-05-13 22:51  castaglia

	* include/auth.h, modules/mod_auth.c, src/auth.c:
	  Move the functions which check /etc/ftpusers and /etc/shells out
	  of the mod_auth module, and into the Auth API layer.	This makes
	  it possible for other modules to use these checks when deciding
	  to let users in.

2008-05-12 22:41  castaglia

	* include/table.h, src/main.c, src/table.c:
	  Fix bug where proftpd could enter a recursive loop and eventually
	  run out of stack memory.  Turns out that if errno is EINTR when
	  pr_signals_handle() was called, then pr_signals_handle() would
	  call pr_trace_msg(), which would lead to a call to
	  pr_signals_handle(), which would call pr_trace_msg(), etc etc.

	  To deal with this, the Table API now has an internal-use-only
	  functionn, used by pr_signals_handle(), to indicate whether a
	  signal is currently being handled or not.  If a signal is being
	  handled, then the Table API code will not call
	  pr_signals_handle().

2008-05-12 10:22  castaglia

	* modules/mod_dso.c:
	  Work around compiler warnings about "nested extern declaration of
	  lt_preloaded_symbols".  This was caused by the use of the
	  LTDL_SET_PRELOADED_SYBMOLS libtool macro.  Instead, use the code
	  to which the macro expands, and separate the code so that the
	  declaration of the lt_preloaded_symbols is in the proper scope.

2008-05-12 10:16  castaglia

	* configure:
	  Updated configure.

2008-05-12 10:11  castaglia

	* configure.in, modules/mod_dso.c:
	  Make sure we use the libltdl shipped with proftpd, not the system
	  libltdl.

2008-05-11 18:23  castaglia

	* modules/mod_xfer.c:
	  Found more while loops without signal handling.  Tsk tsk.

2008-05-11 13:40  castaglia

	* modules/mod_auth.c, modules/mod_core.c, modules/mod_xfer.c,
	  src/main.c:
	  Move the setting of the TimeoutIdle timer from src/main.c into
	  mod_core.  The issue was that any vhost-specific TimeoutIdle
	  timer was not being honored properly.  Another cause of this
	  issue was that the handling of the PASS POST_CMD dispatch was
	  faulty; the mod_auth and mod_xfer modules were both returning
	  HANDLED for those POST_CMD handlers, which prevented other
	  modules from receiving the dispatch.	Oops.

2008-05-10 19:36  castaglia

	* src/main.c:
	  Make a lowercased version of the protocol name, in
	  set_protocol_name(), for use in the WtmpLog entry.

2008-05-08 08:28  castaglia

	* modules/mod_core.c:
	  As it turns out, the <Limit> section can handles commands for
	  more than just FTP.

2008-05-08 08:06  castaglia

	* contrib/mod_load/mod_load.c.in:
	  Mark a string used by mod_load as localisable.

2008-05-07 23:49  castaglia

	* include/support.h, src/main.c:
	  Make it possible to change the protocol name used in some logging
	  messages via a set_protocol_name() function.

2008-05-07 23:16  castaglia

	* src/main.c:
	  Stylistic nits, no functional change.

2008-05-07 22:29  castaglia

	* src/main.c:
	  Always have signal handling in while loops.

2008-05-07 08:14  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec:
	  Bug#3076 - RPM build failing on 64 bit OS due to incomplete
	  .spec.

2008-05-06 10:42  castaglia

	* include/response.h, src/response.c:
	  Add new pr_response_block() API, for blocking the normal response
	  chains from being sent to the client.  For use by modules which
	  want to send their own data, as is, to clients.

2008-05-06 10:01  castaglia

	* doc/howto/Authentication.html:
	  Typo.

2008-05-06 09:33  castaglia

	* configure:
	  Updated configure.

2008-05-06 09:30  castaglia

	* configure.in, config.h.in, contrib/mod_site_misc.c,
	  include/fsio.h, modules/mod_facts.c, src/fsio.c:
	  Add two new FSIO API functions: pr_fsio_utimes() and
	  pr_fsio_futimes().  These functions use the utimes(2) system
	  call, which supercedes the old utime(2) system call.	Plus, this
	  allows FSIO modules to provide their own implementations of these
	  calls.

	  Update the mod_facts and mod_site_misc modules, which used
	  utime(2) directly, to call these new FSIO APIs.

2008-05-06 00:23  castaglia

	* include/fsio.h, src/fsio.c:
	  Add pr_fsio_fchmod() and pr_fsio_fchown() functions, for acting
	  on already opened pr_fh_t objects rather than always requiring
	  paths.

2008-05-05 22:19  castaglia

	* include/response.h, src/response.c:
	  Add a new pr_response_clear() function, for clearing a response
	  chain without having to flush that chain out to the client first.

2008-05-05 22:17  castaglia

	* src/main.c:
	  If sending responses in pr_cmd_dispatch_phase(), be sure to flush
	  the correct response chain.

2008-05-05 22:13  castaglia

	* Make.rules.in, include/conf.h, include/throttle.h,
	  modules/mod_xfer.c, src/throttle.c:
	  More refactoring.  This time, move the TransferRate handling out
	  of mod_xfer and into a Throttle API.	Again, this is to expose
	  this same functionality to other modules that may want throttling
	  capabilities.

2008-05-05 21:31  castaglia

	* include/modules.h, src/main.c:
	  Add a new function, pr_cmd_dispatch_phase().	This is very
	  similar to pr_cmd_dispatch(), except that it allows callers to
	  dispatch a cmd_rec to a specific phase of command handlers (e.g.
	  LOG_CMD).  It also supports a flag for indicating whether the
	  caller wishes the response chains to be flushed to the client.

	  This API allows modules to dispatch commands to specific handlers
	  as needed.  Wondering about the utility?  Well, I have need for
	  such a thing in my soon-to-be-released mod_sftp module for
	  proftpd.

2008-05-05 21:11  castaglia

	* include/auth.h, modules/mod_auth.c, src/auth.c:
	  Refactor the lockdown() function from mod_auth into the
	  pr_auth_chroot() function, in the Auth API.  This makes it
	  possible to reuse the same code from other modules.

2008-04-28 08:14  castaglia

	* NEWS, modules/mod_auth.c, modules/mod_log.c, src/dirtree.c,
	  src/support.c:
	  Bug#3073 - Command arguments not decoded properly in some places.

2008-04-25 17:20  castaglia

	* src/data.c:
	  Apply the fix for Bug#3001 to a similar area of the code, this
	  time in a non-Linux code path.

2008-04-25 09:41  castaglia

	* NEWS, locale/Makefile.in, locale/zh_CN.po:
	  Adding Chinese translation.

2008-04-17 18:18  castaglia

	* configure:
	  Updated configure.

2008-04-17 18:14  castaglia

	* configure.in:
	  If the PR_USE_OPENSSL macro is defined, then the proftpd build
	  would fail when linking the `proftpd' executable, due to an
	  unresolved 'OPENSSL_cleanse' symbol.	There was a spot in the
	  configure script which was not properly adding the OpenSSL libs
	  to the library list.

2008-04-16 19:13  castaglia

	* NEWS:
	  Had wrong bug number for IPv6-by-default change.

2008-04-16 19:11  castaglia

	* configure:
	  Updating configure.

2008-04-16 19:06  castaglia

	* configure.in:
	  Really fix Bug#2755 by making sure that IPv6 support is enabled
	  by default.  Previously, it was only enabled *if* the
	  --disable-ipv6 configure option was used -- not so helpful as a
	  default.

2008-04-16 09:27  castaglia

	* NEWS:
	  Forgot to mention the release date for 1.3.2rc1 in the NEWS file.

2008-04-16 09:26  castaglia

	* include/version.h:
	  Update version for CVS.

2008-04-15 19:06  castaglia

	* Makefile.in:
	  Clean up the locale/Makefile when handling the 'distclean'
	  target.

2008-04-15 17:30  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2008-04-15 17:29  castaglia

	* contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing to release 1.3.2rc1.

2008-04-15 17:26  castaglia

	* doc/howto/Tracing.html, src/main.c, src/trace.c:
	  Remove the unused "l10n" trace channel, and add a "signal" trace
	  channel.  Update the Tracing howto with these channel changes.
	  Use the "signal" channel, rather than debug logging, when logging
	  about EINTR delaying.

2008-04-15 15:38  castaglia

	* contrib/ftpmail:
	  Fix issue with handling of binary files as attachments.  Such
	  attachments need to be base64-encoded, to protect them from CRLF
	  translation/handling by Mail::Sendmail.

2008-04-15 13:51  castaglia

	* RELEASE_NOTES:
	  Updating release notes.

2008-04-11 18:07  castaglia

	* modules/mod_lang.c:
	  When scanning the LangPath for suitable languages, make sure that
	  the languages are acceptable to setlocale(3), in addition to
	  having a proftpd.mo file.

2008-04-10 08:04  castaglia

	* doc/howto/Limit.html:
	  Mention that within <Limit> sections, limits are applied only
	  based on names, not on IDs.

2008-04-09 10:03  castaglia

	* include/options.h:
	  Make the default PR_TUNABLE_EINTR_RETRY_INTERVAL value be 0.2
	  secs, rather than 0, in order to prevent tightly-spinning EINTR
	  retry loops.

2008-04-08 16:34  castaglia

	* locale/it_IT.po:
	  Updated Italian translation.

2008-04-05 14:05  castaglia

	* locale/proftpd.pot:
	  Fill in some descriptive details in the .pot file header.

2008-04-05 13:47  castaglia

	* configure:
	  Updated configure.

2008-04-05 13:44  castaglia

	* configure.in:
	  Yet another attempt to fix the writing of the PR_LOCALE_DIR
	  string into config.h by the configure script (Bug #3066).

2008-04-05 12:46  castaglia

	* modules/mod_core.c:
	  Don't set the UTF8 feature in mod_core; it's already handled by
	  mod_lang.  Addresses Bug#3070.

2008-04-04 20:22  castaglia

	* modules/mod_lang.c:
	  Missed one spot where the language needed to specified as "en_US"
	  (to satiate setlocale(3)) instead of just "en".  While I was at
	  it, I made the fallback "en_US" string be a macro.

2008-04-04 20:11  castaglia

	* locale/Makefile.in:
	  Add a `make check' target for the locale/ directory, to run
	  msgcmp on our .po files to see how out-of-date they might become.

2008-04-04 18:56  castaglia

	* locale/Makefile.in:
	  Make sure that all .po files pass the msgfmt format check.

2008-04-04 18:39  castaglia

	* doc/modules/mod_lang.html, modules/mod_lang.c:
	  Mention the requirement that the LangDefault language be listed
	  in `locale -a' in the docs.  Change the default language from
	  "en" to "en_US", as per the `locale -a' requirement.

2008-04-04 18:29  castaglia

	* locale/: en.po, it.po:
	  Remove the vestiges of the renamed .po files.

2008-04-04 18:26  castaglia

	* locale/: Makefile.in, en_US.po, it_IT.po:
	  Turns out that setlocale(3) prefers the language tag to include
	  the country code as well, hence "en_US" instead of just "en",
	  "it_IT" instead of just "it", etc.  Picky, picky.

2008-04-04 18:03  castaglia

	* locale/proftpd.pot:
	  Updated proftpd.pot to reflect changed line numbers.

2008-04-04 18:01  castaglia

	* modules/mod_lang.c:
	  Add proper provisioning of the LANG FEAT, and handling of the
	  LANG command.  Also addresses Bug#3067 with some explicit calls
	  to bind_textdomain_codeset().

2008-04-04 17:49  castaglia

	* locale/it.po:
	  Fix msgfmt format check warning in it.po.

2008-04-04 14:14  castaglia

	* locale/proftpd.pot:
	  Update proftpd.pot with the strings to be translated from
	  mod_quotatab.

2008-04-04 14:13  castaglia

	* contrib/mod_quotatab.c:
	  Tag a few more strings that need to be translated, when
	  displaying quota limit/tallies to clients.

2008-04-04 11:37  castaglia

	* locale/: Makefile.in, en.po, it.po:
	  Add it.po (courtesy of Frankie) and en.po for default
	  translations.

2008-04-04 10:52  castaglia

	* locale/: Makefile.in, files.txt, proftpd.pot:
	  Update the list of files to include contrib modules, and updated
	  the .pot file accordingly.

2008-04-04 10:47  castaglia

	* contrib/: mod_quotatab.c, mod_radius.c, mod_readme.c,
	  mod_site_misc.c, mod_tls.c, mod_wrap2/mod_wrap2.c:
	  Add tags for the response strings which need to be
	  localised/translated in the contrib modules.

2008-04-04 10:44  castaglia

	* contrib/mod_wrap2/.cvsignore:
	  More files to be ignored by CVS.

2008-04-04 10:21  castaglia

	* modules/mod_lang.c:
	  Delay the call to setlocale() until the postparse event, after we
	  have called bindtextdomain().

2008-04-04 10:16  castaglia

	* include/conf.h:
	  Use dgettext() instead of gettext() when retrieving localised
	  strings, so that we can explicitly specify the domain ("proftpd")
	  to use.

2008-04-03 18:13  castaglia

	* locale/Makefile.in:
	  When installing locale .mo files, actually do the installation
	  into the proper directory structure.

2008-04-03 18:12  castaglia

	* modules/mod_lang.c:
	  When requesting a locale change, it helps to actually use the
	  locale provided by the caller.  Sheesh.

2008-04-03 18:01  castaglia

	* modules/mod_lang.c:
	  Hook up handling of LangPath and LangDefault, and start trying to
	  actually use the configured locale message catalogs.

2008-04-03 15:08  castaglia

	* configure:
	  Updated configure.

2008-04-03 15:01  castaglia

	* configure.in:
	  Fix the handling of the PR_LOCALE_DIR macro, so that it properly
	  substitutes the variables.

2008-04-03 10:50  castaglia

	* locale/: Makefile.in, proftpd.pot:
	  Provide a .pot file as a starting point for translators.

2008-04-03 09:03  castaglia

	* locale/Makefile.in:
	  Older msginit versions do not support the --sort-by-file option.
	  Also, do not run msgfmt if msginit fails.

2008-04-03 08:56  castaglia

	* locale/.cvsignore:
	  Ignore a few other generated files in the locale/ directory.

2008-04-03 08:55  castaglia

	* locale/files.txt:
	  Update the list of files from which to extract strings via
	  xgettext.

2008-04-02 20:21  castaglia

	* src/encode.c:
	  Fix typo which breaks the solution for Bug#3064.

2008-04-02 20:18  castaglia

	* src/encode.c:
	  Add a few more character sets to the list of those which override
	  the value of the Telnet IAC value.

2008-04-02 20:14  castaglia

	* NEWS, include/encode.h, src/encode.c, src/netio.c:
	  Bug#3064 - Better handling of 0xFF character for Cyrillic,
	  non-UTF8 charsets.

2008-04-02 19:33  castaglia

	* modules/mod_lang.c:
	  Bug#3063 - proftpd fails to start if LC_ALL environment variable
	  is wrong.

2008-04-02 19:02  castaglia

	* NEWS:
	  Bug#3056 - Support non-UTF8 encoding and character sets.

2008-04-02 18:57  castaglia

	* doc/howto/Tracing.html:
	  The log channel name changed from "utf8" to "encode".

2008-04-02 18:54  castaglia

	* RELEASE_NOTES, doc/modules/mod_lang.html:
	  Mention the new UseEncoding directive in the release notes, and
	  add docs for UseEncoding to the mod_lang docs.

2008-04-02 18:34  castaglia

	* Make.rules.in, include/conf.h, include/encode.h, include/fsio.h,
	  include/utf8.h, modules/mod_core.c, modules/mod_lang.c,
	  src/encode.c, src/fsio.c, src/main.c, src/trace.c, src/utf8.c:
	  Bug#3056 - Support non-UTF8 encoding and character sets.

2008-03-31 18:15  castaglia

	* doc/: contrib/mod_quotatab.html, howto/Quotas.html:
	  Add more description of how mod_quotatab determines which group
	  quota to use, when there are multiple applicable group quota to
	  choose from (see Bug #3053).

2008-03-27 11:28  castaglia

	* src/scoreboard.c:
	  In addition to logging the PID of the blocking lock owner, log
	  the type of blocking lock (read/write).

2008-03-26 23:24  castaglia

	* src/scoreboard.c:
	  If we're unable to get a read or write lock on the ScoreboardFile
	  because some other process (e.g. ftptop) has a lock on it, look
	  up the PID of that blocking lock owner, and log it.

2008-03-26 23:04  castaglia

	* contrib/mod_wrap2_sql.c:
	  Replace some "magic numbers" with macros, and increase
	  legibility.

2008-03-26 19:30  castaglia

	* contrib/mod_wrap2_sql.c:
	  Make sure to allocate enough room for the SQL query names in the
	  tab_data; the fact that this was working was highly dependent on
	  the architecture and just dumb luck.

2008-03-26 19:06  castaglia

	* contrib/mod_wrap2_sql.c:
	  Clear up a temporary pool before exiting early.

2008-03-26 18:57  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  Quell compiler warning about partially-declared callback function
	  signature.

2008-03-26 18:47  castaglia

	* NEWS, contrib/mod_quotatab_sql.c:
	  Bug#3061 - Segfault in mod_quotatab_sql if the SQL query returns
	  NULL bytes/files values.

2008-03-26 18:00  castaglia

	* src/scoreboard.c:
	  Further reduce possible race conditions when reading the
	  scoreboard by NOT blocking signals while reading the scoreboard
	  header.  If signals are blocked while entering a potentially
	  endless loop, it's a very bad thing.

2008-03-26 15:33  castaglia

	* src/scoreboard.c:
	  Add trace logging of scoreboard locking.

2008-03-26 14:13  castaglia

	* src/scoreboard.c, utils/scoreboard.c:
	  Bug#3057 - ftptop can lock scoreboard, blocking proftpd.  Try not
	  to lock as aggressively in ftptop.

2008-03-25 15:20  castaglia

	* NEWS, src/utf8.c:
	  Bug#3059 - Wrong handling of UTF8 conversions.

2008-03-25 10:14  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#3058 - Handling of OPTS command results in badly set values
	  in code.

2008-03-21 14:01  castaglia

	* tests/tests.c:
	  Clarify that the tests.log file can be found in the tests/
	  directory.

2008-03-20 14:56  castaglia

	* src/netaddr.c:
	  Unit tests caught regression where a NULL buffer was not being
	  checked properly.  Yay unit testing!

2008-03-20 14:17  castaglia

	* .cvsignore:
	  Ignore the generated proftpd.pc file.

2008-03-19 14:16  castaglia

	* contrib/mod_sql.c:
	  When there is an unrecoverable SQL backend error, make sure to
	  log this in the regular proftpd debug logs, along with a note
	  prompting the admin to look in the SQLLogFile as well, as a
	  reminder.

2008-03-19 14:01  castaglia

	* configure:
	  Updated configure.

2008-03-19 13:59  castaglia

	* config.h.in, configure.in, modules/mod_auth_unix.c:
	  Add autoconf support for checking for login.h and usersec.h;
	  these headers are required for the AIX loginrestrictions()
	  support in the mod_auth_unix module.

2008-03-17 09:40  castaglia

	* contrib/mod_tls.c:
	  Protect some OCSP-specific code with checks against the OpenSSL
	  version.

2008-03-17 09:33  castaglia

	* contrib/mod_tls.c:
	  Make checking of the verification mechanism names (CRL, OCSP)
	  case-insensitive.

2008-03-17 09:32  castaglia

	* RELEASE_NOTES:
	  Be sure to mention TLSVerifyOrder in the release notes.

2008-03-17 09:15  castaglia

	* doc/contrib/mod_tls.html:
	  Add docs for the new TLSVerifyOrder directive.

2008-03-17 09:02  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2840 - Online Certificate Status Protocol (OCSP) support.

2008-03-17 08:19  castaglia

	* contrib/mod_sql_odbc.c:
	  Use the TOP clause when the driver name is "FreeTDS", or when the
	  driver name contains "SQL Server".

2008-03-15 12:12  castaglia

	* include/inet.h, modules/mod_core.c, src/main.c:
	  Add an API that allows a module to take full control of the
	  command handling, including IO.  I'm working on a module which
	  requires this ability.

2008-03-14 15:27  castaglia

	* contrib/mod_sql_odbc.c:
	  Check for the FreeTDS driver; if so, use TOP instead of LIMIT.

2008-03-13 15:44  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Use pcalloc() rather than palloc() in the database backend
	  modules.  Fix some inconsistent style while there.

2008-03-13 15:35  castaglia

	* contrib/mod_sql_odbc.c:
	  Improve the error logging in mod_sql_odbc by calling the
	  SQLGetDiagRec() function repeatedly, retrieving (and logging) all
	  of the errors in the diag stack, not just the first error.

2008-03-13 10:27  castaglia

	* doc/contrib/mod_sql_odbc.html:
	  Update instructions for configuring proftpd for using ODBC
	  libraries.

2008-03-13 09:43  castaglia

	* contrib/mod_sql_odbc.c:
	  When allocating the conn_t struct in mod_sql_odbc, be sure to use
	  pcalloc(), so that the allocated memory is zeroed.

	  Also, add an sqlodbc_strerror() function, for displaying the
	  string version of the SQLRETURN value returned by many of the
	  ODBC functions.  Makes for slightly more legible logging.

2008-03-11 15:28  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#3051 - mod_quotatab incorrectly reduces file count on rename.

2008-03-11 10:39  castaglia

	* configure:
	  Updated configure.

2008-03-11 10:35  castaglia

	* RELEASE_NOTES:
	  Mention the pkgconfig file.

2008-03-11 10:31  castaglia

	* Make.rules.in, Makefile.in, configure.in, lib/Makefile.in:
	  When installing proftpd, be sure to install the libsupp library
	  as well.

	  Also, supply a pkgconfig file (see
	  http://pkgconfig.freedesktop.org/) for proftpd.  The generated
	  proftpd.pc file is created during the `make install' step, and is
	  installed into lib/pkgconfig/proftpd.pc.

	  These changes are for Bug #2991.

2008-03-08 11:52  castaglia

	* src/support.c:
	  If we are linking with OpenSSL, and that OpenSSL is new enough,
	  use its memory-cleansing function rather than our own.

2008-03-07 21:16  castaglia

	* contrib/mod_tls.c:
	  If FIPS mode is requested, and the OpenSSL installation doesn't
	  support FIPS, log a warning.

2008-03-07 21:12  castaglia

	* Makefile.in, NEWS, RELEASE_NOTES, contrib/mod_tls.c,
	  contrib/mod_load/Makefile.in, contrib/mod_wrap2/Makefile.in,
	  doc/howto/TLS.html, modules/Makefile.in, tests/Makefile.in:
	  Bug#3050 - Support use of OpenSSL in FIPS mode.

2008-03-05 19:08  castaglia

	* NEWS, RELEASE_NOTES:
	  Add mention of ftpmail in the NEWS and in the release notes.

2008-03-05 19:06  castaglia

	* contrib/ftpmail, doc/contrib/ftpmail.html:
	  Added ftpmail, a Perl script which reads a TransferLog FIFO and
	  sends automatic email notifications for uploads.

2008-03-03 18:05  castaglia

	* doc/contrib/mod_ban.html:
	  Update docs for the BanOnEvent directive.

2008-03-03 18:01  castaglia

	* NEWS, contrib/mod_ban.c:
	  Bug#3047 - BanOnEvent should support optional ban message.

2008-03-03 09:13  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#3045 - "QuotaOptions ScanOnLogin" does not work for 'class'
	  or 'all' limits.

2008-03-03 08:26  castaglia

	* NEWS, contrib/mod_wrap2_file.c:
	  Bug#3048 - mod_wrap2_file should support comma-delimited lists of
	  clients.

2008-03-03 08:21  castaglia

	* modules/mod_core.c:
	  Make the message about an AuthOrder module with no auth handlers
	  a little more explicit.

2008-02-25 11:05  castaglia

	* src/inet.c:
	  Forgot to remove the old pr_inet_validate() function from inet.c.

2008-02-24 14:25  castaglia

	* tests/: Makefile.in, netaddr.c, stubs.c, tests.c, tests.h:
	  Adding unit tests for the Netaddr API.  Note that some of the
	  tests still need to be filled in.

2008-02-24 14:23  castaglia

	* src/netaddr.c:
	  Fix minor bugs in the Netaddr API.

2008-02-24 12:35  castaglia

	* include/compat.h, include/inet.h, include/netaddr.h,
	  src/ftpdctl.c, src/log.c, src/netaddr.c:
	  Move the function for validating DNS strings from inet.c
	  (pr_inet_validate) to netaddr.c (pr_netaddr_validate_dns_str).
	  Also remove the never-defined pr_inet_fqdn() function while I'm
	  at it.

2008-02-23 17:53  castaglia

	* src/log.c:
	  Set errno when appropriate, and catch a corner case where the
	  caller might provide a null format string.

2008-02-20 14:09  castaglia

	* src/log.c:
	  Log if ftruncate(3) fails.

2008-02-20 14:07  castaglia

	* modules/mod_delay.c:
	  Add logging of when write() fails for the DelayTable, even for a
	  single byte.	Also fix up some of the log messages where
	  "warning" would be redundant (the message was already logged at
	  the LOG_WARN level).

2008-02-20 14:01  castaglia

	* contrib/mod_ban.c:
	  Make sure we provide a printf-like format string when necessary,
	  rather than simply sending the intended string.  In this case,
	  there is no way for a user to inject their own data into the
	  message, but it's better to be paranoid.

2008-02-20 13:59  castaglia

	* src/fsio.c:
	  Rather than relying on simple path comparison in
	  pr_fs_copy_file(), for detecting when the source and destination
	  files are the same, check for same path, same device, same inode,
	  same size, and same mtime.

2008-02-20 10:47  castaglia

	* src/fsio.c:
	  Make sure the pr_fs_copy_file() function properly handles NULL
	  arguments, and detects when the source and destination paths are
	  the same.

2008-02-19 08:42  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#3044 - Segfault if mod_delay fails to load DelayTable.

2008-02-18 18:31  castaglia

	* tests/: Makefile.in, tests.c, tests.h, version.c:
	  Add unit tests for the new Version API functions.

2008-02-18 18:29  castaglia

	* Make.rules.in, include/version.h, src/version.c:
	  Make it possible to get versions (number, string) at runtime, for
	  runtime comparisons (e.g. by shared modules at load time).  These
	  functions complement the existing buildtime version macros.

2008-02-18 13:45  castaglia

	* include/log.h:
	  Use gcc's varargs checking for printf-like statements for the
	  pr_log_auth() function.

2008-02-18 13:26  castaglia

	* tests/: Makefile.in, event.c, tests.c, tests.h:
	  Added unit tests for the Event API.

2008-02-18 13:25  castaglia

	* src/event.c:
	  Event API bugfixes: Check for duplicate event handlers in
	  pr_event_register().	Return ENOENT if the requested event was
	  never registered, in pr_event_unregister().  Make sure the caller
	  provides a dump function in pr_event_dump().

2008-02-17 18:58  castaglia

	* tests/: Makefile.in, feat.c, tests.c, tests.h:
	  Add unit tests for the Feat API.

2008-02-17 18:56  castaglia

	* src/feat.c:
	  Minor fixes, so that EPERM is returned (before EINVAL), if there
	  are not features registered.	Also fix a bug where
	  pr_feat_remove() would return ENOENT, even when the feature being
	  removed had been registered; it was actually removed, but
	  pr_feat_remove() was not doing the right thing.

2008-02-17 18:15  castaglia

	* tests/: Makefile.in, tests.c, tests.h, var.c:
	  Add unit tests for the Var API.

2008-02-17 18:13  castaglia

	* include/var.h, src/var.c:
	  Removed the duplicate pr_var_remove() function (pr_var_delete()
	  did the same thing).	Fixed some cases where the functions would
	  not behave properly if the Var API has not been initialized
	  first, specifically pr_var_set().  Handle some bad arguments
	  better.

2008-02-17 13:27  castaglia

	* tests/tests.c:
	  Slightly more elegant way of iterating over all of the
	  testsuites, without needing to use strcmp().

2008-02-17 13:19  castaglia

	* tests/: Makefile.in, table.c, tests.c, tests.h:
	  Add unit tests for the Table API.

2008-02-17 13:17  castaglia

	* src/table.c:
	  Fix a few minor bugs related to checking for improper arguments.

2008-02-16 20:15  castaglia

	* doc/howto/Testing.html:
	  Start of a doc that will describe ProFTPD's burgeoning testsuite,
	  and how to use it.

2008-02-16 19:26  castaglia

	* tests/tests.c:
	  Make it possible to specify the name of a single testsuite to run
	  using the PR_TEST_SUITE environment variable.  Makes it much
	  easier when writing new testcases; now I don't have to run all
	  previous testcases to get to the one I'm working on.

2008-02-16 18:44  castaglia

	* tests/tests.c:
	  Emit a message to the user, asking them to send their tests.log
	  and their configure info, whenever the testsuite fails for them.

2008-02-16 18:11  castaglia

	* tests/: Makefile.in, stubs.c, tests.c, tests.h, timers.c:
	  Adding unit tests for the Timers API.

2008-02-16 18:06  castaglia

	* src/timers.c:
	  Fixing some issues found in the Timers API by unit testing.
	  Handle some null arguments better, and handle the case where
	  there may be no registered timers when pr_timer_reset() is
	  called.  Fixed up style in a few places.

2008-02-16 17:01  castaglia

	* tests/: Makefile.in, sets.c, tests.c, tests.h:
	  Adding unit tests for the Sets API.

2008-02-16 16:59  castaglia

	* include/sets.h, src/sets.c:
	  Cleanup of the Sets API.  Removed the unused xaset_union() and
	  xaset_subtract() functions.  Clean up the style/formatting of the
	  sets.c file.	Make sure that the functions can properly handle
	  NULL/bad arguments.  Have them return -1 on error, not zero on
	  error.

2008-02-16 12:46  castaglia

	* Makefile.in:
	  If --enable-tests has not been used, the tests/Makefile will not
	  have been created.  Thus do not try to use this Makefile for the
	  'make clean' target unless --enable-tests has been used.

2008-02-15 21:36  castaglia

	* tests/str.c:
	  Fill in the unit test for the sstrncpy() function.

2008-02-15 21:18  castaglia

	* tests/: .cvsignore, array.c, env.c, str.c, tests.c:
	  Capture testsuite output in `tests.log' file.  Make sure this
	  file is ignored by CVS.  Use fixtures for the very common task of
	  allocating and destroying the pool used by tests.

2008-02-15 17:44  castaglia

	* doc/contrib/mod_quotatab.html:
	  Properly close the line item.

2008-02-15 17:37  castaglia

	* doc/contrib/mod_quotatab.html:
	  Mention that mod_quotatab's ScanOnLogin behavior only kicks in if
	  the quota limit for the user includes non-zero bytes-in or
	  files-in.

2008-02-15 07:41  castaglia

	* doc/howto/CreateHome.html:
	  Start a FAQ for CreateHome questions.

2008-02-14 09:07  castaglia

	* doc/howto/CreateHome.html:
	  List the uid and gid parameters of CreateHome, and talk about
	  them a little.

2008-02-14 07:15  castaglia

	* doc/howto/TLS.html:
	  Add TLS FAQ on removing cert key passphrases.

2008-02-13 18:23  castaglia

	* contrib/mod_sql.c:
	  Add logging of when mod_sql decides to use the SQLDefaultUID
	  and/or SQLDefaultGID because the uid/gid falls below the
	  SQLMinUserUID and/or SQLMinUserGID.

2008-02-13 09:23  castaglia

	* tests/.cvsignore:
	  Ignore generated files.

2008-02-13 09:14  castaglia

	* configure:
	  Updated configure.

2008-02-13 09:11  castaglia

	* config.h.in, configure.in:
	  Update the autoconf support to define a PR_USE_TESTS macro, when
	  testsuite support is enabled.  Some of the proftpd macro
	  definitions will change when PR_USE_TESTS is true, to better
	  support unit testing.

2008-02-13 09:10  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_cap.c:
	  Bug#2000 - mod_cap should not use bundled libcap.  Updated
	  autoconf to check for a system libcap, and to make proftpd NOT
	  build and use the bundled libcap if a system libcap is present.

2008-02-13 08:16  castaglia

	* tests/str.c:
	  Fill in the unit tests for more of the string manipulation
	  functions.

2008-02-13 08:16  castaglia

	* src/str.c:
	  Fix up the indentation/style in sreplace().  Guard against
	  null/bad arguments.

2008-02-12 23:49  castaglia

	* tests/: Makefile.in, env.c, tests.c, tests.h:
	  Add unit tests for the Env API.

2008-02-12 23:24  castaglia

	* include/pool.h, src/pool.c:
	  Guard against bad/null inputs in the Array API, and change the
	  signature to prevent negative counts and sizes (which would make
	  no sense).

2008-02-12 23:21  castaglia

	* tests/: Makefile.in, array.c, tests.c, tests.h:
	  Adding unit tests for the Array API.

2008-02-12 19:45  castaglia

	* src/str.c:
	  Guard against NULL arguments in sreplace().

2008-02-12 09:04  castaglia

	* configure:
	  Updated configure.

2008-02-12 08:58  castaglia

	* configure.in:
	  Try to describe the --enable-devel option such that packagers
	  won't use it.

2008-02-11 07:13  castaglia

	* configure:
	  Updated configure.

2008-02-10 20:46  castaglia

	* Make.rules.in, Makefile.in, config.h.in, configure.in:
	  Added support for the --enable-tests configure option, autoconf
	  checking for the `check' package, and support for a `make check'
	  option.

2008-02-10 20:44  castaglia

	* tests/: Makefile.in, pool.c, str.c, stubs.c, tests.c, tests.h:
	  Start of a testsuite for proftpd.  Uses the 'check' package; see

	    http://check.sourceforge.net/

	  To enable, compile proftpd using --enable-tests.  Then run `make
	  check' before installing.

	  Expect to see a lot of activity here, as proftpd gets the
	  testsuite its desperately needed for years.

2008-02-10 20:37  castaglia

	* Make.rules.in, include/conf.h, include/pool.h, include/str.h,
	  include/support.h, src/ftpdctl.c, src/pool.c, src/str.c,
	  src/support.c:
	  Moving some functions out of pool.c and support.c into a new
	  str.c object.  This is some necessary refactoring.  "Why is it
	  necessary?" you ask.	Good question.	Because I'm about to add
	  some testsuite support to proftpd, and writing those unit tests
	  required some basic, long-overdue code refactoring.

2008-02-10 12:14  castaglia

	* contrib/: mod_ban.c, mod_ctrls_admin.c:
	  Updated mod_ban and mod_ctrls_admin to use the re-named
	  scoreboard entry reading function.

2008-02-09 18:29  castaglia

	* include/compat.h, include/scoreboard.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_xfer.c, src/data.c, src/main.c,
	  src/scoreboard.c, utils/ftpcount.c, utils/ftptop.c,
	  utils/ftpwho.c, utils/scoreboard.c, utils/utils.h:
	  Added a new pr_scoreboard_entry_get() function, and renamed some
	  of the other scoreboard entry functions to match the naming
	  convention.  This also meant adding some compatibility macros in
	  compat.h for other modules, for now.

	  Also updated ftpwho and ftptop to properly display uploading,
	  downloading, and listing commands (including handling the MLST
	  and MLSD commands properly).

	  This work fell out of handling the case where dispatched commands
	  on the control channel, while a data transfer is occurring, can
	  change the scoreboard fields and thus cause erroneous/confusing
	  output in ftpwho and ftptop.

2008-02-09 17:17  castaglia

	* include/proctitle.h, src/data.c, src/proctitle.c: Be sure to
	  restore the previous process title after handling a command from
	  the control channel whilst handling a data transfer.

2008-01-30 09:26  castaglia

	* include/response.h, src/data.c, src/main.c, src/response.c:
	  Now that proftpd can handle commands on the control channel
	  whilst doing a data transfer, it needs to be more careful of the
	  memory pool used by the Response API.  Specifically, we don't
	  want to lose the memory pool from the data-transferring command
	  while handling the command from the the control channel.

	  Also, make sure that proftpd rejects any data transfer command
	  from the control channel if we're already doing a data transfer.
	  The amount of re-plumbing that would be needed to support kicking
	  off multiple simultaneous data transfers is quite a lot; FTP
	  clients already work around this by establishing multiple
	  simultaneous separate sessions.

2008-01-28 07:38  castaglia

	* contrib/mod_ifsession.c:
	  Use the session.pool, rather than main_server->pool, for merging
	  in configurations in mod_ifsession.  The session.pool is assigned
	  as part of setting up a connection; the latter memory pool is
	  not.

2008-01-24 17:53  castaglia

	* contrib/mod_wrap.c:
	  Quell some compiler warnings in mod_wrap.

2008-01-24 17:11  castaglia

	* src/proctitle.c:
	  Silence a compiler warning about unused variables when
	  PR_DEVEL_STACK_TRACE is defined.

2008-01-24 09:11  castaglia

	* src/netacl.c:
	  Fix issue when trying to stringify an IP mask ACL; pstrcat() was
	  being called with a number, not a string, as an argument.

2008-01-23 08:59  castaglia

	* src/netio.c:
	  Hmm.	Maybe some of the lingering close changes I made yesterday
	  weren't the best.  So, for now, pare it back to logging about any
	  read data received during a lingering close.

2008-01-22 20:26  castaglia

	* src/netio.c:
	  When performing a lingering close, the select() call actually
	  return because there was data to be read on the socket being
	  closed.  If that is the case, log the presence of that data using
	  Tracing, and continue the lingering.	(Otherwise, such data will
	  cause a premature lingering, which is not really what we want
	  either.)

2008-01-21 10:05  castaglia

	* src/main.c:
	  Remove some tabs; no functional change.

2008-01-21 09:50  castaglia

	* RELEASE_NOTES:
	  Mention the inclusion of IPv6 support in the default build.

2008-01-21 09:48  castaglia

	* README.IPv6:
	  Updated the IPv6 README.

2008-01-21 09:48  castaglia

	* configure:
	  Updated configure.

2008-01-21 09:44  castaglia

	* NEWS, configure.in, sample-configurations/basic.conf:
	  Bug#2577 - IPv6 support should be enabled by default.

2008-01-18 11:23  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#3034 - Rewritten command parameters need to be set in
	  multiple places.

2008-01-18 08:26  castaglia

	* contrib/mod_ctrls_admin.c:
	  Silence compiler warning about unused variable.

2008-01-18 08:17  castaglia

	* NEWS, include/netacl.h, src/class.c, src/netacl.c:
	  Bug#3033 - Class rules not honoring '!' negation character.

2008-01-17 17:01  castaglia

	* src/main.c:
	  Make sure that the handling of any <Limit LOGIN> sections happens
	  after the class of the session has been determined.  Otherwise,
	  any AllowClass/DenyClass directives within the <Limit> section
	  will not be handled properly.

2008-01-16 18:19  castaglia

	* modules/mod_facts.c:
	  Fix some issues with the formatting of entries for the MLST and
	  MLSD responses.  MLST entries require a leading space, as per RFC
	  -- but MLSD entries do not.  (Also add a missing newline
	  character in the entries.)

	  The data connection cleanup handler appeared not to be necessary;
	  the MLSD command handler appears to be closing the connection
	  itself, so no need for a cleanup POST_CMD/POST_CMD_ERR handler
	  for that.

2008-01-16 17:42  castaglia

	* NEWS, src/netaddr.c:
	  Bug#3031 - IPv4-mapped IPv6 connections not matched properly
	  against IPv4 glob ACLs.

2008-01-15 17:21  castaglia

	* modules/mod_facts.c:
	  The mod_facts module was not properly returning a type of "cdir"
	  if the listed path was indeed the current directory.

2008-01-15 16:38  castaglia

	* src/main.c:
	  Handle the case where the admin might define the tunable EINTR
	  retry interval to be less than a second, e.g.:

	    ./configure CFLAGS=-DPR_TUNABLE_EINTR_RETRY_INTERVAL=0.5 ...

	  In the code which handles that value, break the defined value
	  into usecs, and Do The Right Thing(tm).  The previous code simply
	  assumed that the defined value would be in seconds.  The issue
	  would only be noticed if compiler warnings were enabled and
	  scanned; for example:

	    main.c:1527: warning: unsigned int format, double arg (arg 3)

2008-01-15 10:27  castaglia

	* doc/howto/Logging.html:
	  Add more substance to the note about not logging to
	  world-writable directories (i.e. mention that proftpd will NOT do
	  this).

2008-01-15 09:56  castaglia

	* NEWS, include/modules.h, include/netio.h, src/data.c, src/main.c,
	  src/netio.c:
	  Bug#2999 - Data transfer not aborted when control connection is
	  closed.

	  This patch adds polling of the control connection while
	  transferring data on the data connection.  Commands sent on the
	  control connection will be dispatched (thus delaying the data
	  transfer); this allows handling of commands like ABOR during data
	  transfer.  If the control connection closes during the data
	  transfer, the data transfer is aborted.  Hopefully this will
	  address quite a few issues related to aborting data transfers.

2008-01-14 18:26  castaglia

	* contrib/mod_ratio.c:
	  Silence some compiler warnings about uninitialized variables.

2008-01-14 17:21  castaglia

	* src/data.c:
	  Found a few more places where text needs to be marked for
	  localisation.

2008-01-14 14:42  castaglia

	* doc/contrib/mod_tls.html:
	  Update TLSLog description to note requirement about parent
	  directory permissions.

2008-01-14 07:38  castaglia

	* include/ftp.h, modules/mod_facts.c:
	  Add definitions of the MLSD, MLST commands to ftp.h.

2008-01-12 15:01  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#3027 - Unmatched backreferences are not handled properly in
	  RewriteRules.

2008-01-12 14:59  castaglia

	* contrib/mod_rewrite.c:
	  Additional changes needed for the full fix for Bug #3026.

2008-01-11 19:28  castaglia

	* configure:
	  Updated configure.

2008-01-11 19:25  castaglia

	* configure.in:
	  Copy-n-paste error in configure.in added erroneous line break.

2008-01-11 19:00  castaglia

	* modules/mod_xfer.c:
	  The PRIO_MIN and PRIO_MAX macros may not be defined on some
	  platforms (e.g.  Solaris 9), so define suitable values in such
	  cases.

2008-01-11 18:20  castaglia

	* configure:
	  Updated configure.

2008-01-11 18:12  castaglia

	* configure.in:
	  Avoid an autoconf warning when checking for
	  <security/pam_modules.h> by including <security/pam_appl.h>, if
	  detected.  Without this, the configure script would throw an ugly
	  warning (e.g. on Solaris 9) about not being able to compile
	  <security/pam_modules.h>.

2008-01-11 13:55  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#3026 - RewriteCondition does not negate -d -f -s tests.

2008-01-11 09:12  castaglia

	* contrib/mod_sql.c:
	  Fix off-by-one error in mod_sql, which only cropped up in the
	  case where a) a custom SQLUserInfo query was used, and b) that
	  query neglected to provide a shell value.  This would lead to a
	  segfault.

2008-01-10 10:22  castaglia

	* contrib/mod_ifsession.c:
	  Add signal handling to mod_ifsession's while loops, as proper.
	  Some style cleanup.  Bump the mod_ifsession version number to
	  1.0; there have been few bugs reported with this module, showing
	  that it's stable.

2008-01-09 20:24  castaglia

	* contrib/mod_sql.c:
	  Remove the mod_sql code which used to support the (deprecated and
	  removed) SQLHomedirOnDemand feature.

2008-01-09 20:10  castaglia

	* configure:
	  Updated configure.

2008-01-09 20:08  castaglia

	* configure.in:
	  Remove $0 from the PR_BUILD_OPTS; the $ac_configure_args variable
	  already contains the string "configure", thus using $0 is
	  redundant.

2008-01-09 10:56  castaglia

	* modules/mod_log.c:
	  Copy the improvements in mod_sql for handling of certain
	  SQLNamedQuery variables (Bug#2889, Bug#3025) into mod_log, so
	  that ExtendedLogs benefit from the improvements as well.

2008-01-09 08:13  castaglia

	* contrib/mod_sql.c:
	  Expand %F in SQLNamedQuery, for DELE, using dir_best_path(),
	  rather than simply logging the name of the file as sent by the
	  client.  (Do the same for %F and RNTO as well.)

2008-01-09 08:06  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#3025 - Using %b in a SQLNamedQuery does not properly log the
	  file size for DELE.

2008-01-09 07:28  castaglia

	* contrib/mod_sql_odbc.c:
	  Removed "IMHO" from comment describing Oracle library bug; it's
	  been confirmed by Oracle.

2008-01-08 16:06  castaglia

	* contrib/mod_quotatab.c:
	  If the DELE command fails, make sure to still clear the cached
	  file size by registerting a POST_CMD_ERR handler.

	  And in the PRE_CMD handler for DELE, be sure to a) UTF8 decode
	  any path the client might be sending, and b) be sure to cache the
	  size of the symlink file, not the pointed-to file, if the file
	  being deleted is indeed a symlink.

2008-01-08 16:04  castaglia

	* modules/mod_core.c:
	  Explicit cast to avoid compiler warning.

2008-01-08 15:27  castaglia

	* modules/mod_core.c:
	  If multiple addresses are given using the DefaultAddress
	  directive, make sure the log message emitted reflects this,
	  otherwise it can be confusing (see Bug#3024).

2008-01-08 09:59  castaglia

	* contrib/mod_sql_odbc.c:
	  Work around an Oracle library bug in mod_sql_odbc, rather than in
	  the core proftpd code, by using square brackets instead of
	  parentheses in the process title.  More details on the issue can
	  be found as comments in the mod_sql_odbc code.

2008-01-08 09:58  castaglia

	* src/main.c:
	  Revert back to using parentheses in the process title; the Oracle
	  bug workaround can be done, I think, from mod_sql_odbc rather
	  than from the core code.

2008-01-08 09:37  castaglia

	* src/main.c:
	  Change the name to which the process title is set when the daemon
	  process is waiting to accept connections.  It's a hack, a
	  workaround of an Oracle library bug.	Yuck.

2008-01-07 20:23  castaglia

	* README.modules, RELEASE_NOTES:
	  Mention the new database backend modules: mod_sql_odbc and
	  mod_sql_sqlite.

2008-01-07 20:21  castaglia

	* doc/contrib/mod_sql_odbc.html:
	  Update the installation instructions for mod_sql_odbc; they are
	  slightly different, and no longer require the use of an extra
	  configure script.

2008-01-07 20:15  castaglia

	* contrib/mod_sql_sqlite.c:
	  Turns out there's no need to guard the definition and
	  registration of an event handler for the 'core.module-unload'
	  event; none of the other mod_sql backend modules have guards for
	  their module-unload event handlers.

2008-01-07 20:15  castaglia

	* NEWS, contrib/mod_sql_odbc.c, doc/contrib/mod_sql_odbc.html:
	  Add the mod_sql_odbc module to the contrib area.

2008-01-07 20:12  castaglia

	* configure:
	  Updated configure.

2008-01-07 20:07  castaglia

	* configure.in:
	  When checking for module-specific header files (and then creating
	  symlinks to those header files into the include/ area), test for
	  existence of a file, rather than requiring both that the path
	  exist AND be a regular file.	The difference is that a simple
	  existence check allows for the header files to themselves be
	  symlinks (for whatever reason).

2008-01-07 18:38  castaglia

	* contrib/mod_sql_sqlite.c, doc/contrib/mod_sql_sqlite.html:
	  Make sure that mod_sql_sqlite acts properly when built as a
	  shared module.

	  Update docs to mention the SQLBackend name provided by
	  mod_sql_sqlite.

2008-01-07 18:31  castaglia

	* NEWS, contrib/mod_sql_sqlite.c, doc/contrib/mod_sql_sqlite.html:
	  Add the mod_sql_sqlite module to the contrib area.

2008-01-07 18:21  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Typo.

2008-01-07 18:13  castaglia

	* configure:
	  Updated configure.

2008-01-07 18:09  castaglia

	* configure.in:
	  Decided I do not need the leading '$' character in the configure
	  invocation string, for I am capricious that way.

2008-01-07 18:07  castaglia

	* configure.in:
	  I don't know why, but on this Ubuntu box, the configure arguments
	  were not being properly written out to the generated config.h
	  file.  I had to poke around a bit with the autoconf variables,
	  but finally found a magic incantation to make it work.

	  Of course, this means it will probably stop working on some other
	  platform; will check once this change propagates to the anon CVS
	  server.

2008-01-07 07:35  castaglia

	* configure:
	  Update configure.

2008-01-06 17:56  castaglia

	* doc/contrib/mod_sql.html:
	  Make clearer the distinction between Unix domain sockets and TCP
	  sockets when discussing chroot() and its effects on database
	  connection re-opening.

	  Remove any mention of long-deprecated directives; they will only
	  serve to confuse people at this point in time.

2008-01-06 17:44  castaglia

	* NEWS, contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c:
	  Bug#3022 - Timed SQL connections don't reconnect to database.

2008-01-05 15:12  castaglia

	* README.modules:
	  Update README.modules to mention the new modules.

2008-01-05 13:37  castaglia

	* configure.in: Fix issue with configure script where the
	  command-line options were not being properly captured (before
	  being processed to find the system name), and thus not being
	  preserved for -V output.  Also remove any occurrence of "your" in
	  the configure output.

2008-01-05 13:21  castaglia

	* modules/mod_auth.c: There is no longer a need to stash the
	  current class name in the config tree using the "CURRENT-CLASS"
	  key; the current class information is available via the
	  session.class pointer.

2008-01-04 22:40  castaglia

	* contrib/mod_sql.c:
	  Remove the unused add_virtualbool() function.

2008-01-04 22:28  castaglia

	* Make.rules.in:
	  Yet another place where we need to teach proftpd not to build the
	  ident code as part of the core engine anymore.

2008-01-04 22:26  castaglia

	* include/conf.h, include/ident.h, src/ident.c: Delete the now
	  unused core ident lookup code; this functionality has been moved
	  to the mod_ident module, as per Bug#2453.

2008-01-04 22:23  castaglia

	* src/xferlog.c:
	  Forgot to check in the changes for this file, relating to
	  Bug#2453.  Without these, the build fails.

2008-01-04 20:55  castaglia

	* contrib/mod_ban.c, contrib/mod_wrap.c, modules/mod_auth.c: Fix a
	  few more places where text needs to be localised.

2008-01-04 17:29  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#3023 - Allow uploading to /dev/null.

2008-01-04 17:22  castaglia

	* configure:
	  Updated configure.

2008-01-04 17:22  castaglia

	* RELEASE_NOTES, doc/modules/mod_ident.html:
	  Update documentation for the new mod_ident module.

2008-01-04 17:12  castaglia

	* NEWS, configure.in, contrib/mod_sql.c,
	  contrib/mod_wrap2/mod_wrap2.c, include/proftpd.h,
	  modules/mod_ident.c, modules/mod_log.c, src/display.c,
	  src/main.c:
	  Bug#2453 - Separate RFC1413 code into mod_ident module.

2008-01-04 17:01  castaglia

	* src/table.c:
	  Calling pr_table_add_dup() and supplying a zero-length value data
	  size should Do The Right Thing(tm) by treating the value as a
	  string, and automatically calculating the string length, just as
	  pr_table_add() does.

2008-01-04 15:22  castaglia

	* configure:
	  Updated configure.  (Upgraded to autoconf-2.61 as well.)

2008-01-04 15:18  castaglia

	* Make.rules.in, config.h.in, configure.in, contrib/mod_tls.c,
	  include/conf.h, modules/mod_core.c, src/main.c:
	  Add an autoconf check for the sys/resource.h header file; this is
	  the file which, on BSD, defines the getpriority(2) and
	  setpriority(2) functions.  This should help the current proftpd
	  sources in CVS to compile properly on FreeBSD.

2008-01-04 14:23  castaglia

	* modules/mod_auth_unix.c:
	  Fix compiler warning about using the wrong datatype when calling
	  getgrouplist(2).

2008-01-04 14:22  castaglia

	* src/dirtree.c:
	  Use socklen_t, not int, for getsockopt(2) calls.

2008-01-02 20:23  castaglia

	* configure:
	  Updated configure.

2008-01-02 20:21  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_auth_unix.c:
	  Bug#1896 - Check AIX account status.

2008-01-02 19:49  castaglia

	* NEWS, contrib/mod_ratio.c:
	  Bug#1973 - mod_ratio uses the too-small int datatype for tracking
	  bytes.

2008-01-02 18:52  castaglia

	* NEWS, contrib/mod_ratio.c:
	  Bug#1771 - mod_ratio compile warnings.

	  Add better formatting, error checking, function definition, etc.

2008-01-02 18:13  castaglia

	* utils/: ftpcount.c, ftpwho.c, misc.c, scoreboard.c, utils.h:
	  Clean up some unused function prototypes in the utils code, and
	  consolidate all of the utils to use the same sstrncpy()
	  implementation.

2008-01-02 18:00  castaglia

	* modules/mod_facts.c:
	  Fix printf(3) format warning in mod_facts.

2008-01-02 17:39  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#3020 - Server replies to NLST with 450 at the wrong time.
	  Only open a data connection, when handling NLST, when we know
	  that we will most likely be sending some data.

2008-01-02 15:17  castaglia

	* RELEASE_NOTES:
	  Mention the new TransferPriority directive.

2008-01-02 15:16  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2731 - Add ability to set process priority for file
	  transfers.

2008-01-02 15:07  castaglia

	* modules/mod_xfer.c:
	  Need to add the name of the timer added, as per the changed Timer
	  API.

2008-01-02 14:47  castaglia

	* configure:
	  Updated configure.

2008-01-02 14:44  castaglia

	* configure.in:
	  Missing quotation mark broke the configure script.

2008-01-02 14:43  castaglia

	* contrib/mod_tls.c:
	  Pay attention to the TLSRandomSeed file, if configured, and log
	  whenever mod_tls does not have sufficient PRNG seed data (as per
	  the RAND_status() OpenSSL API).

2008-01-02 10:31  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2889 - Update SQLLog so that RNTO stores the path when using
	  the %F variable.

2008-01-02 09:58  castaglia

	* NEWS, modules/mod_auth.c, src/auth.c:
	  Bug#2997 - Uploading files with "~" causes harmless but annoying
	  log message.

2008-01-01 09:31  jwm

	* contrib/mod_ldap.c: happy new year

2008-01-01 09:29  jwm

	* contrib/mod_ldap.c: release v2.8.18: * Remove all local caching
	  code in favor of the recently added caching in   the ProFTPD Auth
	  layer.  * Silence some compiler warnings.

2007-12-31 14:47  castaglia

	* include/proftpd.h, modules/mod_auth.c, modules/mod_xfer.c,
	  src/data.c, src/main.c:
	  Move the TIMER_ macros into the PR_ namespace, for cleanliness.

2007-12-31 14:33  castaglia

	* NEWS, include/data.h, include/dirtree.h, modules/mod_core.c,
	  modules/mod_xfer.c, src/data.c, src/dirtree.c, src/main.c:
	  Bug#2741 - Apply TimeoutNoTransfer, TimeoutStalled, TimeoutIdle
	  to <Anonymous> section.

2007-12-31 13:45  castaglia

	* RELEASE_NOTES, doc/modules/mod_auth_pam.html:
	  Updated documentation.

2007-12-31 13:37  castaglia

	* NEWS, modules/mod_auth_pam.c:
	  Bug#3014 - Optionally set PAM_TTY item when using PAM.

2007-12-31 11:39  castaglia

	* doc/rfc/rfc2640.txt:
	  Add RFC2640 to the docs collection.

2007-12-31 11:34  castaglia

	* configure:
	  Updated configure.

2007-12-31 11:31  castaglia

	* modules/mod_facts.c:
	  No need to include the URLs to the RFC and Draft implemented by
	  this module; they are in the mod_facts module documentation now.

2007-12-31 11:30  castaglia

	* NEWS, config.h.in, configure.in, include/dirtree.h,
	  include/options.h, modules/mod_xfer.c, src/data.c, src/dirtree.c,
	  src/main.c:
	  Bug#2874 - Data transfer buffers should be allocated at startup,
	  not at compile time.

2007-12-31 11:19  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#3003 - Fallback to normal transmission in case of sendfile
	  EOVERFLOW error missing.

2007-12-31 11:13  castaglia

	* RELEASE_NOTES:
	  Updating the release notes.

2007-12-31 11:12  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2894 - Mark the AnonymousGroup directive as deprecated, to be
	  removed in a future release.

2007-12-31 10:56  castaglia

	* doc/modules/mod_facts.html:
	  Adding documentation (though brief) for the new mod_facts module.

2007-12-31 10:47  castaglia

	* doc/rfc/: draft-ietf-ftpext-mlst-15.txt,
	  draft-somers-ftp-mfxx-03.txt, rfc3659.txt:
	  Adding RFC3659 (which supercedes an Internet Draft on MLST), and
	  adding an Internet Draft defining the MFF and MFMT commands.

2007-12-31 10:33  castaglia

	* configure:
	  Updated configure.

2007-12-31 10:28  castaglia

	* NEWS, configure.in, modules/mod_facts.c:
	  Bug#3015 - Support for RFC3659.  The mod_facts module is now part
	  of the default proftpd build, providing the MLSD, MLST commands
	  from RFC3659 as well as the MFF and MFMT commands from an
	  Internet Draft.

2007-12-31 09:39  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#3019 - DisplayLogin in <Anonymous> section not displayed
	  properly.

2007-12-22 13:17  castaglia

	* modules/mod_lang.c: Pedantic correction of indentation, so that
	  it is consistent with the style of the rest of the file.

2007-12-22 11:26  castaglia

	* src/inet.c: Enable the SO_KEEPALIVE option on sockets used by
	  proftpd.  This will enable the TCP keepalive messages which help
	  to determine if the peer host (as opposed to the peer program)
	  have crashed.

2007-12-17 19:26  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#3013 - "TLSOptions AllowPerUser" not working as expected.

2007-12-17 18:15  castaglia

	* modules/mod_site.c:
	  Typo.

2007-12-17 18:09  castaglia

	* modules/mod_auth.c:
	  Make sure to localise strings sent via pr_response_send().

2007-12-15 13:47  castaglia

	* modules/mod_core.c: Update the comments for the MDTM handler,
	  noting that it is an official command as per RFC3659.  Also make
	  sure to initialize the entire buffer used to construct the
	  response timestamp.

2007-12-12 13:23  castaglia

	* NEWS, contrib/mod_site_misc.c, doc/contrib/mod_site_misc.html:
	  Bug#3012 - SITE UTIME should support YYYYMMDDhhmmss format.

2007-12-10 13:46  castaglia

	* contrib/mod_tls.c:
	  Bug#3011: "TLSRequired !data" configuration does not allow PROT
	  C.

	  If the TLSRequired directive policy does not explicitly require
	  SSL/TLS protection on the data channel, then allow any PROT C
	  requests from clients.

2007-11-15 19:16  castaglia

	* NEWS, src/data.c:
	  Bug#3001 - Incomplete downloads not logged properly in
	  TransferLog if sendfile is used.

2007-11-15 18:15  castaglia

	* contrib/mod_site_misc.c:
	  Thomas L. Shinnick rightly pointed out the bugs involved here,
	  when using <Limit> configurations for the SITE commands provided
	  by the mod_site_misc module.

2007-11-15 09:33  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#3006 - 'ScanOnLogin' QuotaOption may try to update a
	  nonexistent tally record.

2007-11-15 09:21  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#3004 - 'ScanOnLogin' QuotaOption does not honor
	  QuotaDirectoryTally directive.

2007-11-15 08:38  castaglia

	* src/main.c:
	  Use REG_RIP for 64-bit machines, rather than REG_EIP, if the
	  'stacktrace' --enable-devel configure option is used.

2007-11-15 07:15  castaglia

	* NEWS, src/data.c, src/netio.c:
	  Bug#3005 - OOB abort closes the control connection.

2007-10-26 09:02  castaglia

	* doc/modules/mod_lang.html:
	  Update the LangEngine docs to mention that that is the directive
	  which governs the appearance of "UTF8" in response to a FEAT
	  command -- not the UseUTF8 directive.

2007-10-24 22:18  castaglia

	* modules/Makefile.in: Be sure to clean up any .a archive files
	  around as well.

2007-10-22 11:09  castaglia

	* contrib/mod_ban.c, contrib/mod_dynmasq.c,
	  contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c,
	  contrib/mod_tls.c, include/timers.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_ctrls.c, modules/mod_xfer.c,
	  src/data.c, src/ident.c, src/main.c, src/timers.c:
	  Changed the pr_timer_add() function to take a 'desc' string, for
	  describing the timer being added.  This description is logged in
	  the trace logging of timers.

2007-10-18 09:22  castaglia

	* NEWS:
	  Typo.

2007-10-17 08:39  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2996 - Requirement for same OpenSSL header, library version
	  in mod_tls too restrictive.

2007-10-16 09:29  castaglia

	* RELEASE_NOTES:
	  Add more release notes fragments, to be filled in more detail
	  later.

2007-10-16 09:27  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2995 - The %f LogFormat variable expanded to same file for
	  RNFR and RNTO.

2007-10-15 23:12  castaglia

	* src/main.c:
	  Add some missing (albeit sometimes unnecessary) 'break'
	  statements.

2007-10-15 23:07  castaglia

	* src/main.c:
	  Remove crufty unused ElectricFence code.

2007-10-15 11:16  castaglia

	* configure:
	  Updated configure.

2007-10-15 11:11  castaglia

	* config.h.in, configure.in, src/main.c:
	  Enhance the proftpd -V output to include the directory where the
	  proftpd header files are installed, for DSO-enabled proftpds.
	  This will be used by the prxs tool (see Bug#2991).

2007-10-15 10:53  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#2992 - The %f LogFormat variable expanded improperly to "-"
	  for SITE CHMOD.

2007-10-15 10:30  castaglia

	* configure:
	  Updated configure.

2007-10-15 10:27  castaglia

	* NEWS, acconfig.h, config.h.in, configure.in:
	  Bug#2993 - Unable to compile 1.3.1 on Debian unstable/amd64.

2007-10-15 09:51  castaglia

	* NEWS, RELEASE_NOTES, include/modules.h, src/main.c,
	  src/modules.c:
	  Bug#2937 - Should list modules (with versions) for modules loaded
	  as DSOs.

2007-10-15 09:23  castaglia

	* doc/howto/DSO.html:
	  Update the DSO doc with better instructions, after having run
	  through them myself.

2007-10-14 15:59  castaglia

	* Make.rules.in, utils/ftpcount.c, utils/ftptop.c, utils/ftpwho.c,
	  utils/misc.c, utils/utils.h: Factor out the function used to scan
	  the config file for the ScoreboardFile directive from three of
	  the utilities into a single common location.	This is groundwork
	  for making it possible to scan the config file for other
	  directives as well.

2007-10-13 18:10  castaglia

	* contrib/mod_tls.c: Explicitly cast one of the tls_log() arguments
	  to an unsigned int, to silence compilers warning of mismatched
	  printf arguments.

2007-10-13 17:48  castaglia

	* src/auth.c: Refactor the code for creating and adding to the
	  idcache tables into separate functions.  This makes it easier to
	  add to those caches in the auth_getpwnam() and auth_getgrnam()
	  functions.

2007-10-12 22:16  castaglia

	* contrib/mod_tls.c: If the TLSCryptoDevice handling code is in the
	  session initialization code path, then the directive can once
	  again be vhost-specific.

2007-10-12 20:08  castaglia

	* configure:
	  Update configure.

2007-10-12 20:05  castaglia

	* config.h.in, configure.in, modules/mod_ctrls.c, src/ctrls.c:
	  More work towards Bug #2386.	In this, I found that Solaris 10
	  has a getpeerucred(3) function, which can be used for obtaining
	  kernel-enforced credentials for the peer on the other end of a
	  Unix domain socket.

2007-10-12 18:47  castaglia

	* contrib/mod_radius.c, include/auth.h, modules/mod_auth_pam.c,
	  src/auth.c:
	  More work towards Bug #2989.	Adds a new
	  pr_auth_add_auth_only_module() function, to be used by modules
	  that are auth-only "yes/no" style of modules (e.g. mod_auth_pam).
	  This presents a better solution for the issue.

2007-10-12 13:40  castaglia

	* NEWS, contrib/mod_radius.c, include/auth.h, src/auth.c:
	  Bug#2989 - Unable to authenticate users if RadiusUserInfo is not
	  configured.

2007-10-12 09:05  castaglia

	* contrib/mod_tls.c:
	  Style cleanup; no functional changes.

2007-10-12 09:01  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2990 - TLSCryptoDevice does not work.

2007-10-11 11:08  castaglia

	* doc/howto/ConfigurationTricks.html:
	  Add note about how different PassivePorts are not needed for
	  different proftpd instances.

2007-10-11 10:07  castaglia

	* RELEASE_NOTES:
	  Mention mod_unique_id in the release notes.

2007-10-11 10:06  castaglia

	* doc/contrib/mod_unique_id.html:
	  Update the mod_unique_id for its new home, and add an example of
	  using the UNIQUE_ID environment variable in a SQL table.

2007-10-11 10:02  castaglia

	* NEWS, contrib/mod_unique_id.c, doc/contrib/index.html,
	  doc/contrib/mod_unique_id.html:
	  Added the mod_unique_id contrib module.

2007-10-11 09:58  castaglia

	* contrib/mod_dynmasq.c:
	  Use the PR_ macro namespace.

2007-10-11 09:47  castaglia

	* contrib/mod_tls.c:
	  Had checking for <Limit> on PROT command in the wrong place.
	  Oops.

2007-10-11 09:45  castaglia

	* RELEASE_NOTES, doc/contrib/mod_tls.html:
	  Document the new TLSRequired policy configurations.

2007-10-11 09:39  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2968 - Ability to allow protection on control channel, but
	  reject protection on data channel.

2007-10-11 09:32  castaglia

	* RELEASE_NOTES:
	  Start of a new release notes doc for the 1.3.2 series.

2007-10-11 09:29  castaglia

	* doc/contrib/index.html:
	  The mod_ban module was not in the contrib index list.  Oops.

2007-10-11 09:28  castaglia

	* doc/contrib/mod_dynmasq.html:
	  Updating the mod_dynmasq docs for their new home.

2007-10-11 09:26  castaglia

	* NEWS, contrib/mod_dynmasq.c, doc/contrib/index.html,
	  doc/contrib/mod_dynmasq.html:
	  Adding the mod_dynmasq module to the source distribution.

2007-10-11 09:23  castaglia

	* contrib/: INSTALL.mod_wrap, README.mod_wrap:
	  Removing obsoleted documentation; this documentation is now
	  available in doc/contrib/mod_wrap.html.

2007-10-11 09:21  castaglia

	* doc/howto/: ConfigurationTricks.html, index.html:
	  Adding ConfigurationTricks doc to source distribution.

2007-10-10 19:37  castaglia

	* src/ctrls.c:
	  Use "credentials" consistently, not the lazy "creds", in log
	  messages.

2007-10-10 19:35  castaglia

	* configure:
	  Updating configure.

2007-10-10 19:31  castaglia

	* NEWS, config.h.in, configure.in, include/ctrls.h,
	  modules/mod_ctrls.c, src/ctrls.c:
	  Bug#2386 - Controls should use kernel-enforced credentials where
	  possible.

2007-10-10 10:13  castaglia

	* src/ctrls.c:
	  Revert back to using debug logging, rather than trace logging,
	  for the Unix socket detection tests.	Trace logging will not have
	  been initialized when Controls are initialized, so any trace
	  logging done in init_ctrls() was being ignored/lost.

2007-10-09 20:56  castaglia

	* contrib/mod_ban.c:
	  Turns out that testing for the _POSIX_SOURCE macro is a better
	  way of knowing which typecast to use for shmdt(2).

2007-10-09 20:44  castaglia

	* contrib/mod_ban.c:
	  Solaris' shmdt(2) wants a char *, not a const void * -- and the
	  compiler complains every time mod_ban is compiled.  Easy enough
	  to fix that with a proper cast, but just for Solaris.

2007-10-09 20:38  castaglia

	* contrib/mod_ban.c:
	  Seems that Solaris' getopt implementation prefers resetting the
	  optind variable to 1, rather than zero, in order to reset the
	  getopt(3) function.

2007-10-09 19:32  castaglia

	* modules/mod_auth_unix.c:
	  Remove the caching that mod_auth_unix did, for the ID-to-name
	  lookups.  This caching is now being handled at a higher layer, in
	  the Auth API.

2007-10-09 14:56  castaglia

	* src/netaddr.c:
	  Make sure that trace logging is done *before* the temporary pool
	  (from which one of the netaddr objects may have been allocated)
	  is freed.  Otherwise we might log garbage day, or trigger a
	  segfault.

2007-10-09 14:54  castaglia

	* src/netaddr.c:
	  Add trace logging for when comparing netaddrs yields no match,
	  for completeness.

2007-10-09 10:30  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2982 - Support limit on number of simultaneous file transfers
	  from one client.

2007-10-09 10:24  castaglia

	* NEWS, contrib/mod_wrap2_file.c:
	  Bug#2988 - mod_wrap2_file ignores "ALL" keyword.

2007-10-08 11:47  castaglia

	* NEWS, src/auth.c:
	  Bug#2986 - Authoritative PAM is not honored.

2007-10-08 11:22  castaglia

	* NEWS, contrib/mod_ban.c:
	  Bug#2987 - Verbose ban information (i.e. 'ftpdctl ban info -v')
	  not working on FreeBSD.

2007-10-05 11:36  castaglia

	* doc/contrib/mod_ban.html:
	  Document the new ClientConnectRate BanOnEvent rule.

2007-10-05 11:33  castaglia

	* NEWS, contrib/mod_ban.c:
	  Bug#2979 - Ability to ban clients which connect too often.

2007-10-05 10:33  castaglia

	* modules/mod_core.c:
	  Removing support for the deprecated DisplayFirstChdir directive;
	  it has been replaced with the DisplayChdir directive.

2007-10-05 10:25  castaglia

	* contrib/mod_sql.c:
	  Removing deprecated SQLHomedirOnDemand directive; it has been
	  superceded by the CreateHome directive.

2007-10-05 10:22  castaglia

	* modules/mod_xfer.c:
	  Removing support for the deprecated HiddenStor directive; it has
	  been superceded by the HiddenStores directive.

2007-10-05 10:13  castaglia

	* doc/contrib/mod_ctrls_admin.html:
	  Document the new 'dns clear cache' ftpdctl command.

2007-10-05 10:08  castaglia

	* NEWS, contrib/mod_ctrls_admin.c, include/netaddr.h,
	  src/ftpdctl.c, src/main.c, src/netaddr.c:
	  Bug#2925 - Add caching of IP address and DNS name lookups.

2007-10-05 10:04  castaglia

	* src/auth.c:
	  Forgot semicolon.

2007-10-05 10:00  castaglia

	* NEWS, include/auth.h, src/auth.c, src/table.c:
	  Bug#2984 - mod_auth_file uid2name() does not cache results
	  causing slow LIST response.

2007-10-05 09:57  castaglia

	* configure:
	  Updating configure.

2007-10-05 09:55  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_auth_unix.c:
	  Bug#2983 - Use getgrouplist(3) for group lookup, if available.

2007-10-05 09:48  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2969 - Allow APPE after REST.

2007-10-05 09:44  castaglia

	* doc/contrib/mod_tls.html:
	  Document the new EnableDiags TLSOption.

2007-10-05 09:42  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2978 - Support more verbose OpenSSL diagnostic logging.

2007-10-05 09:40  castaglia

	* include/version.h:
	  Start of a new release cycle (1.3.2).

2007-10-05 08:47  castaglia

	* NEWS:
	  Forgot to update NEWS with the release time.

2007-10-05 08:40  castaglia

	* ChangeLog:
	  Updating the ChangeLog.

2007-10-05 08:38  castaglia

	* doc/: Configuration.html, Configuration.pdf:
	  Updating the HTML page with the configuration directives.  Also
	  added a PDF copy of the same information (thanks Sven!).

2007-10-05 08:15  castaglia

	* contrib/dist/rpm/proftpd.spec, include/version.h:
	  Updating version for 1.3.1-stable.

2007-10-04 10:04  castaglia

	* contrib/mod_tls.c:
	  Log a PID as an explicit unsigned int, not an implicit int.
	  Quells a compiler warning about mismatched printf arguments.

2007-10-04 10:01  castaglia

	* src/env.c:
	  Quell a compiler warning about casting away the const qualifier,
	  on systems which support the putenv(3) function.

2007-10-04 09:24  castaglia

	* RELEASE_NOTES:
	  Updating the release notes, preparing for a release.

2007-10-03 19:25  castaglia

	* NEWS, contrib/dist/rpm/ftp.pamd, contrib/dist/rpm/proftpd.spec:
	  Bug#2795 - Improvements to RPM .spec file to build more of the
	  modules, plus better optional packaging organization.

2007-10-03 18:46  castaglia

	* include/table.h:
	  Correct comment in table.h.

2007-10-02 15:29  castaglia

	* doc/howto/TLS.html:
	  Add mention of RFC 2228, and URL, to TLS doc.

2007-10-01 14:41  castaglia

	* modules/mod_delay.c:
	  Update the trace message for the other location in mod_delay
	  where the DelayTable is mapped into memory.

2007-10-01 14:25  castaglia

	* modules/mod_delay.c:
	  Log the table size, and the table fd, when attempting to map a
	  DelayTable into memory.

2007-10-01 09:40  castaglia

	* doc/modules/mod_delay.html:
	  Change to using relative URLs, so that the documentation can be
	  used outside of a network connection.

2007-10-01 08:14  castaglia

	* doc/modules/mod_delay.html:
	  Add notes about mod_delay usage to the mod_delay documentation.

2007-09-30 16:38  castaglia

	* src/timers.c: Catch edge case where the timers list may be
	  empty/null.

2007-09-30 14:05  castaglia

	* NEWS, src/main.c: Bug#2981 - Command-line long options --ipv4 and
	  --ipv6 do not work.

2007-09-27 17:53  castaglia

	* modules/mod_ls.c:
	  If an FTP client aborted the data transfer during a directory
	  listing, then a 226 response would be sent *twice*, e.g.:

	    226 Transfer complete
	    226 Abort successful

	  would be seen, using the ftp(1) client.  The problem was that
	  mod_ls, when closing its data connection, did not check to see if
	  the transfer had been aborted.  Aborted transfers should cause
	  the data connection to be closed "quietly", i.e. no sending of
	  the "Transfer complete" message.

	  With this change, mod_ls now checks for an aborted transfer, and
	  will close the data connection "quietly" when appropriate, thus
	  eliminating the duplicate 226 responses.

2007-09-27 17:47  castaglia

	* modules/mod_ls.c:
	  Cut down on logging an error if errno indicates "success";
	  usually this happens when the client aborted the directory
	  listing.

2007-09-27 09:13  castaglia

	* modules/mod_xfer.c:
	  Add some tracing to aborted transfers.

2007-09-27 09:04  castaglia

	* src/trace.c:
	  Add the 'xfer' channel to the list of default trace channels.

2007-09-25 09:27  castaglia

	* contrib/mod_tls.c:
	  No need to report on system call errors of "Success".

2007-09-24 19:16  castaglia

	* contrib/mod_tls.c:
	  Allow handling of the PROT command after the CCC command has been
	  used.  One particular FTPS client (lftp) is known to send PROT
	  (again) after CCC.

2007-09-18 20:22  castaglia

	* doc/howto/TLS.html:
	  Minor formatting tweak.

2007-09-18 20:14  castaglia

	* doc/howto/TLS.html:
	  Add FAQ about a commonly-seen error in the TLSLog, and how using
	  the NoCertRequest TLSOption may help.

2007-09-17 10:36  castaglia

	* NEWS, modules/Makefile.in:
	  Bug#2974 - Install error if multiple modules, using their own
	  build script, are built as shared modules.

2007-09-14 09:08  castaglia

	* modules/mod_core.c:
	  When handling an EPSV command, close any existing data connection
	  first.  Related to Bug #2900.

2007-09-13 14:32  castaglia

	* contrib/mod_tls.c:
	  Just as we don't want to call EVP_cleanup(3) at session
	  initialization time if there are other OpenSSL-using modules
	  around, we don't want to unload the human-readable OpenSSL error
	  strings, either.

2007-09-13 08:25  castaglia

	* contrib/mod_tls.c:
	  Alter the conditions under which mod_tls calls EVP_cleanup(3).
	  Call the function when mod_tls is being unloaded, or when the
	  session is exiting, without reservation.  If however the FTP
	  session is being initialized, and mod_tls has been compiled but
	  not enabled (i.e. the TLSEngine is off or not present), *and* any
	  other known OpenSSL using modules (i.e.  mod_ldap and mod_sql)
	  are present, do NOT call EVP_cleanup().  Doing so might deprive
	  those other modules of OpenSSL functionality unnecessarily.

	  Patch suggested by Nigel Kukard a while ago.

2007-09-13 08:22  castaglia

	* contrib/mod_sql.c:
	  Adding some logging about various error cases when using OpenSSL
	  digests for authentication; these were contributed by Nigel
	  Kukard a while ago.

2007-09-13 07:57  castaglia

	* modules/mod_dso.c:
	  Fix compiler warning about redeclaring a variable if Controls
	  support is enabled.

2007-09-12 11:08  castaglia

	* doc/howto/Vhost.html:
	  Remove mention of the now-deprecated Bind directive.

2007-09-11 19:24  castaglia

	* contrib/mod_tls.c:
	  When initializing mod_tls, check the version of the OpenSSL
	  headers used against the version of the OpenSSL library used.
	  Refuse to load the module unless the versions match properly.
	  (This will help catch systems where mismatched versions of
	  headers and libraries are used inadvertently.)

2007-09-11 15:58  castaglia

	* modules/mod_dso.c:
	  Add trace logging of the succesful loading of modules/files.

2007-09-11 10:47  castaglia

	* modules/mod_core.c:
	  If the admin has specified "UseUTF8 off" in the proftpd.conf
	  file, be sure to remove the UTF8 listing from the FEAT output.
	  Otherwise, clients might be a little confused.

2007-09-10 17:52  castaglia

	* contrib/mod_sql.c:
	  Cast the off_t value of total_xfer_bytes properly, and quell
	  warnings from picky compilers.

2007-09-10 17:49  castaglia

	* src/log.c:
	  When writing to utmp/wtmp logs, we're really not concerned if we
	  fail to truncate the file as requested.

2007-09-10 17:47  castaglia

	* modules/mod_log.c:
	  If there was a problem writing to the ExtendedLog fd, be sure to
	  log it using proftpd's logging (and hope that that write()
	  succeeds).

2007-09-10 17:44  castaglia

	* modules/mod_delay.c:
	  Inform picky compilers that we will be ignoring the return value
	  from write(2).  This may not be the best behavior, but it is what
	  we are doing.

2007-09-10 17:42  castaglia

	* modules/mod_xfer.c:
	  Make sure to cast the restart_pos value (an off_t), in order to
	  satisfy picky compilers.

2007-09-10 15:55  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Fix syntax of RPM options for some modules.

2007-09-07 17:13  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Update the RPM spec file to include the mod_wrap2 modules,
	  mod_ban, mod_ctrls_admin, mod_site_misc, and the NLS capability.

2007-09-07 09:13  jwm

	* contrib/mod_ldap.c: Fix anonymous binds when
	  draft-ietf-ldapext-ldap-c-api-04 functions are used.

	  Submitted by: Quentin Garnier <cube@cubidou.net>

2007-09-04 14:14  castaglia

	* contrib/mod_tls.c:
	  The implementation of the fix for Bug #2686 missed a few places
	  where we need to lookup one of the TLSRequired settings.

2007-08-29 19:00  castaglia

	* modules/mod_xfer.c:
	  Clean up the code style in the xfer_stor() function.	Also add
	  logging of the case where an lseek() fails for some reason.

2007-08-29 10:47  castaglia

	* doc/howto/SQL.html:
	  Added SQL FAQ about shared library loader errors.

2007-08-24 08:07  castaglia

	* doc/howto/Debugging.html:
	  Mention using `proftpd -V' in the Debugging howto.

2007-08-22 07:50  castaglia

	* src/: fsio.c, netio.c:
	  Surround the invocation of function pointers with parentheses, to
	  help some (broken, IMHO) code introspection tools to be able to
	  read the code better.

2007-08-21 19:00  jwm

	* contrib/mod_ldap.c: missed version number

2007-08-21 15:36  castaglia

	* NEWS, lib/sstrncpy.c:
	  Bug#2964 - Building RPM fails because of *snprintf trying to be
	  redefined.

2007-08-17 14:41  jwm

	* contrib/mod_ldap.c: release 2.8.17

2007-08-09 15:56  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2963 - Use of -A option for LIST/NLST commands not cleared
	  for subsequent commands.

2007-08-09 15:16  castaglia

	* README.facl:
	  Remove extraneous whitespace.

2007-08-03 07:52  castaglia

	* NEWS, contrib/mod_wrap2_file.c, contrib/mod_wrap2_sql.c,
	  contrib/mod_wrap2/mod_wrap2.c, contrib/mod_wrap2/mod_wrap2.h.in:
	  Bug#2958 - mod_wrap2 does not handle multiple rules in access
	  files.

2007-07-31 15:08  castaglia

	* modules/mod_auth.c:
	  Coding style changes; no functional change.

2007-07-31 08:17  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#2955 - Undeclared identifier MAP_FAILED for mod_delay on AIX.

2007-07-24 15:09  castaglia

	* NEWS, src/dirtree.c:
	  Bug#2950 - Hostname with multiple IP addresses might cause
	  "ai_family not supported" error if IPv6 support enabled.

2007-07-19 11:12  castaglia

	* NEWS, src/proctitle.c:
	  Bug#2947 - SIGBUS on Mac OS X when dynamically loading shared
	  libs.  The solution is to set argv elements to the empty string,
	  rather than NULL, so that stupid libraries which grovel around in
	  argv without checking for NULL pointers don't crash.	Silly
	  libraries.

2007-07-18 09:41  castaglia

	* NEWS, modules/mod_facl.c:
	  Bug#2946 - Anonymous logins fail if the mod_facl module is
	  enabled.

2007-07-07 07:24  jwm

	* contrib/mod_ldap.c:	mod_ldap 2.8.17-20070707:
	      fix LDAPServer handling; config_rec argv arrays don't contain
	  the
	      directive name in index 0.

2007-07-06 15:40  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Correct misspellings.

2007-07-06 09:51  castaglia

	* NEWS, contrib/mod_sql_mysql.c:
	  Bug#2944 - mod_sql_mysql fails to compile due to missing
	  quotation.

2007-07-05 08:18  castaglia

	* NEWS, include/version.h:
	  Reset files for 1.3.1rc4.

2007-07-04 12:34  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2007-07-04 12:33  castaglia

	* contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for 1.3.1rc3 release.

2007-07-04 12:27  castaglia

	* RELEASE_NOTES:
	  Updating the release notes, getting ready for a release.

2007-07-04 11:08  castaglia

	* contrib/mod_wrap2_file.c:
	  A recent innocuous change to mod_wrap2_file turned out to be not
	  so innocuous; a static buffer was made non-static, and terror and
	  madness ensued.  To fix this (and avoid the distasteful static
	  buffer), mod_wrap2_file now makes duplicates of the parsed
	  buffers using the table pool (for just such purposes).  This
	  patch also cleans up the handling of the service and client lists
	  in the file.

2007-07-02 16:20  jwm

	* contrib/mod_ldap.c: 2.8.17-20070701:	 don't use a separate
	  directive (LDAPURL) to specify LDAP URLs; support   them in
	  LDAPServer instead - add ldap url support, via the LDAPURL
	  directive - add ldaps (ldap over ssl) support, via the LDAPUseSSL
	  directive and   ldaps:// scheme to LDAPURL - refine tls debugging
	  statement

2007-07-02 13:27  castaglia

	* RELEASE_NOTES:
	  Updating release notes.

2007-07-02 11:09  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  Make sure that mod_wrap2 honors the runtime UseIPv6 configuration
	  directive.

2007-06-28 10:41  castaglia

	* doc/howto/Timestamps.html:
	  Add a little more substance to the Timestamps howto, to remind
	  readers that they need to think for themselves a little, and read
	  their system docs.

2007-06-28 08:52  castaglia

	* modules/mod_auth.c:
	  The clearing of any cached directory config pointers, as a fix
	  for Bug #2939, was a little too aggressive.  We only need to
	  clear those pointers once, prior to calling setup_env().

2007-06-25 15:55  castaglia

	* contrib/mod_wrap2_file.c:
	  Attempt to log a more informative message if a too-long multiline
	  is found.  Also add support for allocating a larger buffer for
	  such lines at compile time.

2007-06-25 10:19  castaglia

	* NEWS, contrib/mod_ban.c:
	  Bug#2942 - BanLog directive does not accept "none" parameter.

2007-06-25 08:10  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2939 - Anonymous restrictions apply after a failed anonymous
	  login followed by a successful normal user login.

2007-06-18 19:04  castaglia

	* NEWS:
	  Fix typos.

2007-06-18 14:45  castaglia

	* doc/howto/Quotas.html:
	  Add a FAQ about group quota determination.

2007-06-12 11:57  castaglia

	* src/auth.c:
	  Yet another patch, working on the PAM-related fallout from Bug
	  #2922.

2007-06-12 10:41  castaglia

	* modules/mod_auth_file.c:
	  Remove some debug logging which inadvertently crept into
	  mod_auth_file.

2007-06-11 17:59  castaglia

	* contrib/mod_sql.c:
	  For symmetry, log a message in the SQLLogFile when a particular
	  SQLAuthType handler fails.  This complements the log message
	  already written when the handler indicates success.

2007-06-11 08:28  castaglia

	* NEWS, contrib/mod_wrap2/mod_wrap2.c:
	  Bug#2938 - mod_wrap2 does not honor WrapTables for <Anonymous>
	  logins.

2007-06-06 17:30  castaglia

	* contrib/: mod_ifsession.c, mod_rewrite.c:
	  Add reporting of the module version for the mod_ifsession and
	  mod_rewrite modules.

2007-06-04 16:53  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2935 - DELE command doesn't check file stat result before
	  logging.

2007-06-03 20:57  jwm

	* contrib/mod_ldap.c: 2.8.17-20070603: * Use non-deprecated LDAP
	  API functions if the LDAP SDK is new enough to   comply with
	  draft-ietf-ldapext-ldap-c-api-04.

2007-05-30 08:52  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2900 - Some kernels incorrectly reuse IPv6 ports for EPSV
	  command.  Rather than relying on untrusted kernel behavior (i.e.
	  assigning a random _unused_ port if port zero is used in a bind()
	  call), proftpd now explicitly chooses a random port (using the
	  same technique as used for PassivePorts) when handling the EPSV
	  command.  Note that the PassivePorts directive still works
	  properly for this port selection.

2007-05-25 17:26  castaglia

	* doc/howto/Quotas.html:
	  Add a FAQ about the QuotaExcludeFilter directive.

2007-05-24 10:17  castaglia

	* doc/howto/Tracing.html:
	  No need for the quotations -- they're a bit much.

2007-05-24 10:15  castaglia

	* RELEASE_NOTES, doc/howto/Tracing.html, doc/howto/index.html:
	  Adding tracing howto.

2007-05-24 08:47  castaglia

	* src/help.c:
	  The list of commands displayed for the HELP command was being
	  truncated.  Fix suggested by Richard Gray.

2007-05-23 08:25  castaglia

	* README.PAM:
	  Update the PAM readme with notes for Linux, per Bug#2907.

2007-05-22 14:21  castaglia

	* NEWS, utils/ftptop.1.in, utils/ftptop.c:
	  Bug#2923 - ftptop display flickers if delay is greater than 25
	  seconds.  Simply accept only delay values between zero and 15
	  seconds.

2007-05-22 14:01  castaglia

	* configure:
	  Updating configure.

2007-05-22 13:54  castaglia

	* NEWS, config.h.in, configure.in, src/fsio.c:
	  Bug#2934 - Function perm_copy_fd() not in older Linux libacl
	  versions.  Test for that function, and use acl_get_fd(3) and
	  acl_set_fd(3) if not present.

2007-05-22 10:45  castaglia

	* include/options.h:
	  Minor style nit.  No functional change.

2007-05-21 09:10  castaglia

	* src/inet.c:
	  Use tracing to log if there was a problem using getsockopt() to
	  get the IPV6_V6ONLY option.

2007-05-21 09:04  castaglia

	* NEWS, src/inet.c:
	  Bug#2932 - Syslog contains "error setting IPV6_V6ONLY: Protocol
	  not available".

2007-05-21 08:30  castaglia

	* doc/howto/Directory.html:
	  Include RNTO in the list of FTP commands affected by trailing
	  "/*" suffixes in <Directory> lines.

2007-05-21 08:19  castaglia

	* src/auth.c:
	  Additional patch for Bug#2922, to check for and use mod_auth_pam
	  for authentication, if present (and usable).

2007-05-21 07:39  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2890 - SystemLog permission errors on SIGHUP when mod_tls is
	  enabled.

2007-05-18 18:51  castaglia

	* modules/mod_facl.c:
	  Use the event handler defined for the "core.module-unload" event,
	  when compiled as a DSO module.

2007-05-16 08:25  castaglia

	* modules/mod_facl.c:
	  Declare the facl_module variable before using it.  This isn't a
	  problem for most builds, but for proftpds built with DSO support
	  and with a DSO mod_facl, it's a compilation error.

2007-05-15 10:35  castaglia

	* src/netio.c:
	  More work towards Bug#2920.  Hopefully this will be the last of
	  that particular issue.

2007-05-14 19:23  castaglia

	* modules/mod_xfer.c:
	  Short-circuit out of xfer_rate_throttle() early, if the transfer
	  has already been aborted.

2007-05-14 19:11  castaglia

	* doc/howto/Timestamps.html:
	  Adjust link to mod_site_misc docs to use the local copy.

2007-05-14 19:08  castaglia

	* doc/howto/Timestamps.html:
	  Start adding a FAQ section about timezones and timestamps.

2007-05-14 17:41  castaglia

	* modules/mod_xfer.c, src/data.c:
	  More checks of XFER_ABORTED, in pursuit of a solution for
	  Bug#2920.

2007-05-14 14:34  castaglia

	* modules/mod_xfer.c:
	  Attempt to handle aborted transfers that were in the midst of
	  being throttled.

2007-05-14 14:31  castaglia

	* modules/mod_xfer.c:
	  Do not block SIGURG (used to abort transfers) when handling
	  throttled transfers.

2007-05-10 15:47  castaglia

	* NEWS, modules/mod_xfer.c, src/data.c, src/inet.c, src/netio.c:
	  Bug#2920 - ABOR command not handled during data transfer.
	  Bug#2924 - DeleteAbortedStores doesn't work when the ABOR command
	  is used.

2007-05-10 14:55  castaglia

	* src/: inet.c, netio.c:
	  Add tracing of aborted connections.  Also corrects an issue where
	  a lingering close was happening *twice*, once per stream (input
	  and output), whereas only one lingering close (or lingering
	  abort) is needed.

	  Came out of investigating Bug#2920.

2007-05-10 14:49  castaglia

	* src/main.c:
	  Add tracing of received FTP commands.

2007-05-09 10:15  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Check to see if the SQL backend module (either MySQL or Postgres)
	  has been properly initialized, prior to attempting to use the
	  connection pool.  Failure to do so, in inadvertently
	  misconfigured proftpds, was leading to NULL pointer dereference
	  segfaults.

2007-05-07 08:35  castaglia

	* NEWS, modules/mod_auth.c, modules/mod_core.c, modules/mod_xfer.c:

	  Bug#2864 - DisplayLogin should work regardless of chroot.  This
	  feature includes DisplayQuit and DisplayTransferFiles as well.

	  To make this work, the configured Display files must use absolute
	  paths.  ProFTPD will then open an fd on those files, prior to
	  chroot(2), such that the fds, on paths outside of the chroot(),
	  are accessible once the process has been chrooted.

2007-05-04 10:10  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2921 - NLST fails if using POSIX ACLs.

2007-05-04 10:05  castaglia

	* modules/mod_facl.c:
	  Add more tracing of POSIX ACL functions, particularly on BSD and
	  Linux, in order to get better views of errors.  Fix some stupid
	  printf format thinkos.  Add function to convert between a mode_t,
	  used for access(2), to an acl_perm_t, used for acl_get_perm(2) on
	  BSD and Linux.

	  Hopefully this clears up some of the issues for Bug #2661.

2007-04-30 10:47  castaglia

	* modules/mod_facl.c:
	  Fix the initialization of mod_facl's configuration directives.
	  Oops.

2007-04-24 09:12  castaglia

	* src/netio.c:
	  Guard against using negative numbers when calling FD_SET.  The
	  FD_SET macro expects an fd, and if that fd is less than zero, the
	  results are unpredictable (crashes, silent failures, just works,
	  hangs, etc).

2007-04-18 08:31  castaglia

	* modules/mod_facl.c:
	  More tracing of POSIX ACLs on Solaris.  Looks like the
	  implementation changed on Solaris 10 for certain filesystems
	  (ZFS, NFSv4).

2007-04-17 14:33  castaglia

	* NEWS, include/auth.h, modules/mod_core.c, src/auth.c:
	  Bug#2922 - Auth API allows one auth module to authenticate user
	  data provided by a different auth module.

2007-04-17 14:03  castaglia

	* src/fsio.c:
	  Include the paths in the trace messages about which FS is used
	  for a given filesystem access call.  This will be useful in
	  developing and debugging FSIO modules, e.g. mod_facl.

2007-04-15 20:07  castaglia

	* sample-configurations/mod_sql.conf: Do not use 'Plaintext' as a
	  example SQLAuthTypes parameter, since too many people blindly
	  copy examples as-is, then blame you for the consequences.

2007-04-02 15:22  castaglia

	* src/inet.c:
	  Allow data transfers on low-numbered sockets to work on SCO Unix.

2007-04-02 09:32  castaglia

	* NEWS, modules/mod_ls.c, src/data.c:
	  Bug#2911 - NLST on a nonexistent path, followed by an NLST on an
	  existing file, causes segfault.

2007-03-27 20:49  castaglia

	* src/parser.c:
	  Cleanup pr_parser_cleanup().	First, return EPERM if the parser
	  stack is not in a state when it can be properly cleaned up.
	  Second, reset stack pointers to NULL even when there is no parser
	  pool provided.

2007-03-27 20:33  castaglia

	* src/parser.c:
	  Tag the temporary pool right after its creation, not after it has
	  been used.

2007-03-27 20:24  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2913 - TYPE command does not clear ASCII flag from LIST/NLST
	  commands.

2007-03-27 19:58  castaglia

	* contrib/mod_rewrite.c:
	  Updating coding style in a few places.  No functional change.

2007-03-26 17:35  castaglia

	* config.guess, config.sub, contrib/mod_load/config.guess,
	  contrib/mod_load/config.sub, lib/libltdl/config.guess:
	  Updated the config.guess and config.sub scripts, used by the
	  configure script for platform detection, to the versions shipped
	  with autoconf-2.61.

2007-03-21 20:54  castaglia

	* src/dirtree.c:
	  Formatting tweaks, no functional change.

2007-03-09 11:01  castaglia

	* sample-configurations/: anonymous.conf, basic.conf,
	  complex-virtual.conf, mod_sql.conf:
	  Update the example config files to use DisplayChdir, rather than
	  the deprecated DisplayFirstChdir directive.

2007-03-09 08:20  castaglia

	* modules/mod_core.c:
	  Bar configurations like:

	    PassivePorts 2222 2222

	  where the max and min port numbers are the same; it's a useless
	  configuration.

2007-03-06 10:30  castaglia

	* doc/contrib/mod_ban.html:
	  Add a FAQ about using a delay, rather than session termination,
	  for banned clients, and why that is a bad idea.

2007-03-06 09:55  castaglia

	* README.PAM:
	  Typo.

2007-03-01 08:07  castaglia

	* NEWS:
	  Fix typo noted by Sven.

2007-02-21 15:04  jwm

	* contrib/mod_ldap.c: - bump version - previous commit wrt LDAPAttr
	  fetching was submitted by TJ Saunders   <tj@castaglia.org>; got a
	  little fresh with my editor and missed the paste

2007-02-21 15:02  jwm

	* contrib/mod_ldap.c: fetch attribute redefinitions (LDAPAttr)
	  before using any attribute names, such as when generating the
	  default search filters

2007-02-21 14:58  jwm

	* contrib/mod_ldap.c: wordwrap, error message tweak

2007-02-20 14:01  castaglia

	* doc/contrib/: mod_quotatab_radius.html, mod_radius.html:
	  Fix the documentation for the RadiusQuotaInfo.

2007-02-20 09:07  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#2906 - RewriteCondition backreferences not properly
	  substituted.

2007-02-19 20:46  castaglia

	* NEWS, modules/mod_xfer.c: Bug#2902 - Stack read overrun in
	  mod_xfer on 32bit platform.  Use an explicit compiler cast to
	  ensure that the proper data type size is used in the arguments
	  for a variadic function.

2007-02-19 20:39  castaglia

	* contrib/mod_quotatab_radius.c: Need to include mod_quotatab.h,
	  which includes the ProFTPD headers, before doing the ProFTPD
	  version check.

2007-02-16 08:36  castaglia

	* doc/howto/TLS.html:
	  Add FAQ about SSL/TLS renegotiations, and how some FTPS clients
	  do not handle them well.

2007-02-15 11:02  castaglia

	* RELEASE_NOTES:
	  Note new doc for 1.3.1rc3 release, whenever that is.

2007-02-15 11:00  castaglia

	* doc/howto/: Timestamps.html, index.html:
	  Add a document talking about timestamps and chroots (see Bug
	  #2717, Bug #2896).

2007-02-15 09:56  castaglia

	* configure:
	  Updated configure.

2007-02-15 09:54  castaglia

	* lib/pr-syslog.c, src/support.c:
	  Use the feature macro to determine if tzname is actually present
	  to be guarded.

2007-02-15 09:52  castaglia

	* config.h.in, configure.in:
	  We're really only concerned with the tzname global variable, not
	  with the timezone and daylight global variables.  For now,
	  anyway.

2007-02-15 09:48  castaglia

	* config.h.in, configure.in:
	  Be defensive, and add autoconf detection for the tzname,
	  timezone, and daylight global variables.

2007-02-15 09:01  castaglia

	* contrib/mod_quotatab.c, contrib/mod_radius.c,
	  contrib/mod_rewrite.c, contrib/mod_sql.c, contrib/mod_tls.c,
	  contrib/mod_wrap2/mod_wrap2.c, modules/mod_ctrls.c,
	  src/support.c, src/trace.c:
	  Replace calls to localtime(3) throughout the proftpd code with
	  calls to pr_localtime().

2007-02-15 08:54  castaglia

	* src/log.c:
	  Missed a call to localtime(3) that needs to replaced with
	  pr_localtime().

2007-02-15 08:46  castaglia

	* modules/mod_log.c, src/ftpdctl.c, src/log.c:
	  Update mod_log and the core logging to use pr_localtime(), which
	  guards against localtime(3) resetting the tzname global variable
	  to an unexpected/wrong timezone (i.e. GMT) in a chrooted process.

2007-02-15 08:43  castaglia

	* src/support.c:
	  Update pr_localtime() so that it no longer requires a pool.  If a
	  pool is provided, it will be used, otherwise, the struct tm *
	  from localtime(3) will be returned as is.

2007-02-14 17:40  castaglia

	* src/support.c:
	  For functions which use pr_localtime() (and there should be more
	  of them), protect the tzname global variable values, to guard
	  against localtime(3) twiddling with the tzname variable.  This
	  twiddling causes weird values once the process is chrooted.

2007-02-14 17:31  castaglia

	* modules/mod_log.c:
	  Remove a section of code which relies on a macro, HAVE_GMTOFF,
	  which has not be defined by proftpd's configure script in who
	  knows how long.

	  This investigation was prompted by looking into Bug #2896.

2007-02-14 17:23  castaglia

	* src/: ftpdctl.c, log.c:
	  When writing to the log fd, check for errors, and specifically
	  try the write(2) call again if the call was interrupted.

2007-02-13 08:29  castaglia

	* modules/mod_xfer.c:
	  Forgot to log one of the reasons for not using sendfile():
	  UseSendfile set to 'off'.

2007-02-13 08:17  castaglia

	* modules/mod_xfer.c:
	  Add debug logging, level 10, showing when sendfile is used, or
	  isn't used.  And if sendfile isn't used, log the reason.

2007-02-13 08:00  castaglia

	* src/dirtree.c:
	  Fix typo.

2007-02-12 11:43  castaglia

	* src/dirtree.c:
	  A further optimization, suggested by Glenn Nielsen.  In the
	  find_best_dir() function, the paths being compared always come
	  from c->name, which means that it's actually OK to do direct
	  pointer comparison, rather than using strcmp().  Only time will
	  tell whether this is a too-clever optimization.

2007-02-12 11:28  castaglia

	* src/dirtree.c:
	  Make some minor optimizations to the dir_match_path() function.
	  Specifically, call strlen() only once when necessary (rather than
	  multiple times), and reorder checks such that strcmp() checks,
	  the most expensive of the checks, are done *last*, rather than
	  first.  The goal is to scan the directory path string as few
	  times as possible; given many such directory path strings, each
	  scan adds up.

2007-02-12 09:16  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#2897 - mod_quotatab subtracts size of deleted file from
	  bytes-transferred tally.

2007-02-08 11:11  castaglia

	* modules/mod_auth.c:
	  Add explanatory comment about checks for session.gids,
	  session.groups.

2007-02-08 09:24  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2893 - ProFTPD can use the wrong group data if the user name
	  changes.

2007-01-19 15:01  castaglia

	* NEWS, modules/mod_lang.c:
	  Bug#2883 - Problem with locale and SQL database queries.

2007-01-19 14:52  castaglia

	* locale/files.txt:
	  Update the list of source files in locale/files.txt.

2007-01-19 14:51  castaglia

	* locale/Makefile.in:
	  Fixed typos in command used to generate files.txt.

2007-01-19 13:59  castaglia

	* NEWS, include/modules.h, modules/mod_core.c, modules/mod_lang.c,
	  src/main.c, src/modules.c:
	  Bug#2881 - ProFTPD does not support OPTS UTF8 command when
	  --enable-nls is used.

2007-01-18 08:08  castaglia

	* src/trace.c:
	  The list of channel names should be named 'trace_channels', not
	  'trace_levels'.  What was I thinking?

2007-01-17 18:48  castaglia

	* NEWS, include/conf.h, include/lastlog.h, include/log.h:
	  Bug#2878 - Error compiling proftpd on Solaris 2.9 using
	  --with-lastlog.

2007-01-17 18:14  castaglia

	* contrib/mod_tls.c:
	  Update mod_tls to use the pr_env_* functions.  This also
	  eliminates a lot of #ifdef PR_USE_DEVEL checks in the mod_tls
	  code -- hooray!

2007-01-17 18:11  castaglia

	* include/env.h, src/env.c:
	  Add some documentation to the pr_env_* functions in the header.
	  Also beef up the code in env.c, such that it is prepared for
	  memory checker programs (e.g. Valgrind) in cases where
	  --enable-devel is used.  This makes it possible to clean up some
	  ugly #ifdef checks elsewhere (e.g.  mod_tls).

2007-01-17 11:50  castaglia

	* contrib/mod_sql.c:
	  Update mod_sql.c to use pr_env_get() rather than getenv(3).

2007-01-17 11:38  castaglia

	* configure:
	  Updated configure.

2007-01-17 11:32  castaglia

	* contrib/mod_tls.c, configure.in, src/main.c, src/proctitle.c:
	  The proper macro to use is PR_USE_DEVEL, not PR_DEVEL.

2007-01-17 10:48  castaglia

	* configure:
	  Updated configure.

2007-01-17 10:34  castaglia

	* configure.in:
	  Add printing of "checking for" messages when scanning for the
	  list of usual suspects of lastlog locations.

	  Related to Bug #2878.

2007-01-17 10:16  castaglia

	* configure:
	  Updated configure.

2007-01-17 10:12  castaglia

	* configure.in:
	  Fix the configure script to properly use the pr_lastlog_path
	  variable (it was using spaces around the '=' operator, which the
	  shell may not like).

	  Part of Bug #2878.

2007-01-17 09:44  castaglia

	* include/lastlog.h:
	  Error out of the build process if PR_LASTLOG_PATH has not been
	  defined in one form or another.  Include a slightly more
	  informative error message, so that it's better than some cryptic
	  compiler error later, when compiling lastlog.c.

	  Part of the fixes for Bug #2878.

2007-01-17 07:39  castaglia

	* NEWS, src/inet.c:
	  Bug#2877 - ServerType 'inetd' results in "getnameinfo error:
	  ai_family not supported" errors in log.

2007-01-16 21:33  castaglia

	* src/main.c: Remove the redundant is_standalone variable; it can
	  be replaced with checks against the global variable ServerType.

2007-01-16 11:58  castaglia

	* Makefile.in:
	  The -lsupp LIBS flag is now populated in the UTILS_LIBS variable,
	  so there is no need for the hardcoded flag as well.

2007-01-16 11:54  castaglia

	* src/main.c:
	  A bad patch mixed up the ordering of settings displayed via
	  show_settings().

2007-01-16 11:53  castaglia

	* src/env.c:
	  Fix bug in pr_env_set() on systems that have putenv(3) rather
	  than setenv(3).

2007-01-15 15:55  castaglia

	* configure: Updated configure.

2007-01-15 15:51  castaglia

	* configure.in: Do not scan a mod_foo.h.in file, assuming a
	  module-specific subdirectory, for build system hints.  A .in file
	  needs to be processed (as via the module's own configure script),
	  and should not be scanned until after that processing.

2007-01-15 15:49  castaglia

	* NEWS: Forgot to list Bug #2875 in the NEWS file.

2007-01-15 14:21  castaglia

	* modules/mod_ctrls.c: Use a socklen_t, rather than a size_t, for
	  accept(2).

2007-01-14 17:33  castaglia

	* configure: Updated configure.

2007-01-14 17:30  castaglia

	* configure.in: Bug#2875 - Malformed getopt checks cause
	  compilation errors in getopt.c.

2007-01-13 16:18  castaglia

	* configure: Updated configure.

2007-01-13 16:16  castaglia

	* configure.in: There's no need to define PR_USE_SENDFILE as zero.

2007-01-12 22:12  castaglia

	* include/proctitle.h, src/main.c, src/proctitle.c: Move the
	  proctitle functions into the 'pr_' namespace, just to be safe
	  (and consistent).

2007-01-12 20:29  castaglia

	* doc/contrib/mod_quotatab.html:
	  Specify what I mean when I say "groups" and "classes".

2007-01-12 20:16  castaglia

	* include/pidfile.h, src/main.c, src/pidfile.c:
	  Move the pidfile functions into the 'pr_' namespace, so that they
	  don't collide with functions of the same names on systems whose
	  <libutil.h> system header defines them (with conflicting
	  prototypes).	Yay portability.

2007-01-12 20:14  castaglia

	* locale/.cvsignore:
	  Another .cvsignore file for locale/.

2007-01-12 10:54  castaglia

	* contrib/: mod_load/.cvsignore, mod_wrap2/.cvsignore:
	  Add .cvsignore files for the mod_load/ and mod_wrap2/
	  directories.

2007-01-12 10:51  castaglia

	* include/version.h:
	  Back to CVS status, for the next RC release.

2007-01-12 09:52  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2007-01-12 09:49  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for 1.3.1rc2 release.

2007-01-12 09:44  castaglia

	* RELEASE_NOTES:
	  Adding release notes for 1.3.1rc2.

2007-01-12 09:33  castaglia

	* doc/howto/TLS.html:
	  Add a mod_tls FAQ about the "no shared cipher" error.

2007-01-11 23:01  castaglia

	* src/fsio.c: In the case of successful chown() and chmod() calls,
	  clear the statcache, as the cached data may now be stale.

2007-01-11 21:40  castaglia

	* src/: env.c, pidfile.c, proctitle.c: Correct the license wording
	  to mention The ProFTPD Project as primary copyright holder.

2007-01-11 17:30  castaglia

	* Make.rules.in, include/conf.h, include/env.h, include/support.h,
	  src/env.c, src/support.c:
	  Refactored the pr_env_* routines into their own source and header
	  files.

2007-01-11 15:43  castaglia

	* src/ftpdctl.c:
	  Since src/ftpdctl.c has its own copy of sstrcat() and sstrncpy()
	  (itself a bad sign), it needs to have the same paranoid checks
	  added to those functions as were added to the core
	  implementations.

2007-01-11 15:08  castaglia

	* contrib/mod_ctrls_admin.c:
	  When 'ftpdctl shutdown' is used, include the number of sessions
	  being summarily terminated (after a grace period) in the
	  ControlsLog message.

2007-01-11 13:36  castaglia

	* Make.rules.in, include/conf.h, include/pidfile.h, src/main.c,
	  src/pidfile.c:
	  More refactoring of src/main.c.  Now the PID file routines
	  (writing and removing the pidfile) are separated out.

2007-01-11 11:16  castaglia

	* Make.rules.in, include/conf.h, include/proctitle.h, src/main.c,
	  src/proctitle.c:
	  The src/main.c file is a bit hairy mess, and in desperate need of
	  refactoring.	This moves the process title functions into their
	  own proctitle.c file, with accompanying header.

2007-01-11 10:21  castaglia

	* contrib/mod_sql.c:
	  Another in the series of patches for Bug#2869, this one makes
	  sure that sites which use the 'fast' parameter in SQLAuthenticate
	  still operate properly.

2007-01-10 20:09  castaglia

	* src/pool.c:
	  The bytes_in_block_list() function should be #ifdef'd as well
	  behind PR_USE_DEVEL.

2007-01-10 20:05  castaglia

	* include/compat.h, include/dirtree.h, include/fsio.h,
	  include/pool.h, src/dirtree.c, src/fsio.c, src/main.c,
	  src/pool.c:
	  Move a lot of functions, either existing or new, behind
	  PR_USE_DEVEL checks, since a lot of functions are meant only for
	  the debugging purposes of proftpd developers.  (Hopefully this
	  will make the resulting proftpd executable slightly smaller.)
	  There will be more such debugging functions added; they are meant
	  as hooks utilized by a mod_debug module (again, only for
	  developer use).

	  The only user-visible change in this is that the SIGUSR2 signal,
	  when sent to a proftpd process, would cause that process to print
	  out a trace of its memory pool usage.  Now, a SIGUSR2 signal will
	  cause an event to be generated -- but the printing of the memory
	  pool usage is gone.  I may add that back at some point, if/when
	  there is a hue and cry raised.

2007-01-09 20:55  castaglia

	* configure:
	  Updated configure.

2007-01-09 19:45  castaglia

	* configure.in:
	  Thinko.

2007-01-09 19:19  castaglia

	* Make.rules.in, lib/Makefile.in:
	  Put the declarations for ar and ranlib in a place that's visible
	  to contrib modules (namely, Make.rules).  Update the lib/Makefile
	  to use that location; while I'm at it, remove the stale
	  dependency listings from lib/Makefile.

2007-01-09 19:17  castaglia

	* configure:
	  Updated configure.

2007-01-09 19:16  castaglia

	* contrib/mod_load/: config.guess, config.sub:
	  The configure script for the mod_load module requires the
	  config.sub and config.guess helper scripts.

2007-01-09 19:07  castaglia

	* configure.in:
	  Check for the existence of the file before trying to cat it.

2007-01-09 18:25  castaglia

	* configure:
	  Updated configure.

2007-01-09 18:19  castaglia

	* Make.rules.in, Makefile.in, configure.in:
	  Even more build system magic.  With this change, we add support
	  for a new "hint" tag: $Archive$.  This particular tag is *only*
	  honored in a very particular situation: the contrib module uses
	  its own subdirectory (e.g.  contrib/mod_foo/) *and* that module
	  is being built as a static module.  Contrib modules built as
	  shared modules fall into different linking rules.

	  The purpose of this $Archive$ tag is to allow the Makefile for
	  that mod_foo module to be built from multiple source files, which
	  would result in multiple object files.  All of those object files
	  would need to be part of the command to link the final `proftpd'
	  executable.  (A shared module would not need to present for this
	  link step.)

	  Rather than have multiple object files from contrib modules, it
	  involves less files (though at the cost of more complexity) to
	  use a single archive file, e.g. mod_foo.a.  The Makefile for the
	  contrib module, for its "static" target, will thus need to
	  assemble a mod_foo.a archive from the various .o files.  When
	  this happens, the contrib module uses the $Archive$ hint (similar
	  to the $Libraries$ hint) to let proftpd's module build system
	  know to expect that archive file.

2007-01-09 12:08  castaglia

	* configure:
	  Updating configure.

2007-01-09 12:04  castaglia

	* configure.in:
	  More build system magic.  This allows contrib module developers,
	  who use their own module-specific subdirectory e.g.
	  contrib/mod_foo/, to have the $Libraries$ tags in their
	  mod_foo.c, mod_foo.h, or mod_foo.h.in files be properly picked up
	  by proftpd's build system, just as happens for a module in
	  contrib/mod_foo.c.

2007-01-08 20:19  castaglia

	* configure:
	  Updating configure.

2007-01-08 20:16  castaglia

	* contrib/: mod_load/Makefile.in, mod_wrap2/Makefile.in:
	  There's no need to redefine LIBS, then use it in the link
	  command.  Just use SHARED_MODULE_LIBS directly, and don't
	  obfuscate the matter.

2007-01-08 20:14  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Add DSO and lastlog support to the RPM spec.

2007-01-08 20:09  castaglia

	* Make.rules.in, configure.in, contrib/mod_load/Makefile.in,
	  contrib/mod_wrap2/Makefile.in:
	  Tweak the build system so that any LIBS specified on the
	  command-line are picked up when building shared modules whose
	  sources are in their own directory (e.g. mod_load, mod_wrap2).
	  This may sound like a bit of an edge case, but I suspect that it
	  will become a necessity once proftpd supports having contrib
	  modules that come with their own message catalogs (i.e. NLS
	  support), and thus may need to be linked against the libintl
	  library (which provides gettext() support).

2007-01-08 19:31  castaglia

	* src/modules.c:
	  Set errno to EINVAL, when appropriate, in a few places.

2007-01-08 18:14  castaglia

	* src/parser.c:
	  Paranoid checking of signals within a while loop, in case the
	  loop should decide to continue endlessly.

2007-01-08 14:59  castaglia

	* src/auth.c:
	  Make sure that dispatch_auth() does not loop endlessly, if there
	  are never any ERROR or HANDLED returns from the auth module
	  handlers.  Simply keep track of the starting table, and watch the
	  iterator table; when the two match, we have looped through the
	  auth handlers, and will assume that the entire auth command has
	  been DECLINED.

2007-01-08 11:58  castaglia

	* modules/Makefile.in, src/Makefile.in, utils/Makefile.in:
	  Remove crufty, outdated, and unnecessary dependency listings.

2007-01-08 11:50  castaglia

	* configure:
	  Updated configure.

2007-01-08 11:47  castaglia

	* config.h.in, configure.in, include/support.h, lib/getopt.h:
	  I discovered last night that proftpd's build system was not doing
	  as advertised.  Specifically, it continued to build the bundled
	  getopt implementation regardless of whether the host system had
	  its own getopt support.  (I discovered this on Mac OS X, whose
	  linker is apparently more picky that the one on my Linux machine,
	  and which was complaining of multiply defined _opt* symbols.)

	  This changes updates the build system so that it does as stated:
	  if the host system does not have getopt support, we use our own.

2007-01-07 22:52  castaglia

	* src/auth.c: Yet another while loop in need of signal handling.

2007-01-07 12:48  castaglia

	* contrib/dist/rpm/proftpd.spec: Add controls support to the RPM
	  spec.

2007-01-07 12:42  castaglia

	* contrib/dist/rpm/proftpd.spec: Include the installed header files
	  in the RPM spec.

	  Add ability for specifying mod_quotatab_file.

2007-01-05 19:25  castaglia

	* doc/howto/TLS.html:
	  Add documentation mentioning the CCC command, and how to
	  configure mod_tls such that command is allowed for FTPS clients.

2007-01-05 16:07  castaglia

	* contrib/mod_tls.c:
	  If the TLSRequired setting is such that the control connection
	  *cannot* be unprotected, then be sure to deny any CCC commands.

2007-01-03 23:26  castaglia

	* src/support.c: Fix dir_abs_path() such that it does not tack on
	  redundant directories to the end of a relative path.

2007-01-03 14:57  castaglia

	* modules/mod_auth_file.c:
	  Remember to use PR_DECLINED rather than DECLINED.

2007-01-03 14:06  castaglia

	* modules/mod_auth_file.c:
	  Paranoid checking for a NULL return value from crypt(3), just in
	  case.  One user's debug logs suggest a segfault in
	  mod_auth_file's "check" routine.  Might end up be a red herring,
	  but this code is still useful.

2007-01-03 10:24  castaglia

	* contrib/mod_sql.c:
	  Make sure that "SQLAuthenticate groupset" works properly.

2007-01-02 18:54  castaglia

	* Make.rules.in:
	  Make sure the LIBS environment variable is honored when linking
	  the utility programs (i.e. ftptop, ftpwho).

2007-01-02 14:27  castaglia

	* doc/contrib/mod_quotatab_ldap.html:
	  Minor clarification.

2006-12-28 09:52  castaglia

	* NEWS, src/mkhome.c: Bug#2872 - CreateHome doesn't recreate
	  symlinks from skeleton properly.

2006-12-26 17:59  castaglia

	* src/parser.c: Fix a nasty bug where a <Directory> section which
	  contained a <Limit> section, but no other directives, e.g.:

	    <Directory /path>
	      <Limit LIST>
		DenyAll
	      </Limit>
	    </Directory>

	  was handled as being "empty", and thus ignored; the <Limit> would
	  not take effect.

2006-12-22 12:23  castaglia

	* contrib/mod_sql.c:
	  Paranoid NULL termination of vararg lists to the
	  sql_prepare_where() variadic function.

2006-12-22 11:52  castaglia

	* contrib/mod_sql.c:
	  Additional work toward Bug #2869, trying to preserve the
	  functionality added for Bug #2828.  (That is, make sure that
	  variables within the user-defined SQLGroupWhereClause are still
	  processed/resolved properly.)

2006-12-22 10:48  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2869 - mod_sql botches WHERE clauses.

2006-12-21 14:19  castaglia

	* contrib/mod_ratio.c, include/dirtree.h, src/dirtree.c:
	  It's past time to get rid of get_param_int().  This function was
	  very naught, and used the size of a void * for storing int
	  values.  The rest of the proftpd code has been cleansed of its
	  use (replaced with get_param_ptr()); mod_ratio was the last
	  holdout.

2006-12-21 10:01  castaglia

	* src/dirtree.c:
	  "Temporary" fix has been in place for years; remove the
	  misleading comment and commented-out code, since it's proven
	  itself to not be needed.

2006-12-20 10:39  castaglia

	* contrib/mod_load/install-sh, contrib/mod_wrap2/install-sh,
	  include/install-sh, locale/install-sh, modules/install-sh:
	  For platforms which don't have a standard `install' program, we
	  provide the install-sh script.  On those platforms, though, this
	  script needs to be in the same directories as the Makefiles which
	  use install, rather than just in the top-level directory.

2006-12-20 10:28  castaglia

	* modules/mod_core.c, src/trace.c:
	  Fixing two issues with this change:

	  1) Once set in a config file, the Trace/TraceLog directives were
	  always    being honored, even after those directives had been
	  removed from the    config file and proftpd restarted.

	  2) After a restart, the TraceLog fd would often be the same as
	  used for    connected clients, with the result that the clients
	  would receive    some of the trace log messages.  To address
	  this, we need to ensure    that the TraceLog fd is never one of
	  the major three (stdin, stdout,    or stderr).

2006-12-19 15:54  castaglia

	* src/: parser.c, trace.c:
	  Adding tracing of the parser, using the 'config' trace channel.

2006-12-19 13:36  castaglia

	* src/netaddr.c:
	  More tracing of netaddr functions, particularly in the reverse
	  DNS resolution code.

2006-12-18 19:26  castaglia

	* modules/mod_auth_pam.c:
	  Adding tracing of PAM.

2006-12-18 19:11  castaglia

	* src/netaddr.c:
	  Adding tracing of netaddr functions, using the trace channel name
	  'dns'.

2006-12-18 18:42  castaglia

	* modules/mod_facl.c, src/trace.c:
	  Adding tracing of POSIX ACLs.

2006-12-18 18:38  castaglia

	* contrib/mod_quotatab.c:
	  Make sure we remove mod_quotatab's custom FS, if registered, when
	  the module is being unloaded (as a shared module).

2006-12-18 17:29  castaglia

	* NEWS, src/event.c:
	  Bug#2857 - Failure to properly unregister event handlers leads to
	  segfault after restarts.

	  When scanning the lists of event handlers to find the handlers to
	  remove, we need to make sure we cover all lists, not
	  short-circuit out when we don't find any matching handlers on the
	  first list examined.

2006-12-18 15:09  castaglia

	* src/netacl.c:
	  Adding tracing of NetACLs.

2006-12-18 14:43  castaglia

	* src/ident.c:
	  Add tracing of ident lookups.

2006-12-18 12:04  castaglia

	* contrib/mod_ban.c:
	  Get in the habit of setting pools to NULL after destroying them.

	  Update to use newer Timer API.

2006-12-18 11:27  castaglia

	* modules/mod_core.c:
	  The handling of TraceLog was done well; after a restart, the
	  TraceLog might very well have opened on a low-numbered fd, one
	  assumed to be used for a connecting client.  This means that
	  after a restart, connecting clients might inadvertently receive
	  TraceLog messages on their client, as if they were FTP response
	  messages from proftpd.  Oops.

2006-12-18 10:33  castaglia

	* src/inet.c:
	  FreeBSD 7 on its way.

2006-12-18 10:09  castaglia

	* src/support.c:
	  The pickier compiler on my Linux laptop caught this thinko.

2006-12-17 15:37  castaglia

	* modules/mod_auth.c, modules/mod_log.c, src/parser.c: Use
	  pr_env_get() rather than getenv(3).

2006-12-17 15:28  castaglia

	* contrib/mod_wrap2/mod_wrap2.c, modules/mod_auth.c,
	  modules/mod_core.c: Update modules to use pr_env_set() rather
	  than setenv().  This is mostly for the benefit of systems which
	  may provide putenv() rather than setenv().

2006-12-17 15:27  castaglia

	* configure: Updated configure.

2006-12-17 15:24  castaglia

	* config.h.in, configure.in, include/support.h, src/support.c:
	  Rather than using setenv(3) and unsetenv(3) directly, provide
	  pr_env() wrappers.  This is particularly useful for Solaris
	  systems, which may not provide setenv(3) but *do* provide
	  putenv(3); pr_env_set() handles this transparently.  (If present,
	  setenv(3) is used, otherwise if putenv(3) is present, that is
	  used, otherwise ENOSYS.)

2006-12-15 17:13  castaglia

	* modules/mod_ctrls.c, src/ctrls.c:
	  Add tracing of controls.

2006-12-15 15:24  castaglia

	* modules/mod_dso.c:
	  Adding tracing of DSO modules.

2006-12-15 15:10  castaglia

	* doc/contrib/mod_ctrls_admin.html:
	  Documentation for the 'trace info' ftpctl action.

2006-12-15 15:07  castaglia

	* contrib/mod_ctrls_admin.c:
	  Fix the handling of a 'trace info' control action, so that the
	  list of trace channels and their respective log levels is
	  comprehensibly displayed.

2006-12-15 14:32  castaglia

	* src/fsio.c:
	  Add more handling of possible signals within while() loops.

2006-12-15 14:25  castaglia

	* modules/mod_ls.c:
	  Style changes, and some additional pr_signals_handle() calls in
	  while() loops.

2006-12-15 14:17  castaglia

	* src/event.c:
	  Use tracing for logging of events, rather than debug logging.

2006-12-15 11:49  castaglia

	* src/fsio.c:
	  Add tracing of the FSIO API, no longer using pr_log_debug().

2006-12-15 11:35  castaglia

	* src/auth.c:
	  Moving more logging out of the main error log, and into the
	  TraceLog.  A lot of this level detail isn't always necessary.

2006-12-15 11:32  castaglia

	* doc/contrib/mod_ctrls_admin.html:
	  Add docs for the 'trace' control action.

2006-12-15 11:05  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2849 - Error msg "Not owner" returned by "SIZE in ASCII mode"
	  is misleading.

2006-12-15 10:51  castaglia

	* src/utf8.c:
	  Make sure that utf8_init() and utf8_free() are present for use by
	  the linker, even if they return ENOSYS.

2006-12-15 10:46  castaglia

	* lib/getopt.c:
	  Make sure to reference the gettext() function only when NLS
	  support has been requested.  Otherwise, confusing linker errors
	  result.

2006-12-14 16:21  castaglia

	* src/timers.c:
	  Add timer tracing.

2006-12-14 16:06  castaglia

	* include/: compat.h, timers.h:
	  Compatibility macros should all be collected in compat.h.

2006-12-14 15:15  castaglia

	* locale/Makefile.in:
	  Using the --sort-by-file option when generating message catalogs.

2006-12-14 15:12  castaglia

	* modules/mod_delay.c:
	  Move a lot of the debug logging in mod_delay out of proftpd's
	  main error log into the TraceLog using tracing.

2006-12-14 14:18  castaglia

	* src/inet.c:
	  Use tracing to log when we have successfully bound an
	  address/port to a socket.

2006-12-14 08:37  castaglia

	* configure:
	  Updated configure.

2006-12-14 08:27  castaglia

	* Make.rules.in, Makefile.in, configure.in:
	  The utilities (ftptop, ftpwho, etc) also need to be linked with
	  libintl, if NLS support is enabled and libintl is present.

2006-12-13 14:54  castaglia

	* NEWS, contrib/mod_radius.c, doc/contrib/mod_radius.html:
	  Bug#2856 - Support for RADIUS NAS-Identifier attribute.

2006-12-13 10:19  castaglia

	* configure:
	  Updated configure.

2006-12-13 10:16  castaglia

	* configure.in:
	  Better checking for the required libintl support when
	  --enable-nls is selected.  If the requisite functions (e.g.
	  bindtextdomain(), gettext()) aren't found in libintl, then libc
	  is checked.  If not there either, then configure will abort.

2006-12-13 10:04  castaglia

	* modules/mod_ls.c:
	  Use strcoll(3) both when NLS is enabled and when strcoll(3) is
	  actually present.

2006-12-13 09:44  castaglia

	* modules/mod_lang.c:
	  Make sure that mod_lang can compile if libintl support is absent.

2006-12-13 09:40  castaglia

	* src/utf8.c:
	  Make sure utf8.c can compile and run, even when iconv support is
	  lacking.

2006-12-12 10:44  castaglia

	* doc/modules/mod_delay.html:
	  Typo.

2006-12-12 10:24  castaglia

	* include/version.h:
	  Back to CVS mode, for the next RC release.

2006-12-12 09:02  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2006-12-12 09:00  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for 1.3.1rc1 release.

2006-12-12 08:52  castaglia

	* RELEASE_NOTES:
	  Finish polishing up these release notes.

2006-12-12 08:34  castaglia

	* NEWS, src/ctrls.c:
	  Bug#2867 - Local authorized user buffer overflow in Controls
	  request handling.

2006-12-11 15:11  castaglia

	* src/var.c:
	  Handle the case where the retrieved variable is NULL.

2006-12-11 14:42  castaglia

	* modules/mod_ls.c:
	  More pedantic checks for NULL pointers.

2006-12-11 14:40  castaglia

	* contrib/mod_sql.c:
	  Use pr_log_debug() to handle cases where the database-specific
	  SQL backend module is chosen, as a SQLLogFile may not have been
	  opened at the time of backend selection.

2006-12-11 13:45  castaglia

	* doc/howto/TLS.html:
	  Add a mod_tls FAQ about linker errors related to libdl.

2006-12-11 12:06  castaglia

	* modules/mod_core.c:
	  More safety checking of possibly NULL return values.

2006-12-11 11:58  castaglia

	* modules/mod_core.c:
	  Move the check for a NULL path earlier, before we actually try to
	  use path by calling pr_fsio_fstat() on it.

2006-12-11 11:53  castaglia

	* src/log.c:
	  Handle a possible return value of NULL from localtime(3).

2006-12-11 11:05  castaglia

	* src/fsio.c:
	  Check for NULL return values from strdup(3).

2006-12-11 10:59  castaglia

	* src/dirtree.c:
	  Paranoid checks for NULL pointers, to ensure we don't
	  accidentally pass them to library functions (e.g. strstr(3) or
	  substr(3)).

2006-12-11 09:07  castaglia

	* src/trace.c:
	  Off by one.

2006-12-11 09:03  castaglia

	* src/fsio.c, modules/mod_ls.c, modules/mod_site.c:
	  Off by one.

2006-12-11 00:20  castaglia

	* lib/glibc-glob.c: Paranoid null pointer check.  Useful, since we
	  do use the ALTDIRFUNC flag.

2006-12-11 00:12  castaglia

	* src/fsio.c: Make sure pr_fs_dircat() doesn't attempt to operate
	  on NULL pointers.

2006-12-11 00:02  castaglia

	* modules/mod_log.c: More insurance that a possible NULL value
	  isn't passed to a library call, e.g. strftime(3).

2006-12-10 23:59  castaglia

	* modules/mod_log.c: Ensure we don't inadvertently attempt to
	  lookup a NULL environment variable name, or copy a NULL
	  environment variable value.

2006-12-10 23:55  castaglia

	* src/trace.c: Paranoid check for improper indices into the
	  allocated buffer.

2006-12-10 23:52  castaglia

	* src/support.c: Ensure that we don't accidentally go past the end
	  of the allocated array.

2006-12-10 23:40  castaglia

	* modules/mod_site.c: Another possible negative array index catch.

2006-12-10 23:37  castaglia

	* modules/mod_ls.c: Catch another possible situation where the
	  index used may inadvertently be -1.

2006-12-10 23:21  castaglia

	* src/fsio.c: Pedantically fix some edge cases where an index of -1
	  might accidentally be used.

2006-12-07 09:18  castaglia

	* src/main.c:
	  I think that the majority of sites don't use Classes so much, so
	  move the log message about connections from unknown classes up a
	  few debug log levels.

2006-12-06 16:10  castaglia

	* modules/mod_ls.c:
	  If sorting of directory listings by file name is requested, and
	  NLS support is enabled, be sure to use the locale-sensitive
	  strcoll(3) function for comparison, rather than strcmp(3).

2006-12-06 10:56  castaglia

	* configure:
	  Updated configure.

2006-12-06 10:55  castaglia

	* config.h.in, configure.in, include/conf.h:
	  NLS support requires checking for the locale.h header, and
	  including it if necessary.

2006-12-05 21:15  castaglia

	* doc/howto/DisplayFiles.html:
	  Renamed DisplayFirstChdir to DisplayChdir, and added mention of
	  the new DisplayFileTransfer.

2006-12-05 20:29  castaglia

	* include/display.h, src/display.c:
	  Add the ability to display files via filehandles, using
	  pr_display_fh(), in addition to displaying files via paths using
	  pr_display_file().

	  Why would we want pr_display_fh()?  Many sites, especially those
	  with lots of users, like DisplayLogin, but they also want to
	  chroot their users.  The handling of DisplayLogin could be
	  changed to open a filehandle prior to the chroot, if necessary,
	  and thus continue to display a file whilst allowing chrooted
	  users.  That's the goal, anyway.

2006-12-05 20:22  castaglia

	* src/display.c:
	  Use tracing, rather than debug level 10, for logging about
	  unresolved variables in Display files.

2006-12-05 20:21  castaglia

	* src/trace.c:
	  Add a default trace channel for logging from the Variables API
	  layer.

2006-12-05 20:05  castaglia

	* lib/sstrncpy.c:
	  Include the library support header libsupp.h, at least, since
	  that is what its purpose is.

2006-12-05 19:57  castaglia

	* lib/sstrncpy.c:
	  No need to pull in all of proftpd's configuration for sstrncpy().

2006-12-05 13:44  castaglia

	* contrib/mod_wrap2/mod_wrap2.c:
	  More updates to the current APIs.

2006-12-05 12:05  castaglia

	* contrib/: mod_ban.c, mod_wrap2/mod_wrap2.c:
	  Updating mod_ban, mod_wrap2 to use newer module API names and
	  macros.

2006-12-05 11:00  castaglia

	* include/log.h:
	  Use GCC pragmas for checking callers of pr_log_writefile() as
	  well.

2006-12-05 10:54  castaglia

	* modules/mod_ls.c:
	  Since the sendline() arguments were giving us such trouble, I
	  decided to make use of GCC's attribute pragma to warn about
	  printf-like functions, as is done in other places in the proftpd
	  code (e.g. the Response API header).

2006-12-05 09:47  castaglia

	* src/support.c:
	  Typo.

2006-12-05 09:44  castaglia

	* src/trace.c:
	  Add 'data' as one of the built-in trace channel names.

2006-12-04 17:07  castaglia

	* contrib/mod_tls.c:
	  Add some comments reminding me why I see gibberish in the debug
	  logging, depending on the mod_tls configuration.

2006-12-04 14:33  castaglia

	* contrib/mod_tls.c:
	  Rather than logging when CRLs have not been configured, log when
	  CRLs *are* present and being used.

2006-12-04 14:31  castaglia

	* contrib/mod_tls.c:
	  More paranoia.  Also some minor style changes.

2006-12-04 14:16  castaglia

	* contrib/mod_tls.c:
	  Increase the size of the buffer used to log X509 names from the
	  client cert to 1KB

	  If the client certificate cannot be verified because of an
	  invalid purpose, log the purposes of the client certificate.

2006-12-04 13:56  castaglia

	* contrib/mod_tls.c:
	  X509_STORE_CTX_init() did not return a value in versions of
	  OpenSSL prior to 0.9.7.

	  Also conditionalize the use of the tls_crypto_device variable as
	  per supporting OpenSSL version.

2006-12-04 11:31  castaglia

	* modules/mod_ls.c:
	  Correct one case where sendline() was being called with two
	  format parameters but only one argument (led to garbage being
	  sent to client in directory listing).  Also, make sure that all
	  callers of sendline() use NULL as the last argument, as is proper
	  for any variadic function.

2006-12-04 11:27  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2862 - NLST / returns a listing of the current directory.

2006-12-04 11:24  castaglia

	* modules/mod_ls.c:
	  More paranoia.  Make sure that the length returned from
	  readlink() isn't too large for our buffers.

2006-12-04 11:11  castaglia

	* src/support.c:
	  More defensive checking of input arguments, in pr_memscrub() and
	  sstrcat().

2006-12-04 10:25  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2863 - LIST of nonexistent file causes RST on data channel.
	  As with a similar issue with the NLST command, make sure the data
	  channel is opened before closing it, lest the client receive a
	  RST on their end of the data channel.

2006-12-04 10:07  castaglia

	* locale/Makefile.in:
	  Be more specific about the language support right now: en_US
	  instead of en.

2006-12-01 19:26  castaglia

	* RELEASE_NOTES:
	  More release notes.

2006-12-01 19:17  castaglia

	* doc/contrib/mod_sql.html:
	  Document the SQLOptions directive.

2006-12-01 18:24  castaglia

	* locale/Makefile.in:
	  Don't forget to include the step that actually compiles a .po
	  into a machine-readable .mo file.  The .mo file is what will be
	  installed into the locale/ directory, and used by the gettext
	  library.

2006-12-01 18:13  castaglia

	* modules/mod_lang.c:
	  Call bindtextdomain(3), using the configured LangPath (or
	  PR_LOCALE_DIR if not configured), in order to use the translated
	  message catalogs for proftpd there.

2006-12-01 17:08  castaglia

	* RELEASE_NOTES:
	  More documentation for the release notes.

2006-12-01 16:06  castaglia

	* configure:
	  Updating configure.

2006-12-01 15:46  castaglia

	* Make.rules.in, Makefile.in, configure.in:
	  Only try to build the locale-related message catalogs etc if the
	  --enable-nls configure option is used.

2006-12-01 15:42  castaglia

	* RELEASE_NOTES:
	  Start adding more substance to the release notes, in preparation
	  for a release.

2006-12-01 11:33  castaglia

	* locale/Makefile.in:
	  Make errors with creating translation catalogs non-fatal during
	  the build process.

2006-12-01 11:29  castaglia

	* locale/: Makefile.in, files.txt:
	  More work on the Makefile for generating the template message
	  catalog for translation.

2006-11-30 14:31  castaglia

	* contrib/ftpquota:
	  If opening a quota table for displaying records only, open the
	  table in read-only mode, rather than read-append mode.

2006-11-30 10:06  castaglia

	* src/ftpdctl.c:
	  Return a value, since the function definition requires it.

2006-11-29 09:08  castaglia

	* contrib/mod_radius.c:
	  Make sure that the attribute length for UIDs and GIDs does not
	  exceed the size of the variable used for holding the UID and GID.

2006-11-28 20:13  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2860 - Failure to check for data length in mod_tls could lead
	  to remote buffer overwriting.

	  (Also add entry for Bug #2858.)

2006-11-28 19:47  castaglia

	* contrib/mod_tls.c:
	  Prevent some possible NULL pointer dereferences by checking for
	  tls_pkey before using it.

	  Use root privileges when checking for the existence of
	  certificate and key files, during the config handler runs.  These
	  files are opened with root privs later in the module, so the
	  checks for the existence should also use root privs.

2006-11-28 19:29  castaglia

	* contrib/mod_radius.c:
	  Fix typo in declaration of static MD5_Update() function.

	  Also add paranoid check for size of attribute length, in RADIUS
	  packet, which exceeds the maximum size of the data type.

2006-11-28 11:37  jwm

	* src/support.c: use the version that was released as part of
	  1.3.0a; these integer "overflows" aren't exploitable, so there is
	  no prophylactic difference

2006-11-27 06:49  jwm

	* src/support.c: Bug #2858 - CVE-2006-5815: remote code execution
	  in ProFTPD

2006-11-17 15:42  jwm

	* src/main.c: - avoid passing a NULL pointer to pr_log_pri() as it
	  can causes segfaults	 on some platforms.  - make the 'invalid
	  CommandBufSize' error message a litle  clearer

2006-10-31 19:12  castaglia

	* lib/glibc-glob.c:
	  Catch a few cases, from code borrowed from glibc, where the
	  return value from realloc(3) was not being checked to see if it's
	  NULL before using it.

2006-10-31 19:11  castaglia

	* lib/sstrncpy.c, src/support.c, utils/misc.c:
	  Prevent sstrcat() and sstrncpy() from working on buffers if the
	  length argument is zero.

2006-10-31 18:36  castaglia

	* modules/mod_ls.c:
	  Since readlink(2) is not guaranteed to NUL-terminate the provided
	  buffer, we need to save space for the NUL terminator.

2006-10-31 18:35  castaglia

	* src/netio.c:
	  Require that callers of pr_netio_gets() and
	  pr_netio_telnet_gets() specify a non-zero buffer length.

2006-10-31 18:34  castaglia

	* lib/pwgrent.c, modules/mod_auth_file.c:
	  Check if realloc(3) returned NULL or not before blindly assigning
	  the return value to our pointer.

2006-10-31 14:49  castaglia

	* src/main.c:
	  Fix an issue where the cmd_buf_size variable, for the size of the
	  buffer used for reading FTP commands sent by clients, was not
	  being properly set to the size configured via the
	  CommandBufferSize directive.

2006-10-30 14:07  castaglia

	* doc/howto/SQL.html:
	  Add an example of using Python to generate an OpenSSL-encoded
	  mod_sql password string.

2006-10-25 09:05  castaglia

	* src/ftpdctl.c:
	  Add stub for pr_trace_msg(), so that linking ftpdctl does not
	  fail.

2006-10-24 10:47  castaglia

	* src/event.c:
	  Allocate a larger event pool (ref Bug #2850).

2006-10-24 09:43  castaglia

	* NEWS, src/pool.c:
	  Bug#2850 - Small event pool allocation on 64-bit machine leads to
	  segfault on startup.	See the bug report for an excellent
	  analysis of the issue.

2006-10-24 09:13  castaglia

	* src/: ctrls.c, event.c:
	  Add tracing of when control action handlers and event handlers
	  are registered and unregistered.

2006-10-23 19:40  castaglia

	* contrib/mod_ban.c:
	  Update the mod_ban module to be better behaved as a shared
	  module.

2006-10-23 19:32  castaglia

	* src/trace.c:
	  Be sure to set the trace table pointer to NULL after clearing the
	  pool from which it was allocated.

2006-10-23 18:34  castaglia

	* contrib/mod_wrap2/: mod_wrap2.c, mod_wrap2.h.in:
	  Updated mod_wrap2 to be better behaved when compiled as a shared
	  module.

2006-10-19 19:18  jwm

	* contrib/mod_ldap.c: add much more extensive debugging output

2006-10-13 08:00  castaglia

	* src/parser.c:
	  Treat a trailing LF as the eol marker; no need to treat any CRs
	  before that LF as eol markers.

2006-10-13 07:53  castaglia

	* src/parser.c:
	  Typo.

2006-10-13 07:51  castaglia

	* src/parser.c:
	  If we don't find an end-of-line marker (LF or CRLF) in the line
	  of configuration data read in, issue a warning, so that the admin
	  knows that any configuration error may be caused by data
	  truncation.

2006-10-11 09:47  castaglia

	* doc/modules/mod_facl.html:
	  Add small doc for the mod_facl module.

2006-10-11 09:37  castaglia

	* RELEASE_NOTES, modules/mod_facl.c:
	  Add a runtime directive for disabling mod_facl, if needed.

2006-10-05 11:01  castaglia

	* src/parser.c:
	  Style cleanup.  Sprinkle more "pr_signals_handle()" around within
	  the while loops, too.

2006-10-05 10:57  castaglia

	* NEWS, src/parser.c:
	  Bug#2848 - Unable to properly parse config files using
	  Windows-style line endings.

2006-10-04 14:06  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2847 - HiddenStores files not properly removed if data
	  transfer times out.

2006-09-29 09:41  castaglia

	* RELEASE_NOTES:
	  A little more about UseIPv6, and the command-line options.

2006-09-29 09:38  castaglia

	* NEWS, RELEASE_NOTES, include/netaddr.h, modules/mod_core.c,
	  src/bindings.c, src/dirtree.c, src/inet.c, src/main.c,
	  src/netacl.c, src/netaddr.c, src/proftpd.8.in:
	  Bug#2817 - Ability to disable IPv6 support at runtime.

2006-09-27 08:58  castaglia

	* src/main.c:
	  Reset the handler for the SIGUSR2 signal (and NOT the SIGHUP
	  signal) in the sig_evnt() handler.

2006-09-18 09:55  castaglia

	* configure:
	  Updating configure.

2006-09-18 09:48  castaglia

	* Makefile.in, configure.in, locale/Makefile.in:
	  Renaming the po/ directory to locale/.

2006-09-14 11:02  castaglia

	* NEWS, src/fsio.c:
	  Bug#2842 - Filesystem statcache is not correctly caching return
	  value of stat().

2006-09-13 13:49  castaglia

	* configure:
	  Updated configure.

2006-09-13 13:32  castaglia

	* Makefile.in, configure.in:
	  Start of a po/Makefile, for building .po files (localised message
	  strings).  Part of the support for RFC2640.

2006-09-11 19:38  castaglia

	* modules/mod_auth.c:
	  If MaxLoginAttempts is exceeded, mention in the generated log
	  message that we are refusing the client's connection.

2006-09-11 18:31  castaglia

	* doc/contrib/mod_sql.html:
	  Remove mention of SQLHomedirOnDemand, as that directive is now
	  deprecated.

2006-09-11 17:51  castaglia

	* NEWS, RELEASE_NOTES:
	  There is no 'SQLWhereClause' directive.  Oops.

2006-09-11 17:48  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql.c:
	  Bug#2828 - Support variables in SQL Where directives.

2006-09-11 14:58  castaglia

	* doc/contrib/mod_sql.html:
	  Document the syntax for refering to environment variables in a
	  SQLNamedQuery.

2006-09-11 14:52  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql.c:
	  Bug#2799 - SQLNamedQuery should support environment variables.

2006-09-11 11:42  castaglia

	* doc/contrib/mod_tls.html:
	  Add documentation for the new TLSPassPhraseProvider directive.

2006-09-11 11:33  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_tls.c:
	  Bug#2756 - Support for TLSPassPhraseProvider.

2006-09-11 11:30  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2839 - ProFTPD seems to re-read the file two times in RETR
	  command.

2006-09-11 10:58  castaglia

	* configure:
	  Updating configure.

2006-09-11 10:55  castaglia

	* Make.rules.in, Makefile.in, config.h.in, configure.in:
	  Add support for a PR_LOCALE_DIR, which will contain the localised
	  string files for different locales.  The location of this
	  directory can be set, at compile-time, using the --datadir
	  configure option.  Run-time configuration of this path is done
	  using mod_lang's LangPath directive.

2006-09-08 18:15  castaglia

	* README.modules, doc/modules/mod_lang.html:
	  Add mostly-done documentation for mod_lang module, and mention
	  mod_lang in the README.modules file.	(Note that I still need to
	  write README.NLS.)

2006-09-08 17:51  castaglia

	* configure:
	  Updated configure.

2006-09-08 17:48  castaglia

	* RELEASE_NOTES, configure.in, modules/mod_lang.c:
	  Adding mod_lang to the mix, for supporting the LANG command, as
	  part of implementing RFC2640.

2006-09-08 09:41  castaglia

	* NEWS, include/dirtree.h, modules/mod_core.c, src/dirtree.c,
	  src/main.c:
	  Bug#2837 - Defines improperly persist across daemon restarts.

2006-09-08 08:46  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#2835 - Group quotas not honored for supplemental group
	  membership.

2006-09-07 09:04  castaglia

	* RELEASE_NOTES:
	  Typo.

2006-09-06 20:06  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2825 - SSL/TLS CRLs are not working properly.

2006-09-06 19:56  castaglia

	* contrib/mod_ldap.c:
	  Check for PR_USE_OPENSSL as well as HAVE_OPENSSL.

2006-09-06 19:53  castaglia

	* contrib/mod_sql.c:
	  Correct the checks for HAVE_OPENSSL and PR_USE_OPENSSL in
	  mod_sql.

2006-09-06 19:49  castaglia

	* contrib/mod_radius.c:
	  Make the ordering of OpenSSL header inclusion a little more
	  legible.

2006-09-06 19:47  castaglia

	* contrib/mod_radius.c:
	  When proftpd has been compiled to use OpenSSL, then mod_radius
	  has no need for using it's own MD5 routines; we can use those
	  from OpenSSL instead.

2006-09-06 19:27  castaglia

	* configure:
	  Updated configure.

2006-09-06 19:24  castaglia

	* configure.in:
	  Make sure the USE_OPENSSL macro is set if mod_tls is compiled in.

2006-09-06 18:57  castaglia

	* src/bindings.c:
	  Style changes; no functional change.

2006-09-06 17:30  castaglia

	* NEWS:
	  Added mod_wrap2 to the distro.

2006-09-06 17:23  castaglia

	* README.modules, RELEASE_NOTES:
	  Updating docs for mention of mod_wrap2.  Needs to fleshed out
	  more.

2006-09-06 17:16  castaglia

	* contrib/mod_wrap2/configure:
	  Adding configure script for mod_wrap2.

2006-09-06 17:15  castaglia

	* contrib/: mod_wrap2_file.c, mod_wrap2_sql.c:
	  Adding mod_wrap2 submodules.

2006-09-06 16:11  castaglia

	* contrib/mod_wrap2/: Makefile.in, configure.in, mod_wrap2.c,
	  mod_wrap2.h.in:
	  Adding mod_wrap2 to the contrib/ area.

2006-09-06 16:09  castaglia

	* doc/contrib/: index.html, mod_wrap2.html, mod_wrap2_file.html,
	  mod_wrap2_sql.html:
	  Adding documentation for the mod_wrap2 et al modules.

2006-09-05 10:04  castaglia

	* include/modules.h:
	  The privdata structure is no longer used.

2006-08-23 19:29  castaglia

	* contrib/mod_sql.c:
	  When determining the backend database module to use, mod_sql was
	  using the *first* entry in the list of backends, rather than the
	  *last*, as is documented.  Updated the default behavior to
	  properly use the last entry (which is the first module loaded).

2006-08-17 09:05  castaglia

	* modules/mod_ls.c:
	  Fix an issue noticed by Daniel, using lftp (but not ftp).

	  When handling an NLST command on an empty directory, lftp would
	  receive a TCP RST from proftpd, rather than the more polite FIN.
	  This would happen because proftpd did a lazy opening of the data
	  connection; the connection would be opened only when proftpd,
	  when listing the contents of the directory, encountered something
	  to list.  In the case of an empty directory, there would be
	  nothing to list.  Hence no accept(2) for the client's data
	  connection, followed by a close() on the socket.  In the TCP
	  world, this is "slamming the connection closed", and hence the
	  client would receive a RST -- the initial handshake was not
	  completed before the socket was closed.

	  The fix, then, is trivial: always open the data connection,
	  regardless of whether there is data to be sent, when handling
	  NLST commands.  (For some reason this issue does not seem to
	  affect the LIST command.)

2006-08-16 11:42  jwm

	* contrib/mod_ldap.c: fix debug message format (thanks to mathew
	  <meta@pobox.com>)

2006-08-09 08:39  castaglia

	* modules/mod_core.c:
	  Prevent users from misconfiguring their servers silently by
	  trying to use something like "<Global ~user>" in their
	  proftpd.conf.

2006-08-04 08:11  castaglia

	* doc/howto/Limit.html:
	  Mention that <Limit LOGIN> does not work as expected within
	  <Directory> sections.

2006-08-02 11:26  castaglia

	* NEWS, include/options.h, src/main.c:
	  Bug#2774 - Idle clients exhibit excessive usage of system
	  resources.

2006-07-19 19:15  castaglia

	* RELEASE_NOTES, include/fsio.h, modules/mod_core.c, src/fsio.c:
	  At Michael's suggestion, add a UseUTF8 directive, for run-time
	  disabling of UTF8 support.

2006-06-29 10:16  castaglia

	* modules/mod_auth_unix.c:
	  Not only was the persistent_passwdf variable never used, neither
	  was the _get_ppw_info() function.

2006-06-29 09:00  castaglia

	* Makefile.in:
	  Fix missing dependency of the `install-proftpd' target on the
	  $(includedir).  There was a dependency already on
	  $(includedir)/proftpd -- but that is not the same.

2006-06-28 09:32  castaglia

	* NEWS, contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c:
	  Bug#2809 - conf.h should be included before mysql.h in
	  mod_sql_mysql.c.  The mod_sql_postgres module was similarly
	  updated.

2006-06-28 09:16  castaglia

	* NEWS, modules/mod_auth_file.c:
	  Bug#2803 - mod_auth_file does not properly iterate through
	  AuthUserFile entries.  The issue was one of rewinding an already
	  open AuthUserFile, every time pr_auth_getpwent() was called.	The
	  mod_auth_file module has been restructured to avoid this.  The
	  code was also substantially changed, removing a lot of dead code
	  for a never-used feature (that of supporting multiple
	  AuthUserFiles within the same server context).

2006-06-28 09:10  castaglia

	* NEWS, contrib/mod_wrap.c:
	  Bug#2810 - Incorrect use of assignment instead of comparison in
	  mod_wrap.

2006-06-22 13:37  castaglia

	* include/lastlog.h, src/lastlog.c:
	  Oops.  Forgot to check these files in.  They're for Bug #2610.

2006-06-22 12:48  jwm

	* modules/mod_ctrls.c: auth_(uid|gid)2name have become
	  pr_auth_(uid|gid)2name

2006-06-22 10:06  castaglia

	* include/proftpd.h, modules/mod_auth_unix.c:
	  There's absolutely no reason for the pwdfname and grpfname
	  variables to be visible outside of mod_auth_unix.

2006-06-22 09:08  castaglia

	* modules/mod_auth_pam.c:
	  Explicitly set the size of the authtable array.  Some picky
	  compilers apparently don't like array declarations without the
	  size.

2006-06-20 09:54  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2807 - mod_sql processes SQLLog QUIT query twice.

2006-06-16 14:35  castaglia

	* modules/mod_auth_unix.c:
	  Remove unused variables and simplify the code.

2006-06-16 10:02  castaglia

	* contrib/mod_ldap.c:
	  auth_check() -> pr_auth_check()

2006-06-16 10:00  castaglia

	* contrib/mod_sql.c:
	  Style cleanup.

2006-06-15 19:54  castaglia

	* configure:
	  Updating configure.

2006-06-15 19:52  castaglia

	* config.h.in, configure.in, src/main.c:
	  Enhance the -V output to include the CFLAGS, LDFLAGS, and LIBS
	  used to compile proftpd.

2006-06-15 19:33  castaglia

	* contrib/mod_site_misc.c:
	  Updating mod_site_misc to handle UTF8-encoded paths.

2006-06-15 19:30  castaglia

	* NEWS:
	  Bug#2626 - "ERROR" macro collision can cause compiler errors on
	  HP-UX.

2006-06-15 19:28  castaglia

	* Makefile.in:
	  There is no real need to clean the include/ directory.

2006-06-15 19:22  castaglia

	* contrib/: mod_ban.c, mod_ctrls_admin.c, mod_ifsession.c,
	  mod_ldap.c, mod_quotatab.c, mod_radius.c, mod_ratio.c,
	  mod_readme.c, mod_rewrite.c, mod_site_misc.c, mod_sql.c,
	  mod_sql_mysql.c, mod_sql_postgres.c, mod_tls.c, mod_wrap.c:
	  Updating contrib modules to use PR_ERROR, PR_DECLINED, and
	  PR_HANDLED.

2006-06-15 19:10  castaglia

	* contrib/mod_load/mod_load.c.in:
	  Update mod_load to use PR_HANDLED.

2006-06-15 18:40  castaglia

	* modules/: mod_auth.c, mod_auth_file.c, mod_auth_pam.c,
	  mod_auth_unix.c, mod_cap.c, mod_core.c, mod_ctrls.c, mod_delay.c,
	  mod_dso.c, mod_log.c, mod_ls.c, mod_site.c, mod_xfer.c:
	  Updating the core modules to use the PR_ERROR, PR_DECLINED, and
	  PR_HANDLED macros.  Also includes style changes.

2006-06-15 18:11  castaglia

	* doc/mod_sample.c:
	  Updating the sample module to reflect ongoing changes in the core
	  code.

2006-06-15 17:53  castaglia

	* modules/mod_auth.c:
	  To enable lastlog support requires --with-lastlog, not
	  --enable-lastlog.

2006-06-15 17:48  castaglia

	* include/: compat.h, dirtree.h, modules.h:
	  Start work towards Bug #2626 -- renaming the ERROR macro to
	  PR_ERROR, to avoid namespace collisions on some platforms (i.e.
	  HP-UX).  The DECLINED and HANDLED macros will be similarly
	  renamed to PR_DECLINED and PR_HANDLED.

	  Compatibility redefines in compat.h will help to make the
	  transition transparent (hopefully).

2006-06-15 17:37  castaglia

	* src/main.c:
	  Forgot a few places where SIG_REHASH was renamed to SIG_RESTART.

2006-06-15 17:36  castaglia

	* configure:
	  Updating configure.

2006-06-15 17:36  castaglia

	* include/proftpd.h, src/main.c:
	  Remove all the old "struct rehash" callback stuff.  Replace
	  mention of "rehash" with "restart".

2006-06-15 17:32  castaglia

	* include/proftpd.h, src/main.c:
	  Remove the deprecated pr_rehash_register_handler() function.
	  This functionality is now available via the Events API, by
	  registering an event handler for the 'core.restart' event.

2006-06-15 17:26  castaglia

	* Make.rules.in, Makefile.in, NEWS, configure.in,
	  include/Makefile.in:
	  Bug#2719 - ProFTPD should install its header files into the
	  installation location.

2006-06-15 16:00  castaglia

	* include/.cvsignore:
	  Preparing to ignore the generated Makefile that will appear in
	  the include/ directory.

2006-06-15 14:40  castaglia

	* configure:
	  Updating configure.

2006-06-15 13:53  castaglia

	* Make.rules.in, NEWS, RELEASE_NOTES, config.h.in, configure.in,
	  include/conf.h, modules/mod_auth.c, src/main.c:
	  Bug#2610 - Support for logging to /var/log/lastlog.

2006-06-14 19:39  castaglia

	* src/dirtree.c:
	  Change fixup_globals() so that it operates on the same list as
	  given to fixup_servers(), rather than using the global
	  server_list variable.  (There are cases where the two lists may
	  not be the same.)

2006-06-14 18:54  castaglia

	* include/pool.h, src/pool.c:
	  Removing unused pool code.

2006-06-14 18:43  castaglia

	* doc/contrib/mod_sql.html:
	  Update the mod_sql docs, as per changes for Bug #2784.

	  Remove the list of deprecated directives from ancient mod_sql
	  versions.

2006-06-14 18:39  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql_mysql.c:
	  Bug#2784 - Ability to specify MySQL Unix domain socket path.

2006-06-14 17:26  castaglia

	* NEWS, RELEASE_NOTES, modules/mod_core.c:
	  Bug#2798 - MDTM should return time in GMT.

2006-06-14 16:50  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql.c:
	  Bug#2687 - Support for more efficient group table schema.

2006-06-14 16:33  castaglia

	* src/utf8.c:
	  Use "C" as a default local character set, if we cannot determine
	  a better one.

2006-06-14 13:42  castaglia

	* src/utf8.c:
	  Add a trace message of the character set to which UTF8 conversion
	  will be done.

2006-06-14 10:53  castaglia

	* src/netaddr.c:
	  Use separate log messages for the cases where getaddrinfo(3) and
	  getnameinfo(3) fail, to differentiate between syscall errors (in
	  which case, log errno) and errors with the functions themselves
	  (in which case, use gai_strerror(3)).

2006-06-14 08:10  castaglia

	* NEWS, src/log.c:
	  Bug#2801 - Error compiling proftpd on NetBSD 3.0/sparc64.

2006-06-14 08:04  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2800 - free_proc_title() in developer build tries to free
	  strings from pool allocated by mod_tls.

2006-06-13 15:14  castaglia

	* src/scoreboard.c:
	  Silence compiler warning (seen under --enable-devel) by renaming
	  variable.

2006-06-12 09:03  castaglia

	* doc/howto/DSO.html:
	  Update example Makefile to include DESTDIR.

2006-06-12 09:02  castaglia

	* contrib/mod_load/Makefile.in:
	  Make sure that mod_load's Makefile honors DESTDIR.  Thanks to Ken
	  Zalewski for pointing this out.

2006-06-09 11:29  castaglia

	* doc/contrib/mod_sql.html:
	  Typo.

2006-06-09 10:24  castaglia

	* RELEASE_NOTES:
	  Updating the release notes.

2006-06-09 10:21  castaglia

	* NEWS, contrib/mod_ctrls_admin.c,
	  doc/contrib/mod_ctrls_admin.html, include/scoreboard.h,
	  modules/mod_core.c, src/scoreboard.c:
	  Bug#2797 - Add ability to force cleaning the scoreboard.

2006-06-08 12:07  castaglia

	* contrib/mod_sql.c:
	  Restore the use of CF_MERGEDOWN_MULTI on SQLLog and SQLShowInfo
	  directives, but only when mod_ifsession is in use.

2006-06-08 12:00  castaglia

	* contrib/mod_sql.c:
	  No need to set CF_MERGEDOWN_MULTI on directives that cannot
	  appear in <Directory> sections, i.e. SQLLog and SQLShowInfo.

2006-06-08 10:51  castaglia

	* configure:
	  Updating configure.

2006-06-08 10:46  castaglia

	* configure.in:
	  Fixing typo in handling of --enable-devel=profile configure
	  option.

2006-06-07 09:50  castaglia

	* doc/howto/Chroot.html:
	  Bug#1323: DefaultRoot not working with nfs root squash +
	  protected directories.

2006-05-26 10:29  castaglia

	* configure:
	  Updated configure script.

2006-05-26 10:20  castaglia

	* modules/mod_core.c:
	  Modify mod_core for handling UTF8 paths, and mark it for i18n.

2006-05-26 10:16  castaglia

	* config.h.in, configure.in, include/fsio.h, modules/mod_ls.c,
	  modules/mod_site.c, modules/mod_xfer.c, src/fsio.c, src/main.c,
	  src/netio.c:
	  Marking more places in the source for gettext manipulation.
	  Added two new functions, pr_fs_decode_path() and
	  pr_fs_encode_path(), which are to be used for encoding to/from
	  UTF8 paths (or not).

2006-05-26 09:59  castaglia

	* src/trace.c:
	  Change the format of the TraceLog: The log entry does not need to
	  contain any server information.

2006-05-26 09:43  castaglia

	* src/: table.c, trace.c:
	  Miscellaneous improvements: when dumping a table, include the
	  length of the value data (for cases where the value is binary,
	  and not a string); when adding new trace channels, make a copy of
	  the channel name, as callers will not do so.

2006-05-26 08:35  castaglia

	* NEWS:
	  Correct a bug number.

2006-05-25 10:01  castaglia

	* configure:
	  Updating configure.

2006-05-25 09:55  castaglia

	* Make.rules.in, config.h.in, configure.in, include/conf.h,
	  include/dirtree.h, include/utf8.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_ls.c, modules/mod_site.c,
	  modules/mod_xfer.c, src/data.c, src/help.c, src/main.c,
	  src/utf8.c:
	  Adding UTF8 encoding/decoding functions.  Marking source,
	  preparing it for use with the gettext utilities.

	  Part of the work towards making the proftpd source i18n/l10n
	  ready.

2006-05-25 08:46  castaglia

	* NEWS, RELEASE_NOTES, modules/mod_log.c:
	  Bug#2793 - LogFormat variable for the ProFTPD version.

2006-05-25 08:44  castaglia

	* NEWS, RELEASE_NOTES, modules/mod_xfer.c:
	  Bug#2775 - Support for DisplayFileTransfer directive.

2006-05-24 08:00  castaglia

	* README.AIX:
	  Updating the AIX notes with remarks about gcc versions which do
	  and don't work.

2006-05-23 10:34  castaglia

	* NEWS, modules/mod_ctrls.c:
	  Bug#2792 - ProFTPD fails after SIGHUP signal when Controls
	  support is enabled.

2006-05-23 10:31  castaglia

	* src/dirtree.c:
	  Style tweaks.  Add handling of signals to a while() loop.

2006-05-23 08:06  castaglia

	* configure:
	  Updating configure script.

2006-05-23 08:02  castaglia

	* configure.in:
	  Fix the --without-getopt configure option so that it properly
	  disables checks for the getopt_long() function and getopt.h
	  header, in addition to disabling the check for the getopt()
	  function.  This was causing a problem on FreeBSD 4.x builds,
	  where the libgnugetopt package would install a getopt.h header
	  (picked up by proftpd's configure script) that had a conflicting
	  redefinition of the getopt struct.

2006-05-23 07:55  castaglia

	* configure.in:
	  Fix a bug, reported via the Debian bug system, where the paths
	  from which proftpd would look for shared libraries included the
	  --sbindir.

	  The issue was the use of the -rpath linker parameter when linking
	  the proftpd executable; it is not necessary.	Loading of DSO
	  modules does not seem to be affected by the removal of that
	  -rpath.

2006-05-22 09:45  castaglia

	* contrib/mod_tls.c:
	  Remove Perlism causing a broken module.  Add handling of signals
	  to a potentially long-running while loop.

2006-05-22 09:22  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2514 - Trouble with mod_tls and DSA certificates.

2006-05-19 15:07  castaglia

	* src/netaddr.c:
	  Fix some compiler warnings, and a syntax error.

2006-05-18 09:45  castaglia

	* src/trace.c:
	  If pr_trace_msg() is used with an unknown channel, return -1
	  rather than 0.

2006-05-18 08:57  castaglia

	* configure:
	  Updating configure script.

2006-05-18 08:38  castaglia

	* Make.rules.in, NEWS, RELEASE_NOTES, config.h.in, configure.in,
	  contrib/mod_ctrls_admin.c, include/conf.h, include/trace.h,
	  modules/mod_core.c, src/main.c, src/response.c, src/trace.c:
	  Bug#2506 - Better ability to configure what sort of debug output
	  to generate.

2006-05-17 17:47  castaglia

	* src/netaddr.c:
	  Add debug logging (level 10) of when the ACL comparison functions
	  pr_netaddr_cmp() and pr_netaddr_ncmp() are comparing an IPv4
	  address against an IPv4-mapped IPv6 address.

2006-05-17 09:18  castaglia

	* NEWS, README.IPv6, src/netacl.c, src/netaddr.c:
	  More work on Bug#2785.

2006-05-15 14:42  castaglia

	* doc/howto/DSO.html:
	  Make note of some of the errors you might encounter when using
	  DSO modules.

2006-05-15 09:32  castaglia

	* NEWS, README.IPv6, README.PAM, README.classes, RELEASE_NOTES,
	  modules/mod_core.c, modules/mod_xfer.c, src/netacl.c:
	  Getting the restored SourceForge devel CVS repository back up to
	  sync, after their hard disk failure.	Joy.

2006-05-12 14:53  castaglia

	* README.AIX:
	  Document that some versions of AIX have sendfile issues.

2006-05-05 09:02  castaglia

	* contrib/mod_tls.c:
	  Clean up the handling of the TLSCACertificatePath directive.

2006-04-21 09:37  castaglia

	* contrib/mod_quotatab.c, doc/contrib/mod_quotatab.html:
	  Forgot to add the description for the QuotaExcludeFilter
	  directive.

2006-04-21 09:26  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_quotatab.c,
	  contrib/mod_quotatab.h, doc/contrib/mod_quotatab.html,
	  doc/howto/Quotas.html:
	  Bug#2713 - Ability to check a user's existing disk bytes/files
	  usage and update tally accordingly.

2006-04-20 19:04  castaglia

	* contrib/mod_sql.h:
	  Update the mod_sql header.  Crufty information, and a typo.

2006-04-20 19:02  castaglia

	* include/feat.h, src/feat.c:
	  Change the way the Feat API stores features to be listed, from
	  using an array to using a table.  This makes it much easier to
	  remove features from the listing.

2006-04-20 18:59  castaglia

	* contrib/: mod_sql.c, mod_sql_mysql.c, mod_sql_postgres.c:
	  Expanding the HOOKs exposed by mod_sql, so that other contrib
	  modules can run their own SQL statements without having to
	  reinvent mod_sql's wheel.

2006-04-20 18:32  castaglia

	* NEWS, README.modules, RELEASE_NOTES, contrib/mod_ban.c,
	  doc/contrib/mod_ban.html:
	  Adding mod_ban.

2006-04-20 10:03  castaglia

	* NEWS, src/inet.c:
	  Bug#2733 - IP TOS not being set for data transfers.

2006-04-19 19:28  castaglia

	* src/parser.c:
	  Adding some sanity checks for NULL pointers, pointed out by
	  Coverity scans.  Also remove some unnecessary conditionals.

2006-04-19 19:24  castaglia

	* modules/mod_log.c:
	  "writeable" -> "writable".

2006-04-19 19:06  castaglia

	* modules/mod_xfer.c:
	  Clean up dead code spotted by Coverity scan.

2006-04-19 19:01  castaglia

	* modules/mod_auth.c:
	  Clean up dead code spotted by Coverity scan.	Also fixup some
	  formatting issues while I'm here.

2006-04-19 18:46  castaglia

	* src/data.c, modules/mod_auth_file.c:
	  Clean up dead code spotted by Coverity scan.

2006-04-19 18:42  castaglia

	* contrib/mod_sql.c:
	  Clean up dead code spotted by Coverity.

2006-04-19 16:10  castaglia

	* RELEASE_NOTES, modules/mod_xfer.c:
	  Get the ball rolling on deprecating HiddenStor, in favor of
	  HiddenStores.

2006-04-19 09:59  castaglia

	* configure:
	  Updating configure.

2006-04-19 09:56  castaglia

	* NEWS, configure.in:
	  As part of addressing Bug #2447, make use of the --enable-openssl
	  autoconf option automatically add libssl and libcrypto to the
	  library list.

2006-04-19 09:44  castaglia

	* NEWS, config.h.in, configure.in, contrib/mod_ldap.c,
	  contrib/mod_sql.c, src/main.c:
	  Bug#2447 - HAVE_OPENSSL should be managed in configure.

2006-04-17 15:48  castaglia

	* NEWS, RELEASE_NOTES, modules/mod_log.c:
	  Bug#2651 - LogFormat should support variable for logging the
	  response message.

2006-04-17 15:38  castaglia

	* doc/contrib/: mod_quotatab.html, mod_quotatab_radius.html:
	  Update mod_quotatab docs with links to RADIUS submodule.

2006-04-17 15:35  castaglia

	* NEWS, README.modules, RELEASE_NOTES,
	  contrib/mod_quotatab_radius.c, contrib/mod_radius.c,
	  doc/contrib/mod_quotatab_radius.html:
	  Bug#2627 - Support for RADIUS quotatab module.

2006-04-17 15:23  castaglia

	* NEWS, contrib/mod_sql.c:
	  Mention in NEWS that CreateHome should be used instead of
	  SQLHomedirOnDemand.  Mark the SQLHomedirOnDemand config handler
	  as deprecated in the mod_sql source.

2006-04-17 15:22  castaglia

	* modules/mod_core.c:
	  As per the warnings in the 1.3.0 release cycle, the Bind
	  directive was deprecated, and is now removed.

2006-04-17 15:20  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql.c:
	  Bug#2628 - SQLHomedirOnDemand should be deprecated.

2006-04-17 14:01  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_tls.c, doc/contrib/mod_tls.html:

	  Bug#2686 - Allow CCC command but still require SSL/TLS protection
	  during authentication.

2006-04-17 11:52  castaglia

	* NEWS, RELEASE_NOTES, modules/mod_auth.c,
	  doc/howto/CreateHome.html, doc/howto/index.html, src/mkhome.c:
	  Bug#2611 - CreateHome should allow non-root-owned parent
	  directories.

2006-04-17 11:39  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_tls.c, doc/contrib/mod_tls.html:

	  Bug#2599 - Support for using OpenSSL "engines".

2006-04-17 10:53  castaglia

	* configure:
	  Updating configure.

2006-04-17 10:04  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_auth_pam.c:
	  Bug#2769 - mod_auth_pam needs a patch to allow pam_group to work.

2006-04-17 09:48  castaglia

	* NEWS, doc/modules/mod_delay.html, modules/mod_delay.c:
	  Bug#2664 - Add 'delay info' ftpdctl action for showing DelayTable
	  values.

2006-04-17 09:20  castaglia

	* NEWS, src/inet.c:
	  Bug#2777 - ProFTPD does handle data sockets properly on FreeBSD
	  6.

2006-04-16 16:18  castaglia

	* modules/mod_xfer.c:
	  At some point in the future, proftpd will support the MODE Z
	  command.  When that happens, mod_xfer will need to not use
	  sendfile() if MODE Z has been requested.

2006-04-16 16:08  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2740 - TYPE command not allowed before USER/PASS, causes
	  problem for `ftp -n'.

2006-04-16 16:01  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2654 - FEAT command should be subject to <Limit>.

2006-04-16 15:51  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2753 - CCC not closing SSL/TLS connection correctly.

2006-04-16 15:45  castaglia

	* NEWS, include/dirtree.h, include/table.h, src/dirtree.c,
	  src/table.c:
	  Bug#2535 - Compare directives using integer comparisons when
	  possible to improve performance.

2006-04-16 15:41  castaglia

	* NEWS, modules/mod_auth_unix.c:
	  Bug#2721 - mod_auth_unix does not behave properly when first in
	  AuthOrder.

2006-04-16 15:39  castaglia

	* NEWS, modules/mod_auth_file.c, modules/mod_auth_unix.c:
	  Bug#2714 - mod_auth_file munges AuthUserFile, AuthGroupFile
	  records.

2006-04-16 15:35  castaglia

	* doc/howto/Debugging.html:
	  Adding mention of the stack trace logging to the Debugging howto.

2006-04-16 15:25  castaglia

	* configure:
	  Updating configure.

2006-04-16 15:23  castaglia

	* NEWS, RELEASE_NOTES, config.h.in, configure.in,
	  include/options.h, src/main.c:
	  Bug#2766 - Support for automatic stack trace if SIGSEGV is
	  received.

2006-04-16 15:12  castaglia

	* include/version.h:
	  Now that 1.3.0 is out, we can start on 1.3.1.

2006-04-16 14:39  castaglia

	* ChangeLog:
	  Updating the ChangeLog.

2006-04-16 14:36  castaglia

	* contrib/dist/rpm/proftpd.spec, include/version.h, NEWS:
	  Preparing for release of 1.3.0-final.

2006-04-10 09:41  castaglia

	* lib/glibc-mkstemp.c:
	  Fix typo in mkstemp() implementation, noted by Charles Seeger.

2006-04-07 18:20  castaglia

	* doc/howto/ConfigFile.html:
	  Update the description of the User/Group directives to mention
	  effective versus real privs, and how some programs report on real
	  instead of effective privs.

2006-03-22 14:10  castaglia

	* NEWS, lib/glibc-glob.c, lib/pwgrent.c, src/fsio.c:
	  Quell several compiler warnings:

	  Bug#2770 - FreeBSD compiler warning that "__GLIBC__" is not
	  defined.  Bug#2771 - FreeBSD compiler warning about undeclared
	  fgetpwent/fgetgrent		 functions.  Bug#2772 - FreeBSD
	  compiler warning that "_FILE_OFFSET_BITS" is not defined.

2006-03-22 13:45  castaglia

	* Make.rules.in, NEWS:
	  Bug#2733 - libtool requires sh/bash.

2006-03-22 10:51  castaglia

	* utils/: ftptop.c, scoreboard.c:
	  Minor fixes to ftptop: use snprintf(3) rather than sprintf(3),
	  and make sure that any scoreboard path set via the -f
	  command-line option actually exists.

2006-03-18 12:15  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2006-03-18 12:13  castaglia

	* NEWS, RELEASE_NOTES, contrib/dist/rpm/proftpd.spec,
	  include/version.h:
	  Rolling up RC5 release.

2006-03-17 10:52  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#2723 - mod_delay causes process to hang on OS X when proftpd
	  exits.

2006-03-16 18:12  castaglia

	* RELEASE_NOTES:
	  Updating the release notes for the RC5 release.

2006-03-16 10:06  castaglia

	* README.controls, doc/howto/Controls.html:
	  Make notes about how Controls are affected by ServerType.

2006-03-15 11:41  castaglia

	* src/main.c:
	  We need to copy the session addresses into memory after any
	  reverse DNS resolution is performed, not before.

2006-03-14 19:56  castaglia

	* NEWS, modules/mod_log.c, modules/mod_xfer.c, src/main.c:
	  Bug#2765 - Child process segfaults while handling a SIGTERM.	A
	  field from a structure whose memory had been freed by the time
	  the field was referenced was tickling the segfault.

2006-03-14 18:49  castaglia

	* modules/mod_auth.c:
	  Remove slightly misleading (and outdated) comment.

2006-03-14 18:47  castaglia

	* NEWS, modules/mod_auth.c:
	  Make the workaround for Bug#2717 be specific to glibc-2.3 or
	  greater, not to Linux in general.

2006-03-14 18:09  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2717 - Wrong timestamp in logs for chrooted processes.

2006-03-13 19:18  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2764 - REST command does not return an error for negative
	  numbers.

2006-03-11 16:16  castaglia

	* include/privs.h:
	  Remove some duplicating logging in the PRIVS_RELINQUISH macro
	  definition.

2006-03-11 09:27  castaglia

	* include/version.h:
	  Forgot to change the status back to "CVS", for now.

2006-03-09 10:50  castaglia

	* doc/contrib/mod_sql.html:
	  Add description of the SQLBackend directive.

2006-03-09 10:20  castaglia

	* configure:
	  Updating configure.

2006-03-09 10:12  castaglia

	* configure.in:
	  Updating changes made for fixing Bug#2759 so that the libsupp
	  library can be found.

2006-03-08 11:11  castaglia

	* configure:
	  Updating configure.

2006-03-08 11:06  castaglia

	* NEWS, configure.in:
	  Bug#2759 - Adding --with-includes to configure can cause problems
	  when building with other packages.

2006-03-06 13:49  castaglia

	* doc/howto/NAT.html:
	  Add a description of what can happen if the configured
	  PassivePorts range is too small.

2006-03-06 10:17  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec:
	  Bug#2757 - Add support for quota modules to RPM spec.

2006-03-01 09:00  castaglia

	* RELEASE_NOTES:
	  Updating release notes.

2006-03-01 08:45  castaglia

	* ChangeLog, NEWS, contrib/dist/rpm/proftpd.spec,
	  include/version.h:
	  Preparing for release of 1.3.0rc4.

2006-02-23 15:01  castaglia

	* doc/rfc/: draft-murray-auth-ftp-ssl-15.txt, rfc4217.txt:
	  The old IETF Draft which defined FTPS was finally upgraded to a
	  full-fledged RFC in Nov 2005, as RFC4217.

2006-02-23 14:42  castaglia

	* doc/howto/SQL.html:
	  Added FAQ about libz linker errors to SQL howto.

2006-02-21 09:51  castaglia

	* modules/mod_delay.c:
	  Add more debug logging, level 10, for when mod_delay mmaps or
	  munmaps.  This is for tracking down Bug #2723.  Also handle the
	  case where munmap(2) fails.

2006-02-20 22:55  castaglia

	* NEWS, modules/mod_core.c: Bug#2752 - FEAT reply not RFC 2389
	  compliant.

2006-02-07 17:25  castaglia

	* NEWS, src/data.c:
	  Bug#2746 - Data transfer function does not return error condition
	  in case of read errors.  Now the pr_data_xfer() loop will error
	  out if there is an error returned by pr_netio_read(), just as is
	  already done if there is an error returned by pr_netio_write().

2006-01-11 05:55  castaglia

	* doc/howto/: index.html, AuthFiles.html:
	  Added the AuthFiles howto (it was referenced by the ConfigFile
	  howto).

2006-01-04 05:31  castaglia

	* modules/mod_xfer.c:
	  Fix a warning about an unused variable.  The tcp_level variable
	  is really only used if TCP_CORK is defined; thus it should be
	  declared within an #ifdef TCP_CORK block.

2005-12-27 10:29  castaglia

	* RELEASE_NOTES:
	  Mention the OSX tweaks in the Release Notes.

2005-12-26 19:04  castaglia

	* src/main.c: Initialise the session.proc_prefix string upon client
	  connection.  There was a strange edge case, involving
	  mod_wrap-2.0.x, where proftpd was calling set_proc_title() using
	  a NULL session.proc_prefix.  GNU libc handles printfs of NULLs
	  gracefully, but other libc implementations (e.g. Solaris) are not
	  as forgiving; this edge case was leading to segfaults on those
	  platforms.

2005-12-19 10:59  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2735 - Allow REST 0 in ASCII mode.

2005-12-13 09:54  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2709 - mod_sql improperly strips spaces from names, allowing
	  for confusing authentication.

2005-12-07 14:15  castaglia

	* NEWS, modules/mod_auth_pam.c:
	  Bug#2729 - Authorative PAM authentication doesn't work.

2005-12-05 11:17  castaglia

	* RELEASE_NOTES, doc/howto/Quotas.html, doc/howto/index.html:
	  Adding Quotas howto to doc/ area.

2005-12-02 10:34  jwm

	* contrib/mod_ldap.c: some overdue cleanup: - use braces
	  everywhere. honestly, i don't know why i wrote code this way.  -
	  now that we're using strtoul() sanity checking on default
	  [UG]IDs, we	don't need the isdigit() checking - use
	  get_param_ptr for single-argument directives instead of
	  find_config() - if a directive is present (get_param_ptr()
	  returns non-NULL), assign its   value to the config variable; we
	  don't want to assume default values	in the variable
	  initialization as well as the getconf handler.

2005-12-02 09:04  jwm

	* contrib/mod_ldap.c: - complain about invalid default [UG]IDs -
	  only allocate enough arguments in the config_rec for LDAPDoAuth
	  and	LDAPDoUIDLookups to cover the arguments specified

2005-12-02 08:51  jwm

	* contrib/mod_ldap.c: - remove get_param_int() usage; store values
	  in an allocated pointer intsead - config handlers now take their
	  directive name from c->argv[0], saving   a few bytes of static
	  strings

2005-11-29 10:19  castaglia

	* doc/contrib/mod_tls.html:
	  Adding more specific instructions for what a
	  TLSCertificateChainFile should contain.

2005-11-28 18:42  castaglia

	* NEWS, src/inet.c:
	  Bug#2374 revisited, for the sake of updated Mac OSX releases.
	  When is a regression not a regression?  When it's the fault of
	  the host system, not the application code.  Sigh.

2005-11-19 11:44  castaglia

	* doc/howto/DSO.html:
	  Adding more comments to the DSO howto, based on user
	  feedback/questions.

2005-11-16 08:04  jwm

	* contrib/mod_ldap.c: release 2.8.16

2005-11-15 12:01  castaglia

	* doc/contrib/mod_quotatab.html:
	  Formatting changes.

2005-11-15 11:44  castaglia

	* doc/contrib/mod_quotatab.html:
	  Improve the mod_quotatab doc, emphasizing the definitions of
	  limit and tally tables.  Also add HTML anchors, for easier
	  referencing from the upcoming Quotas howto.

2005-11-14 09:47  castaglia

	* doc/contrib/mod_tls.html:
	  Update description of AllowDotLogin TLSOption, as proftpd now
	  will not prompt for a password if none is required.

2005-11-14 08:33  castaglia

	* NEWS, include/pr-syslog.h, lib/pr-syslog.c, src/log.c:
	  Bug#2705 - proftpd fails to log anything to syslog after dropping
	  privs on Solaris.

	  Since proftpd has custom syslog routines, we can simply add an
	  accessor function for setting the static log_facility variable.
	  libc-based syslogging cannot do this; proftpd used libc syslog
	  routines in the past, hence the need to call openlog() again if
	  the facility changed.

	  Thanks to Kostantinos Koukopoulos for the patch.

2005-11-12 10:25  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2712 - DisplayFirstChdir directive does not work.

2005-11-11 13:05  castaglia

	* NEWS, include/ctrls.h, modules/mod_ctrls.c, src/ctrls.c:
	  Bug#2711 - Controls socket detection broken.

2005-11-10 11:14  castaglia

	* src/ctrls.c:
	  Copy the full length of the socket path, including the
	  terminating NUL.

2005-11-08 09:59  castaglia

	* contrib/mod_tls.c:
	  Make the log messages generated during certificate verification a
	  little cleaner.  Also add explicit handling of the
	  INVALID_PURPOSE error case.

2005-11-08 08:13  castaglia

	* configure:
	  Updating configure.

2005-11-08 08:06  castaglia

	* NEWS, configure.in:
	  Bug#2708 - configure cannot detect some headers.

2005-11-04 08:36  castaglia

	* NEWS, src/log.c:
	  Bug#2706 - utmp/wtmp logging on NetBSD needs some tweaks.

2005-11-04 08:34  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2703 - Disk quota exceeded for small files not being
	  triggered.

2005-10-31 15:23  castaglia

	* include/version.h:
	  Bump version to 1.3.0rc4 (hopefully will turn out to be
	  1.3.0-stable).

2005-10-31 09:45  castaglia

	* ChangeLog:
	  One more update.

2005-10-31 09:39  castaglia

	* src/fsio.c:
	  Correct usage of pr_fsio_readlink().

2005-10-31 09:34  castaglia

	* NEWS, include/version.h, contrib/dist/rpm/proftpd.spec:
	  Preparing for 1.3.0rc3 roll.

2005-10-31 09:32  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2005-10-28 08:54  castaglia

	* RELEASE_NOTES:
	  Updating release notes.

2005-10-26 16:36  castaglia

	* src/fsio.c:
	  Drat.  Forgot to replace all occurrences of ->readlink() with
	  pr_fsio_readlink().

2005-10-26 09:53  castaglia

	* modules/mod_facl.c:
	  Use direct pointer assignment rather than acl_copy_entry(); the
	  latter is not needed.  Patch supplied by Patrick McHardy.

2005-10-26 09:34  castaglia

	* src/fsio.c:
	  When cleaning the path in pr_insert_fs(), only add a trailing
	  path separator if the original path had one _and_ the current
	  cleaned path does _not_ have one.  Thanks to Patrick McHardy for
	  pointing this out.

2005-10-26 09:19  castaglia

	* src/fsio.c:
	  Patrick McHardy pointed out that in a couple of places, the FSIO
	  API uses the readlink function pointer, registered for an fs_t,
	  directly.  However, it is not required for registered fs_ts to
	  provide any particular FSIO function.  Thus pr_fsio_readlink(),
	  which iterates through the fs layers in order to find the first
	  that does provide a readlink function, should be used.

2005-10-23 14:50  castaglia

	* contrib/mod_sql.c:
	  Fix a segfault expanding the '%h' sequence for an SQLLog EXIT
	  command by using the proper API.  Related to Bug #2695.

2005-10-20 08:33  castaglia

	* doc/contrib/mod_tls.html:
	  Fixed example installation instructions for mod_tls.

2005-10-19 16:33  castaglia

	* configure:
	  Updating configure.

2005-10-19 16:28  castaglia

	* configure.in, config.h.in, include/ctrls.h, modules/mod_ctrls.c,
	  src/ctrls.c:
	  Change the location of the logic used to determine whether the
	  platform prefers S_ISFIFO or S_ISSOCK for detecting Unix domain
	  sockets.  Rather than using a test program as part of the
	  configure script, move the check into the init_ctrls() code, so
	  that it can be done at run-time.

2005-10-18 16:27  castaglia

	* contrib/mod_sql.c, modules/mod_log.c:
	  Fix handling of the %f log variable for the RNTO command.  Both
	  mod_log and mod_sql were using session.xfer.path for %f, when in
	  the case of RNTO, the %f that is desired is actually the argument
	  of the command, cmd->arg, not session.xfer.path.

2005-10-18 11:30  castaglia

	* contrib/mod_sql.c, modules/mod_log.c:
	  When expanding the %J log variable (for command arguments), be
	  sure to hide the arguments for the PASS command.

2005-10-10 10:58  castaglia

	* README.IPv6, src/netacl.c:
	  Only use the full range of characters which appear in an IPv6
	  (and IPv4) address when IPv6 support is enabled.

	  Also, document the case where, when IPv6 support *is* enabled,
	  certain DNS names are not handled as one would expect, due to the
	  heuristics used by the ACL parser.

2005-10-08 13:51  castaglia

	* RELEASE_NOTES, doc/howto/Filters.html, doc/howto/Regex.html,
	  doc/howto/index.html:
	  Add the regular expression tutorial to the doc/howto/ area.

2005-10-08 13:34  castaglia

	* RELEASE_NOTES:
	  Add some notes to the RELEASE_NOTES file for the upcoming
	  1.3.0rc3 release.

2005-10-08 13:16  castaglia

	* configure:
	  Updating configure.

2005-10-08 13:14  castaglia

	* config.h.in, configure.in, modules/mod_ctrls.c:
	  Add an autoconf check to see if the platform prefers S_ISFIFO or
	  S_ISSOCK for Unix domain sockets.  It seems that some systems
	  (e.g. UnixWare) prefer S_ISFIFO, even though the file is
	  created/bound using socket(2)/bind(2) rather than mknod(2).
	  Isn't portability grand.

	  The added test defines a PR_ISSOCK_UNIX macro, defined to the
	  appropriate S_IS* macro, for use in proftpd code.

2005-09-28 11:50  castaglia

	* doc/howto/Limit.html:
	  Style.

2005-09-27 19:06  castaglia

	* src/: dirtree.c, support.c:
	  Style.

2005-09-27 09:22  castaglia

	* src/response.c:
	  Style.

2005-09-27 09:11  castaglia

	* NEWS, src/response.c:
	  Bug#2692 - R_DUP response messages can break the FTP protocol
	  responses.

2005-09-27 09:08  castaglia

	* NEWS, include/privs.h:
	  Bug#2682 - Signals can interrupt privilege switching.  To guard
	  against this, the PRIVS macros now all contain
	  pr_signals_block()/pr_signals_unblock() guards.

2005-09-26 16:36  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2697 - Improper SSL session shutdown sequence used for some
	  FTPS clients.

2005-09-21 10:40  castaglia

	* modules/mod_core.c:
	  Clean up the debug logging done when handling config directive
	  regexes.  No need to report on the memory location for the
	  allocated regex.

2005-09-20 18:08  castaglia

	* doc/contrib/mod_tls.html:
	  Typo.

2005-09-20 18:04  castaglia

	* doc/contrib/mod_tls.html:
	  Use of the StdEnvVars TLSOption does not necessarily increase the
	  process memory footprint; it depends on the various memory
	  allocator caching strategies involved.

2005-09-20 15:45  castaglia

	* doc/contrib/mod_tls.html:
	  Enhancing the explanations of the TLSCACertificateFile and
	  TLSRandomSeed directives.

2005-09-20 11:33  castaglia

	* doc/contrib/mod_tls.html:
	  Minor updates to mod_tls doc.

2005-09-19 14:35  castaglia

	* NEWS, contrib/mod_radius.c, contrib/mod_sql.c, include/netaddr.h,
	  src/log.c, src/main.c, src/netaddr.c:
	  Bug#2695 - Client IP/host is not logged when client exits.

2005-09-19 10:14  castaglia

	* modules/mod_xfer.c:
	  Style.

2005-09-08 11:36  castaglia

	* README.modules:
	  Minor corrections to the location of contrib module
	  documentation, thanks to Sven Hoexter.

2005-09-08 09:39  castaglia

	* contrib/mod_tls.c:
	  Log in the TLSLog when mod_tls denies FTP commands because of the
	  configured security policy.

2005-09-04 17:05  castaglia

	* src/netaddr.c:
	  When reporting DNS resolution errors, report the type of address
	  requested, i.e. IPv4 or IPv6.

2005-09-04 16:57  castaglia

	* NEWS, include/parser.h, src/main.c, src/parser.c:
	  Bug#2689 - Parser does not complain about unclosed configuration
	  sections.

2005-08-29 18:45  castaglia

	* RELEASE_NOTES:
	  Fix typo.

2005-08-28 11:01  castaglia

	* src/fsio.c:
	  After cleaning the path given to pr_insert_fs(), we make sure it
	  has a trailing '/' path separator character.	However, this is
	  only necessary if the path being inserted is not '/' itself.
	  Check for that case, and make sure to not add the trailing '/' if
	  it is not needed.

2005-08-25 10:53  castaglia

	* contrib/mod_tls.c:
	  The mod_tls version information was missing from a couple of log
	  messages.

2005-08-24 09:10  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2685 - ListOptions' max parameters cannot be set higher than
	  255.

2005-08-23 09:50  castaglia

	* modules/mod_auth.c, modules/mod_core.c, src/main.c:
	  Log, at debug level 6, if there was an error displaying a Display
	  file.

2005-08-23 09:25  castaglia

	* src/dirtree.c:
	  Add explanatory comment.  When researching a problem earlier, I
	  was a bit confused by the reuse of a pool variable; the comment
	  is a reminder of what is going on.

2005-08-16 09:06  castaglia

	* INSTALL:
	  Update the section of the INSTALL doc that talks about xinetd
	  configuration; as of xinetd-2.3.11, the 'RECORD' logging option
	  has been deprecated.

2005-08-10 09:08  jwm

	* README.LDAP: update README.LDAP; oops, i've been forgetting about
	  this

2005-08-07 09:35  castaglia

	* modules/mod_core.c:
	  When reporting on use or nonuse of <IfModule> and <IfDefine>
	  sections, correctly report the "!" character.  Otherwise, the
	  reporting is confusing.

2005-08-07 09:01  castaglia

	* contrib/mod_tls.c:
	  When handling any error returned by SSL_shutdown(3) (after it has
	  been called the second time), and the error is not explicitly
	  handled by the switch statement, log the error code.	This will
	  help in debugging certain cases where tls_get_error() returns
	  "(unknown)", which possibly indicates no error occurred.

2005-08-07 08:46  castaglia

	* configure:
	  Updating configure.

2005-08-07 08:44  castaglia

	* NEWS, configure.in:
	  Bug#2676 - configure option --disable-ipv6 enables IPv6.

2005-08-04 14:06  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2674 - mod_sql string escape problem during group lookups.

2005-08-03 10:08  castaglia

	* contrib/mod_radius.c:
	  Pad the size of the radius_packet_t structure.

2005-08-03 10:06  castaglia

	* NEWS, contrib/mod_radius.c:
	  Bug#2669 - mod_radius segfaults if PASS command sent with no USER
	  command.

2005-08-02 16:38  castaglia

	* doc/howto/ListOptions.html:
	  Fix documentation for "-a" ListOption.

2005-08-02 08:53  castaglia

	* NEWS, modules/mod_ctrls.c:
	  Bug#2668 - mod_ctrls fails to open socket during SIGHUP.

2005-08-01 18:34  castaglia

	* modules/mod_facl.c:
	  Add debugging output, level 6, showing when mod_facl has
	  successfully registered its FS handler.

2005-08-01 13:49  castaglia

	* modules/mod_ctrls.c:
	  Display the mod_ctrls version when using `proftpd -vv'.

2005-07-31 20:16  castaglia

	* src/ftpdctl.c:
	  Display the name of the socket path being contacted when `ftpdctl
	  -v' is used.

2005-07-31 20:15  castaglia

	* NEWS:
	  Bug#2667 - mod_tls handles SIGHUP badly.  Stop registering the
	  handler for the "core.postparse" event in the "core.restart"
	  event handler; such multiple registrations cause the
	  "core.postparse" event handler to be invoked multiple times.

2005-07-30 18:25  castaglia

	* contrib/mod_tls.c:
	  The "core.restart" event handler for mod_tls was registering a
	  handler for the "core.postparse" event; however, one was already
	  being registered.  The duplicate "core.postparse" registrations
	  would cause the handler to be called repeatedly, leading to
	  locking of key passphrases into memory multiple times and other
	  unintended funniness.

2005-07-27 11:45  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2662 - OpenSolaris/Solaris 11 has TCP_CORK but not SOL_TCP.

2005-07-27 10:48  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec:
	  Bug#2660 - Add mod_facl in rpm spec file.

2005-07-26 19:08  castaglia

	* contrib/mod_tls.c:
	  Explicitly mention that $SSL_CERT_DIR is an environment variable.

2005-07-24 12:25  castaglia

	* include/version.h:
	  Updating version.

2005-07-24 11:21  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2005-07-24 11:15  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for release of 1.3.0rc2.

2005-07-24 11:08  castaglia

	* NEWS, contrib/mod_radius.c:
	  Bug#2658 - Segfault in mod_radius when using long password.

2005-07-21 15:00  castaglia

	* RELEASE_NOTES:
	  Fix typo.

2005-07-20 17:43  castaglia

	* contrib/mod_tls.c:
	  Slight paranoia about calling BIO_free() on possibly NULL
	  pointer.

2005-07-20 17:40  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2657 - Segfault in tls_get_error() function in mod_tls.

2005-07-18 17:30  castaglia

	* doc/howto/: Classes.html, SQL.html:
	  Updating Class and SQL howtos.

2005-07-15 15:13  castaglia

	* NEWS:
	  Minor rewording of NEWS, with respect to POSIX ACLs.

2005-07-08 08:53  castaglia

	* RELEASE_NOTES:
	  Updating the release notes.

2005-07-08 08:26  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2653 - When MaxStoreFileSize is reached, error should be
	  EDQUOT rather than EPERM.

2005-07-07 07:45  castaglia

	* NEWS, src/data.c:
	  Bug#2560 - Reporting errors when user filesystem quota is
	  exceeded.

2005-07-07 00:10  castaglia

	* modules/mod_log.c:
	  With the fixing of Bug #1965, the mod_log module no longer needs
	  a PRE_CMD handler in order to properly log the QUIT command; the
	  POST_CMD C_ANY handler suffices.  In fact, the PRE_CMD C_QUIT
	  handler currently in place means that the QUIT command would be
	  logged twice in an ExtendedLog.

2005-07-05 09:11  castaglia

	* doc/howto/: DNS.html, VirtualUsers.html, index.html:
	  Adding DNS, VirtualUsers howtos.

2005-07-05 08:49  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2645 - SQLShowInfo format string vulnerability.

2005-07-05 08:42  castaglia

	* NEWS, src/response.c:
	  Bug#2646 - ftpshut format string vulnerability.

2005-07-03 11:52  castaglia

	* contrib/mod_ldap.c, contrib/mod_radius.c, contrib/mod_sql.c,
	  contrib/mod_tls.c, modules/mod_auth.c, modules/mod_auth_file.c,
	  modules/mod_auth_pam.c, modules/mod_auth_unix.c:
	  Update the auth modules to set the session.auth_mech member with
	  the name of the module which successfully authenticates a user.

2005-07-03 11:13  castaglia

	* NEWS:
	  Bug#2375 - Slow directory listing with several blank .ftpaccess
	  files.

2005-07-03 11:08  castaglia

	* src/dirtree.c:
	  When parsing .ftpaccess files, check that the size of the
	  .ftpaccess file is non-zero before handling it.  This is related
	  to Bug #2375, if not _the_ culprit.  I suspect that there are
	  more improvements to be made with regards to .ftpaccess file
	  processing, though.

2005-07-02 11:41  castaglia

	* NEWS, contrib/mod_sql.c:
	  Fix segfault where using SQLLog to execute a SQLNamedQuery (which
	  uses %L or %a) for the EXIT command would attempt to use freed
	  memory.

2005-07-02 11:06  castaglia

	* modules/mod_xfer.c:
	  Set the current working directory, in the FSIO layer, before an
	  open() call.	This may be the cause of some strange behaviors
	  seen with some of my FSIO modules (i.e. mod_md5).

2005-07-02 10:59  castaglia

	* modules/mod_delay.c:
	  More bounds checking in mod_delay, as part of an investigation
	  into Bug #2621 using valgrind.

2005-06-29 17:39  castaglia

	* NEWS, include/conf.h:
	  Bug#2647 - Improper "socklen_t" redefine for HP-UX when using
	  X/Open.

2005-06-29 12:11  castaglia

	* doc/modules/mod_delay.html:
	  This document covers mod_delay, not mod_dso.	Fix typo.

2005-06-27 13:40  castaglia

	* NEWS, contrib/mod_sql_mysql.c:
	  Bug#2644 - mod_sql_mysql should handle old MySQL password format
	  more gracefully.

2005-06-26 22:38  castaglia

	* configure:
	  Updating configure.

2005-06-26 22:25  castaglia

	* config.h.in, configure.in:
	  Check for the size of a time_t.  We do not need this immediately,
	  but we will soon.

2005-06-23 16:23  castaglia

	* contrib/mod_quotatab_sql.c:
	  Fix a rather broken assignment.  Newer versions of gcc, being
	  less lenient, choke on this assignment whereas older versions of
	  gcc let it pass.

2005-06-22 13:56  castaglia

	* contrib/mod_tls.c:
	  Always set the tls_pkey_list pointer to NULL after scrubbing the
	  list.  Also, be sure to scrub that list at session initialization
	  time if TLSEngine is not on for the session.

2005-06-22 10:22  castaglia

	* src/fsio.c:
	  The changes in the FSIO API to support chained FS objects changed
	  some things; the lookup_file_fs() function made assumptions which
	  were broken by those changes.  Update lookup_file_fs() to
	  properly deal with FS objects whose stat or lstat function
	  pointers may be NULL.

2005-06-21 18:58  castaglia

	* src/fsio.c:
	  Off by one in my calculation; PR_TUNABLE_PATH_MAX-1 is the last
	  usable index in the buffer.  Of course, I may still be wrong
	  here, but I'd rather be wrong by too large of a difference,
	  rather than too small.

2005-06-21 16:11  castaglia

	* src/fsio.c:
	  Tracking down a bug in my crufty mod_md5fs module revealed the
	  cause to be a subtle bug in pr_insert_fs().  The path provided by
	  the caller was being cleaned via pr_fs_clean_path(), which would
	  remove any trailing path separators.	However, in the case of
	  FSIO FS objects, that trailing separator is important.  Re-add it
	  if it was there.

2005-06-21 15:06  castaglia

	* configure:
	  Update configure.

2005-06-21 13:54  castaglia

	* src/bindings.c:
	  The ipv6_supported variable need only be defined if --enable-ipv6
	  is used.

2005-06-21 11:49  castaglia

	* configure.in:
	  If the --enable-ctrls configure option is used, mod_ctrls will be
	  built as a static module.  To get mod_ctrls to be built as a
	  shared module, use --enable-ctrls and list mod_ctrls in the
	  --with-shared list.  However, I have not tested how well
	  mod_ctrls behaves as a shared module...

2005-06-21 11:27  castaglia

	* src/main.c:
	  Display the default libexec/ directory for the -V option, if DSO
	  support is enabled.

2005-06-21 10:22  castaglia

	* configure:
	  Updating configure.

2005-06-21 10:02  castaglia

	* configure.in, src/bindings.c:
	  Undo yesterday's autoconf change for IPv6 support detection.
	  Instead, move that detection into init_bindings(), although I
	  suspect that it will be needed in other places of the code as
	  well.  At least this way, though, a proftpd compiled using
	  --enable-ipv6 on an IPv4 box will still start up properly and
	  accept connections.

2005-06-21 06:54  castaglia

	* NEWS:
	  Update the description of Bug #2573, making note of the changed
	  behavior and how to address it (as per Bug #2640).

2005-06-20 15:57  castaglia

	* configure:
	  Updating configure.

2005-06-20 15:35  castaglia

	* configure.in:
	  Have autoconf check for IPv6 support when the --enable-ipv6
	  configure option is used.  It is completely possible for an
	  IPv4-only box to be used to compile a proftpd configured using
	  --enable-ipv6.  When that proftpd is started on the IPv4-only
	  box, it would choke inexplicably.  This is due to changes made
	  for Bug #2758.

2005-06-20 15:16  castaglia

	* src/netaddr.c:
	  Log when we are looking for IPv4 addresses via DNS, and when
	  we're looking for IPv6 addresses.

2005-06-19 22:41  castaglia

	* src/mkhome.c:
	  Make sure to reset the umask in the case where mkdir() could
	  fail.  Otherwise, the umask of the process will be left in the
	  wrong state.

2005-06-19 19:05  castaglia

	* doc/contrib/mod_ifsession.html:
	  Updating mod_ifsession docs.

2005-06-18 14:05  castaglia

	* contrib/mod_tls.c:
	  OpenSSL 0.9.8 changed some macro names (and did not document it
	  *sigh*).  Update mod_tls to use the new names as necessary.

2005-06-18 11:16  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#2630 - Use of mmap in mod_delay may be problematic on HP-UX.

2005-06-16 14:27  castaglia

	* include/table.h, src/table.c:
	  Add a new table flag, PR_TABLE_FL_USE_CACHE.	By default, this
	  flag is off.	The caching behavior of previously-looked up keys
	  in the table accessors was a bit confusing (which itself
	  indicates the need for better table documentation).  Make use of
	  that lookup cache disabled by default, so that the behavior is
	  least surprising to developers.  Callers that require higher
	  performance tables can enable the flag as needed.

2005-06-16 11:58  castaglia

	* src/table.c:
	  Added some missing pr_signals_handle() calls in while loops.

2005-06-15 10:38  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2639 - HiddenStores does not work.

2005-06-15 08:40  castaglia

	* src/dirtree.c:
	  Set a valid errno for pr_is_boolean().

2005-06-14 11:11  castaglia

	* src/auth.c:
	  Add debugging, level 10, of retrieved user/group names and
	  UIDs/GIDs, similar to what is done during in pr_auth_getgroups().

2005-06-13 18:23  castaglia

	* contrib/mod_radius.c, contrib/mod_sql.c, contrib/mod_tls.c,
	  include/compat.h, include/log.h, modules/mod_core.c,
	  modules/mod_ctrls.c, modules/mod_log.c, src/log.c, src/xferlog.c:

	  Move the LOG_* macros (for indicating writable dirs, symlinks,
	  and permission modes) into the PR_ namespace.  Provide
	  compatibility macros for source compatibility for other modules,
	  for now.

2005-06-13 15:01  castaglia

	* include/log.h, modules/mod_core.c, modules/mod_log.c, src/log.c:
	  Move the log_str2sysloglevel() function into the 'pr_' namespace.

2005-06-13 09:27  castaglia

	* NEWS, modules/mod_xfer.c, src/data.c:
	  Bug#2636 - Data connection failure when handling STOR does not
	  trigger error response.

2005-06-11 21:42  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2637 - <Limit STAT> does not work.

2005-06-11 17:36  castaglia

	* include/: compat.h, dirtree.h:
	  Moving some macro (name redefinitions) into the more appropiate
	  compat.h header.

2005-06-11 16:46  castaglia

	* contrib/mod_tls.c:
	  Style consistency and cleanup.

2005-06-11 15:18  castaglia

	* contrib/mod_tls.c:
	  Comment typo.

2005-06-10 10:21  castaglia

	* contrib/mod_tls.c, include/auth.h, modules/mod_auth.c,
	  src/auth.c:
	  Removing the overloaded use of pr_auth_authenticate() in mod_auth
	  for allowing RFC2228 modules to authenticate a user using
	  non-PASS means.

	  Instead, there is a new Auth API function,
	  pr_auth_requires_pass().  All modules have a chance to provide
	  handlers for this auth command; if any module can successfully
	  authenticate the client without requiring the PASS command, then
	  pr_auth_requires_pass() will return FALSE.  If and only if
	  pr_auth_requires_pass() returns FALSE will mod_auth send the 232
	  response code to the client, indicating that no PASS command is
	  required.

2005-06-10 10:06  castaglia

	* NEWS, lib/pr-syslog.c:
	  Bug#2632 - Invalid application of `sizeof' to an incomplete type
	  on AIX.

2005-06-10 09:25  castaglia

	* doc/howto/NAT.html:
	  Provide an example configuration for the LAN/WAN
	  MasqueradeAddress issue.

2005-06-09 06:14  castaglia

	* doc/howto/SQL.html:
	  Fix typo.

2005-06-08 11:33  castaglia

	* NEWS, contrib/mod_radius.c:
	  Bug#2631 - Segfault when using RadiusAcctServer.

2005-06-08 09:21  castaglia

	* doc/howto/SQL.html:
	  Grgoire COLBERT contributed a snippet of PHP code that can be
	  used to generate base64-encoded MD5-digested password strings,
	  suitable for use by mod_sql.

2005-06-07 11:58  castaglia

	* contrib/mod_radius.c:
	  Minor style cleanup.

2005-06-06 10:45  castaglia

	* doc/contrib/mod_rewrite.html:
	  No need for the trailing /, as the closing } serves as the
	  delimiter.

2005-06-06 10:40  castaglia

	* doc/contrib/mod_rewrite.html:
	  The example RewriteRule directive provided had a problem.  One of
	  its parameters contained an embedded whitespace, and the example
	  did not enclose that parameter in quotations, which meant that
	  the config parser would split that parameter incorrectly.

2005-06-05 11:26  castaglia

	* NEWS, README.FreeBSD:
	  Bug#2250 - Add ports, compiling info to FreeBSD README.

2005-06-05 11:20  castaglia

	* README:
	  Updated README to use "1.3.x" as ProFTPD version, rather than
	  "1.2.x".

2005-06-03 00:12  castaglia

	* NEWS, include/fsio.h:
	  Bug#2624 - "fh_data" macro collision causes compiler error on
	  Tru64 V5.1A.

2005-06-02 08:25  castaglia

	* contrib/mod_radius.c:
	  Since mod_radius is distributed with the proftpd source, it
	  should not have an "RC" version.  It will now be officially
	  version 0.8.

2005-06-01 21:43  castaglia

	* modules/mod_delay.c:
	  Bug#2622 - Segfault seen randomly in mod_delay.

	  This patch changes the bounds check for the j variable, which is
	  decrementing, to be as necessary.

2005-06-01 16:21  castaglia

	* modules/mod_core.c:
	  Add better logging of when PORT, PASV, EPRT, and EPSV are denied
	  because of <Limit> configurations.  Minor code style changes.

2005-06-01 14:07  castaglia

	* doc/contrib/mod_radius.html:
	  Remove extraneous space.

2005-06-01 14:03  castaglia

	* doc/contrib/mod_radius.html:
	  Updating mod_radius documentation.

2005-06-01 13:52  castaglia

	* README.Solaris2.5x:
	  Use "ProFTPD", not "ProFTP".

2005-06-01 13:50  castaglia

	* contrib/mod_radius.c:
	  More strict checking of the number of parameters for the
	  RadiusLog directive.

	  In general, this a problem with the CHECK_ARGS macro.  It allows
	  >= n parameters, where it should check strictly for == n.

2005-06-01 10:21  castaglia

	* NEWS, src/bindings.c, src/netaddr.c:
	  Bug#2578 - ProFTPD does not listen on IPv6 addresses on FreeBSD.

2005-05-31 16:40  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#2622 - Segfault seen randomly in mod_delay.

2005-05-31 09:15  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#2601 - mod_delay sometimes delays for a long time.

2005-05-20 19:16  castaglia

	* modules/mod_auth.c:
	  If we are unable to resolve a user's home directory, try to
	  interpolate it (as when the home dir is "~"), in order to provide
	  a more informative log message to the admin.	This will greatly
	  help in debugging.

2005-05-10 09:35  castaglia

	* NEWS, lib/pr-syslog.c:
	  Bug#2585 - Proftpd does not write RFC 3164 compliant messages
	  into /dev/log.

2005-05-08 13:42  castaglia

	* configure:
	  Updated configure.

2005-05-08 13:37  castaglia

	* NEWS, configure.in:
	  Bug#2598 - Build system should check for duplicate module
	  requests.

2005-05-07 12:19  castaglia

	* Makefile.in, modules/Makefile.in:
	  Make the use of `test' in the Makefiles non-silent, to aid in
	  debugging build issues.

2005-05-07 10:52  castaglia

	* contrib/mod_load/Makefile.in:
	  Make mod_load's Makefile portable.  Related to Bug#2589.

2005-05-07 10:38  castaglia

	* NEWS:
	  Wrong bug number.

2005-05-07 10:38  castaglia

	* NEWS, modules/Makefile.in:
	  Bug#2589 - Makefile in modules/ directory is not portable.

2005-05-07 10:01  castaglia

	* src/netaddr.c:
	  Typo; we were checking the wrong variable, which causes the wrong
	  error message to (possibly) be displayed if there were resolver
	  errors.

2005-05-05 22:53  castaglia

	* NEWS, modules/mod_core.c, modules/mod_ctrls.c, src/table.c:
	  Bug#2605 - Compiler warnings/errors about missing typecasts on
	  HP-UX.

2005-05-05 22:33  castaglia

	* contrib/mod_tls.c:
	  Bug#2607 - Compiler warnings about missing typecasts in mod_tls
	  on HP-UX.

2005-05-05 22:24  castaglia

	* contrib/mod_rewrite.c:
	  Bug#2606 - Compiler warnings about missing typecasts in
	  mod_rewrite on HP-UX.

2005-04-30 17:04  castaglia

	* src/netaddr.c:
	  Log, at debug level 10, if we're returning an IP address when a
	  DNS name was requested because of the UseReverseDNS setting.

2005-04-30 16:32  castaglia

	* configure:
	  Updating configure.

2005-04-30 16:27  castaglia

	* configure.in:
	  Removed --disable-auth-unix configure option.  It isn't very
	  useful; trying to actually use a proftpd compiled with that
	  option would not work well.  Perhaps it will come back later, in
	  a better/more usable fashion.

2005-04-30 12:59  castaglia

	* NEWS, contrib/mod_ctrls_admin.c,
	  doc/contrib/mod_ctrls_admin.html:
	  Add new 'dns' control action to mod_ctrls_admin, for setting
	  UseReverseDNS at runtime.

2005-04-30 12:07  castaglia

	* src/bindings.c:
	  Add debugging denoting when there is no exactly matching vhost
	  configured for an incoming connection and we end up using the
	  DefaultServer.

2005-04-30 11:03  castaglia

	* NEWS, modules/mod_auth_unix.c:
	  Bug#2582 - ProFTPD on Tru64 with SIA does not call
	  sia_ses_estab().

2005-04-29 09:34  castaglia

	* configure:
	  Updating configure.

2005-04-29 09:26  castaglia

	* configure.in, config.h.in, modules/mod_auth_unix.c:
	  Systems with shadow library support (e.g. Solaris) may require
	  that the setspent(3) function be called prior to calling
	  getspent(3) et al.

2005-04-27 14:04  castaglia

	* configure:
	  Updating configure.

2005-04-27 14:01  castaglia

	* NEWS, config.h.in, configure.in:
	  Bug#2588 - AIX requires _USE_IRS #define to use hstrerror().

2005-04-25 15:12  castaglia

	* src/bindings.c:
	  It's possible for pr_ipbind_listen() to be called without any
	  calls to pr_ipbind_create().	The ipbind_pool was being
	  initialized in pr_ipbind_create() if it didn't already exist.
	  pr_ipbind_listen() tries to use ipbind_pool, but did not check to
	  see if ipbind_pool was initialized.  So when pr_ipbind_listen()
	  was called without any prior calls to pr_ipbind_create(), proftpd
	  would segfault.  Oops.

2005-04-24 14:48  castaglia

	* config.h.in:
	  Typo.

2005-04-23 15:54  castaglia

	* modules/mod_delay.c:
	  Have mod_delay log the random value it adds to the delay factor,
	  at debug level 10.  Is this where the extra-long delays are
	  coming from?	Perhaps...

2005-04-23 11:03  castaglia

	* contrib/mod_quotatab.c:
	  More formatting tweaks for mod_quotatab's display in response to
	  a SITE QUOTA command.

2005-04-23 09:13  castaglia

	* contrib/mod_quotatab.c:
	  Fix minor formatting/spacing issue seen when QuotaDisplayUnits is
	  set to something other than 'b' and the number of units to be
	  displayed is not "unlimited".

2005-04-23 08:53  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2596 - STAT command can cause segfault.

2005-04-22 09:26  castaglia

	* contrib/mod_sql.c:
	  Be consistent in the style/formatting of the "cache hit for"
	  messages by quoting the group name, too.

2005-04-21 10:58  castaglia

	* NEWS, modules/Makefile.in:
	  Bug#2593 - `make install-modules' does not honour DESTDIR
	  enviroment variable.

2005-04-21 10:33  jwm

	* .cvsignore, lib/libltdl/.cvsignore: update for libtool

2005-04-21 10:08  jwm

	* modules/.cvsignore: - ignore libtool-generated files -
	  mod_linuxprivs is gone

2005-04-17 10:12  castaglia

	* NEWS, modules/mod_delay.c, modules/mod_xfer.c:
	  Bug#2590 - AIX uses unsigned int for ULONG_MAX, causing printf
	  format warning Bug#2591 - wrong argument type in call to
	  pr_log_debug in mod_delay.c on AIX

2005-04-15 14:18  castaglia

	* NEWS, src/dirtree.c:
	  Bug#2587 - HideNoAccess does not work for DefaultRoot/<Anonymous>
	  logins.

2005-04-14 22:55  castaglia

	* include/: auth.h, compat.h, conf.h, log.h:
	  Add a header whose role is to hold preprocessor directives for
	  backward compatibility.  Function renames, macro changes, etc,
	  that sort of thing.

2005-04-11 10:02  castaglia

	* NEWS, contrib/mod_sql_postgres.c:
	  Bug#2584 - mod_sql_postgres missing end-of-comment character.

2005-04-11 09:47  castaglia

	* include/version.h:
	  Update version.

2005-04-10 16:21  castaglia

	* NEWS:
	  Updating release date for 1.3.0rc1.

2005-04-10 16:19  castaglia

	* src/data.c:
	  As per comments in Bug #2509, it seems that Linux x86_64
	  environments do not support sendfile() for more than 2^31 bytes.
	  I don't know if Solaris suffers from the same design.

	  Have I ever mentioned how much I find the sendfile API to be
	  broken?

2005-04-10 16:15  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#2554 - mod_delay gets segfault-signal on several logins.

2005-04-04 13:40  castaglia

	* NEWS, modules/mod_auth_unix.c:
	  Bug#2580 - ProFTPD on Tru64 with SIA allows login with blank
	  password.

2005-03-26 13:10  castaglia

	* NEWS, include/version.h, contrib/dist/rpm/proftpd.spec,
	  ChangeLog:
	  Preparing for release of 1.3.0rc1.

2005-03-26 12:53  jwm

	* RELEASE_NOTES: mod_ldap is now 2.8.15

2005-03-26 12:48  castaglia

	* RELEASE_NOTES:
	  Updating release notes, preparing for release of 1.3.0rc1.

2005-03-25 08:41  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2493 - mod_tls should support CCC command.

2005-03-18 10:25  castaglia

	* NEWS, src/support.c:
	  Bug#2576 - PWD command does not handle " character properly.

2005-03-16 23:12  castaglia

	* modules/mod_auth.c:
	  Call PRIVS_ROOT before PRIVS_REVOKE, to make absolutely sure that
	  the real and effective UIDs are as needed in order for privs
	  revocation to work.

2005-03-16 08:16  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2551 - Recursive LIST with symlinked directories gives
	  duplicate results.

2005-03-15 22:16  castaglia

	* modules/mod_ls.c:
	  Cruft removal.

2005-03-12 09:36  castaglia

	* modules/mod_ls.c:
	  Fix an unreported bug where attempting to use the -t directory
	  listing option would trigger a segfault.

2005-03-11 12:44  jwm

	* contrib/mod_ldap.c: [no log message]

2005-03-08 09:06  castaglia

	* NEWS, src/pool.c:
	  Bug#2567 - Segmentation fault with 64-bit binary due to structure
	  layout difference.

2005-03-05 22:03  castaglia

	* contrib/mod_quotatab.c:
	  More consistent log messages.

2005-03-05 15:02  castaglia

	* contrib/mod_quotatab.c:
	  Fixed quotatab_fsio_write() to check the xfer limit as well as
	  the upload limit.

2005-03-05 14:55  castaglia

	* NEWS, contrib/mod_quotatab.c:
	  Bug#2515 - mod_quotatab should enforce hard limits at the
	  filesystem level.

2005-03-05 09:46  castaglia

	* NEWS, contrib/mod_tls.c, modules/mod_auth.c, src/auth.c:
	  Bug#2164 - Support non-PASS response codes.

2005-03-05 09:33  castaglia

	* NEWS, src/inet.c:
	  Bug#2559 - IPv6 socket option should be set for ServerType inetd.

2005-03-04 09:01  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug #2573 - TLSProtocol directive in proftpd.conf is ignored.

2005-03-02 12:33  castaglia

	* modules/mod_delay.c:
	  Allow for <IfClass>-based tweaks of the DelayEngine directive.

2005-02-27 18:50  castaglia

	* README.DSO:
	  Mention the DSO howto.

2005-02-27 11:23  castaglia

	* README.modules:
	  List mod_facl in the modules README.

2005-02-27 11:21  castaglia

	* README.facl:
	  Fleshing out the POSIX ACL doc.

2005-02-27 09:46  castaglia

	* README.DSO:
	  Update the DSO doc with information on where to find more
	  documentation for the mod_dso module.

2005-02-26 18:37  castaglia

	* README.DSO:
	  Adding more substance to the DSO doc.

2005-02-26 12:22  castaglia

	* RELEASE_NOTES:
	  Mention the new --enable-facl configure option, mod_facl module
	  in the release notes.

2005-02-26 09:55  castaglia

	* src/fsio.c:
	  Fix missing variable declaration.

2005-02-26 09:39  castaglia

	* configure:
	  Updating configure.

2005-02-26 09:28  castaglia

	* NEWS, README.facl, config.h.in, configure.in, include/conf.h,
	  include/dirtree.h, include/fsio.h, include/privs.h,
	  include/proftpd.h, include/support.h, modules/mod_auth.c,
	  modules/mod_facl.c, modules/mod_ls.c, src/dirtree.c, src/fsio.c,
	  src/main.c, src/support.c:
	  Bug #2331: Proftpd does not honor POSIX ACLs.

2005-02-24 18:01  castaglia

	* NEWS, contrib/mod_sql_mysql.c:
	  Bug #2563: Linking fails on Solaris with libz and libmysqlclient.

2005-02-24 16:00  castaglia

	* ChangeLog:
	  Updated ChangeLog.

2005-02-15 13:54  jwm

	* contrib/dist/rpm/proftpd.spec: i don't have access to red hat
	  machines anymore, so i'm no longer maintaining this

2005-02-07 10:15  castaglia

	* include/inet.h, src/inet.c:
	  Use "const char *" where appropriate.

2005-02-04 15:54  castaglia

	* NEWS, src/fsio.c:
	  Bug#2556: Rename of directory across devices fails.

2005-01-25 11:30  castaglia

	* NEWS, lib/libcap/cap_sys.c:
	  Bug#2503 - Bundled libcap library does not compile on IA64
	  machine.

2005-01-12 16:19  castaglia

	* modules/mod_ls.c:

	  The fix for Bug #2229 (rev 1.119 of modules/mod_ls.c)
	  inadvertently broke globbing; it was calling globfree(3) on a
	  struct whose members had been allocated from memory that was not
	  obtained via glob(3).  This is a bad combination.

2005-01-06 15:39  castaglia

	* contrib/mod_load/mod_load.c.in, contrib/mod_radius.c,
	  modules/mod_delay.c:
	  Fix compiler warnings (generated by gcc-3.4.2 on an AMD64 machine
	  running Linux 2.6.9).

2005-01-06 10:55  castaglia

	* src/bindings.c:
	  Fix segfault caused by a NULL listener_list.

2005-01-02 21:36  castaglia

	* doc/howto/Stopping.html:
	  Updating FAQ URL.

2005-01-02 16:21  castaglia

	* INSTALL:
	  Apparently configure scripts don't pass env vars very well to
	  sub-configure scripts.

2005-01-02 13:00  jwm

	* lib/glibc-hstrerror.c: silence ranlib's 'object contains no
	  symbols' warning if the host OS already has hstrerror()

2005-01-02 00:01  castaglia

	* RELEASE_NOTES:
	  Make a note to describe the addition of mod_delay to the module
	  list.

2005-01-01 12:15  castaglia

	* doc/contrib/mod_load.html:
	  Updating the mod_load docs to mention the provided Display
	  variables.

2005-01-01 12:06  castaglia

	* doc/howto/DisplayFiles.html:
	  Mention that other modules can add their own Display variables.

2005-01-01 12:04  castaglia

	* contrib/mod_load/mod_load.c.in:
	  Enhance mod_load to use the Variables API.

2005-01-01 11:42  castaglia

	* contrib/mod_load/configure:
	  Updating configure.

2005-01-01 11:41  castaglia

	* doc/contrib/mod_load.html:
	  Eliminated the need for Solaris users to do anything special when
	  building mod_load; its configure script handles everything.

2005-01-01 11:39  castaglia

	* contrib/mod_load/: configure.in, getloadavg.c, mod_load.c,
	  mod_load.c.in:
	  Modified the configure script to detect when additional libraries
	  are needed, and to generate mod_load.c from mod_load.c.in, with
	  the $Libraries$ tag properly populated.

	  Note that newer autoconf treatment of the AC_FUNC_GETLOADAVG
	  macro requires that a getloadavg.c file be present, even if
	  empty.  How annoying.

2005-01-01 11:13  castaglia

	* contrib/mod_load/mod_load.c:
	  No need for mod_load's getloadavg() function to be visible
	  outside of the source file.

2005-01-01 11:02  castaglia

	* contrib/mod_load/mod_load.c:
	  Fix some compiler warnings about formats.

	  Add an empty $Libraries$ tag.  Soon, mod_load's configure script
	  will process the mod_load source, and substitute in a list of
	  libraries that mod_load conditionally requires (e.g. libkstat on
	  Solaris).

2005-01-01 10:55  castaglia

	* contrib/mod_load/mod_load.c:
	  Slightly prettier code organization.

2005-01-01 10:49  castaglia

	* contrib/mod_load/mod_load.c:
	  Updating mod_load source style.

2005-01-01 10:42  castaglia

	* doc/contrib/index.html:
	  Update doc/contrib index to include mod_load reference.

2005-01-01 10:40  castaglia

	* README.modules, RELEASE_NOTES:
	  Add mod_load to the list of modules.

2005-01-01 10:37  castaglia

	* NEWS, contrib/mod_load/Makefile.in, contrib/mod_load/configure,
	  contrib/mod_load/configure.in, contrib/mod_load/mod_load.c,
	  contrib/mod_load/mod_load.h.in, doc/contrib/mod_load.html:
	  Bug#1651 - Add contrib module to limit connection acceptance
	  based on system load.

2005-01-01 10:36  castaglia

	* configure:
	  Updating configure.

2005-01-01 10:20  castaglia

	* modules/Makefile.in:
	  Fix the install target when handling only shared modules that
	  install themselves.

2004-12-31 19:02  castaglia

	* .autom4te.cfg, Make.rules.in, Makefile.in, NEWS, configure.in,
	  modules/Makefile.in:
	  Bug#2549 - Allow contrib modules to be built from multiple source
	  files.

2004-12-31 11:17  castaglia

	* doc/howto/FTP.html:
	  Updating the list of SITE commands supported by ProFTPD.

2004-12-31 10:55  castaglia

	* doc/howto/FTP.html:
	  Updating the list of FTP commands supported by ProFTPD.

2004-12-30 15:08  castaglia

	* contrib/mod_sql_mysql.c:
	  Log if mod_sql_mysql fails to authenticate a password using the
	  'backend' SQLAuthType because of a password mismatch.

2004-12-30 14:51  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2541 - <Directory ~user> path resolved at startup time,
	  rather than at session time.

2004-12-30 14:23  castaglia

	* NEWS, modules/mod_delay.c:
	  Bug#2540 - Fails to disable mod_delay if no DelayTable file
	  exists.

2004-12-23 12:17  castaglia

	* modules/: mod_auth.c, mod_core.c, mod_log.c:
	  More prettification of error messages.

2004-12-23 11:55  castaglia

	* contrib/mod_sql.c:
	  Makes for nicer error messages.

2004-12-22 22:58  castaglia

	* INSTALL:
	  Updating the installation notes.

2004-12-17 15:14  castaglia

	* modules/Makefile.in:
	  Make the Makefile for the modules/ directory nicer, so that when
	  developing shared modules within the source directory, make picks
	  up on the updated source file and does The Right Thing.

2004-12-17 13:56  castaglia

	* modules/mod_dso.c:
	  Avoid compiler warning about unused function.

2004-12-17 10:24  castaglia

	* NEWS, contrib/mod_ifsession.c:
	  Bug#2536 - mod_ifsession does not properly merge in all
	  directives.

2004-12-16 17:58  castaglia

	* src/sets.c:
	  Update xaset_insert_end() so that it updates the 'next' field of
	  the previous member in the set.

2004-12-16 17:25  castaglia

	* contrib/mod_ifsession.c:
	  Hide some of the label strings used by mod_ifsession by prefacing
	  their names with an underscore.  Such names are not displayed by
	  pr_config_dump().

2004-12-16 16:03  castaglia

	* contrib/mod_ldap.c:
	  Typo.

2004-12-16 15:54  castaglia

	* contrib/mod_ctrls_admin.c:
	  Support being unloaded as a shared module.

2004-12-16 15:37  castaglia

	* contrib/mod_rewrite.c:
	  Support being unloaded as a shared module.

2004-12-16 15:26  castaglia

	* contrib/mod_radius.c:
	  Add code to support being unloaded as a shared module.

2004-12-16 14:55  castaglia

	* contrib/: mod_quotatab.c, mod_quotatab.h, mod_quotatab_file.c,
	  mod_quotatab_ldap.c, mod_quotatab_sql.c:
	  Add a new quotatab_unregister_backend() function to the
	  mod_quotatab API, and rename quotatab_register() to
	  quotatab_register_backend().	This makes it consistent with
	  mod_sql's backend API, and also makes it possible to unregister a
	  quotatab backend module.

	  Adds support for graceful unloading of mod_quotatab et al as
	  shared modules.

2004-12-16 11:38  castaglia

	* contrib/mod_tls.c:
	  Add code to mod_tls to support being unloaded as a shared module.

2004-12-16 10:33  castaglia

	* modules/mod_dso.c, src/main.c:
	  Rather than having the core engine unload modules during a
	  restart, have them unloaded by mod_dso.  That's only fair, since
	  a) mod_dso was responsible for loading the modules in the first
	  place, and b) mod_dso also handles the unloaded of the handles
	  from libltdl, about which the core engine knows nothing.

2004-12-16 10:17  castaglia

	* contrib/: mod_sql.c, mod_sql_mysql.c, mod_sql_postgres.c:
	  Tweak the SQL modules to better handle being built as shared
	  modules.

2004-12-16 10:13  castaglia

	* src/main.c:
	  During a restart (e.g. SIGHUP), unload all non-static modules,
	  i.e. all shared modules that have been dynamically loaded.  This
	  is to handle the case where an admin removes a LoadModule
	  directive from proftpd.conf, then issues a SIGHUP.

	  Note that this requires changes to shared modules, to make sure
	  they unload themselves properly.  Such changes for the contrib/
	  modules will follow shortly.

2004-12-15 19:01  castaglia

	* include/event.h, src/event.c:
	  Tweak the Event API to allow blanket unregistration of all a
	  module's event listeners in one pr_event_unregister() call.

	  Gracefully avoid a possible segfault during pr_event_register().

2004-12-15 18:30  castaglia

	* src/auth.c:
	  'login' is a global variable somewhere, so compiling under
	  --enable-devel kicks up compiler warnings.

2004-12-15 18:23  castaglia

	* Makefile.in:
	  The shell's test function prefers to operate on single strings,
	  so enclose the expanded $SHARED_MODULE_OBJS list within
	  quotations.

2004-12-15 16:54  castaglia

	* doc/howto/DisplayFiles.html:
	  Updating the DisplayFiles doc with the newly added Display
	  variables.

2004-12-15 16:50  castaglia

	* doc/howto/: DisplayFiles.html, index.html:
	  Adding a doc covering the Display directives.

2004-12-12 15:55  castaglia

	* doc/howto/DSO.html:
	  Grammatical nicety.

2004-12-12 15:03  castaglia

	* doc/howto/ListOptions.html:
	  Updating URL for current location under doc/howto/.

2004-12-12 15:01  castaglia

	* doc/howto/: ListOptions.html, index.html:
	  Adding the ListOptions howto to the source distribution.

2004-12-12 14:57  castaglia

	* RELEASE_NOTES:
	  Update the release notes.

2004-12-12 14:56  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2534 - Add suport for -S ListOption, for sorting files by
	  file size.

2004-12-12 14:00  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2229 - NLST and LIST behave differently e.g. when listing an
	  empty directory.  Make the behavior between LIST and LIST
	  consistent with respect to empty directories, and when listing
	  nonexistent directories.

2004-12-12 13:52  castaglia

	* doc/howto/: DSO.html, index.html:
	  Adding DSO howto to source distribution.

2004-12-12 11:27  castaglia

	* doc/contrib/mod_sql.html:
	  Add documentation for the SQLEngine directive.

2004-12-12 09:53  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql.c:
	  Bug#2406 - Add a SQLEngine directive.

2004-12-11 21:59  castaglia

	* modules/: mod_ctrls.c, mod_site.c:
	  Use the Auth API functions in the 'pr_' namespace.

2004-12-11 16:14  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2027 - Add log message for timed out passive transfers.

2004-12-08 14:30  castaglia

	* doc/contrib/mod_quotatab.html:
	  Explicitly mention that only one type of limit is in effect at a
	  time, and that applicable limits for a given user are not
	  combined.

2004-12-05 00:12  castaglia

	* src/main.c:
	  Yet another place where main_server needs to be set to NULL
	  before calling free_pools().	Only affects servers built using
	  the --enable-devel=nodaemon option.

2004-12-05 00:03  castaglia

	* src/main.c:
	  If main_server is not set to NULL before freeing all of the pools
	  (from which main_server is allocated), segfaults can occur if
	  something tries to log a message.  Note that this only happens if
	  the --enable-devel configure option is used, so it doesn't affect
	  most users.

2004-12-04 23:58  castaglia

	* src/main.c:
	  Properly set session.c and session.d to NULL once we've closed
	  them.

2004-12-04 22:38  castaglia

	* doc/howto/Authentication.html:
	  Correct the RequireValidShell FAQ URL.

2004-12-04 21:50  castaglia

	* include/auth.h, modules/mod_auth.c, src/auth.c:
	  Move that code responsible for looking up the anonymous
	  configuration for a given user name, if applicable, out of
	  mod_auth.c and into the Auth API.  The main reason for this is to
	  allow contrib modules that may need to determine whether a given
	  login is to be handled anonymously (e.g.  mod_wrap, mod_sql) the
	  ability to use the same code as mod_auth, rather than having to
	  duplicate it themselves.  A nice side benefit as that the Auth
	  API function added, pr_auth_get_anon_config(), more legibly
	  describes what the function does.  This will help to make the
	  mod_auth code slightly easier to understand (for some value of
	  "easier").

2004-12-04 20:25  castaglia

	* doc/howto/Limit.html:
	  Add examples of blocking PORT or PASV commands.

2004-12-04 11:17  castaglia

	* doc/howto/: Upgrade.html, index.html:
	  Add an Upgrade mini-HOWTO to doc/howto/.

2004-12-04 01:20  castaglia

	* doc/contrib/mod_quotatab.html:
	  Fix up the links to the quotatab submodule docs.

2004-12-04 01:13  castaglia

	* doc/contrib/mod_quotatab.html:
	  Update the mod_quotatab installation instructions.

2004-12-03 23:52  castaglia

	* contrib/mod_quotatab.c, contrib/mod_quotatab.h,
	  doc/contrib/mod_quotatab.html:
	  Add some Display variables for mod_quotatab:

	    %{mod_quotatab.limit.bytes_in}
	    %{mod_quotatab.limit.bytes_out}
	    %{mod_quotatab.limit.bytes_xfer}
	    %{mod_quotatab.limit.files_in}
	    %{mod_quotatab.limit.files_out}
	    %{mod_quotatab.limit.files_xfer}
	    %{mod_quotatab.tally.bytes_in}
	    %{mod_quotatab.tally.bytes_out}
	    %{mod_quotatab.tally.bytes_xfer}
	    %{mod_quotatab.tally.files_in}
	    %{mod_quotatab.tally.files_out}
	    %{mod_quotatab.tally.files_xfer}

	  These are documented in the mod_quotatab documentation under
	  doc/contrib/.

2004-12-03 23:43  castaglia

	* src/var.c:
	  Pass the exact pointers provided by callers of pr_var_set(),
	  rather than copies of the pointed-to data.

2004-12-03 23:40  castaglia

	* modules/mod_core.c:
	  Reduce complexity of code needed for displaying byte/file
	  Variables by reducing the number of callbacks to two (as opposed
	  to six).

2004-12-03 23:39  castaglia

	* src/display.c:
	  Fix displaying of variables.

2004-12-03 23:02  castaglia

	* RELEASE_NOTES:
	  Mention the new Display variables in the release notes.

2004-12-03 22:59  castaglia

	* NEWS, include/proftpd.h, modules/mod_core.c, modules/mod_xfer.c,
	  src/display.c:
	  Bug#2170 - Add byte count variables, similar to the file count
	  Display variables.

2004-12-03 17:16  castaglia

	* modules/mod_core.c:
	  Handle the case where there's only one name provided in the
	  Allow/Deny rule.

2004-12-02 15:15  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2528 - Incorrect username 'and' parsing in AllowUser.

2004-12-01 17:45  castaglia

	* src/main.c:
	  Close the control and data connections before running any
	  registered 'core.exit' event handlers.

2004-12-01 17:24  castaglia

	* contrib/mod_tls.c:
	  Unregister the NetIO streams registered by mod_tls during its
	  'core.exit' handler.	This prevents segfaults that can happen
	  when a session is exiting (as when ABORting an in-progress data
	  transfer).

2004-12-01 10:08  castaglia

	* contrib/mod_rewrite.c, modules/mod_core.c, modules/mod_xfer.c:
	  Correct a few lingering cases where pr_log_pri() was being called
	  with a log level that wasn't in the PR_ namespace.

2004-11-29 14:28  castaglia

	* src/dirtree.c:
	  Style cleanup.

2004-11-28 16:26  castaglia

	* doc/howto/Debugging.html:
	  Updating URL.

2004-11-25 11:03  jwm

	* modules/mod_delay.c: include signal.h to fix the build under
	  Solaris 8

2004-11-24 12:38  castaglia

	* src/support.c:
	  More old-style exit handler cruft.

2004-11-22 19:43  castaglia

	* src/display.c:
	  Extraneous #include (and at the bottom of a file).

2004-11-22 19:30  castaglia

	* modules/mod_core.c:
	  We were calling pr_display_file() on DisplayQuit files with the
	  arguments in the wrong order.

2004-11-21 22:09  castaglia

	* doc/contrib/mod_ctrls_admin.html:
	  Fix the mod_ctrls_admin documentation.  First, there was a
	  duplicate entry for the 'down' control action.  Second, the
	  'shutdown' entry had gone completely missing.

2004-11-21 21:36  castaglia

	* NEWS:
	  Bug#2510 - Use of ExportCertData TLSOption leads to segfault.

2004-11-21 21:21  castaglia

	* contrib/mod_tls.c:
	  Since we stuff an SSL * in the strm_data slot for each NetIO
	  stream, and there are two streams for a connection, when closing
	  a connection, we want to call tls_end_session() (which ends up
	  freeing that SSL *) only once per connection.  I chose to do this
	  always for the write stream of a connection.	Should help with
	  some of the OpenSSL reference counter issues we've been seeing.

	  This patch is also part of the solution for Bug #2313.

2004-11-21 17:37  castaglia

	* contrib/mod_tls.c:
	  Adding some missing logic; pointers that have been free()'d
	  should always be set to NULL afterwards.

2004-11-21 16:34  castaglia

	* Makefile.in:
	  As per Michael's suggestion, remove the .libs/ directory, and
	  libtool, during the 'distclean' target.

2004-11-21 16:27  castaglia

	* src/support.c:
	  More old-style exit handler cruft.

2004-11-21 16:26  castaglia

	* src/main.c:
	  Straggler run_exit_handlers() call.  Be gone with ye!

2004-11-21 16:21  castaglia

	* include/support.h, src/main.c, src/support.c:
	  No more support for the old-style exit handlers.

2004-11-21 15:36  castaglia

	* modules/mod_delay.c:
	  Allow SIGTERM to interrupt mod_delay.

2004-11-21 12:26  castaglia

	* modules/mod_delay.c:
	  Since mod_delay uses mmap(), any updates it makes to the
	  DelayTable won't be reflected in the mtime field of the file's
	  metadata.  To help alleviate this perception, add a 'core.exit'
	  event handler that explicitly writes out the DelayTable to disk.

	  Fix up some memory problems spotted under valgrind.  Also, if the
	  expected DelayTable is smaller than the current table, make sure
	  we truncate the file.

2004-11-21 11:16  castaglia

	* doc/contrib/mod_ifsession.html:
	  Forgot to list MaxInstances as not being alterable by
	  mod_ifsession.

2004-11-21 11:09  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2520 - Turning on AuthAliasOnly disables MaxClientsPerHost.
	  ProFTPD was not using the TOPLEVEL_CONF macro, as it should have
	  been.

2004-11-20 14:35  castaglia

	* NEWS, include/timers.h, src/main.c, src/timers.c:
	  Bug#2516 - Getting "421 Login Timeout" immediately upon connect.
	  The child processes were inheriting the values of static Timer
	  API variables, including the parent's timer list.  This causes
	  problems when, in the parent process, one of those static
	  variables stops being properly updated.  I'm not convinced that
	  the root cause of this bug has been found, but this patch
	  addresses the problematic behavior, so that at least session
	  processes aren't affected so badly.

2004-11-20 13:20  castaglia

	* src/timers.c:
	  Be a little more paranoid: don't set the indispatch flag until
	  after alarms have been blocked.

2004-11-20 12:38  castaglia

	* README.IPv6:
	  Remove mention of the Bind directive.  We want it gone.

2004-11-20 12:32  castaglia

	* NEWS, README.IPv6, RELEASE_NOTES, include/bindings.h,
	  modules/mod_core.c, src/bindings.c, src/dirtree.c:
	  Bug#2454 - Extend <VirtualHost> to honor multiple addresses.

2004-11-19 19:15  castaglia

	* RELEASE_NOTES:
	  Adding a comment about how use of sendfile() causes download
	  transfer speeds not to be displayable.

2004-11-17 09:58  castaglia

	* doc/howto/Controls.html:
	  Mention that only primary groups, not supplemental groups, are
	  used.

2004-11-17 09:33  castaglia

	* configure:
	  Updating configure.

2004-11-17 09:28  castaglia

	* configure.in:
	  Tweak the configure script to always use our bundled version of
	  getaddrinfo() on HP-UX 11.x, since HP-UX's getaddrinfo() (among
	  many other things) is busted.

2004-11-14 17:39  castaglia

	* README.modules:
	  Updating README.modules.

2004-11-14 16:21  castaglia

	* modules/: mod_core.c, mod_xfer.c:
	  Deny the SIZE command if we're in ASCII mode, as we do for REST.
	  Be sure to add debug logging for both of these cases.

2004-11-14 15:58  castaglia

	* modules/mod_core.c:
	  Check that a scoreboard entry's PID is non-zero before sending
	  the zero signal to that PID.

2004-11-14 15:45  castaglia

	* NEWS, doc/howto/ASCII.html, doc/howto/index.html,
	  modules/mod_xfer.c:
	  Bug#2471 - Restart command (REST) is not working correctly for
	  text files.

2004-11-14 13:03  castaglia

	* doc/howto/: Scoreboard.html, index.html:
	  Adding a ScoreboardFile mini-HOWTO.

2004-11-13 15:01  castaglia

	* ltmain.sh:
	  Increase the max allowed command line length in the libtool
	  script to be 4K.  I'd rather we encounter the system limit before
	  an arbitrarily imposed one.

2004-11-13 14:47  castaglia

	* include/fsio.h, src/fsio.c:
	  Beginnings of support for stackable FSIO layers.  Rather than
	  allowing only a one-to-one mapping between paths and FS objects,
	  this patch allows for one-to-many mappings, linking FS objects
	  together in a linked list for the same path.

	  At present, only the top layer on the stack, for a given FSIO
	  operation, will be used.  I anticipate that it will be the
	  responsibility of the called FSIO handler to decide whether it
	  wants to act as a filter handler, and pass the parameters farther
	  down the stack, or whether it wants to act as a source/sink
	  handler and handle the parameters entirely by itself.  This
	  behavior allows for backward compatibility with existing FSIO
	  modules.

2004-11-13 14:41  castaglia

	* modules/mod_delay.c:
	  Use proper grammar.

2004-11-11 10:58  castaglia

	* RELEASE_NOTES, modules/mod_log.c:
	  Make "SECURE" an alias for "SEC" when configuring ExtendedLog
	  logging classes.

2004-11-10 18:44  castaglia

	* include/table.h, src/main.c, src/table.c:
	  Add a function, pr_table_nalloc(), to the Table API which allows
	  for allocating a table with the given number of chains.
	  Previously, callers would need to call pr_table_alloc(), then
	  pr_table_ctl() to resize the number of chains, and in doing so
	  there would be a slight memory leak.	Now such callers can
	  allocate the number of chains (usually smaller than the default
	  of 32) as they need.

2004-11-10 10:54  castaglia

	* configure:
	  Updating configure.

2004-11-10 10:34  castaglia

	* RELEASE_NOTES:
	  Mention the new UseSendfile directive.

2004-11-10 10:32  castaglia

	* NEWS, configure.in, modules/mod_xfer.c:
	  Bug#2507 - Enable use of sendfile by default.

2004-11-10 10:19  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_tls.c, include/modules.h,
	  modules/mod_log.c:
	  Bug#2518 - Ability to log SSL/TLS commands in an ExtendedLog.

2004-11-09 19:26  castaglia

	* src/timers.c:
	  Prevent callers from providing a negative number of seconds when
	  adding a timer.

2004-11-09 11:17  castaglia

	* NEWS:
	  Add a header to the NEWS file indicating the Bugzilla URL to use
	  for looking up the mentioned bug reports.

2004-11-08 19:07  castaglia

	* modules/mod_delay.c:
	  Use PR_RUN_DIR, not RUN_DIR.

2004-11-08 18:46  castaglia

	* configure:
	  Updating configure.

2004-11-08 18:45  castaglia

	* NEWS:
	  Bug#2480 - Remote users discovery.

2004-11-08 18:41  castaglia

	* configure.in:
	  Make mod_delay one of the default modules.

2004-11-08 18:37  castaglia

	* modules/mod_delay.c, doc/modules/mod_delay.html:
	  Adding mod_delay to the distribution.  Part of Bug #2480.

2004-11-07 17:43  castaglia

	* modules/Makefile.in:
	  Found a case where make(1) was not providing $(RM).  How
	  annoying.

2004-11-06 13:25  castaglia

	* configure:
	  Updating configure.

2004-11-06 13:21  castaglia

	* configure.in:
	  I prefer, if possible, to see the functions checked in
	  alphabetical order.

2004-11-04 21:12  castaglia

	* README.DSO:
	  Adding reminder note.

2004-11-04 16:49  castaglia

	* configure:
	  Updated configure.

2004-11-04 16:43  castaglia

	* configure.in, config.h.in:
	  Check for the fdatasync(2) function.

2004-11-04 14:48  castaglia

	* NEWS, include/data.h, modules/mod_xfer.c, src/data.c:
	  Bug#2509 - sendfile() usage fails with > 2GB files.

2004-11-04 14:17  castaglia

	* doc/GetConf:
	  Removing crufty old file.

2004-11-04 11:25  castaglia

	* configure:
	  Updating configure.

2004-11-04 11:11  castaglia

	* config.h.in, configure.in:
	  Add checks for iconv() and nl_langinfo(), which will be needed
	  for i18n support.

2004-11-03 12:11  castaglia

	* doc/contrib/index.html:
	  Adding an index to the doc/contrib/ directory.

2004-11-03 11:37  castaglia

	* doc/contrib/: ftpasswd.html, ftpquota.html, mod_ctrls_admin.html,
	  mod_ifsession.html, mod_quotatab.html, mod_quotatab_file.html,
	  mod_quotatab_ldap.html, mod_quotatab_sql.html, mod_radius.html,
	  mod_rewrite.html, mod_site_misc.html, mod_sql.html, mod_tls.html,
	  mod_wrap.html:
	  Moving the HTML documentation from contrib/ to doc/contrib/.

2004-11-03 11:37  castaglia

	* contrib/: ftpasswd.html, ftpquota.html, mod_ctrls_admin.html,
	  mod_ifsession.html, mod_quotatab.html, mod_quotatab_file.html,
	  mod_quotatab_ldap.html, mod_quotatab_sql.html, mod_radius.html,
	  mod_rewrite.html, mod_site_misc.html, mod_sql.html, mod_tls.html,
	  mod_wrap.html:
	  Moving the HTML documentation from contrib/ into doc/contrib/.

2004-11-03 08:53  castaglia

	* modules/: mod_auth_pam.c, mod_core.c, mod_ls.c, mod_xfer.c:
	  Removing deprecated directives.

2004-11-03 08:44  castaglia

	* contrib/mod_sql.c:
	  Cleaning up the style of code in mod_sql.  It still needs work,
	  as it's inconsistent and thus harder to read and maintain.

2004-11-02 19:18  castaglia

	* config.h.in, configure.in:
	  Check for, and record, the size of a size_t.

2004-11-02 17:54  castaglia

	* include/table.h, src/table.c:
	  When removing keys and entries from the table, rather than
	  destroying their pools, add them to free lists, associated with
	  the table itself.  Check these free lists when adding new keys
	  and entries.	Thus the total memory for a table is proportional
	  to the total number of entries ever used at one time, and we
	  don't have as much memory churn from the destroying of pools.
	  The pool members of the key and entry structs have thus been
	  removed.

	  Also handle signals while iterating through the table chains in
	  pr_table_empty().

2004-11-02 16:40  castaglia

	* include/default_paths.h:
	  Remove an unused macro, and its accompanying crufty comment.

2004-11-02 10:18  castaglia

	* config.h.in, configure.in, contrib/mod_ctrls_admin.c,
	  contrib/mod_radius.c, include/conf.h, include/default_paths.h,
	  include/mod_ctrls.h, include/netaddr.h, include/scoreboard.h,
	  modules/mod_auth.c, modules/mod_auth_unix.c, modules/mod_core.c,
	  modules/mod_ctrls.c, modules/mod_dso.c, src/ctrls.c,
	  src/dirtree.c, src/ftpdctl.c, src/inet.c, src/log.c, src/main.c,
	  src/netacl.c, src/netaddr.c, src/scoreboard.c, src/support.c,
	  utils/ftpcount.c, utils/ftpshut.c, utils/ftptop.c,
	  utils/ftpwho.c, utils/scoreboard.c, utils/utils.h:
	  Moving many of the macros defining default paths into the 'PR_'
	  namespace.  This isn't an issue now, but will become one when
	  proftpd installs its header files into the production location,
	  which will allow DSO modules to be built outside of the proftpd
	  source tree.	When that happens, the likelihood of symbol
	  collisions between ProFTPD macros/names and other files
	  increases.

2004-11-01 20:01  castaglia

	* Makefile.in:
	  No need to invoke modules/Makefile's 'shared-modules' target if
	  there are no shared module to build.

2004-11-01 19:35  castaglia

	* Makefile.in, lib/Makefile.in, modules/Makefile.in:
	  More tweaks to get builds using just --with-modules to work
	  again.

2004-11-01 19:23  castaglia

	* configure:
	  Updating configure.

2004-11-01 19:15  castaglia

	* Makefile.in, configure.in, lib/Makefile.in, modules/Makefile.in:
	  Need to properly handle the case where the user might specify
	  --with-modules, and no --with-shared.  In this case, the
	  $(SHARED_MODULE_OBJS) variable will be empty, which was not being
	  handled.

2004-11-01 09:48  castaglia

	* NEWS, README.DSO:
	  Mention the addition of DSO support in NEWS, and start on an
	  accompanying README.DSO.  There will eventually appear a DSO
	  mini-HOWTO as well.

2004-11-01 09:42  castaglia

	* configure:
	  Updating configure.

2004-11-01 09:38  castaglia

	* Make.rules.in, Makefile.in, configure.in, modules/Makefile.in:
	  Adding support for a --with-shared configure option, for building
	  DSO (aka shared) modules.

2004-11-01 09:30  castaglia

	* modules/mod_dso.c:
	  Calling lt_dlexit() in a 'core.exit' event handler caused proftpd
	  to segfault when shutting down.  All of the stashed module *m
	  pointers for dynamically loaded modules become invalid after a
	  call to lt_dlexit(), and those pointers can be used after
	  mod_dso's exit handler.  The solution (though not clean) is to
	  not call lt_dlexit().

2004-11-01 09:21  castaglia

	* src/display.c:
	  Bad reuse of variable name.

2004-11-01 09:12  castaglia

	* include/var.h:
	  Forgot to declare the pr_var_delete() function.

2004-10-31 14:39  castaglia

	* modules/mod_dso.c:
	  The dso_unload_module() function is only used if the 'rmmod'
	  control action is used, which means that it requires Controls
	  support.  Otherwise, we don't need it.

2004-10-31 14:36  castaglia

	* modules/mod_dso.c:
	  Remove an unnecessary function.

2004-10-31 14:27  castaglia

	* modules/mod_core.c:
	  Report the line number of the <IfDefine>, <IfModule> sections
	  used or skipped.

2004-10-31 14:26  castaglia

	* include/parser.h, src/parser.c:
	  Add a function to the Parser API for getting the current line
	  number.  This is useful for better reporting.

2004-10-31 14:11  castaglia

	* modules/mod_dso.c:
	  Some of the loop variables are only used if Controls support is
	  enabled.

2004-10-31 14:03  castaglia

	* configure:
	  Updating configure.

2004-10-31 14:00  castaglia

	* aclocal.m4:
	  Update our local autoconf macros, specifically those dealing with
	  libtool.  This should fix the warning:

	    libtool: link: warning: `AC_LIBTOOL_DLOPEN' not used. Assuming
	  no dlopen support.

	  that I was seeing.

2004-10-31 13:22  castaglia

	* src/table.c:
	  Quell a compiler warning about "use of cast expressions as
	  lvalues" by being explicit.

2004-10-31 13:06  castaglia

	* config.h.in, include/conf.h:
	  The configure script was checking for <inttypes.h>, but we were
	  not recording whether it was present or not, or including the
	  header if it was present.  Shame on us.

2004-10-31 12:58  castaglia

	* modules/Makefile.in:
	  The building of modules should require the libltdl header or
	  library.  Just libtool to handle the linking.

2004-10-31 12:56  castaglia

	* src/main.c:
	  Add the display of PR_TUNABLE_RCVBUFSZ, PR_TUNABLE_SNDBUFSZ to
	  the -V output.

2004-10-31 12:49  castaglia

	* configure:
	  Updating configure.

2004-10-31 12:46  castaglia

	* configure.in, Makefile.in:
	  Attempting to get a DSO-enabled proftpd to link properly on
	  platforms other than Linux by linking with libltdl as an object
	  file, rather than linking against it as a library.

2004-10-31 12:24  castaglia

	* modules/mod_log.c:
	  Since we're using %ld as a format, explicitly cast the value as a
	  long int, rather than as a time_t.

2004-10-31 12:19  castaglia

	* configure:
	  Updating configure.

2004-10-31 12:16  castaglia

	* Make.rules.in, configure.in:
	  Let's move the definition of HAVE_CONFIG_H into Make.rules.  The
	  ordering of HAVE_CONFIG_H in the flags is therefore nicer.

2004-10-31 12:13  castaglia

	* configure:
	  Updating configure.

2004-10-31 12:11  castaglia

	* configure.in:
	  Define HAVE_CONFIG_H when compiling proftpd.	Some of the files
	  under lib/ require this, in order to pull in <config.h>, and
	  subsequently some of the system headers needed.

2004-10-31 12:06  castaglia

	* lib/Makefile.in:
	  If LIB_DEPS happens to be the empty string (as needed for
	  Solaris), provide a target for it which does nothing.  Otherwise
	  make will be cranky.

2004-10-31 12:01  castaglia

	* configure:
	  Updating configure.

2004-10-31 11:58  castaglia

	* src/var.c:
	  Quell a compiler warning about a label with no expressions.

2004-10-31 11:57  castaglia

	* config.h.in, configure.in:
	  Check for the <string.h> header.

2004-10-31 11:54  castaglia

	* configure:
	  Updating configure.

2004-10-31 11:51  castaglia

	* configure.in:
	  Initialize the socket buffer sizes, just to be safe.

2004-10-31 11:37  castaglia

	* RELEASE_NOTES, include/version.h:
	  As Daniel noted, it should be "1.3.0", not just "1.3".

2004-10-31 11:35  castaglia

	* configure:
	  Updating configure.

2004-10-31 11:31  castaglia

	* configure.in:
	  Bourne shell tests on Solaris don't like testing empty values;
	  they prefer the empty string if nothing else.

2004-10-31 11:12  castaglia

	* configure:
	  Updating configure.

2004-10-31 11:09  castaglia

	* config.h.in, configure.in, include/options.h, src/data.c,
	  src/dirtree.c:
	  First, fix a bug where session.xfer.buf was allocated as
	  PR_TUNABLE_BUFFER_SIZE, rather than PR_TUNABLE_XFER_BUFFER_SIZE.

	  Next, try to be smarter about the default value for
	  PR_TUNABLE_XFER_BUFFER_SIZE.	The configure script now runs a
	  small test program that uses getsockopt(2) to determine the sizes
	  of a TCP socket's send and receive buffers.  The smaller of the
	  two buffer sizes is used as the default value for
	  PR_TUNABLE_XFER_BUFFER_SIZE; the --enable-transfer-buffer-size
	  option will override this test.  The test program also records
	  those send/receive buffer sizes in PR_TUNABLE_RCVBUFSZ and
	  PR_TUNABLE_SNDBUFSZ, which were previously hardcoded to be 8K.

2004-10-31 11:03  castaglia

	* modules/mod_xfer.c, src/data.c:
	  Style nits: struct stat variables should be named 'st', and the
	  'xlate' name for the ASCII handling routines is not appropriate
	  in light of the i18n translation we will be needing.	It's more
	  of a transformation, really.

2004-10-31 10:53  castaglia

	* NEWS:
	  Updating NEWS.

2004-10-31 10:53  castaglia

	* Make.rules.in, include/conf.h, include/display.h,
	  include/modules.h, include/var.h, modules/mod_auth.c,
	  modules/mod_core.c, src/display.c, src/main.c, src/var.c:
	  Bug#2701 - Add Variables API.

	  This also separates the code used for handling Display* files
	  into its own file; src/main.c was calling into modules/mod_core.c
	  for that function, which is bad design.  Core code should not be
	  using functions implemented in modules.

2004-10-31 10:45  castaglia

	* config.h.in, configure.in, src/main.c:
	  Make sure that if --enable-dso is used, it shows up when the -V
	  command-line option is used.

2004-10-30 19:14  castaglia

	* RELEASE_NOTES:
	  Updating the release notes.  These still need some work.

2004-10-30 18:57  castaglia

	* src/inet.c:
	  Typo.

2004-10-30 18:39  castaglia

	* src/parser.c:
	  Update the license to reflect the proper original copyright
	  holder(s).

2004-10-30 18:32  castaglia

	* Make.rules.in, contrib/mod_ifsession.c, include/conf.h,
	  include/dirtree.h, include/parser.h, modules/mod_core.c,
	  src/dirtree.c, src/main.c, src/parser.c:
	  Separating the parser code out from src/dirtree.c into its own
	  file, src/parser.c, with a proper header file documenting the API
	  (include/parser.h).  Update the rest of the core code to use the
	  new API as needed.

2004-10-30 17:57  castaglia

	* contrib/mod_ifsession.c:
	  There is not enough information to call resolve_deferred_dirs()
	  at session init time.  This function is usually for expanding the
	  tilde in path names, and at session init time, we don't know the
	  user name for expansion.

2004-10-30 16:18  castaglia

	* src/main.c:
	  Use pr_auth_getgroups(), not auth_getgroups().

2004-10-30 16:16  castaglia

	* contrib/mod_tls.c, contrib/mod_wrap.c, src/dirtree.c, src/fsio.c,
	  src/support.c:
	  Use the Auth API functions in the 'pr_' namespace.

2004-10-30 16:14  castaglia

	* modules/mod_core.c:
	  Use the Auth API functions in the 'pr_' namespace rather than
	  relying on the compatibility macros.

2004-10-30 15:11  castaglia

	* configure:
	  Updating configure.

2004-10-30 15:06  castaglia

	* configure.in:
	  Tweaking the configure script a bit, providing more complete path
	  information in flags, etc.  Not really needed for the default
	  build process which we all know and love, but will become
	  necessary when building DSO modules.

2004-10-30 14:55  castaglia

	* src/timers.c:
	  This struct is no longer typedef'd.

2004-10-30 14:01  castaglia

	* include/timers.h:
	  Include some redefines for supporting legacy modules that may not
	  have been updated to use the 'pr_' namespace Timer API.

2004-10-30 13:57  castaglia

	* contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c,
	  contrib/mod_tls.c, modules/mod_ctrls.c:
	  Update the contrib/ modules to use the Timer API in the 'pr_'
	  namespace (and mod_ctrls, too).

2004-10-30 13:45  castaglia

	* include/timers.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_xfer.c, src/data.c, src/ident.c, src/inet.c,
	  src/main.c, src/timers.c:
	  Moving the Timer API into the 'pr_' namespace.

2004-10-30 13:44  castaglia

	* include/ftp.h:
	  In the near future, a module will implement support for RFC2640's
	  LANG command.

2004-10-30 13:42  castaglia

	* include/version.h:
	  With the addition of DSO support, ProFTPD is now moving into the
	  1.3.x series.  Whee!

2004-10-29 15:56  castaglia

	* ltmain.sh:
	  Yet another bug in GNU's ltmain.sh script -- yet another
	  undeclared variable.

2004-10-29 15:33  castaglia

	* doc/modules/mod_dso.html:
	  Typo (spotted by Michael).

2004-10-29 15:23  castaglia

	* doc/modules/mod_dso.html:
	  Adding documentation for mod_dso.

2004-10-29 14:46  castaglia

	* src/event.c:
	  As a comment to myself indicated, it is necessary to pstrdup()
	  the name of the event for which a listener is being registered,
	  rather than stashing a pointer to the given name directly.  This
	  was causing a segfault when the pointer to the name given was
	  part of a dynamically loaded module.

2004-10-29 12:17  castaglia

	* modules/mod_core.c:
	  The DebugLevel configuration handler was not recognizing 10 as a
	  valid debug level.

2004-10-29 09:08  castaglia

	* doc/modules/mod_ctrls.html:
	  Grammar fix.

2004-10-29 08:29  castaglia

	* modules/mod_dso.c:
	  Removing debugging cruft.

2004-10-29 08:21  castaglia

	* configure:
	  Updating configure.

2004-10-28 23:01  castaglia

	* lib/libltdl/Makefile.in:
	  Disable the actions that try to use autoheader and automake.
	  These aren't installed on every system, and we don't really use
	  them.

2004-10-28 22:51  castaglia

	* configure.in, lib/Makefile.in:
	  Only configure, build, and clean the libltdl/ directory if
	  --enable-dso is selected.  Otherwise, let the build proceed as
	  usual, and let the normal 'clean' target work without throwing an
	  error.

2004-10-28 22:33  castaglia

	* configure:
	  Updating configure.

2004-10-28 22:28  castaglia

	* Make.rules.in, Makefile.in, config.h.in, configure.in,
	  include/default_paths.h, lib/Makefile.in, modules/Makefile.in:
	  More DSO support changes.

2004-10-28 22:21  castaglia

	* ltmain.sh, modules/mod_dso.c:
	  Adding a (slightly modified) copy of ltmain.sh, which is
	  responsible for creating the libtool executable.  Also adding
	  mod_dso.c.  All part of the preparations for adding DSO support
	  to ProFTPD.

2004-10-28 22:19  castaglia

	* aclocal.m4:
	  Adding GNU libtool M4 definitions to our aclocal.m4.

2004-10-28 22:17  castaglia

	* lib/libltdl/: COPYING.LIB, Makefile.am, Makefile.in, README,
	  acinclude.m4, aclocal.m4, config-h.in, config.guess, config.sub,
	  configure, configure.ac, install-sh, ltdl.c, ltdl.h, ltmain.sh,
	  missing:
	  Adding GNU libtool's libltdl files to ProFTPD.

2004-10-28 18:10  castaglia

	* modules/mod_core.c:
	  The checks for <IfDefine>, </IfDefine>, <IfModule>, and
	  </IfModule>, within the respective directive handlers, need to be
	  case-insensitive.

2004-10-28 12:11  castaglia

	* NEWS, utils/ftptop.c:
	  Bug#2484 - Better ftptop formatting.

2004-10-26 18:49  castaglia

	* modules/mod_xfer.c:
	  Typo.

2004-10-26 16:24  castaglia

	* include/dirtree.h, include/modules.h, include/proftpd.h,
	  modules/mod_site.c, modules/mod_xfer.c, src/main.c,
	  src/modules.c:
	  Removing old privdata_t structures in favor of table entries,
	  using the new Table API.

2004-10-26 15:28  castaglia

	* configure:
	  Updating configure.

2004-10-26 15:19  castaglia

	* config.h.in, configure.in:
	  Define CONFIG_DIR to point to the hardcoded directory containing
	  the proftpd.conf file.

2004-10-26 15:14  castaglia

	* Make.rules.in, include/conf.h, include/table.h, src/table.c:
	  Adding the Table API source.

2004-10-19 18:32  castaglia

	* contrib/mod_tls.c:
	  It is possible for SSL_read() to return SSL_ERROR_WANT_WRITE as
	  well, so handle that case the same way as handling
	  SSL_ERROR_WANT_READ: select() on the socket until it is available
	  for writing, then call SSL_read() again.

	  Note that this happens (ideally) only when a renegotiation is
	  occuring on the underlying SSL session.  So set the
	  SSL_MODE_AUTO_RETRY mode too (if the OpenSSL version supports
	  it), which will hopefully keep renegotiations from causing
	  SSL_read() to return SSL_ERROR_WANT_WRITE.

2004-10-18 09:42  castaglia

	* modules/mod_xfer.c:
	  A few cases where log_pri() was being used, rather than
	  pr_log_pri().

2004-10-17 16:42  castaglia

	* doc/howto/Directory.html:
	  Mention using quotations to enclose directory paths that contain
	  spaces.

2004-10-17 16:29  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#1965 - Change timing of handling of QUIT command.

2004-10-17 12:09  castaglia

	* contrib/mod_sql.c:
	  Extraneous redeclaration of a variable.

2004-10-17 10:47  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Fixing bad reuse of variable name from outer scope.

2004-10-16 18:21  castaglia

	* RELEASE_NOTES:
	  Mention the new MaxConnectionsPerHost directive in the release
	  notes.

2004-10-16 18:10  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2273 - Ability to limit number of unauthenticated clients
	  from a single host.

2004-10-15 17:43  castaglia

	* NEWS, modules/mod_auth_pam.c:
	  Bug#2497 - Users can login without password if pam_start() fails.

2004-10-15 10:07  castaglia

	* NEWS, src/auth.c, src/dirtree.c:
	  Bug#2499 - make_cmd() does not NULL-terminate cmd->argv[].

2004-10-14 19:43  castaglia

	* modules/mod_auth.c:
	  Move the handling of the AccessGrantMsg and DisplayLogin
	  directives into the POST_CMD handler for PASS, rather than in the
	  CMD handler.	This is aesthetically where such handling should
	  occur, and it makes it possible for future enhancements where
	  contrib modules can add their own variables to be interpolated
	  into the DisplayLogin file.

2004-10-11 20:07  castaglia

	* src/inet.c:
	  Nicer error message.

2004-10-11 10:03  castaglia

	* src/bindings.c:
	  Avoid an infinite loop problem with Bind is used by stashing
	  pointers to the bindings to use, when accepting a client
	  connection, in an array_header, rather than overloading the
	  'next' field in the conn_t struct.

2004-10-11 09:33  castaglia

	* src/dirtree.c:
	  Fix case where the config tree was not dumped if the server_rec
	  had an empty set of config_recs.  The name of the server_rec
	  should still be dumped in such cases.

2004-10-09 15:34  castaglia

	* doc/howto/TLS.html:
	  Update link to FTPS Draft.

2004-10-09 15:24  castaglia

	* src/dirtree.c:
	  The parser internals are crufty, and are in need of rewriting and
	  prettification.  Until then, make the code a little more legible
	  (to me, at least).

2004-10-09 13:46  castaglia

	* NEWS, include/inet.h, include/netio.h, src/data.c, src/inet.c,
	  src/netio.c:
	  Bug#2494 - ABOR problem with Cisco routers copy ftp flash.

2004-10-09 13:44  castaglia

	* src/main.c:
	  Generate a 'core.connect' event after a client has connected and
	  we've forked, but before we lookup the server_rec for the
	  session.

2004-10-08 18:16  jwm

	* contrib/mod_ldap.c: release 2.8.14

2004-10-07 14:17  castaglia

	* contrib/ftpasswd:
	  Explicitly mention "RequireValidShell off" if the given shell is
	  not in /etc/shells.

2004-10-07 11:59  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2496 - NLST off-by-one bug when handling relative paths in a
	  chrooted session.

2004-10-07 11:35  castaglia

	* contrib/mod_sql.html:
	  Remove mention of the PERCALL parameter of SQLConnectInfo, until
	  the feature actually works.

2004-10-07 08:53  castaglia

	* modules/mod_ls.c:
	  Use the Auth API in the 'pr_' namespace.

2004-10-06 11:42  castaglia

	* contrib/mod_sql.html:
	  Removing mention of SQLAuthenticate's "*" suffix, as it was
	  deprecated in the 1.2.10 release cycle.

2004-10-02 13:22  castaglia

	* contrib/mod_tls.c:
	  Handle signals when in potentially infinite gotos, so that the
	  process can be interrupted.

	  Expand the TLSLog entry for refused PROT commands a little more,
	  to explain why the PROT command was refused (e.g. 'PROT C' was
	  sent, but TLSRequired setting requires data protection).

2004-10-02 13:05  castaglia

	* doc/howto/TLS.html:
	  Adding two more FAQs to the TLS howto.

2004-10-01 22:48  castaglia

	* doc/rfc/: draft-murray-auth-ftp-ssl-13.txt,
	  draft-murray-auth-ftp-ssl-15.txt:
	  Updating the FTPS Draft to the current version.

2004-10-01 21:24  castaglia

	* contrib/mod_tls.c:
	  Fix the logic when reporting on syscall errors, so that the
	  errors are properly reported.

2004-10-01 20:34  castaglia

	* modules/mod_auth.c:
	  Stop sending 232 as a response code to the PASS command; it is
	  valid only in response to a USER command.  Part of Bug #2164.

2004-10-01 20:30  castaglia

	* contrib/mod_tls.c:
	  Remove code that is never compiled.

2004-09-30 17:43  castaglia

	* NEWS, modules/mod_auth_pam.c:
	  Bug#2492 - Off-by-one error in FreeBSD PAM username length check.

2004-09-29 14:04  castaglia

	* NEWS, src/dirtree.c:
	  Bug#2490 - <Limit ALL> affects PORT command.	The EPRT, EPSV,
	  PORT, and PASV commands are now explicitly excluded from the ALL
	  command group.

2004-09-27 18:25  jwm

	* NEWS, contrib/mod_ldap.c: new mod_ldap 2.8.13

2004-09-27 10:12  castaglia

	* contrib/mod_quotatab_ldap.c:
	  mod_ldap now looks for a HOOK, rather than a CMD, for the
	  mod_quotatab_ldap lookup symbol, as per John's request.

2004-09-26 14:12  castaglia

	* modules/mod_auth_file.c:
	  Use the 'pr_' namespace of the Auth API.

2004-09-26 14:07  castaglia

	* modules/mod_auth_unix.c:
	  Use the 'pr_' namespace of the Auth API.

2004-09-26 13:23  castaglia

	* modules/mod_auth.c:
	  Removing code that should not have been committed.  Oops.

2004-09-26 13:11  castaglia

	* include/auth.h, include/conf.h, include/modules.h,
	  modules/mod_auth.c, src/auth.c:
	  Moving the Auth API into the 'pr_' namespace, and creating a
	  separate header file defining the pr_auth function prototypes.

2004-09-26 11:24  castaglia

	* NEWS, contrib/mod_sql.c, contrib/mod_sql_mysql.c,
	  contrib/mod_sql_postgres.c:
	  Bug#2485 - SQL backend modules close all open connections too
	  early.

2004-09-26 11:17  castaglia

	* NEWS:
	  Mention the new init.d script for SuSE.

2004-09-26 11:09  castaglia

	* NEWS, RELEASE_NOTES, contrib/mod_sql.c, contrib/mod_sql.h,
	  contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c:
	  Bug#2392 - mod_sql needs better handling of its backend modules.

2004-09-26 10:57  castaglia

	* src/mkhome.c:
	  Generate a 'core.create-home' event when creating a home
	  directory; the event_data is currently the name of the user whose
	  home is being created.  And correct a typo.

2004-09-25 16:47  jwm

	* contrib/dist/rpm/proftpd.init.d.suse: suse init script Submitted
	  by: Daniel Weuthen <dw@megabit.net>

2004-09-23 14:37  castaglia

	* NEWS, include/privs.h:
	  Bug#2488 - Wrong order of privs calls on HP generates "unable to
	  setregid()" error.

2004-09-18 12:08  castaglia

	* contrib/mod_quotatab.c:
	  When handling the 'core.restart' event, do not bounce the log
	  file descriptor.  Restarts are processed by the daemon process,
	  and mod_quotatab only logs in session processes; bouncing the log
	  descriptor in the daemon process was causing mod_quotatab to open
	  a descriptor onto stdout, which then wreaked havoc with the rest
	  of the system.

2004-09-17 17:40  castaglia

	* src/proftpd.8.in:
	  Document the new -N option in the proftpd(8) man page.

2004-09-17 17:38  castaglia

	* NEWS, include/proftpd.h, modules/mod_core.c, src/main.c:
	  Bug#2468 - Ability to disable address/port collision checking.

2004-09-17 10:50  castaglia

	* contrib/mod_quotatab.c:
	  Explicitly use the more modern 'pr_log_openfile' symbol.

2004-09-14 18:01  castaglia

	* include/conf.h:
	  Typo (log -> long).

2004-09-14 10:49  castaglia

	* NEWS, contrib/mod_ldap.c, contrib/mod_radius.c,
	  contrib/mod_sql.c, include/conf.h, include/modules.h,
	  modules/mod_auth.c, modules/mod_auth_file.c,
	  modules/mod_auth_unix.c, modules/mod_core.c, modules/mod_ctrls.c,
	  modules/mod_log.c, modules/mod_ls.c, modules/mod_site.c,
	  modules/mod_xfer.c, src/auth.c, src/data.c, src/xferlog.c:
	  Bug#2389 - 64-bit compilation warnings.

2004-09-12 18:47  castaglia

	* src/support.c:
	  Add an explicit typecast to quell warnings on 64-bit platforms.

2004-09-12 18:43  castaglia

	* modules/mod_auth_pam.c:
	  Quell a compiler warning on Solaris with an explicit typecast.

2004-09-12 17:12  castaglia

	* doc/howto/Limit.html:
	  Add example of using <Class> and mod_ifsession to configure a
	  user so that they can only login from a certain IP range.

2004-09-12 16:36  castaglia

	* doc/howto/FXP.html:
	  Add text noting the ISPs may filter FTP ports, blocking FXP.

2004-09-11 16:43  castaglia

	* contrib/UPGRADE.mod_sql:
	  Removing crufty old file.

2004-09-11 10:53  castaglia

	* src/main.c:
	  Typo.

2004-09-07 17:40  castaglia

	* contrib/mod_quotatab.c:
	  Add logging of the non-ENOENT cases when the uploaded file has
	  disappeared.

2004-09-07 15:34  castaglia

	* src/main.c:
	  Settings display format tweak.

2004-09-07 15:29  castaglia

	* src/main.c:
	  Add --settings option to the long getopt() list.

2004-09-07 15:23  castaglia

	* src/main.c:
	  Update the long descriptions for the -n, -d command-line
	  parameters.

2004-09-07 15:18  castaglia

	* include/proftpd.h:
	  Removing cruft.

2004-09-07 12:41  castaglia

	* contrib/mod_quotatab.c:
	  Handle the case where, after an upload, the file to which bytes
	  have been added has disappeared (as when MaxStoreFileSize and
	  DeleteAbortedStores are in effect).

2004-09-07 12:22  castaglia

	* src/proftpd.8.in:
	  Mention debug level 10 in the proftpd(8) man page.

2004-09-05 15:42  castaglia

	* src/event.c:
	  More graceful handling of NULL evh->module pointers.

2004-09-05 15:01  castaglia

	* doc/mod_sample.c:
	  Update the sample module to include registering the module
	  version.

2004-09-05 14:36  castaglia

	* configure:
	  Updating configure script.

2004-09-05 14:36  castaglia

	* src/main.c:
	  Display the --enable-scoreboard-updates setting in the -V output.

2004-09-05 14:34  castaglia

	* NEWS, config.h.in, configure.in:
	  Add autoconf support for a --enable-scoreboard-updates option.

2004-09-05 14:29  castaglia

	* NEWS, include/options.h, modules/mod_xfer.c:
	  Bug#2455 - Allow fine-tuning of how often mod_xfer updates the
	  scoreboard.

2004-09-05 14:24  castaglia

	* RELEASE_NOTES:
	  Update release notes for 1.2.11 release cycle.

2004-09-05 14:21  castaglia

	* src/proftpd.8.in:
	  Remove extra space.

2004-09-05 14:16  castaglia

	* src/proftpd.8.in:
	  Document the new -V command-line option in the proftpd(8) man
	  page.

2004-09-05 14:12  castaglia

	* configure:
	  Updating configure script.

2004-09-05 14:10  castaglia

	* NEWS, config.h.in, configure.in, src/main.c:
	  Add support for a -V command-line option, which displays various
	  compile-time settings, a la Apache.

2004-09-04 19:37  castaglia

	* config.h.in, include/conf.h:
	  Move the HPUX socklen_t bug fix to include/conf.h, a header file
	  that is not preprocessed by autoconf.  The autoconf preprocessing
	  was causing the #undef in the generated config.h header file to
	  be commented out, which would result in complaints from stringent
	  compilers.

2004-09-04 19:23  castaglia

	* contrib/: mod_sql.c, mod_sql_mysql.c, mod_sql_postgres.c:
	  Remove the _MOD_VERSION #define from mod_sql, as it was not doing
	  as was intended, I think.  Much better, cleaner, and more
	  explicit to have each module #define its own VERSION string, and
	  to use that version string consistently within the module.

2004-09-04 17:53  castaglia

	* modules/mod_log.c:
	  Convert mod_log to use the Events API.

2004-09-04 17:43  castaglia

	* contrib/mod_rewrite.c:
	  Convert mod_rewrite to use the Events API.

2004-09-04 17:38  castaglia

	* src/regexp.c:
	  The Regexp API need not use the core_module pointer for
	  registering its callbacks; registered events can have a NULL
	  module pointer.

2004-09-04 17:36  castaglia

	* src/regexp.c:
	  Convert the Regexp API to use the Events API for cleanup.

2004-09-04 17:36  castaglia

	* modules/mod_xfer.c:
	  Update mod_xfer to use the Events API a little more.

2004-09-04 17:31  castaglia

	* modules/mod_auth_unix.c:
	  Convert mod_auth_unix to use the Events API.

2004-09-04 17:31  castaglia

	* modules/mod_auth_pam.c:
	  Convert mod_auth_pam to use the Events API.

2004-09-04 17:19  castaglia

	* contrib/mod_sql.c:
	  Convert mod_sql to use the Events API.

2004-09-04 17:16  castaglia

	* contrib/mod_radius.c:
	  Convert mod_radius to use the Events API.

2004-09-04 17:15  castaglia

	* contrib/mod_quotatab.c:
	  Convert mod_quotatab to using the Events API.

2004-09-04 16:05  castaglia

	* NEWS, src/fsio.c:
	  Bug#2476 - Incorrect detection of symbolic link loop across
	  devices.  The algorithm used for loop detection relied solely on
	  the inode number, which does not account for the possibility that
	  different devices may reuse inode numbers.  This patch adds the
	  device number to the detection algorithm.

2004-09-04 15:56  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2463 - mod_xfer doesn't check how many bytes it has written
	  to disk.

2004-09-04 15:53  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2458 - Bad handling of CreateHome parameters.

2004-09-04 15:51  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2457 - Directory listing provides bad info when path ends
	  with /.

2004-09-04 15:46  castaglia

	* NEWS, src/main.c:
	  Bug#2449 - ProFTPD silently ignores extra command-line
	  parameters.

2004-09-04 14:21  castaglia

	* include/version.h:
	  Update version, indicating CVS status once more.

2004-09-04 11:54  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2004-09-04 11:50  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing to release 1.2.10-final.

2004-08-25 11:08  castaglia

	* src/data.c:
	  When using sendfile(), only reset the transmission timers if
	  bytes have actually been written out.  sendfile() can return
	  zero, indicating that it wrote zero bytes -- we do not want to
	  reset the timers in this case, for it could indicate other issues
	  with the file descriptor from which data are being read.

	  This fixes an endless loop seen at a particular site involving
	  use of sendfile() and NFS/SAN-shared files.

2004-08-24 15:24  castaglia

	* modules/mod_xfer.c:
	  Reset the 'have_prot' flag to false when a successful PROT C
	  command is processed.

2004-08-12 16:24  castaglia

	* modules/mod_xfer.c:
	  Update to patch to mod_xfer for Bug #2444: the PROT command is
	  allowed before authentication.  The patch was required
	  authentication first, causing issutes for FTPS clients that sent
	  PROT before USER.

2004-08-07 15:22  castaglia

	* NEWS, src/log.c, src/main.c:
	  Bug#2427 - proftpd gets a memory fault when run from ssh batch
	  mode.

2004-08-07 15:21  castaglia

	* src/main.c:
	  Two more cases where the IP address contacted by the client
	  should be used, if present, rather than the ServerAddress field
	  of the relevant server_rec.

2004-08-07 13:58  castaglia

	* src/main.c:
	  Fix a minor bug in the reporting of ServerIdent, where the wrong
	  IP address may be displayed.	For example, with the following
	  configuration:

	    <VirtualHost 127.0.0.1>
	      Bind 1.2.3.4
	      ...
	    </VirtualHost>

	  a client connecting to 1.2.3.4 should see "[127.0.0.1]" at the
	  tail end of the default ServerIdent displayed, rather than the
	  more appropriate "[1.2.3.4]".  The fix is to use the IP address
	  to which the client connected, rather than the ServerAddress
	  field of the server_rec to which the client connected.  As the
	  case with Bind shows, multiple IP addresses may be associated
	  with the same server_rec, and the IP address displayed to the
	  connecting client should not "leak" this fact.

2004-08-05 19:16  castaglia

	* src/main.c:
	  Reorder the timing of calling pr_ident_lookup(), making it occur
	  after modules have been initialized.	This makes it possible for
	  mod_ifsession, for example, to alter if ident lookups will be
	  enabled, e.g.:

	    <IfClass foo>
	      IdentLookups off
	    </IfClass>

	  so that ident lookups can be enabled/disabled selectively.

2004-08-05 17:58  castaglia

	* doc/howto/Limit.html:
	  Add description of applying <Limit> sections to SITE commands.

2004-08-05 12:12  castaglia

	* RELEASE_NOTES:
	  Updating the release notes.

2004-08-04 11:52  castaglia

	* NEWS, modules/mod_core.c:
	  Add support for automatically scrubbing the scoreboard for stale
	  sessions on session init time, for inetd proftpds.  Scrubbing is
	  already done periodically for standalone proftpds.

2004-08-03 16:17  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2444 - Use of sendfile() does not interoperate well with
	  RFC2228 security mechanisms.

2004-08-02 17:44  castaglia

	* contrib/mod_sql.c:
	  Convert mod_sql to using ProFTPD's sstrcat() function, rather
	  than strcat(3).

2004-08-01 12:02  castaglia

	* NEWS, modules/mod_auth_file.c:
	  Bug#2445 - AuthUserFile in <Global> context overrides
	  <VirtualHost> setting.  Note that this bug will be revisited in
	  the next release cycle, and fixed The Right Way(tm).

2004-07-30 18:35  castaglia

	* modules/mod_core.c:
	  Store the original name configured by a MasqueradeAddress
	  directive in the config_rec, along with the resolved netaddr
	  object.  This will make it possible to re-resolve the original
	  name at a later date.

2004-07-30 17:07  castaglia

	* doc/howto/Limit.html:
	  Add example <Limit LOGIN> configuration that allows only
	  anonymous logins.

2004-07-30 10:42  castaglia

	* modules/mod_core.c:
	  Make certain that all occurrences of an environment variable are
	  removed when handling the UnsetEnv directive; a environment
	  variable can appear multiple times in the environ array.

2004-07-28 13:41  castaglia

	* doc/howto/Authentication.html:
	  Updating the section on "Resolving ~", fixing mention of
	  mod_auth_pam.

2004-07-22 14:49  castaglia

	* NEWS, modules/mod_auth_pam.c:
	  Bug#2442 - Segfault in FreeBSD PAM library with long login names.

2004-07-22 13:53  castaglia

	* README.PAM:
	  Update the PAM docs about AuthPAMAuthoritative, and add an Issues
	  section.

2004-07-21 17:11  castaglia

	* contrib/: mod_ldap.c, mod_sql.c:
	  Apply the same criteria for including <crypt.h> to mod_ldap and
	  mod_sql as are used for mod_auth_unix and mod_auth_file.

2004-07-21 16:58  castaglia

	* NEWS, modules/mod_auth_file.c, modules/mod_auth_unix.c:
	  Bug #2411 - AIX5 portability bug with mod_auth_unix,
	  mod_auth_file.  Using gcc on AIX5, these files compile without
	  complaint.  However, using the IBM compiler and following the
	  instructions in README.AIX, they will fail on AIX5.  The fix is
	  to extend for AIX5 the portability hack that is done for AIX4.

2004-07-20 10:39  castaglia

	* NEWS, include/modules.h, modules/mod_core.c, src/auth.c:
	  Bug #2440 - Unable to use PAM authentication properly.  As
	  explained in the bug report, the deprecation of all
	  *Authoritative directives causes an issue with modules like
	  mod_auth_pam.  This patch makes use of an unused flag variable in
	  the authtable structure in order to implement the setting of auth
	  module authoritativeness via the AuthOrder directive.

2004-07-14 17:08  castaglia

	* modules/mod_ctrls.c:
	  We were forgetting to remove our previous timer before adding a
	  new one.

2004-07-14 17:07  castaglia

	* src/timers.c:
	  Prevent add_timer() from adding multiple timers that use the same
	  timerno.

2004-07-14 14:51  castaglia

	* modules/mod_ctrls.c:
	  We don't want child processes handling these events for
	  mod_ctrls.

2004-07-13 17:20  castaglia

	* include/version.h:
	  Let's try this again.

2004-07-13 16:58  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2004-07-13 16:57  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  How embarassing.  A typo broke 1.2.10rc2, necessitating a release
	  of rc3.

2004-07-13 16:51  castaglia

	* modules/mod_core.c:
	  Typo.

2004-07-13 15:19  castaglia

	* include/version.h:
	  Bump version for CVS checkouts.

2004-07-13 11:34  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2004-07-13 11:32  castaglia

	* NEWS, include/version.h, contrib/dist/rpm/proftpd.spec:
	  Preparing for release of 1.2.10rc2.

2004-07-13 10:56  castaglia

	* modules/mod_core.c:
	  Variable name collision from different scopes; fix to quell a
	  compiler warning.

2004-07-13 10:53  castaglia

	* src/support.c:
	  Quell a warning about reusing a global symbol name 'dup'.

2004-07-13 09:54  castaglia

	* modules/mod_core.c:
	  Rest of patch for Bug#2439.

2004-07-11 14:52  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2439 - <Limit CWD> doesn't work.

2004-07-09 11:24  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2438 - Display variable %z not expanded properly.

2004-07-08 14:38  castaglia

	* contrib/mod_ifsession.c:
	  Only perform <Limit LOGIN> checks if we've actually merged
	  something in.  Also, when performing this check, use the
	  TOPLEVEL_CONF macro (which correctly handles <Anonymous>
	  contexts) to avoid inadvertently checking the wrong <Limit LOGIN>
	  block.

2004-07-06 10:32  castaglia

	* doc/howto/TLS.html:
	  Update the link to the most current FTPS Draft.

2004-07-06 10:31  castaglia

	* doc/rfc/: draft-murray-auth-ftp-ssl-10.txt,
	  draft-murray-auth-ftp-ssl-13.txt:
	  Updating the FTPS Draft to the current version.

2004-06-30 19:00  castaglia

	* src/dirtree.c:
	  Fix pr_expr_eval_class_and() and pr_expr_eval_class_or() to
	  properly handle the case where session.class may be NULL (as when
	  there is no <Class> definition that matches the connecting
	  client).  Previously, if there was no matching <Class> for a
	  client, a rule such as:

	    <IfClass !name>

	  would evaluate to false.  It _should_ evaluate to true; this
	  change makes it so.

	  This fixes a problem Michael was encountering with mod_ifsession
	  and Classes.

2004-06-30 18:52  castaglia

	* src/dirtree.c:
	  When handling <Global> contexts in fixup_globals(), only handle
	  contexts that have both the right config_type (CONF_GLOBAL) _and_
	  the right name ("<Global>").	Contrib modules (e.g.
	  mod_ifsession) might create their own contexts that use the
	  CONF_GLOBAL flag; in the case of mod_ifsession, the fact that
	  fixup_globals() was handling the mod_ifsession-created context
	  config_recs was causing a bug when <If*> sections were used
	  within <Global> contexts.

	  This change also includes some style cleanup.

2004-06-30 18:17  castaglia

	* src/dirtree.c:
	  Style.

2004-06-30 18:06  castaglia

	* contrib/mod_tls.c:
	  Improve mod_tls' error reporting by displaying the paths that are
	  given in the configuration data for various files, in the cases
	  where mod_tls determines that those paths do not exist.

2004-06-30 11:25  castaglia

	* contrib/mod_tls.html, doc/howto/TLS.html:
	  Updating the mod_tls docs, and the TLS howto, to mention the new
	  AllowPerUser TLSOption, and the risks involved in its use.

2004-06-30 10:52  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2419 - Ability to disable TLSRequired on per-user basis (e.g.
	  for anonymous logins).

2004-06-29 19:42  castaglia

	* NEWS, src/class.c, src/netacl.c, src/netaddr.c:
	  Bug#2303 - Problem evaluating multiple <Class> rules.

2004-06-23 10:47  castaglia

	* contrib/mod_sql.html:
	  Typo.

2004-06-22 17:04  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2431 - mod_sql does not use UID/GID properly in cache
	  lookups.  For the most part this is an issue only if you define a
	  user account with UID of zero, or a group account with GID of
	  zero, in your SQL user tables.

2004-06-21 10:34  castaglia

	* contrib/mod_ifsession.html:
	  Add ExtendedLog to the list of directives that mod_ifsession does
	  not handle.

2004-06-18 14:29  castaglia

	* contrib/mod_tls.html:
	  Typo.

2004-06-17 13:34  castaglia

	* NEWS, include/dirtree.h, src/dirtree.c, src/main.c:
	  Bug#2418 - chmod returns 550 with filename containing multiple
	  spaces.

2004-06-16 17:06  castaglia

	* NEWS:
	  Typo.

2004-06-15 09:45  castaglia

	* src/netio.c:
	  Style.

2004-06-11 19:03  castaglia

	* src/modules.c:
	  Removal of symbols (e.g. AuthOrder) was not working properly
	  without this change.

2004-06-11 14:19  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2422 - %v not working in SQLNamedQuery.

2004-06-10 14:51  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2411 - Caching effects cause RNTO to fail if AllowOverwrite
	  is off and target path does not exist.

2004-06-10 11:30  castaglia

	* contrib/mod_sql.c:
	  Remove debugging cruft.

2004-06-10 11:27  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2424 - SQLDefaultHomedir overrides column value.

2004-06-08 16:08  castaglia

	* doc/howto/ServerType.html:
	  ProFTPD is now IPv6-capable; it simply needs the proper configure
	  option.  Update the ServerType howto to reflect this (relevant
	  for Solaris users).

2004-06-07 16:00  castaglia

	* contrib/: mod_quotatab.h, mod_sql.c:
	  Increment versions of mod_quotatab, mod_sql.

2004-06-07 15:58  castaglia

	* NEWS, contrib/mod_quotatab_sql.c, contrib/mod_sql.c,
	  include/support.h, src/support.c:
	  Bug#2420 - Name field is not escaped before querying database.

	  This patch fixes mod_quotatab_sql to escape the name string used.
	   To do this, several changes were made: the _sql_strip_spaces()
	  function of mod_sql.c was made a public ProFTPD API string
	  function (pr_str_strip), so that that code need not be duplicated
	  in both mod_sql.c and mod_quotatab_sql.c, a new HOOK to mod_sql's
	  sql_escapestring function was added, under the symbol
	  'sql_escapestr', to avoid further code duplication, and
	  mod_quotatab_sql was updated to make use of the new API.

2004-06-05 18:14  castaglia

	* contrib/mod_tls.c:
	  Fix scrubbing of passphrases when a session process exits.

2004-06-03 10:32  castaglia

	* contrib/mod_tls.html:
	  Adding required OpenSSL clauses.

2004-05-31 15:07  castaglia

	* include/dirtree.h, include/event.h, src/dirtree.c, src/event.c:
	  Add a pr_event_dump() function, for dumping internal Events info.
	  Adjust config-dumping function names to match (i.e.
	  pr_config_dump()).

2004-05-31 14:49  castaglia

	* contrib/mod_ctrls_admin.c:
	  Removing the 'dump' control action from mod_ctrls_admin.  A new
	  module, mod_dumper, will implement this control action.  I
	  anticipate the audience for mod_dumper to be much smaller than
	  for mod_ctrls_admin.

2004-05-31 14:47  castaglia

	* src/modules.c:
	  Slightly cleaner structure.

2004-05-31 14:20  castaglia

	* src/dirtree.c:
	  Attempting to dump the config for a minimally configured
	  server_rec (i.e.  server_rec->conf is NULL) would segfault.

2004-05-31 12:33  castaglia

	* src/modules.c:
	  When iterating through the stash for removing symbols, be sure to
	  pass in the previously-found entry, not NULL.  Otherwise, symbols
	  can inadvertently be skipped.

2004-05-31 11:58  castaglia

	* src/modules.c:
	  Fix removal of a module from the loaded_modules list.

2004-05-31 10:54  castaglia

	* src/modules.c:
	  Fix a bug introduced in the handling of HOOK vs CMD symbols.	Fix
	  handling of loaded_modules pointer when unloading a module.  Add
	  signal handling where appropriate.

2004-05-31 10:47  castaglia

	* src/modules.c:
	  Missed a case where the PR_SYM_CONF hashing needed to be handled
	  differently.

2004-05-30 18:51  castaglia

	* src/modules.c:
	  The changes made earlier, to have processing of configuration
	  directives use the stash directly, caused a problem.	The prior
	  structure allowed for case-insensitive comparisons between the
	  directive name in the config file and the name defined by the
	  processing module.  By switching to doing lookups from the stash
	  directly, such case-insensitive comparisons became difficult.

	  So, for now, whenever a PR_SYM_CONF symbol is added or requested
	  from the stash, its hash value is calculated not from the symbol
	  name directly, but from a lowercased version of the name (and
	  only for PR_SYM_CONF symbols).  In order to make this work, there
	  is now special-case handling of PR_SYM_CONF, and the
	  stash_lookup() functions use strcasecmp() rather than strcmp().
	  I hope this doesn't cause any problems with other symbols.

	  In the future, when the proposed Tables API is complete, I'd like
	  to have completely separate tables for the different symbol
	  types.  This will (hopefully) make lookups faster (smaller
	  namespace to search) and allow customized hashing/comparison
	  functions (PR_SYM_CONF symbols needing different treatment from
	  other symbols in this case) on a per-table basis.

2004-05-30 15:46  castaglia

	* contrib/mod_ctrls_admin.c, include/modules.h, modules/mod_core.c,
	  src/modules.c:
	  Add pr_module_load() and pr_module_unload() functions, for
	  loading and unloading modules (and their symbols) from the stash.
	  Rework the rest of the code to work with the changes (i.e.
	  removed crufty globals).

2004-05-30 14:54  castaglia

	* NEWS:
	  Bug#2125 - -vv command line switch should list versions of
	  modules.

2004-05-30 14:50  castaglia

	* modules/mod_cap.c, src/main.c:
	  Minor formatting tweak.  Update mod_cap to report its version.
	  Other modules will follow.

2004-05-30 14:48  castaglia

	* src/main.c:
	  Typo.

2004-05-30 14:45  castaglia

	* src/main.c:
	  Bug#2125 - -vv command line switch should list versions of
	  modules.

	  With this change, modules _can_ report their version (or other
	  short descriptor)in such a way that it will be listed if the -vv
	  command line option is used.	It is not required for modules to
	  do so; if they do not, just the module name is displayed.

2004-05-30 14:34  castaglia

	* include/modules.h:
	  Extend the module structure to include fields for module version,
	  and an opage handle for the module (for libltdl pointers).  This
	  extension do not break the currently-defined module structures in
	  module files.

2004-05-29 19:39  castaglia

	* contrib/mod_ctrls_admin.c, src/dirtree.c, src/modules.c,
	  src/sets.c:
	  More prep work for loadable modules.	This change removes use of
	  the m_conftable global variable, shifting the users of that
	  variable to using the stash directly, via pr_stash_get_symbol().
	  For example, mod_ctrls_admin was using m_conftable for supporting
	  the 'get directives' control action.	Now that handler iterates
	  through the stash directly for PR_SYM_CONF symbols (which
	  required some adjusting of the stash internals to allow for such
	  interating).

2004-05-29 16:38  castaglia

	* src/event.c:
	  Make pr_event_unregister() function as documented if given a NULL
	  callback argument.

2004-05-29 16:02  castaglia

	* include/modules.h, modules/glue.sh, modules/mod_core.c,
	  src/modules.c:
	  More fun with the loaded_modules list.  Initially, the
	  loaded_modules linked list will be NULL; it is the job of
	  modules_init() to initialize the modules in the static_modules
	  list, and add a pointer to the loaded module to the
	  loaded_modules list.

	  More work needs to be done on abstracting the process of loading
	  of a module.

2004-05-29 15:31  castaglia

	* modules/mod_ctrls.c:
	  Clean up the ControlsLog entries when encountering a stale
	  connection: we don't need to know the full timestamps, just the
	  difference as compared to the ControlsAuthFreshness.

2004-05-29 14:02  castaglia

	* include/modules.h, src/main.c, src/modules.c:
	  Use "modules", plural, to indicate that the function acts on
	  multiple modules, not just one.

2004-05-29 13:13  castaglia

	* src/modules.c:
	  Add sane errno values.

2004-05-29 13:03  castaglia

	* include/modules.h, modules/glue.sh, modules/mod_core.c,
	  modules/mod_ctrls.c, src/main.c, src/modules.c:
	  Beginning work on supporting loadable modules.  The
	  modules/glue.sh file autogenerates a file that defines the
	  static_modules array, which contains the module structure
	  pointers from all the statically compiled modules.  This list
	  cannot be modified.  For loadable modules, we need a modifiable
	  list, which I've added to the script: loaded_modules.  Initially,
	  loaded_modules is identical to static_modules.  A pr_module_get()
	  function has been added, to lookup a module pointer given its
	  name.

2004-05-29 12:52  castaglia

	* modules/mod_ctrls.c:
	  Add more info to the ControlsLog when the ControlsAuthFreshness
	  is exceeded, to help in debugging why this happens.

2004-05-29 11:55  castaglia

	* contrib/mod_tls.c:
	  Typo (thanks John!).

2004-05-28 21:22  castaglia

	* doc/howto/Directory.html:
	  Wording update.

2004-05-28 21:19  castaglia

	* contrib/mod_tls.c:
	  Fix handling of memory passed to mlock(2).  It seems that
	  mlock(2) is very picky, and wants a page-aligned address only.
	  malloc(3)/calloc(3) do not return page-aligned addresses by
	  default (although FreeBSD's man page suggests that for a
	  sufficient size request, they will), so we help them along by
	  adding some page-alignment code.  We still want to stash the
	  pointer returned by malloc(), not the aligned address, so that we
	  can properly free the allocated memory later.

	  Also use pr_log_debug(), rather than logging to the TLSLog, when
	  locking passphrases into memory, for at that point in the server
	  lifecycle, the TLSLog has not yet been opened.

2004-05-28 18:56  castaglia

	* contrib/mod_tls.c:
	  Silence a compiler warning by providing a default value.

2004-05-28 18:55  castaglia

	* contrib/mod_tls.c:
	  Typo.

2004-05-28 17:28  castaglia

	* src/scoreboard.c:
	  Unblock signals properly.

2004-05-28 09:46  castaglia

	* README.modules:
	  Update this README.

2004-05-27 10:20  castaglia

	* contrib/mod_tls.c:
	  Registering for the wrong event: we want 'core.postparse', not
	  'core.restart'.  Close the TLSLog during a restart, so that it
	  can be rolled.  The TLSLog will be reopened by the next session.

2004-05-26 12:25  castaglia

	* src/ctrls.c:
	  Make sure that the destination ctrl object has a valid temporary
	  pool from which to copy arguments.

2004-05-26 11:54  castaglia

	* src/dirtree.c:
	  Reset the sid (server ID) counter when preparing to parse a
	  configuration.

2004-05-25 19:17  castaglia

	* configure:
	  Updating configure script.

2004-05-25 19:15  castaglia

	* config.h.in, configure.in:
	  Check if intptr_t is defined.

2004-05-25 16:31  castaglia

	* modules/mod_ctrls.c:
	  When closing fds, set them to -1, to make sure that a cached fd
	  value is not inadvertently used somewhere it shouldn't be.  Also,
	  block alarms when handling the 'core.restart' event.

2004-05-25 16:00  castaglia

	* contrib/mod_tls.c:
	  Check the return value of SSL_CTX_set_default_verify_locations(),
	  and log the error (if any).

2004-05-25 10:41  castaglia

	* doc/howto/BCP.html:
	  Wording.

2004-05-25 10:17  castaglia

	* src/main.c:
	  Make sure that fixup_servers() happens before generating the
	  'core.postparse' event (mod_tls' 'core.postparse' handler was
	  tickling a segfault because one of the server_recs had a NULL
	  ServerName field; fixup_servers() sets all of the server_rec
	  fields appropriately).

2004-05-24 16:27  castaglia

	* modules/mod_ctrls.c:
	  Fix a problem when restarting a proftpd with mod_ctrls.  Some
	  variables were allocated from the module pool, and then being
	  used after that pool had been destroyed/reallocated.	This meant
	  that different configurations and interactions might (or might
	  not) work.

2004-05-24 14:35  castaglia

	* lib/pr-syslog.c:
	  Mention the Sun bug number that caused the /dev/log kernel memory
	  leak.

2004-05-22 17:11  castaglia

	* contrib/mod_quotatab_sql.c:
	  Typo.

2004-05-22 16:59  castaglia

	* contrib/mod_quotatab_sql.c:
	  Don't complain about being unable to delete a nonexistent
	  QuotaLock.

2004-05-21 10:46  castaglia

	* RELEASE_NOTES:
	  Style.

2004-05-21 10:35  castaglia

	* RELEASE_NOTES:
	  Update the release notes with mention of TimeoutLinger.

2004-05-21 10:19  castaglia

	* NEWS, include/data.h, modules/mod_core.c, src/data.c:
	  Add a TimeoutLinger option.  It's just simpler to change this
	  value via the config file, for those sites that encounter
	  troubles with lingering closes, rather than requiring a
	  reconfigure and recompile.

2004-05-20 10:28  castaglia

	* contrib/mod_ctrls_admin.c:
	  Check for signals while waiting for all kids to end when handling
	  a graceful shutdown.

2004-05-19 20:39  castaglia

	* doc/howto/: Controls.html, index.html:
	  Add a Controls howto.

2004-05-19 14:44  castaglia

	* modules/mod_auth.c:
	  Make sure a Class has been assigned before attempting to use it.

2004-05-19 10:07  castaglia

	* NEWS, lib/pr-syslog.c, src/main.c:
	  Bug#2336 - Use of /dev/log on Solaris leads to kernel memory
	  leak.

2004-05-18 19:32  castaglia

	* src/dirtree.c:
	  Style.

2004-05-18 16:22  castaglia

	* contrib/mod_ctrls_admin.html:
	  Typo.

2004-05-18 15:43  castaglia

	* contrib/mod_ctrls_admin.html:
	  Document that 'ftpdctl get' accepts both 'config' and
	  'directives' parameters.

2004-05-17 11:24  castaglia

	* modules/mod_auth.c, modules/mod_xfer.c, src/data.c, src/main.c:
	  Generate events when the Timeout* callbacks cause the session to
	  time out.

2004-05-15 10:25  castaglia

	* src/data.c:
	  Fix an edge case when handling ASCII translation: if this buffer
	  ends in a CR, and the next buffer starts with an LF, we need not
	  add a CR in front of the LF.	Prior to this change, though,
	  proftpd would forget about that dangling CR in the previous
	  buffer, treat the LF as a bare LF, and add a CR, resulting in a
	  CR-CR-LF sequence in the output stream rather than the proper
	  CR-LF.

2004-05-13 07:01  castaglia

	* contrib/mod_tls.c, include/modules.h, src/main.c, src/modules.c:
	  Remove the explicit postparse callback registration code in favor
	  of the new Events API.

2004-05-12 19:58  castaglia

	* contrib/mod_tls.c:
	  Use more future-proof APIs to access the X509v3 subjectAltNames
	  in the client cert.  Properly NUL-terminate strings obtained from
	  memory BIOs.

2004-05-12 18:13  castaglia

	* NEWS, modules/mod_auth.c, src/mkhome.c:
	  Bug#2410 - CreateHome always copies skel directory.

2004-05-11 19:20  castaglia

	* src/main.c:
	  I don't think this is valid anymore, if it ever was.	The
	  IPV6_ADDRFORM socket option is not supported on FreeBSD or
	  Solaris, and looks to be deprecated (if not removed entirely) in
	  later Linux kernels.

2004-05-11 16:37  castaglia

	* NEWS, modules/mod_auth_file.c, modules/mod_auth_unix.c:
	  Bug#2407 - mod_auth_file does not allow for proper cascading of
	  "end" and "set" auth requests

2004-05-11 09:56  castaglia

	* include/modules.h, src/main.c, src/modules.c:
	  Removing the daemon startup registration handlers; these have
	  been superceded by Events (e.g. the "core.startup" event).

2004-05-10 10:50  castaglia

	* NEWS, src/main.c:
	  Bug#2332 - SO_OOBINLINE error after upgrading proftpd from 1.2.6
	  to 1.2.9.  Attempt to fix by moving the setting of these socket
	  options to happen earlier in the session.

2004-05-09 13:05  castaglia

	* src/data.c:
	  When opening a data connection, check for the ESPV ALL mode as
	  well.

2004-05-08 18:07  castaglia

	* src/fsio.c:
	  When looking up the FS to use for a path, always start with the
	  root FS ("/") as the best FS to handle the path.  This fixes a
	  bug where the FS handlers registered by modules like mod_md5fs or
	  mod_gzipfs were being used for paths other than those for which
	  they were registered.

	  Also fix a bug where an FS that did not start with a '/', such as
	  one used by mod_conf_sql, would cause the FSIO API to prepend the
	  current location when it shouldn't have; the FSIO API simply
	  needed to use the proper check for whether the given path was an
	  absolute path or not.

2004-05-07 20:21  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Style cleanup of the SQL backend modules.  Also updating them to
	  use an event handler for the "core.exit" event.

	  Fixed their session initialization routines to always allocate a
	  new conn_pool and a new conn_cache.  Eventually the mod_sql API
	  will be revamped to handle these structures a little better.

2004-05-07 14:31  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2366 - Add support for -h list option.

2004-05-07 11:17  castaglia

	* modules/mod_ls.c:
	  Redeclaring a variable isn't a good thing to do.

2004-05-06 20:36  castaglia

	* src/child.c:
	  Include <signal.h> so that the kill(2) function prototype is
	  visible.

2004-05-06 08:35  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2405 - "LIST *" should not list dotfiles.

2004-05-05 10:49  castaglia

	* src/child.c:
	  Fix the logic determining when to create a new child list.  Also,
	  when creating that list, use a subpool of the child_pool, rather
	  than passing child_pool itself; the list allocator assigns the
	  given pool into the list's 'pool' member, rather than creating a
	  subpool from the given pool and allocating the list from what
	  (which is how I would expect it to be done).

2004-05-04 09:54  castaglia

	* lib/glibc-glob.c:
	  The buffer length should be PR_TUNABLE_LOGIN_MAX + 1.

2004-05-03 19:59  castaglia

	* lib/glibc-glob.c:
	  Patch the bundled glob implementation to use PR_TUNABLE_LOGIN_MAX
	  when the _SC_LOGIN_MAX sysconf variable is not available.  This
	  brings the implementation more in line with the rest of proftpd.

2004-05-03 10:25  castaglia

	* NEWS, include/class.h, src/class.c, src/main.c:
	  Bug#2403 - Sending SIGHUP to proftpd stops it when using Classes.

2004-05-02 08:05  castaglia

	* NEWS, contrib/mod_rewrite.c, contrib/mod_rewrite.html:
	  Bug#2082 - Add mod_rewrite "replaceall" builtin function.

2004-05-01 22:42  castaglia

	* NEWS, contrib/mod_ctrls_admin.c, contrib/mod_ctrls_admin.html:
	  Bug#2399 - Rename start/stop control actions to up/down.

2004-05-01 20:39  castaglia

	* include/glibc-glob.h:
	  Quell some warnings seen on FreeBSD by checking that a
	  preprocessor symbol (_FILE_OFFSET_BITS) is defined before using
	  its value in a comparison.

2004-05-01 11:44  castaglia

	* contrib/mod_tls.c:
	  Only report the version of OpenSSL being used at debug level 2 or
	  higher.

2004-05-01 11:27  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2401 - MaxClientsPerClass only checks first directive in
	  config file.

2004-05-01 11:01  castaglia

	* NEWS, src/class.c:
	  Bug#2400 - <Class> search order is wrong.

2004-04-30 12:01  castaglia

	* NEWS, contrib/mod_ctrls_admin.c, contrib/mod_ctrls_admin.html,
	  include/child.h, src/child.c, src/main.c:
	  Bug#2034 - Add support for a "graceful shutdown" signal.
	  Includes adding a convenience function to the Child API,
	  child_signal(), for sending a given signal to all child
	  processes.

2004-04-29 13:09  castaglia

	* contrib/mod_ctrls_admin.html:
	  Typo.

2004-04-29 12:28  castaglia

	* Make.rules.in, include/child.h, include/conf.h, src/child.c,
	  src/main.c:
	  Move the handling of child objects into their own file.  This
	  will help by letting modules be able to know how many existing
	  sessions there are.  However, the child list routines will not be
	  in the public "pr_" namespace, as they are not currently suitable
	  for general consumption.

2004-04-28 20:35  castaglia

	* contrib/mod_ldap.c, include/sets.h, modules/mod_auth_unix.c,
	  src/dirtree.c, src/main.c, src/sets.c, src/support.c:
	  Rename crufty 'mempool' symbol to be 'pool', which is more
	  consistent with the pool members of other proftpd structures.

2004-04-28 20:35  castaglia

	* README.IPv6:
	  Note the sysctl names that affect handling of wildcard sockets
	  and IPv6 binds.  The current code should override these sysctl
	  settings, but it is still good to have the sysctl names noted for
	  reference.

2004-04-28 18:55  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2396 - NLST command doesn't understand options.

2004-04-28 14:29  castaglia

	* modules/mod_core.c:
	  When using pr_fs_copy_file() to handle RNFR/RNTO across device
	  mounts, make sure to unlink the source path.

2004-04-28 14:00  castaglia

	* include/version.h:
	  Set version back to CVS status for rc2.

2004-04-28 10:54  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2004-04-28 10:52  castaglia

	* NEWS, include/version.h, contrib/dist/rpm/proftpd.spec:
	  Preparing to roll 1.2.10rc1 tarball.

2004-04-28 10:43  castaglia

	* README, RELEASE_NOTES:
	  Add a RELEASE_NOTES file (name may change in the future) that
	  will track the sort of comments usually mentioned in the release
	  announcement email, including new and deprecated configuration
	  directives, new and deprecated modules, upgrade notes, etc.

	  Add a note about RELEASE_NOTES to the README.

2004-04-27 13:49  castaglia

	* contrib/mod_sql.html:
	  Update mod_sql installation instructions.

2004-04-27 09:58  castaglia

	* modules/mod_xfer.c:
	  Make the error message returned here consistent with the other
	  occurrences of 500 responses in mod_xfer.

2004-04-26 16:33  castaglia

	* include/dirtree.h, src/dirtree.c:
	  Split the Boolean checking code into a public function, so that
	  it can be used for checking strings from sources other than
	  cmd_recs.

2004-04-23 18:17  castaglia

	* modules/mod_auth.c:
	  Do not warn about a successful root login until after root has
	  indeed successfully logged in.

2004-04-23 18:13  castaglia

	* doc/modules/mod_auth_pam.html:
	  Add HTML docs for mod_auth_pam.

2004-04-23 14:29  castaglia

	* modules/mod_ls.c:
	  The prior fix for Bug#2367 has some unintended (i.e. _bad_)
	  consequence, spotted by Michael.  This fixes it up properly
	  (hopefully for good).

2004-04-23 13:46  castaglia

	* src/netacl.c:
	  The '{' character is also used in globs.

2004-04-23 11:35  castaglia

	* modules/mod_ls.c:
	  Write a debug message, level 1, when NLST commands with options
	  (as from ncftp) are received.

2004-04-22 18:32  castaglia

	* contrib/mod_sql.c:
	  Protect against a possible segfault that occurs when mod_sql
	  assumes that a query has data, by checking for a valid data
	  pointed in the returned modret_t object.

2004-04-21 18:32  castaglia

	* src/inet.c:
	  Only set the TOS (Type Of Service) flags on IPv4 sockets; IPv6
	  sockets don't support TOS flags, as far as I know.  This should
	  fix the

	    error setting write fd IP_TOS: Option not supported by protocol

	  errors seen on some platforms (e.g. Solaris).

2004-04-21 14:29  castaglia

	* doc/howto/: index.html, Classes.html:
	  Add a howto for the new <Class> format.

2004-04-20 18:23  castaglia

	* src/main.c:
	  Style cleanup.

2004-04-20 18:15  castaglia

	* src/main.c:
	  Capture the actual errno value, rather than assuming that
	  intervening functions will not change errno.

2004-04-20 16:26  castaglia

	* doc/howto/Limit.html:
	  Consistency of style is a Good Thing.

2004-04-20 13:57  castaglia

	* contrib/mod_ctrls_admin.c:
	  If the 'dump classes' control action is requested, make sure that
	  the Class dump output includes the Satisfy setting.

2004-04-19 19:05  castaglia

	* src/log.c:
	  Fix the logging of IP addresses in the utmp/wtmp log on Linux.
	  Formatting cleanup.

2004-04-19 16:59  castaglia

	* include/class.h, modules/mod_core.c, src/class.c:
	  Add a Satisfy directive.  Note that this directive does NOT
	  function like Apache's Satisfy directive.  This current
	  implementation is to be used when defining a class, to specify
	  how to evaluate all of the rules of the class: any, or all.

	  Future work will overload this directive to work as users would
	  like (see Bug#1898) for the <Limit> context.

2004-04-19 16:33  castaglia

	* src/dirtree.c:
	  Report line numbers when parsing .ftpaccess files, too.

2004-04-18 10:00  castaglia

	* src/dirtree.c:
	  Have the fatal messages reported during configuration parsing
	  report the line number and configuration file, for easier fixing
	  of broken configs.

2004-04-16 09:33  castaglia

	* NEWS, include/privs.h:
	  Bug#2317 - Wrong order of privs calls on HP generates "unable to
	  setregid()".	error.	The problem turned out to be a call to
	  setregid() before a call to setreuid(), but only in the HP privs
	  code (non-seteuid() case).  The fix was trivial: call setreuid()
	  first, to make sure the proper UIDs are set, then call
	  setregid().

2004-04-15 18:08  castaglia

	* NEWS:
	  Mention in NEWS the new doc/modules/ directory.

2004-04-15 17:54  castaglia

	* doc/modules/mod_ctrls.html:
	  Updating mod_ctrls' installation instructions.

2004-04-15 17:36  castaglia

	* doc/modules/: mod_auth_file.html, mod_cap.html, mod_ctrls.html:
	  Add a 'doc/modules/' directory, for core module documentation.
	  Add the docs for mod_auth_file, mod_cap, and mod_ctrls.

2004-04-15 17:19  castaglia

	* contrib/: mod_ifsession.html, mod_quotatab.html, mod_radius.html,
	  mod_sql.html, mod_tls.html, mod_wrap.html:
	  Formatting fixups.

2004-04-15 16:16  castaglia

	* include/ctrls.h:
	  These changes should've been part of an earlier commit.

2004-04-15 15:19  castaglia

	* contrib/mod_rewrite.html:
	  The features listed under "future work" have been implemented.

2004-04-15 15:14  castaglia

	* contrib/mod_tls.c:
	  Much improved handling of OpenSSL's error queue, so that the
	  TLSLog can properly show all of the errors in the queue (rather
	  than just the top error, which is usually not too helpful in
	  pinpointing the actual problem).

2004-04-15 14:31  castaglia

	* contrib/mod_rewrite.html:
	  Document the flags parameters for RewriteCondition, RewriteRule.
	  Also document the possible pattern variants allowed for
	  RewriteCondition.  Add an example of using mod_rewrite to make
	  all uploaded files have uppercased filenames.

2004-04-15 11:46  castaglia

	* sample-configurations/basic.conf:
	  The default configuration file should not allow use of SITE
	  CHMOD.

2004-04-15 10:33  castaglia

	* contrib/mod_rewrite.html:
	  Formatting typo.

2004-04-14 19:47  castaglia

	* src/main.c:
	  Cleanup the error reported if the PidFile cannot be opened.

2004-04-14 13:25  castaglia

	* modules/mod_core.c:
	  Michael suggested that this log message be at the INFO level.

2004-04-14 11:11  castaglia

	* contrib/mod_ctrls_admin.c, modules/mod_ctrls.c, src/ctrls.c:
	  Remove the unused 'set' control action from mod_ctrls_admin.
	  Make the 'lsctrl' control action list only enabled control
	  actions.  Initialize the ControlsSocketACL such that access to
	  the socket is allowed to everyone by default; access to
	  individual control actions still defaults to "deny" unless access
	  is explicitly granted via configuration.

2004-04-13 13:19  castaglia

	* doc/howto/Filters.html:
	  Emphasize _not_ using both an Allow and a Deny Filter at the same
	  time.

2004-04-13 10:55  castaglia

	* include/privs.h:
	  Revert part of my previous update to privs.h; it included a
	  possible fix for Bug#2317, but that fix is not ready to be
	  committed just yet.

2004-04-13 10:52  castaglia

	* NEWS, include/privs.h:
	  Bug#2387 - PRIVS_USER macro should set effective GID to user's
	  primary GID.

2004-04-13 09:48  castaglia

	* include/dirtree.h, src/dirtree.c:
	  Add a SID (Server ID) to every server_rec.  This SID is a unique
	  ID that is automatically assigned to each generated server_rec
	  when proftpd parses its configuration.  SIDs are useful for
	  tracking purposes, particularly for contrib modules that want to
	  track which vhost caused something to happen.

	  Format/style cleanups, removed unused CLASS_USER #define.

2004-04-13 09:46  castaglia

	* contrib/mod_ctrls_admin.c:
	  Update the proftpd version required by mod_ctrls_admin.

2004-04-12 10:41  castaglia

	* modules/mod_auth.c:
	  Have AnonRejectPasswords generate an event.

2004-04-12 10:35  castaglia

	* modules/mod_ctrls.c:
	  Consistent use of strcmp().  Use ANY_MODULE where appropriate,
	  rather than NULL.

2004-04-12 10:14  castaglia

	* src/fsio.c:
	  Fix pr_fsio_getline() to handle the case where a config line,
	  broken across several lines in the config file using line
	  continuations, has one of the lines commented out, e.g.:

	     SomeDirective \
	       foo \
	     #	bar \
	       baz

	  Without this patch, pr_fsio_getline() would return the '#'
	  character, which is not what most people would think would
	  happen.

2004-04-12 10:09  castaglia

	* src/dirtree.c:
	  Be a little more strict when checking for "${env:...}" strings in
	  the config file.

	  Format/style cleanup.

2004-04-11 15:50  castaglia

	* doc/howto/: BCP.html, Globbing.html, index.html:
	  Add the Globbing and BCP howtos.

2004-04-11 15:38  castaglia

	* include/options.h:
	  Updating outdated comments.

2004-04-11 15:13  castaglia

	* modules/mod_xfer.c:
	  Typo.

2004-04-11 15:03  castaglia

	* modules/mod_xfer.c:
	  Make the 'core.signal.USR2' event handler check for new
	  TransferRates when involved in any of the file data transfer
	  commands (APPE, RETR, STOR, STOU), not just RETR.  Update
	  comments as well.

2004-04-11 13:42  castaglia

	* NEWS, modules/mod_ctrls.c, src/ctrls.c:
	  Bug#2383 - mod_ctrls.c: ctrls_listen(): Invalid size in bind()
	  argument.

2004-04-11 13:35  castaglia

	* modules/mod_xfer.c:
	  Add a handler for the event 'core.signal.USR2' to mod_xfer.  The
	  handler causes mod_xfer, if and only if the RETR command is
	  currently being handled, to rescan the config tree for
	  TransferRate entries.

	  The 'core.signal.USR2' event is only generated when Controls have
	  been enabled, so in most cases this won't change anything.  Its
	  purpose is mainly to help the mod_shaper module be able to change
	  the TransferRate for a session in mid-transfer.

2004-04-11 13:27  castaglia

	* include/dirtree.h, src/dirtree.c:
	  Add a new merge flag, CF_SILENT.  Unlike the rest of the CF_
	  flags, this flag is handled by fixup_dirs(); the other CF_ flags
	  are handled by the internal _reorder_dirs() function.  When
	  fixup_dirs() sees CF_SILENT, it will not print a debug
	  configuration dump, which is its default behavior.

2004-04-11 13:22  castaglia

	* src/event.c:
	  Make sure that the order of event registration matches module
	  load order.  This helps when the same event may be handled by
	  multiple modules, and the order of handling is important.

2004-04-11 13:12  castaglia

	* modules/mod_core.c:
	  This copy of copy_file() is no longer needed.

2004-04-10 13:55  castaglia

	* contrib/: ftpasswd.html, ftpquota.html, mod_ctrls_admin.html,
	  mod_ifsession.html, mod_quotatab.html, mod_quotatab_file.html,
	  mod_quotatab_ldap.html, mod_quotatab_sql.html, mod_radius.html,
	  mod_rewrite.html, mod_site_misc.html, mod_sql.html, mod_tls.html,
	  mod_wrap.html:
	  Minor formatting change (removed extraneous <br>).

2004-04-10 13:42  castaglia

	* doc/howto/: FXP.html, index.html:
	  Add FXP howto.

2004-04-10 13:37  castaglia

	* doc/howto/: NAT.html, index.html:
	  Add NAT howto.

2004-04-10 13:11  castaglia

	* doc/howto/SQL.html:
	  Update the SQL howto to mention using SQLLogFile.

2004-04-10 12:02  castaglia

	* doc/howto/index.html:
	  Add an index page for these howtos.

2004-04-10 11:44  castaglia

	* doc/howto/Directory.html:
	  Typo.

2004-04-10 11:33  castaglia

	* doc/howto/Directory.html:
	  Add paragraph describing how the * glob within a path is matched
	  (i.e.  only for single directory level, not multiple directory
	  levels).

2004-04-10 11:01  castaglia

	* doc/howto/: Authentication.html, Chroot.html, ConfigFile.html,
	  Debugging.html, Directory.html, FTP.html, Filters.html,
	  Limit.html, SQL.html, ServerType.html, Stopping.html, TLS.html,
	  Umask.html, Vhost.html:
	  Standardize on "Last Updated" in the footer.

2004-04-10 10:59  castaglia

	* doc/howto/Logging.html:
	  Add Logging doc.

2004-04-10 10:42  castaglia

	* doc/howto/: Authentication.html, ConfigFile.html, Filters.html,
	  Limit.html, ServerType.html, Stopping.html, Vhost.html:
	  Modifying links in docs to reference other docs in this area,
	  rather than the pages on www.castaglia.org.

2004-04-10 10:29  castaglia

	* doc/howto/Stopping.html:
	  Add doc for starting/stopping proftpd.

2004-04-10 10:23  castaglia

	* doc/howto/FTP.html:
	  Add doc covering FTP commands supported by proftpd.

2004-04-10 10:16  castaglia

	* doc/howto/ServerType.html:
	  Adding ServerType doc.

2004-04-09 19:30  castaglia

	* modules/mod_auth_unix.c:
	  When compiling on a HP-UX box which supports bigcrypt(), the
	  following warning is seen:

	    passing arg 1 of `bigcrypt' discards qualifiers from pointer
	  target type

	  Quell this warning by explicitly casting the arguments to
	  bigcrypt() to be char *.

2004-04-09 19:01  castaglia

	* doc/howto/SSH.html:
	  Add FTP-over-SSH mini-HOWTO.

2004-04-09 17:34  castaglia

	* doc/howto/: Authentication.html, Chroot.html, ConfigFile.html,
	  Debugging.html, Directory.html, Filters.html, Limit.html,
	  SQL.html, TLS.html, Umask.html, Vhost.html:
	  Adjusting footers for consistency.

2004-04-09 17:19  castaglia

	* doc/howto/Umask.html:
	  Add the Umask mini-HOWTO.

2004-04-09 11:49  castaglia

	* doc/howto/Filters.html:
	  Add the Filters mini-HOWTO to the source distro.

2004-04-09 10:19  castaglia

	* contrib/: mod_ctrls_admin.c, mod_ctrls_admin.html:
	  Add ability to kick entire Classes via the 'kick' action.

2004-04-09 09:58  castaglia

	* include/fsio.h, modules/mod_core.c, src/fsio.c, src/mkhome.c:
	  The CreateHome code also included a static copy_file() function.
	  This change refactors the code so that both CreateHome and the
	  rename-across-mount-points code both use the same function, added
	  to the FSIO code as pr_fs_copy_file().  Code reuse good.

2004-04-09 09:54  castaglia

	* contrib/mod_ifsession.c:
	  Removing this HOOK, as it won't work as intended.  May re-add in
	  the future.

2004-04-08 17:23  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2385 - Renames fail with error "Invalid cross-device link".
	  In the case of EXDEV from rename(2), mod_core now manually copies
	  the file from the source to the destination location.  Any
	  content existing at the destination location is lost.

2004-04-08 15:50  castaglia

	* contrib/mod_ifsession.html:
	  Add note about making sure that mod_ifsession is last in the
	  --with-modules list.

2004-04-07 19:54  castaglia

	* contrib/mod_ctrls_admin.html:
	  Updating author, copyright info.

2004-04-07 19:43  castaglia

	* contrib/mod_ctrls_admin.html:
	  Add mod_ctrls_admin docs for the 'kick' action.

2004-04-07 19:39  castaglia

	* contrib/mod_ctrls_admin.c:
	  Add the 'kick' action to mod_ctrls_admin, for disconnecting
	  clients by user or host names.

2004-04-07 13:12  castaglia

	* doc/howto/Authentication.html:
	  Add note about avoiding use of mod_auth.c and mod_auth_pam.c in
	  AuthOrder directives.

2004-04-07 12:55  castaglia

	* contrib/mod_quotatab.html:
	  Add comment about per-session settings in mod_quotatab docs.

2004-04-07 12:02  castaglia

	* contrib/mod_quotatab.c:
	  Add a QuotaLog message warning that when per_session is true, the
	  QuotaTallyTable will not be updated.

2004-04-06 16:17  castaglia

	* NEWS, config.h.in:
	  Bug#2221 - proftpd on hp-ux 11.22.  Override the default
	  socklen_t detection on HP-UX 11 to be an int.  APR suffers from
	  this same problem (the bug is ultimately an HP-UX problem).

2004-04-05 18:50  castaglia

	* src/ctrls.c:
	  Fix a format warning on Solaris.

2004-04-05 16:01  castaglia

	* contrib/mod_tls.c:
	  Make sure and clear the relevant bits in tls_flags when the
	  control and data channels are closed.

2004-04-05 11:01  castaglia

	* src/ctrls.c:
	  Remove a hardcoded maximum limit on the size of request strings
	  that can be sent using the Controls API.  Uncovered when trying
	  to send messages larger than 8 Kb via SysV message queues.

2004-04-05 10:59  castaglia

	* modules/mod_auth.c, src/scoreboard.c:
	  Check for an error return value from pr_rewind_scoreboard().

	  Keep track of the process which opened the cached scoreboard fd.
	  It's possible to have the daemon process open the fd, and then
	  fork, which means the child will have that same fd.  However, the
	  child may fdopen() another file onto that fd (e.g. if the fd is
	  0), thus losing the scoreboard fd.  This patch also prevents the
	  possibility of a file descriptor leak by having the same process
	  open the scoreboard multiple times (e.g. when multiple modules
	  call pr_open_scoreboard()).

2004-04-05 10:54  castaglia

	* NEWS:
	  Mention the adding of mini-HOWTOs in NEWS.

2004-03-25 11:22  castaglia

	* configure:
	  Updating configure.

2004-03-25 11:16  castaglia

	* configure.in:
	  Remove checks for README.mod_sql from configure.

2004-03-25 09:33  castaglia

	* contrib/mod_tls.c:
	  Report the version of OpenSSL used in server debugging output.

2004-03-24 13:57  castaglia

	* contrib/ftpasswd.html:
	  Reflect Bug#2371's new --not-previous-passsword addition in the
	  ftpasswd HTML docs.

2004-03-24 13:55  castaglia

	* NEWS, contrib/ftpasswd:
	  Bug#2371 - ftpasswd should have option to compare password
	  against value in passwd file.

2004-03-23 15:29  castaglia

	* contrib/mod_tls.c:
	  Be more explicit about the expected return value from
	  SSL_CTX_load_verify_locations(3).  Handle the cases where the
	  pointers to the CA file or CA path may be NULL, as some libcs do
	  not handling printing of NULL pointers gracefully, unlike glibc.

2004-03-23 10:40  castaglia

	* modules/mod_ls.c:
	  Add a comment explaining the fix for Bug#2367.

2004-03-23 10:37  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2367 - LIST *.* strange behaviour.

2004-03-22 11:44  castaglia

	* doc/howto/: Authentication.html, Chroot.html, ConfigFile.html,
	  Debugging.html, Directory.html, Limit.html, TLS.html, Vhost.html:

	  Adding more howtos.

2004-03-22 11:32  castaglia

	* README.mod_sql:
	  Removing this outdated README; see doc/howto/SQL.html for an
	  updated version.

2004-03-22 11:31  castaglia

	* doc/howto/SQL.html:
	  Adding an HTML SQL howto to the doc/ area, to replace the
	  README.mod_sql (which is now terribly outdated).

2004-03-19 12:22  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2369 - EPSV should not send network address when
	  MasqueradeAddress is used.  RFC 2428 is not very clear on this
	  point, for it introduces a discrepancy in the possible responses
	  to PASV versus EPSV.	Until this can be cleared up, do not honor
	  MasqueradeAddress when EPSV is used by the client.

2004-03-17 10:48  castaglia

	* contrib/mod_sql.html:
	  Removed mention of "*" for the SQLAuthenticate directive.

2004-03-16 13:46  castaglia

	* contrib/mod_sql.c:
	  Mark the SQLLog and SQLShowInfo config_recs as
	  CF_MERGEDOWN_MULTI.  This doesn't affect how mod_sql processes
	  these directives, but it does make them work properly within
	  mod_ifsession blocks.

2004-03-10 18:18  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2363 - ABOR response RFC 959 compliance.

2004-03-10 18:02  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2361 - Second USER command causes problems with chrooted
	  session.  The PRE_CMD handler for C_USER should check to see if a
	  user is already logged in before doing any processing.

2004-03-10 16:13  castaglia

	* NEWS:
	  Typos.

2004-03-09 17:31  castaglia

	* include/privs.h:
	  Typo.

2004-03-08 16:53  castaglia

	* src/netaddr.c:
	  Add some debug logging, level 10, showing when a name is being
	  resolved to its IP addresses, including when DNS is used.

	  At debug level 10, things are getting quite verbose; we should
	  start looking into debugging output masks.

2004-03-08 12:32  castaglia

	* README.controls:
	  Clarify that using --enable-ctrls means not using
	  --with-modules=mod_ctrls.

2004-03-05 10:48  castaglia

	* modules/mod_core.c:
	  On second thought, setting errno to ENOENT in these cases may not
	  be the best idea.

2004-03-05 10:36  castaglia

	* modules/mod_core.c:
	  Make sure that errno has an appropriate value in the case where a
	  resolved path may actually be NULL.  Also, report on failed paths
	  using cmd->arg, rather than cmd->argv[1], to handle the case
	  where the client may have specified a path containing whitespace
	  characters.

2004-03-05 10:22  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2321 - FTP permission checks inconsistent for DELE and RMD
	  when symlink in directory path.  For future reference, if
	  dir_canonical_path() is used to obtain a path, use
	  dir_check_canon() for checking <Limit> permissions on that
	  returned path, instead of using dir_check().	The dir_* namespace
	  could use some cleaning up, to make this sort of relationship a
	  little clearer.

2004-03-04 19:24  castaglia

	* NEWS, utils/ftptop.c:
	  Bug#2357 - ftptop should use COLS for determining display width.

2004-03-04 19:00  castaglia

	* configure:
	  Updating configure.

2004-03-04 18:13  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_xfer.c:
	  Bug#2353 - REST doesn't handle offsets greater than 2 GB.

2004-03-04 13:13  castaglia

	* modules/mod_core.c:
	  Change handling of the SetEnv, UnsetEnv directives so that that
	  they can be set on a per-vhost basis.

2004-03-03 17:41  castaglia

	* contrib/mod_tls.c:
	  Didn't mean to commit those debugging changes.  Oops.

2004-03-03 17:33  castaglia

	* contrib/mod_tls.c:
	  No need to be that verbose.

2004-03-03 13:21  castaglia

	* contrib/mod_tls.c:
	  Handle the case where mod_tls has been configured to set
	  environment variables but the client does not present a
	  certificate (e.g. when not verifying clients).  Previously, this
	  would cause a segfault.

2004-03-02 16:24  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2355 - Send error message to client when 'TLSRequired both'
	  is in effect.

2004-03-02 09:43  castaglia

	* contrib/mod_tls.c:
	  Typo.

2004-03-01 08:55  castaglia

	* include/conf.h:
	  Doesn't help to check for <utime.h> if we don't include it.

2004-03-01 08:54  castaglia

	* contrib/mod_ctrls_admin.c:
	  Typo.  Eventually, mod_ctrls_admin's dump control will handling
	  list of variables in the (as yet uncommitted) Variables API.

2004-03-01 08:47  castaglia

	* configure:
	  Updating configure.

2004-03-01 08:44  castaglia

	* config.h.in, configure.in:
	  Check for the <utime.h> system header.

2004-03-01 08:43  castaglia

	* contrib/mod_ctrls_admin.c, contrib/mod_ctrls_admin.html,
	  src/netacl.c:
	  Complete the 'dump classes' control for mod_ctrls_admin.  Also
	  adds the missing pr_netacl_get_type() function.

2004-03-01 08:42  castaglia

	* src/event.c:
	  Add some basic caching of the last valid event generated, as a
	  minor optimization.

2004-02-27 16:17  castaglia

	* contrib/mod_sql.html:
	  Add HTML docs for mod_sql.

2004-02-27 14:53  castaglia

	* modules/mod_ls.c:
	  STAT is an INFO command more than it is a DIRS command (for
	  logging purposes).

2004-02-27 14:42  castaglia

	* contrib/mod_sql.c:
	  Add handling of the %L (local IP address) and %V (local DNS name)
	  tags.  Fix formatting.

2004-02-27 11:44  castaglia

	* modules/mod_cap.c:
	  Bug#2348 prompted this addition of handling CAP_DAC_OVERRIDE and
	  CAP_DAC_READ_SEARCH, in addition to CAP_CHOWN.

2004-02-27 11:27  castaglia

	* NEWS, README.modules:
	  Bug#2257 - Add SITE SYMLINK command to mod_site.  Added a new
	  contrib module, mod_site_misc, instead.

2004-02-27 10:41  castaglia

	* contrib/: mod_site_misc.c, mod_site_misc.html:
	  New contrib module that implements miscellaneous SITE commands
	  (e.g. SITE SYMLINK, SITE UTIME, etc) that other ftpds may
	  recognize (e.g. ncftpd).

2004-02-24 12:34  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2339 - STAT command doesn't follow RFC959.

2004-02-24 12:32  castaglia

	* sample-configurations/basic.conf:
	  It's a little more efficient to have AllowOverwrite in the server
	  config context, rather than in a <Directory> context that covers
	  the entire filesystem.

2004-02-24 12:13  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2311 - MaxClients counts unauthenticated users.

2004-02-24 11:45  castaglia

	* contrib/mod_sql.c:
	  Oops.  My previous commit included my work-in-progress patch for
	  SQLShowInfo, which isn't ready yet.

2004-02-24 11:39  castaglia

	* contrib/mod_sql.c:
	  Fixed a bug in mod_sql in the show_group() function, where a
	  large list of users that belonged to a single group could tickle
	  a segfault.  There was a hardcoded buffer size of 2K that was
	  being exceeded.  Better to use pstrcat() and build up the needed
	  string.

	  Also add some typecasts to unsigned longs for reporting IDs.

2004-02-24 08:52  castaglia

	* modules/mod_core.c:
	  Typos.

2004-02-23 16:44  castaglia

	* modules/mod_xfer.c:
	  Allow uploading to FIFOs.  Should we allow uploading to symlinks,
	  too?

2004-02-23 15:27  castaglia

	* modules/mod_site.c:
	  mod_site no longer uses a configuration handler table.

2004-02-23 11:30  castaglia

	* src/dirtree.c:
	  Quell a minor compiler warning on OSX.

2004-02-23 10:34  castaglia

	* README.modules:
	  Adding mod_quotatab et al to the list of modules that accompany
	  proftpd.

2004-02-20 10:34  castaglia

	* NEWS, include/dirtree.h, modules/mod_core.c, src/dirtree.c,
	  src/main.c:
	  Bug#1696 - Include directive should support directories.

2004-02-20 09:10  castaglia

	* contrib/ftpasswd:
	  When the --not-system-password option is used, it's possible for
	  there to be no entry in the system password files for the user
	  being created, in which case $hash and $syspasswd will both be
	  the empty string -- and will match, making ftpasswd think that a
	  different password is needed.  Fix this by checking for the empty
	  strings.

2004-02-19 10:22  castaglia

	* README.IPv6:
	  Updating the IPv6 notes.

2004-02-19 10:13  castaglia

	* contrib/mod_ifsession.c:
	  Add a check for <Limit LOGIN> to mod_ifsession, after all the
	  configuration merging is done.  This allows for configurations
	  like:

	    <IfUser foo>
	      <Limit LOGIN>
		DenyAll
	      </Limit>
	    </IfUser>

2004-02-16 19:53  castaglia

	* NEWS, modules/mod_auth_pam.c:
	  Bug#2105 - Remove Authoritative directives.

2004-02-16 19:09  castaglia

	* contrib/ftpasswd.html:
	  Documenting the new --delete-user and --delete-group options.
	  Examples should be added at some point, too.

2004-02-16 19:06  castaglia

	* NEWS, contrib/ftpasswd:
	  Bug#2171 - Add delete options to ftpasswd.

2004-02-16 18:15  castaglia

	* Make.rules.in, contrib/mod_tls.c, include/conf.h, include/help.h,
	  modules/mod_auth.c, modules/mod_core.c, modules/mod_ls.c,
	  modules/mod_site.c, modules/mod_xfer.c, src/help.c:
	  Adding a new API so that modules can declare, for the HELP
	  response list, which FTP commands they support.  This makes it
	  easier/cleaner for contrib modules, e.g. mod_tls, to declare
	  their support for FTP commands that may not be handled by the
	  core code.

2004-02-16 15:05  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2237 - HiddenStores does not check for existing file in edge
	  case.

2004-02-15 14:58  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2327 - SQLNegativeCache causes unnecessary errors in server
	  logging.

2004-02-15 14:42  castaglia

	* contrib/mod_sql.c:
	  Note the directive name when warning of deprecated * usage.

2004-02-15 14:05  castaglia

	* contrib/mod_sql.c:
	  Disable the "*" functionality in SQLAuthenticate, which was used
	  to configure mod_sql to be authoritative.  This conflicts with
	  the AuthOrder configuration directive, which should be used
	  instead.

2004-02-15 11:41  castaglia

	* NEWS:
	  Mention in the NEWS file that Class and Classes are now
	  deprecated.

2004-02-13 15:37  castaglia

	* contrib/mod_quotatab.h:
	  Update mod_quotatab's PROFTPD_VERSION_NUMBER check.

2004-02-13 15:28  castaglia

	* contrib/mod_ifsession.c:
	  Update the PROFTPD_VERSION_NUMBER check.

2004-02-13 14:47  castaglia

	* contrib/mod_rewrite.c:
	  Updating mod_rewrite for Class code changes.

2004-02-13 14:45  castaglia

	* contrib/mod_quotatab.c:
	  Updating mod_quotatab for Class code changes.

2004-02-13 14:44  castaglia

	* contrib/mod_ifsession.c:
	  Updating mod_ifsession to reflect Class changes.

2004-02-12 15:46  castaglia

	* NEWS, Makefile.in:
	  Bug#2340 - Problem with parallel builds.

2004-02-11 19:48  castaglia

	* contrib/mod_radius.html:
	  Update the mod_radius installation instructions.

2004-02-11 19:47  castaglia

	* contrib/mod_radius.html:
	  Typo.

2004-02-11 19:41  castaglia

	* contrib/mod_radius.html:
	  Update the mod_radius docs.

2004-02-10 15:31  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2337 - TLSRenegotiate parameters not processed correctly.

2004-02-09 20:07  castaglia

	* contrib/mod_tls.c:
	  When walking the server_list list, we need to start with
	  server_list->xas_list, not just server_list.	This is a subtle
	  and easy to miss bug, and was causing the list-walking code to
	  attempt to access inaccessible memories (not good).

	  This highlights a need for a good list/set-iterating API, rather
	  than relying on details of the actual structures.

2004-02-07 17:55  castaglia

	* contrib/mod_readme.c:
	  Update mod_readme to use the new pr_gmtime() function.

2004-02-07 17:12  castaglia

	* NEWS, utils/ftpcount.c:
	  Bug#2306 - ftpcount output should handle case of no users.

2004-02-07 16:40  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2324 - Directories whose names contain whitespace are
	  inaccessible.  The problem was that the dir_check() call was
	  using cmd->argv[0], rather than cmd->arg; the former is the first
	  parameter of the command (where the parameters are assumed to be
	  whitespace-separated) whereas the latter is the entire parameter
	  list as a single string.  The rest of the patch cleans up the
	  formatting in the chdir() handling code.

2004-02-04 10:45  castaglia

	* src/xferlog.5.in:
	  Document in the xferlog(5) man page that any space or control
	  characters in a filename will be converted to an underscore in
	  TransferLogs.

2004-02-03 15:57  castaglia

	* NEWS, modules/mod_core.c, src/dirtree.c:
	  Bug#2315 - Overlapping virtual server causes error.

	  Also changes the collision check log messages to say "warning"
	  rather than "error".

2004-02-01 12:51  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2322 - NLST -a returns listing formatted for LIST -a.

2004-01-30 16:08  castaglia

	* src/log.c:
	  Addition of PID was redundant.  Oops.

2004-01-30 15:09  castaglia

	* src/netaddr.c:
	  "dup" is an already used global variable in some system headers.
	  How annoying.

2004-01-30 08:42  castaglia

	* src/main.c:
	  Remove an annoying "FTP session closed." message from being
	  logged when doing a simple syntax check of a proftpd.conf whose
	  ServerType is inetd.

2004-01-29 19:37  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2295 - mod_tls returns multi-line response to AUTH commands.

2004-01-29 19:09  castaglia

	* README.classes:
	  Explicitly mention that the Class and Classes directives are
	  deprecated.

2004-01-29 14:20  castaglia

	* Make.rules.in, NEWS, contrib/mod_sql.c, include/class.h,
	  include/conf.h, include/dirtree.h, include/netacl.h,
	  include/proftpd.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_log.c, src/class.c, src/dirtree.c, src/main.c,
	  src/netacl.c:
	  Bug#1925 - Clean up of Class code.

2004-01-28 19:37  castaglia

	* src/log.c:
	  If --enable-devel is used, add the PID to the server debugging
	  lines.  This might be useful enough to use all of the time, but
	  for now it'll be restricted to developer use.

2004-01-28 19:19  castaglia

	* include/netaddr.h, src/netaddr.c:
	  Add a new function, pr_netaddr_dup(), for convenience.

2004-01-28 17:03  castaglia

	* contrib/mod_quotatab.c:
	  The SITE QUOTA command should be marked as a CL_MISC class
	  command, so that ExtendedLogs that wish to log MISC commands
	  record it.

2004-01-20 16:35  cyberrobo

	* .cvsignore: adding ftpdctl to the ignorelist

2004-01-20 15:26  castaglia

	* contrib/mod_quotatab_sql.html:
	  Add FREEFORM INSERT query that is needed when talking to SQL
	  Server.

2004-01-20 09:11  castaglia

	* contrib/mod_radius.html:
	  Grammar fix.

2004-01-20 09:07  castaglia

	* contrib/mod_radius.html:
	  Make a note of some nonsensical RADIUS implementations not being
	  supported by mod_radius.

2004-01-19 10:00  castaglia

	* contrib/mod_ctrls_admin.c, modules/mod_ctrls.c:
	  No need to re-register the controls themselves, just reallocate
	  the ACLs from the new module pools.

2004-01-19 09:58  castaglia

	* contrib/mod_ctrls_admin.c, modules/mod_ctrls.c:
	  When handling the "core.restart" event, the module pools for both
	  mod_ctrls and mod_ctrls_admin are destroyed/recreated.  Since the
	  ACLs for the registered controls are allocated from these module
	  pools, the ACLs need to be recreated as well.

	  Also, when building mod_ctrls_admin, make sure that Controls
	  support has been enabled.

2004-01-19 09:42  castaglia

	* src/log.c:
	  Make pr_log_writefile() a little more robust, by checking whether
	  the given fd is valid before doing any work.

2004-01-18 11:01  castaglia

	* utils/: ftptop.c, utils.h:
	  No need to include <sys/types.h> in these files, as it is already
	  included in config.h.

2004-01-18 10:21  castaglia

	* modules/mod_ctrls.c:
	  Change the usage of PRIVS macros in some of mod_ctrls' config
	  handlers.  Michael found that this was causing problems when
	  restarting a proftpd with Controls enabled (see Bug#2242).

2004-01-18 10:11  castaglia

	* modules/mod_ctrls.c:
	  No need to log the error using root privs.

2004-01-17 22:07  cyberrobo

	* src/.cvsignore: added ftpdctl manpage to ignore list

2004-01-17 15:18  castaglia

	* configure:
	  Updating configure script.

2004-01-17 15:16  castaglia

	* NEWS, configure.in:
	  Bug#2320 - autoconf check for socklen_t doesn't work on FreeBSD
	  4.8-RELEASE.

2004-01-17 15:08  castaglia

	* NEWS, Makefile.in:
	  Bug#2319 - Build scripts have owner-only execute permission.

2004-01-17 14:57  castaglia

	* config.sub:
	  No, that didn't work.

2004-01-17 14:56  castaglia

	* config.sub:
	  Checking to see how to get permissions changed in CVS.  I think
	  CVS requires that the file itself (not just the mode) differ.

2004-01-16 12:47  castaglia

	* README.classes:
	  First draft of a README describing the new <Class> syntax.
	  Edits/additions welcome.

2004-01-15 16:45  castaglia

	* modules/mod_core.c:
	  Have the emitted vhost collision message say "warning", rather
	  than "error".

2004-01-15 16:29  castaglia

	* modules/mod_auth.c:
	  The current CreateHome description has the following examples:

	    CreateHome on skel /etc/ftpd/skel
	    CreateHome on dirmode 755
	    CreateHome on skel /etc/ftpd/skel dirmode 700

	  However, the current CreateHome implementation assumes that the
	  parameter after the Boolean will always be the mode.	This change
	  makes the config handler check for any preceding 'skel' or
	  'dirmode' keywords before trying to process that parameter as the
	  mode.  Hopefully now the examples will work properly.

2004-01-15 15:54  castaglia

	* contrib/mod_quotatab.c:
	  Christian Schulte <cs@schulte.it> noticed that the handling of
	  locks by mod_quotatab is not right.  The quotatab_write()
	  function would obtain a write-lock, then call quotatab_read() to
	  refresh its data, and quotatab_read() would degrade that
	  write-lock to a read-lock, then release it completely, leaving
	  the actual write operation unprotected by a lock.  This patch
	  fixes the contention in the locking routinese by having them
	  check and set a static variable.

2004-01-15 13:51  castaglia

	* README.controls:
	  Updating/fixing this document.

2004-01-14 12:57  castaglia

	* README.controls:
	  Add a README describing the new Controls code.  It's a work in
	  progress.

2004-01-13 20:00  castaglia

	* modules/mod_auth.c:
	  Fix compiler warning.

2004-01-13 15:47  castaglia

	* NEWS:
	  Add comment that bug 2183 is the same as bug 2165.

2004-01-12 15:13  castaglia

	* modules/mod_xfer.c:
	  Consistency.

2004-01-12 15:01  castaglia

	* modules/mod_xfer.c:
	  Report errors when closing a file that has been written.  Such
	  errors normally don't occur, but can happen with a disk is full.

	  Fix a typo.

2004-01-11 13:33  castaglia

	* NEWS, contrib/mod_sql_mysql.c:
	  Bug#2307 - MySQL 4.1.1 API change causes mod_sql_mysql
	  compilation failure.

2004-01-08 20:41  castaglia

	* src/pool.c:
	  The logic for handling new_block()'s exact argument was
	  accidentally inverted.

2004-01-08 20:23  castaglia

	* include/pool.h, src/pool.c:
	  Be consistent with the argument data types.  These probably
	  should be size_ts, but ints suffice.

2004-01-08 20:15  castaglia

	* include/pool.h, src/pool.c:
	  Adding some new functions to the Pool API.  These new functions
	  allow for pools to be allocated for a specific size, rather than
	  always having the requested size be rounded up to the nearest
	  BLOCK_MINFREE (usu. 512 bytes).  These will be handy in cases
	  where pools smaller than 512 bytes can be used (e.g. stash
	  pools).

2004-01-02 07:27  jwm

	* NEWS:
	  - Bug 2267 - Broken IP subnet matching. Added new ACL
	  parsing/matching code.

2003-12-30 15:17  castaglia

	* contrib/mod_sql.c:
	  Make mod_sql a little less noisy.  This "no SQLAuthTypes" message
	  would be logged for every connection to a vhost that has not been
	  configured for mod_sql (when mod_sql is present), which can be
	  very annoying for those configurations where only some vhosts,
	  not all, need to authenticate using SQL.

2003-12-30 14:56  castaglia

	* src/main.c:
	  Style.

2003-12-26 07:59  jwm

	* NEWS, Makefile.in: Bug 2305 - Compile Problems since > 1.2.9 Link
	  ftpdctl against libsocket and libnsl to pick up dependency
	  functions

2003-12-19 13:29  castaglia

	* contrib/mod_quotatab.c:
	  Don't subtract xfer bytes when deleting a directory.	Found and
	  fixed by Christian Schulte <cs@schulte.it>

2003-12-16 09:43  castaglia

	* NEWS, src/netio.c:
	  Bug#2300 - poll() returns 1 and read returns 0, inifinite loop.

2003-12-14 14:09  jwm

	* contrib/dist/rpm/proftpd.spec:
	  [Bug 2301] New: (s)rpms should require "/sbin/chkconfig" instead
	  of package "chkconfig"

2003-12-11 12:30  castaglia

	* contrib/mod_quotatab.h:
	  Bump the mod_quotatab version, for clarity.

2003-12-11 00:04  castaglia

	* modules/mod_auth.c:
	  Forgot to add strerror() to the DefaultRoot resolution debugging.

2003-12-10 23:59  castaglia

	* modules/mod_auth.c:
	  Add some debugging to the function which determines the actual
	  path to use for DefaultRoot.

2003-12-09 12:08  castaglia

	* contrib/mod_quotatab.c:
	  More minor quotatab bugs fixed by Christian Schulte
	  <cs@schulte.it>.

2003-12-09 11:57  castaglia

	* contrib/mod_quotatab_sql.c:
	  Bug found by Christian Schulte <cs@schulte.it>: delta values are
	  signed, and can be negative.

2003-12-02 23:43  castaglia

	* contrib/: ftpquota.html, mod_quotatab.html,
	  mod_quotatab_file.html, mod_quotatab_ldap.html,
	  mod_quotatab_sql.html:
	  Updating mod_quotatab docs to reflect the fact that the current
	  versions will now always be found in the source distribution,
	  rather than on castaglia.org/proftpd.

2003-12-02 23:39  castaglia

	* NEWS, contrib/ftpquota, contrib/ftpquota.html,
	  contrib/mod_quotatab.c, contrib/mod_quotatab.h,
	  contrib/mod_quotatab.html, contrib/mod_quotatab_file.c,
	  contrib/mod_quotatab_file.html, contrib/mod_quotatab_ldap.c,
	  contrib/mod_quotatab_ldap.html, contrib/mod_quotatab_sql.c,
	  contrib/mod_quotatab_sql.html:
	  Adding mod_quotatab to the contrib area.

2003-12-02 16:16  castaglia

	* NEWS, src/netaddr.c:
	  Bug#2288 - ServerFQDN set to 255.255.255.255 and not hostname.
	  This was due to the bundled inet_ntop() implementation not
	  correctly handling the INADDR_NONE return value.

2003-12-01 19:06  castaglia

	* modules/mod_core.c:
	  Adjust mod_core.c to use the pr_* wrappers for gmtime(),
	  localtime().

2003-12-01 18:54  castaglia

	* NEWS, include/support.h, modules/mod_ls.c, src/support.c:
	  Bug#2290 - gmtime() static storage may be overwritten by modules.
	  A portable solution is to use wrappers that memcpy() the
	  gmtime() and localtime() results.

2003-11-19 12:57  castaglia

	* include/inet.h, include/netaddr.h, src/inet.c, src/netaddr.c:
	  Moving the declaration and definition of pr_get{addr,name}info,
	  pr_freeadrinfo, pr_inet_{ntop,pton} from inet to netaddr, as
	  netaddr is the file that uses those functions most.  Also, it
	  solves some linking problems on older systems that do not have
	  the get{addr,name}info(2) functions.

2003-11-19 12:13  castaglia

	* NEWS, Makefile.in:
	  Bug#1635 - Older systems' chown(1) does not support -h option.

2003-11-17 10:58  castaglia

	* src/netaddr.c:
	  Adding comments to clarify the purpose/usage of the
	  get_v4inaddr() function.

2003-11-15 17:32  castaglia

	* src/netacl.c:
	  Forgot to change this function name.

2003-11-15 17:25  castaglia

	* src/netacl.c:
	  Typo.

2003-11-15 16:55  castaglia

	* include/netacl.h, src/dirtree.c, src/netacl.c:
	  Making the ACL type publically available via an accessor.

2003-11-15 16:49  castaglia

	* contrib/: mod_ctrls_admin.c, mod_ctrls_admin.html:
	  Split the 'debug config|memory' stuff into a new control action,
	  'dump'.  In the future, the 'dump' action will also support
	  dumping of <Class> and <Directory> information.

2003-11-15 15:49  castaglia

	* Make.rules.in, include/conf.h, include/dirtree.h,
	  include/netacl.h, include/netaddr.h, modules/mod_core.c,
	  src/dirtree.c, src/netacl.c, src/netaddr.c:
	  Adding new ACL parsing/matching code.  This is flexible enough to
	  handle IPv6 addresses, and will be used in the new <Class>
	  definition code (coming soon).  This should also fix the ACL
	  checking that was broken (Bug#2267) in 1.2.9's IPv6 changes.

2003-11-15 12:41  castaglia

	* modules/mod_core.c:
	  Need to set the ServerAddress field of the main_server as well
	  when handling the DefaultAddress directive, because
	  fixup_servers() later checks that field.

2003-11-15 12:30  castaglia

	* src/dirtree.c:
	  Bad grammar.

2003-11-15 12:27  castaglia

	* NEWS, src/dirtree.c:
	  Bug#2048 - Add ability to get configuration file values from
	  environment.

2003-11-15 11:52  castaglia

	* NEWS, include/dirtree.h, src/dirtree.c:
	  Bug#2274 - Default server only binds to one IP address of host if
	  --enable-ipv6 is used.

2003-11-15 11:43  castaglia

	* modules/mod_core.c:
	  Handle IPv4 address Binds properly for DefaultAddress when IPv6
	  is in use.

2003-11-14 18:31  castaglia

	* configure:
	  Updating configure.

2003-11-14 18:27  castaglia

	* configure.in:
	  When checking for the security and sec libs on Tru64 Unix, we
	  need to check for the libs before checking for the functions via
	  AC_CHECK_FUNC, not after.

2003-11-12 23:25  castaglia

	* src/netaddr.c:
	  Should be using pcalloc() not palloc().

2003-11-12 11:14  castaglia

	* contrib/: mod_ctrls_admin.c, mod_ctrls_admin.html:
	  Use '#' as the address/port delimiter, rather than '/'.

2003-11-12 08:20  castaglia

	* NEWS, src/inet.c:
	  Updating code for Mac OS X 10.3 (Darwin 7).

2003-11-10 13:38  castaglia

	* configure:
	  Updating configure.

2003-11-10 13:33  castaglia

	* config.h.in, configure.in:
	  Add a check for the getenv(3) function.

2003-11-09 19:56  castaglia

	* contrib/mod_ctrls_admin.html:
	  Document the 'config' option to the 'debug' action.

2003-11-09 19:55  castaglia

	* contrib/mod_ctrls_admin.c, include/dirtree.h, src/dirtree.c:
	  Rearrange the config-dumping code a little and provide a public
	  function for it, so that mod_ctrls_admin can support a 'debug
	  config' action.

2003-11-09 19:52  castaglia

	* src/pool.c:
	  Better name for this printf-like function pointer variable.

2003-11-09 19:14  castaglia

	* configure:
	  Updating configure.

2003-11-09 19:10  castaglia

	* configure.in:
	  Some systems (e.g. FreeBSD) declare getaddrinfo(2) in
	  <sys/socket.h>.

2003-11-09 16:51  castaglia

	* contrib/mod_ctrls_admin.c:
	  Update mod_ctrls_admin to use events.

2003-11-09 16:01  castaglia

	* contrib/: mod_ctrls_admin.c, mod_ctrls_admin.html:
	  Controls are useless without something implementing some control
	  actions; add the mod_ctrls_admin module (was mod_ctrls_common) to
	  contrib.

2003-11-09 15:32  castaglia

	* src/: auth.c, ctrls.c, data.c, dirtree.c, event.c, fsio.c,
	  ident.c, log.c, main.c, mkhome.c, netaddr.c, scoreboard.c,
	  support.c:
	  Updating the source code to use pr_log_debug() rather than
	  log_debug().

2003-11-09 15:10  castaglia

	* modules/: mod_auth.c, mod_auth_file.c, mod_cap.c, mod_core.c,
	  mod_ctrls.c, mod_log.c, mod_ls.c, mod_site.c, mod_xfer.c:
	  Updating modules to use pr_log_debug() rather than log_debug().

2003-11-09 14:59  castaglia

	* include/privs.h:
	  Use pr_log_debug() rather than log_debug().

2003-11-09 14:54  castaglia

	* doc/mod_sample.c:
	  Updating the sample module mod_sample.c to use pr_log_*() rather
	  than log_*().

2003-11-09 14:51  castaglia

	* modules/mod_core.c:
	  unsetenv(3) returns void, not int.

2003-11-09 14:48  castaglia

	* src/main.c:
	  Typo.

2003-11-09 14:43  castaglia

	* src/main.c:
	  Forgot to cleanup one sig_debug() reference.

2003-11-09 14:40  castaglia

	* include/proftpd.h, src/main.c:
	  Tweak the handling of SIGUSR2 a little.  If controls are not
	  enabled, keep the current behavior: the proftpd process will
	  print a memory dump.	If controls are enabled, generate a
	  "core.signal.USR2" event, which will allow modules to register
	  multiple handlers for this same event.  This way,
	  mod_ctrls_common can use SIGUSR2 to get other proftpd processes
	  to print memory dumps, and thus keeping the ability to get memory
	  dumps from any proftpd process.  Without this change, if controls
	  are enabled, we can only get a memory dump of the daemon process
	  (and most of the time, it is the session processes in which we
	  are interested).

2003-11-09 14:19  castaglia

	* Make.rules.in, include/conf.h, include/log.h, include/support.h,
	  include/xferlog.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_xfer.c, src/log.c, src/main.c, src/support.c,
	  src/xferlog.c:
	  Splitting the TransferLog routines into their own source file,
	  and moving the functions into a nonpublic xferlog_ namespace.

2003-11-09 13:35  castaglia

	* contrib/mod_ldap.c:
	  Updating mod_ldap.c to use pr_log_*() rather than log_*().

2003-11-09 13:29  castaglia

	* contrib/mod_ratio.c:
	  Updating mod_ratio.c to use pr_log_*() rather than log_*().

2003-11-09 13:28  castaglia

	* contrib/mod_wrap.c:
	  Updating mod_wrap.c to use pr_log_*() rather than log_*().

2003-11-09 13:26  castaglia

	* contrib/mod_tls.c:
	  Updating mod_tls.c to use pr_log_*() rather than log_*().

2003-11-09 13:25  castaglia

	* contrib/mod_sql_postgres.c:
	  Updating mod_sql_postgres to use pr_log_*() rather than log_*().

2003-11-09 13:24  castaglia

	* modules/mod_core.c, src/main.c:
	  The function is now pr_log_setdebuglevel(), not
	  log_setdebuglevel().

2003-11-09 13:23  castaglia

	* contrib/mod_sql_mysql.c:
	  Updating mod_sql_mysql.c to use pr_log_*() rather than log_*().

2003-11-09 13:22  castaglia

	* contrib/mod_sql.c:
	  Updating mod_sql.c to use pr_log_*() rather than log_*().

2003-11-09 13:20  castaglia

	* contrib/mod_rewrite.c:
	  Updating mod_rewrite.c to use pr_log_*() rather than log_*().

2003-11-09 13:19  castaglia

	* contrib/mod_readme.c:
	  Updating mod_readme to use pr_log_debug() rather than
	  log_debug().

2003-11-09 13:18  castaglia

	* contrib/mod_radius.c:
	  Updating mod_radius.c to use pr_log_pri() rather than log_pri().

2003-11-09 13:16  castaglia

	* contrib/mod_ifsession.c:
	  Updating mod_ifsession to use pr_log_debug() rather than
	  log_debug().

2003-11-09 13:11  castaglia

	* include/privs.h:
	  Updating privs.h to use the pr_log_* functions.  Also cleans up
	  some cruft related to checking of when session.login_uid is set.

2003-11-09 13:09  castaglia

	* include/bindings.h, include/log.h, lib/pwgrent.c,
	  modules/mod_auth.c, modules/mod_auth_file.c,
	  modules/mod_auth_pam.c, modules/mod_auth_unix.c,
	  modules/mod_cap.c, modules/mod_core.c, modules/mod_ctrls.c,
	  modules/mod_log.c, modules/mod_ls.c, modules/mod_xfer.c,
	  src/auth.c, src/bindings.c, src/ctrls.c, src/data.c,
	  src/dirtree.c, src/fsio.c, src/inet.c, src/log.c, src/main.c,
	  src/mkhome.c, src/modules.c, src/netaddr.c, src/pool.c,
	  src/regexp.c, src/scoreboard.c, src/support.c:
	  Moving the log_*() functions into the pr_ namespace.	Let the
	  terror and madness begin!  Actually, log.h includes some
	  transitional macros, so that the old symbols will be redefined
	  properly.

2003-11-09 11:53  castaglia

	* NEWS:
	  Note the affect of the logging class change for RNFR and RNTO.

2003-11-09 09:08  castaglia

	* src/ftpdctl.8.in:
	  Still not quite right.  Trying to get the action-parameters to be
	  properly shown as optional parameters to the action part of the
	  command.

2003-11-09 09:04  castaglia

	* src/ftpdctl.8.in:
	  Tweak the ftpdctl man page a little.

2003-11-09 00:02  castaglia

	* configure:
	  Updating configure.

2003-11-09 00:00  castaglia

	* Makefile.in, configure.in, src/ftpdctl.8.in:
	  Adding ftpdctl man page.

2003-11-08 23:47  castaglia

	* src/ctrls.c:
	  Tag pools allocated in the Controls API.  Style cleanup.

2003-11-08 21:38  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2046 - Change RFNR and RNTO logging class to WRITE.

2003-11-08 21:15  castaglia

	* contrib/mod_wrap.c:
	  Wrong function name.

2003-11-08 21:11  castaglia

	* modules/: mod_auth.c, mod_core.c, mod_xfer.c:
	  Updating the rest of the core code to use the newer Expressions
	  API.

2003-11-08 21:03  castaglia

	* contrib/mod_wrap.c:
	  Updating mod_wrap for the newer Expressions API.

2003-11-08 20:53  castaglia

	* contrib/mod_ifsession.c:
	  Updating mod_ifsession to use the new Expressions API.  Fixed a
	  compiler warning issued under --enable-devel.

2003-11-08 20:46  castaglia

	* include/dirtree.h, src/dirtree.c:
	  Cleaning up the API for evaluating user, group, and class
	  expressions.	This commit gives the API a consistent pr_expr_
	  prefix.  It also provides some transitional macros.

2003-11-08 20:43  castaglia

	* configure:
	  Updating configure.

2003-11-08 19:41  castaglia

	* contrib/mod_ifsession.c:
	  Adjust mod_ifsession to use the same expression indicator values
	  as the core code.

2003-11-08 19:37  castaglia

	* NEWS, include/dirtree.h, modules/mod_core.c, src/dirtree.c:
	  Bug#2015 - Add AND, OR keywords to Allow/DenyUser directives.
	  This affects the AllowGroup and DenyGroup directives as well.

2003-11-08 18:34  castaglia

	* modules/mod_ctrls.c:
	  Register a handler for the "core.exit" event, rather than using
	  pr_exit_register_handler().  The latter function will be being
	  phased out.

2003-11-08 18:29  castaglia

	* modules/mod_auth.c:
	  Generate events when the MaxClients* and MaxHostsPerUser limits
	  are hit.

2003-11-08 18:17  castaglia

	* include/event.h, src/event.c, src/main.c:
	  Add generation of "core.exit" event.	Adjust the event
	  unregistration function to handle the needs of the core code when
	  doing exit handler processing.

2003-11-08 18:08  castaglia

	* modules/mod_ctrls.c:
	  Modify mod_ctrls to use the new Event API (as all new modules
	  should).

2003-11-08 17:55  castaglia

	* Make.rules.in, Makefile.in, NEWS, config.h.in, configure.in,
	  include/bindings.h, include/conf.h, include/ctrls.h,
	  include/mod_ctrls.h, include/pool.h, modules/mod_ctrls.c,
	  src/Makefile.in, src/bindings.c, src/ctrls.c, src/ftpdctl.c,
	  src/main.c, src/modules.c, src/pool.c:
	  Bug#2072 - Add Controls API.	Still to be done: a man page for
	  ftpdctl, better documentation for mod_ctrls.

2003-11-08 16:52  castaglia

	* src/bindings.c:
	  Remove (now) unused variable.

2003-11-08 15:34  castaglia

	* NEWS, modules/mod_core.c, src/bindings.c:
	  Bug#2272 - Address/port collision check needs to handle
	  DefaultAddress. The problem was that the address assigned by
	  DefaultAddress was being assigned _after_ the addr/port collision
	  check.

2003-11-08 14:45  castaglia

	* include/fsio.h, src/fsio.c:
	  Cleanup the FSIO API a little:

	    + some of the directory operation flags were improperly
	  overloading file
	      operation flags
	    + change the prototype of the open/creat handlers to take a
	  pointer to
	      a pr_fh_t (filehandle) rather than a pointer to a pr_fs_t
	  (filesystem),
	      which allows the open/creat handlers to store file-specific
	  data in
	      the handle (fh->fh_data), which was not possible when using
	  the
	      filesystem pointer.
	    + added a new function, pr_remove_fs(), for removing a
	  filesystem from
	      the map without explicitly destroying that filesystem object
	  (as
	      pr_unregister_fs() will do automatically).
	    + some internal function stylistic renaming, which does not
	  affect any
	      code outside of this file.

2003-11-08 14:34  castaglia

	* modules/mod_auth.c, src/main.c:
	  Using the new Event API, generate some events when key limits are
	  exceeded.  Modules that register handlers for these events can
	  now take appropriate action (such as blacklisting a client that
	  has exceeded the MaxLoginAttempts).

2003-11-08 14:32  castaglia

	* src/event.c:
	  When unregistering an event handler, be sure to honor the module
	  argument, if any.

2003-11-08 14:19  castaglia

	* Make.rules.in, NEWS, include/conf.h, include/event.h,
	  modules/mod_core.c, src/event.c, src/main.c:
	  Adding Event API.

2003-11-08 12:40  castaglia

	* NEWS, contrib/mod_radius.c:
	  Bug#2255 - RADIUS Service-Type should reflect attribute
	  expectations.

2003-11-08 12:30  castaglia

	* configure:
	  Updating configure.

2003-11-08 12:26  castaglia

	* NEWS, configure.in:
	  Bug#2271 - Improper autoconf check for getaddrinfo() on Tru64
	  UNIX 5.1.

2003-11-08 11:40  castaglia

	* Make.rules.in:
	  Bug#2270 - Linkers can be quite picky about the order in which
	  flags appear.

2003-11-05 20:43  castaglia

	* modules/mod_auth_file.c:
	  The new group membership debugging found a bug: mod_auth_file,
	  when scanning an AuthGroupFile, would only add the group name if
	  the ID for the group was different from the user's primary GID.
	  For GID stuff, this is fine; however, for group expressions in
	  proftpd.conf that may rely on those group names, it's a bug.

	  This allows for an interesting situation: assign a user to
	  multiple groups with different names, but the same GID.  Thus you
	  can workaround the NGROUPS_MAX system limit using a long list of
	  group names; the operating system won't notice, and proftpd will
	  happily check the names.  Nice.

2003-11-05 20:35  castaglia

	* src/auth.c:
	  Add debugging output for group name/ID retrieval.

2003-11-05 18:53  castaglia

	* src/auth.c:
	  Add debugging that shows the group IDs that end up being set via
	  setgroups().

2003-11-05 16:13  castaglia

	* configure:
	  Updating configure.

2003-11-05 16:10  castaglia

	* config.h.in, configure.in, modules/mod_core.c:
	  Some platforms don't have setenv()/unsetenv().  Bummer.

2003-11-04 12:44  castaglia

	* src/scoreboard.c:
	  When deleting the scoreboard file (usu. when a standalone proftpd
	  starts up), log a message if there is an existing scoreboard file
	  that is being unlinked.

2003-11-02 16:42  jwm

	* contrib/dist/rpm/proftpd.spec:
	  - Bug 2265 - correct path to mysql headers   Submitted by:
	  ncroiset@vdldiffusion.com (Nicolas Croiset) - note in the
	  %changelog that it isn't updated often - use the CVS	 revision
	  history

2003-11-01 00:25  castaglia

	* contrib/mod_tls.html:
	  Update the mod_tls docs, now that Bug#2135's patch has been
	  committed.

2003-11-01 00:14  castaglia

	* Makefile.in:
	  When preparing a distribution using the 'dist' target, be sure to
	  clean up the .bak files generated by the 'clean' target.

2003-10-31 23:11  castaglia

	* include/pool.h, modules/mod_core.c, modules/mod_log.c,
	  modules/mod_ls.c, src/auth.c, src/bindings.c, src/data.c,
	  src/dirtree.c, src/feat.c, src/fsio.c, src/inet.c, src/log.c,
	  src/main.c, src/modules.c, src/pool.c, src/regexp.c,
	  src/support.c:
	  Introduce a new function, pr_pool_tag().  This function is used
	  to "tag" a given pool with an arbitrary label (given as a string
	  constant).  The pool tags are shown in a pool dump (currently
	  triggered using SIGUSR2).

2003-10-31 16:12  castaglia

	* include/log.h:
	  Add 10 as a debugging level.	I plan to use this level for
	  debugging output about DNS resolution and supplemental group
	  membership issues.

2003-10-31 15:57  castaglia

	* src/dirtree.c:
	  Add to proftpd's debugging verbosity by showing the
	  dispatch/handling of configuration directives to the modules
	  which handle that directive.

2003-10-31 11:50  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2098 - Add SetEnv, UnsetEnv directives.

2003-10-31 11:41  castaglia

	* NEWS, modules/mod_auth_unix.c:
	  Bug#2174 - mod_auth_unix should not act authoritatively.

2003-10-31 11:23  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2086 - Add <Limit> support for PORT, PASV, EPRT, EPSV.

2003-10-31 10:55  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#2135 - Add ability to handle passphrase-protected server
	  keys.

2003-10-31 10:46  castaglia

	* src/: data.c, dirtree.c, fsio.c, main.c, netio.c:
	  Silencing some valgrind complaints.  Style fixups.

2003-10-31 01:14  castaglia

	* include/version.h:
	  Woohoo! The start of a new release cycle...

2003-10-31 00:22  castaglia

	* ChangeLog:
	  Preparing for 1.2.9 release.

2003-10-31 00:10  castaglia

	* NEWS, include/version.h, contrib/dist/rpm/proftpd.spec:
	  Preparing for the release of 1.2.9.

2003-10-31 00:05  castaglia

	* NEWS:
	  Mention the memory leak fixes.

2003-10-31 00:02  castaglia

	* contrib/mod_sql.c:
	  Always expand %U to the USER name given, not just when
	  session.user is NULL.

2003-10-30 23:22  castaglia

	* modules/mod_auth.c:
	  Undoing part of change made earlier: rather than removing a
	  C_USER config_rec during both the LOG_CMD (success) and
	  LOG_CMD_ERR (failure) command phases of the PASS command, only do
	  the removal in LOG_CMD_ERR, which was the originally intended
	  effect.  Doing the removal in the LOG_CMD handler causes trouble
	  for modules that may want to use %U (e.g. mod_rewrite).

2003-10-30 12:38  flyhmstr

	* doc/: Configuration.html, Configuration.sgml, faq.html:
	  ML: New userguide (html & sgml) and faq built from current pdd
	  sources     committed.

2003-10-28 10:41  castaglia

	* README.FreeBSD:
	  Adding FreeBSD package installation docs from Bug#2250.

2003-10-22 00:40  castaglia

	* src/main.c:
	  Removing duplicate sanity check.

2003-10-21 23:49  castaglia

	* src/fsio.c:
	  Fixing comments.  Have pr_insert_fs() set errno on error, for
	  reporting purposes.

2003-10-20 18:44  castaglia

	* utils/utils.h:
	  It helps to make sure that the utils (ftpcount, ftpwho, ftptop)
	  expect that the scoreboard entry has the same format as the core
	  code (cf. size of the sce_client_addr field).

2003-10-20 15:20  castaglia

	* include/scoreboard.h:
	  Forgot to increase the size of the IP address buffer in the
	  scoreboard if --enable-ipv6 is used.

2003-10-20 00:28  castaglia

	* modules/mod_log.c:
	  More paranoid checking of snprintf() usage.

2003-10-20 00:15  castaglia

	* contrib/: mod_radius.c, mod_sql.c, mod_tls.c:
	  Minor paranoia changes: make certain the buffer is NUL-terminated
	  before calling strlen() on its contents.

2003-10-20 00:02  castaglia

	* NEWS, modules/mod_ls.c:
	  Check for excessive length of symlink directory listing entries,
	  when ShowSymlinks is on.  This also requires that the platform
	  _not_ provide MAXPATHLEN.  Added some style/spacing changes as
	  well.

2003-10-19 14:45  jwm

	* NEWS, contrib/dist/rpm/proftpd.spec:
	  Bug 2197 - The RPM .spec has been updated for easy RPM builds
	  from CVS snapshots.

2003-10-19 14:40  jwm

	* contrib/dist/rpm/proftpd.spec: rpm doesn't like empty
	  BuildPreReqs, add a static dep on pam-devel

2003-10-18 16:48  castaglia

	* src/fsio.c:
	  Fixing a memory leak in the handling of structures used for
	  tracking open directories.

2003-10-18 15:14  castaglia

	* src/dirtree.c:
	  Fixing a rather major memory pool leak.  A temporary pool was
	  being allocated in dir_hide_file() (which is called rather
	  often), but in the case where no HideFiles directive was
	  configured (very common), that pool was not being destroyed.
	  Oops.

2003-10-17 08:39  castaglia

	* NEWS, include/netaddr.h, modules/mod_core.c, modules/mod_log.c,
	  src/netaddr.c:
	  Bug#2204 - More reverse DNS resolutions problems.  A previous fix
	  for systems that use gethostbyname2() (e.g. the BSDs, some Linux
	  distributions) was not properly checking the return value from
	  pr_netaddr_is_v4mapped(), and thus IPv4 addresses were not being
	  resolved to their names.

	  Bug#2242 - Parsing during rehashing was failing with an EPERM.
	  The problem was that configuration directive handlers
	  (specifically, SyslogFacility and SystemLog) were using
	  PRIVS_RELINQUISH, which caused later Includes to fail.
	  Configuration handlers should not use the PRIVS macros.

2003-10-17 06:19  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2181: fixing this bug (again) to work correctly in all cases.

2003-10-16 23:15  castaglia

	* include/fsio.h, include/inet.h, include/netio.h, src/fsio.c,
	  src/inet.c, src/main.c, src/netio.c:
	  Removing the pr_ prefix from some API initialization functions;
	  they are not really appropriate for module use.

2003-10-15 17:58  castaglia

	* include/version.h:
	  Updating the version for CVS status.

2003-10-15 12:54  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2003-10-15 12:53  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for release of 1.2.9rc3.

2003-10-15 07:15  jwm

	* contrib/dist/rpm/proftpd.spec:
	  only include xinetd support in the -xinetd RPM

2003-10-14 11:22  castaglia

	* src/netaddr.c:
	  Fixed pr_netaddr_get_dnsstr() to use the right family value when
	  calling gethostbyname2().

2003-10-14 11:17  castaglia

	* src/main.c:
	  The free_proc_title() function is currently only used when
	  --enable-devel has been configured.

2003-10-14 06:41  jwm

	* contrib/dist/rpm/proftpd.spec:
	  we're "The ProFTPD Project"

2003-10-13 00:27  castaglia

	* configure:
	  Updating configure.

2003-10-13 00:25  castaglia

	* configure.in, include/libsupp.h, lib/glibc-hstrerror.c:
	  Adding bundled glibc implementation of hsterror(), for those
	  systems that don't have it already.

2003-10-13 00:15  castaglia

	* configure:
	  Updating configure.

2003-10-13 00:12  castaglia

	* config.h.in, configure.in:
	  Not all systems have the hsterror() function, for converting
	  resolver error codes (h_errno) to strings.  Thus, we need to
	  check for it, and provide a bundled replacement if it is not
	  present.  I'll be adding the glibc implementation of hstrerror()
	  soon.

2003-10-12 22:02  castaglia

	* src/netaddr.c:
	  This get_v4inaddr() function is only called from one place (at
	  present), and all the necessary sanity checks have already been
	  performed, so there is no need to do them again.

2003-10-11 12:32  castaglia

	* src/netaddr.c:
	  Typo.

2003-10-11 12:29  castaglia

	* src/netaddr.c:
	  The retrieval of the IPv4 portion of an IPv4-mapped IPv6 address
	  is only necessary when gethostbyname2() is being used, rather
	  than gethostbyname() (I think...this may need to change in the
	  future).

2003-10-11 12:27  castaglia

	* src/netaddr.c:
	  When performing reverse DNS lookups on IPv4-mapped IPv6
	  addresses, we need to be a little more careful about which checks
	  are performed.  This change alters the call to gethostbyname2()
	  (when it is present) to be AF_INET if the netaddr is an
	  IPv4-mapped IPv6 address, rather than using AF_INET6 as was done
	  previously.  The subsequent memcmps need to be adjusted
	  accordingly.	This should hopefully resolve Bug#2204.

2003-10-11 10:01  castaglia

	* src/netaddr.c:
	  The BSDs are not the only systems that might provide
	  gethostbyname2().  It seems that some Linux kernels have been
	  patched to have that function as well.

2003-10-11 09:57  castaglia

	* include/netaddr.h, modules/mod_core.c, src/netaddr.c:
	  Since pr_netaddr_v4mappedv6() returns TRUE or FALSE (or -1 on
	  error), I've renamed it to be pr_netaddr_is_v4mappedv6().

2003-10-10 11:11  castaglia

	* src/main.c:
	  Report the cause of error if configuration parsing fails.

2003-10-10 09:07  castaglia

	* modules/mod_core.c:
	  If processing an Included file fails, log the reason.

2003-10-09 23:36  castaglia

	* src/netaddr.c:
	  Adding note about a use of gethostbyname() that may need to be
	  gethostbyname2() in the future.

2003-10-09 22:49  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2222 - Overlapping vhosts should warn instead of die.

2003-10-09 22:45  castaglia

	* src/dirtree.c:
	  No need to keep the server_recs of vhosts that cannot be
	  resolved.

2003-10-09 22:37  castaglia

	* include/netaddr.h, src/dirtree.c, src/netaddr.c:
	  Removing the pr_netaddr_get_fqdn() function.	It was only being
	  used in one place: to set the main_server->ServerFQDN member.
	  ServerFQDN is used in the logging prefix, and for vhosts, was
	  usually the IP address.  With this change, the log prefix for
	  entries generated by vhosts will be their DNS names (if
	  possible).  It also removes a call to gethostbyname() which on
	  *BSDs might not have performed as expected for IPv6 strings.

2003-10-09 18:30  castaglia

	* src/netaddr.c:
	  Make the logging of badly configured DNS name/IP address mappings
	  a little less noisy.

2003-10-09 12:44  castaglia

	* configure:
	  Updating configure.

2003-10-09 12:40  castaglia

	* NEWS, config.h.in, configure.in, src/netaddr.c:
	  Bug#2204 - Reverse DNS lookups not happening properly on
	  connected clients on FreeBSD.  We need to use gethostbyname2() on
	  FreeBSD (and possibly the other BSDs).

2003-10-09 12:34  castaglia

	* NEWS, configure.in, src/netaddr.c:
	  Bug#2188 - Wildcard sockets not properly handled on FreeBSD.
	  Need to set sin_len/sin6_len struct sockaddr members, if present,
	  for wildcard sockets.

2003-10-08 11:13  castaglia

	* NEWS, src/log.c:
	  Bug#2202 - AllowLogSymlinks check is flawed.

2003-10-07 22:38  castaglia

	* modules/mod_core.c:
	  Style cleanup (whitespace).

2003-10-07 21:48  castaglia

	* src/inet.c:
	  Adding note to pr_inet_set_proto_opts() about setsockopt()
	  problems on IPv6 sockets.

2003-10-07 20:28  castaglia

	* configure:
	  Updating configure.

2003-10-07 20:25  castaglia

	* configure.in:
	  autoconf on FreeBSD was not properly reporting the headers it
	  detected (or didn't): specifically, <netinet/in_systm.h> and
	  <netinet/ip.h> were not being reported as found and useable in
	  config.h.  The fix is to include a few more header dependencies
	  in autoconf, so that autoconf's tests pass and the headers are
	  properly reported as found.

2003-10-06 00:16  castaglia

	* contrib/mod_tls.c:
	  Be a little more careful in tls_blinding_on(): it's possible that
	  SSL_get_privatekey() returns NULL, which I didn't check for.
	  This, I think, is causing segfaults on some systems (depending on
	  the certificates used).

2003-10-05 20:53  castaglia

	* include/netaddr.h, src/data.c, src/main.c, src/netaddr.c:
	  Change pr_netaddr_reverse_dns() to be
	  pr_netaddr_set_reverse_dns(), so that it has a verb in the
	  function name (style nit, I know).  Also includes some
	  capitalization and spacing cleanup in data.c.

2003-10-05 20:14  castaglia

	* NEWS:
	  Updating NEWS so that people can see that Bug#2183 (and all its
	  friends) has been fixed.

2003-10-03 10:44  castaglia

	* Makefile.in:
	  Remove the generated 'stamp-h' file as well for the distclean
	  target.

2003-10-01 07:21  castaglia

	* NEWS, contrib/mod_sql_mysql.c:
	  Bug#2191 - Segfault in mod_sql_mysql when using 'Backend'
	  SQLAuthType.	This only happens for MySQL 4.1.  The MySQL
	  make_scrambled_password() function changed in 4.1, and the wrong
	  variable value was being used.

2003-10-01 06:16  castaglia

	* configure:
	  Updating configure.

2003-10-01 06:09  castaglia

	* config.h.in, configure.in:
	  Style cleanup in config.h.  Add check for <sys/mman.h> header
	  file (will be needed if/when something wants to use the mmap(2)
	  system call).

2003-09-30 23:35  castaglia

	* src/main.c:
	  Style cleanup, comment correction.  Also removed a double
	  signal(SIGIO) call; first one set a handler for the signal, the
	  second one caused the signal to be ignored.  Weird.

2003-09-30 23:25  castaglia

	* src/main.c:
	  Style cleanup.  Add a comment about needing PRIVS (or not) when
	  disconnecting sessions.

2003-09-29 10:25  castaglia

	* src/bindings.c:
	  Fixed thinko highlighted by Bug#2188.

2003-09-28 21:48  castaglia

	* contrib/mod_tls.html:
	  Don't know what I was thinking.

2003-09-28 21:41  castaglia

	* contrib/mod_tls.html:
	  Grammar fix, adding description.

2003-09-28 17:00  castaglia

	* include/bindings.h, src/bindings.c, src/main.c:
	  The init_bindings() and free_bindings() functions are not
	  suitable for use in modules, and so should not be in the pr_
	  namespace.

2003-09-28 16:56  castaglia

	* modules/mod_auth_unix.c:
	  It's possible for UID/GID lookups to occur outside of a session.
	  When this happens, session.pool is not valid.  Check for and
	  handle this situation.  (This was causing segfaults when I
	  attempt to use mod_ctrls.)

2003-09-28 15:43  castaglia

	* include/regexp.h, src/main.c, src/regexp.c:
	  The regexp init function shouldn't be in the pr_ namespace, as it
	  is not suitable for use in module code.

2003-09-28 13:31  castaglia

	* modules/: mod_auth.c, mod_auth_unix.c:
	  Style cleanup.

2003-09-28 10:04  castaglia

	* src/dirtree.c:
	  One of the changes I made to quell a valgrind warning (something
	  about reading possibly uninitialized memory, probably due to a
	  zero-length path variable in this case) had disastrous side
	  effects on directive lookups.  This highlights that the
	  build_dyn_config() function needs comments and/or to be rewritten
	  entirely.

	  Also includes some style cleanup.

2003-09-27 15:16  castaglia

	* configure:
	  Updating configure.

2003-09-27 15:13  castaglia

	* configure.in, src/main.c:
	  Some of the pedantic memory cleanups added in 1.2.9rc2, after
	  some time spent under valgrind, turn out to affect performance,
	  when a session exits, particularly on busy machines.	So I've
	  made these checks enabled only when proftpd is compiled using the
	  --enable-devel flag.

2003-09-27 13:48  castaglia

	* NEWS, src/bindings.c:
	  Bug#2024 - DefaultServer not functioning properly.  The addition
	  of the Bindings API in 1.2.8rc1 broke the DefaultServer directive
	  in many configurations.  For inetd-run proftpds, all configured
	  <VirtualHost> servers were being treated like they had
	  "DefaultServer on", which meant that the last such configured
	  server would be used, instead of the true DefaultServer.  For
	  both inetd- and standalone-run proftpds, if no exactly matching
	  vhost was found for a client, the localhost server (i.e. the
	  "server config" vhost) would be used before the DefaultServer
	  vhost.  Both problems are fixed by this change.

2003-09-27 11:40  castaglia

	* NEWS, src/data.c:
	  Bug#2200 - Correct segfaults with xlate_ascii_write() on IRIX.
	  Some of the last of the remaining code (whose I understood only
	  partially, such as the session.xfer.buf++ increment) is now
	  removed, as well as a potentially dangerous NUL-termination
	  statement.

2003-09-26 12:02  jwm

	* contrib/dist/rpm/proftpd.spec: Bug 2197 - Spec file enhancements
	  and fixes Submitted by: pb@bieringer.de (Dr. Peter Bieringer)

2003-09-25 23:53  castaglia

	* modules/mod_core.c:
	  Correcting a misleading/outdated comment.

2003-09-23 12:10  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2181 - Active IPv4 ftp doesn't work when using --enable-ipv6.
	  The fix was to build up an IPv6 netaddr from the PORT argument,
	  rather than an IPv4 netaddr, in the case of --enable-ipv6.

2003-09-23 08:19  castaglia

	* NEWS:
	  Mention fixing of ASCII handling exploit.

2003-09-23 08:13  castaglia

	* src/data.c:
	  Fixing remote exploit in ASCII handling, discovered by X-Force at
	  ISS:

	    http://xforce.iss.net/xforce/alerts/id/154

2003-09-23 07:45  jwm

	* contrib/dist/rpm/proftpd.spec: * Tue Sep 23 2003 Daniel Roesen
	  <dr@proftpd.org> - Added "--with ipv6" to enable IPv6 support
	  while building the RPM

2003-09-22 16:36  castaglia

	* README.IPv6:
	  Daniel has confirmed that IPv6 and FTP over SSL/TLS works just
	  fine, for both active and passive transfers.

2003-09-19 13:21  castaglia

	* NEWS, include/privs.h:
	  Bug#2179 - ROOT_UID instead of ROOT_GID used in setegid() call.
	  This affects Cygwin installations.

2003-09-18 12:21  castaglia

	* src/netaddr.c:
	  Using EPERM makes more sense, I think, than EACCES in most of the
	  pr_netaddr* cases.

2003-09-18 12:08  castaglia

	* NEWS, src/netaddr.c:
	  Bug#2176 - getnameinfo() error on Cygwin during startup.  The
	  sa_family member of some addresses was not being properly
	  initialized in some instances.

2003-09-14 13:49  castaglia

	* contrib/mod_wrap.html:
	  Typo.

2003-09-14 11:27  castaglia

	* src/scoreboard.c:
	  Actually check for error return values when locking the
	  scoreboard.  A recently reported issue with the scoreboard on
	  Solaris, under high load, may be related to this: fcntl() on
	  Solaris is known to return ENOLCK under high load, if the
	  requested lock hits the system lock limit.  By checking for the
	  return values, proftpd can at least log if this ENOLCK is indeed
	  the case.

2003-09-13 16:34  castaglia

	* configure:
	  Updating configure.

2003-09-13 16:29  castaglia

	* NEWS, README.IPv6, config.h.in, configure.in, src/netaddr.c:
	  Bug#2167 - getnameinfo() on FreeBSD doesn't support IP address
	  lookups.

	  FreeBSD's struct sockaddr_in and struct sockaddr_in6 have the
	  sin_len and sin6_len members.  The code in pr_netaddr_get_addr()
	  was not properly initializing these members, and so when those
	  structs were given to getnameinfo(), getnameinfo() didn't handle
	  them well.  Solaris and Linux don't have these _len members, so
	  the problem didn't crop up there.

	  IPv6 systems whose structs have these _len members are supposed
	  to define the SIN6_LEN symbol, by RFC design.  However, it's
	  possible that a system not support IPv6 and yet have the sin_len
	  member and the getnameinfo() function.  So rather than just rely
	  on SIN6_LEN being present, I added an autoconf check for the
	  sin_len member, and an IPv4 SIN_LEN symbol.

2003-09-12 00:56  castaglia

	* README:
	  Just some pointers/notes about user questions.

2003-09-11 20:01  castaglia

	* README.IPv6:
	  Seems that perhaps FreeBSD's getnameinfo(3) doesn't like IP
	  addresses, but it does handle DNS names correctly.  Interesting.

2003-09-11 13:11  castaglia

	* configure:
	  Updating configure.

2003-09-11 12:58  castaglia

	* configure.in:
	  Add another --enable-devel option: 'profile'.  When this option
	  is used, compiler and linker flags for generating profile output
	  (as for gprof(1)) are generated.  For this to work properly, one
	  also needs to use the 'nodaemon' and 'nofork' options as well,
	  e.g.:

	    ./configure --enable-devel=nodaemon:nofork:profile ...

2003-09-11 12:56  castaglia

	* include/version.h:
	  Updating version for CVS snapshots.

2003-09-11 06:39  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2003-09-11 06:33  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Let's get this rc2 show on the road.

2003-09-10 23:36  castaglia

	* include/conf.h:
	  Add note about possibly using sockaddr_storage in the future.

2003-09-10 07:02  castaglia

	* src/main.c:
	  Fixing PR_DEVEL_NO_DAEMON.

2003-09-09 14:15  castaglia

	* src/log.c:
	  Log the client's IP address in the brackets, not the DNS name.

2003-09-09 14:14  castaglia

	* src/netaddr.c:
	  When doing reverse DNS lookups, actually use the looked up name.
	  Oops.

2003-09-09 07:58  castaglia

	* utils/ftpshut.c:
	  Fix grammar in comment.

2003-09-09 07:57  castaglia

	* NEWS:
	  ftpshut's option -R (for remove), not -D (for delete).

2003-09-09 07:16  castaglia

	* NEWS, src/netio.c:
	  Bug#2122 - EAGAIN on Solaris can cause an infinite loop.

2003-09-08 22:37  castaglia

	* include/netaddr.h, modules/mod_core.c, src/inet.c, src/netaddr.c:

	  Rename pr_netaddr_initialize() to be pr_netaddr_clear(), as that
	  is what is really happening.

2003-09-08 19:49  castaglia

	* src/inet.c:
	  Remove duplicate comment.

2003-09-08 18:07  castaglia

	* src/inet.c:
	  Use the netaddr allocator where appropriate.

2003-09-08 18:04  castaglia

	* src/dirtree.c:
	  Remove cruft.  The multiple addresses for a server are handled
	  elsewhere.

2003-09-08 17:55  castaglia

	* include/netaddr.h, src/netaddr.c:
	  Provide a netaddr allocator.

2003-09-08 17:32  castaglia

	* include/netaddr.h, modules/mod_core.c, src/inet.c, src/netaddr.c:

	  Forgot to properly initialize pr_netaddr_t structs declared on
	  the stack.  Provide a wrapper function for this, in case any of
	  the default settings for a pr_netaddr_t need to change (in which
	  case, providing an allocator as well, for pr_netaddr_t *
	  declarations, will be necessary).

	  Also fixed some tabs that crept into inet.c.

2003-09-07 19:58  castaglia

	* configure:
	  Updating configure.

2003-09-07 19:55  castaglia

	* include/inet.h, modules/mod_core.c, src/inet.c, src/netaddr.c:
	  Bug#2162 - Move pr_inet_ntop definition to include/inet.h.  Code
	  cleanup.

2003-09-07 19:48  castaglia

	* configure.in:
	  Clean up configure.in a little, and just use LIB_OBJS (rather
	  than both pr_lib_objs and LIB_OBJS).

2003-09-07 19:39  castaglia

	* configure:
	  Updating configure.

2003-09-07 19:35  castaglia

	* NEWS, configure.in:
	  Bug#2161 - Duplicate autoconf check for sia.h.

2003-09-07 17:56  castaglia

	* src/main.c:
	  Add a function to free up the memory allocated when moving the
	  environment "out of the way" for use by setproctitle() et al;
	  valgrind was complaining about this lost memory.  Also free up
	  the permanent pool, and the free block list, when the daemon
	  shuts down.

2003-09-07 17:53  castaglia

	* modules/mod_auth_unix.c:
	  Changing permanent_pool to session.pool where appropriate.  Also
	  add a session exit callback that will call endpwent()/endgrent(),
	  freeing up any memory that may have been allocated via
	  setpwent()/setgrent().  Symmetry is a Good Thing.

2003-09-07 17:51  castaglia

	* modules/mod_auth_pam.c:
	  Removed an unnecessary check for a NULL pointer that will be
	  given to free(3): the POSIX standard says that free() can handle
	  a NULL pointer without choking.  Also, since mod_auth_pam handles
	  the password, when the buffer which holds the password is freed,
	  it should be scrubbed, rather than just using memset().

2003-09-07 17:42  castaglia

	* src/main.c:
	  Removing cruft, updating calls to subsystem initializers.

2003-09-07 17:41  castaglia

	* include/dirtree.h, src/dirtree.c:
	  Cleanup.  Fixed some timing and usages of sub pools, particularly
	  in get_dir_ctxt().  Changed permanent_pool to be session.pool
	  where appropriate.  Changed !strcmp() to be strcmp() == 0, and
	  added some checks for paths of zero length (spotted by valgrind).

2003-09-07 17:39  castaglia

	* src/auth.c:
	  Removing cruft.  Also added some comments on the difference
	  between the static make_cmd() function in this file, and the
	  public pr_cmd_alloc() function.

2003-09-07 17:37  castaglia

	* src/fsio.c:
	  Style cleanup, mostly.  Using strcmp() == 0 rather than !strcmp()
	  is a little clearer to most people.  Also fixed a bug where a
	  pool was not being destroyed at the proper time.

2003-09-07 17:36  castaglia

	* src/data.c:
	  Use memcpy() rather than memmove(), as memcpy() is a little more
	  efficient (it doesn't have to check the overlapping buffers).
	  Also, allocate one space for one more character, to account for
	  the possibility of a LF as the first character in the buffer
	  being adjusted (it would then need to be prefaced by a CR).

2003-09-07 17:33  castaglia

	* modules/: mod_auth_file.c, mod_core.c, mod_log.c:
	  Changed uses of permanent_pool to session.pool, as is more
	  appropriate in most module code.

2003-09-07 17:32  castaglia

	* modules/mod_auth.c:
	  Changed some uses of permanent_pool here to be session.pool, as
	  is more appropriate in most module code.

2003-09-07 17:31  castaglia

	* include/modules.h, src/modules.c:
	  Removing cruft.  The call_module_auth() and call_module_cmd()
	  functions were duplicates of call_module(), so there is no need
	  to keep them around.	Also fixed some of the pools being used
	  when adding symbols to the stash.  Fixed a bug where the stash
	  pool was not being properly allocated from permanent_pool
	  (valgrind found this).

2003-09-07 17:29  castaglia

	* include/pool.h, src/pool.c:
	  Cleaning up the pool interface.  The pr_ prefix for initializing
	  the pool code, as many of the subsystem initializers are not
	  meant to be called by module code; the pr_ suffix is meant to
	  denote the API for use by module authors.  Also fixed a possible
	  alarm-blocking bug in destroy_pool().

2003-09-07 17:26  castaglia

	* include/inet.h, src/inet.c:
	  Removing cruft.  The iplist/niplist members of the conn_t struct
	  were not being used anymore.	Also removed some unnecessary
	  complexities (a macro, a cleanup handler).

2003-09-07 17:25  castaglia

	* contrib/mod_ratio.c:
	  Removing some cruft from the source code, which involves removing
	  mod_ratio's use of one of the crufty functions.

2003-09-07 16:55  castaglia

	* modules/mod_cap.c:
	  A weekend with valgrind proved very enlightening.  This patch
	  corrects several small leaks that were occurring when handling
	  POSIX capabilities.

2003-09-07 16:54  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2154 - SQL query loses shell information.

2003-09-06 10:44  castaglia

	* modules/mod_ls.c:
	  Another leak fixed.  In this case, listdir() was
	  (inappropriately) setting pointers in the array--allocated and
	  returned by sreaddir()--to NULL.  Those pointers were allocated
	  using calloc() in sreaddir(), which meant that later, when
	  listdir() went to free the memory, it couldn't -- the address was
	  lost.  All better now.

2003-09-06 09:56  castaglia

	* src/data.c:
	  Fixing subtle off-by-one bug (thank you valgrind!).

2003-09-05 13:00  castaglia

	* src/pool.c:
	  Rename xmalloc, xcalloc, and xrealloc to be smalloc, scalloc, and
	  srealloc ("s" for "safe", just like sstrncpy and sstrcat).  This
	  moves these functions out of the way of dmalloc's symbols (and
	  doesn't hurt proftpd at all).

2003-09-05 12:42  castaglia

	* include/conf.h:
	  Add conditional include for <dmalloc.h>, for use when using
	  dmalloc to track memory usage.

2003-09-05 11:38  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2153 - Small error in handling PR_AUTH_RFC2228 authentication
	  code.

2003-09-03 13:18  castaglia

	* configure:
	  Updating configure.

2003-09-03 13:14  castaglia

	* NEWS, configure.in:
	  Bug#2007 - autoconf header detection problem.

2003-08-30 09:11  castaglia

	* configure:
	  Updating configure.

2003-08-30 09:07  castaglia

	* configure.in, include/libsupp.h, lib/glibc-gai_strerror.c,
	  src/netaddr.c:
	  Partial fix for issues mentioned in Bug#2143: bundling
	  gai_strerror(3) implementation (from glibc) in libsupp.a, to be
	  used if the system does not provide a gai_strerror(3) function
	  itself.

2003-08-29 10:20  castaglia

	* include/bindings.h, include/dirtree.h, src/bindings.c:
	  Add comments about the duplicate
	  ipbind->ib_server->listen/ipbind->ib_listener pointers.  Also,
	  correct the patch for Bug#2146 so that ib_server->listen is still
	  handled properly (as it prior to the patch) in the Bindings API.

2003-08-29 10:01  castaglia

	* NEWS, include/bindings.h, src/bindings.c:
	  Bug#2146 - DNS names not handled properly when --enable-ipv6 is
	  used.  As mentioned in the report, this was caused by a design
	  assumption revealed by the addition of IPv6 support: that of a
	  one-to-one association between a server_rec and its listening
	  connection.  For DNS names resolving to A and AAAA records, there
	  can be two listening connections for a given server_rec.  The fix
	  occurs in the Bindings API, where a server_rec's listeners are
	  now associated with the bindings for the server_rec, rather than
	  with the server_rec itself.  Multiple bindings can point to the
	  same server_rec.

2003-08-28 23:33  castaglia

	* src/netaddr.c:
	  Using uninitialized memory can be bad.

2003-08-28 22:44  castaglia

	* src/inet.c:
	  Only one type of IPv4 service at time: either IPTOS_LOWDELAY or
	  IPTOS_THROUGHPUT but not both.

	  Some discussion on IPng mailing list archives mention that using
	  IP_TOS may be a problem on IPv6 connections...

2003-08-27 20:17  castaglia

	* README.ports:
	  Adding FreeBSD 4.9-PRERELEASE to the list.  Apparently the source
	  works out-of-the-box.

2003-08-27 17:43  jwm

	* NEWS:
	  - Bug 2108 - IgnoreHidden should not hide dotfiles   Dotfiles are
	  now displayed when the -a argument is supplied, even when the
	  IgnoreHidden directive is enabled. To replicate the old behavior
	  of hiding   dotfiles no matter what, use either of the following
	  directives:	  ListOptions "" strict     HideFiles ^\..*

2003-08-27 17:40  jwm

	* modules/mod_ls.c:
	  Bug 2108 - IgnoreHidden should not hide dotfiles

2003-08-27 17:37  jwm

	* NEWS:
	  - Bug 1804 - RPM spec file improvements   The spec file now has
	  xinetd support, builds under newer version of RPM,   installs
	  standalone support with the main proftpd RPM, and accepts --with
	  mod_modname arguments during the build process.  - Bug 2127 -
	  Entry in the file section   The RPM spec's %files section now
	  honors the install prefix.

2003-08-27 17:36  jwm

	* contrib/dist/rpm/proftpd.spec:
	  Bug 2127 - Entry in the file section

2003-08-27 17:33  jwm

	* contrib/dist/rpm/xinetd:
	  add xinetd configuration to go with new .spec

2003-08-27 17:32  jwm

	* contrib/dist/rpm/proftpd.spec:
	  - don't reset servertype on upgrade - don't explicitly install
	  docs - %doc should include them

	  submitted by: Ivan F. Martinez <ivanfm@os2brasil.com.br> Peter
	  Bieringer <pb@bieringer.de>

2003-08-22 10:29  castaglia

	* README.ports:
	  Adding NetBSD 1.6.1 to the list.

2003-08-19 18:57  castaglia

	* README.IPv6:
	  Add note about FreeBSD 4.8 and getnameinfo(3).

2003-08-18 13:13  castaglia

	* NEWS, src/dirtree.c:
	  Bug#2141 - Glob Allow/Deny parameters cause extraneous log
	  messages when comparing addresses.

2003-08-16 10:01  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2148 - Enforce PR_TUNABLE_LOGIN_MAX.

2003-08-16 08:47  castaglia

	* sample-configurations/mod_sql.conf:
	  Add comment in mod_sql sample config about SQLAuthTypes being
	  required.

2003-08-16 08:43  castaglia

	* contrib/mod_sql.c:
	  Add log messages to session init if no SQLAuthTypes configured.

2003-08-16 08:38  castaglia

	* contrib/mod_sql.c:
	  Using mod_sql for authentication, but not configuring a
	  SQLAuthTypes directive, would result in a segfault in the session
	  process.  This patch catches the segfault, and adds a log message
	  concerning the problem.

2003-08-14 18:33  castaglia

	* NEWS, contrib/mod_ifsession.c:
	  Fixed mod_ifsession's handling of multiple configuration sets.
	  The problem was that mod_ifsession, after merging in the
	  configuration from a config_rec, would call xaset_remove() and
	  remove that config_rec from the main server's configuration sets.
	  This had the side effect of making other config_recs in the set,
	  in the set after the removed config_rec, no longer visible by the
	  iterating function.  As in Perl: don't change the items in a list
	  while iterating over it.  Instead, queue up the changes you want
	  to make while iterating, wait until finished iterating, and then
	  change the list.

2003-08-14 11:34  castaglia

	* include/netaddr.h, src/netaddr.c:
	  Rather than using typecasts to silence the compiler warnings
	  about loss of the 'const' modifier in pr_netaddr_fnmatch(),
	  simply remove the 'const' from the function signature.

2003-08-13 18:02  castaglia

	* NEWS, src/data.c:
	  Bug#2147 - Segmentation fault processing file in ASCII mode.

2003-08-13 12:11  castaglia

	* src/netaddr.c:
	  Silence some compiler warnings.

2003-08-13 11:54  castaglia

	* configure:
	  Updating configure script.

2003-08-13 11:50  castaglia

	* NEWS, configure.in:
	  Bug#2144 - Rework autoconf handling of --enable-sia option.

2003-08-13 09:04  castaglia

	* configure:
	  Updating configure script.

2003-08-12 23:26  castaglia

	* config.h.in, configure.in:
	  Check for gai_strerror(3).  We'll also need to provide an
	  implementation if gai_strerror() is not present.

2003-08-12 23:21  castaglia

	* configure:
	  Updating configure script.

2003-08-12 23:07  castaglia

	* NEWS, configure.in, include/libsupp.h, include/support.h,
	  lib/sstrncpy.c, src/support.c:
	  Bug#2142 - sstrncpy() not available to lib/vsnprintf.c.

2003-08-12 22:28  castaglia

	* src/inet.c:
	  It seems the 'sa_family' symbol is a macro on IRIX.

2003-08-12 10:07  castaglia

	* include/: conf.h, inet.h:
	  Move the conditional definitions of INET(6)_ADDRSTRLEN to conf.h,
	  so that the definition of pr_netaddr_t can use them.	Sigh.

2003-08-11 22:59  castaglia

	* include/conf.h:
	  Can't use INET6_ADDRSTRLEN until include/inet.h is included, but
	  the pr_netaddr_t needs to be typedef'd before then.  So we do it
	  manually.

2003-08-10 23:31  castaglia

	* contrib/mod_sql.c:
	  Removing use of get_param_int() from mod_sql.

2003-08-10 23:07  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#2137 - NLST and IgnoreHidden causes segfault.

2003-08-10 21:41  castaglia

	* src/main.c:
	  Oops.  Calling of the postparse callbacks should happen after all
	  the servers have been fixed up, in order to make sure that the
	  modules see the "correct" server configuration data.

2003-08-10 21:37  castaglia

	* src/main.c:
	  Postparse callbacks should be called after the configuration has
	  been parsed during a rehash, too.  Modules that wish to have
	  postparse callbacks invoked during a rehash will need to have
	  rehash handlers that register the postparse callback.

2003-08-09 09:37  castaglia

	* modules/mod_auth.c:
	  Previous changes to auth_scan_scoreboard() removed some checks
	  that really needed to be there, to prevent segfaults when using
	  configurations that did not use Classes.

2003-08-09 09:08  castaglia

	* src/inet.c:
	  Fixed function signature to match declared prototype.  Fixed
	  variable name.

2003-08-09 01:09  castaglia

	* contrib/mod_ifsession.c, include/dirtree.h, modules/mod_auth.c,
	  src/dirtree.c:
	  Spelling correction.

2003-08-09 00:50  castaglia

	* src/bindings.c:
	  Removed debugging cruft.

2003-08-09 00:22  castaglia

	* include/proftpd.h, src/netaddr.c:
	  Comment clarification, style fixups, fixing compiler warnings.

2003-08-08 15:15  castaglia

	* modules/mod_auth_file.c:
	  Fixed position of use of pr_signals() handle, so as not to occur
	  before variable declaration in the case where HAVE_FGETPWENT is
	  false/undef.

2003-08-08 08:10  castaglia

	* NEWS:
	  Fixed wrong bug report number.

2003-08-07 19:50  castaglia

	* include/netaddr.h:
	  Complete the description of pr_netaddr_fnmatch().

2003-08-07 13:16  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2130 - %y in DisplayLogin is not updated correctly.  The
	  problem was that the auth_scan_scoreboard() function, which
	  scanned the scoreboard and tallied up the variables used when
	  filling in %y/%N, was only being called if the DisplayConnect
	  directive was used.  Instead, auth_scan_scoreboard() should
	  always be called, to handle any of the Display* directives.

2003-08-07 11:24  castaglia

	* src/netaddr.c:
	  Added implementation of pr_netaddr_fnmatch().

2003-08-07 11:05  castaglia

	* include/netaddr.h, src/netaddr.c:
	  Added implementation (untested) of pr_netaddr_ncmp().  Changed
	  the pr_netaddr*() routines to return EACCES if for some reason
	  the	netaddrs on which they operate do not have a recognizable
	  family (AF_INET   or AF_INET6).

2003-08-07 08:49  castaglia

	* include/netaddr.h, src/bindings.c, src/netaddr.c:
	  Added a pr_netaddr_get_inaddr_len(), to provide sizes of struct
	  in{6}_addr, matching the pr_netaddr_get_sockaddr_len() function.

	  Added a stub for pr_netaddr_fnmatch(), to be implemented soon.

2003-08-07 00:09  castaglia

	* include/netaddr.h, src/inet.c, src/netaddr.c:
	  Changed pr_netaddr_get_addrlen() to
	  pr_netaddr_get_sockaddr_len(), to more clearly reflect the length
	  returned.

	  Added stub for pr_netaddr_ncmp(), to be implemented shortly.

2003-08-06 18:59  castaglia

	* README.IPv6:
	  Clarifying that IPv6 sockets handling IPv4 packets only occurs
	  when it is an wildcard IPv6 socket.

2003-08-06 17:55  castaglia

	* NEWS:
	  Mention the --enable-ipv6 configure option.

2003-08-06 17:42  castaglia

	* include/netaddr.h:
	  Adding descriptions of the netaddr API functions.

2003-08-06 16:05  castaglia

	* include/inet.h:
	  Add some comments about the handling of get{addr,name}info
	  symbols.  I'm not quite sure I have all the preprocessor logic
	  for these symbols done correctly yet.

2003-08-06 15:31  castaglia

	* src/netaddr.c:
	  Typos.

2003-08-06 15:08  castaglia

	* configure:
	  Updating configure.

2003-08-06 15:03  castaglia

	* ChangeLog, Make.rules.in, NEWS, README.IPv6, config.h.in,
	  configure.in, contrib/mod_ifsession.c, contrib/mod_radius.c,
	  contrib/mod_ratio.c, contrib/mod_rewrite.c, contrib/mod_sql.c,
	  contrib/mod_tls.c, include/bindings.h, include/conf.h,
	  include/dirtree.h, include/ftp.h, include/inet.h, include/log.h,
	  include/netaddr.h, include/proftpd.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_log.c, src/bindings.c,
	  src/data.c, src/dirtree.c, src/ident.c, src/inet.c, src/log.c,
	  src/main.c, src/netaddr.c, src/scoreboard.c, utils/misc.c:
	  Bug#1711 - IPv6 support.  Let the IPv6 fun begin.

2003-08-06 00:07  castaglia

	* modules/mod_auth_file.c:
	  Fix code in case where fgetgrent(3) is not present on the system.

2003-08-01 17:30  castaglia

	* contrib/mod_sql_mysql.c:
	  MySQL-4.1.0 changed the signature for the
	  make_scrambled_password() function, so we handle it by checking
	  the MySQL version.  This commit also includes some style changes.

2003-07-31 18:05  castaglia

	* modules/mod_log.c, modules/mod_ls.c, modules/mod_site.c,
	  src/data.c, src/dirtree.c, src/main.c, src/pool.c, src/support.c:

	  Style.

2003-07-31 18:03  castaglia

	* contrib/mod_radius.c, contrib/mod_rewrite.c, modules/mod_auth.c,
	  modules/mod_auth_file.c, src/netio.c:
	  Adding signal handling in while() loops.

2003-07-30 11:01  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#2118 - %F doesn't work for DELE command; %f is inconsistent.
	  This is exactly the reason why we really need a unified
	  cookie/variable handling interface.  Too much code duplicated
	  around in modules leads to out-of-sync code bugs like this.

2003-07-29 18:52  castaglia

	* contrib/mod_tls.c:
	  Removing unused code.

2003-07-29 18:34  castaglia

	* NEWS, contrib/mod_tls.c:
	  Close files that have been fopen()'d always, not just when
	  conditions mean that no errors are encountered.

2003-07-29 10:46  castaglia

	* contrib/mod_tls.html:
	  Adding description of the $SSL_CERT_DIR TLSLog message

2003-07-29 08:15  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2119 - FEAT response format does not conform to RFC2389.

2003-07-29 07:36  castaglia

	* doc/rfc/: rfc2228.txt, rfc2389.txt, rfc2428.txt:
	  Style.

2003-07-28 15:57  castaglia

	* NEWS:
	  Mention fix of mod_tls directives.

2003-07-28 15:50  castaglia

	* contrib/mod_tls.c:
	  TLSCACertificateFile and TLSCACertificatePath are documented to
	  be allowed in all server contexts, not just "server config"; the
	  code was wrong.

2003-07-24 22:36  castaglia

	* sample-configurations/: anonymous.conf, complex-virtual.conf,
	  mod_sql.conf, virtual.conf:
	  Style.

2003-07-24 18:21  jwm

	* include/pr-syslog.h: silence warning

2003-07-24 08:22  castaglia

	* NEWS, Makefile.in:
	  Bug#2115 - ftptop depends on snprintf but doesn't link in
	  lib/libsupp.a

2003-07-23 19:44  castaglia

	* doc/rfc/rfc2428.txt:
	  IPv6 support _is_ going to be added Real Soon Now(tm), so we
	  might as well as the relevant RFC.

2003-07-21 15:03  castaglia

	* NEWS, README.mod_sql, contrib/mod_sql.c:
	  Bug#2113 - mod_sql default uses mysql keyword.

2003-07-18 12:18  castaglia

	* include/proftpd.h, src/main.c:
	  Add two new members to the session struct: curr_cmd and
	  curr_phase.  These are for storing pointers to the current FTP
	  command name and current command handler phase, respectively.
	  They are useful for places like the FSIO API, where callbacks may
	  want to take conditional action depending on the FTP
	  command/phase at the time.

2003-07-16 11:48  castaglia

	* NEWS, include/dirtree.h, src/dirtree.c, src/main.c:
	  Bug#2110 - Segfault if gethostname(2) returns NULL.  When code
	  was added to simply remove a server_rec whose name could not be
	  resolved from the list, rather than halting the process there
	  (which allows a more Apache-like handling of badly configured
	  vhosts by logging/skipping, rather than choking), an edge case
	  became possible where, after looping through all the server_recs,
	  _none_ remained in the list.	This case was not being handled,
	  and lead to a segfault later in the processing.  This patch
	  checks for the case where no valid server_recs remain in the
	  list.

2003-07-15 23:16  castaglia

	* contrib/mod_sql_mysql.c:
	  Spacing nit.

2003-07-14 19:57  castaglia

	* modules/mod_xfer.c:
	  Cruft.

2003-07-10 18:51  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#2103 - AuthAliasOnly in server context causes hang.

2003-07-10 09:09  jwm

	* contrib/mod_ldap.c:
	  release 2.8.12

2003-07-07 15:59  castaglia

	* contrib/mod_sql_mysql.c:
	  Typo.

2003-07-07 13:42  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Updating module names in comments.

2003-07-07 13:15  castaglia

	* NEWS:
	  Correcting handling of mod_tls TLSCertificateChainFile directive.

2003-07-07 13:13  castaglia

	* contrib/mod_tls.c:
	  Change the semantics of TLSCertificateChainFile slightly.  Now,
	  this directive can be used to explicitly configure the chain of
	  certs given to a peer during the TLS handshake.  Any server
	  certs, configured using either CertificateFile or
	  CertificatePath, are added to the list of CAs allowed for
	  clients, but not for servers.

2003-07-07 11:27  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#2100 - Invalid domain in <VirtualHost> tag causes
	  segmentation fault.

2003-07-03 14:48  castaglia

	* sample-configurations/: anonymous.conf, complex-virtual.conf:
	  Don't forget the X-variants of FTP commands in <Limit> examples.

2003-06-28 10:14  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Add comments about provide proper escapestring implementations.
	  Failure to do so allows SQL injection.

2003-06-27 00:13  castaglia

	* modules/mod_core.c:
	  Be a little more verbose about the exact error cause of
	  log_opensyslog() fails.

2003-06-27 00:10  castaglia

	* lib/pr-syslog.c:
	  Fix some inadvertently inverted #ifdefs.

2003-06-23 18:47  castaglia

	* NEWS, contrib/mod_rewrite.c, include/conf.h:
	  Bug#2090 - mod_rewrite doesn't compile on Solaris 8.

2003-06-23 12:58  castaglia

	* contrib/mod_radius.c:
	  Use USHRT_MAX rather than 65535 (and fix a typo).

2003-06-17 13:54  castaglia

	* contrib/mod_sql_postgres.c:
	  Removing POSTGRES_NO_ESCAPESTRING #define from mod_sql_postgres.
	  See Bug#2087.

2003-06-16 18:25  castaglia

	* configure:
	  Updating configure.

2003-06-16 18:23  castaglia

	* config.h.in, configure.in, include/conf.h:
	  Configure detection/use for <netinet/in_systm.h> header; this
	  fixes compile errors on BSD platforms.  Patch contributed by
	  Daniel Svensson.

2003-06-16 13:22  castaglia

	* NEWS, src/dirtree.c, src/sets.c:
	  Bug#2088: proftpd -t segfault.  The functional change of this
	  patch is using parent_pool, rather than c_pool, in
	  start_sub_config() when allocating a new xaset *.  The rest of
	  the patch is style cleanup.

2003-06-12 16:41  castaglia

	* contrib/mod_tls.html:
	  Minor corrections.

2003-06-12 12:30  castaglia

	* contrib/mod_tls.c:
	  Better handling of too long certificate verification chains.

2003-06-11 19:08  castaglia

	* src/: inet.c, modules.c:
	  Missing $Id: ChangeLog,v 1.145 2010/02/24 17:58:50 castaglia Exp $ keyword.

2003-06-11 15:45  castaglia

	* src/ident.c:
	  Match debug levels with what's in main.c for ident lookups.

2003-06-11 15:44  castaglia

	* src/: ident.c, main.c:
	  Add some debugging routines to the ident lookups.

2003-06-11 13:46  castaglia

	* config.h.in:
	  Missing entry for <netinet/ip.h> header file, checked by
	  configure.

2003-06-09 17:38  castaglia

	* contrib/mod_tls.c:
	  Need to be consistent about names of variables used.

2003-06-09 17:33  castaglia

	* contrib/mod_tls.c:
	  Better handling of possible errors when loading certs from a
	  CertificateChainFile.

2003-06-09 17:20  castaglia

	* contrib/mod_tls.c:
	  Fixed typo that prevent TLSCertificateChainFile from working
	  properly.

2003-06-09 10:25  castaglia

	* NEWS, modules/mod_auth_file.c:
	  Bug#2083 - "550 Access denied" on group permission with
	  AuthGroupFile.

2003-06-05 17:07  castaglia

	* src/main.c:
	  Add debug output (level 6) for use/nonuse of RFC1413 lookups.

2003-06-05 12:34  castaglia

	* modules/: mod_auth.c, mod_core.c:
	  Match variable data types.

2003-06-05 12:28  castaglia

	* NEWS, modules/mod_auth.c:
	  Some inappropriate/ill-timed Class functionality check was
	  preventing %N/%y from being properly counted for DisplayConnect
	  files.

2003-06-04 16:32  castaglia

	* include/options.h:
	  Increase default PR_TUNABLE_LOGIN_MAX size (and don't use
	  _POSIX_LOGIN_NAME_MAX, even if it is defined).  Should fix
	  Bug#2079.

2003-06-04 10:03  castaglia

	* configure:
	  Updating configure.

2003-06-04 09:59  castaglia

	* configure.in, config.h.in:
	  Add autoconf checks for mlock(2), mlockall(2), munlock(2), and
	  munlockall(2).

2003-06-04 07:53  castaglia

	* src/inet.c:
	  Typo in inet_setnonblock() (Bug#2077).

2003-06-03 21:37  castaglia

	* README.mod_sql:
	  Updating example SQL hooks code for current API.

2003-06-03 19:19  castaglia

	* contrib/mod_tls.html:
	  Updating mod_tls installation instructions.

2003-06-03 13:42  castaglia

	* modules/mod_log.c, src/log.c, src/main.c:
	  Changing variable names to avoid pedantic compiler warnings
	  emitted by gcc-3.3.

2003-06-03 09:25  castaglia

	* NEWS, include/conf.h, include/fsio.h, include/options.h,
	  include/proftpd.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_ls.c, modules/mod_xfer.c, src/dirtree.c, src/fsio.c,
	  src/log.c, src/netio.c, src/response.c, src/scoreboard.c,
	  src/support.c, utils/scoreboard.c, utils/utils.h:
	  Bug#2069: Long MKD path causes truncated server response.

2003-06-03 09:17  castaglia

	* src/fsio.c:
	  Change related to Bug#2043: files always need to be opened using
	  the O_BINARY flag on Cygwin, not just for ASCII transfers.

2003-06-03 09:11  castaglia

	* configure:
	  Updating configure.

2003-06-03 09:04  castaglia

	* NEWS, config.h.in, configure.in:
	  Bug#2076 - The --enable-transfer-buffer-size configure option
	  doesn't work properly.

2003-06-02 15:16  castaglia

	* NEWS, src/fsio.c:
	  Bug#2075 - ls / fails under Cygwin.

2003-06-02 09:23  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2074: MaxStoreFileSize restriction capabilities ignored.	The
	  find_maxnbytes() function in modules/mod_xfer.c was not checking
	  the argc of the configured config_recs properly, and so was
	  ignoring any configured classifiers on
	  Max{Retrieve,Store}FileSize directives.  This also fixes the
	  handling of a single "*" configuration parameter, which is
	  documented as being allowed.

2003-05-31 09:31  castaglia

	* README.mod_sql:
	  Increasing suggested passwd column length.

2003-05-30 17:51  castaglia

	* contrib/mod_rewrite.c:
	  Changed referenced to deprecated make_named_sub_pool() to
	  make_sub_pool().

2003-05-30 17:37  castaglia

	* contrib/mod_sql.c, modules/mod_log.c:
	  Adding new LogFormat variable, %J (and mod_sql support for it).
	  This variable expands to the arguments given in an FTP command.
	  Currently, there is %m for just the command, %r for the full
	  command (command + arguments), but nothing for just the
	  arguments.  Hence the need for a new variable.

2003-05-30 17:07  castaglia

	* modules/mod_core.c:
	  Changed handling of RNTO slightly.  It would clear session.xfer.p
	  at the end of the CMD phase.	Unfortunately, this meant that for
	  ExtendedLog/SQLLog, which might want to use %f for RNTO, the path
	  allocated from that pool would be gone.  Now, a
	  LOG_CMD/LOG_CMD_ERR handler for RNTO does the clearing of
	  session.xfer.p for RNTO, thus letting mod_log/mod_sql have a
	  chance to do their stuff.

2003-05-29 09:31  castaglia

	* README.cygwin:
	  Adding note to Cygwin README to use Cygwin 1.3.22 or later, in
	  order to prevent/quell ENOTSOCK errors (Bug#2064).

2003-05-29 00:29  castaglia

	* contrib/: mod_sql_mysql.c, mod_sql_postgres.c:
	  Add some sanity checks to the backend init handlers. (Note: this
	  actually makes a difference for a different module I'm working
	  on, but the logic is still worthwhile for the existing code.)

2003-05-28 16:03  jwm

	* contrib/dist/rpm/proftpd.spec:
	  build fixup from Ivan Martinez <ivanfm@os2brasil.com.br>

2003-05-27 19:51  castaglia

	* Makefile.in:
	  Add an 'all' dependency to the install target, to catch those
	  unsuspecting admins that might skip the 'make' and go straight
	  for the 'make install'.

2003-05-27 13:42  castaglia

	* lib/pr-syslog.c:
	  UnixWare 7.1 seems to have STREAMS support for /dev/log, similar
	  to Solaris and IRIX.	It's not quite the same, though.  Patch
	  contributed by Olivier PRENANT.

2003-05-26 17:46  jwm

	* contrib/dist/rpm/proftpd.spec:
	  logrotate script should be config(noreplace)

2003-05-26 17:45  jwm

	* contrib/dist/rpm/proftpd.spec:
	  Apparently RPM doesn't like user-defined options with dashes in
	  them (--with-module -> --with)

2003-05-26 12:20  castaglia

	* src/data.c:
	  Style/spacing.

2003-05-25 18:48  jwm

	* NEWS:
	  I really should pay attention to what I'm doing when I resolve
	  conflicts...

2003-05-25 18:41  jwm

	* NEWS:
	  Bug 1804 - Permit selection of additional contrib modules when
	  building the RPM

2003-05-25 18:39  jwm

	* contrib/dist/rpm/proftpd.spec:
	  change the flag name

2003-05-25 18:17  jwm

	* contrib/dist/rpm/proftpd.spec:
	  Bug 1804 - RPM spec file improvements

2003-05-23 12:43  castaglia

	* src/log.c:
	  Make the error about logging to world-writeable directories a
	  little more prominent.

2003-05-22 12:26  castaglia

	* NEWS, src/fsio.c:
	  Bug#2043 - Proftpd converts LF to CRLF on PUT (Cygwin)

2003-05-22 08:01  castaglia

	* modules/mod_xfer.c:
	  Fix missing case for .ftpaccess files bearing
	  Max{Retrieve,Store}FileSize directives.

2003-05-20 11:00  castaglia

	* contrib/mod_sql.c:
	  Correcting thinko in mod_sql that affected proper lookup of shell
	  values.  Minor log message correction.

2003-05-19 15:28  castaglia

	* modules/mod_xfer.c:
	  Make sure that for the TransferRate, when updating the
	  scoreboard, the actual number of bytes sent (not adjusted for
	  free bytes) is used.

2003-05-19 13:12  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2051 - freebytes in TransferRate does not work properly.

2003-05-16 09:18  castaglia

	* include/version.h:
	  Bumping the version for CVS.

2003-05-15 21:28  castaglia

	* ChangeLog:
	  Updating ChangeLog.

2003-05-15 21:25  castaglia

	* NEWS, contrib/dist/rpm/proftpd.spec, include/version.h:
	  Preparing for 1.2.9rc1 release.

2003-05-14 19:21  castaglia

	* README.mod_sql:
	  Bug#2044 - PostgreSQL backend SQLConnectInfo malfunction.
	  Actually, this is merely bad documentation.

2003-05-14 17:49  castaglia

	* lib/libcap/Makefile, lib/libcap/cap_alloc.c,
	  lib/libcap/cap_text.c, lib/libcap/libcap.h,
	  lib/libcap/include/sys/capability.h, modules/mod_cap.c:
	  Bug#2000 - mod_cap should not use bundled libcap.  This patch
	  updates the bundled libcap; I won't be closing the bug report
	  just yet.

2003-05-14 12:05  castaglia

	* modules/mod_xfer.c:
	  We don't want to call regerror(3) when regexec(3) matches -- we
	  want to call regerror() when it _doesn't_ match.  Seeing
	  "Success" in the debugging output is not very useful.

2003-05-14 10:54  castaglia

	* NEWS:
	  Wrong bug report number.

2003-05-13 22:17  castaglia

	* NEWS, include/dirtree.h, modules/mod_auth.c, modules/mod_core.c,
	  src/dirtree.c:
	  Bug#1977 - Add %u variable support in configuration file.

2003-05-13 21:56  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#2031 - Add support for flags for RewriteCondition,
	  RewriteRule (a la Apache's mod_rewrite)

2003-05-13 21:43  castaglia

	* NEWS, src/dirtree.c, src/fsio.c:
	  Bug#2047 - 1024 or more chars in .ftpaccess causes lockup.

2003-05-12 11:23  castaglia

	* lib/pr-syslog.c:
	  Fix logic.

2003-05-12 11:20  castaglia

	* lib/pr-syslog.c:
	  Add an Id tag.

2003-05-09 16:57  jwm

	* lib/pr-syslog.c:
	  centralize STREAMS defines

2003-05-09 00:02  castaglia

	* configure:
	  Updating.

2003-05-08 23:58  castaglia

	* configure.in:
	  Minor wording correction/change.

2003-05-08 11:12  castaglia

	* configure:
	  Updating configure.

2003-05-08 11:10  castaglia

	* configure.in:
	  Cygwin installation patch (contributed by Jason Tishler
	  <jason@tishler.net>).

2003-05-02 11:13  castaglia

	* README.cygwin:
	  Add note about Cygwin's lack of largefile support (sizeof(off_t)
	  is only 4, rather than 8, on Cygwin).

2003-05-02 10:09  castaglia

	* configure:
	  Updating configure.

2003-05-02 10:07  castaglia

	* config.h.in, configure.in, include/conf.h:
	  Adjusting the check for %llu support a little: we only want to
	  use %llu if a) printf(3) supports it _and b) the size of off_t
	  (hopefully defined to be an unsigned long long) is 8 bytes.
	  Otherwise, use %lu.

2003-04-30 12:32  castaglia

	* include/dirtree.h, include/support.h, modules/mod_auth.c,
	  modules/mod_auth_unix.c, src/dirtree.c, src/support.c:
	  Moving the handling of authentication for Cygwin from mod_auth to
	  mod_auth_unix.

2003-04-30 11:20  castaglia

	* modules/: mod_auth.c, mod_core.c:
	  get_param_ptr() lookup logic thinkos.

2003-04-30 11:16  castaglia

	* contrib/mod_rewrite.html:
	  Add default value for RewriteEngine.

2003-04-30 11:13  castaglia

	* contrib/mod_rewrite.c:
	  More explicit handling of RewriteEngine lookup.

2003-04-30 09:12  castaglia

	* modules/mod_auth_file.c:
	  Style/placement.

2003-04-30 08:49  castaglia

	* NEWS, modules/mod_auth_file.c:
	  Bug#2032 - AuthOrder not working when first option is
	  mod_auth_file.c.

2003-04-30 00:44  castaglia

	* configure:
	  Updating.

2003-04-30 00:42  castaglia

	* config.h.in, configure.in, include/conf.h:
	  Try to determine whether %llu or %lu should be used in the
	  configure script by actually testing use of printf(3), rather
	  than relying on _FILE_OFFSET_BITS (which some platforms don't
	  use) or SIZEOF_OFFSET_T (which doesn't convey the host printf()'s
	  ability to support %llu).

2003-04-29 23:45  castaglia

	* contrib/mod_tls.c:
	  Forgot to decrement the reference count to the peer cert
	  properly.

2003-04-29 17:03  castaglia

	* modules/mod_xfer.c:
	  Fix some cases where a filehandle was not being closed properly,
	  or the wrong filehandle was being closed.  In all honesty, I
	  think this patch may be a bit paranoid, as these cases are
	  probably caught by xfer_err_cleanup().  Still, at least the code
	  will be more consistent (and less confusing if you don't know
	  where to look) with these changes.

2003-04-29 10:40  castaglia

	* NEWS:
	  Oops...wrong credit. =/

2003-04-29 10:39  castaglia

	* NEWS:
	  Add credit for AllowForeignAddress fix.

2003-04-29 10:13  castaglia

	* modules/mod_core.c, src/inet.c:
	  Transition to using get_param_ptr() instead of get_param_int()
	  resulted in bad logic when handling AllowForeignAddress.

2003-04-26 10:50  jwm

	* src/.cvsignore, utils/.cvsignore:
	  ignore autogenerated man pages

2003-04-24 21:13  castaglia

	* NEWS, README.cygwin, include/privs.h, modules/mod_auth.c,
	  src/main.c:
	  Cygwin portability fixes: on Cygwin, the root UID/GID is not 0/0,
	  but 18/544:

	    http://cygwin.com/ml/cygwin/2003-04/msg01918.html

	  Also updating the Cygwin README with feedback from Jason Tishler
	  <jason at tishler.net>.

2003-04-24 17:02  castaglia

	* NEWS, include/bindings.h, src/bindings.c, src/main.c:
	  Fixed minor fd leak/messiness where listening fds were not being
	  properly closed in a session process, when the session is first
	  starting.  Michael noticed symptoms of this manifesting as a
	  problem handling HUPs.  (I can't believe this behavior has gone
	  on for so long in the code with no one noticing...oh well).

2003-04-24 16:02  castaglia

	* contrib/mod_rewrite.c:
	  Fixing bug where a RewriteRule with no conditions was not being
	  executed properly.

2003-04-24 12:41  castaglia

	* INSTALL, README.modules:
	  Module name changes.

2003-04-23 17:27  castaglia

	* README.modules:
	  Updating the module list.

2003-04-23 11:55  castaglia

	* contrib/mod_rewrite.c:
	  Pedantic change -- bad grammar in variable name.

2003-04-22 23:56  castaglia

	* configure:
	  Updating.

2003-04-22 23:53  castaglia

	* configure.in, include/privs.h, modules/mod_auth.c,
	  modules/mod_cap.c, modules/mod_core.c, src/auth.c, src/main.c:
	  Adding more stuff to the --enable-devel option: first, the
	  ability to generate core dumps (thank you, Michael!) Second, the
	  ability to specify developer options in the configure
	  --enable-devel parameter, rather than using CFLAGS.  For example,
	  rather than doing:

	    CFLAGS="-DPR_DEVEL_NO_FORK -DPR_DEVEL_COREDUMP" ./configure
	  --enable-devel ...

	  you can now do:

	    ./configure --enable-devel=nofork:coredump ...

	  At present, only three developer options are supported: nodaemon,
	  nofork, and coredump.

2003-04-22 22:00  castaglia

	* contrib/mod_rewrite.html:
	  Typo.

2003-04-22 19:46  castaglia

	* src/pool.c:
	  Sanity checking.

2003-04-22 19:39  castaglia

	* lib/glibc-glob.c:
	  Fixing compiler warning.

2003-04-22 17:42  castaglia

	* contrib/mod_rewrite.html:
	  Adding more substance to this document (still needs more,
	  though).

2003-04-22 17:28  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#2029 - Rewrite rule may execute more than once if multiple
	  rewrite conditions exist.

2003-04-22 16:07  castaglia

	* NEWS:
	  Bug#2003 - mod_auth.c does not compile for cygwin on W2K.

2003-04-22 16:05  castaglia

	* modules/mod_auth.c:
	  Slight modification of Cygwin stuff, as per Bug#2003.  Cygwin
	  doesn't/shouldn't use the normal proftpd auth handlers for
	  checking passwords (it's done by Cygwin's cygwin_logon_user()
	  function).

2003-04-22 13:47  castaglia

	* include/proftpd.h, lib/pr_fnmatch_loop.c, modules/mod_auth.c,
	  modules/mod_auth_unix.c:
	  Bug#2003 - mod_auth.c does not compile for cygwin on W2K.  There
	  may be more work needed on this bug, but this patch at least
	  compiles correctly.

2003-04-21 20:21  castaglia

	* contrib/mod_tls.html:
	  Updating the mod_tls documentation.

2003-04-17 23:26  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#1532 - [patch] Human readable disk free.

2003-04-17 16:06  castaglia

	* src/inet.c:
	  Cruft removal.

2003-04-16 10:53  castaglia

	* src/fsio.c:
	  Add Solaris 2.5.1 to the list of Solaris versions that use struct
	  statvfs for its statvfs(2) call.

2003-04-16 00:34  castaglia

	* src/fsio.c:
	  Typo.

2003-04-16 00:00  castaglia

	* configure:
	  Updating configure script.

2003-04-15 23:56  castaglia

	* configure.in:
	  Tweaking the configure.in file to fix some things that cause
	  trouble on Tru64 Unix (and probably other picky platforms).

2003-04-15 23:09  castaglia

	* src/fsio.c:
	  Reworking the #ifdefs around statvfs a little; now, if we're a
	  Solaris 2.6 or 2.7 box, we'll use struct statvfs, otherwise,
	  statvfs_t.  We'll deal with those poor souls still using 2.5.1 or
	  older later.	(Thanks for the info about statvfs64 on Solaris
	  2.7, Noah).

2003-04-15 20:18  castaglia

	* src/fsio.c:
	  Silencing compiler warnings about statvfs64(2) on LFS-enabled
	  Solaris.

2003-04-15 15:56  castaglia

	* modules/mod_core.c:
	  "HideFiles none" config_recs did not contain the proper
	  CF_MERGEDOWN_MULTI flag, unlike their regex-bearing config_rec
	  siblings.

2003-04-14 23:42  castaglia

	* NEWS, src/main.c:
	  Bug#2021 - Inetd mode and scoreboard format changes.	Now, if
	  ServerType is inetd and the server encounters a scoreboard
	  version mismatch on startup, the old scoreboard file will be
	  unlinked and a new blank one written.

2003-04-14 23:22  castaglia

	* NEWS, modules/mod_auth.c, modules/mod_core.c:
	  Added RootRevoke configuration directive.

2003-04-14 18:08  castaglia

	* src/modules.c:
	  Minor adjustment, to make sure that PRE_CMD, POST_CMD et al are
	  not inadvertently forgotten.

2003-04-14 16:18  castaglia

	* src/modules.c:
	  HOOK commands need to be properly inserted into the stash if they
	  are to be later looked up.

2003-04-14 15:38  castaglia

	* modules/mod_xfer.c:
	  Michael found a bug where the REST position was not properly
	  being cleared between uploads/downloads.

2003-04-09 11:29  castaglia

	* src/inet.c:
	  Typo.

2003-04-08 23:39  castaglia

	* src/inet.c:
	  IRIX doesn't need this ioctl(2) call, it seems.

2003-04-08 19:53  castaglia

	* NEWS, modules/mod_core.c, modules/mod_site.c, modules/mod_xfer.c:

	  Bug#2002 - Per-<Directory> PathAllowFilter/PathDenyFilter.

2003-04-08 15:25  castaglia

	* contrib/mod_ifsession.c:
	  Fixing bug with mod_ifsession's searching/handling of multiple
	  <If*> contexts.

2003-04-08 11:49  castaglia

	* configure:
	  Updating configure.

2003-04-08 11:47  castaglia

	* config.h.in, configure.in, NEWS, include/data.h, src/data.c:
	  Bug#1813 - configure code: mistake in BSD sendfile semantic
	  detection. The autoconf test for Linux simply needed to #include
	  <sys/sendfile.h>.

	  Bug#2019 - proftpd support for Solaris 8/9 native sendfile.  A
	  native Solaris sendfile() implementation became available via
	  patch for Solaris 8, and is included by default in Solaris 9.  I
	  don't know how stable or esoteric the implementation is, so this
	  may have bugs lurking.

2003-04-08 10:18  castaglia

	* modules/mod_ls.c:
	  Fix segfault in NLST.

2003-04-07 15:53  castaglia

	* src/main.c:
	  Minor buglet: actually honor RLIM_INFINITY if USE_DEVEL is
	  defined when setting the RLIMIT_CORE rlimit.

2003-04-07 14:07  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#2018: Incorrect caching of TransferRate values.

2003-04-04 09:04  castaglia

	* lib/: pr_fnmatch.c, pr_fnmatch_loop.c:
	  Quell some compiler warnings when --enable-devel flags are used.

2003-04-03 23:30  castaglia

	* configure:
	  Updating.

2003-04-03 23:29  castaglia

	* configure.in:
	  Oops...forgot an important part. =P

2003-04-03 23:25  castaglia

	* configure:
	  Updating.

2003-04-03 23:23  castaglia

	* NEWS, configure.in, src/proftpd.8, src/proftpd.8.in,
	  src/xferlog.5, src/xferlog.5.in, utils/ftpcount.1,
	  utils/ftpcount.1.in, utils/ftpshut.8, utils/ftpshut.8.in,
	  utils/ftptop.1, utils/ftptop.1.in, utils/ftpwho.1,
	  utils/ftpwho.1.in:
	  Bug#2016 - man pages should be autogenerated to reflect the
	  --prefix used.  The man pages are now generated by the configure
	  script.

2003-04-03 15:15  castaglia

	* modules/mod_core.c:
	  Scrub the scoreboard during a rehash (SIGHUP), too.

2003-04-03 10:55  castaglia

	* configure:
	  Updating configure script for curses/ncurses library detection
	  changes.

2003-04-03 10:49  castaglia

	* configure.in:
	  Bug#2009: ncurses/ftptop linker problem on Solaris.  The system
	  in question has curses.h, libcurses, and libncurses.	The
	  configure script used libncurses when linking ftptop (as ncurses
	  is preferred if we can get it) without checking to see if
	  ncurses.h was present.  Now, the library is checked only if the
	  corresponding header is present.

2003-04-02 17:34  castaglia

	* configure:
	  Updating configure script.

2003-04-02 17:31  castaglia

	* NEWS, configure.in, config.h.in, utils/ftptop.c:
	  Added new --disable-{curses,ncurses} configure options.

2003-04-02 14:54  castaglia

	* README.PAM:
	  Updating Linux PAM configuration examples.

2003-04-02 09:45  castaglia

	* NEWS, src/main.c:
	  Bug#2011 - No "FTP session closed." msgs written to logfile.	The
	  check for when to write the message ("!is_master") only checks if
	  the current process is a child process, not an existing daemon
	  process.  This works well for standalone daemons, but not
	  inetd-run daemons, which have no "master" process.  The fix,
	  then, is to log the message if either !is_master or if the
	  servertype is inetd.

2003-04-01 15:56  castaglia

	* include/modules.h, src/modules.c:
	  Removing crufty auth_priority variable.

2003-04-01 12:22  castaglia

	* contrib/mod_sql.c:
	  Pedantic orthography correction.

2003-04-01 12:13  castaglia

	* contrib/mod_sql.c:
	  Add typecasting, to quell compiler warnings.

2003-04-01 10:11  castaglia

	* modules/mod_core.c:
	  This module needs to include signal.h, so that it picks up the
	  prototype for kill(2).

2003-03-29 15:55  castaglia

	* src/scoreboard.c:
	  Be a little more careful about interrupted system calls.  In some
	  cases, we wrap the system calls in while() loops, handling
	  EINTRs.  In others, we simply block all signals that might
	  interrupt the system call.  Also, lock the scoreboard when
	  writing a new header for it (this was not being done).

2003-03-29 15:52  castaglia

	* modules/mod_auth.c:
	  Remove spurious logged complaints about the scoreboard, causing
	  by logging on any return value from pr_open_scoreboard(), not
	  just the error return values.  Oops.

2003-03-29 11:52  castaglia

	* modules/mod_ls.c:
	  Prevent a segfault in some situations by making sure the pointer
	  exists before dereferencing it.

2003-03-29 09:12  castaglia

	* src/fsio.c:
	  Be a little more accurate when reporting the name of the FS whose
	  callback is being invoked.

2003-03-28 13:17  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#1998 - Add ListOptions for setting limits on -R listings.

2003-03-27 23:34  castaglia

	* src/main.c:
	  Every command needs to have its logging class, unless otherwise
	  explicitly set, default to CL_ALL.

2003-03-27 17:58  castaglia

	* contrib/ftpasswd:
	  Make explicit the fact that --group --member parameters are user
	  names.

2003-03-26 16:55  castaglia

	* contrib/mod_ifsession.html:
	  Adding text to the mod_ifsession docs.

2003-03-25 19:34  castaglia

	* src/mkhome.c:
	  Quell compiler warnings on Solaris by explicitly casting mode_t
	  to an unsigned int.

2003-03-25 02:41  cyberrobo

	* modules/mod_ls.c: small typo

2003-03-24 21:52  castaglia

	* NEWS, src/inet.c:
	  Bug#1997 - UnixWare 7.1.3 & port 20.

2003-03-24 15:43  castaglia

	* src/inet.c:
	  Typo.

2003-03-24 15:40  castaglia

	* src/inet.c:
	  More setsockopt(2) fun: *BSD want IPPROTO_IP for setting IP_TOS
	  options, Linux wants SOL_IP.

2003-03-24 12:26  castaglia

	* modules/mod_auth.c, src/main.c, src/scoreboard.c,
	  utils/ftpcount.c, utils/ftptop.c:
	  Fixing the messages reported when opening the scoreboard (and
	  making all such messages consistent).

	  Note: we'll need to document, probably in the release
	  announcement, when the scoreboard format (include/scoreboard.h's
	  PR_SCOREBOARD_VERSION) is increment.	For standalone-run daemons,
	  there is no problem; for inetd-run daemons, though, the old
	  scoreboard file will need to be deleted before the new daemon is
	  started, else the new daemon will complain of the scoreboard
	  being too old.  (I think this is what we are seeing now with
	  people upgrading from 1.2.7 to 1.2.8; it's the first time in who
	  knows how long that the scoreboard version number was increment.)

2003-03-24 12:02  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#1935 - mod_ls memory leak.

2003-03-23 22:14  castaglia

	* NEWS, contrib/mod_tls.c:
	  Fixing mod_tls' use of SSL_shutdown() to properly shutdown an SSL
	  session when talking to some clients that don't want to shutdown
	  properly.

2003-03-23 12:00  castaglia

	* src/netio.c:
	  A shutdown() is not a close(); shutdown should not be freeing the
	  netio stream's pool.

2003-03-23 10:15  castaglia

	* contrib/mod_sql.c:
	  More error checking when a custom SQLUserInfo query is used.

2003-03-22 11:09  castaglia

	* utils/utils.h:
	  Cruft.

2003-03-22 11:04  castaglia

	* configure:
	  Updating.

2003-03-22 11:02  castaglia

	* configure.in:
	  For now, require that --enable-ipv6 be used at configure time.
	  Once IPv6 support has had all its bugs worked out, then we can
	  make IPv6 support the default.

2003-03-22 10:19  castaglia

	* configure:
	  Updating.

2003-03-22 10:16  castaglia

	* config.h.in, configure.in, modules/mod_auth_unix.c:
	  Change AUTO_SHADOW to be USE_AUTO_SHADOW, to be more consistent.

	  Add a --disable-ipv6 configure option, and a corresponding
	  USE_IPV6 define.  Add check for getnameinfo(3) function.

2003-03-22 09:59  castaglia

	* configure:
	  Updating.

2003-03-22 09:55  castaglia

	* aclocal.m4, config.h.in, configure.in:
	  Check for a defined struct sockaddr_storage.	I don't know if
	  this is really necessary, or if we can assume that all platforms
	  will define this struct.  I think it better to have the check,
	  just in case.

2003-03-21 20:49  castaglia

	* contrib/mod_sql.c:
	  Check the number of fields in the returned set of a SQLUserInfo
	  query.  Hopefully this will quell some mod_sql/shell-related
	  segfaults.

2003-03-20 22:46  castaglia

	* NEWS:
	  Should mention mod_radius changes here.

2003-03-20 22:44  castaglia

	* contrib/mod_radius.c:
	  Changing way mod_radius looks up custom attributes in response
	  packets; now, rather than using RADIUS attribute type IDs,
	  mod_radius will use VSA IDs.	The new RadiusVendor directive is
	  used to configure the vendor for which mod_radius will search.
	  The new RadiusGroupInfo complements the existing RadiusUserInfo
	  directive; as expected, RadiusGroupInfo is used to configure
	  RADIUS user group membership information.

2003-03-20 22:00  castaglia

	* src/scoreboard.c:
	  Report the scoreboard path anyway.

2003-03-20 21:58  castaglia

	* src/scoreboard.c:
	  Add debug logging of the path used if opening the scoreboard file
	  fails.

2003-03-20 19:26  castaglia

	* src/: fsio.c, main.c:
	  Making the checking of the configuration file path actually work.

	  Getting rid of #PR_HACK_DISABLE_MEM_VHOST_FREE, and commenting
	  out the freeing code completely.  Copy-on-write semantics means
	  that that freeing of memory, which would not be used or changed
	  anyway, probably adds load unnecessarily.  I doubt anyone will
	  miss that code.

2003-03-20 15:23  castaglia

	* contrib/: mod_sql.c, mod_sql.h, mod_sql_mysql.c,
	  mod_sql_postgres.c:
	  Added the ability to construct custom user information queries
	  with mod_sql.  The mod_sql docs will be updated accordingly.
	  Various style cleanups included in this patch.

2003-03-20 13:38  castaglia

	* NEWS:
	  Typo.

2003-03-20 11:33  castaglia

	* utils/: ftpcount.1, ftptop.1, ftpwho.1:
	  Updating paths to reflect default installation locations.

2003-03-20 11:31  castaglia

	* src/proftpd.8:
	  Updating the paths in the man page to reflect the default
	  installation location.  At some point, we'll need to handle this
	  better, to generate/rewrite the man page based on the --prefix
	  used, so that the man pages properly reflect the locations of the
	  installed files.

2003-03-20 11:11  castaglia

	* src/fsio.c:
	  Minor correction of bug introduced by last night's
	  pr_fs_valid_path() addition (forgot to handle case where no
	  modules registered an FS).

2003-03-20 09:46  castaglia

	* NEWS, utils/ftptop.c:
	  Bug#1995 - ftptop: no curses or ncurses library on this system.

2003-03-19 23:54  castaglia

	* contrib/mod_sql_mysql.c:
	  One minor cast needed to compile/link without warnings against
	  MySQL-4.0 client libraries.

2003-03-19 18:19  castaglia

	* include/fsio.h, modules/mod_core.c, src/fsio.c, src/main.c:
	  Modifying the checking of configuration paths slightly.  Rather
	  than now only accepting absolute paths (criterion: string begins
	  with '/'), paths that start with any of the paths registered with
	  the FSIO layer will be accepted.  This allows FSIO modules to
	  register handlers for paths that may not necessarily be local
	  filesystem paths (e.g. "sql://" paths).  This change affects the
	  paths accepted by the Include configuration directive as well.

2003-03-19 12:05  castaglia

	* configure:
	  Updating.

2003-03-19 11:50  castaglia

	* aclocal.m4, config.h.in, configure.in:
	  More IPv6-related autoconf detection.

2003-03-19 11:00  castaglia

	* NEWS, contrib/mod_tls.c:
	  Patching mod_tls to use RSA blinding in installations of OpenSSL
	  older than 0.9.7b, in order to prevent certain RSA-based timing
	  attacks:   http://www.openssl.org/news/secadv_20030317.txt

2003-03-18 23:58  castaglia

	* modules/mod_auth.c:
	  Another off-by-one bug, this time afflicting MaxClientsPerUser.

2003-03-18 08:17  castaglia

	* contrib/mod_rewrite.html:
	  Added note about the $0 backreference.

2003-03-18 08:13  castaglia

	* src/inet.c:
	  Portability fun with socket options. =P

2003-03-18 07:57  castaglia

	* configure:
	  Updating.

2003-03-18 07:53  castaglia

	* config.h.in, configure.in:
	  Start autoconf checks for some functions we'll need for IPv6
	  support.

2003-03-18 07:19  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#1987 - mod_rewrite seems not to handle more than one
	  backreference (only $1).

2003-03-17 23:52  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#1986 - mod_rewrite backreferences not zero-based (use $1 not
	  $0?).

2003-03-17 15:48  castaglia

	* src/data.c:
	  Trying to make sure that an interrupted sendfile(2) on Linux has
	  its signals handled properly.

2003-03-17 08:48  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#1989 - SQLLog '*' doesn't match any commands.

2003-03-17 08:41  castaglia

	* modules/mod_xfer.c:
	  Add handling of signals if sendfile() is interrupted.

2003-03-14 19:33  castaglia

	* NEWS, contrib/mod_sql_mysql.c:
	  Bug#1730 - mod_mysql logging of long transfers fails.

2003-03-14 19:18  castaglia

	* NEWS, contrib/mod_rewrite.c:
	  Bug#1985 - mod_rewrite fails to build on platforms without
	  flock().

2003-03-14 10:27  castaglia

	* contrib/: mod_sql.c, mod_sql.h, mod_sql_mysql.c,
	  mod_sql_postgres.c:
	  Adding $Id: ChangeLog,v 1.145 2010/02/24 17:58:50 castaglia Exp $ tags to the mod_sql files.

2003-03-14 07:54  castaglia

	* src/dirtree.c:
	  Be a little more thorough in checking how to handle the given
	  path in get_dir_ctxt().

2003-03-14 07:51  castaglia

	* src/dirtree.c:
	  Correct get_dir_ctxt() when operating within a chroot.

2003-03-13 18:37  jwm

	* README.LDAP: forgot to update this for 2.8.11

2003-03-13 15:31  castaglia

	* NEWS, include/dirtree.h, src/dirtree.c, src/main.c:
	  Bug#1983 - filenames beginning with # fail to upload / download.

2003-03-12 18:56  castaglia

	* include/fsio.h, src/fsio.c:
	  Changing a few of the FSIO functions (close, read, write, lseek)
	  so that they operate on file handles, rather than on filesystem
	  objects.  This is done primarily so that they can get access to
	  the newly-added fh_data member of a file handle, used for storing
	  file-specific data.

	  Also added two new FSIO functions, for fstat and ftruncate.

2003-03-12 13:55  castaglia

	* NEWS, contrib/mod_sql_mysql.c:
	  Bug#1982: fixing how mod_sql_mysql reads MySQL .cnf files.  Looks
	  like there's a bug in MySQL's (undocumented) load_defaults()
	  functions.  Hrmf.

2003-03-12 13:13  castaglia

	* modules/mod_auth.c:
	  Change the timing of when C_USER is removed from the config tree;
	  this allows modules that want to lookup the USER name sent by the
	  client (e.g.	for substituting %U) a chance to do so.

2003-03-12 08:36  castaglia

	* Makefile.in:
	  Pass LDFLAGS on to ftpcount and ftpshut, too.

2003-03-11 18:46  castaglia

	* contrib/mod_ifsession.c, include/dirtree.h, modules/mod_core.c,
	  src/dirtree.c, src/sets.c:
	  Updating code that checks for empty configuration contexts, and
	  removes them.  (Empty contexts within another context were
	  causing segfaults).  Also, add code to report, upon ending of a
	  configuration context, if the ended context is being ignored (at
	  debug level 3).

2003-03-10 12:48  castaglia

	* contrib/mod_ifsession.html:
	  Updating mod_ifsession docs.

2003-03-09 15:24  castaglia

	* NEWS, include/scoreboard.h, modules/mod_auth.c,
	  modules/mod_core.c, src/scoreboard.c, utils/utils.h:
	  Bug#1915 - Unsafe pointer usage in scoreboard file format.

2003-03-09 14:40  castaglia

	* NEWS, contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c:
	  Bug#1849 - Compile can have trouble finding mysql.h.

2003-03-09 14:30  castaglia

	* configure:
	  Updating the configure script.

2003-03-09 14:28  castaglia

	* NEWS, configure.in, include/conf.h, include/dirtree.h,
	  include/inet.h, include/options.h, modules/mod_core.c,
	  modules/mod_xfer.c, src/bindings.c, src/data.c, src/dirtree.c,
	  src/inet.c, src/main.c:
	  Bug#1921 - Socket-level performance tweaks.

2003-03-09 08:53  castaglia

	* src/inet.c:
	  Portability fix for letting active/inetd function properly on Mac
	  OSX (Darwin).

2003-03-09 08:23  castaglia

	* src/main.c, utils/ftpcount.c, utils/ftpwho.c:
	  Minor change: list the short form of options first, then the long
	  form.

2003-03-08 20:19  castaglia

	* NEWS, include/options.h, modules/mod_core.c:
	  Bug#1969 - Add scoreboard-scrubbing timer.

2003-03-08 19:55  castaglia

	* src/main.c:
	  Oops.  Had these function calls, for running through the
	  registered daemon startup callbacks, in the inetd startup code --
	  not too useful there.  Now in the standalone startup code, where
	  they belong.

2003-03-08 19:16  castaglia

	* modules/mod_core.c:
	  Actually, let's hold off on the idea of barring use of 0.0.0.0,
	  for now.  We can revisit it later.

2003-03-08 19:09  castaglia

	* include/modules.h, src/main.c, src/modules.c:
	  Adding yet another module callback registration set of functions.
	  This set is for allowing modules to register callbacks that are
	  invoked just before the daemon starts up, after it has (possibly)
	  daemonized.  One would want to have something done at this point
	  when you want to make sure that the daemon process is affected,
	  e.g. adding a timer.	Calling alarm(3) in a module_init function
	  won't work for standalone daemons, for part of the daemonizing
	  process involves forking() twice (to dissociate the process
	  completely from the terminal), and all pending alarms are cleared
	  for a child process.

2003-03-08 18:25  castaglia

	* NEWS:
	  Making note of new handling/checking for IP address/port
	  collisions.

2003-03-08 18:24  castaglia

	* modules/mod_core.c:
	  This patch prevents two specific vhost misconfigurations: 1)
	  trying to use "0.0.0.0", which no client could ever reach, and 2)
	  IP address/port collisions.  The second is the more likely of the
	  misconfigurations, particularly when DNS names, rather than IP
	  addresses, are used in <VirtualHost> lines (as when new proftpd
	  uses think to configure name-based vhosts).

2003-03-08 18:06  castaglia

	* contrib/mod_tls.c, include/feat.h, modules/mod_core.c,
	  src/feat.c:
	  Pedantic namespace change: pr_{add,get}_feat ->
	  pr_feat_{add,get}.  This provides consistency in the pr_*
	  function namespace.

2003-03-08 17:35  castaglia

	* README.ports:
	  Updating.

2003-03-08 17:04  castaglia

	* include/modules.h:
	  Cruft.

2003-03-08 16:56  castaglia

	* include/proftpd.h:
	  Cruft.

2003-03-07 15:11  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#1932 - Make Max* checks a PASS POST_CMD handler.

2003-03-06 09:48  castaglia

	* contrib/mod_sql_postgres.c:
	  Postgres added a string-escaping function at some point, so just
	  as mod_sql_mysql does, now mod_sql_postgres will make use of its
	  library-provided function.

	  Note that a manual #define had to be used, to ensure backward
	  compatibility with Postgres installations that don't have the
	  escape function.  Ideally a configure script could check for the
	  function; this is yet another case for having proftpd's build
	  system support per-module build directories and scripts.

2003-03-05 18:18  jwm

	* contrib/mod_ldap.c:
	  upgrade to 2.8.11

2003-03-05 18:15  castaglia

	* NEWS, contrib/mod_ifsession.c, contrib/mod_ifsession.html:
	  Bug#1933 - Add mod_ifsession contrib module.

2003-03-05 16:11  castaglia

	* NEWS, contrib/mod_radius.c:
	  Bug#1980 - Login with incorrect password POSSIBLE when using
	  mod_radius.

2003-03-05 13:55  castaglia

	* NEWS, utils/ftpcount.1, utils/ftpcount.c, utils/ftptop.1,
	  utils/ftptop.c, utils/ftpwho.1, utils/ftpwho.c:
	  Bug#1869 - Add option "--server/-s" to ftpwho&ftpcount&ftptop.

2003-03-05 11:23  castaglia

	* NEWS, contrib/mod_tls.c:
	  Bug#1979 - Add TLSTimeoutHandshake directive.

2003-03-05 11:20  castaglia

	* NEWS, include/scoreboard.h, src/main.c, src/scoreboard.c,
	  utils/ftptop.c, utils/ftpwho.c, utils/utils.h:
	  Bug#1794 - Scoreboard format changes.  This commit splits the cmd
	  (i.e. the FTP command used) from the command arguments in the
	  scoreboard.

2003-03-04 18:05  castaglia

	* modules/mod_auth.c:
	  Fixing shadowing variable name.

2003-03-04 17:23  castaglia

	* include/privs.h:
	  Make the PRIVS_ROOT macro change the egid to 0 as well as the
	  euid, to be consistent.

2003-03-04 15:32  castaglia

	* modules/mod_xfer.c:
	  Re-add the missing setsockopt(TCP_CORK) to uncork the socket
	  after sending data.

2003-03-04 15:22  castaglia

	* modules/mod_xfer.c:
	  Still working on this.

2003-03-04 15:14  castaglia

	* modules/mod_xfer.c:
	  Fixing use of TCP_CORK.

2003-03-04 13:46  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#1972 - %T not correctly shows time at performance of a
	  command "rename".

2003-03-04 13:30  castaglia

	* NEWS, utils/ftpshut.c, utils/ftpshut.8:
	  Added -D option to ftpshut, to be used to delete the /etc/shutmsg
	  file (rather than having to manually remove it).

2003-03-04 12:03  castaglia

	* modules/mod_xfer.c, src/inet.c:
	  Add use of TCP_CORK setsockopt(2) option on platforms that define
	  it (e.g.  Linux).

2003-03-04 11:55  castaglia

	* contrib/mod_sql.c, include/modules.h, src/modules.c:
	  Formalizing the use of "hooks", which are custom cmdtable entries
	  that contrib modules can add.  mod_sql started the trend with its
	  "sql_lookup" and "sql_change" hooks.	This patch makes sure that
	  any such hooks will not be accidentally used; it was possible, if
	  a custom hook was entered that has an all uppercase name, for a
	  client to send an FTP command that matched that name, leading to
	  a possible bad interaction.

	  This patch avoids the above scenario by defining a new symbol
	  tag, PR_SYM_HOOK, to be used for "hook" cmdtable entries.  I'll
	  add documentation about this in the Developer's Guide as
	  appropriate.

2003-03-04 11:50  castaglia

	* NEWS, modules/mod_auth.c:
	  Added AnonRejectPasswords.

2003-03-04 11:28  castaglia

	* NEWS, include/scoreboard.h, modules/mod_auth.c,
	  modules/mod_auth_unix.c, src/main.c, src/scoreboard.c,
	  utils/ftpcount.c, utils/ftptop.c, utils/ftpwho.c,
	  utils/scoreboard.c, utils/utils.h:
	  Bug#1967: Add display of uptime to ftpwho, ftptop.

2003-03-04 11:24  castaglia

	* NEWS, contrib/mod_sql_mysql.c, include/version.h,
	  modules/mod_core.c:
	  Bugs 1828 and 1960.

2003-03-03 21:26  castaglia

	* ChangeLog:
	  Updating.

2003-03-03 21:25  castaglia

	* NEWS, include/version.h, contrib/dist/rpm/proftpd.spec:
	  Preparing for release of 1.2.8.

2003-03-03 18:58  castaglia

	* README.PAM:
	  Updating PAM information for FreeBSD.

2003-03-03 12:13  castaglia

	* README.mod_sql:
	  Updating.

2003-03-02 20:21  castaglia

	* src/inet.c:
	  Fixed #if check.

2003-03-02 18:21  castaglia

	* src/main.c:
	  Changing code back to its original setting; when doing the
	  modifications for mod_unixpw -> mod_auth_unix, this code was
	  incorrectly modified.

2003-03-02 16:42  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#1976 - Login hangs, spawned process runs in endless loop in
	  mod_auth.

2003-03-02 16:31  castaglia

	* NEWS, src/inet.c:
	  Adding FreeBSD-5.0 to the #defines for the socket/privs fun.

2003-03-01 10:41  castaglia

	* contrib/mod_tls.c:
	  Playing with logged messages...

2003-03-01 10:39  castaglia

	* contrib/mod_tls.c:
	  Bad grammar.

2003-03-01 10:31  castaglia

	* contrib/mod_tls.c:
	  Pedantic changes of "SSL" to "TLS" adding logging for when
	  mod_tls starts a TLS handshake on the data connection

2003-02-25 20:49  castaglia

	* src/inet.c:
	  Modify the use of ioctl() such that it will be used on platforms
	  known to use STREAMS (i.e. Solaris and IRIX, at present).

2003-02-25 20:30  castaglia

	* include/dirtree.h, src/dirtree.c:
	  Added pr_class_and_expression(), for symmetry (and yes, there are
	  cases where having a list of class names evaluated in a Boolean
	  AND fashion can be useful).

2003-02-25 11:00  castaglia

	* configure:
	  Updating configure script.

2003-02-25 10:56  castaglia

	* NEWS, config.h.in, configure.in, include/conf.h, lib/pr-syslog.c,
	  src/inet.c, src/netio.c:
	  Bug#1964 - When uploading to an NFS mounted file system in
	  passive mode read() get EAGAIN and closes connection.

2003-02-24 17:39  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#1937 - transfer hangs when using transferrate limits on a
	  resumed download.

2003-02-24 15:47  castaglia

	* modules/mod_xfer.c:
	  Cleanup of missed code for Bug#1970.

2003-02-24 10:39  castaglia

	* NEWS, modules/mod_xfer.c, utils/ftptop.c, utils/ftpwho.c:
	  Bug#1970 - Transfer time wraps around and causes problems with
	  transfer speed calculation.

2003-02-24 10:15  castaglia

	* modules/mod_ls.c:
	  Removing unused cruft.

2003-02-24 10:13  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#1953 - STAT -R does not work.

2003-02-24 08:06  castaglia

	* NEWS, src/inet.c:
	  Bug#1966 - SCO OpenServer 5.0.5 and inetd (not passive mode).

2003-02-23 18:37  castaglia

	* NEWS, modules/mod_log.c, src/dirtree.c:
	  Bug#1908 - ExtendedLog to work properly in <Anonymous> context.

2003-02-19 23:48  castaglia

	* NEWS, utils/ftpwho.c:
	  Bug#1958 - ftpwho -o oneline has newlines when client is idle.

2003-02-18 16:01  castaglia

	* modules/mod_xfer.c:
	  Minor variable name change; seems to collide with variable used
	  in Tru64 5.1b's headers.

2003-02-18 10:01  castaglia

	* configure:
	  Updating configure script.

2003-02-18 09:55  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_auth_unix.c,
	  modules/mod_ls.c:
	  Bug#1941 - SCO OpenServer 5.0.5

2003-02-18 00:16  castaglia

	* sample-configurations/basic.conf:
	  Adding some comments to the default config file.  Hopefully this
	  will stem some of the more common questions on the users mailing
	  list.

2003-02-17 17:45  jwm

	* configure:
	  update

2003-02-17 17:41  jwm

	* configure.in:
	  typo

2003-02-17 17:28  jwm

	* configure:
	  update

2003-02-17 17:25  jwm

	* configure.in:
	  expend as little effort as possible if mod_cap is explicitly
	  disabled

2003-02-17 15:41  castaglia

	* configure:
	  Updating configure script.

2003-02-17 15:40  castaglia

	* configure.in:
	  Add to output at end of configure --help instructions describing
	  LIBS environment variable.

2003-02-16 16:56  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#1956 - Upload transfer rate broken.

2003-02-14 07:47  castaglia

	* NEWS, contrib/mod_tls.c:
	  Added FTPS FEAT responses, as per the Draft.

2003-02-12 16:02  castaglia

	* modules/mod_xfer.c:
	  Helps if I get the variable names right...

2003-02-12 15:54  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#1948 - mod_xfer relinquishes privs before chmod takes place.

2003-02-12 11:03  castaglia

	* NEWS, include/log.h, modules/mod_xfer.c, src/data.c, src/log.c:
	  Bug#1916 - Transfers hang with strange transfertime in logfile.

2003-02-12 00:46  castaglia

	* src/netio.c, src/pool.c, src/sets.c, include/ident.h,
	  include/timers.h:
	  Adding more $Id: ChangeLog,v 1.145 2010/02/24 17:58:50 castaglia Exp $ keywords.

2003-02-11 23:34  castaglia

	* src/feat.c:
	  Added $Id: ChangeLog,v 1.145 2010/02/24 17:58:50 castaglia Exp $ keyword.

2003-02-10 15:34  castaglia

	* contrib/mod_sql.c, modules/mod_auth.c:
	  Add logging of the problem if an admin configured a valid shell
	  column in a SQL table, but the value of the shell in the table
	  was NULL.

2003-02-10 10:02  castaglia

	* NEWS, src/dirtree.c:
	  Bug#1952 - Umask Bug: Server Not Honoring VirtualHost Umask.

2003-02-10 08:53  castaglia

	* configure:
	  Updating configure script.

2003-02-10 08:51  castaglia

	* NEWS, aclocal.m4, configure.in, modules/mod_xfer.c:
	  Bug#1949 - Compiler warns of 'long double' usage on OSX.

2003-02-07 12:46  castaglia

	* README:
	  Add a line to the REAME pointing out the doc/ directory.  Not
	  that anyone will notice.  *sigh*

2003-02-06 08:40  castaglia

	* configure:
	  Updated configure script.

2003-02-06 08:38  castaglia

	* NEWS, aclocal.m4, config.h.in, configure.in,
	  modules/mod_auth_unix.c:
	  Bug#1950 - OSX setgrent(3) returns int, causing compiler warning.

2003-02-05 13:14  castaglia

	* include/privs.h:
	  Oops.  I said DEBUG9, but had DEBUG0.  Should've been DEBUG9 in
	  code.  Fixed.

2003-02-05 13:11  castaglia

	* include/privs.h:
	  Add debug output, level 9, for PRIVS macros when they are
	  disabled (will help cut down on confusion when proftpd is built
	  on Linux, and admins forget that mod_cap is now enabled by
	  default, and that mod_cap will disable id switching).

2003-02-01 10:11  castaglia

	* NEWS, include/glibc-glob.h:
	  Bug#1943 - Unable to install on FreeBSD 5.0.

2003-01-31 12:48  castaglia

	* configure:
	  Updating configure script.

2003-01-31 09:28  castaglia

	* configure.in:
	  Only check for the linux/capability.h header if mod_cap has not
	  already been explicitly disabled in the configure options.

2003-01-30 11:05  jwm

	* NEWS, configure, configure.in:
	  Bug 1863 - Unable to build under UnixWare 7

2003-01-30 08:15  castaglia

	* modules/mod_xfer.c:
	  Changed TransferRate handler to use strtod() rather than
	  strtoul() when parsing the kbps rate parameter.  strtold() would
	  be better...but FreeBSD doesn't seem to have strtold().  *sigh*

2003-01-29 18:11  castaglia

	* include/version.h:
	  Updating version.h for CVS status.

2003-01-29 17:25  jwm

	* Makefile.in:
	  build deps before we get rid of the Makefiles we need to generate
	  them :-)

2003-01-29 09:27  flyhmstr

	* doc/Configuration.html: ML: updated build of configuration.html

2003-01-29 07:25  castaglia

	* NEWS, include/version.h, contrib/dist/rpm/proftpd.spec:
	  Marking Bug#1911 fixed (I think the fix was committed when I was
	  working on Bug#1931).  Also updating the version and spec files,
	  preparing for rc2 release.

2003-01-28 14:00  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#1939 - RLimitMemory seems broken.

2003-01-25 12:51  castaglia

	* src/dirtree.c:
	  Michael noticed that the parse_config_file() function was failing
	  to close the opened configuration file handle, leaking
	  descriptors.	This started happening in 1.2.8rc1, with the
	  introduction of the FSIO patch.  Fixed.  Good catch, Michael!

2003-01-24 18:38  castaglia

	* NEWS, src/support.c:
	  Bug#1938 - upload to root directory fails.

2003-01-23 22:52  castaglia

	* contrib/mod_radius.c:
	  Fixed misordered parameters to pr_rehash_register_handler() call.

2003-01-23 15:25  castaglia

	* src/modules.c:
	  Actually check for a negative return value from the module
	  initialization callback, if one is provided, and report an error
	  if the initialization failed.  Previously, the code would only
	  check for a -1 return value, and would silently load the module
	  to the internal lists if the returned value was not -1; just as
	  silently would -1 returns be handled.

2003-01-22 21:48  castaglia

	* include/conf.h:
	  Wrapping _GNU_SOURCE definition in an #ifndef.  It's possible
	  that, depending on the CFLAGS options given, some other included
	  file may already define it, in which case the compiler will throw
	  an "already defined" warning.

2003-01-21 22:12  castaglia

	* modules/mod_ls.c:
	  As discovered when looking into Bug#1931, some of the response
	  codes used when handling NLST are not legal viz. RFC959.  This
	  patch changes the 550s to 450s.

2003-01-20 22:46  castaglia

	* src/inet.c:
	  Fixing inet_getname() so that, when doing reverse DNS checks, the
	  two related calls, gethostbyaddr() and gethostbyname(), don't
	  overwrite the same data.  This was happening under Tru64 Unix,
	  and could have happened under Linux.

2003-01-19 18:18  jwm

	* NEWS, modules/mod_auth.c:
	  Bug 1734 - Cygwin - Unable to set uid

2003-01-18 15:28  castaglia

	* Make.rules.in, NEWS, include/conf.h, include/mkhome.h,
	  modules/mod_auth.c, src/mkhome.c:
	  Bug#1241 - Additional functionality: HomedirOnDemand.  Added as
	  CreateHome directive.

2003-01-18 11:29  castaglia

	* configure:
	  Updating configure, again. =P

2003-01-18 11:26  castaglia

	* configure.in:
	  Argh.  John had it right the first time.  My mistake. =P

2003-01-18 11:23  castaglia

	* configure:
	  Updating configure script.

2003-01-18 11:19  castaglia

	* configure.in:
	  Changing check of UnixWare's libgen a little, to add -lgen to
	  LIBS if libgen is present.

2003-01-18 11:09  castaglia

	* config.h.in:
	  Adding HAVE_LIBGEN to config.h, corresponding to added
	  AC_CHECK_LIB(gen) in configure.in.

2003-01-17 22:06  castaglia

	* modules/mod_auth_file.c, src/auth.c:
	  Adding proper UID/GID->name translation to mod_auth_file.c

2003-01-17 18:33  castaglia

	* NEWS, modules/mod_auth_file.c:
	  Bug#1918 - AuthUserFile not works normally.

2003-01-17 16:13  castaglia

	* src/fsio.c:
	  Some of the FSIO routines are manually returning ENOENT, rather
	  than letting errno propagate up properly.

2003-01-17 13:47  castaglia

	* modules/mod_auth_file.c, modules/mod_core.c, src/modules.c:
	  Fixed broken pr_stash_remove_symbol() (AuthOrder still wasn't
	  working quite right).  Removed devel cruft from mod_auth_file,
	  and added some more debugging output to it.

2003-01-17 08:46  castaglia

	* NEWS, contrib/mod_ratio.c, contrib/mod_sql.c, include/dirtree.h,
	  include/modules.h, modules/mod_core.c, src/auth.c, src/main.c,
	  src/modules.c:
	  Bug#1926 - AuthOrder doesn't work.

	  Also did a lot of style cleanup along the way.

2003-01-16 19:41  castaglia

	* NEWS, utils/ftptop.1, utils/ftptop.c:
	  Adding displaying of transfer rates to ftptop.

2003-01-16 00:28  castaglia

	* Make.rules.in:
	  The patch for Bug#1904 added building of utils/misc.o for ftpwho
	  rather than ftptop.  ftptop may need it, but it doesn't link
	  against -lsupp, whereas ftpwho does.

2003-01-15 22:08  castaglia

	* src/regexp.c:
	  Missing Id keyword.

2003-01-15 18:04  castaglia

	* NEWS, contrib/mod_sql_mysql.c, include/support.h,
	  modules/mod_core.c, modules/mod_log.c, src/dirtree.c,
	  src/support.c, utils/misc.c:
	  Bug#1922 - Server allows RNTO an existing file even with
	  AllowOverwrite turned off

	  Some logging bugs in mod_log also corrected.

2003-01-13 21:22  castaglia

	* include/inet.h, src/data.c, src/inet.c, src/main.c:
	  Adding checking for, and logging of, errors when calling
	  setsockopt(2).

2003-01-13 20:43  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#1923 - %N magic cookie reports incorrectly.

2003-01-13 19:31  castaglia

	* NEWS, modules/mod_log.c:
	  Fixing problem with using %f for DELE logging, as mentioned on
	  -user.

2003-01-13 11:22  castaglia

	* NEWS:
	  Forgot to mention tcp{Receive,Send}Window fix in NEWS.

2003-01-13 11:20  castaglia

	* src/data.c:
	  Fixing the timing of setting of socket options.  The
	  tcpReceiveWindow and tcpSendWindow configuration directives were
	  not taking effect properly because setsockopt(2) was being
	  called, for the data connection, _after_ the TCP handshake was
	  done.  As it is during the handshake when such things as window
	  sizes are negotiated, this timing rendered any configuration
	  settings useless.

2003-01-13 10:25  castaglia

	* src/main.c:
	  As John pointed out, it's better to have run-time generated
	  files, much like coredumps, to be under RUN_DIR
	  (/var/run/proftpd), or CORE_DIR (although CORE_DIR is #defined to
	  be RUN_DIR).	So now, the profiling gmon.out and bb.out files
	  will be found there, rather than /tmp.

	  Thanks, John! =)

2003-01-12 21:38  castaglia

	* Make.rules.in, modules/mod_core.c, src/main.c:
	  Added DEVEL_NO_DAEMON define, and changed other DEBUG_* defines
	  to match.  The purpose for these is to be able to build a proftpd
	  daemon that can be profiled.	Now, one can have a configure
	  statement such as:

	    CFLAGS="-DDEVEL_NO_DAEMON -DDEVEL_NO_FORK -g -pg -a" \
	      LIBS="-pg" ./configure ...

	  The resulting daemon will only handle one session.  The bb.out
	  and gmon.out profiling files will be written to /tmp.

2003-01-12 21:17  castaglia

	* configure:
	  Updating configure script.

2003-01-12 20:31  castaglia

	* configure.in:
	  Removing -Wfloat-equal, for now.  This warning flag was
	  introduced with gcc-3.0, and so we'll need to check the gcc
	  version being used (if indeed it is gcc being used) before using
	  this flag.

2003-01-12 20:25  castaglia

	* modules/mod_xfer.c:
	  Floating point numbers are best compared using greater/less than,
	  not equals.  Thanks to Steve Grubb for pointing this out.

2003-01-12 20:21  jwm

	* NEWS:
	  Add -Wundef and -Wfloat-equal to CFLAGS (Suggested by Steve Grubb
	  <linux_4ever@yahoo.com>)

2003-01-12 20:16  jwm

	* configure:
	  update with autoconf 2.57; I'm curious if this changes the LFS
	  problems I'm currently working on

2003-01-12 20:15  castaglia

	* configure.in:
	  Add -Wfloat-equal and -Wundef to the warning flags enabled by
	  using the --enable-devel configure option.

2003-01-12 20:09  jwm

	* configure:
	  update

2003-01-12 17:27  castaglia

	* NEWS, modules/mod_core.c, src/main.c:
	  Bug#1910 - ProFTPD hangs on SIGHUP.

2003-01-10 16:26  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#1919 - <Directory> section already configured for $dir needs
	  clarification.

2003-01-08 20:28  jwm

	* configure:
	  update

2003-01-08 20:27  jwm

	* modules/mod_cap.c:
	  EnableCapabilities -> CapabilitiesSet

2003-01-08 20:25  jwm

	* README.capabilities, configure.in:
	  OS-neutrality

2003-01-08 12:44  castaglia

	* contrib/mod_radius.c:
	  Corrected typo in session accouting variables.  Bumped version
	  number.

2003-01-07 16:12  castaglia

	* NEWS, lib/pr-syslog.c:
	  Bug#1891 - SGI syslog isn't being written to.

2003-01-07 10:45  castaglia

	* contrib/mod_radius.c:
	  Use cmd->arg, rather than cmd->argv[1], from the C_PASS command.

2003-01-07 09:30  castaglia

	* modules/mod_core.c, src/timers.c:
	  Correcting minor bugs.

2003-01-07 09:14  castaglia

	* configure:
	  Updated configure script.

2003-01-07 09:05  castaglia

	* configure.in:
	  Add enable/disable configure option, for excluding mod_cap from
	  Linux builds, for those sites that wish to have minimalist builds
	  (e.g. every automatic inclusion should have an optional switch
	  for disabling that inclusion).

2003-01-05 09:33  jwm

	* NEWS:
	  style nit

2003-01-04 20:00  jwm

	* NEWS, Make.rules.in:
	  Bug 1904 - Tru64 UNIX 4.0D and sstrncpy()

2003-01-04 19:48  jwm

	* modules/glue.sh:
	  style

2003-01-04 19:48  jwm

	* configure:
	  update

2003-01-04 19:47  jwm

	* Make.modules.in, Make.rules.in, Makefile.in, NEWS, configure.in,
	  lib/Makefile.in, modules/Makefile.in, src/Makefile.in,
	  utils/Makefile.in:
	  Bug 1826 - Makefiles are a bit icky. This gives the build system
	  a nice tidying up; I don't seem to have broken anything.

	  The only noticable change is that the dist/distclean/cvsclean
	  targets have been cleaned up:

	  cvsclean: is no more. Use distclean instead.	distclean: return
	  the source tree to its pristine condition (don't touch
	  CVS state directories).  dist: prepare the source tree for
	  distribution. Move the RPM spec file	     into place and blow
	  away any CVS state directories.

2003-01-04 18:26  jwm

	* config.guess, config.sub:
	  part of Bug 1826 - Makefiles are a bit icky: updated
	  config.{guess,sub}

2003-01-04 18:20  jwm

	* Makefile.in:
	  Part of #1826 - ftptop doesn't need to link against $(LIBS)

2003-01-04 18:19  jwm

	* configure:
	  update

2003-01-04 18:18  jwm

	* NEWS:
	  credit for #1893

2003-01-04 18:18  jwm

	* NEWS, configure.in:
	  Bug 1893 - Apple likes to move things

2003-01-04 17:29  jwm

	* modules/mod_auth.c, modules/mod_auth_file.c, modules/mod_core.c,
	  modules/mod_ls.c, modules/mod_site.c, lib/glibc-mkstemp.c,
	  lib/pr-syslog.c, lib/pwgrent.c, lib/strsep.c, lib/vsnprintf.c,
	  utils/ftpcount.c, utils/ftpshut.c, utils/ftptop.c,
	  utils/ftpwho.c, utils/misc.c, utils/scoreboard.c:
	  nuke trailing whitespace

2003-01-02 20:31  jwm

	* NEWS:
	  credit where credit is due

2003-01-02 20:16  jwm

	* src/: Makefile.in, utils.c:
	  utils.c doesn't seem to be needed anymore...

2003-01-02 20:00  jwm

	* NEWS:
	  mod_cap announcement

2003-01-02 19:53  jwm

	* README.capabilities, README.linux-privs,
	  contrib/dist/rpm/proftpd.spec:
	  mod_linuxprivs -> mod_cap

2003-01-02 19:50  jwm

	* README.modules:
	  mod_linuxprivs is now the official module mod_cap

2003-01-02 19:47  jwm

	* contrib/dist/rpm/proftpd.spec:
	  we don't have to explicitly include mod_linuxprivs anymore;
	  mod_cap will be included automatically

2003-01-02 19:44  jwm

	* configure:
	  update

2003-01-02 19:43  jwm

	* config.h.in, configure.in, modules/mod_cap.c:
	  fix the build :-) This now autodetects and cleanly builds mod_cap
	  into proftpd if the host OS (Linux) supports it

2003-01-02 19:09  jwm

	* configure:
	  update

2003-01-02 19:08  jwm

	* config.h.in, configure.in:
	  fixing linux/capability.h detection

2003-01-02 19:03  jwm

	* configure:
	  update

2003-01-02 19:02  jwm

	* modules/mod_cap.c:
	  removing debugging cruft

2003-01-02 19:02  jwm

	* configure.in, modules/mod_cap.c:
	  removing last Linux-specific bits of mod_cap

2003-01-02 18:47  jwm

	* modules/mod_cap.c:
	  getting rid of some linux references

2003-01-02 18:39  jwm

	* configure:
	  update

2003-01-02 18:36  jwm

	* configure.in, contrib/README, modules/mod_cap.c:
	  mod_linuxprivs -> mod_cap

2003-01-02 18:16  jwm

	* README.linux-privs, configure.in, contrib/mod_linuxprivs.c,
	  contrib/mod_linuxprivs.html, lib/libcap/.cvsignore,
	  lib/libcap/Makefile, lib/libcap/_makenames.c,
	  lib/libcap/cap_alloc.c, lib/libcap/cap_extint.c,
	  lib/libcap/cap_file.c, lib/libcap/cap_flag.c,
	  lib/libcap/cap_proc.c, lib/libcap/cap_sys.c,
	  lib/libcap/cap_text.c, lib/libcap/libcap.h,
	  lib/libcap/include/sys/capability.h:
	  Turning mod_linuxprivs into a core module, mod_cap. This is by no
	  means complete.

2003-01-02 13:09  castaglia

	* contrib/mod_sql.c:
	  Added handling of %U to mod_sql, so that it can be used in
	  SQLNamedQuery directives; part of the addition of Bug#1482.

2003-01-02 10:53  jwm

	* doc/license.txt:
	  update copyright year

2003-01-02 10:27  castaglia

	* configure:
	  Updated configure script.

2003-01-02 10:25  castaglia

	* config.h.in, configure.in, contrib/mod_linuxprivs.c,
	  contrib/mod_radius.c, contrib/mod_rewrite.c, contrib/mod_sql.c,
	  contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c,
	  contrib/mod_tls.c, include/data.h, include/ident.h,
	  include/pool.h, include/proftpd.h, include/response.h,
	  include/support.h, modules/mod_auth.c, modules/mod_auth_pam.c,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_xfer.c, src/bindings.c, src/data.c, src/ident.c,
	  src/inet.c, src/main.c, src/netio.c, src/pool.c, src/regexp.c,
	  src/response.c, src/scoreboard.c, src/support.c, src/timers.c,
	  src/utils.c:
	  More namespace/API changes, for consistency:

	    data_*() -> pr_data_*()
	    register_rehash() ->  pr_rehash_register_handler()
	    add_exit_handler() -> pr_exit_register_handler()
	    (un)block_alarms() -> pr_alarms_(un)block()
	    (un)block_signals() -> pr_signals_(un)block()
	    pr_handle_signals() -> pr_signals_handle()

	  The distinction for which I am striving is to have all the
	  functions that module developers should use to be prefixed with
	  pr_; public functions may be available without a pr_ prefix, but
	  such functions will be intended for use by the core code only.

	  Also, more in the RFC2228 support department:

	    session_t has a new field, rfc2228_mech.  This is to be filled
	  in by
	    the RFC2228 module that handles an AUTH command, so that other
	    RFC2228 modules, should they be higher in the module load
	  order, know
	    not to process RFC2228 commands meant for the handling module.

	    The response formatting callback function now takes an
	  additional
	    parameter, a pool pointer, as the first argument.  The pool
	  that will
	    be passed to that function will be the same pool used by the
	  other
	    response functions.

2003-01-02 09:28  castaglia

	* configure.in, contrib/ftpasswd, contrib/mod_radius.c,
	  contrib/mod_readme.c, contrib/mod_rewrite.c, contrib/mod_tls.c,
	  contrib/mod_wrap.c, doc/mod_sample.c, include/bindings.h,
	  include/conf.h, include/data.h, include/default_paths.h,
	  include/dirtree.h, include/feat.h, include/fsio.h, include/ftp.h,
	  include/ident.h, include/inet.h, include/libsupp.h,
	  include/log.h, include/modules.h, include/netio.h,
	  include/options.h, include/pool.h, include/pr-syslog.h,
	  include/privs.h, include/proftpd.h, include/regexp.h,
	  include/response.h, include/scoreboard.h, include/sets.h,
	  include/support.h, include/timers.h, modules/mod_auth.c,
	  modules/mod_auth_file.c, modules/mod_auth_unix.c,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_site.c, modules/mod_xfer.c, src/auth.c,
	  src/bindings.c, src/data.c, src/dirtree.c, src/feat.c,
	  src/fsio.c, src/ident.c, src/inet.c, src/log.c, src/main.c,
	  src/modules.c, src/netio.c, src/pool.c, src/proftpd.8,
	  src/regexp.c, src/response.c, src/scoreboard.c, src/sets.c,
	  src/support.c, src/timers.c, src/utils.c, src/xferlog.5,
	  utils/ftpcount.1, utils/ftpcount.c, utils/ftpshut.c,
	  utils/ftptop.c, utils/ftpwho.1, utils/ftpwho.c, utils/misc.c,
	  utils/scoreboard.c, utils/utils.h:
	  Updating the copyright notice in the file headers for the new
	  year.

2003-01-02 08:31  castaglia

	* Makefile.in, utils/ftptop.1:
	  Adding man page for ftptop.

2003-01-01 16:37  jwm

	* contrib/mod_linuxprivs.c:
	  the docs say to use the full capability name: CAP_CHOWN

2002-12-31 17:24  castaglia

	* NEWS, contrib/mod_sql.c, contrib/mod_sql.h,
	  contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c:
	  Bug#1671 - new directive SQLLogFile.

2002-12-31 16:35  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#1272 - Requested Addition: DenyFilter by User or DenyFilter
	  by Directory.

2002-12-31 14:35  castaglia

	* utils/ftptop.c:
	  Actually calculate and display the TIME value (duration of
	  session, in seconds).

2002-12-31 13:18  castaglia

	* src/main.c:
	  Make sure that the configuration file specified using the -c
	  command-line option is an absolute path.  Bug noted by Michael
	  Renner.

2002-12-31 12:05  castaglia

	* NEWS, src/fsio.c:
	  Bug#1894 - Double chdir into self-referencing symlink fails with
	  "No such file or directory".

2002-12-31 12:00  castaglia

	* include/scoreboard.h, modules/mod_auth.c, src/scoreboard.c,
	  utils/ftptop.c, utils/ftpwho.c, utils/utils.h:
	  Portion of changes requested in Bug#1794.

2002-12-30 16:37  castaglia

	* modules/mod_auth.c:
	  Yet another missing word ("the").

2002-12-30 16:35  castaglia

	* modules/mod_auth.c:
	  Missing "of" in message string (noted by Michael).

2002-12-28 12:52  castaglia

	* contrib/mod_linuxprivs.html:
	  Forgot to add documentation for the mod_linuxprivs directives
	  before releasing 1.2.8rc1.  With this file, the
	  README.linux-privs doc can probably be retired.

2002-12-28 12:51  castaglia

	* include/version.h:
	  Updating version for CVS.

2002-12-28 10:23  castaglia

	* ChangeLog, NEWS, contrib/dist/rpm/proftpd.spec,
	  include/version.h:
	  Preparing for 1.2.8rc1 release.

2002-12-27 09:23  castaglia

	* configure:
	  Updating configure script.

2002-12-27 09:21  castaglia

	* NEWS, configure.in:
	  Bug#1906 - Add description strings to AC_DEFINE

2002-12-27 08:27  jwm

	* NEWS:
	  style, date formatting

2002-12-27 08:21  jwm

	* src/: auth.c, data.c, dirtree.c, inet.c, log.c, main.c,
	  modules.c, pool.c, support.c, timers.c:
	  style

2002-12-27 08:13  jwm

	* NEWS:
	  whitespace cleanup

2002-12-27 08:12  jwm

	* configure:
	  update

2002-12-27 08:08  jwm

	* NEWS, configure.in:
	  Bug 1863 - Unable to build under UnixWare 7

2002-12-27 08:04  jwm

	* Makefile.in, NEWS:
	  Bug 1903 - ftpwho depends on snprintf but doesn't link in
	  lib/libsupp.a

2002-12-27 07:47  jwm

	* NEWS, src/timers.c, utils/ftptop.c:
	  Bug 1905 - AIX needs "config.h" included before *anything* else.

2002-12-26 18:36  castaglia

	* src/main.c:
	  Removing the internal_abort() code, which was only enabled by
	  using the --enable-devel switch.  It's more useful to use gdb in
	  this case.

2002-12-26 17:25  jwm

	* contrib/README:
	  cruft removal, cleanup, style, grammar

2002-12-26 17:05  castaglia

	* NEWS, contrib/mod_linuxprivs.c:
	  Bug#1888: Increase mod_linuxprivs configurability.

2002-12-26 16:52  castaglia

	* src/main.c:
	  Change the reporting of "Invalid argument" when deleting a
	  scoreboard slot to be DEBUG1.  This message can appear for
	  reasons other than scoreboard issues (e.g. a module bars a client
	  from completely connecting, misconfigurations, etc).

2002-12-26 14:26  jwm

	* modules/mod_auth_file.c:
	  silence compiler warning about crypt()

2002-12-26 12:18  castaglia

	* NEWS, utils/ftpwho.c:
	  Bug#1900 - ftpwho's output on uploads.

2002-12-26 11:45  castaglia

	* modules/mod_xfer.c:
	  Add debug call when failing to open a file for writing/uploading.
	  This should help pinpoint upload failures.

2002-12-20 12:20  castaglia

	* modules/: mod_auth_file.c, mod_core.c, mod_xfer.c:
	  Style cleanups.

2002-12-19 13:53  castaglia

	* configure:
	  Updating configure script.

2002-12-19 13:52  castaglia

	* modules/mod_auth_file.c:
	  Putting the copyright in the project's name.

2002-12-19 13:47  castaglia

	* NEWS:
	  Forgot to update NEWS with description of Bug#1837/mod_auth_file
	  addition.

2002-12-19 13:45  castaglia

	* config.h.in, configure.in, modules/mod_auth_file.c,
	  modules/mod_auth_pam.c, modules/mod_auth_unix.c,
	  modules/mod_core.c, modules/mod_pam.c, modules/mod_unixpw.c,
	  src/main.c:
	  Bug#1837 - Add module specifically for handling Auth*Files,
	  providing finer-grained control.  This patch also renames
	  mod_unixpw.c to mod_auth_unix.c, and mod_pam.c to mod_auth_pam.c.
	  Configure options have --disable-auth-file, --disable-auth-unix,
	  --enable-auth-pam, as appropriate.

2002-12-19 13:20  castaglia

	* contrib/: mod_sql.c, mod_sql_mysql.c, mod_sql_postgres.c,
	  mod_tls.c:
	  Cleaning up some warnings, seen under --enable-devel, in some
	  contrib modules.  Pointed out by Michael.

	  Just to note: a lot of the warnings generated by mod_tls
	  (specifically, by the OpenSSL files #include'd by mod_tls) cannot
	  be fixed by us.  Quite a few of the warnings are about function
	  prototypes; the OpenSSL developers don't have complete prototype
	  declarations for a lot of the function pointer callback struct
	  slots.  Oh well.

2002-12-19 13:02  castaglia

	* src/dirtree.c:
	  In tracking down an unrelated bug last night, I discovered that,
	  at present, proftpd's parser will gladly handle empty contexts,
	  such as when:

	    <Directory blah>
	    </Directory>

	  or

	    <Global>
	    </Global>

	  appear in the configuration file.  These empty sets are useless,
	  and serve only to use up memory unnecessarily; that memory usage
	  is compounded when directives are merged down into these sets.

	  This patch checks for such empty contexts (in end_sub_config()),
	  and removes them from the configuration tree.

2002-12-19 10:32  castaglia

	* contrib/mod_tls.c:
	  Forgot a parameter to tls_log().

2002-12-19 10:26  castaglia

	* contrib/mod_tls.c:
	  Change handling of PROT in tls_prot() slightly.

2002-12-19 09:51  castaglia

	* contrib/mod_tls.c:
	  More instances where mod_tls was being impolite, and returning
	  ERROR where it should be returning DECLINED, in order to allow
	  other modules a chance at handling some of the RFC2228 commands.

2002-12-19 09:45  castaglia

	* contrib/mod_tls.c:
	  Changed mod_tls' handling of AUTH command to allow other RFC2228
	  modules a change at processing that command.

2002-12-19 09:28  castaglia

	* modules/mod_ls.c, src/dirtree.c, src/main.c:
	  Minor style/formatting changes.

2002-12-18 12:12  castaglia

	* configure:
	  Updating configure script.

2002-12-18 12:09  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_unixpw.c:
	  Bug#1667 - Integrate ProFTPD with C2/SIA on Tru64 Unix.

2002-12-18 10:27  castaglia

	* contrib/: mod_radius.c, mod_radius.html:
	  Fixing several bugs in mod_radius' accounting code.

2002-12-17 19:03  jwm

	* src/proftpd.8: forgot to update the man page for Bug 1885

2002-12-17 18:59  jwm

	* NEWS, src/main.c: Bug 1885 - -q/--quiet option for use with the
	  -n/--nodaemon flag. Useful for running proftpd from inittab or
	  with daemontools.

2002-12-17 15:11  castaglia

	* modules/mod_auth.c:
	  The cleanup of variable names done by the adding of the
	  --enable-devel option caused a problem here, where a variable "c"
	  was used a little too often, causing MaxClients/MaxHosts* lookups
	  to fail.  Thanks to Michael Renner for the help in tracking this
	  one down.

2002-12-17 08:06  castaglia

	* include/modules.h, include/privs.h, src/main.c, src/modules.c:
	  The module init dispatch functions aren't public, and hence do
	  not need the pr_ prefix.

	  Change the debug level for privs changes to 9 (was 8).

2002-12-17 07:18  jwm

	* include/: conf.h, data.h, default_paths.h, dirtree.h, ftp.h,
	  ident.h, inet.h, libsupp.h, modules.h, netio.h, options.h,
	  privs.h, proftpd.h, sets.h: nuke trailing whitespace

2002-12-16 17:52  castaglia

	* modules/mod_core.c:
	  Add the RFC2228 commands to the HELP output, but listed as "not
	  supported".  A means for RFC2228 modules (e.g. mod_tls, mod_gss)
	  to change the supported flag from FALSE to TRUE for these
	  commands is needed.

2002-12-16 17:12  castaglia

	* modules/mod_core.c:
	  Oops.  Not quite ready to commit these changes yet.

2002-12-16 17:06  castaglia

	* contrib/mod_rewrite.c, modules/mod_core.c, modules/mod_ls.c,
	  src/dirtree.c, src/support.c, utils/ftpcount.c, utils/ftptop.c,
	  utils/ftpwho.c:
	  Changed some buffers to use PR_TUNABLE_BUFFER_SIZE (and not to
	  use hardcoded numbers).

2002-12-16 11:07  castaglia

	* include/modules.h:
	  Returning ERROR from an auth handler (specifically, in an "auth"
	  or a "check" auth handler) will not produce the desired result;
	  the ERROR macro sets a value of 1, and the switch() case in
	  mod_auth looks for negative values.  So, to handle this case,
	  I've added PR_AUTH_ERROR return value (-1) for auth handlers that
	  encounter errors, and adjusted the other PR_AUTH_* values
	  accordingly.

2002-12-16 10:45  castaglia

	* include/modules.h, src/main.c:
	  Make the function for dispatching commands a public function:
	  pr_cmd_dispatch().  Some RFC2228 modules may need to "unwrap"
	  encrypted commands and then dispatch the unwrapped commands
	  themselves.  (This also allows for greater games to be played by
	  third-party modules...muahahaha...) *grin*

2002-12-16 10:38  castaglia

	* src/main.c:
	  Changing buffer used for storing commands read in from client to
	  be of PR_TUNABLE_BUFFER_SIZE, rather than hardcoded to 1024.

2002-12-16 07:15  jwm

	* src/main.c: er, yeah. pointer and all that.

2002-12-16 07:12  jwm

	* src/main.c: cleanup

2002-12-15 10:08  jwm

	* configure: updated configure

2002-12-15 10:05  jwm

	* NEWS, acconfig.h, config.h.in, configure.in, src/inet.c: Bug 1883
	  - socklen_t patch. Thanks to Andy Igoshin <ai@vsu.ru> for the
	  patch.

2002-12-13 11:33  castaglia

	* src/: dirtree.c, fsio.c, inet.c, modules.c:
	  Being pedantic, and making sure that pcalloc() is used, to make
	  sure that memory is zeroed before use (helps to cut down on heap
	  bugs).

2002-12-13 11:13  castaglia

	* utils/ftpwho.c:
	  Correcting placement of newline (from Bug#1886).

2002-12-13 09:25  castaglia

	* Make.rules.in, contrib/mod_ratio.c, contrib/mod_readme.c,
	  contrib/mod_sql.c, contrib/mod_tls.c, doc/mod_sample.c,
	  include/conf.h, include/dirtree.h, include/proftpd.h,
	  include/response.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_log.c, modules/mod_ls.c, modules/mod_site.c,
	  modules/mod_xfer.c, src/data.c, src/main.c, src/response.c:
	  Reworking of response functions.

2002-12-12 11:57  castaglia

	* NEWS, contrib/mod_radius.c:
	  Bug#1875 - same radius packet id for start- and stop-accounting
	  record.

2002-12-12 11:56  jwm

	* utils/ftptop.c: make the display a bit prettier and make the best
	  use of an 80-column screen

2002-12-12 10:17  castaglia

	* NEWS, utils/ftpwho.c:
	  Bug#1886 - Ftpwho uses too many lines when authenticating.

2002-12-12 10:01  castaglia

	* include/options.h, lib/glibc-glob.c:
	  These changes make it possible to tune the maximum number of
	  recursion levels supported when globbing.  A better way of
	  dealing with possible DoS attacks via globbing is via the RLimit*
	  directives, or to disable globbing support altogether by using
	  the UseGlobbing directive.  However, in some cases it may be
	  necessary to support globbing, but to do so in as restrictive a
	  manner as possible.

	  The default maximum number of levels supported by GNU's globbing
	  is 8.  This patch keeps that default, but allows the
	  administrator, if need be, to tune that level lower by means of
	  the PR_TUNABLE_GLOBBING_MAX macro, defined in include/options.h.
	  When compiling proftpd, it can be defined to some lower value,
	  e.g.:

	    CFLAGS="-DPR_TUNABLE_GLOBBING_MAX=2" ./configure ...

2002-12-12 09:05  castaglia

	* include/modules.h:
	  Set PR_AUTH_RFC2228_OK to be 2, to avoid the value 1 (that is
	  used by the ERROR macro).

2002-12-12 08:24  castaglia

	* contrib/mod_tls.c, include/netio.h, src/netio.c:
	  Added a shutdown callback to the NetIO API, allowed netio modules
	  (e.g.  mod_gss) to perform a shutdown as they needed, rather than
	  simply calling shutdown(2).

2002-12-12 07:41  jwm

	* modules/mod_auth.c: typo Noticed by: Mihai RUSU <dizzy@roedu.net>

2002-12-11 15:35  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#1881 - Bug in Function MaxClients.

2002-12-11 15:33  castaglia

	* modules/mod_auth.c, modules/mod_core.c, src/support.c:
	  Some of these files' handling of configuration parameters was not
	  thorough with respect to get_param_int() to get_param_ptr()
	  changes (shame on me), and it was causing a segfault when
	  handling some Display* files.

2002-12-11 15:28  castaglia

	* contrib/mod_wrap.c, include/dirtree.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_xfer.c, src/dirtree.c:
	  Forgot to prefix the expression functions with pr_.

2002-12-11 15:17  castaglia

	* NEWS, modules/mod_site.c:
	  Bug#1882 - SITE chmod 777 file<space>name.

2002-12-11 08:49  castaglia

	* NEWS, contrib/mod_wrap.c, include/dirtree.h, include/modules.h,
	  modules/mod_auth.c, modules/mod_core.c, modules/mod_site.c,
	  modules/mod_xfer.c, src/dirtree.c:
	  Bug#1507 - regex pattern matching in [Allow/Deny][User/Group].
	  This patch also adjusts the handling of user- and
	  class-expressions, so that they are evaluated as OR expression,
	  rather than as AND expression (AND evaluation for users and
	  classes do not make sense).

2002-12-10 17:09  jwm

	* doc/: Configuration.html, Configuration.sgml: updated docs

2002-12-10 13:15  castaglia

	* configure:
	  Updating configure script.

2002-12-10 13:12  castaglia

	* configure.in:
	  Forgot a comma.

2002-12-10 13:05  castaglia

	* configure:
	  Updating configure script.

2002-12-10 13:01  castaglia

	* Makefile.in, NEWS, config.h.in, configure.in, include/dirtree.h,
	  include/fsio.h, include/libsupp.h, include/log.h,
	  include/modules.h, include/netio.h, include/pool.h,
	  include/support.h, include/timers.h, lib/glibc-glob.c,
	  lib/glibc-mkstemp.c, lib/pr_fnmatch.c, lib/vsnprintf.c,
	  modules/mod_auth.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_site.c, modules/mod_unixpw.c, modules/mod_xfer.c,
	  src/bindings.c, src/dirtree.c, src/fsio.c, src/inet.c, src/log.c,
	  src/main.c, src/modules.c, src/netio.c, src/regexp.c,
	  src/scoreboard.c, src/sets.c, src/support.c, utils/ftpwho.c,
	  utils/utils.h:
	  This patch adds an --enable-devel configure option, which does
	  the following:

	    install won't use -s, so that object files aren't stripped
	    core dumps should be allowed (although I'm having trouble
	  producing
	      them...I'm sure I'm missing something obvious)
	    CFLAGS is changed to use quite a few of the -W options

	  The rest of the patch is code cleanup, fixing things brought to
	  light by the -W options.  The one remaining warning is about the
	  K&R style pam function in mod_pam.c -- I think that may be
	  required.

2002-12-10 10:14  castaglia

	* configure:
	  Updating configure script.

2002-12-10 07:16  castaglia

	* NEWS, modules/mod_core.c, src/main.c:
	  Bug#1858 - move "session closed" logging from graceful quit to
	  child exit sequence.

2002-12-09 06:39  jwm

	* lib/vsnprintf.c: silence compiler warning

2002-12-09 06:38  jwm

	* lib/vsnprintf.c: style

2002-12-09 06:37  jwm

	* lib/vsnprintf.c: need ctype.h for is*()

2002-12-09 06:36  jwm

	* lib/pr_fnmatch_loop.c: need to include ctype.h for is*()

2002-12-08 08:57  jwm

	* modules/mod_unixpw.c: style

2002-12-07 14:09  jwm

	* NEWS: credit where credit is due

2002-12-07 14:02  jwm

	* src/dirtree.c, src/main.c, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_pam.c, modules/mod_site.c, modules/mod_unixpw.c,
	  src/auth.c, src/inet.c, src/modules.c, src/pool.c, src/sets.c,
	  src/support.c, src/utils.c: style

2002-12-07 13:57  jwm

	* NEWS, acconfig.h, config.h.in, configure.in, include/data.h,
	  src/data.c: AIX sendfile support

2002-12-07 13:50  jwm

	* contrib/dist/rpm/proftpd.init.d: * add /usr/local/sbin/ to $PATH
	  * don't assume ftpshut is in /usr/sbin/, let the shell's PATH
	  figure it out * style

2002-12-07 13:45  jwm

	* src/: auth.c, bindings.c, data.c, dirtree.c, feat.c, fsio.c,
	  ident.c, inet.c, log.c, main.c, modules.c, netio.c, pool.c,
	  regexp.c, scoreboard.c, sets.c, support.c, timers.c, utils.c:
	  style

2002-12-07 13:43  jwm

	* modules/: mod_auth.c, mod_core.c, mod_log.c, mod_ls.c, mod_pam.c,
	  mod_site.c, mod_unixpw.c, mod_xfer.c: nuke trailing whitespace,
	  style

2002-12-07 13:25  jwm

	* src/bindings.c: trailing whitespace

2002-12-07 13:21  castaglia

	* modules/mod_xfer.c:
	  Inadvertently changed the default handling of
	  AllowRetrieveRestart in the get_param_int() -> get_param_ptr()
	  changes.

2002-12-07 13:12  castaglia

	* NEWS, contrib/mod_tls.c, include/log.h, modules/mod_core.c,
	  modules/mod_log.c, src/log.c, src/main.c:
	  Bug#1515 - Enable mod_log to log into default log / syslog.

2002-12-07 08:29  jwm

	* src/bindings.c: Fix bidings for DefaultServer-affected and
	  localhost connections.

	  pr_ipbind_get_server() would never find the default server
	  because it was hashing an address (say, 127.0.0.1) different from
	  the address used by the main server (0.0.0.0). Instead, store a
	  pointer to the default and localhost bindings and fall back to
	  them if the explicit lookup fails.

2002-12-06 18:38  castaglia

	* src/dirtree.c:
	  Removing a get_param_int() that crept back in (probably from the
	  Bindings patch).

2002-12-06 16:48  castaglia

	* Make.rules.in, NEWS, include/bindings.h, include/conf.h,
	  include/dirtree.h, include/inet.h, modules/mod_core.c,
	  src/bindings.c, src/dirtree.c, src/main.c:
	  Committing the Bindings API.

2002-12-06 15:45  castaglia

	* include/ftp.h, include/proftpd.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_ls.c, modules/mod_xfer.c,
	  src/data.c, src/main.c:
	  More RFC2228 support.

2002-12-06 15:13  castaglia

	* modules/: mod_core.c, mod_xfer.c:
	  Provide configuration handlers that remark on deprecated
	  directives, rather than simply having those directives removed
	  (for now).

2002-12-06 15:08  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#1789 - Add ability to block recursive directory listings.

2002-12-06 13:43  jwm

	* include/proftpd.h:
	  tabs -> spaces

2002-12-06 13:37  castaglia

	* src/fsio.c:
	  *sigh* One of these days I'll get this correct. =P

2002-12-06 13:32  castaglia

	* src/fsio.c:
	  The FS API patch had some of the older, broken code w.r.t BSD and
	  statfs().

2002-12-06 13:25  castaglia

	* NEWS, include/scoreboard.h, modules/mod_xfer.c, src/scoreboard.c,
	  utils/ftpwho.c, utils/utils.h:
	  Committing TransferRate patch to CVS.

2002-12-06 13:04  castaglia

	* contrib/mod_radius.c, contrib/mod_sql.c, include/proftpd.h,
	  modules/mod_auth.c, modules/mod_core.c, modules/mod_log.c,
	  modules/mod_ls.c, modules/mod_site.c, modules/mod_xfer.c,
	  src/data.c, src/dirtree.c, src/inet.c, src/log.c, src/main.c:
	  A stack of changes, related to removing get_param_int() from the
	  core code, in favor of get_param_ptr().  I tried to test each
	  affected directive as I went, but, of course, there may be bugs
	  still lingering...

2002-12-06 07:49  castaglia

	* contrib/mod_sql.c:
	  Removed erroneous/extraneous #include "fs.h"

2002-12-05 18:41  jwm

	* lib/pwgrent.c:
	  fix the build (PR_LOG_ERR isn't defined here because this is in
	  libsupp)

2002-12-05 17:03  castaglia

	* modules/mod_log.c:
	  Use C_* command macros.

2002-12-05 16:50  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#1605 - MKD and RMD do not log filepaths with %f or %F option
	  in ExtendedLog.

2002-12-05 15:38  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#1403 - per-server system logs via ServerLog directive.

2002-12-05 15:16  castaglia

	* NEWS, contrib/mod_rewrite.c, contrib/mod_rewrite.html:
	  Adding mod_rewrite to the mix.

2002-12-05 14:53  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#1205 - Add debug option to SystemLog.

2002-12-05 14:47  castaglia

	* NEWS, include/modules.h, include/options.h, modules/mod_core.c,
	  src/main.c, src/modules.c:
	  Bug#1788 - Add ability to configure auth module checking order.

2002-12-05 14:16  castaglia

	* configure:
	  Updated configure script.

2002-12-05 14:13  castaglia

	* configure.in:
	  Update configure.in to use AC_HELP_STRING macro for
	  pretty-printing of --enable and --with options.

2002-12-05 13:57  castaglia

	* NEWS:
	  Adding thanks (well deserved!) to Peter Runestig for his work on
	  mod_tls.

2002-12-05 13:46  castaglia

	* NEWS, contrib/mod_tls.c, contrib/mod_tls.html,
	  doc/rfc/draft-murray-auth-ftp-ssl-10.txt:
	  Bug#1712 - TLS support.

2002-12-05 13:16  castaglia

	* Make.rules.in, NEWS, contrib/mod_ldap.c, contrib/mod_ratio.c,
	  contrib/mod_readme.c, contrib/mod_sql.c, contrib/mod_wrap.c,
	  include/conf.h, include/dirtree.h, include/fs.h, include/fsio.h,
	  include/netio.h, include/proftpd.h, include/support.h,
	  lib/Makefile.in, modules/Makefile.in, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_ls.c, modules/mod_site.c,
	  modules/mod_xfer.c, src/Makefile.in, src/dirtree.c, src/fs.c,
	  src/fsio.c, src/main.c, src/netio.c, src/support.c,
	  utils/Makefile.in:
	  Bug#1653 - Complete the FS API abstraction implementation.

2002-12-05 12:53  castaglia

	* NEWS, include/proftpd.h, modules/mod_core.c, modules/mod_xfer.c:
	  Bug#1743 - No magic cookie for number of files transfered.

2002-12-05 12:37  castaglia

	* NEWS, include/modules.h, include/version.h, src/main.c,
	  src/modules.c, src/support.c:
	  Bug#1833 - Add ability to have add'l module initialization
	  callback.

2002-12-05 12:30  castaglia

	* Make.rules.in, NEWS, doc/rfc/rfc2389.txt, include/conf.h,
	  include/dirtree.h, include/feat.h, include/ftp.h,
	  include/modules.h, include/regexp.h, lib/Makefile.in,
	  modules/Makefile.in, modules/mod_core.c, src/Makefile.in,
	  src/dirtree.c, src/feat.c, src/main.c, src/modules.c:
	  Bug#1806 - Add RFC2389 support.

2002-12-05 12:18  castaglia

	* NEWS, contrib/mod_ldap.c, contrib/mod_radius.c,
	  contrib/mod_sql.c, contrib/mod_sql_mysql.c,
	  contrib/mod_sql_postgres.c, include/modules.h,
	  modules/mod_auth.c, modules/mod_pam.c, modules/mod_unixpw.c,
	  src/auth.c:
	  Bug#1825 - AUTH macro namespace cleanup.

2002-12-05 12:08  castaglia

	* contrib/mod_linuxprivs.c, contrib/mod_radius.c,
	  contrib/mod_sql.c, contrib/mod_wrap.c, include/privs.h,
	  lib/pwgrent.c, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_log.c, modules/mod_pam.c, modules/mod_unixpw.c,
	  modules/mod_xfer.c, src/main.c:
	  Making sure that all LOG_* macros have PR_ prefix, for
	  consistency.

2002-12-05 11:48  castaglia

	* NEWS, src/dirtree.c:
	  Bug#1683 - Handling of VirtualHosts on startup.

2002-12-05 11:20  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#1482 - Add new %U meta to LogFormat, for logging original
	  username.

2002-12-05 11:15  castaglia

	* configure:
	  Updated configure script.

2002-12-05 11:11  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_pam.c,
	  modules/mod_unixpw.c:
	  Bug#1597 - Problems with HP-UX 10/11 trusted systems, mod_pam,
	  and mod_unixpw.

2002-12-05 11:03  castaglia

	* include/version.h:
	  Now that 1.2.7 has been released, update the version info in CVS.

2002-12-05 10:47  castaglia

	* doc/mod_sample.c:
	  Correcting typos.

2002-12-05 08:08  castaglia

	* contrib/dist/rpm/proftpd.spec:
	  Updating version for 1.2.7 release.

2002-12-05 07:30  castaglia

	* ChangeLog, NEWS, include/version.h:
	  Preparing for release of 1.2.7.

2002-12-04 11:14  castaglia

	* modules/mod_auth.c:
	  Patching to fix off-by-one bug in MaxHostsPerUser directive
	  handling.

2002-12-04 07:26  castaglia

	* NEWS, include/support.h, modules/mod_auth.c, src/support.c:
	  Adding memory scrubber for memset() issue mentioned here:

	    http://online.securityfocus.com/archive/1/298598

2002-12-03 07:57  castaglia

	* NEWS, utils/ftpcount.c:
	  Bug#1868 - Wrong cmdopts in ftpcount.c

2002-12-02 13:57  jwm

	* contrib/dist/rpm/.cvsignore: this shouldn't be ignoring
	  proftpd.spec anymore

2002-12-02 10:29  castaglia

	* NEWS, utils/ftpwho.c:
	  Bug#1861 - 'ftpwho -v -o oneline' print all connections in one
	  line.

2002-12-02 10:18  castaglia

	* src/dirtree.c:
	  Minor preprocessor changes.

2002-12-02 10:16  castaglia

	* src/dirtree.c:
	  Removed unused variable.

2002-12-02 09:04  castaglia

	* NEWS, modules/mod_xfer.c, src/pool.c:
	  Bug#1846 - File overwrites fail.  Thanks to Sergei Rozinov for
	  tracking down this bug.

2002-11-26 10:54  castaglia

	* src/support.c:
	  Minor style change: use macros for FTP commands.

2002-11-26 09:28  castaglia

	* NEWS, lib/pr-syslog.c:
	  Bug#1853 - SyslogFacility: unable to open syslog.

2002-11-25 13:28  castaglia

	* modules/mod_auth.c:
	  Moving hcur increment to a more appropriate location.  There
	  still seems to be lingering issues with these limits, though.
	  Yay.

2002-11-25 13:12  castaglia

	* modules/mod_core.c:
	  Oops.  A little too zealous on the previous change -- mg_size
	  should always be filled, even if get_fs_size() is not supported
	  on the host.

2002-11-25 13:02  castaglia

	* modules/mod_core.c:
	  Adjust core_display_file() to use get_param_ptr() when looking up
	  a MaxClients setting to display.  The MaxClients configuration
	  handler had been changed to storing a pointer, but this function
	  hadn't been updated to reflect that configuration handler change.

2002-11-25 10:28  castaglia

	* include/dirtree.h:
	  Removing unused struct members.

2002-11-25 09:33  castaglia

	* contrib/mod_radius.c, modules/mod_auth.c, modules/mod_ls.c,
	  src/dirtree.c, src/ident.c, src/support.c, utils/ftpshut.c:
	  Removed use of UCHAR cast from core code.  It is meant
	  specifically for the fnmatch code, and is a #define to an
	  unsigned char -- but the ANSI C standards define the parameter to
	  many of the is*() functions to be an int, and the UCHAR cast was
	  being used with those is*() functions.  Instead, those UCHAR
	  casts have been replaced with int casts.

2002-11-25 09:22  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#1856 - TimesGMT acts like default is 'off'.

2002-11-25 09:08  castaglia

	* modules/mod_xfer.c:
	  %lu crept back in when PR_LU is needed...

2002-11-25 08:18  castaglia

	* NEWS, modules/mod_site.c:
	  Bug#1852 - Proftpd gets signal 11 on "quote site".

2002-11-25 08:04  castaglia

	* doc/mod_sample.c, include/fs.h, include/netio.h, src/ident.c,
	  src/netio.c:
	  Updating my documentation this weekend,  and came across some
	  minor inconsistencies...

2002-11-25 07:52  castaglia

	* modules/mod_xfer.c:
	  Datatype overflow.

2002-11-23 10:39  jwm

	* modules/mod_ls.c, utils/ftpshut.c, utils/ftptop.c:
	  Silence remaining compiler warnings under Solaris 8 (save for the
	  utmp code, bug Bug 1824 will address that).

	  The nlink_t/pid_t casts will be unnecessary once the Solaris
	  _LP64 ABI is the default (see sys/isa_defs.h for more info on the
	  Solaris ABIs). I didn't want to move from _ILP32 (the historical
	  default) to _LP64 because I wasn't sure of the ramifications. We
	  don't have any DSOs to worry about, but I'm not sure what else
	  would change/break.

2002-11-22 21:20  jwm

	* NEWS, contrib/dist/rpm/proftpd.init.d: Bug 1680 - Error in
	  startup script

2002-11-22 11:21  jwm

	* configure: updated configure

2002-11-22 11:19  jwm

	* config.h.in, configure.in, NEWS, src/support.c: Bug 1839 -
	  undefined reference to `get_fs_size'

2002-11-21 16:19  castaglia

	* NEWS, utils/ftptop.c:
	  Bug#1848 - undefined reference to `halfdelay'.

2002-11-21 08:20  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#1812 - Double logging lines for ExtendedLog.

2002-11-19 09:57  castaglia

	* NEWS, include/dirtree.h, modules/mod_auth.c, modules/mod_core.c,
	  src/dirtree.c:
	  Bug#1838 - Since 1.2.6: in add_useralias() setting flag
	  CF_MERGEDOWN breaks aliased anonymous functionality.

2002-11-18 12:03  castaglia

	* modules/mod_xfer.c:
	  Minor problem with HiddenStores (related to the making of
	  HiddenStores a synonym for HiddenStor, with the eventual goal of
	  deprecating HiddenStor in favor of HiddenStores).

2002-11-18 09:15  castaglia

	* modules/mod_auth.c:
	  Handling of ShowSymlinks in this module still used
	  get_param_int() rather than get_param_ptr().

2002-11-18 08:15  castaglia

	* NEWS, modules/mod_core.c:
	  Bug#1844 - DisplayLogin %y macro is off by 1.

2002-11-18 08:02  castaglia

	* NEWS, include/pr-syslog.h:
	  Bug#1840 - Problem with syslog default destination on HP-UX.

2002-11-16 17:15  jwm

	* utils/.cvsignore:
	  ignore ftptop

2002-11-16 17:14  jwm

	* lib/pr-syslog.c:
	  cast the return value from getpid() to silence a compiler warning
	  under solaris

2002-11-15 09:09  jwm

	* contrib/dist/rpm/proftpd.spec: d'oh - /etc/logrotate.d/ should
	  exist in $RPM_BUILD_ROOT before I try to put stuff in it...

2002-11-15 08:45  castaglia

	* ChangeLog, NEWS, include/version.h:
	  Ramping up for 1.2.7rc3 release.

2002-11-15 08:37  castaglia

	* modules/mod_pam.c:
	  More timing/pam_end() fixes specific to the Solaris flavor of
	  PAM.

2002-11-15 08:11  castaglia

	* utils/ftptop.c:
	  Portability/compiler warning hack.  *sigh*

2002-11-15 08:03  castaglia

	* modules/mod_xfer.c:
	  Necessary typecasts to avoid compiler warnings (seen on Solaris
	  2.8).

2002-11-15 07:46  castaglia

	* modules/mod_log.c:
	  Style cleanup.

2002-11-14 09:57  castaglia

	* modules/mod_auth.c:
	  More hassle/work with MaxClientsPerHost (see Bug#1830, Bug#1831).

2002-11-14 09:09  castaglia

	* contrib/ftpasswd:
	  Forgot to increment the displayed $version.

2002-11-14 08:56  castaglia

	* NEWS:
	  Attributing proper credit. =)

2002-11-14 08:55  castaglia

	* contrib/: ftpasswd, ftpasswd.html:
	  Minor doc change.

2002-11-14 08:53  castaglia

	* NEWS, contrib/ftpasswd, contrib/ftpasswd.html:
	  Adding/changing ftpasswd error exit values.

2002-11-14 06:49  jwm

	* Makefile.in:
	  we don't need to worry about removing the autoconf-processed
	  proftpd.spec anymore (this wasn't even the right path to it,
	  anyway)

2002-11-13 13:15  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#1830 - MaxClientsPerHost (small) Bug.

2002-11-13 08:32  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#1810 - Wrong permissions assigned to uploaded file

2002-11-13 06:55  castaglia

	* NEWS, utils/ftpwho.c:
	  Bug#1815 - Patch to add class information to ftpwho (with verbose
	  on)

2002-11-13 06:37  castaglia

	* src/dirtree.c:
	  Add debugging output mentioning the configuration file being
	  parsed at debug level 2.

2002-11-12 14:27  castaglia

	* modules/: mod_auth.c, mod_core.c, mod_xfer.c:
	  Fix handling/lookup of Timeouts.

2002-11-12 08:42  castaglia

	* configure:
	  Updating configure script.

2002-11-12 08:38  castaglia

	* configure.in:
	  Minor whitespace quibble.

2002-11-12 08:28  jwm

	* .cvsignore:
	  ignore ftptop, autom4te.cache

2002-11-12 08:28  jwm

	* configure:
	  updated configure

2002-11-12 08:23  jwm

	* Make.rules.in, configure.in:
	  oops, accidentally reverted TJ's changes

2002-11-12 08:19  jwm

	* Makefile.in, Make.rules.in, NEWS, configure.in:
	  Only link ftptop with lib{n,}curses - it isn't needed in any
	  other binaries

2002-11-12 08:19  castaglia

	* configure:
	  Updating the configure script.

2002-11-12 08:10  castaglia

	* Make.rules.in, NEWS, configure.in:
	  Bug#1703 - mod_sql_mysql compile error.

2002-11-12 07:24  castaglia

	* modules/mod_core.c, modules/mod_xfer.c, NEWS:
	  Bug#1760 - AllowOverwrite not operational.

2002-11-11 15:57  jwm

	* utils/.cvsignore:
	  ignore Makefile, object and editor backup files

2002-11-11 15:44  jwm

	* modules/mod_unixpw.c: OS X also has a setgrent() that returns
	  void; make a note to update autoconf for a generic check for this

2002-11-05 11:06  jwm

	* NEWS, include/modules.h, modules/mod_auth.c, src/auth.c:
	  Bug 1818 - proftpd doesn't compile on hpux11

2002-11-03 16:53  jwm

	* configure:
	  updated configure

2002-11-03 16:41  jwm

	* NEWS, utils/ftptop.c, config.h.in, configure.in:
	  ftptop can now use either curses or ncurses

	  Based on a submission by: Ayamura KIKUCHI <ayamura@ayamura.org>

2002-11-03 08:40  jwm

	* NEWS, src/scoreboard.c:
	  Bug 1814 - class names are truncated in scoreboard entry

2002-11-02 14:47  jwm

	* contrib/dist/rpm/proftpd.spec:
	  forgot to add logrotate to %files

2002-11-02 14:44  jwm

	* NEWS:
	  update

2002-11-02 14:44  jwm

	* contrib/dist/rpm/: proftpd.logrotate, proftpd.spec:
	  Bug 1398 - there is no log rotate for /var/log/xferlog

2002-11-02 14:32  jwm

	* modules/mod_auth.c:
	  style, whitespace

2002-11-02 14:10  jwm

	* contrib/mod_ratio.c:
	  clean up compiler warnings

2002-11-02 14:01  jwm

	* NEWS, contrib/dist/rpm/proftpd.spec:
	  Bug 1772 - Docs fixup in RPM spec file

2002-11-02 14:01  jwm

	* configure:
	  update configure

2002-11-02 13:49  jwm

	* configure.in:
	  don't preprocess the rpm spec

2002-11-02 13:48  jwm

	* contrib/dist/rpm/: proftpd.spec, proftpd.spec.in:
	  having autoconf process proftpd.spec.in is silly - it's only that
	  way to substitute the @VERSION@ tag.

2002-11-02 13:42  jwm

	* NEWS:
	  update

2002-11-02 13:41  jwm

	* README.PAM, config.h.in, modules/mod_pam.c:
	  Bug 1805 - PAM support under Mac OS X

2002-11-02 13:38  jwm

	* README.PAM:
	  style

2002-11-02 13:34  jwm

	* NEWS, config.h.in, configure.in, include/conf.h:
	  Bug 1803 - Check for SIZEOF_UNSIGNED_LONG_LONG to determine LFS
	  support breaks some Linux installations

2002-10-30 11:29  castaglia

	* NEWS:
	  Typo.

2002-10-30 11:10  castaglia

	* NEWS, contrib/mod_wrap.c:
	  Bug#1800 - Proftpd child segfaults when ussing a PASS without no
	  USER first.

2002-10-29 17:47  castaglia

	* NEWS:
	  Typos.

2002-10-29 17:23  castaglia

	* NEWS, modules/mod_auth.c:
	  Fixing broken AuthAliasOnly, so that it does as described in the
	  docs (it had been broken by Bug#1567).

2002-10-29 10:06  castaglia

	* utils/: ftpcount.c, ftpwho.c, utils.h:
	  Modifying the handling of struct option in these files.  A change
	  had been made earlier in CVS to get these utilities to compile
	  properly under IRIX (which has a <getopt.h> that does not define
	  struct option); unfortunately, that change made it such that on
	  Solaris, the utilities did not compile.  The modifications
	  committed bring the handling of struct option in the utilities to
	  be like that of the main proftpd binary, which consequently is
	  handled properly under Solaris, IRIX, BSD, and Linux.  Hopefully
	  this concludes this getopt issue in the utilities.

2002-10-29 08:41  castaglia

	* modules/: mod_auth.c, mod_core.c:
	  More get_param_int() cleanup (this function will cause grief on
	  LP64 architectures, where pointer sizes are different and passing
	  pointers to stack values is a Bad Thing).  This patch moves all
	  the MaxClients*/MaxHosts* directives into mod_auth, makes them
	  all consistently use pointers, and corrects a small datatype
	  underflow bug that crept in with the introduction of
	  MaxClientsPerUser (oops).

2002-10-29 07:51  jwm

	* src/data.c: * style * Make sure session.xfer uses cleared memory
	  so unset structure members   won't contain random values.

2002-10-29 07:51  jwm

	* NEWS: Make sure session.xfer uses cleared memory so unset
	  structure members won't contain random values.

2002-10-28 14:32  castaglia

	* configure:
	  Updating configure script.

2002-10-28 14:30  castaglia

	* NEWS, config.h.in, configure.in, include/support.h,
	  modules/mod_core.c, src/support.c:
	  Bug#1722 - Can't work magic cookie %F on FreeBSD.

2002-10-28 09:28  castaglia

	* src/data.c:
	  Removed unnecessary log_debug() calls from data_sendfile().  Part
	  of this is because of the headache involved with getting the
	  proper format specifiers into the log_debug() calls -- too much
	  effort for little return.

2002-10-28 08:51  castaglia

	* modules/mod_xfer.c, src/dirtree.c, src/inet.c, src/log.c,
	  src/main.c, utils/ftpcount.c, utils/ftptop.c, utils/ftpwho.c:
	  Added typecast to int in is*() functions for picky Solaris.

2002-10-28 08:19  castaglia

	* include/conf.h:
	  Adding some necessary function prototypes for AIX, when compiled
	  using -D_NO_PROTO.

2002-10-26 15:57  castaglia

	* modules/mod_auth.c, utils/utils.h:
	  Fixing signedness variable check in mod_auth Fixed a missing
	  definition in utils/utils.h which afflicted systems that don't
	  have the getopt_long() function.

2002-10-25 09:54  castaglia

	* include/modules.h, modules/mod_log.c, src/main.c,
	  utils/ftpcount.c:
	  Fixing some function pointer scopes, removing unused variables --
	  general cleanup due to compiler complaints on IRIX.

2002-10-25 09:18  castaglia

	* src/main.c:
	  Re-adding logging of SIGSEGVs.

2002-10-24 15:19  castaglia

	* modules/mod_auth.c:
	  Correcting an off-by-one error concerning the enforcement of
	  MaxClients.

2002-10-24 13:03  castaglia

	* NEWS:
	  Forgot to note that Bug#1745 was fixed in 1.2.7rc1.

2002-10-24 10:22  castaglia

	* configure:
	  Updating configure script.

2002-10-24 10:16  castaglia

	* NEWS, configure.in:
	  Bug#1287 - Error compile with autoshadow option

2002-10-24 09:32  castaglia

	* configure:
	  Updating configure script.

2002-10-24 09:28  castaglia

	* configure.in:
	  Fixing up the configure script to handle the case where the admin
	  forgets to (or just plain doesn't) provide a value for the new
	  --enable-* tunable configure options.  It was simply writing the
	  "yes"/"no" strings into the headers -- not what I wanted.  Now,
	  configure will emit a warning if no values are explicitly
	  provided, and will use the default numbers.  Otherwise, it will
	  use the value provided.

2002-10-24 08:49  castaglia

	* README.AIX:
	  Adding remark reminding AIX users to avoid use of
	  --enable-autoshadow and --enable-shadow in their configure
	  options.

2002-10-23 16:56  castaglia

	* configure:
	  Updating configure script to match changes/fixes to configure.in.

2002-10-23 16:53  castaglia

	* NEWS, config.h.in, configure.in, include/options.h,
	  include/scoreboard.h, utils/utils.h:
	  Fixed configure script handling of ncurses detection (was not
	  #define'ing	HAVE_LIBNCURSES properly) Added
	  --enable-scoreboard-buffer-size option to the other "tunable"
	  configure   options, for tuning the size of sce_cmd, sce_cwd.

2002-10-23 10:27  castaglia

	* modules/mod_site.c:
	  Fixing requirement of auth chk for SITE commands CHGRP and CHMOD.

2002-10-22 12:14  castaglia

	* include/version.h:
	  Making CVS look ready for rc3.

2002-10-22 11:27  castaglia

	* ChangeLog, NEWS, include/version.h:
	  Preparing for release of 1.2.7rc2.

2002-10-21 11:40  castaglia

	* contrib/mod_wrap.c:
	  Fixed a minor file descriptor leak in mod_wrap (affects only the
	  child process, not the daemon process).

2002-10-21 10:10  castaglia

	* configure:
	  Updating configure script for added --enable* options.

2002-10-21 10:06  castaglia

	* NEWS, config.h.in, configure.in, contrib/mod_radius.c,
	  contrib/mod_ratio.c, contrib/mod_sql.c, contrib/mod_sql_mysql.c,
	  contrib/mod_sql_postgres.c, doc/license.txt, include/dirtree.h,
	  include/options.h, include/pool.h, lib/pr-syslog.c,
	  lib/pwgrent.c, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_ls.c, modules/mod_pam.c, modules/mod_site.c,
	  modules/mod_unixpw.c, modules/mod_xfer.c, src/data.c,
	  src/dirtree.c, src/fs.c, src/ident.c, src/inet.c, src/log.c,
	  src/main.c, src/modules.c, src/netio.c, src/pool.c, src/regexp.c,
	  src/support.c:
	  Large style cleanup:	 - added PR_ prefix to TUNABLE_ macros	 -
	  renamed command handlers in some modules (from cmd_* to
	  <module-name>_*)     in order to better exemplify module
	  namespace conventions   - removed extraneous
	  make_named_sub_pool() (added macro for backward     compatibility
	  for contrib modules)	 - lots of trivial whitespace changes

	  Hopefully I didn't break anything too major with this.

2002-10-19 08:16  flyhmstr

	* doc/faq.html: ML: new FAQ issue

2002-10-18 15:20  castaglia

	* src/auth.c:
	  Fixed a bad bug, introduced with the Cygwin changes (I think).
	  setgid() will not be called if the platform doesn't have
	  setgroups() due to the placement of the HAVE_SETGROUPS #ifdefs.
	  I don't know if this change will break stuff under Cygwin, but
	  the current placement of those #ifdefs won't do.

2002-10-18 12:50  castaglia

	* NEWS, modules/mod_core.c:
	  Fixed typo in NEWS Added handler for ScoreboardPath directive,
	  which will report on the  deprecated nature of the directive, and
	  inform the admin of using the  newer ScoreboardFile instead.
	  Hopefully this will help ease (somewhat)  the upgrade to 1.2.7.

2002-10-18 12:43  castaglia

	* NEWS, utils/ftptop.c:
	  Bug#1778 - 1.2.7rc1 fails to link on OpenBSD 3.2-current

2002-10-18 10:59  flyhmstr

	* doc/Configuration.html: ML: updated to include mod_radius stuff

2002-10-18 10:15  flyhmstr

	* doc/: Configuration.html, faq.html: ML: updated directivelist and
	  faq

2002-10-18 08:14  castaglia

	* NEWS, modules/mod_ls.c, src/fs.c:
	  Bug#1785 - Bad handling of symlinks

2002-10-16 17:37  castaglia

	* src/: auth.c, data.c, dirtree.c, inet.c, log.c, main.c,
	  modules.c, pool.c, regexp.c, scoreboard.c, support.c:
	  Cleanliness/style: changing core code to use PR_LOG_* instead of
	  LOG_*.  Contrib modules may need to be changed to use PR_LOG_* in
	  the future.

2002-10-16 11:14  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#1644 - LogFormat local IP and FQDN tags missing

2002-10-15 15:18  castaglia

	* README.AIX:
	  Updating this README with the CFLAGS that seem to work with the
	  newer proftpd versions.

2002-10-15 10:08  castaglia

	* modules/mod_xfer.c:
	  Missed the assignment of session.xfer.path in cmd_stor() in the
	  previous commit.

2002-10-15 10:01  castaglia

	* include/proftpd.h, modules/mod_xfer.c, src/data.c:
	  Removing some cruft from session.xfer, fixing some whitespace
	  styling.  Significant change is moving session.xfer.path so that
	  it is not allocated from session.xfer.p (a pool with a bad name
	  =P), but rather is the string originally allocated in the PRE_CMD
	  handler, from cmd->pool.  There is no reason for the path to be
	  reallocated again from session.xfer.p (unless any functions
	  manipulate that buffer, which they shouldn't, and which none
	  currently do), and, in some cases, ASCII CRLF handling was
	  causing corruption of that buffer.

2002-10-14 17:11  castaglia

	* src/log.c:
	  Make sure log_openfile() returns the same error values as
	  #defined in include/log.h.

2002-10-14 17:04  castaglia

	* src/auth.c:
	  Need to handle case in set_groups() where suppl_gids might be
	  non-NULL, but the contained number of gids (suppl_gids->nelts) is
	  zero.  This was causing a segfault, for memory was being
	  allocated (of length zero) which was then being cleared.

2002-10-14 11:26  castaglia

	* NEWS, modules/mod_auth.c, modules/mod_unixpw.c, src/main.c,
	  src/modules.c:
	  Changing place in code where switching to the User/Group for a
	  vhost occurs, so that it happens prior to the calling of any
	  modules' session initialization callbacks.

2002-10-10 08:00  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#1770 - Forgetting to check for no IP in string

2002-10-09 09:55  castaglia

	* NEWS, modules/mod_auth.c, src/auth.c, src/dirtree.c,
	  src/support.c:
	  Bug#1769 - Lack of supplemental groups can cause segfault.

2002-10-09 09:12  flyhmstr

	* doc/Configuration.html: ML: updated directive list ready for
	  1.2.7rc2

2002-10-08 14:19  castaglia

	* modules/mod_xfer.c:
	  Oops.  Should always use the FS API functions for FS operations.

2002-10-08 08:05  castaglia

	* modules/mod_xfer.c:
	  Clean up files created by mkstemp(3) if other checks (e.g.
	  <Limit>) fail.  Discrepancy noticed by Joao Gouveia
	  <tharbad@kaotik.org>.

2002-10-08 07:35  castaglia

	* NEWS, src/main.c:
	  Bug#1759 - ftpwho shows much more connections than realy is.

2002-10-07 18:04  jwm

	* README, README.AIX, README.modules:
	  style nit

2002-10-07 17:18  castaglia

	* CREDITS, INSTALL, Makefile.in, README, README.AIX,
	  README.linux-privs, README.mod_sql, README.modules, README.ports:

	  Updating documentation, fixing 'make clean' target.  Thanks to
	  Michael Renner for these patches.

2002-10-07 14:40  castaglia

	* INSTALL, README.modules:
	  Removing references to crufty old mod_test.

2002-10-07 10:17  castaglia

	* INSTALL:
	  Changing mention of ScoreboardPath to ScoreboardFile.

2002-10-07 10:14  castaglia

	* sample-configurations/complex-virtual.conf:
	  Updating more example configs.

2002-10-07 10:01  castaglia

	* sample-configurations/PFTEST.shadow:
	  Match username 'proftpd' in the test passwd file.

2002-10-07 09:59  castaglia

	* sample-configurations/PFTEST.conf.in:
	  Updating config for 1.2.7 release cycle (ScoreboardPath ->
	  ScoreboardFile).

2002-10-04 15:51  castaglia

	* utils/ftptop.c:
	  Adding kludge to ftptop that scans the config file for a
	  non-default ScoreboardFile directive.

2002-10-04 12:08  castaglia

	* src/scoreboard.c:
	  Amend the addition of using fchmod() on the scoreboard to make
	  the mode 0644, rather than 0444.  This allows for non-root
	  daemons to still be able to use the scoreboard.  Thanks to
	  Michael Renner for noting this.

2002-10-04 07:41  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#1735 - Proftpd 1.2.6 compiled on FreeBSD 4.6.2 exits on
	  signal 11

2002-10-03 17:36  castaglia

	* src/scoreboard.c:
	  Addition borne of paranoia inspired by recent Apache
	  scoreboarding vulnerability.

2002-10-03 12:15  castaglia

	* modules/mod_auth.c:
	  Fixing off-by-one error in MaxClientsPerHost check.

2002-10-03 08:44  castaglia

	* CREDITS:
	  Adding thanks/credits for unnamed users who contribute to the
	  project.

2002-10-03 08:30  castaglia

	* modules/mod_site.c, src/main.c:
	  Some style-related cleanups.	Still working on that HELP SITE
	  code - had the tertiary operator parameters in the wrong order
	  (and it was apparently causing a segfault).

2002-10-02 13:49  castaglia

	* NEWS, src/netio.c:
	  Bug#1757 - non-ANSI Syntax in netio.c

2002-10-02 13:35  castaglia

	* include/version.h:
	  Updating the version, preparing for the next CVS/release.

2002-10-02 11:13  castaglia

	* modules/mod_site.c:
	  Fixing support for 'HELP SITE' (common) in addition to 'SITE
	  HELP' (proper).

2002-10-02 09:18  castaglia

	* src/main.c:
	  Cleaning up a badly-written preprocessor directive (my fault).

2002-10-02 08:19  castaglia

	* utils/scoreboard.c:
	  Prevent egregious ENOENT error when reading the scoreboard.

2002-10-01 11:59  castaglia

	* ChangeLog, NEWS, include/version.h:
	  Preparing for release of 1.2.7rc1.

2002-10-01 09:23  castaglia

	* modules/mod_auth.c:
	  Minor wording correction for default MaxClientsPerUser message.

2002-10-01 09:19  castaglia

	* NEWS, modules/mod_auth.c:
	  Bug#1675 - add new MaxClientsPerUser configuration option.  Works
	  just like	       MaxHostsPerUser.

2002-10-01 08:50  jwm

	* configure: updated configure

2002-10-01 08:43  jwm

	* configure.in: Fix for broken headers in OS X 10.1 Submitted by:
	  Thomas Ganter <tganter@mac.com>

2002-09-30 13:57  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#1694 - SQLLog QUIT doesn't execute on connection close.

	  With the various changes to mod_sql (SQLNegativeCache, etc), I'm
	  bumping its version to 4.10.

2002-09-30 13:52  castaglia

	* NEWS:
	  Forgot to note that Bug#1748 had been fixed.

2002-09-30 08:56  castaglia

	* NEWS, include/modules.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_site.c, src/main.c:
	  Bug#1475 - Minor changes to SITE command handling.

2002-09-27 19:04  castaglia

	* modules/mod_site.c:
	  Helps if I put the full code from the fix in CVS, doesn't it?

2002-09-27 19:01  castaglia

	* include/privs.h, modules/mod_site.c:
	  Casting and variable type fun (based on compiler complaints).

2002-09-27 18:42  castaglia

	* modules/mod_pam.c:
	  Confirmed -- it's a Solaris-specific thing.  Fixed to (hopefully)
	  not generate error messages when working with Linux/FreeBSD' PAM
	  libraries.

2002-09-27 18:13  castaglia

	* modules/mod_pam.c:
	  Seems there's a slight discrepancy between the Solaris and Linux
	  PAM implementations with regard to the order of calling
	  pam_end().  I don't know about FreeBSD PAM yet, though; don't
	  have root privs on a FreeBSD box to verify.

2002-09-27 17:28  castaglia

	* utils/ftptop.c:
	  With the addition of the sce_server_addr field to the scoreboard
	  entry struct, ftptop no longer needs to use inet_ntoa(3) to
	  stringify the server IP address.

2002-09-27 13:58  castaglia

	* NEWS, modules/mod_pam.c:
	  Bug#1572 - Need to use pam_end() to close session on Solaris 8.
	  The cause turned out to be a need to always call pam_end() after
	  pam_authenticate().

2002-09-27 13:51  castaglia

	* include/scoreboard.h, src/scoreboard.c, utils/utils.h:
	  Seems that gcc-3 has some quirks when it comes to variadic
	  functions.  Adjusting to compensate.

2002-09-27 13:17  castaglia

	* src/scoreboard.c:
	  Try to handle cases where NULLs might be (inappropriately) sent
	  to pr_scoreboard_update_entry().

2002-09-27 13:01  castaglia

	* utils/: ftptop.c, utils.h:
	  Make sure that the utils compile on platforms that don't have
	  <getopt.h>

2002-09-26 10:52  castaglia

	* include/scoreboard.h, modules/mod_auth.c, src/scoreboard.c,
	  utils/ftptop.c, utils/ftpwho.c, utils/utils.h:
	  Adding display of server (IP address/port) string to ftpwho (when
	  -v is used).

2002-09-26 10:20  castaglia

	* utils/ftptop.c:
	  Removed an unused variable.

2002-09-26 10:17  castaglia

	* utils/utils.h:
	  Keeping this in sync with include/scoreboard.h

2002-09-26 10:09  castaglia

	* src/main.c:
	  Make clearing the scoreboard slot one of the first things that
	  happens when a child exits.

2002-09-26 09:59  castaglia

	* utils/ftpwho.c:
	  Adjusting the spacing of ftpwho fields, trying to make the output
	  prettier.

2002-09-26 09:47  castaglia

	* include/scoreboard.h, src/main.c, src/scoreboard.c:
	  Adjusting some of the scoreboard entry sizes to be smaller (we
	  can always make them larger later, if need be).  Also adding the
	  clearing of a scoreboard slot in the case of a SIGSEGV in the
	  signal handler itself.

2002-09-25 18:11  castaglia

	* NEWS, contrib/mod_radius.c, contrib/mod_radius.html:
	  Bug#1687 - Add contrib module for RADIUS authentication,
	  accounting

2002-09-25 18:05  castaglia

	* NEWS, src/dirtree.c:
	  Bug#1732 - No checking for NULL at inet_ascii and pr_fnmatch.
	  The fix for this now allows for "inline" comments in the lines of
	  a proftpd.conf file, e.g.:

	      Port 21 # Some comment here

	  whereas before, that "# Some comment here" would be tokenized and
	  treated as normal input into the configuration directive handler.

2002-09-25 17:36  castaglia

	* NEWS, include/privs.h:
	  Bug#1395 - Check return values in PRIVS calls

2002-09-25 17:04  castaglia

	* src/: ftpcount.1, ftpcount.c, ftpshut.8, ftpshut.c, ftpwho.1,
	  ftpwho.c:
	  Removing these files from src/, as they now appear under utils/

2002-09-25 17:01  castaglia

	* src/main.c:
	  No need to complain of scoreboard slot cleaning error when we're
	  not a child process (e.g. when the daemon is shutting down).

2002-09-25 16:56  castaglia

	* configure:
	  And the necessary delayed commit of the new configure script, to
	  match the configure.in tweaks.

2002-09-25 16:53  castaglia

	* configure.in:
	  Needing to tweak this, in order to get the timestamps on
	  configure.in and configure files in the CVS repository to be what
	  we need them to be.

2002-09-25 16:45  castaglia

	* utils/: Makefile.in, ftpcount.1, ftpcount.c, ftpshut.8,
	  ftpshut.c, ftptop.c, ftpwho.1, ftpwho.c, misc.c, scoreboard.c,
	  utils.h:
	  Populating the new utils/ sub-directory with the source code
	  files for the ftpcount, ftpwho, ftptop, ftpshut utilities.

2002-09-25 16:43  castaglia

	* NEWS:
	  Forgot to update the NEWS file for the scoreboard changes.

2002-09-25 16:43  castaglia

	* Make.rules.in, Makefile.in, config.h.in, configure, configure.in,
	  contrib/mod_sql.c, include/conf.h, include/log.h,
	  include/privs.h, include/scoreboard.h, include/version.h,
	  lib/Makefile.in, modules/Makefile.in, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_xfer.c, src/Makefile.in,
	  src/log.c, src/main.c, src/scoreboard.c, src/support.c:
	  Bug#1713 - Scoreboard changes.  This simple statement covers
	  quite a few changes.

2002-09-24 19:13  jwm

	* modules/mod_xfer.c: * style * silence a compiler warning with a
	  cast (the Cast Nazi yields ground: film   at eleven)

2002-09-24 19:11  jwm

	* src/sets.c: style

2002-09-24 19:11  jwm

	* lib/: glibc-mkstemp.c, strsep.c, vsnprintf.c: * style * silence
	  ranlib warnings if the host OS already has the appropriate
	  functions

2002-09-23 09:17  castaglia

	* src/main.c:
	  Corrections in comments.

2002-09-23 08:30  castaglia

	* src/main.c:
	  Make necessary modification to handling of SIGCHLD, in order to
	  prevent nasty segfaults under non-POSIX, SVR4 systems (e.g.
	  IRIX).  Explanatory comments in sig_child() handler.

2002-09-20 19:12  jwm

	* README.LDAP:
	  * update for 2.8.10 * postcard-ware

2002-09-20 19:09  jwm

	* contrib/mod_ldap.c:
	  mod_ldap is now postcard-ware

2002-09-19 12:26  castaglia

	* sample-configurations/basic.conf:
	  Fix the grammar in the default configuration file a little, and
	  make a minor optimization: <Directory /*> is not really needed,
	  as <Directory /> suffices.

2002-09-16 13:45  castaglia

	* contrib/mod_sql.c:
	  Changed this logging level, so that it does not show up at DEBUG0
	  (which is the default log level, or at least included in the
	  default logging levels).

2002-09-15 13:50  jwm

	* Makefile.in, NEWS:
	  Bug 1726 - Cygwin's Makefile inconsistency

2002-09-13 16:14  castaglia

	* Make.rules.in, NEWS, include/conf.h, include/inet.h,
	  include/io.h, include/netio.h, lib/Makefile.in,
	  modules/Makefile.in, modules/mod_core.c, modules/mod_ls.c,
	  modules/mod_xfer.c, src/Makefile.in, src/data.c, src/fs.c,
	  src/ident.c, src/inet.c, src/io.c, src/main.c, src/netio.c:
	  Adding the NetIO API.

2002-09-13 15:59  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#1736 - RETR does not handle an inappropriate REST

2002-09-13 15:51  castaglia

	* NEWS, include/dirtree.h, modules/mod_core.c, modules/mod_ls.c,
	  src/dirtree.c:
	  Bug#1737 - Enhance file hiding via regular expressions

2002-09-13 15:01  castaglia

	* contrib/mod_sql.c:
	  Make this particular mod_sql log message a little less urgent.

2002-09-13 14:35  castaglia

	* modules/mod_auth.c:
	  Slight correction in the config context used for looking up any
	  configured TimeoutSession.

2002-09-13 13:21  castaglia

	* NEWS, modules/mod_auth.c, modules/mod_core.c, modules/mod_xfer.c,
	  src/data.c, src/dirtree.c:
	  Bug#1436 - Feature Enhancement: Timeouts on a <Virtualhost> basis

2002-09-13 12:58  castaglia

	* modules/mod_auth.c:
	  When unable to chdir to a directory, when logging in, add
	  reporting of errno.

2002-09-13 12:33  castaglia

	* NEWS, include/proftpd.h, modules/mod_core.c, src/main.c:
	  Bug#1658 - Separate session/daemon resource limit settings.

2002-09-13 07:30  jwm

	* configure:
	  Updated configure from last configure.in commit

2002-09-12 18:19  jwm

	* configure.in:
	  You can't explicitly include sys/sendfile.h when compiling with
	  large file support.

	  Submitted by: Jan Kasprzak <kas@informatics.muni.cz>
	  http://www.geocrawler.com/lists/3/SourceForge/9189/0/9566710/

2002-09-12 18:10  jwm

	* contrib/mod_ratio.c:
	  * anonymous ratios are now looked up by the e-mail address used *
	  make sure g.user is defined so the ratio is recorded for
	  *something*

	  Submitted by: Benjamin Schieder <bs1544@bingo-ev.de>
	  http://www.geocrawler.com/lists/3/SourceForge/9190/75/9539913/

2002-09-12 18:02  jwm

	* contrib/dist/rpm/proftpd.spec.in:
	  Documentation improvements

	  Submitted by: Magnus Stenman <stone@hkust.se>
	  http://www.geocrawler.com/lists/3/SourceForge/9189/0/9564251/

2002-09-12 16:23  castaglia

	* modules/mod_log.c:
	  Missed a Boolean...

2002-09-12 16:20  castaglia

	* modules/mod_log.c:
	  Fixed minor problem with duplicate logging: mod_log was a)
	  looking in the wrong context, and b) recursing through
	  configuration subsets in an attempt to fix its wrong context
	  starting point.  Should be remedied now.

2002-09-11 11:59  castaglia

	* doc/mod_sample.c:
	  Updating the code in the mod_sample.c file to demonstrate things
	  a little better.

2002-09-10 16:26  castaglia

	* modules/mod_xfer.c:
	  Helps if uploads/downloads actually work...oops. =P

2002-09-10 12:36  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#1065 - Added MaxRetrieveFileSize, MaxStoreFileSize
	  directives.

2002-09-10 11:50  castaglia

	* NEWS, modules/mod_log.c:
	  Bug#1669 - Filename meta (%f) not correctly expanded for some
	  commands	      in WRITE logging class.  This will
	  necessitate discussion on the 	   current state of
	  proftpd's logging variables.

2002-09-10 10:26  castaglia

	* src/main.c:
	  Removed an unused variable.

2002-09-10 09:29  castaglia

	* src/fs.c:
	  No need for this cast (I don't think...).

2002-09-10 09:07  jwm

	* modules/mod_xfer.c:
	  fixup

2002-09-10 09:01  castaglia

	* NEWS, include/fs.h, include/io.h, modules/mod_core.c,
	  modules/mod_ls.c, src/data.c, src/fs.c, src/io.c, src/support.c:
	  Bug#1486 - lots of changes made to code, adding buffers in an
	  attempt to		optimize directory listings and ASCII file
	  translation.	We'll		 see how many bugs are added with
	  this commit =).

2002-09-10 08:06  castaglia

	* NEWS, include/conf.h, src/fs.c:
	  Bug#1662 - #define _GNU_SOURCE, which will quell some compiler
	  warnings	      (e.g. the crypt() warning when using
	  mod_sql).

2002-09-10 04:35  jwm

	* modules/mod_xfer.c:
	  minor format-type fixups

2002-09-09 16:05  jwm

	* src/main.c:
	  style

2002-09-09 15:43  castaglia

	* src/main.c:
	  No comment.

2002-09-09 15:35  castaglia

	* src/main.c:
	  Spoke too soon. =P

2002-09-09 15:33  castaglia

	* src/main.c:
	  Don't forget to append the "proftpd: " prefix for
	  non-setproctitle(2) platforms.  Hopefully this ends our fun with
	  Bug#1649.

2002-09-09 13:03  uid43859

	* lib/pr-syslog.c:
	  Solaris doesn't have the macro LOG_PRI()

2002-09-09 13:01  uid43859

	* src/main.c:
	  fixed & cleaned up #defines

2002-09-09 07:40  jwm

	* src/main.c:
	  Fixing the fix for Bug#1649 - the #ifdefs didn't actually change
	  anything

2002-09-07 12:08  castaglia

	* lib/pr-syslog.c:
	  Forgot to bracket use of __progname in #ifdefs, as not every
	  platform's libc supports __progname.

2002-09-07 12:02  castaglia

	* src/main.c:
	  Need to match datatypes for the unixpw_persistent variable in
	  main.c and mod_unixpw.c

2002-09-07 10:37  castaglia

	* NEWS:
	  Oops.  Wrong bug number.

2002-09-06 17:25  castaglia

	* modules/mod_core.c:
	  Oops.  Forgot to cleanup my debugging/logging.

2002-09-06 11:51  castaglia

	* NEWS, modules/mod_core.c, src/main.c:
	  Bug#1652 - add a MaxConnectionRate directive, for configuration a
		     connection rate limiting mechanism.  This mechanism is
	  really only		 effective when running proftpd in
	  standalone mode; if using	       inet/xinetd, those daemons
	  have their own connection rate	    limiting mechanisms.

2002-09-06 11:05  castaglia

	* NEWS, src/main.c:
	  Bug#1432 - adding check to function handling FTP commands
	  received from 	   clients to be more strictly
	  RFC959-compliant: leading whitespace		  before the FTP
	  command is now not allowed.

2002-09-06 09:13  castaglia

	* NEWS, modules/mod_core.c, src/main.c:
	  Bug#1253 - added a DefaultAddress directive, for explicitly
	  configuring the	     IP address to which the "default"
	  server listens.

2002-09-06 08:18  castaglia

	* NEWS, src/dirtree.c:
	  Bug#1725 - Still fixing the bugs I introduced into match_ip() as
	  a consequence 	   of Bug#1701.  This particular bug was
	  caused by an assumption;	      I'd forgotten to take into
	  account globbing characters attached		  to address
	  strings in the case of a '.' suffix/prefix.  The
	  manipulated string was used as an argument to inet_getaddr(),
		 which returns a pointer.  I forgot to check for that
	  pointer being 	   NULL.

2002-09-05 18:06  castaglia

	* NEWS, modules/mod_core.c, modules/mod_site.c:
	  Bug#1663 - Add SITE CHGRP command

2002-09-05 17:59  castaglia

	* NEWS, include/ftp.h, include/modules.h, modules/mod_auth.c,
	  src/auth.c:
	  Bug#1719 - Adding RFC2228-defined FTP commands and response
	  codes; made minor	       adjustments to allow future RFC2228
	  modules (will not change	      current/default behavior).

2002-09-05 17:42  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#1593 - added a new mod_sql directive, SQLNegativeCache, to
	  toggle whether	    mod_sql caches negative lookups.
	  Documentation to be forthcoming.

2002-09-05 17:38  castaglia

	* contrib/: mod_sql.c, mod_sql.h, mod_sql_mysql.c,
	  mod_sql_postgres.c:
	  Correcting the OpenSSL exemption clause to list the proper
	  copyright holder for these files.

2002-09-05 16:04  castaglia

	* NEWS, modules/mod_pam.c:
	  Bug#1724 - The AuthPAM* directive lookups were using
	  TOPLEVEL_CONF as their   config context lookup, but the
	  directives themselves were only allowed in   the server config
	  contexts ("server config", <VirtualHost>, and <Globa>).    This
	  had the consequence of those directives not being properly seen
	  when doing <Anonymous> logins.  The fix was to use
	  main_server->conf as	  the lookup context, rather than
	  TOPLEVEL_CONF.

2002-09-05 14:13  castaglia

	* NEWS, modules/mod_auth.c, modules/mod_core.c, src/dirtree.c:
	  Bug#1076 - Adding an AllowOverride directive, to provide
	  finer-grained 	   control over which users, if any, have
	  their .ftpaccess files	    parsed/honored.

2002-09-05 13:09  castaglia

	* Make.rules.in, NEWS, include/conf.h, include/log.h,
	  include/pr-syslog.h, lib/pr-syslog.c, modules/mod_core.c,
	  src/log.c, src/main.c, src/utils.c:
	  Bug#1682 - Use of chroot(2) and external libraries made necessary
	  the		 implementing of an internal syslog client routine
	  for use by		proftpd.

2002-09-04 12:27  castaglia

	* Makefile.in, NEWS:
	  Bug#1654 - Add DESTDIR in Makefile

2002-09-04 11:55  castaglia

	* NEWS, include/version.h, src/auth.c, src/main.c:
	  Starting in on the work for the 1.2.7 version:

	  Bug#1649 - setproctitle() prepends and appends process name. This
	  is a		  FreeBSD-specific bug (yay portability).  Bug#1666
	  - Auth modules can return duplicate supplemental groups

2002-09-04 09:10  flyhmstr

	* doc/Configuration.html: ML: more fixme's gone

2002-09-04 07:54  castaglia

	* ChangeLog, NEWS, include/version.h:
	  Ramping up for the release of 1.2.6.

2002-09-04 00:07  flyhmstr

	* doc/Configuration.html: ML: updated directive list

2002-09-02 13:16  castaglia

	* NEWS, src/io.c:
	  Note version increment of mod_ldap; add processing of signals in
	  the io_poll() loop.

2002-08-30 17:48  jwm

	* contrib/mod_ratio.c:
	  openssl exemption

2002-08-30 17:45  jwm

	* contrib/mod_ldap.c:
	  2.8.10 - replacement for ldap_build_filter()

2002-08-30 17:08  jwm

	* src/main.c:
	  would someone please give me an elementary lesson in checking
	  what exactly i'm committing before committing it?

2002-08-30 17:06  jwm

	* src/: main.c, pool.c:
	  style, removing cruft

2002-08-29 16:25  castaglia

	* contrib/mod_readme.c:
	  Added OpenSSL exemption clause to this contrib module's license.

2002-08-28 09:00  castaglia

	* NEWS, src/dirtree.c:
	  Fixed bug introduced by bad use of inet_ntoa(3) in fix for
	  Bug#1701.

2002-08-24 08:18  jwm

	* contrib/dist/rpm/proftpd.spec.in:
	  bloody fscking stupid thing...

2002-08-24 08:15  jwm

	* contrib/: mod_ldap.c, dist/rpm/proftpd.spec.in:
	  * openssl exemption * version bump to 2.8.9

2002-08-18 18:38  jwm

	* doc/Configuration.sgml:
	  adding the sgml version of the directive docs

2002-08-15 08:02  castaglia

	* ChangeLog, NEWS, include/version.h:
	  Preparing to release 1.2.6rc2

2002-08-15 07:45  castaglia

	* NEWS, src/dirtree.c:
	  Bug#1701 - Reverse lookups not working

2002-08-14 09:25  castaglia

	* modules/: mod_log.c, mod_ls.c, mod_site.c, mod_unixpw.c:
	  Updating copyright notices.

2002-08-14 09:17  castaglia

	* include/inet.h, include/proftpd.h, modules/mod_core.c,
	  modules/mod_ls.c, modules/mod_xfer.c, src/data.c, src/inet.c,
	  src/io.c, src/main.c, src/support.c:
	  Code cleanup:  - moved ShowSymlinks from mod_core to mod_ls  -
	  changed PassivePorts, AllowForeignAddress, ShowSymlinks, TimesGMT
	  to not    use get_param_int() (which uses addresses of stack
	  variables instead of	  heap variables), and using
	  get_param_ptr() instead.   - minor renaming

2002-08-14 08:14  jwm

	* contrib/dist/rpm/proftpd.spec.in:
	  Packager: update

2002-08-14 08:10  jwm

	* contrib/dist/rpm/proftpd.spec.in:
	  Added removal of build leftover directory in %clean.	Submitted
	  by: Christian Pelealu <kurisu@mweb.co.id>

2002-08-13 15:52  castaglia

	* src/log.c:
	  Added minor, but necessary check when reading the scoreboard
	  header on AIX platforms.  Portability is a PITA.

2002-08-12 10:30  castaglia

	* modules/mod_ls.c, src/main.c:
	  Added signal processing for recursive directory listings Added
	  masking of SIGCHLD in the SIGCHLD processing function Added debug
	  logging, at level 7, of module session initialization callbacks

2002-08-05 10:06  castaglia

	* config.sub:
	  Added case to handle ELF NetBSD on a shark.

2002-08-01 16:13  castaglia

	* src/log.c:
	  Added logging of TransferLog file opening at level 6; this will
	  aid in debugging errors involving the default TransferLog
	  ("/var/log/xferlog") on systems which may have troubles (e.g. no
	  /var/log directory, which shows up in the logs as "unable to
	  stat() /var/log" -- not indicative of the culprit [TransferLog]).

2002-08-01 15:11  castaglia

	* modules/mod_unixpw.c:
	  AIX portability/broken-ness changes.

2002-08-01 15:08  castaglia

	* include/dirtree.h, src/dirtree.c:
	  Minor fix, matching up datatypes in function declaration to
	  actual datatype used (caused a complaint under AIX's xlc).

2002-07-26 10:08  castaglia

	* src/main.c:
	  Minor cleanup from previous commit.

2002-07-26 10:02  castaglia

	* src/: dirtree.c, main.c, support.c:
	  Fixed minor HUP memory leak, caused by use of schedule() to
	  schedule an invocation of main_rehash().  A sched_t object is
	  allocated for the scheduling from permanent_pool, but that object
	  is never freed.  The fix was to add a pool member to the sched_t
	  struct, allocated a subpool from permanent_pool, allocate the
	  sched_t struct from that subpool, and assign the subpool to the
	  struct's pool member.  That way, the sched_t object can be
	  destroyed once the scheduled callback has been invoked.  Also
	  cleaned up some of the main_rehash() code, to make it more
	  legible.

2002-07-25 08:21  jwm

	* include/regexp.h:
	  typo/style

2002-07-24 15:20  castaglia

	* Make.rules.in, NEWS, include/conf.h, include/pool.h,
	  modules/mod_core.c, src/inet.c, src/main.c, src/pool.c,
	  include/regexp.h, src/regexp.c:
	  Bug#1697 - Memory leak involving regexp and SIGHUP

2002-07-22 16:18  castaglia

	* modules/: mod_auth.c, mod_core.c:
	  Oops.  Realized that DeferWelcome should've stayed in mod_core.

2002-07-22 15:17  castaglia

	* modules/: mod_auth.c, mod_core.c, mod_xfer.c:
	  Rearranging the placement of several configuration directive
	  handlers, placing the handler functions in the module that
	  actually uses the configured directive (many were bunched into
	  mod_core).

2002-07-20 01:29  flyhmstr

	* contrib/UPGRADE.mod_sql: ML: updated mod_sql homepage url

2002-07-19 14:25  castaglia

	* NEWS, lib/pwgrent.c:
	  Bug#1674 - fgetbufline passes NULL pointer to fgets()

2002-07-18 16:01  castaglia

	* modules/mod_core.c, modules/mod_pam.c, modules/mod_unixpw.c,
	  src/main.c:
	  Miscellaneous configuration handler cleanup.

2002-07-15 08:50  castaglia

	* NEWS, modules/mod_xfer.c:
	  Bug#1645 - HiddenStor should close file before renaming

2002-07-15 08:39  castaglia

	* NEWS, modules/mod_core.c, src/dirtree.c:
	  Bug#1681 - Multiple Include directives in a single file do not
	  get parsed

2002-07-09 15:20  castaglia

	* include/proftpd.h, include/support.h, include/timers.h,
	  src/main.c, src/support.c, src/timers.c:
	  Committed the latest patch attached to Bug#1556.

2002-07-02 17:30  jwm

	* configure:
	  new configure

2002-07-02 17:25  jwm

	* Makefile.in, README.cygwin, configure.in:
	  attach 1428 to bug 1569 - cygwin EXEEXT fixups

2002-07-02 11:25  castaglia

	* ChangeLog, NEWS, include/version.h:
	  Preparing for release of 1.2.6rc1

2002-07-02 10:01  castaglia

	* include/inet.h, include/io.h, include/options.h, src/data.c,
	  src/inet.c, src/io.c:
	  Fixing consequences of Bug#1502 and ABOR causing some clients to
	  wait indefinitely.

2002-07-01 11:28  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#1543 - Usernames with spaces, problems to authenticate

2002-07-01 11:18  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#1628 - group mods (DefaultRoot) only work for primary group
	  w/mysql

2002-06-30 09:48  castaglia

	* src/inet.c:
	  Fixed potential loop problem I inadvertently introduced in the
	  previous check-in.  Oops.

2002-06-28 11:43  castaglia

	* include/proftpd.h, modules/mod_xfer.c, src/data.c, src/inet.c,
	  src/io.c, src/main.c:
	  Fixing consequences of signal handler changes of Bug#1556,
	  allowing for child processes to process their received signals as
	  well (all noted in the bug report).

2002-06-27 20:16  castaglia

	* contrib/mod_sql.c:
	  Correctly check cmap.grpgidfield, rather than cmap.gidfield, when
	  looking up groups by ID.  This was my fault.

2002-06-27 15:39  castaglia

	* configure:
	  Updated configure script

2002-06-27 15:36  castaglia

	* NEWS, config.h.in, configure.in, modules/mod_unixpw.c:
	  Bug#1667 - Move USESHADOW, AUTOSHADOW defines from command line
	  into config.h

2002-06-27 15:09  castaglia

	* contrib/mod_sql.c:
	  Convert some of the configuration handlers to allocating memory
	  for passing numeric values, rather than squeezing them into void
	  *.  This fixes a border case where using 0 as the value for
	  SQLDefault{UID,GID} or SQLMinUser{ID,UID,GID} would cause that
	  directive setting to not be honored; a value of zero cast as a
	  void * means that that void * would most likely be interpreted as
	  NULL upon retrieval.

2002-06-27 14:18  castaglia

	* contrib/mod_sql.c:
	  Removed extraneous parameters from logging calls (caught by
	  __attribute__).

2002-06-27 12:27  castaglia

	* NEWS, contrib/mod_quota.c:
	  Removed mod_quota.c due to lack of maintainership, bugs.

2002-06-27 12:24  flyhmstr

	* doc/ShowUndocumented: ML: removing the showundocumented script as
	  it's no longer useful in this repository

2002-06-27 12:23  flyhmstr

	* doc/Configuration.html: ML:	Updated directive list

2002-06-27 11:35  flyhmstr

	* modules/mod_core.c: ML: fixing minor typo :)

2002-06-27 00:31  castaglia

	* include/log.h, include/proftpd.h, modules/mod_auth.c,
	  modules/mod_xfer.c:
	  Committed the use of gcc's __attribute__ pragma for printf-style
	  function argument checking from Bug#1643.  Fixed the minor printf
	  issues this pragma subsequently found in the TimeoutSession code,
	  throttling code.

2002-06-26 19:33  castaglia

	* NEWS, contrib/mod_sql.c:
	  Bug#1664 - mod_sql segfaults on cache miss for bogus user.

2002-06-26 16:10  castaglia

	* src/inet.c:
	  Use the IPPROTO_TCP macro (that's what it's there for!) for
	  initializing the value of tcp_proto, instead of manually setting
	  it to 6.

2002-06-26 10:32  jwm

	* Makefile.in:
	  #1569 - EXEEXT support

2002-06-25 19:54  castaglia

	* NEWS, include/inet.h, include/io.h, src/data.c, src/inet.c,
	  src/io.c:
	  Bug#1502 - 226 Transfer Complete sent out before data connection
	  is closed

2002-06-25 14:58  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#1655 - Add -n listing option to mod_ls

2002-06-25 13:56  castaglia

	* config.h.in:
	  Solaris already defines _FILE_OFFSET_BITS in its system headers
	  (at least 2.8 does); check for a defined _FILE_OFFSET_BITS before
	  redefining it.

2002-06-25 13:42  castaglia

	* src/: main.c, support.c:
	  Put proper #ifdefs around things to avoid some compiler warnings.

2002-06-25 10:56  castaglia

	* config.h.in:
	  Added lines for endprotoent, setgroups, setprotoent detection
	  performed by autoconf, removed duplicate HAVE_SETPROCTITLE line.

2002-06-25 10:35  castaglia

	* include/conf.h:
	  Add checking of SIZEOF_UNSIGNED_LONG_LONG to the list of macros
	  used for determining when to use %lu and when to use %llu.
	  FreeBSD does not require the other macros used (_FILE_OFFSET_BITS
	  or _LARGE_FILES), and so this additional check (which assumes
	  that if the size of an unsigned long long is 8 bytes, the
	  underlying platform will support use of %llu -- and we all know
	  what happens when one assumes) is required for proper LFS
	  detection and support on FreeBSD (and perhaps other platforms?).

2002-06-25 10:17  castaglia

	* contrib/mod_sql.c:
	  Added LFS-specific format macro, fixed NULL/'\0' comparison (was
	  causing a compiler warning).

2002-06-25 09:52  castaglia

	* modules/mod_xfer.c:
	  One more minor LFS-related modification.

2002-06-25 09:37  castaglia

	* src/auth.c:
	  Fixed minor indentation/spacing.

2002-06-24 21:27  jwm

	* contrib/mod_ldap.c:
	  #1659 - LDAP config handlers should use c->pool instead of
	  permanent_pool

2002-06-24 17:38  castaglia

	* modules/mod_unixpw.c:
	  Fixed compiler warning on FreeBSD concerning return value of the
	  setgrent(3) function.

2002-06-24 16:24  castaglia

	* modules/: mod_auth.c, mod_core.c:
	  Changed use of permanent_pool to c->pool in configuration
	  handlers where appropriate.

2002-06-24 08:23  castaglia

	* modules/mod_ls.c:
	  Forgot to remove the ShowDotFiles configuration handler function.

2002-06-24 08:19  castaglia

	* NEWS, modules/mod_ls.c, modules/mod_site.c:
	  Removed the deprecated AllowChmod and ShowDotFiles directives.

2002-06-23 15:14  castaglia

	* NEWS, include/dirtree.h, src/dirtree.c:
	  Bug#1171 - Add ability to handle backslash-escaped lines in
	  configuration file

2002-06-23 15:12  jwm

	* NEWS:
	  where the hell did I get 1304? this is #1569...

2002-06-23 15:10  jwm

	* NEWS:
	  updates

2002-06-23 14:56  castaglia

	* NEWS:
	  Noting addition/work on Cygwin stuff.

2002-06-23 12:09  castaglia

	* README.cygwin:
	  Minor spelling correction.

2002-06-23 12:07  jwm

	* configure:
	  updated configure for #1304 - Cygwin support

2002-06-23 12:06  jwm

	* README.cygwin:
	  #1304 - README.cygwin Thanks to Stanislav Sinyagin
	  <ssinyagin@yahoo.com>

2002-06-23 12:03  castaglia

	* include/conf.h, include/data.h, include/default_paths.h,
	  include/dirtree.h, include/fs.h, include/ident.h, include/inet.h,
	  include/io.h, include/libsupp.h, include/log.h,
	  include/modules.h, include/options.h, include/pool.h,
	  include/privs.h, include/proftpd.h, include/sets.h,
	  include/support.h, include/timers.h, src/auth.c, src/data.c,
	  src/dirtree.c, src/fs.c, src/ftpcount.c, src/ftpshut.c,
	  src/ftpwho.c, src/ident.c, src/inet.c, src/io.c, src/log.c,
	  src/main.c, src/modules.c, src/pool.c, src/sets.c, src/support.c,
	  src/timers.c, src/utils.c:
	  Updated copyrights.

2002-06-23 11:56  jwm

	* src/log.c, configure.in, src/inet.c, src/auth.c:
	  cleaned up versions of #1304 - Cygwin support

2002-06-22 13:17  jwm

	* modules/mod_xfer.c:
	  minor LFS fix

2002-06-22 11:13  jwm

	* config.guess, config.sub:
	  update config.guess and config.sub from
	  http://subversions.gnu.org/cgi-bin/viewcvs/config/config/;
	  parisc-linux support wasn't in our copies

2002-06-22 00:02  castaglia

	* src/: ftpcount.1, ftpshut.8, ftpwho.1, proftpd.8:
	  Minor corrections to man pages.

2002-06-21 18:06  castaglia

	* NEWS, lib/Makefile.in, lib/glibc-glob.c, src/data.c,
	  src/dirtree.c, src/ftpcount.c, src/io.c, src/log.c, src/main.c,
	  src/pool.c, src/timers.c:
	  Bug#1650 - Code cleanup

2002-06-21 17:54  castaglia

	* modules/mod_auth.c:
	  Fixed bad patching of the new TimeoutSession code.

2002-06-21 17:47  castaglia

	* NEWS, include/proftpd.h, modules/mod_auth.c:
	  Bug#1306 - Add timeout for entire session

2002-06-21 17:24  castaglia

	* modules/mod_auth.c, modules/mod_core.c, modules/mod_log.c,
	  modules/mod_ls.c, modules/mod_site.c, modules/mod_xfer.c,
	  src/dirtree.c:
	  In the aftermath of Bug#1650, I went through most of the
	  configuration directive handlers, looking for similar possible
	  mergedown bugs.  I corrected the lurking mergedown bugs I saw,
	  and fixed other cases where merging down was inappropriately
	  being requested.  More cleanup and code consolidation is
	  possible, and indeed recommended.

2002-06-21 12:36  castaglia

	* modules/mod_core.c:
	  Fixed instance of pstrcat() call that did not properly have NULL
	  as the last argument.

2002-06-21 11:54  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#1650 - LsDefaultOptions doesn't work inside anon context

2002-06-20 17:40  castaglia

	* NEWS, modules/mod_ls.c:
	  Bug#1647 - Unnecessary use of umode_t in mod_ls

2002-06-14 09:41  jwm

	* Makefile.in:
	  these symlinks aren't needed

2002-06-14 09:36  jwm

	* contrib/mod_ldap.c:
	  LDAPHomedirOnDemand cleanup/fixes

2002-06-14 09:19  castaglia

	* Makefile.in:
	  Added .cvsignore files to the list of files cleaned up by 'make
	  distclean'

2002-06-14 08:55  jwm

	* doc/: API, development.notes:
	  removing old cruft

2002-06-12 12:11  castaglia

	* modules/mod_ls.c:
	  Corrected spacing

2002-06-11 10:13  castaglia

	* configure:
	  Updated configure script for LFS support detection.

2002-06-11 10:09  castaglia

	* NEWS, config.h.in, configure.in, include/conf.h, include/data.h,
	  include/log.h, include/proftpd.h, include/support.h,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_xfer.c, src/data.c, src/log.c, src/support.c:
	  Bug#1534 - Large File Support

2002-06-11 09:19  castaglia

	* configure:
	  Updated configure script

2002-06-11 09:18  castaglia

	* Make.rules.in, NEWS, config.h.in, configure.in,
	  include/libsupp.h, include/proftpd.h, lib/glibc-mkstemp.c,
	  modules/mod_core.c, modules/mod_xfer.c, src/data.c:
	  Bug#1258 - STOU not implemented

2002-06-11 08:34  castaglia

	* NEWS, src/auth.c:
	  Bug#1463 - Add auth handler dispatch reporting at new debug level
	  (level 6)

2002-06-11 07:54  castaglia

	* src/main.c:
	  Removed relic function prototype (not needed).

2002-06-11 07:49  castaglia

	* NEWS, include/options.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_ls.c, modules/mod_xfer.c, src/dirtree.c, src/log.c,
	  src/main.c, src/pool.c:
	  Bug#1556 - Signal handlers use unsafe functions

2002-06-11 07:36  castaglia

	* NEWS, include/dirtree.h, include/modules.h, modules/mod_core.c,
	  src/dirtree.c, src/main.c, src/modules.c, src/proftpd.8:
	  Added Define, <IfDefine>, <IfModule> configuration directives, -D
	  command-line option

2002-06-11 07:30  castaglia

	* NEWS, include/version.h, modules/mod_xfer.c, src/data.c:

	  Bug#1407 - ftp protocol differences

2002-06-08 19:55  castaglia

	* NEWS: Fixed version number.  Sheesh.

2002-06-08 19:40  castaglia

	* ChangeLog:
	  Updated ChangeLog

2002-06-08 19:38  castaglia

	* NEWS, contrib/mod_sql.c, contrib/mod_sql_mysql.c,
	  include/version.h:

	  Bug#1379 - Replace bzero/bcopy with memset/memcpy Bug#1576 -
	  SQLHomedirOnDemand segfaults in certain circumstances Bug#1586 -
	  Bad row count assumption in _sql_getgroup() Bug#1625 - Compile
	  problem with mod_sql module

	  Preparing for release of 1.2.5 (stable).

2002-06-06 09:14  castaglia

	* NEWS, contrib/mod_sql.c:

	  Added the mod_sql-4.08 from Andrew's site

2002-05-30 14:09  castaglia

	* NEWS:

	  Updated NEWS

2002-05-30 13:13  castaglia

	* include/version.h:

	  Damn, I forgot to update this file.

2002-05-30 13:07  castaglia

	* ChangeLog:

	  Updating ChangeLog

2002-05-30 09:22  castaglia

	* NEWS, contrib/xferstats.holger-preiss:

	  Bug#1394: ftpstats program is not working, cust says "There was
	  no data to	       process."

2002-05-30 09:06  jwm

	* contrib/mod_ldap.c:
	  a few memory management fixes

2002-05-28 18:09  jwm

	* doc/rfc/: draft-ietf-ftpext-mlst-12.txt,
	  draft-ietf-ftpext-mlst-15.txt:
	  new version of mlst draft. the changes don't appear to change
	  anything we currently implement.

2002-05-26 19:31  jwm

	* contrib/: README.ratio, mod_ratio.c:
	  new mod_ratio from James Dogopoulos

2002-05-22 10:08  flyhmstr

	* doc/Configuration.html: ML: replacing the directive guide

2002-05-21 13:47  castaglia

	* NEWS, contrib/mod_readme.c, include/data.h, include/dirtree.h,
	  include/fs.h, include/ident.h, include/inet.h, include/io.h,
	  include/libsupp.h, include/log.h, include/modules.h,
	  include/pool.h, include/proftpd.h, include/sets.h,
	  include/support.h, include/timers.h, lib/glibc-glob.c,
	  modules/mod_auth.c, modules/mod_core.c, modules/mod_log.c,
	  modules/mod_ls.c, modules/mod_pam.c, modules/mod_site.c,
	  modules/mod_unixpw.c, modules/mod_xfer.c, src/data.c,
	  src/dirtree.c, src/fs.c, src/inet.c, src/io.c, src/log.c,
	  src/main.c, src/modules.c, src/pool.c, src/support.c,
	  src/timers.c, src/utils.c:

	  Bug#1379 - Replace bzero/bcopy with memset/memcpy Bug#1521 -
	  Function prototype cleanup

2002-05-21 11:59  castaglia

	* NEWS, src/timers.c:

	  Bug#1627 - Sessions not timing out

2002-05-21 11:29  castaglia

	* configure:

	  TJ: updated configure script to match configure.in (necessary
	  delay in     commits *sigh*)

2002-05-21 11:26  castaglia

	* configure.in:

	  TJ: changing configure script to check for $Libraries$ line in
	  mod_<name>.h	   files, if present, as well as mod_<name>.c files
	  (which are currently	   scanned)

2002-05-19 13:50  castaglia

	* NEWS, modules/mod_xfer.c:

	  TJ: Bug#1595 - ProFTPD closes connection when accessed from Lynx
	  browser

2002-05-19 13:45  castaglia

	* NEWS, include/proftpd.h, src/log.c, src/main.c:

	  TJ: Bug#1612 - missing/broken ident logging

2002-05-19 07:38  jwm

	* contrib/dist/rpm/proftpd.spec.in:
	  oops, that wasn't ready for commit yet. reverting to 1.12.

2002-05-19 07:35  jwm

	* Makefile.in, contrib/mod_ldap.c,
	  contrib/dist/rpm/proftpd.spec.in:
	  #1626 - install_user is not used everywhere

2002-05-18 08:06  jwm

	* contrib/dist/rpm/ftp.pamd:
	  language cleanup/clarification

2002-05-18 07:59  jwm

	* contrib/dist/rpm/proftpd.init.d:
	  cleanup

2002-05-18 07:48  jwm

	* contrib/dist/rpm/proftpd.spec.in:
	  fixing a typo (' -> `)

2002-05-15 05:55  jwm

	* contrib/mod_ldap.c:
	  2.8.4: fix for segfaults when optional arguments are omitted from
	  LDAPDoGIDLookups directive

2002-05-13 07:07  castaglia

	* ChangeLog:

	  TJ: latest ChangeLog

2002-05-13 07:05  castaglia

	* NEWS, include/version.h:

	  TJ: updated NEWS, version.h with date of 1.2.5rc2 release

2002-05-12 22:16  castaglia

	* configure:

	  TJ: here's the new configure to go with the configure.in

2002-05-12 22:15  castaglia

	* configure.in:

	  TJ: being pedantic, changing the order of functions check to be
	  alphabetical.      Also, I need to check configure.in separately
	  from, and before, configure.	    This is so that when users
	  download from CVS, and run ./configure && make,      the make
	  program's check of the timestamp on configure.in shows an
	  earlier date on configure.in than on configure (if both
	  configure.in and	configure are checked into CVS
	  simultaneously, they will have the same      timestamps, and make
	  will cause the configure script to be run again).	 What a
	  pain.

2002-05-12 22:03  castaglia

	* configure.in:

	  TJ: updated configure.in's copyright information

2002-05-12 16:22  castaglia

	* contrib/README.mod_wrap:

	  TJ: updated README for mod_wrap-1.2.3.

2002-05-12 15:43  castaglia

	* CREDITS:

	  TJ: updated PGP key fingerprint

2002-05-12 14:02  flyhmstr

	* doc/: Configuration.html, faq.html: ML: updated directive list
	  and FAQ for rc2

2002-05-12 13:48  castaglia

	* config.h.in, configure, configure.in, include/io.h,
	  include/proftpd.h, modules/mod_xfer.c:

	  TJ: Added missing checks for functions/headers to configure,
	  needed/used by     include/glibc-glob.c.  Also made small
	  amendments to code (volatility     of flag variables and minor
	  spacing).

2002-05-11 06:49  flyhmstr

	* doc/Configuration.html: ML: updated directive list

2002-05-11 02:55  flyhmstr

	* CREDITS, NEWS: ML: updated NEWS and CREDITS

2002-05-11 02:26  flyhmstr

	* NEWS: ML: news update

2002-05-11 02:25  flyhmstr

	* doc/faq.html: ML: adding new format FAQ

2002-05-10 13:14  castaglia

	* NEWS:

	  Bug#1580 - RPM can't be built by non-root user

2002-05-10 13:08  castaglia

	* contrib/dist/rpm/proftpd.spec.in:

	  Bug#1580 - RPM can't be built by non-root user

2002-05-10 10:59  flyhmstr

	* CREDITS, NEWS: ML: updated credits and news

2002-05-10 10:53  castaglia

	* NEWS, configure, configure.in:

	  Bug#1546 - PF_ARGV_WRITABLE, PF_ARGV_WRITEABLE are used mixed.

2002-05-10 10:28  castaglia

	* NEWS, modules/mod_core.c, src/dirtree.c:

	  Bug#1608 - src/dirtree.c produces two unnecessary warnings
	  Bug#1610 - compiling mod_core.c gives an unneeded/dazzling msg

2002-05-10 10:04  flyhmstr

	* NEWS: ML: updating NEWS

2002-05-10 09:52  flyhmstr

	* include/ftp.h: ML: updating licence

2002-05-10 09:50  flyhmstr

	* doc/: Changes-1.2.0pre3, FAQ-config.html, Undocumented.txt,
	  license.txt, mod_sample.c:
	  ML:	Removed legacy files   The FAQ is removed because it's
	  superceed by the main FAQ.

	    Updated the base licence text with additional copyright info,
	    consistancy typo and the SSL exclusion clause.

2002-05-10 06:00  jwm

	* NEWS:
	  updating for mod_ldap 2.8.3 release

2002-05-10 06:00  jwm

	* ChangeLog:
	  updating changelog

2002-05-10 05:51  jwm

	* contrib/mod_ldap.c:
	  updating to 2.8.3

2002-05-10 05:49  jwm

	* README.LDAP:
	  new mod_ldap README

2002-05-10 01:05  castaglia

	* src/: ident.c, inet.c:

	  TJ: dealing with consequences of Bug#1588 fix, which happens to
	  affect     identd lookups.  Hopefully these changes clear up any
	  remaining	difficulties while still retaining the efficacy of
	  Bug#1588's patch.

2002-05-09 15:59  castaglia

	* src/ident.c:

	  TJ: cleaned up get_ident(), adding proper
	  cleanup/resource-freeing code     at various exit points from the
	  function

2002-05-09 14:29  castaglia

	* src/ident.c:

	  TJ: fixed get_ident() to check for NULL return value from
	  inet_openrw();     this was causing segfaults in the case where
	  an identd server was not     returning a response

2002-05-09 13:42  castaglia

	* src/main.c:

	  TJ: mistakenly changed default setting of IdentLookups to "off"
	  with prior	 changes, setting default back to "on"

2002-05-09 13:15  castaglia

	* modules/mod_auth.c, modules/mod_core.c, src/main.c, src/timers.c:


	  TJ: fixed remove_timer() call to check for NULL timers list
	  before cycling       through the list     changed IdentLookups
	  handler to use pointers (and thus avoid compiler	 warnings
	  about typecasts)     minor reformatting

2002-05-09 10:42  castaglia

	* NEWS:

	  TJ: updated NEWS

2002-05-09 10:36  castaglia

	* configure, configure.in, include/log.h, include/modules.h,
	  include/privs.h, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_unixpw.c, src/dirtree.c, src/main.c:

	  #1544 - Daemon does not switch to configured User/Group identity
	  in	     <VirtualHost> as documented #1581 - uid_t and
	  get_param_int result size

2002-05-08 13:55  flyhmstr

	* NEWS: ML: news update

2002-05-08 13:51  flyhmstr

	* doc/Configuration.html: ML: adding new version of the directive
	  list

2002-05-08 13:50  flyhmstr

	* doc/Configuration.html: ML: removing old version of directive
	  list

2002-05-08 13:34  castaglia

	* ChangeLog:

	  Updated ChangeLog

2002-05-08 12:44  castaglia

	* NEWS:

	  TJ: added NEWS entries for recently committed patches for
	  (fixed?) bug	   reports

2002-05-08 12:21  castaglia

	* modules/mod_auth.c, src/dirtree.c, src/inet.c, src/main.c,
	  src/pool.c:

	  #1523 - "Umask" presented in <Global> block messes up file
	  permissions #1566 - FXP not working properly #1578 - RootLogin
	  directive does not mergedown properly

2002-05-08 11:39  castaglia

	* contrib/dist/rpm/proftpd.init.d, modules/mod_auth.c,
	  modules/mod_core.c, src/dirtree.c, src/inet.c:

	  #1563 - Proftpd 1.2.4. keeps core dumping sig11 on start #1567 -
	  AuthAliasOnly parsed incorrectly #1570 - MasqueradeAddress
	  contexts do not match documentation #1579 - Contrib init.d script
	  makes inappropriate use of ftpshut #1588 - Port scan of TCP/21
	  causes segmentation fault #1601 - Rename terminates ProFTPD
	  (signal 11)

2002-03-06 08:56  flood

	* ChangeLog: Updated ChangeLog.

2002-03-06 08:56  flood

	* NEWS, doc/Configuration.html, modules/mod_core.c, src/main.c:
	  #1445: PID file contents change when attempting to start
	  the daemon a second time #1539: losing SGID bit on created
	  directories w/ {User,Group}Owner	  in effect #1537: doc
	  update

2002-02-28 18:49  flood

	* src/log.c: possible sigsegv introduced by patch for bug 1520

2002-02-28 11:43  flood

	* NEWS, src/dirtree.c: #1468 - segfault with empty .ftpaccess

2002-02-28 11:32  flood

	* ChangeLog: Updated ChangeLog.

2002-02-28 11:30  flood

	* NEWS, doc/Configuration.html, include/privs.h, lib/getopt.c,
	  lib/getopt.h, lib/getopt1.c, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_unixpw.c, src/dirtree.c,
	  src/main.c, src/support.c: #1459 - server fails to send response
	  in some cases #1533 - use memset correctly #1517 - doc update
	  #1461 - modules/mod_unixpw.c pw_getgroups() makes dangerous
	  assumption #1512 - Minor credentials cleanups #1516 - wrong
	  response to CDUP/XCUP/XCWD #1451 - add_config_param_str() no
	  longer uses permanent_pool #1523 - umask allocation in <Global>
	  moved to permanent_pool #1380 - updated getopt library for
	  Tru64/AIX

2002-02-28 11:13  flood

	* NEWS, doc/Configuration.html, include/dirtree.h, include/log.h,
	  lib/pwgrent.c, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_log.c, modules/mod_xfer.c, src/dirtree.c, src/log.c:
	  #1476 doc updates #1520 security checks for TransferLogs #1435
	  AccessDenyMsg for <Anonymous> not working #1492 Bad interaction
	  between HiddenStor and UserOwner #1493 incorrect parsing of
	  AuthUserFile #1485 Adds CF_MERGEDOWN_MULTI config_rec flag

2002-02-26 09:35  flood

	* NEWS, include/glibc-glob.h, lib/glibc-glob.c, modules/mod_auth.c,
	  src/data.c, src/dirtree.c, src/fs.c, src/inet.c, src/log.c,
	  src/main.c, src/support.c: #1378 Replace alloca stuff in
	  glibc-glob.c with something more standard #1498 <Limit LOGIN>
	  block failing with mod_ldap #1381 include/glibc-glob.h fix for
	  Tru64 UNIX #1465 can't bind to port that hasn't been closed by
	  forked child	     process #1379 replace bzero/bcopy with
	  memset/memcpy

2002-02-14 08:50  flood

	* NEWS, contrib/ftpasswd, contrib/ftpasswd.html: added
	  contrib/ftpasswd utility script (contributed by TJ)

2002-02-14 08:39  flood

	* NEWS, contrib/INSTALL.mod_wrap, contrib/README.mod_wrap,
	  contrib/genuser.pl, contrib/mod_wrap.c, contrib/mod_wrap.html:
	  New mod_wrap (1.2.3) removed contrib/genuser.pl (per TJ)

2002-01-23 16:22  flood

	* ChangeLog: Updated ChangeLog.

2002-01-23 16:21  flood

	* NEWS, src/data.c, src/dirtree.c, src/timers.c: #1318 sendfile()
	  semantics incorrect under Linux #1450 Timers removed
	  immediately/alarm() return no longer used for timing #1446
	  DefaultServer overrides SocketBindTight

2001-12-18 08:21  flood

	* ChangeLog: Updated ChangeLog.

2001-12-18 08:21  flood

	* NEWS, include/version.h: bumped version

2001-12-18 08:14  flood

	* NEWS, doc/Configuration.html, modules/mod_ls.c: New Directive:
	  UseGlobbing, allows glibc-based filepath globbing to be disabled.

2001-12-17 12:39  flood

	* ChangeLog: Updated ChangeLog.

2001-12-17 12:39  flood

	* ChangeLog, NEWS, modules/mod_xfer.c: - Check retr_file for
	  validity when RESToring

2001-12-17 12:36  flood

	* NEWS, modules/mod_xfer.c: - Bug 1391 - ABOR handler now clears
	  session.xfer

2001-12-17 12:07  flood

	* NEWS, modules/mod_ls.c, modules/mod_xfer.c, src/data.c: - Bug
	  1392 - Added LOG_CMD_ERR cleanup handler for LIST/NLST/RETR/
		  STOR/APPE/STOU, to defer clearing of transfer counters.

2001-12-17 09:58  flood

	* NEWS, README.LDAP, contrib/mod_ldap.c: New mod_ldap (2.8.1)

2001-12-13 12:37  flood

	* ChangeLog: Updated ChangeLog.

2001-12-13 12:35  flood

	* NEWS, configure, configure.in, doc/Configuration.html,
	  include/modules.h, include/support.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_pam.c, modules/mod_unixpw.c, modules/mod_xfer.c,
	  src/auth.c, src/dirtree.c, src/fs.c, src/inet.c, src/main.c,
	  src/support.c, src/timers.c: - Bug 1364 - Immediate chown() after
	  file creation - Bug 1415 - Change allowed contexts for Include -
	  Bug 1430 - Possible bad handling of Directory contexts - Bug 1426
	  - sigsegv on `ls ///////////' - Bug 1360 - Add getgroups
	  abstraction for auth modules - Bug 1289 - Increase information
	  passed to timer callbacks - Bug 1341 - Bad tracking of forked
	  processes - Bug 1400 - Improper use of MODRET_HASDATA macro - Bug
	  1416 - PidFile in <Global> context is unnecessary, even wasteful
	  - Bug 1429 - Trivial fixes to dispatch reporting - Bug 1419 -
	  Remove unnecessary colons from PRIVS_ macros - Bug 1418 - Slight
	  change to exithandler handling to allow module
	  finalization slot

2001-12-13 08:15  flood

	* contrib/mod_sql.h: forgot to add contrib/mod_sql.h in previous
	  commit

2001-11-30 09:34  flood

	* ChangeLog: updated ChangeLog

2001-11-30 09:34  flood

	* NEWS, README.mod_sql, contrib/UPGRADE.mod_sql, contrib/mod_sql.c,
	  contrib/mod_sql_mysql.c, contrib/mod_sql_postgres.c,
	  sample-configurations/mod_sql.conf: new mod_sql (4.07)

2001-11-29 10:54  flood

	* NEWS, include/dirtree.h, modules/mod_core.c, src/dirtree.c,
	  src/main.c, src/support.c: #1396 DenyFilter works only in server
	  config scope #1410 SIGIO now conditionally compiled #1281
	  Improper checking of server context

2001-11-29 10:20  flood

	* ChangeLog: updated ChangeLog

2001-11-29 10:20  flood

	* NEWS, include/modules.h, modules/mod_core.c, src/dirtree.c,
	  src/main.c: #1368 umask bug hopefully squashed for good #1389
	  fixed hang on PWD #1355 added POST_CMD_ERR handler to API

2001-11-08 09:30  flood

	* NEWS, configure, configure.in: #1113-Make.rules for HPUX
	  incorrectly generated

2001-11-08 09:28  flood

	* NEWS, contrib/README.mod_wrap, contrib/mod_wrap.c: new mod_wrap
	  (1.2.2) from tj

2001-11-08 09:24  flood

	* NEWS, modules/mod_auth.c: #1334-MaxClients none forbids connect

2001-10-19 08:31  flood

	* ChangeLog: Updated ChangeLog.

2001-10-19 08:28  flood

	* include/version.h: 1.2.4

2001-10-19 08:27  flood

	* NEWS, modules/mod_core.c, src/dirtree.c: 1348-umask argument not
	  stored correctly

2001-10-18 10:13  flood

	* ChangeLog: Updated ChangeLog

2001-10-18 10:13  flood

	* NEWS, include/version.h: 1.2.3-release

2001-10-18 10:11  flood

	* ChangeLog: Updated ChangeLog.

2001-10-18 10:10  flood

	* NEWS, doc/Configuration.html, modules/mod_core.c,
	  modules/mod_log.c, modules/mod_site.c, src/main.c:
	  1344-ExtendedLog now logs QUIT command 1332-Doc patch 1335-Doc
	  patch 1334-Max* none fix 1343-better reporting of command
	  dispatching 1242-more verbose logging of regex

2001-10-18 09:51  flood

	* NEWS, src/dirtree.c: #1247 - Fix Allow/Deny boolean logic.

2001-09-26 08:35  flood

	* NEWS, modules/mod_core.c: #1327 AllowForeignAddress mergedown

2001-09-26 08:34  flood

	* NEWS, include/dirtree.h, modules/mod_core.c, src/dirtree.c: #1280
	  datatype fixups

2001-09-26 08:32  flood

	* NEWS, modules/mod_ls.c: #1311 - sigsegv under DirFake* directives

2001-09-26 08:00  flood

	* NEWS, include/conf.h: #1305 - limits.h now included

2001-09-26 07:58  flood

	* NEWS, src/inet.c: #1331 - forward-resolve reverse dns

2001-08-24 10:33  flood

	* src/main.c: patched to not display PASS password on proctitle

2001-08-17 08:43  flood

	* ChangeLog: Updated ChangeLog.

2001-08-17 08:43  flood

	* NEWS, include/version.h: 1.2.2-final

2001-08-16 13:00  flood

	* include/conf.h: Double license in header conf.h

2001-08-16 12:58  flood

	* ChangeLog: Updated ChangeLog.

2001-08-16 12:58  flood

	* ChangeLog, NEWS, contrib/mod_test.c, doc/Configuration.html:
	  Updated docs, moved mod_test.c to attic

2001-08-16 12:54  flood

	* NEWS, modules/mod_ls.c, modules/mod_xfer.c, src/support.c: 1273 -
	  DirFakeGroup merges down 1286 - mod_ls displays set[ug]id bits
	  1266 - APPE could corrupt files 1278 - access_check() does not
	  set errno properly

2001-08-16 11:54  flood

	* NEWS, contrib/mod_sql.c: new mod_sql

2001-08-01 08:18  flood

	* ChangeLog: Updated ChangeLog.

2001-08-01 08:18  flood

	* NEWS, README.mod_sql: README.mod_sql update from author

2001-08-01 08:17  flood

	* INSTALL, NEWS, contrib/mod_quota.c, doc/Configuration.html,
	  modules/mod_ls.c, src/xferlog.5: #1187 Upstream update to
	  mod_quota #1217,1262,1111,1216 Documentation updates #1145
	  DirFakeUser now applies to STAT as well as LIST/NLST

2001-08-01 08:03  flood

	* NEWS, include/proftpd.h, modules/mod_core.c, modules/mod_xfer.c,
	  src/dirtree.c, src/main.c: #1219 - gcc 3.0 fix #1232 - UserOwner
	  changes both uid and gid

2001-07-04 08:28  flood

	* ChangeLog: Updated ChangeLog.

2001-07-04 08:28  flood

	* NEWS, src/log.c: #1230 - size mismatch struct utmpx in Solaris 8
	  (sparcv9)

2001-07-03 07:51  flood

	* NEWS, modules/mod_auth.c: #1098 - Non~* DefaultRoot bug

2001-07-03 07:49  flood

	* NEWS, modules/mod_xfer.c: #1234 ABOR must always return 226

2001-07-02 11:56  flood

	* NEWS, contrib/mod_sql.c: New mod_sql

2001-06-19 18:23  flood

	* ChangeLog: Updated ChangeLog.

2001-06-19 18:23  flood

	* NEWS, include/version.h: Bump version, final commit for 1.2.2rc3

2001-06-19 18:19  flood

	* NEWS, src/main.c: #1215 - Removes setpgid from fork_server

2001-06-19 18:17  flood

	* NEWS, modules/mod_ls.c: #1145 - DirFakeUser can display currently
	  logged in user

2001-06-19 18:13  flood

	* NEWS, doc/Configuration.html: #1164,1020,1134,1190,1207 - Doc
	  updates

2001-06-19 11:51  flood

	* NEWS, src/data.c: #1210 Possible silent truncation in net-ascii
	  mode

2001-06-18 11:02  flood

	* NEWS, modules/mod_ls.c, src/dirtree.c: #1212 Special files in
	  directory listings

2001-06-18 10:40  flood

	* ChangeLog: Updated ChangeLog.

2001-06-18 10:39  flood

	* NEWS, modules/mod_core.c: #1189 Directory dups allowed in
	  Anonymous

2001-06-18 10:35  flood

	* NEWS, modules/mod_auth.c, modules/mod_core.c, modules/mod_ls.c,
	  src/dirtree.c, src/fs.c, src/main.c, src/support.c: #1155 - non
	  rfc behavior #1193 ~ files not handled correctly #1203 - '!' ACL
	  negation logic changed #1161 - %F displays free space on CWD
	  #1151 - <Limit> searching fix for Anon/Vhost root

2001-06-18 10:13  flood

	* ChangeLog: Updated ChangeLog.

2001-06-18 10:12  flood

	* NEWS, contrib/mod_linuxprivs.c, include/conf.h, include/data.h,
	  include/default_paths.h, include/dirtree.h, include/fs.h,
	  include/ident.h, include/inet.h, include/io.h, include/libsupp.h,
	  include/log.h, include/modules.h, include/options.h,
	  include/pool.h, include/privs.h, include/proftpd.h,
	  include/sets.h, include/support.h, include/timers.h,
	  modules/mod_auth.c, modules/mod_core.c, modules/mod_log.c,
	  modules/mod_ls.c, modules/mod_pam.c, modules/mod_site.c,
	  modules/mod_unixpw.c, modules/mod_xfer.c, src/auth.c, src/data.c,
	  src/dirtree.c, src/fs.c, src/ftpcount.c, src/ftpshut.c,
	  src/ftpwho.c, src/ident.c, src/inet.c, src/io.c, src/log.c,
	  src/main.c, src/modules.c, src/pool.c, src/sets.c, src/support.c,
	  src/timers.c, src/utils.c: Updated Copyright/License to allow
	  linking to OpenSSL

2001-06-03 08:17  flood

	* ChangeLog: Updated ChangeLog.

2001-06-03 08:17  flood

	* NEWS, modules/mod_auth.c, modules/mod_core.c, src/main.c: #1185 -
	  homedir symlink dereference #1189 - duplicated <Directory>
	  contexts not allowed #1183 - removed redundant find_class()

2001-06-03 06:38  flood

	* NEWS, contrib/xferstats.holger-preiss,
	  contrib/dist/rpm/proftpd.init.d, include/glibc-glob.h,
	  modules/mod_core.c, src/main.c: #1201 - Feature addition to
	  contrib/xferstats.holger-preiss #1132 - glibc2.0 compilation
	  #1090 - ExtendedLog not reporting errors on all events #1149 -
	  Modification in rpm init script

2001-05-31 09:08  flood

	* ChangeLog: Updated ChangeLog.

2001-05-31 09:08  flood

	* NEWS, README.mod_sql, contrib/mod_sql.c, contrib/mod_sql_mysql.c,
	  contrib/mod_sql_postgres.c: New mod_sql and friends

2001-05-21 14:15  flood

	* ChangeLog: Updated ChangeLog.

2001-05-21 14:14  flood

	* NEWS, contrib/mod_readme.c, include/conf.h, modules/mod_core.c,
	  modules/mod_readme.c: Bug 1175 - GNU HURD portability Bug 1177 -
	  mod_readme.c moved to contrib/ Bug 1176 - PWD/XPWD now G_DIRS and
	  limitable

2001-05-21 13:48  flood

	* NEWS, lib/glibc-glob.c: Bug 1155 - conditional HPUX headers in
	  glibc-glob.c

2001-05-16 20:22  flood

	* ChangeLog: Updated ChangeLog

2001-05-16 20:22  flood

	* NEWS, include/proftpd.h, lib/getopt.c, lib/pr_fnmatch.c,
	  lib/pr_fnmatch_loop.c, modules/mod_auth.c, src/inet.c,
	  src/main.c: #1156 - usernames w/ spaces #1160 - svr4.2mp;UX/4800
	  has bsd root socket semantics #1168 - cleanup #1169 -
	  DefaultRoot/DefaultChdir no longer mutually exclusive #1170 -
	  cleanup #1172 - cleanup

2001-05-16 07:35  flood

	* NEWS, src/inet.c: Bug #1152 - integer array overflow w.r.t.
	  PassivePorts

2001-04-23 20:36  flood

	* NEWS, modules/mod_ls.c: Bug 1137 - NLST displayed hidden files

2001-04-23 11:18  flood

	* NEWS: Final NEWS update for 1.2.2rc2 (old)

2001-04-20 08:20  flood

	* ChangeLog: Updated ChangeLog.

2001-04-20 08:20  flood

	* NEWS, include/version.h, src/main.c: Bug 1112 - removed in_addr
	  cast for better compilation on IRIX 6.2.

2001-04-20 05:31  flood

	* NEWS, modules/mod_site.c: Log warning when AllowChmod is used.

2001-04-18 08:45  flood

	* src/data.c: Ooops.  sendfile() Linux subtraction was backwards.
	  ;)

2001-04-18 08:40  flood

	* ChangeLog: Updated ChangeLog.

2001-04-18 08:40  flood

	* NEWS, src/data.c: Bug #1128 - Incorrect sendfile() semantics.

2001-04-13 11:32  flood

	* modules/mod_core.c: Fixed sigsegv on SITE bug, only in cvs
	  versions.

2001-04-11 13:20  flood

	* modules/mod_log.c, src/dirtree.c, src/log.c: small fixes to dr's
	  case insensitivity patch.  case sensitivity is actually required
	  in some places. ;)

2001-04-11 12:10  flood

	* NEWS, lib/glibc-glob.c, src/main.c: Bug 1119 - IRIX6 fix for
	  glibc-glob.c Bug 1090 - logging now works with PRE_CMD failed
	  handlers

2001-04-11 12:00  flood

	* ChangeLog: Updated ChangeLog.

2001-04-11 12:00  flood

	* src/dirtree.c: MasqueradeAddress now prints LOG_INFO message.

2001-04-11 11:57  flood

	* NEWS, contrib/mod_quota.c, include/log.h, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_unixpw.c, src/dirtree.c, src/ftpcount.c,
	  src/ftpshut.c, src/log.c: Bug #1093 - world writable
	  log/symlinked log files Bug #1094 - Auth{User,Group}File disallow
	  relative paths Bug #1096 - Case insensitivity/RLimit* args

2001-03-26 19:12  flood

	* ChangeLog: Updated ChangeLog.

2001-03-26 19:12  flood

	* doc/Configuration.html: Bugs #1088, 1058 & 1041 - Doc updates for
	  1.2.2.

2001-03-26 18:57  flood

	* NEWS: Updated NEWS version

2001-03-24 07:59  flood

	* ChangeLog: Final commit for 1.2.2rc1.

2001-03-24 07:59  flood

	* include/version.h: Bumped version number to 1.2.2rc1.

2001-03-24 07:56  flood

	* ChangeLog: Updated ChangeLog.

2001-03-24 07:56  flood

	* NEWS, modules/mod_auth.c: Bug #1085: better logging of two auth
	  messages in mod_auth.

2001-03-24 07:46  flood

	* NEWS, doc/Configuration.html, modules/mod_xfer.c: Bug #1043:
	  Possible inf. loop in throttle code.	Bug #1074: Doc fixes Bug
	  #1070: Doc fixes

2001-03-23 05:17  flood

	* NEWS, README.mod_sql, contrib/mod_sql.c, contrib/mod_sql_mysql.c,
	  include/proftpd.h, modules/mod_core.c, src/dirtree.c, src/main.c:
	  Bug #1075 - Fix for short copy of sub-contexts from <Global> New
	  mod_sql and mod_sql docs from maintainer New RLimit* directives
	  used to control resource limits

2001-03-23 04:54  flood

	* modules/mod_core.c, src/auth.c, src/main.c: Slightly better
	  handling of uid/gid type casts and conversions.

2001-03-22 13:43  flood

	* NEWS, modules/mod_auth.c: Bug #1049 - passwd/group files are now
	  close/re-opened at USER/PASS.

2001-03-22 12:56  flood

	* src/dirtree.c: Added debugging to umask code.

2001-03-21 16:12  flood

	* include/glibc-glob.h: glibc glob header should now be more
	  portable

2001-03-17 12:34  flood

	* Make.rules.in, NEWS, acconfig.h, config.h.in, configure,
	  configure.in, include/conf.h, include/glibc-glob.h,
	  include/libsupp.h, lib/glibc-glob.c, lib/glob.c, lib/glob.h,
	  src/fs.c: Bug #1066 - new GNU glob which protects against DoS
	  attacks.

2001-03-12 16:23  flood

	* ChangeLog: Updated ChangeLog.

2001-03-12 16:22  flood

	* contrib/mod_sql.c: New mod_sql from maintainer.

2001-03-11 06:23  flood

	* ChangeLog: Updated ChangeLog.

2001-03-11 06:23  flood

	* NEWS, modules/mod_core.c, src/main.c: Added MasqueradeAddress
	  feature.

2001-03-09 10:49  flood

	* NEWS, modules/mod_auth.c, modules/mod_core.c: Bug #1044 - New
	  directive: AccessDenyMsg

2001-03-09 10:16  flood

	* src/main.c: Bug #1056 (second part) - SIGSEGV is no longer
	  handled when inside the SIGSEGV handler.

2001-03-09 08:14  flood

	* NEWS, src/ftpcount.c: Bug #1055 - ftpwho/ftpcount scan
	  proftpd.conf for scoreboard path.

2001-03-09 05:54  flood

	* NEWS, config.h.in, configure, configure.in,
	  contrib/dist/rpm/proftpd.spec.in, src/ftpcount.1, src/ftpshut.8,
	  src/ftpwho.1, src/pool.c, src/proftpd.8, src/xferlog.5: Bug #1042
	  - Directory matching for / Bug #1051 - man pages reference
	  proftpd.net instead of .org New proftpd.spec.in from RPM
	  maintainer configure now tests for the limits.h header file

2001-03-01 08:00  flood

	* ChangeLog: Updated ChangeLog.

2001-03-01 08:00  flood

	* NEWS: New NEWS

2001-03-01 07:49  flood

	* ChangeLog: Updated ChangeLog.

2001-03-01 07:48  flood

	* README, README.mod_sql, README.ports: Updated READMEs.

2001-02-28 19:18  flood

	* NEWS, configure, configure.in, contrib/mod_sql.c,
	  contrib/mod_sql_mysql.c, include/version.h, modules/mod_core.c:
	  New mod_sql maintainer stuff.  Attempting to use classes without
	  "Classes On" emits a warning.

2001-02-28 15:01  flood

	* doc/rfc/draft-ietf-ftpext-mlst-08.txt,
	  doc/rfc/draft-ietf-ftpext-mlst-12.txt, include/pool.h,
	  modules/mod_auth.c, src/inet.c, src/pool.c: Bug #1037 - Fix for
	  netbsd sockets.  Bug #1039 - proper copying of session.groups New
	  MLST draft proposal

2001-02-28 09:07  flood

	* NEWS, configure, configure.in, modules/mod_xfer.c: Bug #1036 -
	  --disable-shadow now works.  More informative message for REST w/
	  HiddenStor.  Default CFLAGS changed from -O6 to -O2

2001-02-27 13:19  flood

	* contrib/: mod_ldap.c, mod_sql.c, dist/rpm/proftpd.spec.in:
	  Updated RPM spec (again) as well as new mod_ldap and mod_sql
	  contrib modules.

2001-02-27 11:20  flood

	* contrib/mod_sql.c, contrib/dist/rpm/proftpd.spec.in,
	  include/version.h: New RPM .spec and mod_sql.c

2001-02-26 12:14  flood

	* ChangeLog: Updated ChangeLog.

2001-02-26 12:13  flood

	* Makefile.in, NEWS, include/version.h: Final commit to 1.2.0-final
	  release

2001-02-26 09:59  flood

	* src/support.c: access_check() always succeeds for root now.

2001-02-26 09:50  flood

	* ChangeLog: Updated ChangeLog.

2001-02-26 09:50  flood

	* contrib/mod_ldap.c: New mod_ldap.c

2001-02-24 18:13  flood

	* contrib/mod_sql.c: Patch from mod_sql maintainer.

2001-02-24 16:40  flood

	* CREDITS, doc/Configuration.html: Bug #1034 - Final clean-up for
	  docs.  CREDITS - added Chuck

2001-02-23 20:11  flood

	* Makefile.in, configure, configure.in, contrib/README.mod_sql,
	  modules/mod_auth.c: Bug #1033 - access denied text fix Minor
	  tweaks to configure, updates distclean rule in Makefile

2001-02-23 19:53  flood

	* README.mod_sql, configure, configure.in, contrib/README.mod_sql,
	  contrib/mod_sql.c: Bug #1031 - update from mod_sql maintainer New
	  README.mod_sql configure no longer duplicates additional modules'
	  libraries.

2001-02-23 18:37  flood

	* ChangeLog: Updated ChangeLog.

2001-02-23 18:37  flood

	* CREDITS, README.mod_sql-3.0, contrib/README.mod_sql-3.0,
	  contrib/README.mod_sqlpw: Removed mod_sql docs per AAH.  New docs
	  will be added with more appropriate filenames.

2001-02-23 15:35  flood

	* CREDITS, README, README.ports, configure, configure.in,
	  contrib/mod_ratio.c, contrib/mod_sql.c,
	  contrib/mod_sql_postgres.c, lib/Makefile.in: Bug #1024 - minor
	  doc changes.	Bug #1025 - stop assuming the system has ranlib.
	  Bug #1028 - mod_sql_postgres.c patch from maintainer.  Bug #1029
	  - mod_sql.c patch from maintainer.  Bug #1030 - mod_ratio.c
	  should compile again.

2001-02-22 19:08  flood

	* ChangeLog: Updated ChangeLog.

2001-02-22 18:47  flood

	* NEWS, config.h.in, configure, configure.in, include/modules.h,
	  include/proftpd.h, modules/mod_auth.c, src/auth.c, src/dirtree.c,
	  src/main.c: Bug #259 - supplemental groups should now work better
	  for anonymous logins.

2001-02-22 16:59  flood

	* include/inet.h, src/inet.c, src/main.c: Bug #370 - race condition
	  under heavy load at child startup

2001-02-22 16:53  flood

	* contrib/mod_sql.c: New mod_sql 3.01 from Andrew Houghton
	  <aah@acm.org>

2001-02-22 16:36  flood

	* ChangeLog: Updated ChangeLog.

2001-02-22 16:35  flood

	* INSTALL, README, README.AIX, README.FreeBSD, README.modules,
	  README.ports, configure, configure.in, doc/Configuration.html,
	  sample-configurations/PFTEST.conf.in,
	  sample-configurations/PFTEST.group,
	  sample-configurations/PFTEST.install,
	  sample-configurations/PFTEST.passwd,
	  sample-configurations/PFTEST.shadow: Bug #1006 - Fixes in
	  configure.in	Bug #1022 - Docs updated for mod_sql. Bug #1024 -
	  Updated INSTALL, README and new READMEs and PFTEST files.

2001-02-22 15:32  flood

	* modules/mod_ls.c: Bug #1016 - Listing "." files should work again
	  + tweak to IgnoreHidden.

2001-02-22 14:39  flood

	* ChangeLog: Updated ChangeLog.

2001-02-22 14:39  flood

	* NEWS, include/dirtree.h, modules/mod_core.c, modules/mod_ls.c,
	  modules/mod_xfer.c, src/dirtree.c: Bug #1023 - Fix for
	  IgnoreHidden boolean patch problem introduced in rc2.

2001-02-21 20:51  flood

	* ChangeLog: Updated ChangeLog.

2001-02-21 20:51  flood

	* Make.rules.in, Makefile.in, include/.cvsignore,
	  include/version.h, modules/mod_unixpw.c, src/main.c: Build
	  timestamp is now reported at startup and with --version-status.
	  Removing includes from CFLAGS (CPPFLAGS is enough), changed
	  uid/gid cast from unsigned long long to unsigned long.

2001-02-21 18:48  flood

	* configure: configure needs a new timestamp :)

2001-02-21 18:44  flood

	* ChangeLog: Updated ChangeLog, re-ran autoconf

2001-02-21 17:48  flood

	* NEWS, src/log.c: Logging is now done with a single write()
	  syscall

2001-02-21 17:09  flood

	* modules/mod_core.c, src/main.c: Bug #1009 - FTP logins are now
	  logged to match logouts.

2001-02-21 14:33  flood

	* ChangeLog: Updated ChangeLog.

2001-02-21 14:33  flood

	* CREDITS, src/log.c: Bug #1021 - fix for ftpwho/ftpcount not
	  working (_pid_exists() in log.c)

2001-02-20 19:17  flood

	* modules/: mod_unixpw.c, mod_xfer.c: Bug #1015 - Format string for
	  long long uids.  REST command now returns failure message if used
	  where HiddenStor is enabled.

2001-02-20 18:40  flood

	* ChangeLog, NEWS: Updated NEWS

2001-02-20 18:33  flood

	* NEWS, doc/Configuration.html, include/ftp.h, modules/mod_xfer.c,
	  src/log.c: Bug #1003/1017 documentation fixes.  Bug #463 - no
	  longer possible to REST past the end of a file.
	  kill(pid,SIGCONT) in log.c switched to kill(pid,0)

2001-02-20 12:34  flood

	* configure, configure.in, include/version.h, src/main.c: Added
	  --version-status which displays extended version information.

2001-02-19 20:50  flood

	* src/main.c: Timeout and normal logout syslog messages are now
	  logged at LOG_INFO instead of LOG_NOTICE.

2001-02-19 19:26  flood

	* ChangeLog: Updated ChangeLog.

2001-02-19 19:26  flood

	* modules/mod_xfer.c: Bug #1012 - Fixed "Unable to throttle
	  bandwidth: Interrupted system call" issue.

2001-02-19 13:07  flood

	* README.mod_sql-3.0, contrib/README.mod_sql-3.0,
	  contrib/mod_sql.c, contrib/mod_sql_mysql.c,
	  contrib/mod_sql_postgres.c: Added AAH's newly-maintained mod_sql
	  3.0 back in to CVS.

2001-02-18 08:19  flood

	* ChangeLog: Updated ChangeLog.

2001-02-18 08:18  flood

	* contrib/dist/rpm/proftpd.spec.in: Bug #1005 - New RPM .spec.in
	  from droesen

2001-02-15 17:21  flood

	* ChangeLog: Updated ChangeLog.

2001-02-15 17:21  flood

	* modules/mod_core.c, src/dirtree.c: Bug #1008 - Port 21 is now
	  default w/out Port directive.

2001-02-15 06:24  flood

	* src/data.c: spurious #ifdef removed, sendfile() should compile
	  again

2001-02-13 20:13  flood

	* ChangeLog: Updated ChangeLog.

2001-02-13 20:12  flood

	* acconfig.h, config.h.in, configure, configure.in, src/data.c:
	  sendfile configure code fixed, HP/UX support for sendfile removed
	  because HP/UX's implementation is just plain wrong.  Might be
	  added back in 1.3.

2001-02-13 17:06  flood

	* ChangeLog: Updated ChangeLog.

2001-02-13 17:05  flood

	* modules/mod_xfer.c: Bug #462 - sendfile works again on freebsd

2001-02-12 19:05  flood

	* modules/mod_ls.c, src/dirtree.c: Bug #1007 - IgnoreHidden can now
	  be turned off.

2001-02-05 14:30  flood

	* ChangeLog: Updated ChangeLog.

2001-02-05 14:29  flood

	* CREDITS, INSTALL, NEWS, README, contrib/dist/rpm/proftpd.spec.in,
	  doc/Configuration.html: Minor doc changes

2001-02-05 11:48  flood

	* ChangeLog: Updated ChangeLog.

2001-02-05 11:48  flood

	* NEWS, contrib/README.mod_sqlpw, contrib/mod_mysql.c,
	  contrib/mod_pgsql.c, contrib/mod_sqlpw.c, contrib/mod_test.c,
	  modules/mod_tar.c, modules/mod_test.c: moved mod_tar.c,
	  mod_sqlpw.c, mod_mysql.c and mod_pgsql.c to attic, mod_test.c to
	  contrib/.  Adjusted README.sqlpw accordingly.

2001-02-05 11:37  flood

	* configure, configure.in, contrib/mod_ratio.c,
	  contrib/dist/rpm/proftpd.spec.in, modules/mod_auth.c,
	  modules/mod_xfer.c: Bug #279 - Correct use of sendfile. #29 -
	  updated rpm spec. #433 - initial .ftpaccess in cwd. #453
	  mod_ratio now uses new dir_check().  initgroups/getgroups use now
	  requires --enable-initgroups.

2001-02-05 10:28  flood

	* ChangeLog: Updated ChangeLog.

2001-02-05 10:28  flood

	* src/log.c: Bug #455 - SyslogLevel now works as documented.

2001-02-05 10:16  flood

	* README, configure, configure.in, lib/Makefile.in: Bug #293 -
	  Compilation under OSX.

2001-02-02 18:59  flood

	* src/data.c: Minor fixes to bug 399's patch. ;)

2001-02-02 15:12  flood

	* ChangeLog: Updated ChangeLog.

2001-02-02 15:11  flood

	* modules/mod_core.c: Bug #407 - Include pathnames must now be
	  absolute

2001-02-02 15:09  flood

	* include/options.h, modules/mod_xfer.c, src/data.c, src/fs.c,
	  src/io.c: Bug #399 - incorrect handling of CRs during ascii
	  transfers, also made default buffer size a macron in options.h:
	  TUNABLE_BUFFER_SIZE

2001-02-01 19:12  flood

	* CREDITS, INSTALL, NEWS: Updated minor documentation

2001-02-01 14:58  flood

	* ChangeLog: Updated ChangeLog.

2001-02-01 14:58  flood

	* include/version.h, src/auth.c: Bug #435 - uid/gid checking for
	  -1, updated version string to 1.2.0rc3

2001-02-01 11:52  flood

	* ChangeLog: Updated ChangeLog.

2001-02-01 11:52  flood

	* src/main.c: Bug #451 - check uid/gid after PRIVS_SETUP

2001-01-31 19:05  flood

	* modules/mod_pam.c: Bug #363 - mod_pam now handles blank usernames
	  and passwords without segfaulting.

2001-01-31 13:39  flood

	* ChangeLog: Updated ChangeLog.

2001-01-31 13:39  flood

	* configure, configure.in, modules/mod_xfer.c: Bug #35 - call
	  _aborT() funcs in exit handler.  sendfile() support is now
	  disabled by default, enable with --enable-sendfile

2001-01-31 12:52  flood

	* ChangeLog: Updated ChangeLog.

2001-01-31 12:51  flood

	* include/dirtree.h, modules/mod_core.c, modules/mod_ls.c,
	  modules/mod_xfer.c, src/dirtree.c: Bug #410 - IgnoreHidden fix
	  and cleanup/changes of hiding code.

2001-01-31 10:43  flood

	* modules/: mod_auth.c, mod_core.c, mod_unixpw.c: Bug #422 - fixed
	  handling of get_boolean() in config handles #410 - HideNoAccess
	  now takes boolean argument

2001-01-28 18:23  flood

	* ChangeLog: Updated ChangeLog.

2001-01-28 18:16  flood

	* contrib/mod_ldap.c: New mod_ldap.c from jwm@horde.net

2001-01-28 18:15  flood

	* ChangeLog: Updated ChangeLog.

2001-01-28 18:14  flood

	* modules/mod_core.c, src/dirtree.c: Bug #353 - Allows use of '!'
	  negation operator in Allow/Deny.

2001-01-28 16:26  flood

	* ChangeLog: Updated ChangeLog.

2001-01-28 16:23  flood

	* doc/Configuration.html, include/inet.h, modules/mod_core.c,
	  modules/mod_tar.c, modules/mod_test.c, src/inet.c, src/main.c:
	  Bug #188 - Removed use of NAME_MAX in mod_tar and mod_test.  #349
	  - Final implementation of PassivePorts.

2001-01-28 10:34  flood

	* ChangeLog: Updated ChangeLog.

2001-01-28 10:33  flood

	* modules/mod_core.c: Bug #436 - MaxClients* directives now merge
	  downward.

2001-01-28 10:25  flood

	* ChangeLog: Updated ChangeLog.

2001-01-28 10:25  flood

	* doc/Configuration.html, modules/mod_auth.c, modules/mod_unixpw.c,
	  src/main.c: Bug #350 - Enabling classes but not defining a class
	  no longer segfaults. #360 - Proftpd now logs if passwd/group
	  files cannot be opened. #417 - Command filter regexps no longer
	  apply to the PASS command.

2001-01-26 15:24  flood

	* ChangeLog: Updated ChangeLog.

2001-01-26 15:15  flood

	* modules/mod_core.c: Bug #390 - Added ifdef to regex code in
	  mod_core

2001-01-26 15:10  flood

	* contrib/dist/rpm/proftpd.init.d: Bug #347 - RPM problem in
	  contrib/

2001-01-26 15:06  flood

	* src/dirtree.c: Bug #397 - Fixed problem with incorrect config
	  file line count

2001-01-26 14:30  flood

	* src/support.c: Bug #441 - off-by-one error when reading month
	  from /etc/shutmsg

2001-01-26 14:26  flood

	* doc/Configuration.html: Bug #429 - Documentation changes

2001-01-26 13:51  flood

	* src/: inet.c, main.c: Bug #398 - overwriting file descriptor in
	  inet_openrw()

2001-01-25 10:04  flood

	* ChangeLog: Updated ChangeLog.

2001-01-24 22:16  flood

	* ChangeLog, configure: Updated ChangeLog.

2001-01-24 21:53  flood

	* config.h.in, configure.in, modules/mod_auth.c: Bug #365 - Removed
	  jail() code from mod_auth.c

2001-01-24 21:27  flood

	* ChangeLog: Updated ChangeLog.

2001-01-24 21:22  flood

	* ChangeLog: Updated ChangeLog.

2001-01-24 21:13  flood

	* ChangeLog: [no log message]

2001-01-24 21:13  flood

	* contrib/README.mod_sqlpw: Added README.mod_sqlpw

2001-01-24 14:51  flood

	* ChangeLog: [no log message]

2001-01-24 14:50  flood

	* ChangeLog, contrib/mod_ratio.c, src/main.c: Bug #430 - format
	  string fixes in log_pri and mod_ratio.

2001-01-24 14:02  flood

	* src/: dirtree.c, log.c, main.c: Bug #408 (1) - add_config_set fix
	  to prevent USER/pool overwrite DoS Bug #408 (2) - scoreboard
	  memory leak in log_open_run fixed Bug #408 (3) - Fixed potential
	  format string bug in main.c Bug #434	   - Added pool to pidrec_t
	  to fix large server memory leak

2000-10-08 15:24  macgyver

	* acconfig.h, config.h.in, configure, configure.in,
	  include/support.h, modules/mod_ls.c, src/support.c: Correctly use
	  NAME_MAX and fpathconf() when appropriate.

2000-10-08 15:11  macgyver

	* src/ftpshut.c: Handle the month calculation correctly.

2000-10-08 14:45  macgyver

	* contrib/mod_sqlpw.c: Use salt values correctly.

2000-10-08 14:36  macgyver

	* contrib/: README.mod_wrap, mod_wrap.c, mod_wrap.html: Added in
	  mod_wrap into contrib.

2000-10-08 14:22  macgyver

	* modules/mod_core.c: Correctly log the full path of deleted files.

2000-10-08 14:11  macgyver

	* modules/: mod_auth.c, mod_core.c: Added in support for
	  MaxHostsPerUser and fixed a problem with AnonRequirePassword.

2000-10-08 13:55  macgyver

	* src/inet.c: Lots of little cleanups.

2000-10-08 13:54  macgyver

	* contrib/mod_ratio.c: Fixed a bounds issue when checking the SITE
	  command.

2000-08-19 12:02  macgyver

	* configure, configure.in: Fixed ordering in library duplication
	  detection code.

2000-08-18 13:25  macgyver

	* NEWS: Updates.

2000-08-18 13:25  macgyver

	* ChangeLog: Updated ChangeLog.

2000-08-18 13:16  macgyver

	* README.PAM: Updated PAM documentation for FreeBSD.

2000-08-18 08:54  macgyver

	* src/dirtree.c: Don't only partially match directory names.  This
	  annoying bug allowed for directory-level configurations to
	  sometimes not work right.

2000-08-17 23:02  macgyver

	* configure, configure.in: Fixed a small typo in PAM detection.

2000-08-17 22:44  macgyver

	* acconfig.h, config.h.in, configure, configure.in: PAM and path
	  modifications.

2000-08-17 22:26  macgyver

	* modules/mod_pam.c: Updated to use HAVE_PAM.

2000-08-13 08:19  macgyver

	* Make.rules.in, acconfig.h, config.h.in, configure, configure.in,
	  include/conf.h: Some configure and compilation cleanups.

2000-08-13 03:36  macgyver

	* contrib/mod_quota.c: Cleaned up use of lstat() to fs_lstat() to
	  be more portable.

2000-08-07 17:54  macgyver

	* include/data.h, modules/mod_xfer.c, src/data.c: Cleaned up
	  sendfile() implementation to make it simpler and more managable.

2000-08-07 16:17  macgyver

	* modules/mod_core.c: Fixed a typo in set_sysloglevel.

2000-08-04 21:44  macgyver

	* modules/mod_auth.c: Be a little more anal retentive about
	  cleaning up after ourselves when it comes to USER/PASS attempts.

2000-08-04 21:43  macgyver

	* src/data.c: Formatting cleanups.

2000-08-04 21:42  macgyver

	* modules/mod_xfer.c: Removed spurious #if 0.

2000-08-04 08:17  macgyver

	* configure, configure.in: Updated HP/UX sendfile() to only
	  actually check on HP/UX platforms. :)

2000-08-04 08:07  macgyver

	* ChangeLog: Updated ChangeLog.

2000-08-04 08:07  macgyver

	* doc/Undocumented.txt: Updated undocumented functions list (none
	  left! :)).

2000-08-04 08:05  macgyver

	* doc/: GetConf, ShowUndocumented: Small updates to configuration
	  scripts.

2000-08-04 07:57  macgyver

	* doc/Configuration.html: Updated documentation.

2000-08-03 08:40  macgyver

	* doc/Undocumented.txt: Updated undocumented functions list.

2000-08-03 08:39  macgyver

	* contrib/: README.ratio, mod_ratio.c: Updated to mod_ratio.

2000-08-03 08:36  macgyver

	* contrib/mod_ldap.c: Updated to mod_ldap 2.7.3 to remove
	  LDAPSearchFilter.

2000-08-03 08:24  macgyver

	* modules/mod_auth.c: Oops...more compilation fixes for jail(). :)

2000-08-03 07:10  macgyver

	* doc/Undocumented.txt: Updated undocumented functions...only two
	  left, wow!

2000-08-03 07:09  macgyver

	* doc/Configuration.html: Updated documentation.

2000-08-03 07:05  macgyver

	* modules/mod_auth.c: Correctly obtain the IP address in jail().

2000-08-02 22:50  macgyver

	* modules/mod_auth.c: Typos in jail() support.

2000-08-02 20:01  macgyver

	* ChangeLog: Updated ChangeLog.

2000-08-02 19:59  macgyver

	* modules/mod_auth.c: Added some debug logging to lockdown().

2000-08-02 19:46  macgyver

	* NEWS, config.h.in, configure, configure.in, modules/mod_auth.c:
	  Added in support for jail() on platforms that support it
	  (currently FreeBSD 4.x+).

2000-08-02 18:35  macgyver

	* modules/mod_pam.c: More Solaris tweaks.

2000-08-02 18:30  macgyver

	* ChangeLog, NEWS: Updated ChangeLog and NEWS.

2000-08-02 18:29  macgyver

	* src/fs.c: Fixed a problem where files that began with ~ weren't
	  being handled properly.

2000-08-02 16:36  macgyver

	* contrib/mod_quota.c: Fixed a crash when using mod_quota and not
	  defining QuotaExempt.

2000-08-02 16:34  macgyver

	* doc/Configuration.html: Updated documentation.

2000-08-02 16:28  macgyver

	* ChangeLog, NEWS: Updated NEWS and ChangeLog.

2000-08-02 16:26  macgyver

	* Make.rules.in, configure, configure.in: Added in --with-libraries
	  for posterity.

2000-08-02 16:13  macgyver

	* configure.in: Added copyright info to the configure scripts.

2000-08-02 16:07  macgyver

	* src/log.c: Only log to WTMP or WTMPX, not both.  Modern systems
	  should all use WTMPX.

2000-08-02 15:57  macgyver

	* modules/mod_pam.c: Updated Solaris compatibility fix for mod_pam.

2000-08-02 15:38  macgyver

	* stamp-h.in: Added in stamp-h.in support.

2000-08-02 15:38  macgyver

	* .cvsignore, Makefile.in, configure, configure.in: Added support
	  for stamp-h.in and automagic rebuilds whenever configure is
	  updated.

2000-08-02 14:46  macgyver

	* acconfig.h, config.h.in, configure, configure.in: More sendfile
	  detection tweaks. :)

2000-08-02 14:46  macgyver

	* modules/mod_core.c: Forgot to return HANDLED in add_sysloglevel.

2000-08-02 06:58  macgyver

	* ChangeLog: Updated ChangeLog.

2000-08-01 23:44  macgyver

	* configure, configure.in: Reworked sendfile detection to be
	  cleaner and better cached.

2000-08-01 23:18  macgyver

	* Make.rules.in, NEWS, configure, configure.in: Added in
	  --with-includes and made the PAM check for -ldl cache its
	  results.

2000-08-01 22:28  macgyver

	* modules/mod_pam.c: ifdef out the PAM_TTY code needed for Solaris
	  so other systems don't have to work around this issue.

2000-08-01 22:25  macgyver

	* NEWS, include/conf.h, include/data.h, include/default_paths.h,
	  include/dirtree.h, include/fs.h, include/ftp.h, include/ident.h,
	  include/inet.h, include/io.h, include/libsupp.h, include/log.h,
	  include/modules.h, include/options.h, include/pool.h,
	  include/privs.h, include/proftpd.h, include/sets.h,
	  include/timers.h, modules/mod_core.c, src/log.c, src/utils.c:
	  Added SyslogLevel directive, and cleaned up some header files.

2000-08-01 15:20  macgyver

	* modules/mod_core.c, src/main.c: Added support for the PidFile
	  directive, to make ProFTPD more Apache-like.

2000-08-01 14:52  macgyver

	* ChangeLog: Updated ChangeLog.

2000-08-01 14:51  macgyver

	* include/proftpd.h, modules/mod_auth.c, src/main.c:
	  AnonRequirePassword should prevent the password from being
	  displayed in ftpwho/ftpcount/ps.

2000-08-01 14:30  macgyver

	* ChangeLog: Updated ChangeLog.

2000-08-01 14:30  macgyver

	* modules/mod_pam.c: Give ProFTPD it's own entry under /dev.

2000-08-01 14:23  macgyver

	* NEWS, modules/mod_log.c: Honor ExtendedLog NONE.

2000-08-01 13:41  macgyver

	* NEWS, doc/Configuration.html, modules/mod_site.c: AllowChmod
	  defaults to 'on' now, to be backward compatible.

2000-08-01 13:41  macgyver

	* modules/mod_pam.c: More information about PAM and Solaris
	  interaction.

2000-08-01 13:20  macgyver

	* ChangeLog: Updated ChangeLog.

2000-08-01 13:13  macgyver

	* NEWS, modules/mod_auth.c: Moved code around to eliminate a race
	  with MaxClients.

2000-08-01 12:51  macgyver

	* NEWS, contrib/mod_ratio.c, modules/mod_site.c: Fixed a minor bug
	  in SITE HELP.

2000-08-01 11:59  macgyver

	* NEWS, modules/mod_core.c, modules/mod_xfer.c: Added in
	  DeleteAbortedStores and did some minor cleanups.

2000-08-01 11:43  macgyver

	* contrib/mod_quota.c: unlink should never be called directly --
	  use fs_unlink instead.

2000-08-01 11:32  macgyver

	* NEWS, modules/mod_pam.c: Solaris requires you to have PAM_TTY and
	  PAM_RHOST defined before you call pam_open_session.  No, it
	  doesn't make sense to me either. :)

2000-07-28 15:27  macgyver

	* lib/pr_fnmatch.c: Optimizations for fnmatch() implementation.

2000-07-28 15:17  macgyver

	* contrib/mod_ldap.c: Updated mod_ldap to 2.7.2.

2000-07-28 14:56  macgyver

	* modules/mod_xfer.c: Don't check for PORT in cmd_stor if we're in
	  passive mode.

2000-07-28 06:50  macgyver

	* NEWS, modules/mod_site.c: AllowChmod now works in almost any
	  context.

2000-07-27 23:47  macgyver

	* ChangeLog: Updated ChangeLog.

2000-07-27 22:52  macgyver

	* NEWS, modules/mod_site.c: AllowChmod works right now.

2000-07-27 22:47  macgyver

	* NEWS, acconfig.h, config.h.in, configure, configure.in,
	  src/data.c: Added --disable-pam, allowing you to disable PAM at
	  configure-time.  Reorganized sendfile detection a bit and added
	  support for HP/UX.

2000-07-27 09:07  macgyver

	* modules/mod_auth.c: Work around HP/UX's broken compiler in
	  _do_user_counts().

2000-07-26 21:14  macgyver

	* contrib/mod_ldap.c: Updated mod_ldap to latest/greatest.

2000-07-26 16:47  macgyver

	* modules/mod_pam.c: Moved around PAM calls to be Sun
	  Compliant(tm), since anything that isn't strictly in that order
	  seems to cause Solaris environments to puke.

	  Set PAM_RHOST, when we can.

2000-07-26 16:09  macgyver

	* src/main.c: Remove spurious \r\n from various send_response()s.

2000-07-26 04:12  macgyver

	* src/main.c: Be verbose about /etc/shutmsg.

2000-07-26 04:03  macgyver

	* include/proftpd.h, modules/mod_core.c, modules/mod_ls.c,
	  modules/mod_xfer.c, src/data.c, src/io.c, src/log.c: Fixed a
	  crash when STOR called before PORT being issued.  Fixed a crash
	  related to STAT.

2000-07-26 02:49  macgyver

	* lib/pwgrent.c: Fixed some warnings on FreeBSD.

2000-07-26 02:36  macgyver

	* src/main.c: Better checking for empty strings before attempting
	  to call a regex.  Handle empty commands cleaner.

2000-07-26 01:21  macgyver

	* README.LDAP, contrib/mod_ldap.c: Updated mod_ldap to 2.7.1.

2000-07-26 01:19  macgyver

	* lib/: pr_fnmatch.c, pr_fnmatch_loop.c: fnmatch.c was renamed to
	  pr_fnmatch.c, as well as importing the new fnmatch code from
	  glibc.

2000-07-26 01:18  macgyver

	* lib/fnmatch.c: fnmatch.c has now become pr_fnmatch.c.

2000-07-26 01:16  macgyver

	* Make.rules.in, config.h.in, configure, configure.in,
	  include/libsupp.h, lib/Makefile.in, lib/glob.c,
	  modules/Makefile.in, src/Makefile.in, src/dirtree.c, src/fs.c:
	  New fnmatch code in ProFTPD.	Updated from the latest and
	  greatest glibc code.	ProFTPD now always uses our builtin fnmatch
	  to eliminate problems with incompatible implementations as well
	  as namespace collisions.

2000-07-26 00:36  macgyver

	* contrib/mod_ratio.c: Transitioned to the new fnmatch() function,
	  and corrected an error where hosts were being treated in a
	  case-sensitive fashion.

2000-07-25 21:41  macgyver

	* configure, configure.in: Made fnmatch check more robust and
	  cleaned up gcc detection a bit.

2000-07-25 21:11  macgyver

	* configure, configure.in, src/dirtree.c: Hostname checks should be
	  case insensitive.  Added FNM_CASEFOLD to fnmatch check.

2000-07-25 20:48  macgyver

	* doc/ShowUndocumented: Make the grep case insensitive.

2000-07-25 20:42  macgyver

	* config.guess, config.sub: Updated config.guess and config.sub
	  scripts.

2000-07-21 11:45  macgyver

	* ChangeLog: Updated changelog.

2000-07-21 11:44  macgyver

	* ChangeLog, NEWS, config.h.in, configure, configure.in,
	  modules/mod_auth.c, modules/mod_unixpw.c: Portability fixes and
	  additions on various platforms.  Also corrected a problem in
	  configure where a piece of code was completely bypassed.

2000-07-20 23:19  macgyver

	* doc/Configuration.html: Updated configuration documentation.

2000-07-20 23:11  macgyver

	* src/main.c: Check for getopt_long was backwards.

2000-07-20 23:09  macgyver

	* src/ftpcount.c: Handle systems without getopt_long properly.

2000-07-20 22:59  macgyver

	* modules/mod_core.c: Removed unused variables thanks to gcc -Wall.

2000-07-20 22:57  macgyver

	* src/main.c: Removed 2 printfs that were just plain wrong in a
	  situation where a site is administratively shutdown (ala shutmsg,
	  etc).  Also corrected a getopt_long related issue in show_usage.

2000-07-20 22:38  macgyver

	* modules/mod_pam.c: Don't close PAM handle until we exit so we
	  survive across jailed environments.

2000-07-20 22:37  macgyver

	* NEWS: Updated news.

2000-07-20 22:37  macgyver

	* ChangeLog: Updated changelog.

2000-07-20 22:18  macgyver

	* src/main.c: Command line options are constants.

2000-07-20 22:18  macgyver

	* src/main.c: Be mindful of systems without getopt_long.

2000-07-20 22:06  macgyver

	* modules/mod_pam.c: Typo with AuthPAMConfig and PAMConfig.

2000-07-20 22:05  macgyver

	* configure, configure.in: Added in better PAM detection for -ldl.

2000-07-20 21:58  macgyver

	* README.LDAP, contrib/mod_ldap.c, doc/Configuration.html: Latest
	  LDAP updates (mod_ldap 2.7).

2000-07-20 21:52  macgyver

	* src/data.c: Added many more descriptions around various error
	  conditions for better RFC compliance.

2000-07-20 21:52  macgyver

	* modules/mod_pam.c: Fix potential strdup madness.

2000-07-20 21:47  macgyver

	* modules/mod_unixpw.c: Reworked UID/GID hash tables to be more
	  portable across implementations with different sizes for UID and
	  GID fields.

2000-07-11 11:44  macgyver

	* modules/mod_core.c: Fixed a minor typo when there is no regex
	  engine around.

2000-07-11 07:13  macgyver

	* ChangeLog: Updated ChangeLog.

2000-07-11 07:10  macgyver

	* NEWS, src/data.c, src/main.c: Don't ignore ServerUseReverseDNS.

2000-07-11 06:36  macgyver

	* ChangeLog, contrib/mod_ldap.c, contrib/mod_quota.c,
	  contrib/mod_ratio.c, contrib/mod_sqlpw.c, lib/pwgrent.c,
	  lib/vsnprintf.c, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_log.c, modules/mod_ls.c, modules/mod_pam.c,
	  modules/mod_readme.c, modules/mod_site.c, modules/mod_tar.c,
	  modules/mod_test.c, modules/mod_unixpw.c, modules/mod_xfer.c,
	  src/auth.c, src/dirtree.c, src/fs.c, src/ftpcount.c, src/ident.c,
	  src/inet.c, src/io.c, src/log.c, src/pool.c, src/support.c: Minor
	  updates and buffer cleanups.

2000-07-11 06:35  macgyver

	* include/default_paths.h, src/main.c: Added in support for core
	  file debugging.

2000-07-11 06:31  macgyver

	* doc/Configuration.html: Latest and greatest documentation
	  updates.

2000-07-09 00:01  macgyver

	* include/log.h, modules/mod_core.c, modules/mod_xfer.c, src/log.c,
	  src/xferlog.5: Added in support for a completion field in
	  xferlog.

2000-07-09 00:01  macgyver

	* doc/Configuration.html: Updated LDAP documentation.

2000-07-08 23:59  macgyver

	* contrib/mod_ldap.c: Added in -lresolv.

2000-07-08 23:59  macgyver

	* modules/mod_pam.c: Added a little more sanity cleanup.

2000-07-08 23:58  macgyver

	* src/support.c: Try to address potential memory issues with people
	  trying to overflow large path buffers.

2000-07-08 09:26  macgyver

	* modules/mod_pam.c: Forgot to add in AuthPAM to the configuration
	  tables.

2000-07-08 01:15  macgyver

	* src/inet.c: Added in some sanity checking so things like
	  getsockname() don't crash on Solaris when called with invalid
	  descriptors.

2000-07-08 01:02  macgyver

	* modules/mod_pam.c: I must be braindamaged to have let someone
	  else convince me my original code and logic was incorrect about
	  mod_pam.  There was no aforementioned memory leak, and PAM does
	  work exactly as advertised.

2000-07-07 14:11  macgyver

	* contrib/mod_sqlpw.c: Fixed a bug in SQLAuthoritative detection.

2000-07-07 00:12  macgyver

	* ChangeLog, include/version.h: Updated ChangeLog as well as
	  version.

2000-07-07 00:09  macgyver

	* contrib/: README.ratio, mod_ratio.c: Updated to mod_ratio.

2000-07-06 23:41  macgyver

	* NEWS, modules/mod_ls.c, modules/mod_tar.c, src/auth.c,
	  src/data.c, src/fs.c, src/log.c, src/support.c: Fixed various
	  MAXPATHLEN buffers.

2000-07-06 23:21  macgyver

	* modules/mod_ls.c: Use access_check to properly check permissions.
	  More consistent handling of '.' and '..'.  I can't wait to
	  rewrite this module.

2000-07-06 23:18  macgyver

	* modules/mod_core.c, src/support.c: Handle symlinks more
	  appropriately...follow the link, not the file.

2000-07-06 18:19  macgyver

	* NEWS, include/support.h, src/dirtree.c, src/support.c: Added
	  access_check() to handle correct permission checking.

2000-07-06 17:26  macgyver

	* src/auth.c: Minor correction to auth_uid_name and auth_gid_name.

2000-07-06 17:00  macgyver

	* src/log.c: Documented design decision behind utmp entries and
	  strings.

2000-07-06 16:44  macgyver

	* doc/Configuration.html: Updates to documentation.

2000-07-06 16:42  macgyver

	* modules/Makefile.in: Removed mod_mysql.h dependency.

2000-07-06 13:19  macgyver

	* contrib/mod_sqlpw.c: Added SQLKeyField, SQLKey and
	  SQLAuthoritative directives.

2000-07-06 13:08  macgyver

	* NEWS, doc/Configuration.html, include/proftpd.h,
	  modules/mod_core.c, modules/mod_xfer.c: Fixed GroupOwner and
	  added UserOwner.

2000-07-06 12:29  macgyver

	* NEWS, config.h.in, configure, configure.in, src/main.c,
	  modules/mod_auth.c: Added in support to handle large groups
	  efficiently.	This should take care of the 'hangs forever on
	  login' bug.

2000-07-06 11:33  macgyver

	* modules/mod_auth.c: Fixed a bug when classes weren't enabled and
	  DisplayConnect is used.

2000-07-06 06:33  macgyver

	* include/inet.h, src/data.c, src/inet.c: AllowForeignAddress
	  directives now work on passive connections as well.

2000-07-06 05:58  macgyver

	* modules/mod_site.c: Typo in AllowChmod implementation. :)

2000-07-06 05:44  macgyver

	* Make.rules.in: Minor cleanups.

2000-07-05 23:59  macgyver

	* src/main.c: Added in set_proc_title duirng login.

2000-07-05 23:53  macgyver

	* modules/: mod_auth.c, mod_core.c, mod_xfer.c: Stubs for
	  unimplemented commands.  Bleh...we need to overhaul this
	  protocol.

2000-07-05 23:46  macgyver

	* doc/Configuration.html: Updated classes documentation.

2000-07-05 23:45  macgyver

	* NEWS, modules/mod_xfer.c: Minor typo in cmd_stor.

2000-07-05 23:42  macgyver

	* modules/mod_auth.c: Fixed a minor race condition in classes.

2000-07-05 23:18  macgyver

	* NEWS, modules/mod_ls.c: Fixed a minor permissions display problem
	  when DirFakeMode is not in use.

2000-07-05 23:13  macgyver

	* src/proftpd.8: Added documentation for -t option.

2000-07-05 23:08  macgyver

	* src/main.c: Fixed use of 500 instead of R_500.

2000-07-05 22:58  macgyver

	* NEWS, config.h.in, configure, configure.in, lib/vsnprintf.c,
	  src/ftpcount.c: Made portable *snprintf libraries more so by
	  supporting floating point operations and updated ftpcount
	  accordingly.

2000-07-05 22:57  macgyver

	* modules/mod_pam.c: Added in session control management.

2000-07-05 21:51  macgyver

	* lib/pwgrent.c: A fix for dealing with FreeBSD's (IMO **BROKEN**)
	  passwd scheme that allows comments and blank lines in passwd
	  files.

2000-07-05 21:41  macgyver

	* NEWS, modules/mod_site.c: Added AllowChmod directive.

2000-07-05 21:24  macgyver

	* NEWS, doc/Configuration.html, modules/mod_ls.c,
	  modules/mod_readme.c: DisplayReadme now accepts patterns.

2000-07-05 20:55  macgyver

	* Make.rules.in, NEWS, include/default_paths.h, src/main.c,
	  src/proftpd.8: A PID file is now created in standalone mode.

2000-07-05 20:32  macgyver

	* acconfig.h, config.h.in, configure, configure.in, include/conf.h,
	  modules/mod_ls.c: Fixed a POSIX issue regarding NAME_MAX usage.

2000-07-05 20:31  macgyver

	* NEWS: Updated news.

2000-07-05 20:31  macgyver

	* INSTALL: Updated documentation.

2000-07-03 11:25  macgyver

	* modules/mod_ls.c: Fixed potential buffer problem in dolist().

2000-07-03 09:25  macgyver

	* modules/mod_log.c: Cleaned up mod_log slightly, and added in some
	  comments about potential buffer problems to be fixed after 1.2.0.

2000-07-03 09:03  macgyver

	* README.PAM: Updated PAM documentation to reflect AuthPAM.

2000-07-03 08:55  macgyver

	* modules/mod_pam.c: Changed PAMConfig to AuthPAMConfig for
	  compatability reasons going forward.	Added in AuthPAM directive
	  to selectively activate/deactivate PAM.  Cleaned up PAM functions
	  a bit and made some checks more strict.  Removed a minor
	  potential memory leak.

2000-07-03 07:30  macgyver

	* src/main.c: Security fix in setproctitle().

2000-05-15 08:08  macgyver

	* contrib/mod_sqlpw.c: Fixed the 'password shows up instead of the
	  username' problem with SQL passwords

2000-03-05 23:11  macgyver

	* CREDITS: Updated CREDITS

2000-03-05 22:44  macgyver

	* INSTALL: An even cooler INSTALL file

2000-03-05 22:38  macgyver

	* INSTALL, doc/Configuration.html: Documentation updates

2000-03-05 22:25  macgyver

	* NEWS, modules/mod_ls.c: Added in -L option for things like mirror
	  to work with symlinks

2000-03-05 21:32  macgyver

	* configure, configure.in: Fixed a bug in link-testing for -ldl

2000-03-03 13:10  macgyver

	* config.h.in, configure, configure.in, modules/mod_pam.c: Minor
	  cleanups of configure scripts to remove dependencies on -ldl

2000-03-02 07:32  macgyver

	* src/: ftpcount.1, ftpshut.8, ftpwho.1, proftpd.8, xferlog.5:
	  Cleaned up man pages a bit.  Lots more work still needed, though.

2000-02-29 22:13  macgyver

	* NEWS, modules/mod_ls.c: Put in a better optimized sreaddir
	  function

2000-02-29 22:13  macgyver

	* modules/mod_auth.c: Cleanup of a couple of typos, and removed
	  some redundant code

2000-02-29 22:12  macgyver

	* include/conf.h, modules/mod_tar.c: Moved the NAME_MAX stuff into
	  conf.h, for portability

2000-02-29 22:11  macgyver

	* src/pool.c: Commented out references to symbol information in
	  pool allocations

2000-02-28 23:25  macgyver

	* NEWS, acconfig.h, config.h.in, configure, configure.in,
	  src/main.c: Added in support for tzset, to preserve timezone
	  information across a chroot

2000-02-28 23:25  macgyver

	* src/ftpcount.c: Cleaned up a couple of compile-time warnings

2000-02-28 17:11  macgyver

	* NEWS, lib/vsnprintf.c, src/log.c: Removed spurious alloca calls

2000-02-28 16:30  macgyver

	* modules/mod_tar.c: Make mod_tar more portable

2000-02-28 12:19  macgyver

	* NEWS, doc/Configuration.html, modules/mod_auth.c,
	  modules/mod_log.c: Added in %A, %F, and %m to LogFormat so we can
	  do CLF-style logs now

2000-02-28 12:02  macgyver

	* ChangeLog, NEWS, src/dirtree.c, src/main.c: Added -t option to
	  allow for syntax checking of a config file and made config file
	  errors give line and file information on failure

2000-02-28 11:06  macgyver

	* modules/: mod_auth.c, mod_core.c: Minor cosmetic cleanups

2000-02-28 10:57  macgyver

	* NEWS, modules/mod_core.c: Add %k directive to show amount of data
	  in a user-friendly way in DisplayQuit

2000-02-28 10:56  macgyver

	* modules/mod_auth.c: Make root logins louder

2000-02-28 03:15  macgyver

	* NEWS, README.Unixware, config.guess, config.sub: Unixware support
	  and updated config.guess, config.sub files

2000-02-28 02:50  macgyver

	* NEWS, src/inet.c: FreeBSD 4.0 support added

2000-02-28 02:46  macgyver

	* modules/: mod_pam.c, mod_unixpw.c: Fixed a minor typo in pw_auth

2000-02-28 02:42  macgyver

	* NEWS, contrib/mod_quota.c: Added mod_quota

2000-02-28 02:37  macgyver

	* modules/mod_xfer.c: Include sys/sendfile.h

2000-02-28 02:32  macgyver

	* modules/mod_core.c: Minor cleanups of unused variables

2000-02-28 02:25  macgyver

	* NEWS, modules/mod_log.c: Logging of transfer times is more
	  precise

2000-02-28 02:19  macgyver

	* modules/mod_core.c: Fixed a typo that called VirtualHost a
	  VirtualServer

2000-02-28 02:16  macgyver

	* NEWS, modules/mod_log.c: Add a warning for invalid classes in
	  ExtendedLog

2000-02-28 02:14  macgyver

	* NEWS, src/main.c: Save environment before doing anything with
	  set_proc_title.

2000-02-26 13:34  macgyver

	* NEWS, contrib/mod_ldap.c: Updated mod_ldap to 2.5.2.

2000-02-26 13:31  macgyver

	* NEWS, modules/mod_xfer.c: Updated bandwidth code to use select
	  instead of usleep.

2000-02-15 16:33  macgyver

	* NEWS, src/dirtree.c: Fixed Umask handling for directories.

2000-02-15 16:09  macgyver

	* NEWS, modules/mod_xfer.c: Correct the case where there is no
	  second argument to TYPE L X.

2000-02-15 15:48  macgyver

	* src/support.c: Correct calc_fs to actually make the right
	  calculation when using statvfs.

2000-02-01 08:59  macgyver

	* modules/mod_auth.c: Fixed a NULL dereference when AuthUsingAlias
	  is used outside of <Anonymous> directives.

2000-01-23 21:59  macgyver

	* NEWS, modules/mod_auth.c: Fixed a small group permissions
	  problem.

2000-01-23 21:47  macgyver

	* src/: dirtree.c, main.c: Removed references to the fastpathing of
	  limits.  This topic is too complex to deal with for 1.2.0.

2000-01-23 17:15  macgyver

	* src/main.c: This is a stupid message...just disabled my
	  fastpath...needs more work, and I need to step out for a while.
	  :)

2000-01-23 17:03  macgyver

	* src/main.c: Added a fastpath for denying commands in the dispatch
	  loop.

2000-01-23 16:46  macgyver

	* include/proftpd.h, modules/mod_auth.c, modules/mod_core.c,
	  src/ftpcount.c: Support for class listing in ftpcount.  Support
	  for full use of % options in DisplayConnect.

2000-01-23 15:37  macgyver

	* doc/Undocumented.txt: Updated Undocumented.txt.

2000-01-23 15:37  macgyver

	* doc/Configuration.html: Documentation for Include directive.

2000-01-23 15:31  macgyver

	* modules/mod_core.c: Added 'Include' directive.

2000-01-23 15:12  macgyver

	* modules/mod_pam.c: Re-add -ldl to mod_pam.

2000-01-23 14:55  macgyver

	* modules/mod_core.c: DisplayConnect now supports all the %
	  options.  Correct a bug with %z printing in classes.

2000-01-23 14:49  macgyver

	* modules/mod_ls.c: Added TimesGMT, and made our listing output
	  more consistent.

2000-01-23 14:48  macgyver

	* doc/Configuration.html: Added documentation for Class/Classes and
	  TimeGMT.

2000-01-23 10:38  macgyver

	* NEWS, modules/mod_ls.c: Fix a stupid dereference in mod_ls.

2000-01-17 19:16  macgyver

	* CREDITS: Added a CREDITS file.

2000-01-17 19:15  macgyver

	* README: Updated with new web site.

2000-01-17 19:14  macgyver

	* contrib/dist/rpm/proftpd.spec.in: Updated for new web site.

2000-01-17 19:08  macgyver

	* ChangeLog: Updated for pre10.

2000-01-17 19:04  macgyver

	* include/version.h: Updated for pre10.

2000-01-17 19:01  macgyver

	* NEWS: Updated for pre10 release.

2000-01-17 18:07  macgyver

	* doc/Configuration.html, include/dirtree.h, modules/mod_core.c,
	  src/dirtree.c: Corrected some errors in .ftpaccess handling.

2000-01-17 18:00  macgyver

	* config.sub: Recognize BSDI on an UltraSPaRC

2000-01-17 16:41  macgyver

	* NEWS, src/inet.c: inet_getname no longer returns NULL in bad host
	  entry cases.

2000-01-17 16:27  macgyver

	* NEWS, src/fs.c: Corrected ~ reporting.

2000-01-15 14:54  macgyver

	* lib/pwgrent.c: Corrected an allocation error in pwgrent.

2000-01-03 13:28  macgyver

	* include/privs.h, include/proftpd.h, modules/mod_auth.c: Added
	  Simon's patch to handle chdir-ing properly into user accounts.

2000-01-03 12:17  macgyver

	* modules/mod_xfer.c: Handle a case with a zero-length file for
	  BSD.

1999-12-30 11:06  macgyver

	* src/data.c: Fixed total calculation.

1999-12-30 10:41  macgyver

	* NEWS, include/dirtree.h, modules/mod_auth.c, modules/mod_core.c:
	  Fixed error messages in cases where it's an invalid number of
	  arguments.

1999-12-29 22:27  macgyver

	* ChangeLog, src/data.c: Added a fix for BSD's strange sendfile
	  behavior.

1999-12-29 12:08  macgyver

	* src/data.c: Minor correction to sendfile() semantics on FreeBSD.

1999-12-28 07:54  macgyver

	* contrib/mod_linuxprivs.c, contrib/mod_sqlpw.c,
	  modules/mod_auth.c, modules/mod_core.c, modules/mod_log.c,
	  modules/mod_ls.c, modules/mod_readme.c, modules/mod_site.c,
	  modules/mod_xfer.c: Ensured that cmdtable structs remained static
	  to the files they're defined in.

1999-12-28 07:43  macgyver

	* ChangeLog: Updated ChangeLog.

1999-12-28 07:43  macgyver

	* src/: support.c, utils.c: Cleaned up sstrncpy properly and backed
	  out previous incorrect cleanup.

1999-12-27 23:45  macgyver

	* NEWS: Updated again.

1999-12-27 23:43  macgyver

	* NEWS: Updated NEWS.

1999-12-27 23:33  macgyver

	* src/: support.c, utils.c: Cleaned up the implementation of
	  sstrncpy slightly.

1999-12-27 23:27  macgyver

	* modules/mod_xfer.c: Disable sendfile() if we're using bandwidth
	  control.

1999-12-27 23:18  macgyver

	* modules/mod_auth.c: Fixed a missing variable in a log_auth entry.

1999-12-27 22:32  macgyver

	* INSTALL, README, doc/Configuration.html: Updated documentation to
	  reflect new web site.

1999-12-27 22:26  macgyver

	* configure, configure.in: Fixed the detection of hpsecurity.h

1999-12-27 22:24  macgyver

	* modules/mod_readme.c: A minor Y2K correction in handling READMEs.

1999-12-26 19:03  macgyver

	* NEWS, README.LDAP, contrib/mod_ldap.c, doc/Configuration.html:
	  Updated mod_ldap.

1999-12-26 18:53  macgyver

	* configure, configure.in: Fixed a minor typo in a test case.

1999-12-26 18:48  macgyver

	* modules/mod_auth.c: Group handling fixed for complex groups.

1999-12-26 18:43  macgyver

	* modules/mod_xfer.c: Corrected a minor misdefinition in
	  xfer_init_parent.

1999-12-22 22:05  macgyver

	* NEWS, lib/pwgrent.c: Generate a meaningful error for bad group
	  entries.

1999-12-22 22:04  macgyver

	* modules/mod_xfer.c: Added more caught cases in sendfile().

1999-12-09 06:54  macgyver

	* src/support.c: Small Y2K fix.

1999-11-28 21:26  macgyver

	* NEWS, src/data.c: sendfile() doesn't log spurious errors unless
	  in debug mode.

1999-10-27 13:45  macgyver

	* configure, configure.in: Corrected intall_group handling.

1999-10-27 13:43  macgyver

	* modules/mod_xfer.c: Minor optimization in sendfile() detection on
	  Linux.

1999-10-26 23:26  macgyver

	* modules/mod_xfer.c: Minor log cleanup for data_sendfile.

1999-10-26 23:24  macgyver

	* modules/mod_xfer.c: Moved around some logging for data_sendfile.

1999-10-26 22:45  macgyver

	* contrib/.cvsignore: Updated for proftpd.spec.

1999-10-26 22:45  macgyver

	* contrib/dist/rpm/.cvsignore: New file.

1999-10-26 22:44  macgyver

	* modules/mod_xfer.c: sendfile() should take a more graceful and
	  tolerant approach to slow connections.  It seems that the problem
	  is that its too fast.

1999-10-26 22:43  macgyver

	* Makefile.in: Minor path correction for proftpd.spec.

1999-10-26 20:06  macgyver

	* ChangeLog: Updated.

1999-10-26 20:01  macgyver

	* NEWS, contrib/dist/rpm/proftpd.spec.in: Minor cleanups.

1999-10-26 19:36  macgyver

	* NEWS, README.LDAP, doc/Configuration.html, include/version.h:
	  Documentation updates and version bump to pre9.

1999-10-26 19:20  macgyver

	* contrib/dist/rpm/proftpd.spec.in: Updated to reflect new paths.

1999-10-26 18:58  macgyver

	* modules/mod_xfer.c: Added support for TYPE L for RFC 959
	  compliance.

1999-10-26 18:43  macgyver

	* doc/rfc/: draft-bonachea-sftp-00.txt,
	  draft-ietf-ftpext-mlst-08.txt,
	  draft-ietf-ftpext-sec-consider-02.txt, rfc0959.txt, rfc2228.txt:
	  Added RFCs to the documentation.

1999-10-26 18:08  macgyver

	* configure, configure.in: Fixed my stupid typo in FreeBSD
	  setpassent.

1999-10-26 18:02  macgyver

	* doc/: Configuration.html, Undocumented.txt: Added more
	  directives.

1999-10-25 13:13  macgyver

	* doc/: Configuration.html, ShowUndocumented, Undocumented.txt:
	  More additions, courtesy of Ben Ritcey.

1999-10-22 22:24  macgyver

	* NEWS: Added AuthUsingAlias.

1999-10-22 22:18  macgyver

	* doc/Configuration.html, modules/mod_auth.c, modules/mod_core.c:
	  Added in AuthUsingAlias.

1999-10-22 21:07  macgyver

	* configure, configure.in, contrib/ftp.pamd,
	  contrib/proftpd.spec.in, contrib/dist/rpm/ftp.pamd,
	  contrib/dist/rpm/proftpd.init.d,
	  contrib/dist/rpm/proftpd.spec.in, doc/Undocumented.txt: Moved
	  around RPM build files.

1999-10-22 20:53  macgyver

	* ChangeLog: Updated.

1999-10-22 20:52  macgyver

	* NEWS, modules/mod_xfer.c: Minor updates.

1999-10-22 20:39  macgyver

	* contrib/proftpd.spec.in: Updated spec file to produce standalone
	  and inetd packages.

1999-10-22 20:21  macgyver

	* NEWS, README, acconfig.h, config.h.in, configure, configure.in,
	  modules/mod_auth.c: Updates for FreeBSD's brokenness with respect
	  to setpassent.

1999-10-22 20:21  macgyver

	* modules/mod_xfer.c: FreeBSD cleanups for sendfile().

1999-10-22 19:48  macgyver

	* contrib/mod_ldap.c: Updated mod_ldap.

1999-10-20 21:37  macgyver

	* modules/mod_pam.c: Minor cleanups/updates.

1999-10-20 21:36  macgyver

	* doc/: Configuration.html, ShowUndocumented, Undocumented.txt:
	  Updated configuration documentation.

1999-10-17 22:12  macgyver

	* NEWS, doc/Configuration.html, include/dirtree.h,
	  modules/mod_core.c, src/dirtree.c: Added a second argument to the
	  Umask directive to handle directories.

1999-10-17 22:11  macgyver

	* modules/mod_xfer.c: sendfile() now deprecates politely on Linux
	  2.0.x.

1999-10-17 13:09  macgyver

	* doc/Configuration.html: Added in documentation for DisplayReadme.

1999-10-17 12:11  macgyver

	* contrib/genuser.pl: Added in genuser.pl to facilitiate the
	  creation of username:password AuthUserFile entries.

1999-10-11 22:28  macgyver

	* src/ftpwho.c: Added in ftpwho.c.

1999-10-11 20:40  macgyver

	* modules/mod_pam.c: Fixed AuthPAMAuthoritative.

1999-10-11 04:14  macgyver

	* contrib/: mod_pgsql.c, mod_sqlpw.c: Minor code cleanups.

1999-10-11 00:28  macgyver

	* NEWS, config.h.in, configure, configure.in, include/conf.h: Added
	  in support for setgroupent.

1999-10-11 00:20  macgyver

	* modules/mod_auth.c: Fixed the 'no names, just UIDs' bug.

1999-10-10 22:07  macgyver

	* ChangeLog: Updated.

1999-10-10 21:45  macgyver

	* Make.rules.in, Makefile.in, NEWS, src/Makefile.in,
	  src/ftpcount.c: Corrected a couple of grammatical errors in
	  ftpcount/ftpwho, and seperated them into their own binaries.

1999-10-10 20:13  macgyver

	* NEWS, configure, contrib/mod_ldap.c, contrib/mod_linuxprivs.c,
	  contrib/mod_ratio.c, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_log.c, modules/mod_ls.c, modules/mod_pam.c,
	  modules/mod_readme.c, modules/mod_xfer.c, src/log.c, src/main.c,
	  src/utils.c: Updated logging to be more consistent, and generally
	  be more informative.

1999-10-10 20:10  macgyver

	* README.PAM: Updated some information for FreeBSD, SuSE, and
	  others.

1999-10-10 11:33  macgyver

	* NEWS, configure.in: install_group slightly more portable.

1999-10-10 03:05  macgyver

	* contrib/mod_ldap.c: Updated author/copyright info.

1999-10-10 03:01  macgyver

	* contrib/mod_ldap.c, doc/Configuration.html: Added in mod_ldap.

1999-10-07 11:10  macgyver

	* NEWS: Updated.

1999-10-07 11:10  macgyver

	* modules/mod_pam.c: Removed Log RCS ID.

1999-10-06 20:25  macgyver

	* modules/mod_auth.c, modules/mod_core.c, src/main.c: Added in some
	  better/clearer logging support.

1999-10-05 22:26  macgyver

	* NEWS, README.PAM: Fixed FreeBSD documentation.

1999-10-05 20:48  macgyver

	* modules/mod_auth.c: Fixed potential segfault in
	  group_expression().

1999-10-05 20:47  macgyver

	* doc/Configuration.html: Removed Bandwidth from docs.

1999-10-05 20:40  macgyver

	* NEWS: Updated.

1999-10-05 20:39  macgyver

	* modules/mod_pam.c: AuthPAMAuthoritative now defaults to False.

1999-10-04 22:39  macgyver

	* NEWS: Added a news file.

1999-10-04 22:37  macgyver

	* acconfig.h, config.h.in, configure, configure.in,
	  doc/Undocumented.txt, include/data.h, src/data.c: Added in
	  support for sendfile on BSD platforms.

1999-10-04 21:28  macgyver

	* ChangeLog, Makefile.in, doc/Undocumented.txt, doc/mod_sample.c,
	  modules/mod_sample.c: Miscellaneous reshuffling.

1999-10-04 17:07  macgyver

	* configure, configure.in: Fixed a small typo.

1999-10-04 16:58  macgyver

	* ChangeLog: Updated.

1999-10-04 16:58  macgyver

	* ChangeLog: [no log message]

1999-10-04 16:57  macgyver

	* changelog, doc/Changes-1.2.0pre3: Moved the old changelog to
	  doc/Changes-1.2.0pre3 to avoid any confusion.

1999-10-04 16:54  macgyver

	* ChangeLog: Updated the ChangeLog.

1999-10-04 16:41  macgyver

	* contrib/mod_pgsql.c: Fixed a bad path in includes.

1999-10-04 16:39  macgyver

	* contrib/mod_ratio.c: Fixed a typo in an snprintf.

1999-10-04 16:35  macgyver

	* include/version.h: Updated to pre8.

1999-10-04 16:35  macgyver

	* configure, configure.in: Enhanced configure to automagically
	  create the necessary symlinks.

1999-10-04 16:34  macgyver

	* contrib/: mod_mysql.c, mod_pgsql.c: Fixed references to absolute
	  paths.

1999-10-04 16:09  macgyver

	* contrib/: mod_mysql.c, mod_mysql.h, mod_pgsql.c, mod_ratio.c,
	  mod_sqlpw.c: Added in Johnie Ingram's latest mod_*sql patches,
	  along with some slight buffer fixes of my own.

1999-10-01 16:52  macgyver

	* src/support.c: Fixed a typo with statvfs.

1999-10-01 08:57  macgyver

	* doc/Undocumented.txt: Updated undocumented directives.

1999-10-01 01:13  macgyver

	* ChangeLog: Moved to cvs2cl generation of ChangeLogs.

1999-10-01 00:58  macgyver

	* ChangeLog: Updated ChangeLog

1999-10-01 00:57  macgyver

	* config.h.in, configure, configure.in, include/data.h,
	  include/dirtree.h, include/log.h, include/proftpd.h,
	  modules/mod_auth.c, modules/mod_core.c, modules/mod_log.c,
	  modules/mod_xfer.c, src/io.c, src/log.c, src/main.c: Added
	  classes support, new bandwidth support, and sendfile support.

1999-10-01 00:55  macgyver

	* src/data.c: Added support for sendfile().

1999-09-30 21:08  macgyver

	* doc/Undocumented.txt: Regenerated the undocumented directives.

1999-09-30 20:49  macgyver

	* include/privs.h, modules/mod_auth.c: Added in support for
	  setresuid on HP/UX.

1999-09-30 20:36  macgyver

	* doc/Configuration.html, modules/mod_xfer.c: Added new Bandwidth
	  code and documentation.

1999-09-30 20:35  macgyver

	* modules/mod_auth.c: Corrected a tricky bug with parsing of
	  configuration files.	Thanks Klaus.

1999-09-30 20:34  macgyver

	* modules/mod_ls.c: Fixed a silly typo with snprintf.

1999-09-30 20:33  macgyver

	* modules/mod_unixpw.c: Added support for HP/UX-style security.

1999-09-30 20:33  macgyver

	* modules/mod_core.c: Removed old and naieve bandwidth code.

1999-09-30 20:32  macgyver

	* src/dirtree.c, include/dirtree.h: Remove old and naieve bandwidth
	  code.

1999-09-30 20:31  macgyver

	* config.h.in, configure, configure.in: HP/UX security detection
	  added.

1999-09-29 23:10  macgyver

	* modules/mod_auth.c: Fix a potential security hole.

1999-09-29 23:10  macgyver

	* modules/mod_ls.c: DirFakeMode available inside <Directory>
	  blocks.

1999-09-29 23:04  macgyver

	* configure, configure.in: Corrected configure portability issues.

1999-09-29 23:03  macgyver

	* modules/mod_ls.c: Corrected static declarations.

1999-09-29 22:54  macgyver

	* contrib/mod_linuxprivs.c: Added support for PowerPC
	  architectures.

1999-09-29 22:54  macgyver

	* src/dirtree.c: Corrected a couple of problems related to IP LIMIT
	  directives.

1999-09-29 22:28  macgyver

	* contrib/mod_readme.c: Deleted spurious mod_readme file.

1999-09-29 22:13  macgyver

	* modules/mod_core.c: Fixed compliance with RFC 929 with respect to
	  RNTO.

1999-09-29 13:46  macgyver

	* modules/: mod_auth.c, mod_ls.c: Minor bug fixes.

1999-09-29 13:45  macgyver

	* src/dirtree.c: Fixed a bug in match_ip that was causing some
	  LIMIT directives to fail.

1999-09-28 16:09  macgyver

	* src/inet.c: Corrected an incorrect call to inet_validate in
	  inet_getaddr.

1999-09-26 14:42  macgyver

	* doc/Configuration.html: Fixed a small typo.

1999-09-26 10:03  macgyver

	* ChangeLog: Added in a real ChangeLog.

1999-09-26 03:02  macgyver

	* doc/Undocumented.txt, modules/mod_core.c: Added in
	  CommandBufferSize.

1999-09-25 23:00  macgyver

	* src/log.c: Corrected minor syslog errors.

1999-09-25 22:36  macgyver

	* src/dirtree.c: Fixed a C++ style comment.

1999-09-25 22:32  macgyver

	* src/utils.c: Compilation issues on other Unix platforms
	  addressed.

1999-09-25 22:08  macgyver

	* doc/Configuration.html: Added in updated configuration
	  directives.

1999-09-18 11:26  macgyver

	* src/: dirtree.c, fs.c: Cleaned up usage of fs_readlink.

1999-09-18 11:25  macgyver

	* src/log.c: Code cleanups.

1999-09-18 11:25  macgyver

	* src/: pool.c, support.c: Minor code beautification.

1999-09-18 11:23  macgyver

	* modules/mod_ls.c: Fixed some bad code calling fs_readlink.

1999-09-17 00:36  macgyver

	* Makefile.in: Fixed symbolic link installation.

1999-09-17 00:31  macgyver

	* contrib/mod_mysql.c, contrib/mod_ratio.c, include/support.h,
	  modules/mod_auth.c, modules/mod_core.c, modules/mod_log.c,
	  modules/mod_ls.c, modules/mod_pam.c, modules/mod_tar.c,
	  modules/mod_test.c, modules/mod_xfer.c, src/auth.c,
	  src/dirtree.c, src/fs.c, src/ftpcount.c, src/log.c, src/main.c,
	  src/pool.c, src/support.c, src/utils.c: Implemented sstrncpy to
	  handle proper buffer copying issues on all platforms.

1999-09-16 21:14  macgyver

	* modules/mod_ls.c: gcc cleanups.

1999-09-16 21:14  macgyver

	* modules/mod_log.c: Eliminated some potential problems with
	  logging.

1999-09-16 21:13  macgyver

	* modules/mod_xfer.c: gcc cleanups and a more informative error
	  message added.

1999-09-16 21:06  macgyver

	* src/log.c: More intelligent handling of logfiles to avoid a
	  potential race condition.

1999-09-16 21:05  macgyver

	* modules/mod_core.c: General regex cleanups.  Added
	  AllowFilter/DenyFilter.  More intelligent handling of logfiles.
	  gcc cleanups.  wu-ftp style logging of deleted files.

1999-09-16 21:00  macgyver

	* src/pool.c: Fixed gcc warnings.

1999-09-16 20:59  macgyver

	* src/main.c: Added AllowFilter/DenyFilter.  Fixed a small typo
	  with newlines.  Corrected a slight problem with memory debugging.
	  Fixed several gcc warnings.

1999-09-16 20:57  macgyver

	* src/utils.c: Check for bad DNS entries.

1999-09-16 20:56  macgyver

	* include/inet.h, src/inet.c: Check for any potential DNS spoofing
	  attacks from the outside.

1999-09-16 20:55  macgyver

	* include/version.h: Bumped version number.

1999-09-16 20:54  macgyver

	* sample-configurations/complex-virtual.conf: Added in a new sample
	  configuration.

1999-09-16 20:53  macgyver

	* contrib/proftpd.spec.in: Added in mod_readme.

1999-09-16 20:45  macgyver

	* .cvsignore, contrib/.cvsignore: Added some more files to ignore.

1999-09-16 10:20  macgyver

	* src/main.c: Changed an argument reversal.

1999-09-16 00:45  macgyver

	* src/log.c: Cleaned up some ugly code.

1999-09-16 00:42  macgyver

	* src/main.c: Fixed a silly, yet insidious, way to overflow a
	  buffer.

1999-09-14 11:36  macgyver

	* modules/mod_xfer.c: Corrected a minor typo .in -> .in.

1999-09-14 01:43  macgyver

	* changelog, include/proftpd.h, modules/mod_core.c,
	  modules/mod_xfer.c: Implemented HiddenStor.

1999-09-12 14:11  macgyver

	* README.Solaris2.5x: Additional information regarding Solaris
	  2.5.x systems added.

1999-09-12 13:28  macgyver

	* config.h.in, configure, configure.in, include/conf.h, src/log.c:
	  Added in support for utmpx under Solaris and like-minded
	  platforms.

1999-09-12 10:04  macgyver

	* doc/: Configuration.html, FAQ-config.html, GetConf,
	  ShowUndocumented, Undocumented.txt: Added configuration
	  documentation and 'un' documentation.

1999-09-12 09:30  macgyver

	* contrib/mod_ratio.c, doc/GetConf, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_readme.c, modules/mod_sample.c: Initial import of
	  GetConf, and slight cleanup in all modules.

1999-09-11 17:08  macgyver

	* changelog, src/ftpcount.1, src/ftpshut.8, src/ftpwho.1,
	  src/proftpd.8: Corrected mailing list addresses.

1999-09-11 17:05  macgyver

	* contrib/proftpd.spec.in, include/version.h: Corrected versioning
	  info.

1999-09-11 13:50  macgyver

	* configure, configure.in: Forgot the 'id' issue.

1999-09-11 13:45  macgyver

	* contrib/proftpd.spec.in: Cleanup of spec file.

1999-09-11 13:44  macgyver

	* configure, configure.in: A couple of more configure fixes.

1999-09-10 14:17  macgyver

	* README.PAM, src/log.c: Added PAM README, and modified log.c to
	  handle log_xfer more like WU-FTPd.

1999-09-10 13:17  macgyver

	* INSTALL, README, contrib/mod_pam.c, modules/mod_pam.c: Moved PAM
	  into the main module set.  It's now a 'core' feature.

1999-09-10 12:49  macgyver

	* src/main.c: Added CommandBufferSize option.

1999-09-10 12:08  macgyver

	* configure, configure.in: Fixed a small typo with shadow use.

1999-09-10 01:21  macgyver

	* configure, configure.in: Updated support for Solaris, and made
	  PAM sleep quietly when told to do so.

1999-09-10 00:46  macgyver

	* src/support.c: Fixed remaining buffer issues in sreplace.

1999-09-09 22:36  macgyver

	* src/pool.c: Corrected alignment issues on 64-bit platforms.
	  Thanks to Todd C. Miller <millert@ee.ethz.ch> for the patch.

1999-09-09 22:27  macgyver

	* src/ftpshut.c: Cleaned up ftpshut options to return more
	  meaningful errors.

1999-09-09 20:44  macgyver

	* src/pool.c: Fix for improper strncpy.

1999-09-08 20:18  macgyver

	* src/support.c: Corrected a length bug in sreplace.

1999-09-08 01:35  macgyver

	* configure, configure.in, contrib/mod_pam.c: Updates to
	  auto-configuring for PAM on *BSD.

1999-09-08 01:03  macgyver

	* configure, configure.in: Fixed setproctitle detection on *BSD
	  platforms.

1999-09-08 00:48  macgyver

	* configure, configure.in: Fixed an extra 'fi' statement.

1999-09-08 00:43  macgyver

	* configure, configure.in: Fixed a small typo in PAM detection.

1999-09-08 00:42  macgyver

	* Make.rules.in, config.h.in: Added memory debugging support.

1999-09-08 00:15  macgyver

	* contrib/: mod_mysql.c, mod_mysql.h: Initial import of mod_mysql,
	  with some buffer fixes.

1999-09-08 00:09  macgyver

	* modules/Makefile.in: Updated for mod_mysql.

1999-09-08 00:06  macgyver

	* config.guess: Added in StrongARM support.

1999-09-07 23:59  macgyver

	* src/main.c: Added in some debugging code to assist in tracking
	  down memory problems.

1999-09-07 23:58  macgyver

	* src/pool.c: Fixed a couple of bugs introduced by silly typos.

1999-09-07 23:57  macgyver

	* src/log.c: Minor buffer cleanups.

1999-09-07 23:55  macgyver

	* src/inet.c: Added a helper message for people who misconfigure
	  their servers.

1999-09-07 16:29  macgyver

	* Makefile.in, config.h.in, configure, configure.in,
	  include/dirtree.h, include/fs.h, include/version.h, lib/glob.c,
	  src/dirtree.c, src/fs.c, src/ftpcount.c, src/inet.c, src/log.c,
	  src/main.c, src/modules.c, src/pool.c, src/support.c: Removed
	  lots of unsafe buffer copies, as well as addressed a couple of
	  Y2K issues.

1999-09-07 16:22  macgyver

	* contrib/.cvsignore: Removed README.linux-privs

1999-09-07 16:17  macgyver

	* contrib/: ftp.pamd, proftpd.spec.in: Added in RPM spec and
	  ProFTPD PAM file.

1999-09-07 16:14  macgyver

	* contrib/mod_linuxprivs.c: Updated capabilities code to newer
	  release.

1999-09-07 16:13  macgyver

	* contrib/mod_ratio.c: Fixed some potential buffer issues.

1999-09-07 16:13  macgyver

	* contrib/mod_pam.c: Some minor security updates to fix potential
	  buffer problems.

1999-09-07 16:09  macgyver

	* modules/: mod_auth.c, mod_log.c, mod_ls.c, mod_site.c, mod_tar.c,
	  mod_test.c, mod_unixpw.c, mod_xfer.c: Removed unsafe buffer
	  copies that may have been potential problems.  Implemented the
	  'real' patch for the MKD/log security issues.

1999-09-07 16:08  macgyver

	* modules/mod_core.c: Added in Bandwidth patch for bandwidth
	  control.  Security cleanups -- removed lots of unsafe buffer
	  copies.

1999-09-07 16:06  macgyver

	* modules/Makefile.in: Updated Makefile for new capabilities code.

1999-08-30 18:31  flood

	* changelog, contrib/mod_linuxprivs.c, include/options.h,
	  include/pool.h, modules/mod_core.c, modules/mod_ls.c,
	  modules/mod_xfer.c, src/log.c, src/main.c, src/modules.c,
	  src/pool.c: Mucho patches.

1999-03-11 17:58  flood

	* changelog, modules/mod_xfer.c: TYPE A N

1999-03-11 17:37  flood

	* changelog, src/inet.c: OpenBSD SO_REUSEADDR patch.

1999-03-09 17:19  flood

	* changelog, include/version.h: Version 1.2.0pre3

1999-03-07 09:18  flood

	* changelog, include/proftpd.h, modules/mod_core.c, src/dirtree.c,
	  src/main.c: Added `MultilineRFC2228' directive and changed
	  `ServerIdent'.

1999-03-05 09:55  flood

	* modules/mod_xfer.c, src/timers.c: Oops.  Last nights commit
	  royally screwed timers.

1999-03-04 19:34  flood

	* Make.rules.in, Makefile.in, acconfig.h, changelog, config.h.in,
	  configure, configure.in, contrib/mod_pam.c, include/proftpd.h,
	  modules/Makefile.in, modules/mod_core.c, src/data.c, src/main.c:
	  MacGyver's patch to do argv[] rewriting the Right Way<tm>, and
	  some minor socket error handling fixes.

1999-03-04 18:53  flood

	* changelog, include/io.h, modules/mod_xfer.c, src/ident.c,
	  src/io.c, src/main.c: Fixed ident & i/o (hanging) problems.

1999-03-04 16:44  flood

	* changelog, modules/mod_xfer.c: what did I fix?

1999-03-04 16:29  flood

	* include/timers.h, modules/mod_auth.c, src/main.c, src/support.c,
	  src/timers.c: timer code fixed

1999-02-13 18:36  flood

	* modules/mod_ls.c: Ugg.. Yet another mod_ls quickfix.

1999-02-13 17:47  flood

	* modules/mod_auth.c: Ooops.  add_userdir should have tested for >
	  0.

1999-02-13 16:55  flood

	* changelog, include/version.h: Version 1.2.0pre2

1999-02-12 11:37  flood

	* Makefile.in, changelog, modules/mod_auth.c, modules/mod_core.c,
	  modules/mod_ls.c, modules/mod_xfer.c, src/main.c, src/proftpd.8:
	  Mondo changes.

1999-01-27 14:06  flood

	* changelog, include/support.h, modules/mod_ls.c, src/fs.c,
	  src/support.c: More possibly MKD/CWD 'sploits fixed, and mod_ls
	  workin well.

1999-01-21 08:32  flood

	* modules/mod_ls.c, src/ident.c: NLST now works properly! woo!

1999-01-18 19:00  flood

	* modules/mod_readme.c: mod_readme.c added to CVS

1999-01-18 17:34  flood

	* changelog, include/data.h, modules/mod_ls.c, src/data.c,
	  src/fs.c, src/io.c, src/main.c: Still working on NLST RFC959
	  compliane issue.  ncftp client still showing problems.

1998-11-01 11:08  flood

	* changelog, configure, configure.in, contrib/README,
	  contrib/mod_pam.c, contrib/mod_ratio.c, contrib/mod_readme.c,
	  include/proftpd.h, modules/mod_core.c, modules/mod_sample.c,
	  modules/mod_xfer.c, src/dirtree.c: APPE, mod_pam & mod_readme
	  added

1998-10-29 17:38  flood

	* changelog, include/proftpd.h, modules/mod_log.c, src/main.c: Fix
	  Debian bug #28641

1998-10-29 16:59  flood

	* changelog, modules/mod_core.c, src/data.c: Fixes to PASV/PORT.

1998-10-26 17:53  flood

	* changelog, modules/mod_log.c: %{} argument fix in mod_log.c

1998-10-23 04:21  flood

	* changelog, include/pool.h, modules/mod_ls.c, src/main.c,
	  src/pool.c: memory leak in mod_ls fixed

1998-10-17 19:24  flood

	* .cvsignore, COPYING, INSTALL, Make.modules.in, Make.rules.in,
	  Makefile.in, README, README.Solaris2.5x, README.linux-privs,
	  acconfig.h, changelog, config.guess, config.h.in, config.sub,
	  configure, configure.in, install-sh, contrib/.cvsignore,
	  contrib/README, contrib/mod_linuxprivs.c, contrib/mod_ratio.c,
	  contrib/xferstats.holger-preiss, doc/API, doc/development.notes,
	  doc/license.txt, include/conf.h, include/data.h,
	  include/default_paths.h, include/dirtree.h, include/fs.h,
	  include/ftp.h, include/ident.h, include/inet.h, include/io.h,
	  include/libsupp.h, include/log.h, include/modules.h,
	  include/options.h, include/pool.h, include/privs.h,
	  include/proftpd.h, include/sets.h, include/support.h,
	  include/timers.h, include/version.h, lib/.cvsignore,
	  lib/Makefile.in, lib/fnmatch.c, lib/getopt.c, lib/getopt.h,
	  lib/getopt1.c, lib/glob.c, lib/glob.h, lib/pwgrent.c,
	  lib/strsep.c, lib/vsnprintf.c, modules/.cvsignore,
	  modules/Makefile.in, modules/glue.sh, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_sample.c, modules/mod_site.c, modules/mod_tar.c,
	  modules/mod_test.c, modules/mod_unixpw.c, modules/mod_xfer.c,
	  modules/module_glue.c.tmpl, sample-configurations/anonymous.conf,
	  sample-configurations/basic.conf,
	  sample-configurations/virtual.conf, src/.cvsignore,
	  src/Makefile.in, src/auth.c, src/data.c, src/dirtree.c, src/fs.c,
	  src/ftpcount.1, src/ftpcount.c, src/ftpshut.8, src/ftpshut.c,
	  src/ftpwho.1, src/ident.c, src/inet.c, src/io.c, src/log.c,
	  src/main.c, src/modules.c, src/pool.c, src/proftpd.8, src/sets.c,
	  src/support.c, src/timers.c, src/utils.c, src/xferlog.5: Imported
	  source for proftpd 1.2.0

1998-10-17 19:24  flood

	* .cvsignore, COPYING, INSTALL, Make.modules.in, Make.rules.in,
	  Makefile.in, README, README.Solaris2.5x, README.linux-privs,
	  acconfig.h, changelog, config.guess, config.h.in, config.sub,
	  configure, configure.in, install-sh, contrib/.cvsignore,
	  contrib/README, contrib/mod_linuxprivs.c, contrib/mod_ratio.c,
	  contrib/xferstats.holger-preiss, doc/API, doc/development.notes,
	  doc/license.txt, include/conf.h, include/data.h,
	  include/default_paths.h, include/dirtree.h, include/fs.h,
	  include/ftp.h, include/ident.h, include/inet.h, include/io.h,
	  include/libsupp.h, include/log.h, include/modules.h,
	  include/options.h, include/pool.h, include/privs.h,
	  include/proftpd.h, include/sets.h, include/support.h,
	  include/timers.h, include/version.h, lib/.cvsignore,
	  lib/Makefile.in, lib/fnmatch.c, lib/getopt.c, lib/getopt.h,
	  lib/getopt1.c, lib/glob.c, lib/glob.h, lib/pwgrent.c,
	  lib/strsep.c, lib/vsnprintf.c, modules/.cvsignore,
	  modules/Makefile.in, modules/glue.sh, modules/mod_auth.c,
	  modules/mod_core.c, modules/mod_log.c, modules/mod_ls.c,
	  modules/mod_sample.c, modules/mod_site.c, modules/mod_tar.c,
	  modules/mod_test.c, modules/mod_unixpw.c, modules/mod_xfer.c,
	  modules/module_glue.c.tmpl, sample-configurations/anonymous.conf,
	  sample-configurations/basic.conf,
	  sample-configurations/virtual.conf, src/.cvsignore,
	  src/Makefile.in, src/auth.c, src/data.c, src/dirtree.c, src/fs.c,
	  src/ftpcount.1, src/ftpcount.c, src/ftpshut.8, src/ftpshut.c,
	  src/ftpwho.1, src/ident.c, src/inet.c, src/io.c, src/log.c,
	  src/main.c, src/modules.c, src/pool.c, src/proftpd.8, src/sets.c,
	  src/support.c, src/timers.c, src/utils.c, src/xferlog.5: Initial
	  revision

