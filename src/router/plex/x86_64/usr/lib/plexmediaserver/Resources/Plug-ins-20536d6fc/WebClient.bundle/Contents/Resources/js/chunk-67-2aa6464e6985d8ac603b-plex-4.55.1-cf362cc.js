(self.webpackChunkplex_web_client=self.webpackChunkplex_web_client||[]).push([[67],{87067:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>pa});var a=r(67294),n=r(27929),o=r(74309),s=r(38770),l=r(75989),i=r(37703),c=r(22222),d=r(13469),p=r.n(d),u=r(68252),m=r(55885),y=r(76892),v=r(69605),b=r(45399),g=r(27903),P=r(6055),h=r(19755),f=r.n(h),S=r(73034),w=r(69434),E=r(47909),Z=r(56442),D=r(3265),C=r(53145),O=r(4134),I=r(80962),x=r(72759),T=r(27082),k=r(57054),j=Object.defineProperty,N=Object.prototype.hasOwnProperty,M=Object.getOwnPropertySymbols,A=Object.prototype.propertyIsEnumerable,L=(e,t,r)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,R=(e,t)=>{for(var r in t||(t={}))N.call(t,r)&&L(e,r,t[r]);if(M)for(var r of M(t))A.call(t,r)&&L(e,r,t[r]);return e};const W="ui/downloadsPage/initDownloadsPage",H="ui/downloadsPage/resetDownloadsPage",z="ui/downloadsPage/fetchProvidersWithStorage",B="ui/downloadsPage/saveDownloadsParams",U=(0,S.Z)(W),q=(0,S.Z)(H),$=(0,S.Z)(z),K=(0,S.Z)(B);(0,D.Z)({[W](e,t){},[H](e,t){},[z](e,t,r){const a=function(e){return e.get("ui").get("downloadsPage")}(e),n=e.get("embeddedServer");(0,T.c9)((()=>{a.set({isProvidersPending:!0,providersError:null})}));const o=n.getXHROptions(E.Z.join("/media/providers",{includeStorage:1}),{headers:{Accept:Z.AV.accept}});(0,w.Z)("[Downloads] Updating offline file size"),f().ajax(o).then((e=>{n.get("providers").add(e,{parse:!0,merge:!0}),a.set({isProvidersPending:!1,isProvidersPopulated:!0})}),(e=>{a.set({isProvidersPending:!1,providersError:(0,k.Z)(e)})}))},[B](e,t,r){const a=e.get("user").get("experienceSettings").get("savedPivotParams");r((0,O.LN)({savedPivotParams:R(R({},a),{downloads:t})}))},[C.Cs](e,t,r){const{activity:a}=t;(function(e,t){const r=e.get("embeddedServer");return!!r&&r.entityID()===t.serverEntityID})(e,t)&&a.type===x.sC&&a.Response.status===I.ly&&r($())}});var V=r(90934);function _(){return(0,c.P1)((e=>e.downloads.subscriptions),V.Z,((e=[],t)=>e.map((e=>t[e]))))}var F=r(5562);const{ASCENDING:G,DESCENDING:J}=u.Z.directions,X="title",Q="createdAt",Y="storageTotal";var ee=r(48604),te=r(46565),re=r(93143),ae=r(65671),ne=r(72936),oe=r(58801),se=r(95815),le=r(3704),ie=r(82598),ce=r(14838),de=r(83787),pe=r(45697),ue=r.n(pe),me=r(70809);function ye(e){var t=e["aria-label"],r=e.className,n=e.style,o={viewBox:"0 0 560 560",xmlns:"http://www.w3.org/2000/svg",strokeMiterlimit:"1.414",strokeLinejoin:"round",id:"plex-icon-downloads-560"};o["aria-hidden"]=!t,o.style=n,o.className=me.Z.plexIcon+(r?" "+r:"");var s=[a.createElement.apply(a,["path",{d:"m280 476c108.248 0 196-87.752 196-196 0-108.248-87.752-196-196-196-108.248 0-196 87.752-196 196 0 108.248 87.752 196 196 196m0 42c-131.444 0-238-106.556-238-238 0-131.444 106.556-238 238-238 131.444 0 238 106.556 238 238 0 131.444-106.556 238-238 238m0-112l112-112-89.6 0 0-140-44.8 0 0 140-89.6 0 112 112"}].concat([]))];return t&&s.unshift(a.createElement("title",null,t)),a.createElement.apply(a,["svg",o].concat(s))}ye.propTypes={"aria-label":ue().string,className:ue().string,style:ue().object};const ve=ye;function be(e){var t=e["aria-label"],r=e.className,n=e.style,o={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 40 40",id:"plex-icon-downloads-upsell-560"};o["aria-hidden"]=!t,o.style=n,o.className=me.Z.plexIcon+(r?" "+r:"");var s=[a.createElement.apply(a,["path",{d:"M35.335 26.667h-.667v-16A2.67 2.67 0 0 0 32.001 8h-24a2.67 2.67 0 0 0-2.667 2.667v16h-.667a.667.667 0 0 0-.667.667v2.667c0 1.103.897 2 2 2h28c1.103 0 2-.897 2-2v-2.667a.667.667 0 0 0-.667-.667h.002zm-28.666-16c0-.736.599-1.333 1.333-1.333h24c.735 0 1.333.597 1.333 1.333v16h-10a.667.667 0 0 0-.667.667v.667h-5.333v-.667a.667.667 0 0 0-.667-.667h-10v-16h.001zm28 19.333a.668.668 0 0 1-.667.667h-28A.668.668 0 0 1 5.335 30v-2h10.667v.667c0 .368.299.667.667.667h6.667a.667.667 0 0 0 .667-.667V28H34.67v2h-.001zm-2.668-5a.667.667 0 0 1-.667.667H8.667A.667.667 0 0 1 8 25V11.667c0-.368.299-.667.667-.667h22.667c.368 0 .667.299.667.667V25zm-1.333-.667v-12H9.335v12h21.333zm-8.878-5.805a.668.668 0 1 1 .945.944l-2.223 2.221a.684.684 0 0 1-.472.195.677.677 0 0 1-.472-.195l-2.223-2.221a.668.668 0 0 1 .943-.943l1.084 1.083v-3.945a.667.667 0 0 1 1.334 0v3.945l1.084-1.084z"}].concat([]))];return t&&s.unshift(a.createElement("title",null,t)),a.createElement.apply(a,["svg",o].concat(s))}be.propTypes={"aria-label":ue().string,className:ue().string,style:ue().object};const ge=be;var Pe=r(31590),he=r(9220),fe=r(48022),Se=r(90961),we=r(7796);const Ee=parseInt(we.Z.downloadCellHeight,10),Ze=(0,Se.Z)(Ee,5);var De=r(72194),Ce=r(50362),Oe=r(98727),Ie=r(70488),xe=r(74253),Te=r(14699),ke=r(61478),je=r(69881),Ne=r(99051),Me=r(51021),Ae=r(34082);var Le=r(90087),Re=r(60208),We=r(6638),He=r(25366),ze=r(91997),Be=r(14513),Ue=r(26416),qe=r(78188),$e=r(46277),Ke=r(85480),Ve=r(97486),_e=r(95368),Fe=r(56473),Ge=r(97863),Je=r(67635),Xe=Object.defineProperty,Qe=Object.prototype.hasOwnProperty,Ye=Object.getOwnPropertySymbols,et=Object.prototype.propertyIsEnumerable,tt=(e,t,r)=>t in e?Xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const rt=(0,i.$j)((function(){return(0,c.P1)(((e,{isDisabled:t})=>t),(0,Je.Z)(),((e,t)=>({isDisabled:e||t})))}))((e=>{const{metadataItemEntityID:t,buttonComponent:r,dispatch:n}=e,o=((e,t)=>{var r={};for(var a in e)Qe.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&Ye)for(var a of Ye(e))t.indexOf(a)<0&&et.call(e,a)&&(r[a]=e[a]);return r})(e,["metadataItemEntityID","buttonComponent","dispatch"]);return a.createElement(r,((e,t)=>{for(var r in t||(t={}))Qe.call(t,r)&&tt(e,r,t[r]);if(Ye)for(var r of Ye(t))et.call(t,r)&&tt(e,r,t[r]);return e})({},o))}));var at=r(72369);const nt=function(e){return(0,at.Z)(e||0,e>=1e9?2:0)};var ot=r(46453),st=r(90701),lt=r(39611),it=r(52410),ct=r(34272),dt=r(53863);const pt="DownloadSubscriptionSummaryCell-button-lFTKLD MetadataSummaryCell-button-BBVAbI";var ut=Object.defineProperty,mt=Object.prototype.hasOwnProperty,yt=Object.getOwnPropertySymbols,vt=Object.prototype.propertyIsEnumerable,bt=(e,t,r)=>t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gt=(e,t)=>{for(var r in t||(t={}))mt.call(t,r)&&bt(e,r,t[r]);if(yt)for(var r of yt(t))vt.call(t,r)&&bt(e,r,t[r]);return e};const Pt=(0,c.P1)(Ae.Z,(e=>(0,xe.h)(e))),ht=(0,c.P1)(Ae.Z,Oe.Z,((e,t)=>e&&e.providers.map((e=>t[e])))),ft=new RegExp(Q),St=new RegExp(Y),wt=(0,i.$j)((function(){return(0,c.P1)(((e,{activeSort:t})=>t),((e,{listContext:t})=>t),Pt,(0,De.Z)((0,c.P1)((0,Te.Z)(),ht,((e,t)=>{const{source:r}=e.hint,a=t.find((e=>e.source===r));return(0,Ie.R)(a)})),(e=>e)),(0,Te.Z)(),(0,c.P1)(Ce.Z,(0,Te.Z)(),((e,t)=>t.target?e[t.target.metadata]:null)),(e=x.EW,(0,c.P1)((0,Te.Z)(),(0,Me.Z)(e),((e,t)=>t.find((({Context:t})=>t.subscriptionID===e.key))))),((e,t,r,a,n,o,s)=>{const{grabOperations:l,hint:i}=n,{subtype:c,type:d}=i,p=function(e,t,r){const{type:a,subtype:n}=e,o=(0,Le.Z)(a,n,t);return(0,Re.Z)(o,null,a,n,r||{},t)}(i,t,o),u=d!==je.TRACK||c===ke.PODCAST,m=o&&u?(0,We.Z)(r,a,o.key,void 0,o.playlistType):void 0,y=l&&l.find((e=>e.status===I.pn));return{grabError:y&&(y.error||(0,F.Z)("An unexpected error occurred")),isRefreshing:!!s,isDownloadPending:!o&&!!s&&null==s.Context.completed,isDownloading:!!s&&null!=s.Context.total&&null!=s.progress,mediaSubscription:n,imageWidth:p.width,imageHeight:p.height,imageUrl:p.url,metadataItemEntityID:o?o.entityID:null,providerEntityID:a.entityID,route:m,progress:s?s.progress:null,completed:s?s.Context.completed:null,total:s?s.Context.total:null,showEdit:(v=d,v===je.SHOW),showCreatedAt:ft.test(e),showStorageTotal:!!o&&St.test(e)};var v}));var e}),(function(e,t){const{mediaSubscriptionEntityID:r,metricsPage:a,metricsProperties:n}=t,o={mediaSubscriptionEntityID:r,metricsPage:a,metricsProperties:n};return{onEditItem(){e((0,Ne.nY)(o))},onDeleteItem(){e((0,P.L7)(o))},onRetryItem(){e((0,P.OS)(o))}}}))((function(e){const{cellIndex:t,grabError:r,imageHeight:n,imageUrl:o,imageWidth:s,mediaSubscription:l,metadataItemEntityID:i,providerEntityID:c,route:d,progress:p,completed:u,total:m,showStorageTotal:y,showCreatedAt:b,showEdit:g,serverEntityID:P,isDownloadPending:h,isDownloading:f,isRefreshing:S,onEditItem:w,onRetryItem:E,onDeleteItem:Z}=e,D=(0,Ue.Z)(e),[C,O]=(0,a.useState)(!1),I=(0,a.useCallback)((()=>{O(!0)}),[]),x=(0,a.useCallback)((()=>{O(!1),Z()}),[Z]),T=(0,a.useCallback)((()=>{O(!1)}),[]),{hint:k,target:j}=l,{title:N,type:M,subtype:A}=k;let L,R;h?L=(0,F.Z)("Waiting to download"):f&&(L=m>1?(0,F.Z)("Downloading {completed} of {total}",{completed:u+1,total:m}):(0,F.Z)("Downloading")),y?R=nt(l.storageTotal):b&&(R=(0,qe.Z)(l.createdAt)),R=R?` ${He.U} ${R}`:R;const W=!1,H=!S&&r,z=function(e){const{parentTitle:t,grandparentTitle:r,type:a,subtype:n,index:o}=e,s=a===je.TRACK;let l;return a===je.SEASON?l=(0,Ke.Z)({seasonIndex:o,noLeadingZero:!0,useLongName:!0}):a===je.EPISODE||s&&n===ke.PODCAST?l=r:s&&r&&t?l=`${r} ${He.U} ${t}`:s&&r&&(l=r),l}(k);return a.createElement("div",{className:t%2?"DownloadSubscriptionSummaryCell-alternateItem-1A8Zzn MetadataSummaryCell-alternateItem-wclmMn MetadataSummaryCell-item-2ksqkJ":"DownloadSubscriptionSummaryCell-item-3M-lL7 MetadataSummaryCell-item-2ksqkJ",style:D.style},d?a.createElement(ee.Z,{className:"DownloadSubscriptionSummaryCell-underlay-3TS4x- MetadataSummaryCell-underlay-8Jnos2",tabIndex:"0",to:d,"aria-label":N}):null,a.createElement("div",{className:"DownloadSubscriptionSummaryCell-overlay-dAXkOf MetadataSummaryCell-overlay-xhIvnb"},a.createElement("div",{className:"DownloadSubscriptionSummaryCell-posterContainer-zPuewH MetadataSummaryCell-posterContainer-O13JZA"},D.isPlaceholder?a.createElement(Ge.Z,{imageWidth:s,imageHeight:n}):a.createElement(Fe.Z,{metadataKey:l.hint.source,metadataItemEntityID:i,serverEntityID:P,providerEntityID:c,route:d,showOverlay:!!j,showLink:W,showSelect:W,showEdit:W,showMore:W,title:N,type:M,subtype:A,imageWidth:s,imageHeight:n,imageUrl:o,isOffscreen:!1})),a.createElement("div",{className:"DownloadSubscriptionSummaryCell-summaryContainer-1JNlmo MetadataSummaryCell-summaryContainer-2b-kz5"},a.createElement("div",{className:"DownloadSubscriptionSummaryCell-titleContainer-1dErNo MetadataSummaryCell-titleContainer-1gsRA4"},a.createElement("div",{className:"DownloadSubscriptionSummaryCell-title-2hLVkH MetadataSummaryCell-title-1svrXs"},function(e){const{title:t,parentTitle:r,grandparentTitle:a,type:n,index:o,parentIndex:s,originallyAvailableAt:l}=e;let i=a||r||t;return n===je.EPISODE?i=`${(0,$e.Z)({episodeIndex:o,seasonIndex:s,date:l,noLeadingZero:!0,separator:" Â· "})} ${He.U} ${t}`:n===je.TRACK&&(i=t),i}(k))),a.createElement("div",{className:"DownloadSubscriptionSummaryCell-summary-3_lMwW MetadataSummaryCell-summary-24HmlZ"},z?a.createElement("div",null,z):null,H?a.createElement("div",null,a.createElement(lt.Z,{className:"DownloadSubscriptionSummaryCell-errorIcon-2-w8-n"}),r):a.createElement("div",null,function(e){const{guid:t,subtype:r,type:a}=e,{MOVIE:n,SHOW:o,SEASON:s,EPISODE:l,TRACK:i}=je,{PODCAST:c,WEBSHOW:d}=ke;return a===o&&r===c?(0,F.Z)("Podcast"):a===i&&r===c?(0,F.Z)("Podcast Episode"):a===o&&r===d?(0,F.Z)("Web Show"):a===l&&r===d?(0,F.Z)("Web Show Episode"):a===n&&t.includes(ot.Hn)?(0,F.Z)("Video"):a===s?(0,F.Z)("TV Show Season"):a===l?(0,F.Z)("TV Show Episode"):je.getMetadataType(a).title}(k),R))),h||f?a.createElement("div",{className:"DownloadSubscriptionSummaryCell-statusContainer-1VXTY8"},a.createElement("div",{className:"DownloadSubscriptionSummaryCell-statusText-2vPLGA"},L),a.createElement(Ve.Z,{lineWidth:2,progress:p,showProgressText:!1,showIndeterminate:h,size:20,strokeColor:st.Z.selectedColor,trackColor:st.Z.defaultLinkDisabledLinkColor})):null,a.createElement("div",{className:"DownloadSubscriptionSummaryCell-actions-1zdFbL MetadataSummaryCell-actions-3CiM9B"},H?a.createElement(Be.Z,{component:ze.Z,className:pt,tooltip:(0,F.Z)("Retry"),ariaLabel:(0,F.Z)("Retry {title}",{title:N}),iconComponent:ct.Z,onPress:E}):null,g?a.createElement(Be.Z,{component:ze.Z,className:pt,tooltip:(0,F.Z)("Edit"),ariaLabel:(0,F.Z)("Edit download details for {title}",{title:N}),iconComponent:it.Z,onPress:w}):null,a.createElement(rt,{metadataItemEntityID:i,buttonComponent:Be.Z,component:ze.Z,"data-qa-id":"downloadSubscriptionRemoveButton",className:pt,tooltip:(0,F.Z)("Delete"),ariaLabel:(0,F.Z)("Delete {title}",{title:N}),iconComponent:dt.Z,kind:te.T,onPress:I}),a.createElement(_e.Z,{isOpen:C,metricsPage:v.Ke,title:(0,F.Z)("Delete Download"),message:(0,F.Z)("Are you sure you want to delete this download?"),onConfirm:x,onCancel:T}))))}));wt.propTypes=gt(gt({},wt.propTypes),{mediaSubscriptionEntityID:ue().string.isRequired,metricsPage:ue().string.isRequired,metricsProperties:ue().object.isRequired});const Et=wt;var Zt=Object.defineProperty,Dt=Object.prototype.hasOwnProperty,Ct=Object.getOwnPropertySymbols,Ot=Object.prototype.propertyIsEnumerable,It=(e,t,r)=>t in e?Zt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xt=(e,t)=>{for(var r in t||(t={}))Dt.call(t,r)&&It(e,r,t[r]);if(Ct)for(var r of Ct(t))Ot.call(t,r)&&It(e,r,t[r]);return e};const Tt=function(e){const{activeSort:t,metricsPage:r,metricsProperties:n,serverEntityID:o}=e,s=((e,t)=>{var r={};for(var a in e)Dt.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&Ct)for(var a of Ct(e))t.indexOf(a)<0&&Ot.call(e,a)&&(r[a]=e[a]);return r})(e,["activeSort","metricsPage","metricsProperties","serverEntityID"]),l=(0,a.useMemo)((()=>e=>a.createElement(Et,xt(xt({},e),{serverEntityID:o,activeSort:t,listType:fe.t1,listContext:he.jF,metricsPage:r,metricsProperties:n}))),[t,r,n,o]);return a.createElement(Pe.Z,xt(xt({},s),{className:"DownloadSubscriptionSummaryList-content-2zjhKA",scrollerClassName:"DownloadSubscriptionSummaryList-scroller-2h25nF VirtualListScroller-scroller-1ap5-a",scrollPositionStorageKey:"DownloadSubscriptionSummaryList",keyPropName:"mediaSubscriptionEntityID",layout:Ze,cellRenderer:l}))};var kt=r(67006),jt=Object.defineProperty,Nt=Object.prototype.hasOwnProperty,Mt=Object.getOwnPropertySymbols,At=Object.prototype.propertyIsEnumerable,Lt=(e,t,r)=>t in e?jt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rt=(e,t)=>{for(var r in t||(t={}))Nt.call(t,r)&&Lt(e,r,t[r]);if(Mt)for(var r of Mt(t))At.call(t,r)&&Lt(e,r,t[r]);return e};let Wt,Ht;function zt(e,t=window.location.hash){const r=function(e){if(Wt===e)return Ht;const t=e.split("?"),r=t.length>1?t[1]:void 0,a=r?E.Z.parseParams(r):{};return Wt=e,Ht={url:t[0],params:a},Ht}(t);return E.Z.join(r.url,Rt(Rt({},r.params),{type:e.type,subtype:e.subtype,sort:e.sort,save:1}))}function Bt(e,t,r){return t?function(e,t){switch(e){case ke.PODCAST:return t?(0,F.Z)("Podcasts"):(0,F.Z)("Podcast");case ke.WEBSHOW:return t?(0,F.Z)("Web Shows"):(0,F.Z)("Web Show")}}(t,r):e?function(e,t){const r=je.getMetadataType(e);return t?r.plural:r.title}(e,r):(0,F.Z)("All")}function Ut({type:e,subtype:t,sort:r}){const a={save:1};return e&&(a.type=e),t&&(a.subtype=t),r&&(a.sort=r),{type:e,subtype:t,title:Bt(e,t,!0),route:zt(a)}}var qt=r(35815),$t=r(63593),Kt=r(97204),Vt=r(75534),_t=r(83427),Ft=r(91061),Gt=r(31419),Jt=r(64469),Xt=r(26253),Qt=r(72373),Yt=Object.defineProperty,er=Object.prototype.hasOwnProperty,tr=Object.getOwnPropertySymbols,rr=Object.prototype.propertyIsEnumerable,ar=(e,t,r)=>t in e?Yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nr=(e,t)=>{for(var r in t||(t={}))er.call(t,r)&&ar(e,r,t[r]);if(tr)for(var r of tr(t))rr.call(t,r)&&ar(e,r,t[r]);return e};const{ASCENDING:or,DESCENDING:sr}=u.Z.directions,lr=function(e){const{activeType:t,activeSubtype:r,activeSort:n,sorts:o,selectedSort:s,onMenuClose:l}=e,i=((e,t)=>{var r={};for(var a in e)er.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&tr)for(var a of tr(e))t.indexOf(a)<0&&rr.call(e,a)&&(r[a]=e[a]);return r})(e,["activeType","activeSubtype","activeSort","sorts","selectedSort","onMenuClose"]);return a.createElement(Gt.Z,nr(nr({},i),{onMenuClose:l}),o.map((({key:e,descKey:o,defaultDirection:i,title:c})=>{const d=s.key===e;let p=i;d&&(p=n?n===o?or:sr:i===or?sr:or);const u=p===sr;return a.createElement(Jt.Z,{key:e,to:zt({type:t,subtype:r,sort:u?o:e}),isSelected:d,iconComponent:u?Xt.Z:Qt.Z,selectedIconAriaLabel:u?(0,F.Z)("Ascending"):(0,F.Z)("Descending"),onPress:l},c)})))};var ir=Object.defineProperty,cr=Object.prototype.hasOwnProperty,dr=Object.getOwnPropertySymbols,pr=Object.prototype.propertyIsEnumerable,ur=(e,t,r)=>t in e?ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,mr=(e,t)=>{for(var r in t||(t={}))cr.call(t,r)&&ur(e,r,t[r]);if(dr)for(var r of dr(t))pr.call(t,r)&&ur(e,r,t[r]);return e};const yr=function(e){const{activeType:t,activeSubtype:r,types:n,onMenuClose:o}=e,s=((e,t)=>{var r={};for(var a in e)cr.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&dr)for(var a of dr(e))t.indexOf(a)<0&&pr.call(e,a)&&(r[a]=e[a]);return r})(e,["activeType","activeSubtype","types","onMenuClose"]);return a.createElement(Gt.Z,mr(mr({},s),{onMenuClose:o}),n.map((({type:e,subtype:n,title:s,route:l})=>{let i;return i=n?n===r:e?e===t&&!r:!t&&!r,a.createElement(Jt.Z,{key:n||e||"all",to:l,isSelected:i,onMenuClose:o},s)})))};var vr=r(88413),br=r(81473),gr=r(17215),Pr=r(60886),hr=r(84385),fr=r(54939),Sr=r(89267);function wr(e){var t=e["aria-label"],r=e.className,n=e.style,o={viewBox:"0 0 560 560",xmlns:"http://www.w3.org/2000/svg",strokeMiterlimit:"1.414",strokeLinejoin:"round",id:"plex-icon-toolbar-refresh-560"};o["aria-hidden"]=!t,o.style=n,o.className=me.Z.plexIcon+(r?" "+r:"");var s=[a.createElement.apply(a,["path",{d:"M432.272,156.583C396.336,112.3 341.473,84 280,84C171.752,84 84,171.752 84,280C84,388.248 171.752,476 280,476L280,518C148.556,518 42,411.443 42,280C42,148.556 148.556,42 280,42C357.038,42 425.526,78.602 469.024,135.364L532.871,98.503L504,244.497L363.129,196.503L432.272,156.583Z"}].concat([]))];return t&&s.unshift(a.createElement("title",null,t)),a.createElement.apply(a,["svg",o].concat(s))}wr.propTypes={"aria-label":ue().string,className:ue().string,style:ue().object};const Er=wr;var Zr=Object.defineProperty,Dr=Object.prototype.hasOwnProperty,Cr=Object.getOwnPropertySymbols,Or=Object.prototype.propertyIsEnumerable,Ir=(e,t,r)=>t in e?Zr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xr=(e,t)=>{for(var r in t||(t={}))Dr.call(t,r)&&Ir(e,r,t[r]);if(Cr)for(var r of Cr(t))Or.call(t,r)&&Ir(e,r,t[r]);return e};const Tr=2*(0,Pr.Z)(Sr.Z.slowSpeed),kr=function(e){const{isProcessingSubscriptions:t,onPress:r}=e,n=((e,t)=>{var r={};for(var a in e)Dr.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&Cr)for(var a of Cr(e))t.indexOf(a)<0&&Or.call(e,a)&&(r[a]=e[a]);return r})(e,["isProcessingSubscriptions","onPress"]),o=(0,fr.Z)(t,!0,Tr)||t;return a.createElement(gr.Z,xr(xr({},n),{tooltip:(0,F.Z)("Check for new downloads"),tooltipAttachment:hr.OI,"data-qa-id":"toolbarProcessSubscriptions",isDisabled:t,onPress:o?null:r}),o?a.createElement(br.Z,{className:"ToolbarProcessSubscriptionsButton-spinner-1LZvgq Spinner-spinner-5E5Wk_ spin-spin-oHlEXH"}):a.createElement(Er,{className:"ToolbarProcessSubscriptionsButton-icon-2TqatO PlexIcon-plexIcon-1hNiE2"}))},jr={onRefreshDownloads:P.GX},Nr=(0,i.$j)((function(){return(0,c.P1)(_(),(0,vr.ZP)(x.l1),((e,t)=>({canShowProcessSubscriptions:e.length>0,isProcessingSubscriptions:!!t})))}),jr)((function(e){const{className:t,canShowProcessSubscriptions:r,isProcessingSubscriptions:n,onRefreshDownloads:o}=e;return a.createElement("div",{className:t},r?a.createElement(kr,{isProcessingSubscriptions:n,onPress:o}):null)})),Mr=(0,c.P1)(Ae.Z,Oe.Z,((e,t)=>{const{providers:r}=e;return r.reduce(((e,r)=>{const a=t[r].features.find((e=>e.type===kt.P8));return a&&null!=a.storageTotal&&(e+=a.storageTotal),e}),0)})),Ar=(0,i.$j)((function(){return(0,c.P1)(((e,{activeSort:t})=>t),Mr,_(),(0,c.P1)((0,Me.Z)(x.sC),(e=>e.reduce(((e,t)=>e+t.Context.currentSize||0),0))),((e,t,r,a)=>{const n=Ut({sort:e});return{downloadTypes:r.reduce(((t,r)=>{const{type:a,subtype:n}=r.hint;if(!(n?t.find((e=>e.subtype===n)):t.find((e=>e.type===a)))){const r=Ut({type:a,subtype:n,sort:e});t.push(r)}return t}),[n]),storageTotal:t+a}}))}))((function(e){const{serverEntityID:t,activeType:r,activeSubtype:n,activeSort:o,selectedSort:s,downloadTypes:l,storageTotal:i,sorts:c,size:d}=e,p=(0,Vt.Z)(),u=(0,Vt.Z)(),[m,y]=(0,a.useState)(i),[v,b]=(0,a.useState)(!1),[g,P]=(0,a.useState)(!1),h=(0,a.useCallback)((()=>{b(!v)}),[v]),f=(0,a.useCallback)((()=>{b(!1)}),[]),S=(0,a.useCallback)((()=>{P(!g)}),[g]),w=(0,a.useCallback)((()=>{P(!1)}),[]);(0,a.useEffect)((()=>{let e=window.setTimeout((()=>{y(i)}),100);return()=>{e=window.clearTimeout(e)}}),[i]);const E=r||n?(0,F.Z)("All {typeTitle} Downloads",{typeTitle:Bt(r,n,!1)}):(0,F.Z)("All Downloads");return a.createElement(_t.Z,{className:"DownloadsPageHeader-pageHeader-dWvcMI PrimaryPageHeader-pageHeader-2h_9dt PageHeader-pageHeader-WpvbJc"},a.createElement(Kt.Z,null,a.createElement($t.Z,{id:p,"data-qa-id":"downloadsTypesMenuButton",hasMenu:l.length>2,isMenuOpen:v,onPress:h},E),a.createElement(yr,{target:p,isOpen:v,activeType:r,activeSubtype:n,types:l,onMenuClose:f}),d>1?a.createElement($t.Z,{id:u,"data-qa-id":"downloadsSortsMenuButton",hasMenu:!0,isMenuOpen:g,onPress:S},(0,F.Z)("By {sortTitle}",{sortTitle:s.title})):null,d>1?a.createElement(lr,{target:u,isOpen:g,activeType:r,activeSubtype:n,activeSort:o,selectedSort:s,sorts:c,onMenuClose:w}):null,a.createElement(qt.Z,null,d)),a.createElement(Ft.Z,null,a.createElement("div",{className:"DownloadsPageHeader-storageTotal-2Bs463"},(0,F.Z)("{storageTotal} Downloaded",{storageTotal:nt(m)})),a.createElement(Nr,{serverEntityID:t})))})),Lr="DownloadsPage-upsell-3JpmF2",Rr=function(e){const{serverEntityID:t,activeType:r,activeSubtype:n,activeSort:o,selectedSort:s,sorts:l,mediaSubscriptions:i,metricsPage:c,metricsProperties:d,isProvidersPending:p,isProvidersPopulated:u,isMediaSubscriptionsPending:m,canShowUpsell:y,providersError:v,mediaSubscriptionsError:b}=e,[g,P]=(0,a.useState)(!1),h=(0,a.useCallback)((()=>{P(!0)}),[]),f=(0,a.useCallback)((()=>{P(!1)}),[]);if(p&&!u||m&&!i.length)return a.createElement(le.Z,null,a.createElement(oe.Z,null));const S=v||b,w=i.length>0;return a.createElement(se.Z,{metricsPage:c,metricsProperties:d,allowBackgroundLightPreset:!0,scrollDirection:re.Hn},w?a.createElement(Ar,{serverEntityID:t,activeType:r,activeSubtype:n,activeSort:o,selectedSort:s,sorts:l,size:i.length}):null,a.createElement("div",{className:"DownloadsPage-downloadsPageContent-2VzUgn PageContent-pageContent-aqfjwt"},S?a.createElement(ce.Z,null):null,S||w?null:a.createElement(ie.Z,{iconComponent:ge,kind:te._8,title:(0,F.Z)("You have no items downloaded"),description:a.createElement(ae.Z,{className:Lr,message:(0,F.Z)('Use the {downloadIcon} button or choose "Download" from the menu to download items for offline playback.'),tags:[{unpaired:"downloadIcon",children:a.createElement(ve,{key:"downloadIcon"})}]})},y?a.createElement(ae.Z,{className:Lr,message:(0,F.Z)("An active {openPlexPassLink}Plex Pass{closePlexPassLink} is required to download from a Plex Media Server."),tags:[{open:"openPlexPassLink",close:"closePlexPassLink",component:ee.Z,kind:te._8,onPress:h}]}):null),!S&&w?a.createElement(Tt,{serverEntityID:t,items:i,size:i.length,metricsPage:c,metricsProperties:d,activeSort:o}):null,y?a.createElement(de.Z,{origin:ne.Yz,isOpen:g,onModalClose:f}):null))};var Wr=Object.defineProperty,Hr=Object.prototype.hasOwnProperty,zr=Object.getOwnPropertySymbols,Br=Object.prototype.propertyIsEnumerable,Ur=(e,t,r)=>t in e?Wr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,qr=(e,t)=>{for(var r in t||(t={}))Hr.call(t,r)&&Ur(e,r,t[r]);if(zr)for(var r of zr(t))Br.call(t,r)&&Ur(e,r,t[r]);return e},$r=(e,t)=>{var r={};for(var a in e)Hr.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&zr)for(var a of zr(e))t.indexOf(a)<0&&Br.call(e,a)&&(r[a]=e[a]);return r};const Kr={pane:"sync"};function Vr(e,t){return!e&&!t||p().isEqual(e,t)}const _r=(0,g.Z)((e=>{const{key:t,direction:r}=e,{DESCENDING:a}=u.Z.directions;return(e,n)=>{let o,s;return t===X?(o=e.hint[t].toUpperCase(),s=n.hint[t].toUpperCase()):(o=e[t],s=n[t]),o>s?r===a?-1:1:o<s?r===a?1:-1:0}})),Fr={dispatchFetchProvidersWithStorage:$,dispatchInitDownloadsPage:U,dispatchRefreshDownloads:P.GX,dispatchResetDownloadsPage:q,dispatchSaveDownloadsParams:K};class Gr extends a.Component{componentDidMount(){this.props.dispatchInitDownloadsPage(),this.props.dispatchFetchProvidersWithStorage(),this.props.dispatchRefreshDownloads(),this.props.shouldSaveParams&&this._saveDownloadsDefaultParams(this.props)}componentDidUpdate(e){this.props.shouldSaveParams&&!Vr(e.params,this.props.params)&&this._saveDownloadsDefaultParams(this.props)}componentWillUnmount(){this.props.dispatchResetDownloadsPage()}_saveDownloadsDefaultParams(e){Vr(e.params,e.savedDownloadsParams)||e.dispatchSaveDownloadsParams(e.params)}render(){const e=this.props,{params:t,savedDownloadsParams:r,dispatchFetchProvidersWithStorage:n,dispatchRefreshDownloads:o,dispatchInitDownloadsPage:s,dispatchResetDownloadsPage:l,dispatchSaveDownloadsParams:i}=e,c=$r(e,["params","savedDownloadsParams","dispatchFetchProvidersWithStorage","dispatchRefreshDownloads","dispatchInitDownloadsPage","dispatchResetDownloadsPage","dispatchSaveDownloadsParams"]);return a.createElement(Rr,qr(qr({},c),{metricsPage:v.Q_,metricsProperties:Kr}))}}const Jr=(0,i.$j)((function(){return(0,c.P1)(((e,{params:t})=>t),(e=>e.ui.downloadsPage),(e=>e.downloads),y.Z,_(),(0,m.Z)(b.iU),(0,m.Z)(b.Ed),((e,t,r,a,n,o,s)=>{const{sort:l=""}=e;let{type:i,subtype:c}=e;const{isProvidersPending:d,isProvidersPopulated:p,providersError:u}=t,{isSubscriptionsPending:m,subscriptionsError:y}=r,v=[{key:X,descKey:"title:desc",defaultDirection:G,title:(0,F.Z)("Title")},{key:Q,descKey:"createdAt:desc",defaultDirection:J,title:(0,F.Z)("Date Downloaded"),isDefault:!0},{key:Y,descKey:"storageTotal:desc",defaultDirection:J,title:(0,F.Z)("Size on Disk")}],b=l.split(":");let g=b[0];const P=b[1];let h=v.find((e=>e.key===g));h||(h=v.find((e=>e.isDefault))),g||(g=h.key),P&&(h.direction=P);let f=[...n];if((i||c)&&(f=n.reduce(((e,t)=>{const r=t.hint.subtype===c,a=t.hint.type===i;let n=!1;return c?r&&(n=!0):a&&!t.hint.subtype&&(n=!0),n&&e.push(t),e}),[]),n.length&&!f.length)){const{type:t,subtype:r}=e;f=n,e=$r(e,["type","subtype"]),i=null,c=null}const S=_r(h);return f.sort(S),{selectedSort:h,sorts:v,mediaSubscriptions:f.map((e=>e.entityID)),isProvidersPending:d,isProvidersPopulated:p,isMediaSubscriptionsPending:m,canShowUpsell:!o&&!s,providersError:u,mediaSubscriptionsError:y,savedDownloadsParams:a.downloads,params:e,activeType:i,activeSubtype:c,activeSort:l}}))}),Fr)(Gr);var Xr=r(40875),Qr=r(30263),Yr=r(68576);const ea=function(e){const{children:t,isWaitingForEmbeddedServer:r,embeddedServerEntityID:n}=e;return r?a.createElement(le.Z,null,a.createElement(oe.Z,null)):n?a.createElement(Qr.Z,{serverEntityID:n},t(n)):a.createElement(Yr.Z,null)};var ta=Object.defineProperty,ra=Object.prototype.hasOwnProperty,aa=Object.getOwnPropertySymbols,na=Object.prototype.propertyIsEnumerable,oa=(e,t,r)=>t in e?ta(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sa=(e,t)=>{for(var r in t||(t={}))ra.call(t,r)&&oa(e,r,t[r]);if(aa)for(var r of aa(t))na.call(t,r)&&oa(e,r,t[r]);return e};const la=(0,c.P1)(Ae.Z,((e={})=>{const{entityID:t,isProvidersPopulated:r=!1}=e;return{embeddedServerEntityID:t,isProvidersPopulated:r}})),ia={dispatchChangeQuickSearchSettings:Xr.changeQuickSearchSettings};class ca extends a.Component{componentDidMount(){this.props.dispatchChangeQuickSearchSettings({providerEntityID:null,providerIdentifier:null,serverEntityID:null,directoryID:null})}render(){const e=this.props,{isProvidersPopulated:t,dispatchChangeQuickSearchSettings:r}=e,n=((e,t)=>{var r={};for(var a in e)ra.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&aa)for(var a of aa(e))t.indexOf(a)<0&&na.call(e,a)&&(r[a]=e[a]);return r})(e,["isProvidersPopulated","dispatchChangeQuickSearchSettings"]);return a.createElement(ea,sa(sa({},n),{isWaitingForEmbeddedServer:!t}))}}const da=(0,i.$j)(la,ia)(ca);function pa(){const e=(0,o.Z)(),t=(0,a.useMemo)((()=>({context:(0,l.Z)(e.context),type:(0,l.Z)(e.type),subtype:(0,l.Z)(e.subtype),sort:(0,l.Z)(e.sort),save:(0,s.Z)(e.save)})),[e]);return a.createElement(n.Z,{metricsContext:t.context},a.createElement(da,null,(e=>a.createElement(Jr,{serverEntityID:e,params:t,shouldSaveParams:t.save}))))}}}]);