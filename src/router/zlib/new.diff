diff --git a/.codecov.yaml b/.codecov.yaml
index fc17c66a..9b57362f 100644
--- a/.codecov.yaml
+++ b/.codecov.yaml
@@ -1,27 +1,143 @@
 codecov:
-  max_report_age: off
+  max_report_age: false
   notify:
-    wait_for_ci: false
+    wait_for_ci: true
   require_ci_to_pass: false
+
 comment:
   require_base: false
   require_head: false
+
 coverage:
   status:
     project:
       default:
-        threshold: 0.07
+        target: 80%      # Target 80% project coverage
+        threshold: 10    # Allow pass even when project coverage drops by 10% (because of AVX512)
+        paths:
+          - "!test/"     # Don't count coverage of tests towards project coverage
+          - "!tools/"    #               --"--     tools     --"--
+    patch:
+      default:
+        target: auto
+        threshold: 10    # Allow 10% worse coverage of changed code
+
+component_management:
+  default_rules: # Defaults inherited by all components
+    statuses:
+      - type: project
+        target: auto
+        threshold: 0.2   # Most components should have only minimal coverage changes
+  individual_components:
+    - component_id: deflate
+      name: deflate
+      paths:
+        - compare*
+        - compress*
+        - deflate*
+        - insert*
+        - match*
+        - arch/generic/compare*
+        - arch/generic/slide*
+    - component_id: inflate
+      name: inflate
+      paths:
+        - chunkset*
+        - inf*
+        - uncompr*
+        - arch/generic/chunk*
+    - component_id: gzlib
+      name: gzlib
+      paths:
+        - gz*
+    - component_id: adler32
+      name: adler32
+      paths:
+        - adler32*
+        - arch/generic/adler32*
+    - component_id: crc32
+      name: crc32
+      paths:
+        - crc32*
+        - arch/generic/crc32*
+    - component_id: common
+      name: common
+      statuses:
+        - threshold: 2       # CI changes between AVX2 and AVX-512 capable hosts
+      paths:
+        - arch_functions.h
+        - cpu*
+        - fallback*
+        - functable*
+        - trees*
+        - zbuild*
+        - zendian*
+        - zlib*
+        - zmemory*
+        - zutil*
+        - arch/generic/generic_functions.h
+    - component_id: arch_arm
+      name: arch_arm
+      paths:
+        - arch/arm/**
+    - component_id: arch_loongarch
+      name: arch_loongarch
+      paths:
+        - arch/loongarch/**
+    - component_id: arch_power
+      name: arch_power
+      paths:
+        - arch/power/**
+    - component_id: arch_riscv
+      name: arch_riscv
+      paths:
+        - arch/riscv/**
+    - component_id: arch_s390
+      name: arch_s390
+      paths:
+        - arch/s390/**
+    - component_id: arch_x86
+      name: arch_x86
+      statuses:
+        - threshold: 10      # CI changes between AVX2 and AVX-512 capable hosts
+      paths:
+        - arch/x86/**
+    - component_id: minigzip
+      name: minigzip
+      paths:
+        - test/minigzip.c
+    - component_id: minideflate
+      name: minideflate
+      paths:
+        - test/minideflate.c
+    - component_id: tools
+      name: tools
+      paths:
+        - tools/**
+    - component_id: tests
+      name: tests
+      paths:
+        - test/**
+        - "!test/minigzip.c"
+        - "!test/minideflate.c"
+
+github_checks:
+  annotations: false
+
 fixes:
-- '/home/actions-runner/_work/zlib-ng/zlib-ng::'
-- '/home/actions-runner/_work/zlib-ng/zlib-ng/build/::'
+  - '/home/actions-runner/_work/zlib-ng/zlib-ng::'
+  - '/home/actions-runner/_work/zlib-ng/zlib-ng/build/::'
+
 ignore:
-- usr/include/.*
-- /usr/include/.*
-- /build/usr/include/.*
-- usr/lib/.*
-- /usr/lib/.*
-- /build/usr/lib/.*
-- usr/lib64/.*
-- /usr/lib64/.*
-- /build/usr/lib64/.*
-- _deps/**/*
+  - test/benchmarks/**
+  - "**/benchmark_*"
+  - usr/include/.*
+  - /usr/include/.*
+  - /build/usr/include/.*
+  - usr/lib/.*
+  - /usr/lib/.*
+  - /build/usr/lib/.*
+  - usr/lib64/.*
+  - /usr/lib64/.*
+  - /build/usr/lib64/.*
+  - _deps/**
diff --git a/.github/workflows/analyze.yml b/.github/workflows/analyze.yml
index 40315e7d..4928b525 100644
--- a/.github/workflows/analyze.yml
+++ b/.github/workflows/analyze.yml
@@ -5,11 +5,11 @@ concurrency:
   cancel-in-progress: true
 jobs:
   static-analysis:
-    name: GCC
+    name: GCC-14
     runs-on: ubuntu-latest
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
@@ -21,7 +21,7 @@ jobs:
         sudo sed -i 's#http://azure.archive.ubuntu.com/ubuntu/#mirror+file:/etc/apt/mirrors.txt#' /etc/apt/sources.list
 
     - name: Install packages (Ubuntu)
-      run: sudo apt-get install -y gcc-10
+      run: sudo apt-get install -y gcc-14
 
     - name: Generate project files
       run: |
@@ -32,7 +32,7 @@ jobs:
           -DWITH_CODE_COVERAGE=OFF \
           -DWITH_MAINTAINER_WARNINGS=OFF
       env:
-        CC: gcc-10
+        CC: gcc-14
         CFLAGS:
           -fanalyzer
           -Werror
@@ -60,7 +60,7 @@ jobs:
     runs-on: ubuntu-latest
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
diff --git a/.github/workflows/cmake.yml b/.github/workflows/cmake.yml
index 79ee1554..545be209 100644
--- a/.github/workflows/cmake.yml
+++ b/.github/workflows/cmake.yml
@@ -10,30 +10,19 @@ jobs:
   cmake:
     name: ${{ matrix.name }}
     runs-on: ${{ matrix.os }}
-    timeout-minutes: 60
+    timeout-minutes: 80
     strategy:
       fail-fast: false
       matrix:
         include:
-          - name: Ubuntu 20.04 GCC
-            os: ubuntu-20.04
-            compiler: gcc
-            cxx-compiler: g++
-
           - name: Ubuntu GCC ASAN
             os: ubuntu-latest
             compiler: gcc
             cxx-compiler: g++
-            cmake-args: -DWITH_SANITIZER=Address
+            cxxflags: -Wno-maybe-uninitialized
+            cmake-args: -DWITH_SANITIZER=Address -DWITH_BENCHMARKS=ON
             codecov: ubuntu_gcc
 
-          - name: Ubuntu GCC Benchmark
-            os: ubuntu-latest
-            compiler: gcc
-            cxx-compiler: g++
-            cmake-args: -DWITH_BENCHMARKS=ON
-            codecov: ubuntu_gcc_benchmark
-
           - name: Ubuntu GCC Native Instructions
             os: ubuntu-latest
             compiler: gcc
@@ -70,33 +59,56 @@ jobs:
             build-src-dir: ../zlib-ng
             # Build with readonly project directory require CMake 3.19+
             readonly-project-dir: true
-            codecov: ubuntu_gcc_osb
             cflags: -O3
+            # Skipping codecov to allow -O3
 
-          - name: Ubuntu GCC -O3 OSB add_subdirectory
+          - name: Ubuntu GCC OSB add_subdirectory
             os: ubuntu-latest
             compiler: gcc
             cxx-compiler: g++
             build-dir: ../build
             build-src-dir: ../zlib-ng/test/add-subdirectory-project
             readonly-project-dir: true
+            codecov: ubuntu_gcc_osb
 
-          - name: Ubuntu GCC -O1 No Unaligned UBSAN
+          - name: Ubuntu GCC -O1 UBSAN
             os: ubuntu-latest
             compiler: gcc
             cxx-compiler: g++
-            cmake-args: -DWITH_UNALIGNED=OFF -DWITH_SANITIZER=Undefined
-            codecov: ubuntu_gcc_o1
+            cmake-args: -DWITH_SANITIZER=Undefined
             cflags: -O1
+            # Skipping codecov to allow -O1
 
           - name: Ubuntu GCC 32-bit
             os: ubuntu-latest
             compiler: gcc
             cxx-compiler: g++
-            cmake-args: -DCMAKE_C_FLAGS=-m32 -DCMAKE_CXX_FLAGS=-m32 -DCMAKE_SHARED_LINKER_FLAGS=-m32 -DCMAKE_EXE_LINKER_FLAGS=-m32
+            cmake-args: -DCMAKE_C_FLAGS=-m32 -DCMAKE_CXX_FLAGS=-m32 -DCMAKE_SHARED_LINKER_FLAGS=-m32 -DCMAKE_EXE_LINKER_FLAGS=-m32 -DWITH_BENCHMARKS=ON
             packages: gcc-multilib g++-multilib
             codecov: ubuntu_gcc_m32
 
+          - name: Ubuntu GCC C17 MMAP
+            os: ubuntu-latest
+            compiler: gcc
+            cxx-compiler: g++
+            cmake-args: -DCMAKE_C_STANDARD=17
+            cflags: -DUSE_MMAP
+            codecov: ubuntu_gcc_c17_mmap
+
+          - name: Ubuntu GCC C23 REDUCED_MEM
+            os: ubuntu-latest
+            compiler: gcc
+            cxx-compiler: g++
+            cmake-args: -DCMAKE_C_STANDARD=23 -DWITH_REDUCED_MEM=ON
+            codecov: ubuntu_gcc_c23_reduced_mem
+
+          - name: Ubuntu GCC No Chorba
+            os: ubuntu-latest
+            compiler: gcc
+            cxx-compiler: g++
+            cmake-args: -DWITH_CHORBA=OFF
+            codecov: ubuntu_gcc_no_chorba
+
           - name: Ubuntu GCC No CTZLL
             os: ubuntu-latest
             compiler: gcc
@@ -139,387 +151,451 @@ jobs:
             cmake-args: -DWITH_PCLMULQDQ=OFF -DWITH_SANITIZER=Undefined
             codecov: ubuntu_gcc_no_pclmulqdq
 
+          - name: Ubuntu GCC No AVX512VNNI UBSAN
+            os: ubuntu-latest
+            compiler: gcc
+            cxx-compiler: g++
+            cmake-args: -DWITH_AVX512VNNI=OFF -DWITH_SANITIZER=Undefined
+            codecov: ubuntu_gcc_no_avx512vnni
+
           - name: Ubuntu GCC Compat No Opt ASAN
             os: ubuntu-latest
             compiler: gcc
             cxx-compiler: g++
             cmake-args: -DZLIB_COMPAT=ON -DWITH_NEW_STRATEGIES=OFF -DWITH_OPTIM=OFF -DWITH_SANITIZER=Address
-            codecov: ubuntu_gcc_compat_no_opt
             cflags: -DNOT_TWEAK_COMPILER
+            codecov: ubuntu_gcc_compat_no_opt
 
           - name: Ubuntu GCC ARM SF ASAN
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-arm.cmake -DWITH_SANITIZER=Address
             asan-options: detect_leaks=0
-            packages: qemu qemu-user gcc-arm-linux-gnueabi g++-arm-linux-gnueabi libc-dev-armel-cross
+            packages: qemu-user crossbuild-essential-armel
+            gcov-exec: arm-linux-gnueabi-gcov
             codecov: ubuntu_gcc_armsf
 
           - name: Ubuntu GCC ARM SF Compat No Opt UBSAN
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-arm.cmake -DZLIB_COMPAT=ON -DWITH_NEW_STRATEGIES=OFF -DWITH_OPTIM=OFF -DWITH_SANITIZER=Undefined
-            packages: qemu qemu-user gcc-arm-linux-gnueabi g++-arm-linux-gnueabi libc-dev-armel-cross
+            packages: qemu-user crossbuild-essential-armel
+            gcov-exec: arm-linux-gnueabi-gcov
             codecov: ubuntu_gcc_armsf_compat_no_opt
 
           - name: Ubuntu GCC ARM HF ASAN
             os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-armhf.cmake -DWITH_SANITIZER=Address
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-armhf.cmake -DWITH_SANITIZER=Address -DWITH_BENCHMARKS=ON
+            cxxflags: -Wno-psabi -Wno-maybe-uninitialized
             asan-options: detect_leaks=0
-            packages: qemu qemu-user gcc-arm-linux-gnueabihf g++-arm-linux-gnueabihf libc-dev-armel-cross
+            packages: qemu-user crossbuild-essential-armhf
+            gcov-exec: arm-linux-gnueabihf-gcov
             codecov: ubuntu_gcc_armhf
 
-          - name: Ubuntu GCC ARM HF No ACLE ASAN
-            os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-armhf.cmake -DWITH_ACLE=OFF -DWITH_SANITIZER=Address
-            asan-options: detect_leaks=0
-            packages: qemu qemu-user gcc-arm-linux-gnueabihf g++-arm-linux-gnueabihf libc-dev-armel-cross
-            codecov: ubuntu_gcc_armhf_no_acle
-
-          - name: Ubuntu GCC ARM HF No NEON ASAN
+          - name: Ubuntu GCC ARM HF No Neon No ARMv8 ASAN
             os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-armhf.cmake -DWITH_NEON=OFF -DWITH_SANITIZER=Address
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-armhf.cmake -DWITH_NEON=OFF -DWITH_ARMV8=OFF -DWITH_SANITIZER=Address
             asan-options: detect_leaks=0
-            packages: qemu qemu-user gcc-arm-linux-gnueabihf g++-arm-linux-gnueabihf libc-dev-armel-cross
-            codecov: ubuntu_gcc_armhf_no_neon
+            packages: qemu-user crossbuild-essential-armhf
+            gcov-exec: arm-linux-gnueabihf-gcov
+            codecov: ubuntu_gcc_armhf_no_neon_no_armv8
 
           - name: Ubuntu GCC ARM HF Compat No Opt UBSAN
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-armhf.cmake -DZLIB_COMPAT=ON -DWITH_NEW_STRATEGIES=OFF -DWITH_OPTIM=OFF -DWITH_SANITIZER=Undefined
-            packages: qemu qemu-user gcc-arm-linux-gnueabihf g++-arm-linux-gnueabihf libc-dev-armel-cross
+            packages: qemu-user crossbuild-essential-armhf
+            gcov-exec: arm-linux-gnueabihf-gcov
             codecov: ubuntu_gcc_armhf_compat_no_opt
 
           - name: Ubuntu GCC AARCH64 ASAN
-            os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-aarch64.cmake -DWITH_SANITIZER=Address
+            os: ubuntu-22.04
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-aarch64.cmake -DWITH_SANITIZER=Address -DWITH_BENCHMARKS=ON
             asan-options: detect_leaks=0
-            packages: qemu qemu-user gcc-aarch64-linux-gnu g++-aarch64-linux-gnu libc-dev-arm64-cross
+            packages: qemu-user gcc-aarch64-linux-gnu g++-aarch64-linux-gnu libc-dev-arm64-cross
+            gcov-exec: aarch64-linux-gnu-gcov
             codecov: ubuntu_gcc_aarch64
 
-          - name: Ubuntu GCC AARCH64 No ACLE UBSAN
-            os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-aarch64.cmake -DWITH_ACLE=OFF -DWITH_SANITIZER=Undefined
-            packages: qemu qemu-user gcc-aarch64-linux-gnu g++-aarch64-linux-gnu libc-dev-arm64-cross
-            codecov: ubuntu_gcc_aarch64_no_acle
-
-          - name: Ubuntu GCC AARCH64 No NEON UBSAN
-            os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-aarch64.cmake -DWITH_NEON=OFF -DWITH_SANITIZER=Undefined
-            packages: qemu qemu-user gcc-aarch64-linux-gnu g++-aarch64-linux-gnu libc-dev-arm64-cross
-            codecov: ubuntu_gcc_aarch64_no_neon
-
           - name: Ubuntu GCC AARCH64 Compat No Opt UBSAN
-            os: ubuntu-latest
+            os: ubuntu-22.04
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-aarch64.cmake -DZLIB_COMPAT=ON -DWITH_NEW_STRATEGIES=OFF -DWITH_OPTIM=OFF -DWITH_SANITIZER=Undefined
-            packages: qemu qemu-user gcc-aarch64-linux-gnu g++-aarch64-linux-gnu libc-dev-arm64-cross
+            packages: qemu-user gcc-aarch64-linux-gnu g++-aarch64-linux-gnu libc-dev-arm64-cross
+            gcov-exec: aarch64-linux-gnu-gcov
             codecov: ubuntu_gcc_aarch64_compat_no_opt
 
           - name: Ubuntu GCC MIPS
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-mips.cmake
-            packages: qemu qemu-user gcc-mips-linux-gnu g++-mips-linux-gnu libc-dev-mips-cross
+            packages: qemu-user crossbuild-essential-mips
+            gcov-exec: mips-linux-gnu-gcov
             codecov: ubuntu_gcc_mips
 
           - name: Ubuntu GCC MIPS64
             os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-mips64.cmake
-            packages: qemu qemu-user gcc-mips64-linux-gnuabi64 g++-mips64-linux-gnuabi64 libc-dev-mips64-cross
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-mips64.cmake -DWITH_BENCHMARKS=ON
+            packages: qemu-user crossbuild-essential-mips64
+            gcov-exec: mips64-linux-gnuabi64-gcov
             codecov: ubuntu_gcc_mips64
 
           - name: Ubuntu GCC PPC
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc.cmake
-            packages: qemu qemu-user gcc-powerpc-linux-gnu g++-powerpc-linux-gnu libc-dev-powerpc-cross
+            packages: qemu-user crossbuild-essential-powerpc
+            gcov-exec: powerpc-linux-gnu-gcov
             codecov: ubuntu_gcc_ppc
 
           - name: Ubuntu GCC PPC No Power8
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc.cmake -DWITH_POWER8=OFF
-            packages: qemu qemu-user gcc-powerpc-linux-gnu g++-powerpc-linux-gnu libc-dev-powerpc-cross
+            packages: qemu-user crossbuild-essential-powerpc
+            gcov-exec: powerpc-linux-gnu-gcov
             codecov: ubuntu_gcc_ppc_no_power8
 
           - name: Ubuntu GCC PPC64
             os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64.cmake
-            packages: qemu qemu-user gcc-powerpc64-linux-gnu g++-powerpc64-linux-gnu libc-dev-ppc64-cross
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64.cmake -DWITH_BENCHMARKS=ON
+            packages: qemu-user gcc-powerpc64-linux-gnu g++-powerpc64-linux-gnu libc-dev-ppc64-cross
             ldflags: -static
+            gcov-exec: powerpc64-linux-gnu-gcov
             codecov: ubuntu_gcc_ppc64
 
           - name: Ubuntu GCC PPC64 Power9
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64-power9.cmake
-            packages: qemu qemu-user gcc-powerpc64-linux-gnu g++-powerpc64-linux-gnu libc-dev-ppc64-cross
+            packages: qemu-user gcc-powerpc64-linux-gnu g++-powerpc64-linux-gnu libc-dev-ppc64-cross
             ldflags: -static
+            gcov-exec: powerpc64-linux-gnu-gcov
             codecov: ubuntu_gcc_ppc64_power9
 
           - name: Ubuntu Clang PPC64 Power9
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64-clang.cmake
-            packages: qemu qemu-user clang binutils-powerpc64-linux-gnu libc-dev-ppc64-cross libgcc-11-dev-ppc64-cross libstdc++-11-dev-ppc64-cross
+            packages: qemu-user clang binutils-powerpc64-linux-gnu libgcc-11-dev-ppc64-cross libc-dev-ppc64-cross libstdc++-11-dev-ppc64-cross
+            # Codecov disabled for clang on power9, errors
 
           - name: Ubuntu GCC PPC64LE
-            os: ubuntu-20.04
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64le.cmake
-            packages: qemu qemu-user gcc-powerpc64le-linux-gnu g++-powerpc64le-linux-gnu libc-dev-ppc64el-cross
+            os: ubuntu-latest
+            # gtest illegal instruction (related? https://bugs.launchpad.net/qemu/+bug/1781281)
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64le.cmake -DWITH_GTEST=OFF
+            packages: qemu-user crossbuild-essential-ppc64el
+            gcov-exec: powerpc64le-linux-gnu-gcov
+            # mcpu required to test power8 with qemu-ppc64le -cpu power8 (see issue 1378)
+            cflags: -mcpu=power8
+            cxxflags: -mcpu=power8
             codecov: ubuntu_gcc_ppc64le
 
           - name: Ubuntu GCC PPC64LE No VSX
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64le-power9.cmake -DWITH_POWER8=OFF -DWITH_POWER9=OFF
-            packages: qemu qemu-user gcc-powerpc64le-linux-gnu g++-powerpc64le-linux-gnu libc-dev-ppc64el-cross
+            packages: qemu-user crossbuild-essential-ppc64el
+            gcov-exec: powerpc64le-linux-gnu-gcov
             codecov: ubuntu_gcc_ppc64le_novsx
 
           - name: Ubuntu GCC PPC64LE Power9
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64le-power9.cmake
-            packages: qemu qemu-user gcc-powerpc64le-linux-gnu g++-powerpc64le-linux-gnu libc-dev-ppc64el-cross
+            packages: qemu-user crossbuild-essential-ppc64el
+            gcov-exec: powerpc64le-linux-gnu-gcov
             codecov: ubuntu_gcc_ppc64le_power9
 
           - name: Ubuntu Clang PPC64LE Power9
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64le-clang.cmake
-            packages: qemu qemu-user clang binutils-powerpc64le-linux-gnu libc-dev-ppc64el-cross libgcc-11-dev-ppc64el-cross libstdc++-11-dev-ppc64el-cross
+            packages: qemu-user crossbuild-essential-ppc64el
+            # Codecov disabled for clang on power9, errors
+
+          - name: Ubuntu GCC RISC-V
+            os: ubuntu-latest
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-riscv.cmake -DWITH_BENCHMARKS=ON
+            packages: qemu-user crossbuild-essential-riscv64
+            gcov-exec: riscv64-linux-gnu-gcov
+            codecov: ubuntu_gcc_riscv64
+
+          - name: Ubuntu Clang RISC-V
+            os: ubuntu-latest
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-riscv-clang.cmake
+            packages: qemu-user crossbuild-essential-riscv64
+            # Codecov disabled for clang on riscv, errors
+
+          - name: Ubuntu GCC 14 LoongArch64
+            os: ubuntu-latest
+            cmake-args: -DCOMPILER_SUFFIX=-14 -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-loongarch64-gcc.cmake -DWITH_BENCHMARKS=ON
+            packages: qemu-user gcc-14-loongarch64-linux-gnu g++-14-loongarch64-linux-gnu libc-dev-loong64-cross
+            ldflags: -static
+            gcov-exec: loongarch64-linux-gnu-gcov-14
+            codecov: ubuntu_gcc14_loongarch64
+
+          - name: Ubuntu GCC 14 LoongArch64 No LASX
+            os: ubuntu-latest
+            cmake-args: -DCOMPILER_SUFFIX=-14 -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-loongarch64-gcc.cmake -DWITH_BENCHMARKS=ON -DWITH_LASX=OFF
+            packages: qemu-user gcc-14-loongarch64-linux-gnu g++-14-loongarch64-linux-gnu libc-dev-loong64-cross
+            ldflags: -static
+            gcov-exec: loongarch64-linux-gnu-gcov-14
+            codecov: ubuntu_gcc14_loongarch64_no_lasx
 
           - name: Ubuntu GCC SPARC64
-            os: ubuntu-20.04
+            os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-sparc64.cmake
-            packages: qemu qemu-user gcc-sparc64-linux-gnu g++-sparc64-linux-gnu libc-dev-sparc64-cross
+            packages: qemu-user gcc-sparc64-linux-gnu g++-sparc64-linux-gnu libc-dev-sparc64-cross
             ldflags: -static
+            gcov-exec: sparc64-linux-gnu-gcov
             codecov: ubuntu_gcc_sparc64
 
           - name: Ubuntu GCC S390X ASAN
             os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-s390x.cmake -DWITH_SANITIZER=Address
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-s390x.cmake -DWITH_SANITIZER=Address -DWITH_BENCHMARKS=ON
             asan-options: detect_leaks=0
-            packages: qemu qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross
+            packages: qemu-user crossbuild-essential-s390x
             ldflags: -static
+            gcov-exec: s390x-linux-gnu-gcov
             codecov: ubuntu_gcc_s390x
 
           - name: Ubuntu GCC S390X No vectorized CRC32 ASAN
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-s390x.cmake -DWITH_CRC32_VX=OFF -DWITH_SANITIZER=Address
             asan-options: detect_leaks=0
-            packages: qemu qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross
+            packages: qemu-user crossbuild-essential-s390x
             ldflags: -static
+            gcov-exec: s390x-linux-gnu-gcov
             codecov: ubuntu_gcc_s390x_no_crc32
 
-          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL9' || 'Ubuntu' }} GCC S390X DFLTCC ASAN
+          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL10' || 'Ubuntu' }} GCC S390X DFLTCC ASAN
             os: ${{ github.repository == 'zlib-ng/zlib-ng' && 'z15' || 'ubuntu-latest' }}
             compiler: gcc
             cxx-compiler: g++
             cmake-args: >-
               ${{ github.repository != 'zlib-ng/zlib-ng' && '-DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-s390x.cmake' || '' }}
-              -DWITH_DFLTCC_DEFLATE=ON -DWITH_DFLTCC_INFLATE=ON -DWITH_SANITIZER=Address
-            packages: qemu qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross
+              -DWITH_DFLTCC_DEFLATE=ON -DWITH_DFLTCC_INFLATE=ON -DWITH_SANITIZER=Address -DWITH_BENCHMARKS=ON
+            packages: qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross
             asan-options: detect_leaks=0
             ldflags: -static
-            codecov: ${{ github.repository == 'zlib-ng/zlib-ng' && 'el9_gcc_s390x_dfltcc' || 'ubuntu_gcc_s390x_dfltcc' }}
+            gcov-exec: ${{ github.repository == 'zlib-ng/zlib-ng' && 'gcov' || 's390x-linux-gnu-gcov' }}
+            codecov: ${{ github.repository == 'zlib-ng/zlib-ng' && 'el10_gcc_s390x_dfltcc' || 'ubuntu_gcc_s390x_dfltcc' }}
             # The dedicated z15 test VM has 4 cores
             parallels-jobs: 4
 
-          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL9' || 'Ubuntu' }} GCC S390X DFLTCC UBSAN
+          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL10' || 'Ubuntu' }} GCC S390X DFLTCC UBSAN
             os: ${{ github.repository == 'zlib-ng/zlib-ng' && 'z15' || 'ubuntu-latest' }}
             compiler: gcc
             cxx-compiler: g++
             cmake-args: >-
               ${{ github.repository != 'zlib-ng/zlib-ng' && '-DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-s390x.cmake' || '' }}
               -DWITH_DFLTCC_DEFLATE=ON -DWITH_DFLTCC_INFLATE=ON -DWITH_SANITIZER=Undefined
-            packages: qemu qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross
+            packages: qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross
             ldflags: -static
-            codecov: ${{ github.repository == 'zlib-ng/zlib-ng' && 'el9_gcc_s390x_dfltcc' || 'ubuntu_gcc_s390x_dfltcc' }}
+            gcov-exec: ${{ github.repository == 'zlib-ng/zlib-ng' && 'gcov' || 's390x-linux-gnu-gcov' }}
+            codecov: ${{ github.repository == 'zlib-ng/zlib-ng' && 'el10_gcc_s390x_dfltcc' || 'ubuntu_gcc_s390x_dfltcc' }}
             # The dedicated z15 test VM has 4 cores
             parallels-jobs: 4
 
-          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL9' || 'Ubuntu' }} Clang S390X DFLTCC ${{ (github.repository == 'zlib-ng/zlib-ng' && 'MSAN') || 'Compat' }}
+          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL10' || 'Ubuntu' }} Clang S390X DFLTCC ${{ (github.repository == 'zlib-ng/zlib-ng' && 'MSAN') || 'Compat' }}
             os: ${{ github.repository == 'zlib-ng/zlib-ng' && 'z15' || 'ubuntu-latest' }}
-            compiler: ${{ github.repository == 'zlib-ng/zlib-ng' && 'clang' || 'clang-11' }}
-            cxx-compiler: ${{ github.repository == 'zlib-ng/zlib-ng' && 'clang++' || 'clang++-11' }}
+            compiler: clang
+            cxx-compiler: clang++
             cmake-args: >-
-              ${{ github.repository != 'zlib-ng/zlib-ng' && '-DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-s390x.cmake -DZLIB_COMPAT=ON' || '-GNinja -DWITH_SANITIZER=Memory' }}
+              ${{ github.repository == 'zlib-ng/zlib-ng' && '-GNinja -DWITH_SANITIZER=Memory' || '-DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-s390x.cmake -DZLIB_COMPAT=ON' }}
               -DWITH_DFLTCC_DEFLATE=ON -DWITH_DFLTCC_INFLATE=ON
-            packages: qemu qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross
+            packages: qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross
             # The dedicated z15 test VM has 4 cores
             parallels-jobs: 4
+            # codecov disabled, causes MSAN errors
 
           - name: Ubuntu MinGW i686
             os: ubuntu-22.04
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-mingw-i686.cmake
             packages: wine wine32 gcc-mingw-w64-i686 g++-mingw-w64-i686 libpcre2-8-0=10.39-3ubuntu0.1 libpcre2-8-0:i386=10.39-3ubuntu0.1 libodbc1=2.3.9-5ubuntu0.1 libodbc1:i386=2.3.9-5ubuntu0.1 libodbc2=2.3.9-5ubuntu0.1 libodbc2:i386=2.3.9-5ubuntu0.1 libodbccr2=2.3.9-5ubuntu0.1 libodbccr2:i386=2.3.9-5ubuntu0.1 libwine:i386=6.0.3~repack-1 libgphoto2-6:i386=2.5.27-1build2 libsane:i386=1.1.1-5 libgd3=2.3.0-2ubuntu2 libgd3:i386=2.3.0-2ubuntu2 libgcc-s1:i386 libstdc++6:i386
             ldflags: -static
+            gcov-exec: i686-w64-mingw32-gcov-posix
             codecov: ubuntu_gcc_mingw_i686
             # Limit parallel test jobs to prevent wine errors
             parallels-jobs: 1
 
           - name: Ubuntu MinGW x86_64
             os: ubuntu-latest
-            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-mingw-x86_64.cmake
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-mingw-x86_64.cmake -DWITH_BENCHMARKS=ON
             packages: wine wine64 gcc-mingw-w64 g++-mingw-w64
+            cxxflags: -Wno-unused-parameter
             ldflags: -static
+            gcov-exec: x86_64-w64-mingw32-gcov-posix
             codecov: ubuntu_gcc_mingw_x86_64
              # Limit parallel test jobs to prevent wine errors
             parallels-jobs: 1
 
-          - name: Ubuntu 20.04 Clang
-            os: ubuntu-20.04
-            compiler: clang-6.0
-            cxx-compiler: clang++-6.0
-            packages: clang-6.0
+          - name: Ubuntu Clang-15
+            os: ubuntu-latest
+            compiler: clang-15
+            cxx-compiler: clang++-15
+            cmake-args: -DCMAKE_LINKER_TYPE=LLD
+            packages: clang-15 lld
+            gcov-exec: llvm-cov-15 gcov
+            # Codecov disabled for clang-15, errors
+
+          - name: Ubuntu Clang C17 MMAP
+            os: ubuntu-latest
+            compiler: clang
+            cxx-compiler: clang++
+            cmake-args: -DCMAKE_LINKER_TYPE=LLD -DCMAKE_C_STANDARD=17
+            cflags: -DUSE_MMAP
+            packages: llvm-18 lld
+            gcov-exec: llvm-cov-18 gcov
+            codecov: ubuntu_clang_c17_mmap
 
-          - name: Ubuntu Clang
+          - name: Ubuntu Clang-20 C23
             os: ubuntu-latest
-            compiler: clang-11
-            cxx-compiler: clang++-11
-            packages: clang-11 llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
-            codecov: ubuntu_clang
+            compiler: clang-20
+            cxx-compiler: clang++-20
+            cmake-args: -DCMAKE_LINKER_TYPE=LLD -DCMAKE_C_STANDARD=23
+            packages: clang-20 lld
+            # codecov disabled for clang-20, errors
 
           # Check for undefined symbols in the version script for the modern api
-          - name: Ubuntu Clang Undefined Symbols
+          - name: Ubuntu Clang-20 Undefined Symbols
             os: ubuntu-latest
-            compiler: clang-11
-            cxx-compiler: clang++-11
+            compiler: clang-20
+            cxx-compiler: clang++-20
             cmake-args: -DCMAKE_SHARED_LINKER_FLAGS="-fuse-ld=lld -Wl,--no-undefined-version" -DZLIBNG_ENABLE_TESTS=OFF
-            build-shared: ON
-            packages: clang-11 llvm-11 lld
+            build-shared: 'ON'
+            packages: clang-20 lld
+            # codecov disabled, no tests run
 
           # Check for undefined symbols in the version script for the compat api
-          - name: Ubuntu Clang Undefined Symbols Compat
+          - name: Ubuntu Clang-20 Undefined Symbols Compat
             os: ubuntu-latest
-            compiler: clang-11
-            cxx-compiler: clang++-11
+            compiler: clang-20
+            cxx-compiler: clang++-20
             cmake-args: -DCMAKE_SHARED_LINKER_FLAGS="-fuse-ld=lld -Wl,--no-undefined-version" -DZLIBNG_ENABLE_TESTS=OFF -DZLIB_COMPAT=ON
-            build-shared: ON
-            packages: clang-11 llvm-11 lld
+            build-shared: 'ON'
+            packages: clang-20 lld
+            # codecov disabled, no tests run
 
-          - name: Ubuntu Clang Inflate Strict
+          - name: Ubuntu Clang Inflate Strict REDUCED_MEM
             os: ubuntu-latest
-            compiler: clang-11
-            cxx-compiler: clang++-11
-            cmake-args: -DWITH_INFLATE_STRICT=ON
-            packages: clang-11 llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
-            codecov: ubuntu_clang_inflate_strict
+            compiler: clang
+            cxx-compiler: clang++
+            cmake-args: -DWITH_INFLATE_STRICT=ON -DWITH_REDUCED_MEM=ON
+            packages: llvm-18
+            gcov-exec: llvm-cov-18 gcov
+            codecov: ubuntu_clang_inflate_strict_reduced_mem
 
           - name: Ubuntu Clang Inflate Allow Invalid Dist
             os: ubuntu-latest
-            compiler: clang-11
-            cxx-compiler: clang++-11
+            compiler: clang
+            cxx-compiler: clang++
             cmake-args: -DWITH_INFLATE_ALLOW_INVALID_DIST=ON
-            packages: clang-11 llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
+            packages: llvm-18
+            gcov-exec: llvm-cov-18 gcov
             codecov: ubuntu_clang_inflate_allow_invalid_dist
 
-          - name: Ubuntu Clang Reduced Memory
+          - name: Ubuntu Clang Compat Debug
             os: ubuntu-latest
-            compiler: clang-11
-            cxx-compiler: clang++-11
-            cmake-args: -DWITH_REDUCED_MEM=ON
-            packages: clang-11 llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
-            codecov: ubuntu_clang_reduced_mem
-
-          - name: Ubuntu Clang Memory Map
-            os: ubuntu-latest
-            compiler: clang-11
-            cxx-compiler: clang++-11
-            cflags: -DUSE_MMAP
-            packages: clang-11 llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
-            codecov: ubuntu_clang_mmap
-
-          - name: Ubuntu Clang Debug
-            os: ubuntu-latest
-            compiler: clang-11
-            cxx-compiler: clang++-11
-            packages: clang-11 llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
-            codecov: ubuntu_clang_debug
+            compiler: clang
+            cxx-compiler: clang++
+            cmake-args: -DZLIB_COMPAT=ON
+            packages: llvm-18
+            gcov-exec: llvm-cov-18 gcov
             build-config: Debug
+            codecov: ubuntu_clang_compat_debug
 
-          - name: Ubuntu Clang MSAN
+          - name: Ubuntu Clang-20 MSAN
             os: ubuntu-latest
-            compiler: clang-15
-            cxx-compiler: clang++-15
+            compiler: clang-20
+            cxx-compiler: clang++-20
             cmake-args: -GNinja -DWITH_SANITIZER=Memory
-            packages:  ninja-build clang-15 llvm-15-tools
-            gcov-exec: llvm-cov-15 gcov
+            packages: ninja-build clang-20 llvm-20 libclang-rt-20-dev
+            gcov-exec: llvm-cov-20 gcov
             # https://github.com/llvm/llvm-project/issues/55785
             msan-options: use_sigaltstack=0
-
-          - name: Ubuntu Clang RISC-V
-            os: ubuntu-latest
-            cmake-args: -GNinja -DCMAKE_TOOLCHAIN_FILE=./cmake/toolchain-riscv.cmake -DTOOLCHAIN_PATH=${PWD}/prebuilt-riscv-toolchain-qemu/riscv-clang -DQEMU_PATH=${PWD}/prebuilt-riscv-toolchain-qemu/riscv-qemu/bin/qemu-riscv64
-            packages: build-essential cmake ninja-build
+            # codecov disabled for clang-20, errors
 
           - name: Ubuntu Emscripten WASM32
             os: ubuntu-latest
             chost: wasm32
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=${EMSDK}/upstream/emscripten/cmake/Modules/Platform/Emscripten.cmake -DCMAKE_C_COMPILER_TARGET=wasm32 -DCMAKE_CROSSCOMPILING_EMULATOR=${EMSDK_NODE} -DZLIB_COMPAT=ON
+            # codecov disabled for wasm
 
           - name: Windows MSVC 2022 v143 Win32
             os: windows-latest
             compiler: cl
             cmake-args: -G "Visual Studio 17 2022" -A Win32 -T v143
+            # codecov disabled for msvc
 
           - name: Windows MSVC 2022 v143 Win64
             os: windows-latest
             compiler: cl
             cmake-args: -G "Visual Studio 17 2022" -A x64 -T v143
+            # codecov disabled for msvc
 
           - name: Windows MSVC 2022 v143 Win64 Native Instructions (AVX)
             os: windows-latest
             compiler: cl
             cmake-args: -G "Visual Studio 17 2022" -A x64 -T v143 -DWITH_NATIVE_INSTRUCTIONS=ON -DNATIVE_ARCH_OVERRIDE=/arch:AVX
+            # codecov disabled for msvc
+
+          - name: Windows MSVC 2022 v143 Win64 C17
+            os: windows-latest
+            compiler: cl
+            cmake-args: -G "Visual Studio 17 2022" -A x64 -T v143 -DCMAKE_C_STANDARD=17
+            # codecov disabled for msvc
 
           - name: Windows MSVC 2022 v142 Win32
             os: windows-latest
             compiler: cl
             cmake-args: -G "Visual Studio 17 2022" -A Win32 -T v142
+            # codecov disabled for msvc
 
           - name: Windows MSVC 2022 v142 Win64
             os: windows-latest
             compiler: cl
             cmake-args: -G "Visual Studio 17 2022" -A x64 -T v142
+            # codecov disabled for msvc
 
-          - name: Windows MSVC 2019 v141 Win32
-            os: windows-2019
+          - name: Windows MSVC 2022 v141 Win32
+            os: windows-2022
             compiler: cl
-            cmake-args: -G "Visual Studio 16 2019" -A Win32 -T v141
+            cmake-args: -G "Visual Studio 17 2022" -A Win32 -T v141
+            # codecov disabled for msvc
 
-          - name: Windows MSVC 2019 v141 Win64
-            os: windows-2019
+          - name: Windows MSVC 2022 v141 Win64
+            os: windows-2022
             compiler: cl
-            cmake-args: -G "Visual Studio 16 2019" -A x64 -T v141
+            cmake-args: -G "Visual Studio 17 2022" -A x64 -T v141
+            # codecov disabled for msvc
 
-          - name: Windows MSVC 2019 v140 Win32
-            os: windows-2019
+          - name: Windows MSVC 2022 v140 Win32
+            os: windows-2022
             compiler: cl
-            cmake-args: -G "Visual Studio 16 2019" -A Win32 -T v140
+            cmake-args: -G "Visual Studio 17 2022" -A Win32,version=10.0.14393.0 -T v140 -DCMAKE_SYSTEM_VERSION=10.0.14393.0
+            # codecov disabled for msvc
 
-          - name: Windows MSVC 2019 v140 Win64
-            os: windows-2019
+          - name: Windows MSVC 2022 v140 Win64
+            os: windows-2022
             compiler: cl
-            cmake-args: -G "Visual Studio 16 2019" -A x64 -T v140
+            cmake-args: -G "Visual Studio 17 2022" -A x64,version=10.0.14393.0 -T v140 -DCMAKE_SYSTEM_VERSION=10.0.14393.0
+            # codecov disabled for msvc
 
           - name: Windows MSVC ARM No Test
             os: windows-latest
             compiler: cl
-            cmake-args: -A ARM
+            cmake-args: -A ARM,version=10.0.22621.0
+            # codecov disabled for msvc
 
           - name: Windows MSVC ARM64 No Test
             os: windows-latest
             compiler: cl
             cmake-args: -A ARM64
+            # codecov disabled for msvc
 
           - name: Windows ClangCl Win32
             os: windows-latest
             cmake-args: -T ClangCl -A Win32
+            # codecov disabled for clangcl
 
           - name: Windows ClangCl Win64
             os: windows-latest
             cmake-args: -T ClangCl -A x64
+            # codecov disabled for clangcl
 
           - name: Windows ClangCl Win64 Native Instructions (AVX)
             os: windows-latest
             cmake-args: -T ClangCl -A x64 -DWITH_NATIVE_INSTRUCTIONS=ON -DNATIVE_ARCH_OVERRIDE="-mavx -mpclmul"
+            # codecov disabled for clangcl
 
           - name: Windows GCC
             os: windows-latest
@@ -529,10 +605,11 @@ jobs:
             codecov: win64_gcc
 
           - name: Windows GCC Native Instructions (AVX)
-            os: windows-latest
+            os: windows-2022
             compiler: gcc
             cxx-compiler: g++
             cmake-args: -G Ninja  -DWITH_NATIVE_INSTRUCTIONS=ON -DNATIVE_ARCH_OVERRIDE="-mavx -mpclmul"
+            codecov: win64_gcc_native_avx
 
           - name: Windows GCC Compat No Opt
             os: windows-latest
@@ -541,58 +618,71 @@ jobs:
             cmake-args: -G Ninja -DZLIB_COMPAT=ON -DWITH_NEW_STRATEGIES=OFF -DWITH_OPTIM=OFF
             codecov: win64_gcc_compat_no_opt
 
-          - name: macOS Clang ASAN
-            os: macos-13
+          - name: macOS Clang (Intel, Target 10.10)
+            os: macos-15-intel
+            compiler: clang
+            cxx-compiler: clang++
+            cmake-args: -DCMAKE_OSX_DEPLOYMENT_TARGET=10.10 -DWITH_BENCHMARKS=ON
+            ldflags: -ld_classic
+            codecov: macos_clang_intel
+
+          - name: macOS Clang (Intel) ASAN
+            os: macos-15-intel
             compiler: clang
             cxx-compiler: clang++
             cmake-args: -DWITH_SANITIZER=Address
-            codecov: macos_clang
+            codecov: macos_clang_intel_asan
+
+          - name: macOS GCC (Intel) UBSAN
+            os: macos-15-intel
+            compiler: gcc-13
+            cxx-compiler: g++-13
+            cmake-args: -DWITH_SANITIZER=Undefined
+            packages: gcc@13
+            gcov-exec: gcov-13
+            codecov: macos_gcc_intel_ubsan
 
-          - name: macOS Clang ASAN (ARM64)
+          - name: macOS Clang (Intel) Native Instructions
+            os: macos-15-intel
+            compiler: clang
+            cxx-compiler: clang++
+            cmake-args: -DWITH_NATIVE_INSTRUCTIONS=ON
+            codecov: macos_clang_native_intel
+
+          - name: macOS Clang (ARM64) ASAN
             os: macos-latest
             compiler: clang
             cxx-compiler: clang++
             cmake-args: -DWITH_SANITIZER=Address
             codecov: macos_clang_arm64
 
-          - name: macOS GCC UBSAN
-            os: macos-13
-            compiler: gcc-10
-            cxx-compiler: g++-10
-            # Xcode 15 uses a new linker that is not compatible with GCC. Switch to the old linker.
-            # Homebrew gcc@11 and later have a built-in workaround for it.
-            ldflags: -ld_classic
+          - name: macOS GCC (ARM64) UBSAN
+            os: macos-14
+            compiler: gcc-13
+            cxx-compiler: g++-13
             cmake-args: -DWITH_SANITIZER=Undefined
-            packages: gcc@10
-            gcov-exec: gcov-10
-            codecov: macos_gcc
+            packages: gcc@13
+            gcov-exec: gcov-13
+            codecov: macos_gcc_arm64_ubsan
 
-          - name: macOS GCC UBSAN (ARM64)
+          - name: macOS Clang (ARM64) Native Instructions
             os: macos-latest
-            compiler: gcc-11
-            cxx-compiler: g++-11
-            cmake-args: -DWITH_SANITIZER=Undefined
-            packages: gcc@11
-            gcov-exec: gcov-11
-            codecov: macos_gcc_arm64
-
-          - name: macOS Clang Native Instructions (ARM64)
-            os: macos-14
             compiler: clang
             cxx-compiler: clang++
             cmake-args: -DWITH_NATIVE_INSTRUCTIONS=ON
+            codecov: macos_clang_arm64_native
 
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: false
 
     - name: Checkout test corpora
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       # Don't test against all corpora with MinGW due to Wine being unable to run parallel jobs
       # without connection timeout. Without parallel jobs test runs using Wine take close to an hour.
-      if: contains(matrix.name, 'MinGW') == false
+      if: contains(matrix.name, 'MinGW') == false && !contains(matrix.cmake-args, 'WITH_SANITIZER')
       with:
         repository: zlib-ng/corpora
         path: test/data/corpora
@@ -603,7 +693,7 @@ jobs:
       run: sudo dpkg --add-architecture i386
 
     - name: Add ubuntu mirrors
-      if: runner.os == 'Linux' && matrix.packages && !contains(matrix.os, 'z15')
+      if: runner.os == 'Linux' && !contains(matrix.os, 'z15')
       # Github Actions caching proxy is at times unreliable
       run: |
         echo -e 'http://azure.archive.ubuntu.com/ubuntu\tpriority:1\n' | sudo tee /etc/apt/mirrors.txt
@@ -611,18 +701,11 @@ jobs:
         sudo sed -i 's#http://azure.archive.ubuntu.com/ubuntu/#mirror+file:/etc/apt/mirrors.txt#' /etc/apt/sources.list
 
     - name: Install packages (Ubuntu)
-      if: runner.os == 'Linux' && matrix.packages && !contains(matrix.os, 'z15')
+      if: runner.os == 'Linux' && !contains(matrix.os, 'z15')
       run: |
         sudo apt-get update
-        sudo apt-get install -y --allow-downgrades --no-install-recommends ${{ matrix.packages }}
-
-    - name: Download prebuilt RISC-V Clang toolchain & QEMU emulator
-      if: runner.os == 'Linux' && contains(matrix.name, 'RISC-V')
-      run: |
-        gh release download ubuntu20.04_llvm16.0.0_qemu7.0.0 --repo sifive/prepare-riscv-toolchain-qemu
-        tar zxvf prebuilt-riscv-toolchain-qemu.tar.gz
-      env:
-        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
+        sudo apt-get install -y --allow-downgrades --no-install-recommends \
+            ${{ matrix.packages || 'libgtest-dev libbenchmark-dev' }}
 
     - name: Install packages (Windows)
       if: runner.os == 'Windows'
@@ -632,6 +715,49 @@ jobs:
         choco uninstall --no-progress strawberryperl
         choco install --no-progress ninja ${{ matrix.packages }}
 
+    - name: Install Visual Studio toolset v140 (Windows)
+      if: contains(matrix.name, 'v140')
+      run: |
+        # Windows 10 SDK (10.0.14393.795)
+        # https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/index-legacy
+        Invoke-WebRequest -Method Get -Uri https://go.microsoft.com/fwlink/p/?LinkId=838916 -OutFile sdksetup.exe -UseBasicParsing
+        Unblock-File sdksetup.exe
+        Start-Process -Wait sdksetup.exe -ArgumentList "/q", "/norestart", "/ceip off", "/features OptionId.WindowsSoftwareDevelopmentKit"
+
+        Set-Location "C:\Program Files (x86)\Microsoft Visual Studio\Installer\"
+        $InstallPath = "C:\Program Files\Microsoft Visual Studio\2022\Enterprise"
+        $componentsToInstall= @(
+          "Microsoft.VisualStudio.Component.VC.140"
+        )
+        [string]$workloadArgs = $componentsToInstall | ForEach-Object {" --add " +  $_}
+        $Arguments = ('/c', "vs_installer.exe", 'modify', '--installPath', "`"$InstallPath`"",$workloadArgs, '--quiet', '--norestart', '--nocache')
+        # should be run twice
+        $process = Start-Process -FilePath cmd.exe -ArgumentList $Arguments -Wait -PassThru -WindowStyle Hidden
+        $process = Start-Process -FilePath cmd.exe -ArgumentList $Arguments -Wait -PassThru -WindowStyle Hidden
+
+    - name: Install Visual Studio toolset v141 (Windows)
+      if: contains(matrix.name, 'v141')
+      run: |
+        Set-Location "C:\Program Files (x86)\Microsoft Visual Studio\Installer\"
+        $InstallPath = "C:\Program Files\Microsoft Visual Studio\2022\Enterprise"
+        $componentsToInstall= @(
+          "Microsoft.VisualStudio.Component.VC.v141.x86.x64"
+        )
+        [string]$workloadArgs = $componentsToInstall | ForEach-Object {" --add " +  $_}
+        $Arguments = ('/c', "vs_installer.exe", 'modify', '--installPath', "`"$InstallPath`"",$workloadArgs, '--quiet', '--norestart', '--nocache')
+        # should be run twice
+        $process = Start-Process -FilePath cmd.exe -ArgumentList $Arguments -Wait -PassThru -WindowStyle Hidden
+        $process = Start-Process -FilePath cmd.exe -ArgumentList $Arguments -Wait -PassThru -WindowStyle Hidden
+
+    - name: Install Windows 11 SDK (ARM)
+      if: contains(matrix.name, 'MSVC ARM ')
+      run: |
+        # Windows 11 SDK (10.0.22621.2428)
+        # https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/index-legacy
+        Invoke-WebRequest -Method Get -Uri https://go.microsoft.com/fwlink/p/?LinkId=2250105 -OutFile sdksetup.exe -UseBasicParsing
+        Unblock-File sdksetup.exe
+        Start-Process -Wait sdksetup.exe -ArgumentList "/q", "/norestart", "/ceip off"
+
     - name: Install packages (macOS)
       if: runner.os == 'macOS'
       run: brew install ninja ${{ matrix.packages }}
@@ -650,7 +776,7 @@ jobs:
     - name: Compile LLVM C++ libraries (MSAN)
       if: contains(matrix.name, 'MSAN')
       run: |
-        git clone --depth=1 https://github.com/llvm/llvm-project --single-branch --branch llvmorg-16.0.6
+        git clone --depth=1 https://github.com/llvm/llvm-project --single-branch --branch release/20.x
         cmake -S llvm-project/runtimes -B llvm-project/build -G Ninja \
           -DCMAKE_BUILD_TYPE=Release \
           -DLLVM_ENABLE_RUNTIMES="libcxx;libcxxabi" \
@@ -684,6 +810,7 @@ jobs:
         CC: ${{ matrix.compiler }}
         CXX: ${{ matrix.cxx-compiler }}
         CFLAGS: ${{ matrix.cflags }}
+        CXXFLAGS: ${{ matrix.cxxflags }}
         LDFLAGS: ${{ matrix.ldflags }}
         CI: true
 
@@ -693,7 +820,7 @@ jobs:
     - name: Run test cases
       # Don't run tests on Windows ARM
       if: runner.os != 'Windows' || contains(matrix.name, 'ARM') == false
-      run: ctest --verbose -C Release --output-on-failure --max-width 120 -j ${{ matrix.parallels-jobs || '3' }}
+      run: ctest --verbose -C Release -E benchmark_zlib --output-on-failure --max-width 120 -j ${{ matrix.parallels-jobs || '3' }}
       working-directory: ${{ matrix.build-dir || '.' }}
       env:
         ASAN_OPTIONS: ${{ matrix.asan-options || 'verbosity=0' }}:abort_on_error=1:halt_on_error=1
@@ -713,23 +840,36 @@ jobs:
       run: |
         python3 -u -m venv ${{ matrix.build-dir || '.' }}/venv
         source ${{ matrix.build-dir || '.' }}/venv/${{ runner.os == 'Windows' && 'Scripts' || 'bin' }}/activate
-        python3 -u -m pip install gcovr==5.0
-        python3 -m gcovr ${{ matrix.build-dir || '' }} -j 3 --verbose \
+        python3 -u -m pip install gcovr
+        python3 -m gcovr ${{ matrix.build-dir || '' }} -j 3 --gcov-ignore-parse-errors --verbose \
           --exclude-unreachable-branches \
+          --merge-mode-functions separate \
+          --merge-lines \
           --gcov-executable "${{ matrix.gcov-exec || 'gcov' }}" \
           --root ${{ matrix.build-src-dir || '.' }} \
           --xml --output ${{ matrix.codecov }}.xml
 
     - name: Upload coverage report artifact
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: matrix.codecov
       with:
         name: ${{ matrix.name }} (coverage)
         path: ${{ matrix.codecov }}.xml
         retention-days: 1
 
+    - name: Test benchmarks (crashtest only, no coverage data collection)
+      if: contains(matrix.cmake-args, '-DWITH_BENCHMARKS=ON')
+      run: ctest --verbose -C Release -R ^benchmark_zlib$ --output-on-failure --max-width 120 -j ${{ matrix.parallels-jobs || '3' }}
+      working-directory: ${{ matrix.build-dir || '.' }}
+      env:
+        ASAN_OPTIONS: ${{ matrix.asan-options || 'verbosity=0' }}:abort_on_error=1:halt_on_error=1
+        MSAN_OPTIONS: ${{ matrix.msan-options || 'verbosity=0' }}:abort_on_error=1:halt_on_error=1
+        TSAN_OPTIONS: ${{ matrix.tsan-options || 'verbosity=0' }}:abort_on_error=1:halt_on_error=1
+        LSAN_OPTIONS: ${{ matrix.lsan-options || 'verbosity=0' }}:abort_on_error=1:halt_on_error=1
+        UBSAN_OPTIONS: ${{ matrix.ubsan-options || 'verbosity=0' }}:print_stacktrace=1:abort_on_error=1:halt_on_error=1
+
     - name: Upload build errors
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: failure()
       with:
         name: ${{ matrix.name }} (cmake)
@@ -747,12 +887,12 @@ jobs:
     if: cancelled() == false
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: false
 
     - name: Download all reports
-      uses: actions/download-artifact@v4
+      uses: actions/download-artifact@v7
       with:
         merge-multiple: true
 
@@ -762,7 +902,7 @@ jobs:
         echo "CODECOV_REPORTS=`ls -p *.xml | grep -v / | tr '\n' ',' | sed 's/,$//g'`" >> $GITHUB_ENV
 
     - name: Upload reports
-      uses: codecov/codecov-action@v4
+      uses: codecov/codecov-action@v5
       if: (env.CODECOV_TOKEN != '' || github.repository == 'zlib-ng/zlib-ng')
       with:
         files: ${{ env.CODECOV_REPORTS }}
diff --git a/.github/workflows/codeql.yml b/.github/workflows/codeql.yml
index 015506de..c4ca77f7 100644
--- a/.github/workflows/codeql.yml
+++ b/.github/workflows/codeql.yml
@@ -25,20 +25,20 @@ jobs:
 
     steps:
       - name: Checkout
-        uses: actions/checkout@v4
+        uses: actions/checkout@v6
         with:
           show-progress: 'false'
 
       - name: Initialize CodeQL
-        uses: github/codeql-action/init@v3
+        uses: github/codeql-action/init@v4
         with:
           languages: ${{ matrix.language }}
           queries: +security-and-quality
 
       - name: Autobuild
-        uses: github/codeql-action/autobuild@v3
+        uses: github/codeql-action/autobuild@v4
 
       - name: Perform CodeQL Analysis
-        uses: github/codeql-action/analyze@v3
+        uses: github/codeql-action/analyze@v4
         with:
           category: "/language:${{ matrix.language }}"
diff --git a/.github/workflows/configure.yml b/.github/workflows/configure.yml
index 02ed761c..ec776111 100644
--- a/.github/workflows/configure.yml
+++ b/.github/workflows/configure.yml
@@ -16,129 +16,108 @@ jobs:
             compiler: gcc
             configure-args: --warn
 
-          - name: Ubuntu 20.04 GCC
-            os: ubuntu-20.04
-            compiler: gcc
-            configure-args: --warn
-
-          - name: Ubuntu GCC OSB
+          - name: Ubuntu GCC OSB Symbol Prefix No VPCLMUL
             os: ubuntu-latest
             compiler: gcc
-            configure-args: --warn
+            configure-args: --warn --sprefix=zTest_ --without-vpclmulqdq
             build-dir: ../build
             build-src-dir: ../zlib-ng
 
-          - name: Ubuntu GCC Compat No Opt
+          - name: Ubuntu GCC Compat No Opt Reduced Mem
             os: ubuntu-latest
             compiler: gcc
-            configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies
+            configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies --with-reduced-mem
+
+          - name: Ubuntu GCC Compat Symbol Prefix
+            os: ubuntu-latest
+            compiler: gcc
+            configure-args: --warn --zlib-compat --sprefix=zTest_
 
           - name: Ubuntu GCC ARM SF
             os: ubuntu-latest
             compiler: arm-linux-gnueabi-gcc
             configure-args: --warn
             chost: arm-linux-gnueabi
-            packages: qemu qemu-user gcc-arm-linux-gnueabi libc-dev-armel-cross
+            packages: qemu-user gcc-arm-linux-gnueabi libc-dev-armel-cross
 
-          - name: Ubuntu GCC ARM SF Compat No Opt
+          - name: Ubuntu GCC ARM SF Compat No Opt No Gzfileops
             os: ubuntu-latest
             compiler: arm-linux-gnueabi-gcc
-            configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies
+            configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies --without-gzfileops
             chost: arm-linux-gnueabi
-            packages: qemu qemu-user gcc-arm-linux-gnueabi libc-dev-armel-cross
+            packages: qemu-user gcc-arm-linux-gnueabi libc-dev-armel-cross
 
           - name: Ubuntu GCC ARM HF
             os: ubuntu-latest
             compiler: arm-linux-gnueabihf-gcc
             configure-args: --warn
             chost: arm-linux-gnueabihf
-            packages: qemu qemu-user gcc-arm-linux-gnueabihf libc-dev-armel-cross
-
-          - name: Ubuntu GCC ARM HF No ACLE
-            os: ubuntu-latest
-            compiler: arm-linux-gnueabihf-gcc
-            configure-args: --warn --without-acle
-            chost: arm-linux-gnueabihf
-            packages: qemu qemu-user gcc-arm-linux-gnueabihf libc-dev-armel-cross
+            packages: qemu-user gcc-arm-linux-gnueabihf libc-dev-armel-cross
 
-          - name: Ubuntu GCC ARM HF No NEON
+          - name: Ubuntu GCC ARM HF No Neon No ARMv8
             os: ubuntu-latest
             compiler: arm-linux-gnueabihf-gcc
-            configure-args: --warn --without-neon
+            configure-args: --warn --without-neon --without-armv8
             chost: arm-linux-gnueabihf
-            packages: qemu qemu-user gcc-arm-linux-gnueabihf libc-dev-armel-cross
+            packages: qemu-user gcc-arm-linux-gnueabihf libc-dev-armel-cross
 
           - name: Ubuntu GCC ARM HF Compat No Opt
             os: ubuntu-latest
             compiler: arm-linux-gnueabihf-gcc
             configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies
             chost: arm-linux-gnueabihf
-            packages: qemu qemu-user gcc-arm-linux-gnueabihf libc-dev-armel-cross
+            packages: qemu-user gcc-arm-linux-gnueabihf libc-dev-armel-cross
 
           - name: Ubuntu GCC AARCH64
             os: ubuntu-latest
             compiler: aarch64-linux-gnu-gcc
             configure-args: --warn
             chost: aarch64-linux-gnu
-            packages: qemu qemu-user gcc-aarch64-linux-gnu libc-dev-arm64-cross
-
-          - name: Ubuntu GCC AARCH64 No ACLE
-            os: ubuntu-latest
-            compiler: aarch64-linux-gnu-gcc
-            configure-args: --warn --without-acle
-            chost: aarch64-linux-gnu
-            packages: qemu qemu-user gcc-aarch64-linux-gnu libc-dev-arm64-cross
-
-          - name: Ubuntu GCC AARCH64 No NEON
-            os: ubuntu-latest
-            compiler: aarch64-linux-gnu-gcc
-            configure-args: --warn --without-neon
-            chost: aarch64-linux-gnu
-            packages: qemu qemu-user gcc-aarch64-linux-gnu libc-dev-arm64-cross
+            packages: qemu-user gcc-aarch64-linux-gnu libc-dev-arm64-cross
 
           - name: Ubuntu GCC AARCH64 Compat No Opt
             os: ubuntu-latest
             compiler: aarch64-linux-gnu-gcc
             configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies
             chost: aarch64-linux-gnu
-            packages: qemu qemu-user gcc-aarch64-linux-gnu libc-dev-arm64-cross
+            packages: qemu-user gcc-aarch64-linux-gnu libc-dev-arm64-cross
 
           - name: Ubuntu GCC MIPS
             os: ubuntu-latest
             compiler: mips-linux-gnu-gcc
             configure-args: --warn
             chost: mips-linux-gnu
-            packages: qemu qemu-user gcc-mips-linux-gnu libc-dev-mips-cross
+            packages: qemu-user gcc-mips-linux-gnu libc-dev-mips-cross
 
           - name: Ubuntu GCC MIPS64
             os: ubuntu-latest
             compiler: mips64-linux-gnuabi64-gcc
             configure-args: --warn
             chost: mips64-linux-gnuabi64
-            packages: qemu qemu-user gcc-mips64-linux-gnuabi64 libc-dev-mips64-cross
+            packages: qemu-user gcc-mips64-linux-gnuabi64 libc-dev-mips64-cross
 
           - name: Ubuntu GCC PPC
             os: ubuntu-latest
             compiler: powerpc-linux-gnu-gcc
             configure-args: --warn --static
             chost: powerpc-linux-gnu
-            packages: qemu qemu-user gcc-powerpc-linux-gnu libc-dev-powerpc-cross
+            packages: qemu-user gcc-powerpc-linux-gnu libc-dev-powerpc-cross
             cflags: -static
             ldflags: -static
 
-          - name: Ubuntu GCC PPC No Power8
+          - name: Ubuntu GCC PPC No Opt
             os: ubuntu-latest
             compiler: powerpc-linux-gnu-gcc
-            configure-args: --warn --without-power8
+            configure-args: --warn --without-optimizations
             chost: powerpc-linux-gnu
-            packages: qemu qemu-user gcc-powerpc-linux-gnu libc-dev-powerpc-cross
+            packages: qemu-user gcc-powerpc-linux-gnu libc-dev-powerpc-cross
 
           - name: Ubuntu GCC PPC64
             os: ubuntu-latest
             compiler: powerpc64-linux-gnu-gcc
             configure-args: --warn --static
             chost: powerpc-linux-gnu
-            packages: qemu qemu-user gcc-powerpc64-linux-gnu libc-dev-ppc64-cross
+            packages: qemu-user gcc-powerpc64-linux-gnu libc-dev-ppc64-cross
             cflags: -static
             ldflags: -static
 
@@ -147,14 +126,14 @@ jobs:
             compiler: powerpc64le-linux-gnu-gcc
             configure-args: --warn
             chost: powerpc64le-linux-gnu
-            packages: qemu qemu-user gcc-powerpc64le-linux-gnu libc-dev-ppc64el-cross
+            packages: qemu-user gcc-powerpc64le-linux-gnu libc-dev-ppc64el-cross
 
           - name: Ubuntu GCC S390X
             os: ubuntu-latest
             compiler: s390x-linux-gnu-gcc
             configure-args: --warn --static
             chost: s390x-linux-gnu
-            packages: qemu qemu-user gcc-s390x-linux-gnu libc-dev-s390x-cross
+            packages: qemu-user gcc-s390x-linux-gnu libc-dev-s390x-cross
             cflags: -static
             ldflags: -static
 
@@ -163,25 +142,25 @@ jobs:
             compiler: s390x-linux-gnu-gcc
             configure-args: --warn --static --without-crc32-vx
             chost: s390x-linux-gnu
-            packages: qemu qemu-user gcc-s390x-linux-gnu libc-dev-s390x-cross
+            packages: qemu-user gcc-s390x-linux-gnu libc-dev-s390x-cross
             cflags: -static
             ldflags: -static
 
-          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL9' || 'Ubuntu' }} GCC S390X DFLTCC
+          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL10' || 'Ubuntu' }} GCC S390X DFLTCC
             os: ${{ github.repository == 'zlib-ng/zlib-ng' && 'z15' || 'ubuntu-latest' }}
             compiler: ${{ github.repository == 'zlib-ng/zlib-ng' && 'gcc' || 's390x-linux-gnu-gcc' }}
             configure-args: --warn --static --with-dfltcc-deflate --with-dfltcc-inflate
             chost: ${{ github.repository != 'zlib-ng/zlib-ng' &&  's390x-linux-gnu' || '' }}
-            packages: ${{ github.repository != 'zlib-ng/zlib-ng' && 'qemu qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross' || '' }}
+            packages: ${{ github.repository != 'zlib-ng/zlib-ng' && 'qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross' || '' }}
             cflags: ${{ github.repository != 'zlib-ng/zlib-ng' && '-static' || '' }}
             ldflags: ${{ github.repository != 'zlib-ng/zlib-ng' && '-static' || '' }}
 
-          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL9' || 'Ubuntu' }} GCC S390X DFLTCC Compat
+          - name: ${{ github.repository == 'zlib-ng/zlib-ng' && 'EL10' || 'Ubuntu' }} GCC S390X DFLTCC Compat
             os: ${{ github.repository == 'zlib-ng/zlib-ng' && 'z15' || 'ubuntu-latest' }}
             compiler: ${{ github.repository == 'zlib-ng/zlib-ng' && 'gcc' || 's390x-linux-gnu-gcc' }}
             configure-args: --warn --zlib-compat --static --with-dfltcc-deflate --with-dfltcc-inflate
             chost: ${{ github.repository != 'zlib-ng/zlib-ng' &&  's390x-linux-gnu' || '' }}
-            packages: ${{ github.repository != 'zlib-ng/zlib-ng' && 'qemu qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross' || '' }}
+            packages: ${{ github.repository != 'zlib-ng/zlib-ng' && 'qemu-user gcc-s390x-linux-gnu g++-s390x-linux-gnu libc-dev-s390x-cross' || '' }}
             cflags: ${{ github.repository != 'zlib-ng/zlib-ng' && '-static' || '' }}
             ldflags: ${{ github.repository != 'zlib-ng/zlib-ng' && '-static' || '' }}
 
@@ -194,48 +173,74 @@ jobs:
             ldflags: -static
             emu-run: node
 
-          - name: macOS GCC Symbol Prefix
-            os: macos-13
-            compiler: gcc-11
-            configure-args: --sprefix=zTest_
-            packages: gcc@11
-
-          - name: macOS GCC Symbol Prefix (ARM64)
-            os: macos-latest
+          - name: macOS GCC (Intel)
+            os: macos-15-intel
             compiler: gcc-11
-            cflags: -std=gnu11
-            configure-args: --sprefix=zTest_
+            configure-args: --warn
             packages: gcc@11
 
-          - name: macOS GCC Symbol Prefix & Compat
-            os: macos-13
+          - name: macOS GCC (Intel) Compat No Opt
+            os: macos-15-intel
             compiler: gcc-11
-            configure-args: --zlib-compat --sprefix=zTest_
+            configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies
             packages: gcc@11
 
-          - name: macOS GCC Symbol Prefix & Compat (ARM64)
+          - name: macOS GCC (ARM64)
             os: macos-latest
             compiler: gcc-11
             cflags: -std=gnu11
-            configure-args: --zlib-compat --sprefix=zTest_
-            packages: gcc@11
-
-          - name: macOS GCC
-            os: macos-13
-            compiler: gcc-11
             configure-args: --warn
             packages: gcc@11
 
-          - name: macOS GCC (ARM64)
+          - name: macOS GCC (ARM64) Compat No Opt
             os: macos-latest
             compiler: gcc-11
             cflags: -std=gnu11
-            configure-args: --warn
+            configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies
             packages: gcc@11
 
+          - name: Ubuntu GCC RISCV64
+            os: ubuntu-latest
+            compiler: riscv64-linux-gnu-gcc
+            configure-args: --warn
+            chost: riscv64-linux-gnu
+            packages: qemu-user crossbuild-essential-riscv64
+
+          - name: Ubuntu GCC RISCV64 No RVV No ZBC
+            os: ubuntu-latest
+            compiler: riscv64-linux-gnu-gcc
+            configure-args: --warn --without-rvv --without-zbc
+            chost: riscv64-linux-gnu
+            packages: qemu-user crossbuild-essential-riscv64
+
+          - name: Ubuntu GCC RISCV64 Compat No Opt
+            os: ubuntu-latest
+            compiler: riscv64-linux-gnu-gcc
+            configure-args: --warn --zlib-compat --without-optimizations --without-new-strategies
+            chost: riscv64-linux-gnu
+            packages: qemu-user crossbuild-essential-riscv64
+
+          - name: Ubuntu GCC 14 LoongArch64
+            os: ubuntu-latest
+            compiler: loongarch64-linux-gnu-gcc-14
+            configure-args: --warn --static
+            chost: loongarch64-linux-gnu
+            packages: qemu-user gcc-14-loongarch64-linux-gnu g++-14-loongarch64-linux-gnu libc-dev-loong64-cross
+            cflags: -static
+            ldflags: -static
+
+          - name: Ubuntu GCC 14 LoongArch64 Compat No Opt
+            os: ubuntu-latest
+            compiler: loongarch64-linux-gnu-gcc-14
+            configure-args: --warn --static --zlib-compat --without-optimizations --without-new-strategies
+            chost: loongarch64-linux-gnu
+            packages: qemu-user gcc-14-loongarch64-linux-gnu g++-14-loongarch64-linux-gnu libc-dev-loong64-cross
+            cflags: -static
+            ldflags: -static
+
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
@@ -285,11 +290,11 @@ jobs:
       working-directory: ${{ matrix.build-dir }}
 
     - name: Upload build errors
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: failure()
       with:
         name: ${{ matrix.name }} (configure)
         path: |
           **/Makefile
-          ${{ matrix.build-dir || '.' }}/configure.log
+          **/configure.log
         retention-days: 30
diff --git a/.github/workflows/fuzz.yml b/.github/workflows/fuzz.yml
index 376d988b..03d94b34 100644
--- a/.github/workflows/fuzz.yml
+++ b/.github/workflows/fuzz.yml
@@ -31,7 +31,7 @@ jobs:
         dry-run: false
 
     - name: Upload Crash
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: failure()
       with:
         name: artifacts
diff --git a/.github/workflows/libpng.yml b/.github/workflows/libpng.yml
index a1593942..3e4eb4c7 100644
--- a/.github/workflows/libpng.yml
+++ b/.github/workflows/libpng.yml
@@ -9,7 +9,7 @@ jobs:
     runs-on: ubuntu-latest
     steps:
     - name: Checkout repository (zlib-ng)
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
@@ -29,7 +29,7 @@ jobs:
       run: cmake --build . -j2 --config Release
 
     - name: Checkout repository (libpng)
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         repository: glennrp/libpng
         path: libpng
diff --git a/.github/workflows/link.yml b/.github/workflows/link.yml
index 510e6947..bb4b2f5c 100644
--- a/.github/workflows/link.yml
+++ b/.github/workflows/link.yml
@@ -9,12 +9,12 @@ jobs:
     runs-on: ubuntu-latest
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
     - name: Checkout zlib repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
         repository: madler/zlib
@@ -33,7 +33,7 @@ jobs:
       run: cmake --build native -j2 --config Release
 
     - name: Upload build errors
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: failure()
       with:
         name: Link zlib (CMake Logs)
@@ -47,7 +47,7 @@ jobs:
     runs-on: ubuntu-latest
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
@@ -64,7 +64,7 @@ jobs:
       run: cmake --build native -j2 --config Release
 
     - name: Upload build errors
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: failure()
       with:
         name: Link zlib-ng compat (CMake Logs)
diff --git a/.github/workflows/lint.yml b/.github/workflows/lint.yml
index ecfd6471..326a8797 100644
--- a/.github/workflows/lint.yml
+++ b/.github/workflows/lint.yml
@@ -7,7 +7,7 @@ jobs:
     runs-on: ubuntu-latest
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         fetch-depth: 0
 
diff --git a/.github/workflows/nmake.yml b/.github/workflows/nmake.yml
deleted file mode 100644
index 48689fff..00000000
--- a/.github/workflows/nmake.yml
+++ /dev/null
@@ -1,73 +0,0 @@
-name: NMake
-on: [push, pull_request]
-concurrency:
-  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
-  cancel-in-progress: true
-jobs:
-  nmake:
-    name: ${{ matrix.name }}
-    runs-on: ${{ matrix.os }}
-    strategy:
-      fail-fast: false
-      matrix:
-        include:
-          - name: Windows NMake x86
-            os: windows-2022
-            makefile: win32/Makefile.msc
-            arch: x86
-
-          - name: Windows NMake x64 compat
-            os: windows-2022
-            makefile: win32/Makefile.msc
-            arch: x86_amd64
-            additional-args: ZLIB_COMPAT=yes
-
-          - name: Windows NMake x64 Symbol Prefix
-            os: windows-2022
-            makefile: win32/Makefile.msc
-            arch: x86_amd64
-            additional-args: SYMBOL_PREFIX=zTest_
-
-          - name: Windows NMake x64 Symbol Prefix Compat
-            os: windows-2022
-            makefile: win32/Makefile.msc
-            arch: x86_amd64
-            additional-args: ZLIB_COMPAT=yes SYMBOL_PREFIX=zTest_
-
-          - name: Windows NMake x64
-            os: windows-2022
-            makefile: win32/Makefile.msc
-            arch: x86_amd64
-
-          - name: Windows NMake ARM No Test
-            os: windows-2022
-            makefile: win32/Makefile.arm
-            arch: x86_arm
-
-          - name: Windows NMake ARM64 No Test
-            os: windows-2022
-            makefile: win32/Makefile.a64
-            arch: x86_arm64
-
-    steps:
-    - name: Checkout repository
-      uses: actions/checkout@v4
-      with:
-        show-progress: 'false'
-
-    - name: Setup development environment
-      uses: ilammy/msvc-dev-cmd@v1.13.0
-      with:
-        arch: ${{ matrix.arch }}
-
-    - name: Compile source code
-      shell: cmd
-      run: nmake -f ${{ matrix.makefile }} ${{ matrix.additional-args }}
-
-    - name: Run test cases
-      shell: cmd
-      # Don't run tests on Windows ARM
-      if: contains(matrix.arch, 'arm') == false
-      run: |
-        nmake -f ${{ matrix.makefile }} ${{ matrix.additional-args }} test
-        nmake -f ${{ matrix.makefile }} ${{ matrix.additional-args }} testdll
diff --git a/.github/workflows/pigz.yml b/.github/workflows/pigz.yml
index ac2deffb..3df8e51c 100644
--- a/.github/workflows/pigz.yml
+++ b/.github/workflows/pigz.yml
@@ -25,15 +25,15 @@ jobs:
           - name: Ubuntu Clang
             os: ubuntu-latest
             compiler: clang
-            packages: llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
+            packages: llvm-15 llvm-15-tools
+            gcov-exec: llvm-cov-15 gcov
             codecov: ubuntu_clang_pigz
 
           - name: Ubuntu Clang No Optim
             os: ubuntu-latest
             compiler: clang
-            packages: llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
+            packages: llvm-15 llvm-15-tools
+            gcov-exec: llvm-cov-15 gcov
             codecov: ubuntu_clang_pigz_no_optim
             cmake-args: -DWITH_OPTIM=OFF
 
@@ -41,25 +41,25 @@ jobs:
           - name: Ubuntu Clang No Threads
             os: ubuntu-latest
             compiler: clang
-            packages: llvm-11 llvm-11-tools
-            gcov-exec: llvm-cov-11 gcov
+            packages: llvm-15 llvm-15-tools
+            gcov-exec: llvm-cov-15 gcov
             codecov: ubuntu_clang_pigz_no_threads
             cmake-args: -DWITH_THREADS=OFF -DPIGZ_VERSION=v2.6
 
           - name: Ubuntu GCC AARCH64
             os: ubuntu-latest
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=../../cmake/toolchain-aarch64.cmake
-            packages: qemu qemu-user gcc-aarch64-linux-gnu libc-dev-arm64-cross
+            packages: qemu-user gcc-aarch64-linux-gnu libc-dev-arm64-cross
             codecov: ubuntu_gcc_pigz_aarch64
 
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
     - name: Checkout test corpora
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         repository: zlib-ng/corpora
         path: test/data/corpora
@@ -105,15 +105,17 @@ jobs:
     - name: Generate coverage report
       if: matrix.codecov
       run: |
-        python3 -u -m pip install --user gcovr==5.0
-        python3 -m gcovr -j 3 --verbose \
+        python3 -u -m pip install gcovr
+        python3 -m gcovr -j 3 --gcov-ignore-parse-errors --verbose \
           --exclude-unreachable-branches \
+          --merge-mode-functions separate \
+          --merge-lines \
           --gcov-executable "${{ matrix.gcov-exec || 'gcov' }}" \
           --root . \
           --xml --output ${{ matrix.codecov }}.xml
 
     - name: Upload coverage report artifact
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: matrix.codecov
       with:
         name: ${{ matrix.name }} (coverage)
@@ -121,7 +123,7 @@ jobs:
         retention-days: 1
 
     - name: Upload build errors
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: failure()
       with:
         name: ${{ matrix.name }} (cmake)
@@ -139,12 +141,12 @@ jobs:
     if: cancelled() == false
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: false
 
     - name: Download all reports
-      uses: actions/download-artifact@v4
+      uses: actions/download-artifact@v7
       with:
         merge-multiple: true
 
@@ -154,7 +156,7 @@ jobs:
         echo "CODECOV_REPORTS=`ls -p *.xml | grep -v / | tr '\n' ',' | sed 's/,$//g'`" >> $GITHUB_ENV
 
     - name: Upload reports
-      uses: codecov/codecov-action@v4
+      uses: codecov/codecov-action@v5
       if: (env.CODECOV_TOKEN != '' || github.repository == 'zlib-ng/zlib-ng')
       with:
         files: ${{ env.CODECOV_REPORTS }}
diff --git a/.github/workflows/pkgcheck.yml b/.github/workflows/pkgcheck.yml
index 2d2692f2..3399a10b 100644
--- a/.github/workflows/pkgcheck.yml
+++ b/.github/workflows/pkgcheck.yml
@@ -32,7 +32,7 @@ jobs:
             compiler: arm-linux-gnueabihf-gcc
             cxx-compiler: arm-linux-gnueabihf-g++
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-armhf.cmake
-            packages: qemu gcc-arm-linux-gnueabihf g++-arm-linux-gnueabihf libc6-dev-armhf-cross
+            packages: qemu-user gcc-arm-linux-gnueabihf g++-arm-linux-gnueabihf libc6-dev-armhf-cross
 
           - name: Ubuntu GCC AARCH64
             os: ubuntu-latest
@@ -40,7 +40,7 @@ jobs:
             compiler: aarch64-linux-gnu-gcc
             cxx-compiler: aarch64-linux-gnu-g++
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-aarch64.cmake
-            packages: qemu gcc-aarch64-linux-gnu g++-aarch64-linux-gnu libc6-dev-arm64-cross
+            packages: qemu-user gcc-aarch64-linux-gnu g++-aarch64-linux-gnu libc6-dev-arm64-cross
 
           - name: Ubuntu GCC MIPS
             os: ubuntu-latest
@@ -48,7 +48,7 @@ jobs:
             compiler: mips-linux-gnu-gcc
             cxx-compiler: mips-linux-gnu-g++
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-mips.cmake
-            packages: qemu gcc-mips-linux-gnu g++-mips-linux-gnu libc6-dev-mips-cross
+            packages: qemu-user gcc-mips-linux-gnu g++-mips-linux-gnu libc6-dev-mips-cross
 
           - name: Ubuntu GCC MIPS64
             os: ubuntu-latest
@@ -56,7 +56,7 @@ jobs:
             compiler: mips64-linux-gnuabi64-gcc
             cxx-compiler: mips64-linux-gnuabi64-g++
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-mips64.cmake
-            packages: qemu gcc-mips64-linux-gnuabi64 g++-mips64-linux-gnuabi64 libc6-dev-mips64-cross
+            packages: qemu-user gcc-mips64-linux-gnuabi64 g++-mips64-linux-gnuabi64 libc6-dev-mips64-cross
 
           - name: Ubuntu GCC PPC
             os: ubuntu-latest
@@ -64,7 +64,7 @@ jobs:
             compiler: powerpc-linux-gnu-gcc
             cxx-compiler: powerpc-linux-gnu-g++
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc.cmake
-            packages: qemu gcc-powerpc-linux-gnu g++-powerpc-linux-gnu libc6-dev-powerpc-cross
+            packages: qemu-user gcc-powerpc-linux-gnu g++-powerpc-linux-gnu libc6-dev-powerpc-cross
 
           - name: Ubuntu GCC PPC64LE
             os: ubuntu-latest
@@ -72,15 +72,23 @@ jobs:
             compiler: powerpc64le-linux-gnu-gcc
             cxx-compiler: powerpc64le-linux-gnu-g++
             cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-powerpc64le.cmake
-            packages: qemu gcc-powerpc64le-linux-gnu g++-powerpc64le-linux-gnu libc6-dev-ppc64el-cross
+            packages: qemu-user gcc-powerpc64le-linux-gnu g++-powerpc64le-linux-gnu libc6-dev-ppc64el-cross
+
+          - name: Ubuntu GCC RISC-V
+            os: ubuntu-latest
+            chost: riscv64-linux-gnu
+            compiler: riscv64-linux-gnu-gcc
+            cxx-compiler: riscv64-linux-gnu-g++
+            cmake-args: -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-riscv.cmake
+            packages: qemu-user gcc-riscv64-linux-gnu g++-riscv64-linux-gnu libc6-dev-riscv64-cross
 
           - name: macOS Clang
-            os: macOS-11
+            os: macOS-latest
             compiler: clang
             cxx-compiler: clang++
 
           - name: macOS Clang Symbol Prefix
-            os: macOS-11
+            os: macOS-latest
             compiler: clang
             cxx-compiler: clang++
             cmake-args: -DZLIB_SYMBOL_PREFIX=zTest_
@@ -88,7 +96,7 @@ jobs:
 
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
@@ -116,13 +124,10 @@ jobs:
         HOMEBREW_NO_INSTALL_CLEANUP: 1
 
     - name: Select Xcode version (macOS)
-      # Use a version of Xcode that supports ZERO_AR_DATE until CMake supports
-      # AppleClang linking with libtool using -D argument
-      # https://gitlab.kitware.com/cmake/cmake/-/issues/19852
       if: runner.os == 'macOS'
       uses: maxim-lobanov/setup-xcode@v1
       with:
-        xcode-version: '11.7.0'
+        xcode-version: '16.4'
 
     - name: Compare builds
       run: sh test/pkgcheck.sh
@@ -132,7 +137,7 @@ jobs:
         CFLAGS: ${{ matrix.cflags }}
         CXXFLAGS: ${{ matrix.cxxflags }}
         CHOST: ${{ matrix.chost }}
-        CMAKE_ARGS: ${{ matrix.cmake-args }}
+        CMAKE_ARGS: ${{ matrix.cmake-args }} -DWITH_ALL_FALLBACKS=ON
         CONFIGURE_ARGS: ${{ matrix.configure-args }}
         LDFLAGS: ${{ matrix.ldflags }}
 
@@ -142,7 +147,7 @@ jobs:
         CC: ${{ matrix.compiler }}
         CFLAGS: ${{ matrix.cflags }}
         CHOST: ${{ matrix.chost }}
-        CMAKE_ARGS: ${{ matrix.cmake-args }}
+        CMAKE_ARGS: ${{ matrix.cmake-args }} -DWITH_ALL_FALLBACKS=ON
         CONFIGURE_ARGS: ${{ matrix.configure-args }}
         LDFLAGS: ${{ matrix.ldflags }}
 
@@ -175,7 +180,7 @@ jobs:
         LDFLAGS: ${{ matrix.ldflags }}
 
     - name: Upload build errors
-      uses: actions/upload-artifact@v4
+      uses: actions/upload-artifact@v6
       if: failure()
       with:
         name: ${{ matrix.name }}
diff --git a/.github/workflows/release.yml b/.github/workflows/release.yml
index 4494fb34..fb6cc304 100644
--- a/.github/workflows/release.yml
+++ b/.github/workflows/release.yml
@@ -38,13 +38,13 @@ jobs:
           - name: Windows MSVC ARM
             os: windows-latest
             compiler: cl
-            cmake-args: -A ARM
+            cmake-args: -A ARM,version=10.0.22621.0
             deploy-name: win-arm
 
           - name: Windows MSVC ARM Compat
             os: windows-latest
             compiler: cl
-            cmake-args: -A ARM -DZLIB_COMPAT=ON
+            cmake-args: -A ARM,version=10.0.22621.0 -DZLIB_COMPAT=ON
             deploy-name: win-arm-compat
 
           - name: Windows MSVC ARM64
@@ -61,7 +61,7 @@ jobs:
 
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v4
+      uses: actions/checkout@v6
       with:
         show-progress: 'false'
 
diff --git a/.gitignore b/.gitignore
index cd4a9c3f..f4fd297b 100644
--- a/.gitignore
+++ b/.gitignore
@@ -25,8 +25,13 @@
 /minigzip64
 /minigzipsh
 /switchlevels
+/zlib.map
 /zlib.pc
 /zlib-ng.pc
+/zconf-ng.h.included
+/zlib_name_mangling-ng.h
+/zlib-ng.h
+/zlib-ng.map
 
 .DS_Store
 *_fuzzer
@@ -61,6 +66,7 @@ zconf-ng.h.cmakein
 ztest*
 /test/CTestTestfile.cmake
 /test/cmake_install.cmake
+/.cache
 
 configure.log
 a.out
@@ -72,6 +78,10 @@ a.out
 /arch/x86/Makefile
 .kdev4
 *.kdev4
+Makefile.tmp
+/makecrct
+/maketrees
+gzread_mangle.h
 
 /Debug
 /example.dir
@@ -95,3 +105,7 @@ a.out
 MinSizeRel
 RelWithDebInfo
 /_deps/googletest*
+
+# Test datasets
+test/data/corpora/
+test/data/local/
diff --git a/CMakeLists.txt b/CMakeLists.txt
index 719673fb..b9bfbed7 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,24 +1,22 @@
-cmake_minimum_required(VERSION 3.5.1)
-if(CMAKE_VERSION VERSION_LESS 3.12)
-    cmake_policy(VERSION ${CMAKE_VERSION})
-else()
-    cmake_policy(VERSION 3.5.1...3.29.0)
-endif()
+cmake_minimum_required(VERSION 3.14...4.2.1)
 message(STATUS "Using CMake version ${CMAKE_VERSION}")
 
 # If not specified on the command line, enable C11 as the default
 # Configuration items that affect the global compiler environment standards
 # should be issued before the "project" command.
-if(NOT CMAKE_C_STANDARD)
+if(NOT DEFINED CMAKE_C_STANDARD)
     set(CMAKE_C_STANDARD 11)          # The C standard whose features are requested to build this target
 endif()
-if(NOT CMAKE_C_STANDARD_REQUIRED)
+if(NOT DEFINED CMAKE_C_STANDARD_REQUIRED)
     set(CMAKE_C_STANDARD_REQUIRED ON) # Boolean describing whether the value of C_STANDARD is a requirement
 endif()
-if(NOT CMAKE_C_EXTENSIONS)
+if(NOT DEFINED CMAKE_C_EXTENSIONS)
     set(CMAKE_C_EXTENSIONS OFF)       # Boolean specifying whether compiler specific extensions are requested
 endif()
 set(VALID_C_STANDARDS "99" "11")
+if(CMAKE_VERSION VERSION_GREATER 3.20)
+    list(APPEND VALID_C_STANDARDS "17" "23")
+endif()
 if(NOT CMAKE_C_STANDARD IN_LIST VALID_C_STANDARDS)
     MESSAGE(FATAL_ERROR "CMAKE_C_STANDARD:STRING=${CMAKE_C_STANDARD} not in known standards list\n ${VALID_C_STANDARDS}")
 endif()
@@ -43,8 +41,26 @@ include(CheckCSourceRuns)
 include(CheckCCompilerFlag)
 include(CMakeDependentOption)
 include(CMakePackageConfigHelpers)
+include(CTest)
 include(FeatureSummary)
 
+# We need to enable C++ before trying to check for coverage
+option(BUILD_TESTING "Build test binaries." ON) # Depends on CMP0077 (3.13)
+if (DEFINED ZLIB_ENABLE_TESTS)
+    message(DEPRECATION "ZLIB_ENABLE_TESTS is deprecated. Please use BUILD_TESTING instead.")
+    if (NOT ZLIB_ENABLE_TESTS)
+        set(BUILD_TESTING OFF)
+    endif()
+endif()
+cmake_dependent_option(WITH_GTEST "Build gtest_zlib" ON "BUILD_TESTING" OFF)
+cmake_dependent_option(WITH_FUZZERS "Build test/fuzz" OFF "BUILD_TESTING" OFF)
+cmake_dependent_option(WITH_BENCHMARKS "Build test/benchmarks" OFF "BUILD_TESTING" OFF)
+cmake_dependent_option(WITH_BENCHMARK_APPS "Build application benchmarks" OFF "BUILD_TESTING" OFF)
+
+if(WITH_GTEST OR WITH_FUZZERS OR WITH_BENCHMARKS)
+  enable_language(CXX)
+endif()
+
 include(cmake/detect-arch.cmake)
 include(cmake/detect-install-dirs.cmake)
 include(cmake/detect-coverage.cmake)
@@ -75,15 +91,12 @@ endif()
 #
 option(WITH_GZFILEOP "Compile with support for gzFile related functions" ON)
 option(ZLIB_COMPAT "Compile with zlib compatible API" OFF)
-option(ZLIB_ENABLE_TESTS "Build test binaries" ON)
-option(ZLIBNG_ENABLE_TESTS "Test zlib-ng specific API" ON)
-option(WITH_GTEST "Build gtest_zlib" ON)
-option(WITH_FUZZERS "Build test/fuzz" OFF)
-option(WITH_BENCHMARKS "Build test/benchmarks" OFF)
-option(WITH_BENCHMARK_APPS "Build application benchmarks" OFF)
+option(ZLIB_ALIASES "Provide zlib compatible CMake targets" ON)
 option(WITH_OPTIM "Build with optimisation" ON)
+option(WITH_ALL_FALLBACKS "Build all generic fallback functions (Useful for Gbench)" OFF)
 option(WITH_REDUCED_MEM "Reduced memory usage for special cases (reduces performance)" OFF)
 option(WITH_NEW_STRATEGIES "Use new strategies" ON)
+option(WITH_CRC32_CHORBA "Enable optimized CRC32 algorithm Chorba" ON)
 option(WITH_NATIVE_INSTRUCTIONS
     "Instruct the compiler to use the full instruction set on this host (gcc/clang -march=native)" OFF)
 option(WITH_RUNTIME_CPU_DETECTION "Build with runtime detection of CPU architecture" ON)
@@ -91,7 +104,6 @@ option(WITH_MAINTAINER_WARNINGS "Build with project maintainer warnings" OFF)
 option(WITH_CODE_COVERAGE "Enable code coverage reporting" OFF)
 option(WITH_INFLATE_STRICT "Build with strict inflate distance checking" OFF)
 option(WITH_INFLATE_ALLOW_INVALID_DIST "Build with zero fill for inflate invalid distances" OFF)
-option(WITH_UNALIGNED "Support unaligned reads on platforms that support it" ON)
 
 set(ZLIB_SYMBOL_PREFIX "" CACHE STRING "Give this prefix to all publicly exported symbols.
 Useful when embedding into a larger library.
@@ -102,23 +114,34 @@ set(WITH_SANITIZER AUTO CACHE STRING "Enable sanitizer support")
 set_property(CACHE WITH_SANITIZER PROPERTY STRINGS "Memory" "Address" "Undefined" "Thread")
 
 if(BASEARCH_ARM_FOUND)
-    option(WITH_ACLE "Build with ACLE" ON)
+    cmake_dependent_option(WITH_ARMV6 "Build with ARMv6 SIMD" ON ARCH_32BIT OFF)
+    option(WITH_ARMV8 "Build with ARMv8 intrinsics" ON)
     option(WITH_NEON "Build with NEON intrinsics" ON)
-    cmake_dependent_option(WITH_ARMV6 "Build with ARMv6 SIMD" ON "NOT ARCH STREQUAL \"aarch64\"" OFF)
+
+    # Provided for backward compatibility
+    if(DEFINED WITH_ACLE)
+        set(WITH_ARMV8 ${WITH_ACLE})
+    endif()
 elseif(BASEARCH_PPC_FOUND)
     option(WITH_ALTIVEC "Build with AltiVec (VMX) optimisations for PowerPC" ON)
     option(WITH_POWER8 "Build with optimisations for POWER8" ON)
     option(WITH_POWER9 "Build with optimisations for POWER9" ON)
 elseif(BASEARCH_RISCV_FOUND)
     option(WITH_RVV "Build with RVV intrinsics" ON)
+    option(WITH_RISCV_ZBC "Build with RISCV ZBC" ON)
 elseif(BASEARCH_S360_FOUND)
     option(WITH_DFLTCC_DEFLATE "Build with DFLTCC intrinsics for compression on IBM Z" OFF)
     option(WITH_DFLTCC_INFLATE "Build with DFLTCC intrinsics for decompression on IBM Z" OFF)
     option(WITH_CRC32_VX "Build with vectorized CRC32 on IBM Z" ON)
+elseif(BASEARCH_LOONGARCH_FOUND)
+    option(WITH_CRC32_LA "Build with vectorized CRC32 on LoongArch" ON)
+    option(WITH_LSX "Build with vectorized LSX on LoongArch" ON)
+    cmake_dependent_option(WITH_LASX "Build with vectorized LASX on LoongArch" ON "WITH_LSX" OFF)
 elseif(BASEARCH_X86_FOUND)
     option(WITH_SSE2 "Build with SSE2" ON)
     cmake_dependent_option(WITH_SSSE3 "Build with SSSE3" ON "WITH_SSE2" OFF)
-    cmake_dependent_option(WITH_SSE42 "Build with SSE42" ON "WITH_SSSE3" OFF)
+    cmake_dependent_option(WITH_SSE41 "Build with SSE41" ON "WITH_SSSE3" OFF)
+    cmake_dependent_option(WITH_SSE42 "Build with SSE42" ON "WITH_SSE41" OFF)
     cmake_dependent_option(WITH_PCLMULQDQ "Build with PCLMULQDQ" ON "WITH_SSE42" OFF)
     cmake_dependent_option(WITH_AVX2 "Build with AVX2" ON "WITH_SSE42" OFF)
     cmake_dependent_option(WITH_AVX512 "Build with AVX512" ON "WITH_AVX2" OFF)
@@ -131,21 +154,26 @@ option(INSTALL_UTILS "Copy minigzip and minideflate during install" OFF)
 mark_as_advanced(FORCE
     ZLIB_SYMBOL_PREFIX
     WITH_REDUCED_MEM
-    WITH_ACLE WITH_NEON
+    WITH_CRC32_CHORBA
+    WITH_ALL_FALLBACKS
+    WITH_ARMV8 WITH_NEON
     WITH_ARMV6
     WITH_DFLTCC_DEFLATE
     WITH_DFLTCC_INFLATE
     WITH_CRC32_VX
     WITH_AVX2 WITH_SSE2
-    WITH_SSSE3 WITH_SSE42
+    WITH_SSSE3 WITH_SSE41 WITH_SSE42
     WITH_PCLMULQDQ
     WITH_ALTIVEC
     WITH_POWER8
     WITH_POWER9
     WITH_RVV
+    WITH_RISCV_ZBC
+    WITH_CRC32_LA
+    WITH_LSX
+    WITH_LASX
     WITH_INFLATE_STRICT
     WITH_INFLATE_ALLOW_INVALID_DIST
-    WITH_UNALIGNED
     INSTALL_UTILS
     )
 
@@ -165,6 +193,10 @@ if(WITH_GZFILEOP)
     add_definitions(-DWITH_GZFILEOP)
 endif()
 
+if(NOT WITH_CRC32_CHORBA)
+    add_definitions(-DWITHOUT_CHORBA)
+endif()
+
 if(CMAKE_C_COMPILER_ID MATCHES "^Intel")
     if(CMAKE_HOST_UNIX)
         set(WARNFLAGS -Wall)
@@ -187,20 +219,34 @@ elseif(MSVC)
     if(MSVC_VERSION VERSION_LESS 1800)
         message(SEND_ERROR "Unsupported Visual Studio compiler version (requires 2013 or later).")
     endif()
+    if(MSVC_VERSION VERSION_LESS 1930)
+        message(STATUS "Old Visual Studio compiler version, disabling SSE2/SSE4.1 Chorba variants (requires 2022 or later).")
+        add_definitions(-DWITHOUT_CHORBA_SSE)
+    endif()
     # TODO. ICC can be used through MSVC. I'm not sure if we'd ever see that combination
     # (who'd use cmake from an IDE...) but checking for ICC before checking for MSVC should
     # avoid mistakes.
     # /Oi ?
-    set(WARNFLAGS /W3)
+    set(WARNFLAGS /W3 /w34242 /WX)
     set(WARNFLAGS_MAINTAINER /W4)
-    set(WARNFLAGS_DISABLE)
+    set(WARNFLAGS_DISABLE /wd4206 /wd4054 /wd4324)
     if(BASEARCH_ARM_FOUND)
         add_definitions(-D_ARM_WINAPI_PARTITION_DESKTOP_SDK_AVAILABLE)
-        if(NOT "${ARCH}" MATCHES "aarch64")
+        if(ARCH_32BIT)
             set(NEONFLAG "/arch:VFPv4")
         endif()
     endif()
-elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+
+    # Workaround for MSVC. By default MSVC does not define the __SSE*__ macros.
+    # We explicitly define the __SSE__ and __SSE2__ macros, since starting with MSVS 2012
+    # the default instruction set is SSE2.
+    if(BASEARCH_X86_FOUND)
+        add_definitions(
+            -D__SSE__=1
+            -D__SSE2__=1
+        )
+    endif()
+elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
     # Enable warnings in GCC and Clang
     set(WARNFLAGS -Wall)
     set(WARNFLAGS_MAINTAINER -Wextra)
@@ -216,7 +262,7 @@ elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
     endif()
     if(NOT WITH_NATIVE_INSTRUCTIONS)
         if(BASEARCH_ARM_FOUND)
-            if("${ARCH}" MATCHES "arm" AND NOT CMAKE_C_FLAGS MATCHES "-mfloat-abi")
+            if(ARCH_32BIT AND NOT CMAKE_C_FLAGS MATCHES "-mfloat-abi")
                 # Auto-detect support for ARM floating point ABI
                 check_include_file(features.h HAVE_FEATURES_H)
                 if(HAVE_FEATURES_H)
@@ -246,6 +292,9 @@ elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
                     message(STATUS "ARM floating point arch not auto-detected")
                 endif()
             endif()
+        elseif(BASEARCH_X86_FOUND AND CMAKE_C_COMPILER_ID MATCHES "NVHPC")
+            # nVidia compiler defaults to native build, so set target to any x86-64 processor
+            add_compile_options(-tp px)
         endif()
         # Disable LTO unless Native Instructions are enabled
         if(FNO_LTO_AVAILABLE)
@@ -279,6 +328,12 @@ if(WITH_NATIVE_INSTRUCTIONS)
             endif()
             # Fall through
         endif()
+        if(CMAKE_C_COMPILER_ID MATCHES "NVHPC")
+            check_c_compiler_flag("-tp native" HAVE_TP_NATIVE)
+            if(HAVE_TP_NATIVE)
+                set(NATIVEFLAG "-tp native")
+            endif()
+        endif()
     endif()
     if(NATIVEFLAG)
         # Apply flags to all source files and compilation checks
@@ -301,7 +356,7 @@ if(NOT WITH_RUNTIME_CPU_DETECTION)
         message(STATUS "WARNING: Microsoft Visual Studio does not support compile time detection of CPU features for \"/arch\" before \"AVX\"")
         # Workaround for MSVC. By default MSVC does not define the __SSE*__ macros.
         # Fix it if AVX is enabled.
-        set(CMAKE_REQUIRED_FLAGS "${NATIVEFLAG}")
+        set(CMAKE_REQUIRED_FLAGS "${NATIVEFLAG} ${ZNOLTOFLAG}")
         check_c_source_compiles(
             "#ifndef __AVX__
             #  error \"AVX is not enabled.\"
@@ -312,8 +367,6 @@ if(NOT WITH_RUNTIME_CPU_DETECTION)
         set(CMAKE_REQUIRED_FLAGS)
         if(MSVC_IS_ENABLED_AVX)
             add_definitions(
-                -D__SSE__=1
-                -D__SSE2__=1
                 -D__SSE3__=1
                 -D__SSSE3__=1
                 -D__SSE4_1__=1
@@ -334,12 +387,6 @@ if(NOT WITH_NATIVE_INSTRUCTIONS)
     endforeach()
 endif()
 
-# Set architecture alignment requirements
-if(NOT WITH_UNALIGNED)
-    add_definitions(-DNO_UNALIGNED)
-    message(STATUS "Unaligned reads manually disabled")
-endif()
-
 # Apply warning compiler flags
 if(WITH_MAINTAINER_WARNINGS)
     add_compile_options(${WARNFLAGS} ${WARNFLAGS_MAINTAINER} ${WARNFLAGS_DISABLE})
@@ -358,6 +405,35 @@ if(NOT WITH_CODE_COVERAGE AND NOT MSVC AND NOT CMAKE_C_FLAGS MATCHES "([\\/\\-]O
         CMAKE_C_FLAGS_RELEASE "${CMAKE_C_FLAGS_RELEASE}")
 endif()
 
+# Force Visual C++ to use UTF-8
+if(MSVC)
+    if (NOT CMAKE_C_FLAGS MATCHES "[\\/\\-]utf-8")
+        set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} /utf-8")
+    endif()
+    if (NOT CMAKE_CXX_FLAGS MATCHES "[\\/\\-]utf-8")
+        set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /utf-8")
+    endif()
+endif()
+
+#
+# Additional flags for features checking
+#
+set(ADDITIONAL_CHECK_FLAGS )
+if(APPLE)
+    check_c_compiler_flag(-Werror=unguarded-availability HAVE_W_ERROR_UNGUARDED_AVAILABILITY)
+    if(HAVE_W_ERROR_UNGUARDED_AVAILABILITY)
+        set(ADDITIONAL_CHECK_FLAGS "${ADDITIONAL_CHECK_FLAGS} -Werror=unguarded-availability")
+    endif()
+    check_c_compiler_flag(-Werror=unguarded-availability-new HAVE_W_ERROR_UNGUARDED_AVAILABILITY_NEW)
+    if(HAVE_W_ERROR_UNGUARDED_AVAILABILITY_NEW)
+        set(ADDITIONAL_CHECK_FLAGS "${ADDITIONAL_CHECK_FLAGS} -Werror=unguarded-availability-new")
+    endif()
+    check_c_compiler_flag(-Werror=unused-command-line-argument HAVE_W_ERROR_UNUSED_COMMAND_LINE_ARGUMENT)
+    if(HAVE_W_ERROR_UNUSED_COMMAND_LINE_ARGUMENT)
+        set(ADDITIONAL_CHECK_FLAGS "${ADDITIONAL_CHECK_FLAGS} -Werror=unused-command-line-argument")
+    endif()
+endif()
+
 #
 # Check for standard/system includes
 #
@@ -403,30 +479,61 @@ set(CMAKE_REQUIRED_DEFINITIONS) # clear variable
 #
 # Check for fseeko and other optional functions
 #
+set(CMAKE_REQUIRED_FLAGS "${ADDITIONAL_CHECK_FLAGS}")
 check_function_exists(fseeko HAVE_FSEEKO)
 if(NOT HAVE_FSEEKO)
     add_definitions(-DNO_FSEEKO)
 endif()
+set(CMAKE_REQUIRED_FLAGS)
 
+set(CMAKE_REQUIRED_FLAGS "${ADDITIONAL_CHECK_FLAGS}")
 check_function_exists(strerror HAVE_STRERROR)
 if(NOT HAVE_STRERROR)
     add_definitions(-DNO_STRERROR)
 endif()
+set(CMAKE_REQUIRED_FLAGS)
 
-set(CMAKE_REQUIRED_DEFINITIONS -D_POSIX_C_SOURCE=200112L)
-check_symbol_exists(posix_memalign stdlib.h HAVE_POSIX_MEMALIGN)
-if(HAVE_POSIX_MEMALIGN)
-    add_definitions(-DHAVE_POSIX_MEMALIGN)
+#
+# Check for x86 __cpuid / __cpuid_count support: GNU extensions
+# gcc/clang and MSVC have __cpuid, so check __cpuid_count instead
+check_symbol_exists(__cpuid_count cpuid.h HAVE_CPUID_GNU)
+if(HAVE_CPUID_GNU)
+    add_definitions(-DHAVE_CPUID_GNU)
 endif()
 set(CMAKE_REQUIRED_DEFINITIONS)
 
-set(CMAKE_REQUIRED_DEFINITIONS -D_ISOC11_SOURCE=1)
-check_symbol_exists(aligned_alloc stdlib.h HAVE_ALIGNED_ALLOC)
-if(HAVE_ALIGNED_ALLOC)
-    add_definitions(-DHAVE_ALIGNED_ALLOC)
+#
+# Check for x86 __cpuid / __cpuidex support: MSVC extensions
+# gcc/clang and MSVC have __cpuid, so check __cpuidex instead
+# check_symbol_exists() does not work for intrinsics
+
+check_c_source_compiles(
+"
+#include <intrin.h>
+static inline void cpuid_ms(int info, unsigned int *eax, unsigned int *ebx, unsigned int *ecx, unsigned int *edx) {
+    unsigned int registers[4];
+    __cpuid((int *)registers, info);
+    *eax = registers[0];
+    *ebx = registers[1];
+    *ecx = registers[2];
+    *edx = registers[3];
+}
+
+int main(void) {
+  unsigned int eax, ebx, ecx, edx;
+  cpuid_ms(0, &eax, &ebx, &ecx, &edx);
+  return eax;
+}"
+HAVE_CPUID_MS)
+
+if(HAVE_CPUID_MS)
+    add_definitions(-DHAVE_CPUID_MS)
 endif()
 set(CMAKE_REQUIRED_DEFINITIONS)
 
+#
+# Check whether a sanitizer was requested
+#
 if(WITH_SANITIZER STREQUAL "Address")
     add_address_sanitizer()
 elseif(WITH_SANITIZER STREQUAL "Memory")
@@ -440,7 +547,9 @@ endif()
 #
 # Check whether compiler supports -fno-semantic-interposition parameter
 #
+set(CMAKE_REQUIRED_FLAGS "${ADDITIONAL_CHECK_FLAGS}")
 check_c_compiler_flag(-fno-semantic-interposition HAVE_NO_INTERPOSITION)
+set(CMAKE_REQUIRED_FLAGS)
 
 #
 # Check if we can hide zlib internal symbols that are linked between separate source files using hidden
@@ -487,6 +596,7 @@ endif()
 #
 # Check for __builtin_assume_aligned(x,n) support in the compiler
 #
+set(CMAKE_REQUIRED_FLAGS ${ZNOLTOFLAG})
 check_c_source_compiles(
     "char *test(char *buffer) {
         char *abuffer = __builtin_assume_aligned(buffer,64);
@@ -499,10 +609,12 @@ check_c_source_compiles(
 if(HAVE_BUILTIN_ASSUME_ALIGNED)
     add_definitions(-DHAVE_BUILTIN_ASSUME_ALIGNED)
 endif()
+set(CMAKE_REQUIRED_FLAGS)
 
 #
 # check for __builtin_ctz() support in the compiler
 #
+set(CMAKE_REQUIRED_FLAGS ${ZNOLTOFLAG})
 check_c_source_compiles(
     "int main(void) {
         unsigned int zero = 0;
@@ -515,10 +627,12 @@ check_c_source_compiles(
 if(HAVE_BUILTIN_CTZ)
     add_definitions(-DHAVE_BUILTIN_CTZ)
 endif()
+set(CMAKE_REQUIRED_FLAGS)
 
 #
 # check for __builtin_ctzll() support in the compiler
 #
+set(CMAKE_REQUIRED_FLAGS ${ZNOLTOFLAG})
 check_c_source_compiles(
     "int main(void) {
         unsigned int zero = 0;
@@ -531,6 +645,7 @@ check_c_source_compiles(
 if(HAVE_BUILTIN_CTZLL)
     add_definitions(-DHAVE_BUILTIN_CTZLL)
 endif()
+set(CMAKE_REQUIRED_FLAGS)
 
 #
 # check for ptrdiff_t support
@@ -567,13 +682,6 @@ if(MSVC)
     add_definitions(-D_CRT_NONSTDC_NO_DEPRECATE)
 endif()
 
-if(BASEARCH_X86_FOUND)
-    # FORCE_SSE2 option will only be shown if HAVE_SSE2_INTRIN is true
-    if("${ARCH}" MATCHES "i[3-6]86")
-        cmake_dependent_option(FORCE_SSE2 "Always assume CPU is SSE2 capable" OFF "HAVE_SSE2_INTRIN" OFF)
-    endif()
-endif()
-
 #
 # Enable deflate_quick at level 1
 #
@@ -618,9 +726,11 @@ elseif(BASEARCH_RISCV_FOUND)
     set(ARCHDIR "arch/riscv")
 elseif(BASEARCH_S360_FOUND)
     set(ARCHDIR "arch/s390")
+elseif(BASEARCH_LOONGARCH_FOUND)
+    set(ARCHDIR "arch/loongarch")
 elseif(BASEARCH_X86_FOUND)
     set(ARCHDIR "arch/x86")
-    if(NOT ${ARCH} MATCHES "x86_64")
+    if(ARCH_32BIT)
         add_feature_info(SSE2 1 "Support the SSE2 instruction set, using \"${SSE2FLAG}\"")
     endif()
 else()
@@ -629,10 +739,11 @@ else()
 endif()
 
 if(WITH_OPTIM)
+    add_definitions(-DWITH_OPTIM)
     if(BASEARCH_ARM_FOUND)
         add_definitions(-DARM_FEATURES)
         if(${CMAKE_SYSTEM_NAME} STREQUAL "Linux")
-            if("${ARCH}" MATCHES "aarch64")
+            if(ARCH_64BIT)
                 check_c_source_compiles(
                     "#include <sys/auxv.h>
                     int main() {
@@ -695,26 +806,60 @@ if(WITH_OPTIM)
                 endif()
             endif()
         endif()
+        if(${CMAKE_SYSTEM_NAME} STREQUAL "FreeBSD" OR
+           ${CMAKE_SYSTEM_NAME} STREQUAL "OpenBSD")
+            if(ARCH_64BIT)
+                check_c_source_compiles(
+                    "#include <sys/auxv.h>
+                    int main() {
+                        unsigned long hwcap;
+                        elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
+                        return (hwcap & HWCAP_CRC32);
+                    }"
+                    ARM_AUXV_HAS_CRC32
+                )
+                if(ARM_AUXV_HAS_CRC32)
+                    add_definitions(-DARM_AUXV_HAS_CRC32)
+                else()
+                    message(STATUS "HWCAP_CRC32 not present in sys/auxv.h; cannot detect support at runtime.")
+                endif()
+            else()
+                check_c_source_compiles(
+                    "#include <sys/auxv.h>
+                    int main() {
+                        unsigned long hwcap2;
+                        elf_aux_info(AT_HWCAP2, &hwcap2, sizeof(hwcap2));
+                        return (hwcap2 & HWCAP2_CRC32);
+                    }"
+                    ARM_AUXV_HAS_CRC32
+                )
+                if(ARM_AUXV_HAS_CRC32)
+                    add_definitions(-DARM_AUXV_HAS_CRC32)
+                else()
+                    message(STATUS "HWCAP2_CRC32 not present in sys/auxv.h; cannot detect support at runtime.")
+                endif()
+                check_c_source_compiles(
+                    "#include <sys/auxv.h>
+                    int main() {
+                      unsigned long hwcap;
+                      elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
+                      return (hwcap & HWCAP_NEON);
+                    }"
+                    ARM_AUXV_HAS_NEON
+                )
+                if(ARM_AUXV_HAS_NEON)
+                    add_definitions(-DARM_AUXV_HAS_NEON)
+                else()
+                    message(STATUS "HWCAP_NEON not present in sys/auxv.h; cannot detect support at runtime.")
+                endif()
+            endif()
+        endif()
         list(APPEND ZLIB_ARCH_HDRS ${ARCHDIR}/arm_functions.h)
         if(WITH_RUNTIME_CPU_DETECTION)
             list(APPEND ZLIB_ARCH_HDRS ${ARCHDIR}/arm_features.h)
             list(APPEND ZLIB_ARCH_SRCS ${ARCHDIR}/arm_features.c)
         endif()
 
-        if(WITH_ACLE)
-            check_acle_compiler_flag()
-            if(HAVE_ACLE_FLAG)
-                add_definitions(-DARM_ACLE)
-                set(ACLE_SRCS ${ARCHDIR}/crc32_acle.c)
-                set_property(SOURCE ${ACLE_SRCS} PROPERTY COMPILE_FLAGS "${ACLEFLAG} ${NOLTOFLAG}")
-                list(APPEND ZLIB_ARCH_SRCS ${ACLE_SRCS})
-                add_feature_info(ACLE_CRC 1 "Support ACLE optimized CRC hash generation, using \"${ACLEFLAG}\"")
-            else()
-                set(WITH_ACLE OFF)
-            endif()
-        else()
-            set(WITH_ACLE OFF)
-        endif()
         if(WITH_NEON)
             check_neon_compiler_flag()
             if(NEON_AVAILABLE)
@@ -753,6 +898,35 @@ if(WITH_OPTIM)
         else()
             set(WITH_ARMV6 OFF)
         endif()
+        if(WITH_ARMV8)
+            check_armv8_compiler_flag()
+            if(HAVE_ARMV8_INLINE_ASM OR HAVE_ARMV8_INTRIN)
+                add_definitions(-DARM_CRC32)
+                set(ARMV8_SRCS ${ARCHDIR}/crc32_armv8.c)
+                set_property(SOURCE ${ARMV8_SRCS} PROPERTY COMPILE_FLAGS "${ARMV8FLAG} ${NOLTOFLAG}")
+                list(APPEND ZLIB_ARCH_SRCS ${ARMV8_SRCS})
+                add_feature_info(ARMV8_CRC 1 "Support ARMv8 optimized CRC hash generation, using \"${ARMV8FLAG}\"")
+                if(HAVE_ARMV8_INTRIN)
+                    add_definitions(-DARM_CRC32_INTRIN)
+                endif()
+
+                # Check for PMULL support (requires NEON too)
+                if(WITH_NEON AND NEON_AVAILABLE)
+                    check_armv8_pmull_eor3_compiler_flag()
+                    if(HAVE_ARMV8_PMULL_EOR3_INTRIN)
+                        add_definitions(-DARM_PMULL_EOR3)
+                        set(PCMULLEOR3_SRCS ${ARCHDIR}/crc32_armv8_pmull_eor3.c)
+                        set_property(SOURCE ${PCMULLEOR3_SRCS} PROPERTY COMPILE_FLAGS "${PMULLEOR3FLAG} ${NOLTOFLAG}")
+                        list(APPEND ZLIB_ARCH_SRCS ${PCMULLEOR3_SRCS})
+                        add_feature_info(ARMV8_PMULL_EOR3 1 "Support ARMv8 PMULL + EOR3 instructions for CRC, using \"${PMULLEOR3FLAG}\"")
+                    endif()
+                endif()
+            else()
+                set(WITH_ARMV8 OFF)
+            endif()
+        else()
+            set(WITH_ARMV8 OFF)
+        endif()
     elseif(BASEARCH_PPC_FOUND)
         # Common arch detection code
         if(WITH_ALTIVEC)
@@ -797,7 +971,7 @@ if(WITH_OPTIM)
             if(HAVE_POWER8_INTRIN)
                 add_definitions(-DPOWER8_VSX)
                 set(POWER8_SRCS ${ARCHDIR}/adler32_power8.c ${ARCHDIR}/chunkset_power8.c ${ARCHDIR}/slide_hash_power8.c)
-                if("${ARCH}" MATCHES "powerpc64(le)?")
+                if(ARCH_64BIT)
                     add_definitions(-DPOWER8_VSX_CRC32)
                     list(APPEND POWER8_SRCS ${ARCHDIR}/crc32_power8.c)
                 endif()
@@ -832,15 +1006,34 @@ if(WITH_OPTIM)
                 # FIXME: we will not set compile flags for riscv_features.c when
                 # the kernels update hwcap or hwprobe for riscv
                 set(RVV_SRCS ${ARCHDIR}/adler32_rvv.c ${ARCHDIR}/chunkset_rvv.c ${ARCHDIR}/compare256_rvv.c ${ARCHDIR}/slide_hash_rvv.c)
-                if(WITH_RUNTIME_CPU_DETECTION)
-                    list(APPEND RVV_SRCS ${ARCHDIR}/riscv_features.c)
-                endif()
                 list(APPEND ZLIB_ARCH_SRCS ${RVV_SRCS})
                 set_property(SOURCE ${RVV_SRCS} PROPERTY COMPILE_FLAGS "${RISCVFLAG} ${NOLTOFLAG}")
             else()
                 set(WITH_RVV OFF)
             endif()
         endif()
+        if(WITH_RISCV_ZBC)
+            check_riscv_zbc_ext()
+            if(HAVE_RISCV_ZBC)
+                add_definitions(-DRISCV_CRC32_ZBC)
+                set(ZBC_SRCS ${ARCHDIR}/crc32_zbc.c)
+                list(APPEND ZLIB_ARCH_SRCS ${ZBC_SRCS})
+                set_property(SOURCE ${ZBC_SRCS} PROPERTY COMPILE_FLAGS "-march=rv64gc_zbc ${NOLTOFLAG}")
+                add_feature_info(RISCV_ZBC 1 "Support RISC-V Zbc extension for CRC32")
+            else()
+                set(WITH_RISCV_ZBC OFF)
+            endif()
+        endif()
+
+        if(WITH_RUNTIME_CPU_DETECTION AND BASEARCH_RISCV_FOUND)
+            if(WITH_RVV AND WITH_RISCV_ZBC AND HAVE_RVV_INTRIN AND HAVE_RISCV_ZBC)
+                set_property(SOURCE ${ARCHDIR}/riscv_features.c PROPERTY COMPILE_FLAGS "${RISCVFLAG}_zbc ${NOLTOFLAG}")
+            elseif(WITH_RVV AND HAVE_RVV_INTRIN)
+                set_property(SOURCE ${ARCHDIR}/riscv_features.c PROPERTY COMPILE_FLAGS "${RISCVFLAG} ${NOLTOFLAG}")
+            elseif(WITH_RISCV_ZBC AND HAVE_RISCV_ZBC)
+                set_property(SOURCE ${ARCHDIR}/riscv_features.c PROPERTY COMPILE_FLAGS "${RISCVZBCFLAG} ${NOLTOFLAG}")
+            endif()
+        endif()
     elseif(BASEARCH_S360_FOUND)
         check_s390_intrinsics()
         if(HAVE_S390_INTRIN)
@@ -870,6 +1063,50 @@ if(WITH_OPTIM)
                 set(WITH_CRC32_VX OFF)
             endif()
         endif()
+    elseif(BASEARCH_LOONGARCH_FOUND)
+        add_definitions(-DLOONGARCH_FEATURES)
+        list(APPEND ZLIB_ARCH_HDRS ${ARCHDIR}/loongarch_functions.h)
+        if(WITH_RUNTIME_CPU_DETECTION)
+            list(APPEND ZLIB_ARCH_HDRS ${ARCHDIR}/loongarch_features.h)
+            list(APPEND ZLIB_ARCH_SRCS ${ARCHDIR}/loongarch_features.c)
+        endif()
+
+        if(WITH_CRC32_LA)
+            check_la64_crc_intrinsics()
+            if(HAVE_LA64_CRC_INTRIN)
+                add_definitions(-DLOONGARCH_CRC)
+                set(CRC32_LA_SRCS ${ARCHDIR}/crc32_la.c)
+                list(APPEND ZLIB_ARCH_SRCS ${CRC32_LA_SRCS})
+                set_property(SOURCE ${CRC32_LA_SRCS} PROPERTY COMPILE_FLAGS "${NOLTOFLAG}")
+            else()
+                set(WITH_CRC32_LA OFF)
+            endif()
+        endif()
+
+        if(WITH_LSX)
+            check_lsx_intrinsics()
+            if(HAVE_LSX_INTRIN)
+                add_definitions(-DLOONGARCH_LSX)
+                set(LSX_SRCS ${ARCHDIR}/adler32_lsx.c ${ARCHDIR}/chunkset_lsx.c ${ARCHDIR}/compare256_lsx.c ${ARCHDIR}/slide_hash_lsx.c)
+                list(APPEND ZLIB_ARCH_SRCS ${LSX_SRCS})
+                set_property(SOURCE ${LSX_SRCS} PROPERTY COMPILE_FLAGS "${LSXFLAG} ${NOLTOFLAG}")
+            else()
+                set(HAVE_LSX_INTRIN OFF)
+            endif()
+        endif()
+
+        if(WITH_LASX)
+            check_lasx_intrinsics()
+            if(HAVE_LASX_INTRIN AND HAVE_LSX_INTRIN)
+                add_definitions(-DLOONGARCH_LASX)
+                set(LASX_SRCS ${ARCHDIR}/adler32_lasx.c ${ARCHDIR}/chunkset_lasx.c ${ARCHDIR}/compare256_lasx.c ${ARCHDIR}/slide_hash_lasx.c)
+                list(APPEND ZLIB_ARCH_SRCS ${LASX_SRCS})
+                set_property(SOURCE ${LASX_SRCS} PROPERTY COMPILE_FLAGS "${LASXFLAG} ${NOLTOFLAG}")
+            else()
+                set(HAVE_LASX_INTRIN OFF)
+            endif()
+        endif()
+
     elseif(BASEARCH_X86_FOUND)
         add_definitions(-DX86_FEATURES)
         list(APPEND ZLIB_ARCH_HDRS ${ARCHDIR}/x86_functions.h)
@@ -894,14 +1131,10 @@ if(WITH_OPTIM)
             check_sse2_intrinsics()
             if(HAVE_SSE2_INTRIN)
                 add_definitions(-DX86_SSE2)
-                set(SSE2_SRCS ${ARCHDIR}/chunkset_sse2.c ${ARCHDIR}/compare256_sse2.c ${ARCHDIR}/slide_hash_sse2.c)
+                set(SSE2_SRCS ${ARCHDIR}/chunkset_sse2.c ${ARCHDIR}/chorba_sse2.c ${ARCHDIR}/compare256_sse2.c ${ARCHDIR}/slide_hash_sse2.c)
                 list(APPEND ZLIB_ARCH_SRCS ${SSE2_SRCS})
-                if(NOT ${ARCH} MATCHES "x86_64")
+                if(ARCH_32BIT)
                     set_property(SOURCE ${SSE2_SRCS} PROPERTY COMPILE_FLAGS "${SSE2FLAG} ${NOLTOFLAG}")
-                    add_feature_info(FORCE_SSE2 FORCE_SSE2 "Assume CPU is SSE2 capable")
-                    if(FORCE_SSE2)
-                        add_definitions(-DX86_NOCHECK_SSE2)
-                    endif()
                 endif()
             else()
                 set(WITH_SSE2 OFF)
@@ -919,9 +1152,20 @@ if(WITH_OPTIM)
                 set(WITH_SSSE3 OFF)
             endif()
         endif()
+        if(WITH_SSE41)
+            check_sse41_intrinsics()
+            if(HAVE_SSE41_INTRIN AND WITH_SSSE3)
+                add_definitions(-DX86_SSE41)
+                set(SSE41_SRCS ${ARCHDIR}/chorba_sse41.c)
+                list(APPEND ZLIB_ARCH_SRCS ${SSE41_SRCS})
+                set_property(SOURCE ${SSE41_SRCS} PROPERTY COMPILE_FLAGS "${SSE41FLAG} ${NOLTOFLAG}")
+            else()
+                set(WITH_SSE41 OFF)
+            endif()
+        endif()
         if(WITH_SSE42)
             check_sse42_intrinsics()
-            if(HAVE_SSE42_INTRIN AND WITH_SSSE3)
+            if(HAVE_SSE42_INTRIN AND WITH_SSE41)
                 add_definitions(-DX86_SSE42)
                 set(SSE42_SRCS ${ARCHDIR}/adler32_sse42.c)
                 add_feature_info(SSE42_CRC 1 "Support SSE4.2 optimized adler32 hash generation, using \"${SSE42FLAG}\"")
@@ -967,8 +1211,12 @@ if(WITH_OPTIM)
                 add_definitions(-DX86_AVX512)
                 list(APPEND AVX512_SRCS ${ARCHDIR}/adler32_avx512.c)
                 add_feature_info(AVX512_ADLER32 1 "Support AVX512-accelerated adler32, using \"${AVX512FLAG}\"")
-                list(APPEND ZLIB_ARCH_SRCS ${AVX512_SRCS})
+                list(APPEND AVX512_SRCS ${ARCHDIR}/chunkset_avx512.c)
+                add_feature_info(AVX512_CHUNKSET 1 "Support AVX512 optimized chunkset, using \"${AVX512FLAG}\"")
+                list(APPEND AVX512_SRCS ${ARCHDIR}/compare256_avx512.c)
+                add_feature_info(AVX512_COMPARE256 1 "Support AVX512 optimized compare256, using \"${AVX512FLAG}\"")
                 list(APPEND ZLIB_ARCH_HDRS ${ARCHDIR}/adler32_avx512_p.h)
+                list(APPEND ZLIB_ARCH_SRCS ${AVX512_SRCS})
                 set_property(SOURCE ${AVX512_SRCS} PROPERTY COMPILE_FLAGS "${AVX512FLAG} ${NOLTOFLAG}")
             else()
                 set(WITH_AVX512 OFF)
@@ -999,6 +1247,9 @@ if(WITH_OPTIM)
             endif()
         endif()
     endif()
+else()
+    # If WITH_OPTIM is disabled, we need all the fallbacks.
+    set(WITH_ALL_FALLBACKS ON)
 endif()
 
 message(STATUS "Architecture-specific source files: ${ZLIB_ARCH_SRCS}")
@@ -1052,6 +1303,12 @@ else()
     set(PC_INC_INSTALL_DIR "\${prefix}/${CMAKE_INSTALL_INCLUDEDIR}")
 endif()
 
+if(IS_ABSOLUTE "${CMAKE_INSTALL_BINDIR}")
+    set(PC_BIN_INSTALL_DIR "${CMAKE_INSTALL_BINDIR}")
+else()
+    set(PC_BIN_INSTALL_DIR "\${exec_prefix}/${CMAKE_INSTALL_BINDIR}")
+endif()
+
 if(IS_ABSOLUTE "${CMAKE_INSTALL_LIBDIR}")
     set(PC_LIB_INSTALL_DIR "${CMAKE_INSTALL_LIBDIR}")
 else()
@@ -1068,21 +1325,27 @@ set(ZLIB_PUBLIC_HDRS
     ${CMAKE_CURRENT_BINARY_DIR}/zlib${SUFFIX}.h
 )
 set(ZLIB_PRIVATE_HDRS
+    arch/generic/chunk_permute_table.h
+    arch/generic/compare256_p.h
+    arch/generic/generic_functions.h
     adler32_p.h
+    arch_functions.h
     chunkset_tpl.h
     compare256_rle.h
-    arch_functions.h
+    crc32.h
     crc32_braid_p.h
     crc32_braid_comb_p.h
     crc32_braid_tbl.h
     deflate.h
     deflate_p.h
+    fallback_builtins.h
     functable.h
     inffast_tpl.h
     inffixed_tbl.h
     inflate.h
     inflate_p.h
     inftrees.h
+    insert_string_p.h
     insert_string_tpl.h
     match_tpl.h
     trees.h
@@ -1090,16 +1353,11 @@ set(ZLIB_PRIVATE_HDRS
     trees_tbl.h
     zbuild.h
     zendian.h
+    zmemory.h
     zutil.h
+    zutil_p.h
 )
 set(ZLIB_SRCS
-    arch/generic/adler32_c.c
-    arch/generic/adler32_fold_c.c
-    arch/generic/chunkset_c.c
-    arch/generic/compare256_c.c
-    arch/generic/crc32_braid_c.c
-    arch/generic/crc32_fold_c.c
-    arch/generic/slide_hash_c.c
     adler32.c
     compress.c
     crc32.c
@@ -1117,12 +1375,42 @@ set(ZLIB_SRCS
     inflate.c
     inftrees.c
     insert_string.c
-    insert_string_roll.c
     trees.c
     uncompr.c
     zutil.c
 )
 
+set(ZLIB_ALL_FALLBACK_SRCS
+    arch/generic/adler32_c.c
+    arch/generic/chunkset_c.c
+    arch/generic/compare256_c.c
+    arch/generic/crc32_braid_c.c
+    arch/generic/slide_hash_c.c
+)
+
+if(WITH_ALL_FALLBACKS)
+    list(APPEND ZLIB_GENERIC_SRCS ${ZLIB_ALL_FALLBACK_SRCS})
+    add_definitions(-DWITH_ALL_FALLBACKS)
+elseif(BASEARCH_X86_FOUND AND ARCH_64BIT AND WITH_SSE2)
+    # x86_64 always has SSE2, so let the SSE2 functions act as fallbacks.
+    list(APPEND ZLIB_GENERIC_SRCS
+        arch/generic/adler32_c.c
+        arch/generic/crc32_braid_c.c
+    )
+
+    # x86_64 does not need compare256 fallback if we have BUILTIN_CTZ
+    if(NOT HAVE_BUILTIN_CTZ)
+        list(APPEND ZLIB_GENERIC_SRCS arch/generic/compare256_c.c)
+    endif()
+else()
+    list(APPEND ZLIB_GENERIC_SRCS ${ZLIB_ALL_FALLBACK_SRCS})
+    add_definitions(-DWITH_ALL_FALLBACKS)
+endif()
+
+if(WITH_CRC32_CHORBA)
+    list(APPEND ZLIB_SRCS arch/generic/crc32_chorba_c.c)
+endif()
+
 if(WITH_RUNTIME_CPU_DETECTION)
     list(APPEND ZLIB_PRIVATE_HDRS cpu_features.h)
     list(APPEND ZLIB_SRCS cpu_features.c)
@@ -1133,11 +1421,11 @@ set(ZLIB_GZFILE_PRIVATE_HDRS
 )
 set(ZLIB_GZFILE_SRCS
     gzlib.c
-    ${CMAKE_CURRENT_BINARY_DIR}/gzread.c
+    gzread.c
     gzwrite.c
 )
 
-set(ZLIB_ALL_SRCS ${ZLIB_SRCS} ${ZLIB_ARCH_HDRS} ${ZLIB_ARCH_SRCS} ${ZLIB_PUBLIC_HDRS} ${ZLIB_PRIVATE_HDRS})
+set(ZLIB_ALL_SRCS ${ZLIB_GENERIC_SRCS} ${ZLIB_SRCS} ${ZLIB_ARCH_HDRS} ${ZLIB_ARCH_SRCS} ${ZLIB_PUBLIC_HDRS} ${ZLIB_PRIVATE_HDRS})
 if(WITH_GZFILEOP)
     list(APPEND ZLIB_ALL_SRCS ${ZLIB_GZFILE_PRIVATE_HDRS} ${ZLIB_GZFILE_SRCS})
 endif()
@@ -1147,36 +1435,49 @@ if(NOT DEFINED BUILD_SHARED_LIBS OR BUILD_SHARED_LIBS)
 endif()
 
 if(NOT DEFINED BUILD_SHARED_LIBS)
-    add_library(zlib SHARED ${ZLIB_ALL_SRCS} ${ZLIB_DLL_SRCS})
-    add_library(zlibstatic STATIC ${ZLIB_ALL_SRCS})
+    add_library(zlib-ng SHARED ${ZLIB_ALL_SRCS} ${ZLIB_DLL_SRCS})
+    add_library(zlib-ng-static STATIC ${ZLIB_ALL_SRCS})
+    add_library(zlib-ng::zlib ALIAS zlib-ng)
+    add_library(zlib-ng::zlibstatic ALIAS zlib-ng-static)
 
-    set(ZLIB_INSTALL_LIBRARIES zlib zlibstatic)
+    set(ZLIB_INSTALL_LIBRARIES zlib-ng zlib-ng-static)
 else()
-    add_library(zlib ${ZLIB_ALL_SRCS})
+    add_library(zlib-ng ${ZLIB_ALL_SRCS})
+    add_library(zlib-ng::zlib ALIAS zlib-ng)
 
     if(BUILD_SHARED_LIBS)
-        target_sources(zlib PRIVATE ${ZLIB_DLL_SRCS})
+        target_sources(zlib-ng PRIVATE ${ZLIB_DLL_SRCS})
     else()
-        add_library(zlibstatic ALIAS zlib)
+        add_library(zlib-ng-static ALIAS zlib-ng)
+        add_library(zlib-ng::zlibstatic ALIAS zlib-ng)
     endif()
 
-    set(ZLIB_INSTALL_LIBRARIES zlib)
+    set(ZLIB_INSTALL_LIBRARIES zlib-ng)
 endif()
 
 # INFO: Mimics official zlib CMake target
 # Generates ZLIB.cmake in case ZLIB_COMPAT=ON and always exports the CMake target ZLIB::ZLIB
 # In case ZLIB_COMPAT=OFF, the CMake target and file follows zlib-ng naming convention
 if (ZLIB_COMPAT)
-    if (TARGET zlib)
-        set_target_properties(zlib PROPERTIES EXPORT_NAME ZLIB)
-    else()
-        set_target_properties(zlibstatic PROPERTIES EXPORT_NAME ZLIB)
+    set_target_properties(zlib-ng PROPERTIES EXPORT_NAME ZLIB)
+    if (NOT DEFINED BUILD_SHARED_LIBS)
+        set_target_properties(zlib-ng-static PROPERTIES EXPORT_NAME ZLIBSTATIC)
+    endif()
+else()
+    set_target_properties(zlib-ng PROPERTIES EXPORT_NAME zlib)
+    if (NOT DEFINED BUILD_SHARED_LIBS)
+        set_target_properties(zlib-ng-static PROPERTIES EXPORT_NAME zlibstatic)
     endif()
 endif()
 
-include_directories(${CMAKE_CURRENT_SOURCE_DIR})
-include_directories(${ARCHDIR})
-include_directories(${CMAKE_CURRENT_SOURCE_DIR}/arch/generic)
+if (ZLIB_ALIASES)
+    add_library(zlib ALIAS zlib-ng)
+    if (NOT DEFINED BUILD_SHARED_LIBS)
+        add_library(zlibstatic ALIAS zlib-ng-static)
+    elseif (NOT BUILD_SHARED_LIBS)
+        add_library(zlibstatic ALIAS zlib-ng)
+    endif()
+endif()
 
 foreach(ZLIB_INSTALL_LIBRARY ${ZLIB_INSTALL_LIBRARIES})
     if(NOT ZLIB_COMPAT)
@@ -1190,20 +1491,20 @@ endforeach()
 if(WIN32)
     # Shared library
     if(NOT DEFINED BUILD_SHARED_LIBS OR BUILD_SHARED_LIBS)
-        set_target_properties(zlib PROPERTIES OUTPUT_NAME zlib${SUFFIX})
+        set_target_properties(zlib-ng PROPERTIES OUTPUT_NAME zlib${SUFFIX})
     endif()
     # Static library
     if(NOT DEFINED BUILD_SHARED_LIBS)
         if(MSVC)
-            set_target_properties(zlibstatic PROPERTIES OUTPUT_NAME zlibstatic${SUFFIX})
+            set_target_properties(zlib-ng-static PROPERTIES OUTPUT_NAME zlibstatic${SUFFIX})
         else()
-            set_target_properties(zlibstatic PROPERTIES OUTPUT_NAME z${SUFFIX})
+            set_target_properties(zlib-ng-static PROPERTIES OUTPUT_NAME z${SUFFIX})
         endif()
     elseif(NOT BUILD_SHARED_LIBS)
         if(MSVC)
-            set_target_properties(zlib PROPERTIES OUTPUT_NAME zlibstatic${SUFFIX})
+            set_target_properties(zlib-ng PROPERTIES OUTPUT_NAME zlibstatic${SUFFIX})
         else()
-            set_target_properties(zlib PROPERTIES OUTPUT_NAME z${SUFFIX})
+            set_target_properties(zlib-ng PROPERTIES OUTPUT_NAME z${SUFFIX})
         endif()
     endif()
 else()
@@ -1212,12 +1513,12 @@ else()
 endif()
 
 if(NOT DEFINED BUILD_SHARED_LIBS OR BUILD_SHARED_LIBS)
-    set_target_properties(zlib PROPERTIES DEFINE_SYMBOL ZLIB_DLL)
+    set_target_properties(zlib-ng PROPERTIES DEFINE_SYMBOL ZLIB_DLL)
 
     if(ZLIB_COMPAT)
-        set_target_properties(zlib PROPERTIES SOVERSION 1)
+        set_target_properties(zlib-ng PROPERTIES SOVERSION 1)
     else()
-        set_target_properties(zlib PROPERTIES SOVERSION 2)
+        set_target_properties(zlib-ng PROPERTIES SOVERSION 2)
     endif()
 
     if(NOT CYGWIN)
@@ -1228,19 +1529,21 @@ if(NOT DEFINED BUILD_SHARED_LIBS OR BUILD_SHARED_LIBS)
         #
         # This has no effect with MSVC, on that platform the version info for
         # the DLL comes from the resource file win32/zlib1.rc
-        set_target_properties(zlib PROPERTIES VERSION ${ZLIB_FULL_VERSION})
+        set_target_properties(zlib-ng PROPERTIES VERSION ${ZLIB_FULL_VERSION})
     endif()
 
     if(UNIX)
         if(HAVE_NO_INTERPOSITION)
-            set_target_properties(zlib PROPERTIES COMPILE_FLAGS "-fno-semantic-interposition")
+            set_target_properties(zlib-ng PROPERTIES COMPILE_FLAGS "-fno-semantic-interposition")
         endif()
         if(NOT APPLE AND NOT CMAKE_SYSTEM_NAME STREQUAL AIX)
             if(NOT ZLIB_COMPAT)
                 add_definitions(-DHAVE_SYMVER)
             endif()
-            set_target_properties(zlib PROPERTIES LINK_FLAGS
-                "-Wl,--version-script,\"${CMAKE_CURRENT_SOURCE_DIR}/zlib${SUFFIX}.map\"")
+            configure_file(${CMAKE_CURRENT_SOURCE_DIR}/zlib${SUFFIX}.map.in
+                ${CMAKE_CURRENT_BINARY_DIR}/zlib${SUFFIX}.map @ONLY)
+            set_target_properties(zlib-ng PROPERTIES LINK_FLAGS
+                "-Wl,--version-script,\"${CMAKE_CURRENT_BINARY_DIR}/zlib${SUFFIX}.map\"")
         endif()
     endif()
     if(MSYS)
@@ -1249,9 +1552,9 @@ if(NOT DEFINED BUILD_SHARED_LIBS OR BUILD_SHARED_LIBS)
     elseif(WIN32)
         # Creates zlib1.dll when building shared library version
         if(ZLIB_COMPAT)
-            set_target_properties(zlib PROPERTIES SUFFIX "1.dll")
+            set_target_properties(zlib-ng PROPERTIES SUFFIX "1.dll")
         else()
-            set_target_properties(zlib PROPERTIES SUFFIX "2.dll")
+            set_target_properties(zlib-ng PROPERTIES SUFFIX "2.dll")
         endif()
     endif()
 endif()
@@ -1277,8 +1580,8 @@ configure_file(${CMAKE_CURRENT_BINARY_DIR}/zconf${SUFFIX}.h.cmakein
     ${CMAKE_CURRENT_BINARY_DIR}/zconf${SUFFIX}.h @ONLY)
 configure_file(${CMAKE_CURRENT_SOURCE_DIR}/zlib${SUFFIX}.h.in
     ${CMAKE_CURRENT_BINARY_DIR}/zlib${SUFFIX}.h @ONLY)
-configure_file(${CMAKE_CURRENT_SOURCE_DIR}/gzread.c.in
-    ${CMAKE_CURRENT_BINARY_DIR}/gzread.c @ONLY)
+configure_file(${CMAKE_CURRENT_SOURCE_DIR}/gzread_mangle.h.in
+    ${CMAKE_CURRENT_BINARY_DIR}/gzread_mangle.h @ONLY)
 
 if (NOT ZLIB_SYMBOL_PREFIX STREQUAL "")
     add_feature_info(ZLIB_SYMBOL_PREFIX ON "Publicly exported symbols have a custom prefix")
@@ -1294,7 +1597,7 @@ endif()
 
 if(NOT SKIP_INSTALL_LIBRARIES AND NOT SKIP_INSTALL_ALL)
     install(TARGETS ${ZLIB_INSTALL_LIBRARIES}
-        EXPORT ${EXPORT_NAME}
+        EXPORT ${EXPORT_NAME}-targets
         RUNTIME DESTINATION "${CMAKE_INSTALL_BINDIR}"
         ARCHIVE DESTINATION "${CMAKE_INSTALL_LIBDIR}"
         LIBRARY DESTINATION "${CMAKE_INSTALL_LIBDIR}")
@@ -1309,7 +1612,7 @@ if(NOT SKIP_INSTALL_HEADERS AND NOT SKIP_INSTALL_ALL)
 endif()
 if(NOT SKIP_INSTALL_FILES AND NOT SKIP_INSTALL_ALL)
     install(FILES ${ZLIB_PC} DESTINATION "${PKGCONFIG_INSTALL_DIR}")
-    install(EXPORT ${EXPORT_NAME}
+    install(EXPORT ${EXPORT_NAME}-targets
         DESTINATION "${CMAKE_INSTALL_LIBDIR}/cmake/${EXPORT_NAME}"
         NAMESPACE ${EXPORT_NAME}::)
     # Use GNU-style variable names
@@ -1339,17 +1642,17 @@ endif()
 # Example binaries
 #============================================================================
 
-if(ZLIB_ENABLE_TESTS)
+if(BUILD_TESTING)
     enable_testing()
 
     if(BUILD_SHARED_LIBS)
-        if(ZLIBNG_ENABLE_TESTS)
-            message(STATUS "Disabling zlib-ng tests because shared libraries are enabled")
-            set(ZLIBNG_ENABLE_TESTS OFF)
+        if(WITH_GTEST)
+            message(STATUS "Disabling gtest because only shared libraries are enabled")
+            set(WITH_GTEST OFF)
         endif()
 
         if(WITH_BENCHMARKS OR WITH_BENCHMARK_APPS)
-            message(STATUS "Disabling benchmarks because shared libraries are enabled")
+            message(STATUS "Disabling google benchmarks because only shared libraries are enabled")
             set(WITH_BENCHMARKS OFF)
             set(WITH_BENCHMARK_APPS OFF)
         endif()
@@ -1358,17 +1661,29 @@ if(ZLIB_ENABLE_TESTS)
     add_subdirectory(test)
 endif()
 
+#============================================================================
+# Config summary
+#============================================================================
+message("")
+message(STATUS "The following defines have been set (partial list):\n")
+get_property(propvalraw DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} PROPERTY COMPILE_DEFINITIONS)
+list(SORT propvalraw)
+string(REPLACE ";" " " propval "${propvalraw}")
+message("CURRENT_SOURCE_DIR: ${propval}\n")
+
 add_feature_info(WITH_GZFILEOP WITH_GZFILEOP "Compile with support for gzFile related functions")
 add_feature_info(ZLIB_COMPAT ZLIB_COMPAT "Compile with zlib compatible API")
-add_feature_info(ZLIB_ENABLE_TESTS ZLIB_ENABLE_TESTS "Build test binaries")
-add_feature_info(ZLIBNG_ENABLE_TESTS ZLIBNG_ENABLE_TESTS "Test zlib-ng specific API")
-add_feature_info(WITH_SANITIZER WITH_SANITIZER "Enable sanitizer support")
-add_feature_info(WITH_GTEST WITH_GTEST "Build gtest_zlib")
+add_feature_info(ZLIB_ALIASES ZLIB_ALIASES "Compile with zlib compatible CMake targets")
+add_feature_info(BUILD_TESTING BUILD_TESTING "Build test binaries")
+add_feature_info(WITH_SANITIZER WITH_SANITIZER "Enable sanitizer testing support")
+add_feature_info(WITH_GTEST WITH_GTEST "Build tests using Gtest framework")
 add_feature_info(WITH_FUZZERS WITH_FUZZERS "Build test/fuzz")
-add_feature_info(WITH_BENCHMARKS WITH_BENCHMARKS "Build test/benchmarks")
-add_feature_info(WITH_BENCHMARK_APPS WITH_BENCHMARK_APPS "Build application benchmarks")
+add_feature_info(WITH_BENCHMARKS WITH_BENCHMARKS "Build benchmarks using Google Benchmark framework")
+add_feature_info(WITH_BENCHMARK_APPS WITH_BENCHMARK_APPS "Build application benchmarks (currently libpng)")
+add_feature_info(WITH_ALL_FALLBACKS WITH_ALL_FALLBACKS "Build all generic fallback functions")
 add_feature_info(WITH_OPTIM WITH_OPTIM "Build with optimisation")
 add_feature_info(WITH_NEW_STRATEGIES WITH_NEW_STRATEGIES "Use new strategies")
+add_feature_info(WITH_CRC32_CHORBA WITH_CRC32_CHORBA "Use optimized CRC32 algorithm Chorba")
 add_feature_info(WITH_NATIVE_INSTRUCTIONS WITH_NATIVE_INSTRUCTIONS
     "Instruct the compiler to use the full instruction set on this host (gcc/clang -march=native)")
 add_feature_info(WITH_RUNTIME_CPU_DETECTION WITH_RUNTIME_CPU_DETECTION "Build with runtime CPU detection")
@@ -1378,33 +1693,39 @@ add_feature_info(WITH_INFLATE_STRICT WITH_INFLATE_STRICT "Build with strict infl
 add_feature_info(WITH_INFLATE_ALLOW_INVALID_DIST WITH_INFLATE_ALLOW_INVALID_DIST "Build with zero fill for inflate invalid distances")
 
 if(BASEARCH_ARM_FOUND)
-    add_feature_info(WITH_ACLE WITH_ACLE "Build with ACLE")
-    add_feature_info(WITH_NEON WITH_NEON "Build with NEON intrinsics")
     add_feature_info(WITH_ARMV6 WITH_ARMV6 "Build with ARMv6 SIMD")
+    add_feature_info(WITH_ARMV8 WITH_ARMV8 "Build with ARMv8 intrinsics")
+    add_feature_info(WITH_NEON WITH_NEON "Build with NEON intrinsics")
 elseif(BASEARCH_PPC_FOUND)
     add_feature_info(WITH_ALTIVEC WITH_ALTIVEC "Build with AltiVec optimisations")
     add_feature_info(WITH_POWER8 WITH_POWER8 "Build with optimisations for POWER8")
     add_feature_info(WITH_POWER9 WITH_POWER9 "Build with optimisations for POWER9")
 elseif(BASEARCH_RISCV_FOUND)
     add_feature_info(WITH_RVV WITH_RVV "Build with RVV intrinsics")
+    add_feature_info(WITH_RISCV_ZBC WITH_RISCV_ZBC "Build with RISCV ZBC")
 elseif(BASEARCH_S360_FOUND)
+    add_feature_info(WITH_CRC32_VX WITH_CRC32_VX "Build with vectorized CRC32 on IBM Z")
     add_feature_info(WITH_DFLTCC_DEFLATE WITH_DFLTCC_DEFLATE "Build with DFLTCC intrinsics for compression on IBM Z")
     add_feature_info(WITH_DFLTCC_INFLATE WITH_DFLTCC_INFLATE "Build with DFLTCC intrinsics for decompression on IBM Z")
-    add_feature_info(WITH_CRC32_VX WITH_CRC32_VX "Build with vectorized CRC32 on IBM Z")
+elseif(BASEARCH_LOONGARCH_FOUND)
+    add_feature_info(WITH_CRC32_LA WITH_CRC32_LA "Build with vectorized CRC32 on LoongArch")
+    add_feature_info(WITH_LSX WITH_LSX "Build with vectorized LSX on LoongArch")
+    add_feature_info(WITH_LASX WITH_LASX "Build with vectorized LASX on LoongArch")
 elseif(BASEARCH_X86_FOUND)
-    add_feature_info(WITH_AVX2 WITH_AVX2 "Build with AVX2")
-    add_feature_info(WITH_AVX512 WITH_AVX512 "Build with AVX512")
-    add_feature_info(WITH_AVX512VNNI WITH_AVX512VNNI "Build with AVX512 VNNI")
     add_feature_info(WITH_SSE2 WITH_SSE2 "Build with SSE2")
     add_feature_info(WITH_SSSE3 WITH_SSSE3 "Build with SSSE3")
+    add_feature_info(WITH_SSE41 WITH_SSE41 "Build with SSE41")
     add_feature_info(WITH_SSE42 WITH_SSE42 "Build with SSE42")
     add_feature_info(WITH_PCLMULQDQ WITH_PCLMULQDQ "Build with PCLMULQDQ")
+    add_feature_info(WITH_AVX2 WITH_AVX2 "Build with AVX2")
+    add_feature_info(WITH_AVX512 WITH_AVX512 "Build with AVX512")
+    add_feature_info(WITH_AVX512VNNI WITH_AVX512VNNI "Build with AVX512 VNNI")
     add_feature_info(WITH_VPCLMULQDQ WITH_VPCLMULQDQ "Build with VPCLMULQDQ")
 endif()
 
 add_feature_info(INSTALL_UTILS INSTALL_UTILS "Copy minigzip and minideflate during install")
 
-FEATURE_SUMMARY(WHAT ALL INCLUDE_QUIET_PACKAGES)
+feature_summary(WHAT ALL INCLUDE_QUIET_PACKAGES)
 
 #============================================================================
 # CPack
diff --git a/Makefile.in b/Makefile.in
index 41f3e924..9c4463d2 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -30,7 +30,7 @@ LDSHARED=$(CC)
 LDSHAREDFLAGS=-shared
 LDVERSIONSCRIPT=
 
-VER=2.2.1
+VER=2.3.1
 VER1=2
 
 STATICLIB=$(LIBNAME1).a
@@ -76,11 +76,9 @@ pkgconfigdir = ${libdir}/pkgconfig
 
 OBJZ = \
 	arch/generic/adler32_c.o \
-	arch/generic/adler32_fold_c.o \
 	arch/generic/chunkset_c.o \
 	arch/generic/compare256_c.o \
 	arch/generic/crc32_braid_c.o \
-	arch/generic/crc32_fold_c.o \
 	arch/generic/slide_hash_c.o \
 	adler32.o \
 	compress.o \
@@ -99,10 +97,10 @@ OBJZ = \
 	inflate.o \
 	inftrees.o \
 	insert_string.o \
-	insert_string_roll.o \
 	trees.o \
 	uncompr.o \
 	zutil.o \
+	arch/generic/crc32_chorba_c.o \
 	cpu_features.o \
 	$(ARCH_STATIC_OBJS)
 
@@ -116,11 +114,9 @@ OBJC = $(OBJZ) $(OBJG)
 
 PIC_OBJZ = \
 	arch/generic/adler32_c.lo \
-	arch/generic/adler32_fold_c.lo \
 	arch/generic/chunkset_c.lo \
 	arch/generic/compare256_c.lo \
 	arch/generic/crc32_braid_c.lo \
-	arch/generic/crc32_fold_c.lo \
 	arch/generic/slide_hash_c.lo \
 	adler32.lo \
 	compress.lo \
@@ -139,10 +135,10 @@ PIC_OBJZ = \
 	inflate.lo \
 	inftrees.lo \
 	insert_string.lo \
-	insert_string_roll.lo \
 	trees.lo \
 	uncompr.lo \
 	zutil.lo \
+	arch/generic/crc32_chorba_c.lo \
 	cpu_features.lo \
 	$(ARCH_SHARED_OBJS)
 
@@ -239,10 +235,10 @@ gzlib.o: $(SRCDIR)/gzlib.c
 gzlib.lo: $(SRCDIR)/gzlib.c
 	$(CC) $(SFLAGS) -DPIC -DWITH_GZFILEOP $(INCLUDES) -c -o $@ $<
 
-gzread.o: gzread.c
+gzread.o: $(SRCDIR)/gzread.c
 	$(CC) $(CFLAGS) -DWITH_GZFILEOP $(INCLUDES) -c -o $@ $<
 
-gzread.lo: gzread.c
+gzread.lo: $(SRCDIR)/gzread.c
 	$(CC) $(SFLAGS) -DPIC -DWITH_GZFILEOP $(INCLUDES) -c -o $@ $<
 
 gzwrite.o: $(SRCDIR)/gzwrite.c
@@ -385,7 +381,7 @@ maintainer-clean: distclean
 distclean: clean
 	@if [ -f $(ARCHDIR)/Makefile ]; then $(MAKE) -C $(ARCHDIR) distclean; fi
 	@if [ -f test/Makefile ]; then $(MAKE) -C test distclean; fi
-	rm -f $(PKGFILE) configure.log zconf.h zconf.h.cmakein zlib$(SUFFIX).h zlib_name_mangling$(SUFFIX).h *.pc gzread.c
+	rm -f $(PKGFILE) configure.log zconf.h zconf.h.cmakein zlib$(SUFFIX).h zlib_name_mangling$(SUFFIX).h *.pc gzread_mangle.h zlib${SUFFIX}.map
 	-@rm -f .DS_Store
 # Reset Makefile if building inside source tree
 	@if [ -f Makefile.in ]; then \
diff --git a/README.md b/README.md
index 411621b5..023da4f7 100644
--- a/README.md
+++ b/README.md
@@ -1,6 +1,6 @@
 | CI | Stable | Develop |
 |:---|:-------|:--------|
-| GitHub Actions | [![Stable CMake](https://github.com/zlib-ng/zlib-ng/actions/workflows/cmake.yml/badge.svg?branch=stable)](https://github.com/zlib-ng/zlib-ng/actions/workflows/cmake.yml?query=branch%3Astable) <br> [![Stable Configure](https://github.com/zlib-ng/zlib-ng/actions/workflows/configure.yml/badge.svg?branch=stable)](https://github.com/zlib-ng/zlib-ng/actions/workflows/configure.yml?query=branch%3Astable) <br> [![Stable NMake](https://github.com/zlib-ng/zlib-ng/actions/workflows/nmake.yml/badge.svg?branch=stable)](https://github.com/zlib-ng/zlib-ng/actions/workflows/nmake.yml?query=branch%3Astable) | [![Develop CMake](https://github.com/zlib-ng/zlib-ng/actions/workflows/cmake.yml/badge.svg?branch=develop)](https://github.com/zlib-ng/zlib-ng/actions/workflows/cmake.yml?query=branch%3Adevelop) <br> [![Develop Configure](https://github.com/zlib-ng/zlib-ng/actions/workflows/configure.yml/badge.svg?branch=develop)](https://github.com/zlib-ng/zlib-ng/actions/workflows/configure.yml?query=branch%3Adevelop) <br> [![Develop NMake](https://github.com/zlib-ng/zlib-ng/actions/workflows/nmake.yml/badge.svg?branch=develop)](https://github.com/zlib-ng/zlib-ng/actions/workflows/nmake.yml?query=branch%3Adevelop) |
+| GitHub Actions | [![Stable CMake](https://github.com/zlib-ng/zlib-ng/actions/workflows/cmake.yml/badge.svg?branch=stable)](https://github.com/zlib-ng/zlib-ng/actions/workflows/cmake.yml?query=branch%3Astable) <br> [![Stable Configure](https://github.com/zlib-ng/zlib-ng/actions/workflows/configure.yml/badge.svg?branch=stable)](https://github.com/zlib-ng/zlib-ng/actions/workflows/configure.yml?query=branch%3Astable) | [![Develop CMake](https://github.com/zlib-ng/zlib-ng/actions/workflows/cmake.yml/badge.svg?branch=develop)](https://github.com/zlib-ng/zlib-ng/actions/workflows/cmake.yml?query=branch%3Adevelop) <br> [![Develop Configure](https://github.com/zlib-ng/zlib-ng/actions/workflows/configure.yml/badge.svg?branch=develop)](https://github.com/zlib-ng/zlib-ng/actions/workflows/configure.yml?query=branch%3Adevelop) |
 | CodeFactor     | [![CodeFactor](https://www.codefactor.io/repository/github/zlib-ng/zlib-ng/badge/stable)](https://www.codefactor.io/repository/github/zlib-ng/zlib-ng/overview/stable) | [![CodeFactor](https://www.codefactor.io/repository/github/zlib-ng/zlib-ng/badge/develop)](https://www.codefactor.io/repository/github/zlib-ng/zlib-ng/overview/develop) |
 | OSS-Fuzz       | [![Fuzzing Status](https://oss-fuzz-build-logs.storage.googleapis.com/badges/zlib-ng.svg)](https://bugs.chromium.org/p/oss-fuzz/issues/list?sort=-opened&can=1&q=proj:zlib-ng) | [![Fuzzing Status](https://oss-fuzz-build-logs.storage.googleapis.com/badges/zlib-ng.svg)](https://bugs.chromium.org/p/oss-fuzz/issues/list?sort=-opened&can=1&q=proj:zlib-ng) |
 | Codecov        | [![codecov](https://codecov.io/github/zlib-ng/zlib-ng/branch/stable/graph/badge.svg?token=uKsgK9LIuC)](https://codecov.io/github/zlib-ng/zlib-ng/tree/stable) | [![codecov](https://codecov.io/github/zlib-ng/zlib-ng/branch/develop/graph/badge.svg?token=uKsgK9LIuC)](https://codecov.io/github/zlib-ng/zlib-ng/tree/develop) |
@@ -19,19 +19,19 @@ Features
 * Modern C11 syntax and a clean code layout
 * Deflate medium and quick algorithms based on Intels zlib fork
 * Support for CPU intrinsics when available
-  * Adler32 implementation using SSSE3, AVX2, AVX512, AVX512-VNNI, Neon, VMX & VSX
-  * CRC32-B implementation using PCLMULQDQ, VPCLMULQDQ, ACLE, & IBM Z
-  * Slide hash implementations using SSE2, AVX2, ARMv6, Neon, VMX & VSX
-  * Compare256 implementations using SSE2, AVX2, Neon, POWER9 & RVV
-  * Inflate chunk copying using SSE2, SSSE3, AVX, Neon & VSX
+  * Adler32 implementation using SSSE3, SSE4.2, AVX2, AVX512, AVX512-VNNI, Neon, VMX & VSX, LSX, LASX, RVV
+  * CRC32-B implementation using SSE2, SSE4.1, (V)PCLMULQDQ, ARMv8, ARMv8.2 PMULL+EOR3, Power8, IBM Z, LoongArch, ZBC
+  * Slide hash implementations using SSE2, AVX2, ARMv6, Neon, Power8, VMX & VSX, LSX, LASX
+  * Compare256 implementations using SSE2, AVX2, AVX512, Neon, Power9, LSX, LASX, RVV
+  * Inflate chunk copying using SSE2, SSSE3, AVX2, AVX512, Neon, Power8, VSX, LSX, LASX, RVV
   * Support for hardware-accelerated deflate using IBM Z DFLTCC
-* Unaligned memory read/writes and large bit buffer improvements
+* Safe unaligned memory read/writes and large bit buffer improvements
 * Includes improvements from Cloudflare and Intel forks
-* Configure, CMake, and NMake build system support
+* Configure and CMake build system support
 * Comprehensive set of CMake unit tests
 * Code sanitizers, fuzzing, and coverage
 * GitHub Actions continuous integration on Windows, macOS, and Linux
-  * Emulated CI for ARM, AARCH64, PPC, PPC64, RISCV, SPARC64, S390x using qemu
+  * Emulated CI for ARM, AARCH64, LoongArch, PPC, PPC64, RISCV, SPARC64, S390x using qemu
 
 
 History
@@ -97,18 +97,16 @@ Build Options
 | CMake                      | configure                | Description                                                                         | Default |
 |:---------------------------|:-------------------------|:------------------------------------------------------------------------------------|---------|
 | ZLIB_COMPAT                | --zlib-compat            | Compile with zlib compatible API                                                    | OFF     |
-| ZLIB_ENABLE_TESTS          |                          | Build test binaries                                                                 | ON      |
+| ZLIB_ALIASES               |                          | Provide zlib compatible CMake targets                                               | ON      |
 | WITH_GZFILEOP              | --without-gzfileops      | Compile with support for gzFile related functions                                   | ON      |
 | WITH_OPTIM                 | --without-optimizations  | Build with optimisations                                                            | ON      |
 | WITH_NEW_STRATEGIES        | --without-new-strategies | Use new strategies                                                                  | ON      |
-| WITH_NATIVE_INSTRUCTIONS   |                          | Compiles with full instruction set supported on this host (gcc/clang -march=native) | OFF     |
-| WITH_RUNTIME_CPU_DETECTION |                          | Compiles with runtime CPU detection                                                 | ON      |
-| WITH_SANITIZER             |                          | Build with sanitizer (memory, address, undefined)                                   | OFF     |
-| WITH_GTEST                 |                          | Build gtest_zlib                                                                    | ON      |
-| WITH_FUZZERS               |                          | Build test/fuzz                                                                     | OFF     |
-| WITH_BENCHMARKS            |                          | Build test/benchmarks                                                               | OFF     |
-| WITH_MAINTAINER_WARNINGS   |                          | Build with project maintainer warnings                                              | OFF     |
-| WITH_CODE_COVERAGE         |                          | Enable code coverage reporting                                                      | OFF     |
+| WITH_CRC32_CHORBA          |                          | Build with Chorba optimized CRC32                                                   | ON      |
+| WITH_REDUCED_MEM           | --with-reduced-mem       | Reduce zlib-ng memory usage, affects performance and compression ratio              | OFF     |
+| WITH_GTEST                 |                          | Build tests using GTest framework                                                   | ON      |
+| WITH_BENCHMARKS            |                          | Build benchmarks using Google Benchmark framework                                   | OFF     |
+| INSTALL_UTILS              |                          | Copy minigzip and minideflate during install                                        | OFF     |
+| BUILD_TESTING              |                          | Build test binaries                                                                 | ON      |
 
 
 Install
@@ -193,31 +191,40 @@ zlib was originally created by Jean-loup Gailly (compression) and Mark Adler (de
 Advanced Build Options
 ----------------------
 
-| CMake                           | configure             | Description                                                         | Default                |
-|:--------------------------------|:----------------------|:--------------------------------------------------------------------|------------------------|
-| FORCE_SSE2                      | --force-sse2          | Skip runtime check for SSE2 instructions (Always on for x86_64)     | OFF (x86)              |
-| WITH_AVX2                       |                       | Build with AVX2 intrinsics                                          | ON                     |
-| WITH_AVX512                     |                       | Build with AVX512 intrinsics                                        | ON                     |
-| WITH_AVX512VNNI                 |                       | Build with AVX512VNNI intrinsics                                    | ON                     |
-| WITH_SSE2                       |                       | Build with SSE2 intrinsics                                          | ON                     |
-| WITH_SSSE3                      |                       | Build with SSSE3 intrinsics                                         | ON                     |
-| WITH_SSE42                      |                       | Build with SSE42 intrinsics                                         | ON                     |
-| WITH_PCLMULQDQ                  |                       | Build with PCLMULQDQ intrinsics                                     | ON                     |
-| WITH_VPCLMULQDQ                 | --without-vpclmulqdq  | Build with VPCLMULQDQ intrinsics                                    | ON                     |
-| WITH_ACLE                       | --without-acle        | Build with ACLE intrinsics                                          | ON                     |
-| WITH_NEON                       | --without-neon        | Build with NEON intrinsics                                          | ON                     |
-| WITH_ARMV6                      | --without-armv6       | Build with ARMv6 intrinsics                                         | ON                     |
-| WITH_ALTIVEC                    | --without-altivec     | Build with AltiVec (VMX) intrinsics                                 | ON                     |
-| WITH_POWER8                     | --without-power8      | Build with POWER8 optimisations                                     | ON                     |
-| WITH_RVV                        |                       | Build with RVV intrinsics                                           | ON                     |
-| WITH_CRC32_VX                   | --without-crc32-vx    | Build with vectorized CRC32 on IBM Z                                | ON                     |
-| WITH_DFLTCC_DEFLATE             | --with-dfltcc-deflate | Build with DFLTCC intrinsics for compression on IBM Z               | OFF                    |
-| WITH_DFLTCC_INFLATE             | --with-dfltcc-inflate | Build with DFLTCC intrinsics for decompression on IBM Z             | OFF                    |
-| WITH_UNALIGNED                  | --without-unaligned   | Allow optimizations that use unaligned reads if safe on current arch| ON                     |
-| WITH_INFLATE_STRICT             |                       | Build with strict inflate distance checking                         | OFF                    |
-| WITH_INFLATE_ALLOW_INVALID_DIST |                       | Build with zero fill for inflate invalid distances                  | OFF                    |
-| INSTALL_UTILS                   |                       | Copy minigzip and minideflate during install                        | OFF                    |
-| ZLIBNG_ENABLE_TESTS             |                       | Test zlib-ng specific API                                           | ON                     |
+| CMake                           | configure             | Description                                                                         | Default  |
+|:--------------------------------|:----------------------|:------------------------------------------------------------------------------------|----------|
+| WITH_NATIVE_INSTRUCTIONS        |                       | Compiles with full instruction set supported on this host (gcc/clang -march=native) | OFF      |
+| WITH_RUNTIME_CPU_DETECTION      |                       | Compiles with runtime CPU detection                                                 | ON       |
+| WITH_SSE2                       |                       | x86: Build with SSE2 intrinsics                                                     | ON       |
+| WITH_SSSE3                      |                       | x86: Build with SSSE3 intrinsics                                                    | ON       |
+| WITH_SSE41                      |                       | x86: Build with SSE41 intrinsics                                                    | ON       |
+| WITH_SSE42                      |                       | x86: Build with SSE42 intrinsics                                                    | ON       |
+| WITH_PCLMULQDQ                  |                       | x86: Build with PCLMULQDQ intrinsics                                                | ON       |
+| WITH_AVX2                       |                       | x86: Build with AVX2 intrinsics                                                     | ON       |
+| WITH_AVX512                     |                       | x86: Build with AVX512 intrinsics                                                   | ON       |
+| WITH_AVX512VNNI                 |                       | x86: Build with AVX512VNNI intrinsics                                               | ON       |
+| WITH_VPCLMULQDQ                 |                       | x86: Build with VPCLMULQDQ intrinsics                                               | ON       |
+| WITH_ARMV6                      | --without-armv6       | arm: Build with ARMv6 intrinsics                                                    | ON       |
+| WITH_ARMV8                      | --without-armv8       | arm: Build with ARMv8 intrinsics                                                    | ON       |
+| WITH_NEON                       | --without-neon        | arm: Build with NEON intrinsics                                                     | ON       |
+| WITH_ALTIVEC                    | --without-altivec     | ppc: Build with AltiVec (VMX) intrinsics                                            | ON       |
+| WITH_POWER8                     | --without-power8      | ppc: Build with POWER8 intrinsics                                                   | ON       |
+| WITH_POWER9                     | --without-power9      | ppc: Build with POWER9 intrinsics                                                   | ON       |
+| WITH_RVV                        | --without-rvv         | riscv: Build with RVV intrinsics                                                    | ON       |
+| WITH_RISCV_ZBC                  | --without-zbc         | riscv: Build with RiscV ZBC intrinsics                                              | ON       |
+| WITH_CRC32_VX                   | --without-crc32-vx    | s390x: Build with vectorized CRC32 on IBM Z                                         | ON       |
+| WITH_DFLTCC_DEFLATE             | --with-dfltcc-deflate | s390x: Build with DFLTCC intrinsics for compression on IBM Z                        | OFF      |
+| WITH_DFLTCC_INFLATE             | --with-dfltcc-inflate | s390x: Build with DFLTCC intrinsics for decompression on IBM Z                      | OFF      |
+| WITH_LSX                        |                       | loongarch: Build with LSX intrinsics                                                | ON       |
+| WITH_CRC32_LA                   | --without-crc32-la    | loongarch: Build with vectorized CRC32                                              | ON       |
+| WITH_INFLATE_STRICT             |                       | Build with strict inflate distance checking                                         | OFF      |
+| WITH_INFLATE_ALLOW_INVALID_DIST |                       | Build with zero fill for inflate invalid distances                                  | OFF      |
+| WITH_BENCHMARK_APPS             |                       | Build benchmark apps (currently libpng)                                             | OFF      |
+| WITH_ALL_FALLBACKS              |                       | Build with all c-fallbacks (useful for Gbench comparisons)                          | OFF      |
+| WITH_MAINTAINER_WARNINGS        |                       | Build with project maintainer warnings                                              | OFF      |
+| WITH_SANITIZER                  |                       | Build with sanitizer (memory, address, undefined)                                   | OFF      |
+| WITH_FUZZERS                    |                       | Build test/fuzz                                                                     | OFF      |
+| WITH_CODE_COVERAGE              |                       | Enable code coverage reporting                                                      | OFF      |
 
 
 Related Projects
diff --git a/adler32.c b/adler32.c
index 1a643ed5..3e3dfca7 100644
--- a/adler32.c
+++ b/adler32.c
@@ -9,10 +9,14 @@
 
 #ifdef ZLIB_COMPAT
 unsigned long Z_EXPORT PREFIX(adler32_z)(unsigned long adler, const unsigned char *buf, size_t len) {
+    if (buf == NULL)
+        return ADLER32_INITIAL_VALUE;
     return (unsigned long)FUNCTABLE_CALL(adler32)((uint32_t)adler, buf, len);
 }
 #else
 uint32_t Z_EXPORT PREFIX(adler32_z)(uint32_t adler, const unsigned char *buf, size_t len) {
+    if (buf == NULL)
+        return ADLER32_INITIAL_VALUE;
     return FUNCTABLE_CALL(adler32)(adler, buf, len);
 }
 #endif
@@ -20,10 +24,14 @@ uint32_t Z_EXPORT PREFIX(adler32_z)(uint32_t adler, const unsigned char *buf, si
 /* ========================================================================= */
 #ifdef ZLIB_COMPAT
 unsigned long Z_EXPORT PREFIX(adler32)(unsigned long adler, const unsigned char *buf, unsigned int len) {
+    if (buf == NULL)
+        return ADLER32_INITIAL_VALUE;
     return (unsigned long)FUNCTABLE_CALL(adler32)((uint32_t)adler, buf, len);
 }
 #else
 uint32_t Z_EXPORT PREFIX(adler32)(uint32_t adler, const unsigned char *buf, uint32_t len) {
+    if (buf == NULL)
+        return ADLER32_INITIAL_VALUE;
     return FUNCTABLE_CALL(adler32)(adler, buf, len);
 }
 #endif
diff --git a/adler32_p.h b/adler32_p.h
index 38ba2ad7..12fb0ddf 100644
--- a/adler32_p.h
+++ b/adler32_p.h
@@ -12,36 +12,31 @@
 #define NMAX 5552
 /* NMAX is the largest n such that 255n(n+1)/2 + (n+1)(BASE-1) <= 2^32-1 */
 
-#define DO1(sum1, sum2, buf, i)  {(sum1) += buf[(i)]; (sum2) += (sum1);}
-#define DO2(sum1, sum2, buf, i)  {DO1(sum1, sum2, buf, i); DO1(sum1, sum2, buf, i+1);}
-#define DO4(sum1, sum2, buf, i)  {DO2(sum1, sum2, buf, i); DO2(sum1, sum2, buf, i+2);}
-#define DO8(sum1, sum2, buf, i)  {DO4(sum1, sum2, buf, i); DO4(sum1, sum2, buf, i+4);}
-#define DO16(sum1, sum2, buf)    {DO8(sum1, sum2, buf, 0); DO8(sum1, sum2, buf, 8);}
+#define ADLER_DO1(sum1, sum2, buf, i)  {(sum1) += buf[(i)]; (sum2) += (sum1);}
+#define ADLER_DO2(sum1, sum2, buf, i)  {ADLER_DO1(sum1, sum2, buf, i); ADLER_DO1(sum1, sum2, buf, i+1);}
+#define ADLER_DO4(sum1, sum2, buf, i)  {ADLER_DO2(sum1, sum2, buf, i); ADLER_DO2(sum1, sum2, buf, i+2);}
+#define ADLER_DO8(sum1, sum2, buf, i)  {ADLER_DO4(sum1, sum2, buf, i); ADLER_DO4(sum1, sum2, buf, i+4);}
+#define ADLER_DO16(sum1, sum2, buf)    {ADLER_DO8(sum1, sum2, buf, 0); ADLER_DO8(sum1, sum2, buf, 8);}
 
-static inline uint32_t adler32_len_1(uint32_t adler, const uint8_t *buf, uint32_t sum2) {
-    adler += buf[0];
+static inline uint32_t adler32_copy_len_1(uint32_t adler, uint8_t *dst, const uint8_t *buf, uint32_t sum2, const int COPY) {
+    uint8_t c = *buf;
+    if (COPY) {
+        *dst = c;
+    }
+    adler += c;
     adler %= BASE;
     sum2 += adler;
     sum2 %= BASE;
     return adler | (sum2 << 16);
 }
 
-static inline uint32_t adler32_len_16(uint32_t adler, const uint8_t *buf, size_t len, uint32_t sum2) {
-    while (len) {
-        --len;
-        adler += *buf++;
-        sum2 += adler;
-    }
-    adler %= BASE;
-    sum2 %= BASE;            /* only added so many BASE's */
-    /* return recombined sums */
-    return adler | (sum2 << 16);
-}
-
-static inline uint32_t adler32_copy_len_16(uint32_t adler, const uint8_t *buf, uint8_t *dst, size_t len, uint32_t sum2) {
+static inline uint32_t adler32_copy_len_16(uint32_t adler, uint8_t *dst, const uint8_t *buf, size_t len, uint32_t sum2, const int COPY) {
     while (len--) {
-        *dst = *buf++;
-        adler += *dst++;
+        uint8_t c = *buf++;
+        if (COPY) {
+            *dst++ = c;
+        }
+        adler += c;
         sum2 += adler;
     }
     adler %= BASE;
@@ -50,21 +45,27 @@ static inline uint32_t adler32_copy_len_16(uint32_t adler, const uint8_t *buf, u
     return adler | (sum2 << 16);
 }
 
-static inline uint32_t adler32_len_64(uint32_t adler, const uint8_t *buf, size_t len, uint32_t sum2) {
+static inline uint32_t adler32_copy_len_64(uint32_t adler, uint8_t *dst, const uint8_t *buf, size_t len, uint32_t sum2, const int COPY) {
+    const uint8_t *src = buf;
+    const size_t src_len = len;
 #ifdef UNROLL_MORE
     while (len >= 16) {
         len -= 16;
-        DO16(adler, sum2, buf);
+        ADLER_DO16(adler, sum2, buf);
         buf += 16;
 #else
     while (len >= 8) {
         len -= 8;
-        DO8(adler, sum2, buf, 0);
+        ADLER_DO8(adler, sum2, buf, 0);
         buf += 8;
 #endif
     }
     /* Process tail (len < 16).  */
-    return adler32_len_16(adler, buf, len, sum2);
+    adler = adler32_copy_len_16(adler, NULL, buf, len, sum2, 0);
+    if (COPY) {
+        memcpy(dst, src, src_len);
+    }
+    return adler;
 }
 
 #endif /* ADLER32_P_H */
diff --git a/arch/arm/Makefile.in b/arch/arm/Makefile.in
index b6f0aaf2..d0bfe0e1 100644
--- a/arch/arm/Makefile.in
+++ b/arch/arm/Makefile.in
@@ -8,7 +8,8 @@ SFLAGS=
 INCLUDES=
 SUFFIX=
 
-ACLEFLAG=
+ARMV8FLAG=
+PMULLEOR3FLAG=
 NEONFLAG=
 ARMV6FLAG=
 NOLTOFLAG=
@@ -22,7 +23,8 @@ all: \
 	arm_features.o arm_features.lo \
 	chunkset_neon.o chunkset_neon.lo \
 	compare256_neon.o compare256_neon.lo \
-	crc32_acle.o crc32_acle.lo \
+	crc32_armv8.o crc32_armv8.lo \
+	crc32_armv8_pmull_eor3.o crc32_armv8_pmull_eor3.lo \
 	slide_hash_neon.o slide_hash_neon.lo \
 	slide_hash_armv6.o slide_hash_armv6.lo \
 
@@ -50,11 +52,17 @@ compare256_neon.o:
 compare256_neon.lo:
 	$(CC) $(SFLAGS) $(NEONFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_neon.c
 
-crc32_acle.o:
-	$(CC) $(CFLAGS) $(ACLEFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_acle.c
+crc32_armv8.o:
+	$(CC) $(CFLAGS) $(ARMV8FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_armv8.c
 
-crc32_acle.lo:
-	$(CC) $(SFLAGS) $(ACLEFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_acle.c
+crc32_armv8.lo:
+	$(CC) $(SFLAGS) $(ARMV8FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_armv8.c
+
+crc32_armv8_pmull_eor3.o:
+	$(CC) $(CFLAGS) $(PMULLEOR3FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_armv8_pmull_eor3.c
+
+crc32_armv8_pmull_eor3.lo:
+	$(CC) $(SFLAGS) $(PMULLEOR3FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_armv8_pmull_eor3.c
 
 slide_hash_neon.o:
 	$(CC) $(CFLAGS) $(NEONFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/slide_hash_neon.c
diff --git a/arch/arm/acle_intrins.h b/arch/arm/acle_intrins.h
index a67cf3aa..16f5e2c7 100644
--- a/arch/arm/acle_intrins.h
+++ b/arch/arm/acle_intrins.h
@@ -8,12 +8,67 @@
 #  include <arm_acle.h>
 #endif
 
-#ifdef ARM_ACLE
-#if defined(__aarch64__)
+#ifdef ARM_CRC32
+#if defined(ARCH_ARM) && defined(ARCH_64BIT)
 #  define Z_TARGET_CRC Z_TARGET("+crc")
 #else
 #  define Z_TARGET_CRC
 #endif
+#ifdef ARM_PMULL_EOR3
+#  define Z_TARGET_PMULL_EOR3 Z_TARGET("+crc+crypto+sha3")
+#else
+#  define Z_TARGET_PMULL_EOR3
+#endif
+
+#if !defined(ARM_CRC32_INTRIN) && !defined(_MSC_VER)
+#if defined(ARCH_ARM) && defined(ARCH_64BIT)
+static inline uint32_t __crc32b(uint32_t __a, uint8_t __b) {
+    uint32_t __c;
+    __asm__("crc32b %w0, %w1, %w2" : "=r" (__c) : "r"(__a), "r"(__b));
+    return __c;
+}
+
+static inline uint32_t __crc32h(uint32_t __a, uint16_t __b) {
+    uint32_t __c;
+    __asm__("crc32h %w0, %w1, %w2" : "=r" (__c) : "r"(__a), "r"(__b));
+    return __c;
+}
+
+static inline uint32_t __crc32w(uint32_t __a, uint32_t __b) {
+    uint32_t __c;
+    __asm__("crc32w %w0, %w1, %w2" : "=r" (__c) : "r"(__a), "r"(__b));
+    return __c;
+}
+
+static inline uint32_t __crc32d(uint32_t __a, uint64_t __b) {
+    uint32_t __c;
+    __asm__("crc32x %w0, %w1, %x2" : "=r" (__c) : "r"(__a), "r"(__b));
+    return __c;
+}
+#else
+static inline uint32_t __crc32b(uint32_t __a, uint8_t __b) {
+    uint32_t __c;
+    __asm__("crc32b %0, %1, %2" : "=r" (__c) : "r"(__a), "r"(__b));
+    return __c;
+}
+
+static inline uint32_t __crc32h(uint32_t __a, uint16_t __b) {
+    uint32_t __c;
+    __asm__("crc32h %0, %1, %2" : "=r" (__c) : "r"(__a), "r"(__b));
+    return __c;
+}
+
+static inline uint32_t __crc32w(uint32_t __a, uint32_t __b) {
+    uint32_t __c;
+    __asm__("crc32w %0, %1, %2" : "=r" (__c) : "r"(__a), "r"(__b));
+    return __c;
+}
+
+static inline uint32_t __crc32d(uint32_t __a, uint64_t __b) {
+    return __crc32w (__crc32w (__a, __b & 0xffffffffULL), __b >> 32);
+}
+#endif
+#endif
 #endif
 
 #ifdef ARM_SIMD
@@ -26,7 +81,7 @@ typedef uint32_t uint16x2_t;
 
 static inline uint16x2_t __uqsub16(uint16x2_t __a, uint16x2_t __b) {
     uint16x2_t __c;
-    __asm__ __volatile__("uqsub16 %0, %1, %2" : "=r" (__c) : "r"(__a), "r"(__b));
+    __asm__("uqsub16 %0, %1, %2" : "=r" (__c) : "r"(__a), "r"(__b));
     return __c;
 }
 #endif
diff --git a/arch/arm/adler32_neon.c b/arch/arm/adler32_neon.c
index 8e46b380..0b41e4d2 100644
--- a/arch/arm/adler32_neon.c
+++ b/arch/arm/adler32_neon.c
@@ -10,17 +10,141 @@
 #include "zbuild.h"
 #include "adler32_p.h"
 
-static void NEON_accum32(uint32_t *s, const uint8_t *buf, size_t len) {
-    static const uint16_t ALIGNED_(16) taps[64] = {
-        64, 63, 62, 61, 60, 59, 58, 57,
-        56, 55, 54, 53, 52, 51, 50, 49,
-        48, 47, 46, 45, 44, 43, 42, 41,
-        40, 39, 38, 37, 36, 35, 34, 33,
-        32, 31, 30, 29, 28, 27, 26, 25,
-        24, 23, 22, 21, 20, 19, 18, 17,
-        16, 15, 14, 13, 12, 11, 10, 9,
-        8, 7, 6, 5, 4, 3, 2, 1 };
+static const uint16_t ALIGNED_(64) taps[64] = {
+    64, 63, 62, 61, 60, 59, 58, 57,
+    56, 55, 54, 53, 52, 51, 50, 49,
+    48, 47, 46, 45, 44, 43, 42, 41,
+    40, 39, 38, 37, 36, 35, 34, 33,
+    32, 31, 30, 29, 28, 27, 26, 25,
+    24, 23, 22, 21, 20, 19, 18, 17,
+    16, 15, 14, 13, 12, 11, 10, 9,
+    8, 7, 6, 5, 4, 3, 2, 1 };
+
+Z_FORCEINLINE static void NEON_accum32_copy(uint32_t *s, uint8_t *dst, const uint8_t *buf, size_t len) {
+    uint32x4_t adacc = vdupq_n_u32(0);
+    uint32x4_t s2acc = vdupq_n_u32(0);
+    uint32x4_t s2acc_0 = vdupq_n_u32(0);
+    uint32x4_t s2acc_1 = vdupq_n_u32(0);
+    uint32x4_t s2acc_2 = vdupq_n_u32(0);
+
+    adacc = vsetq_lane_u32(s[0], adacc, 0);
+    s2acc = vsetq_lane_u32(s[1], s2acc, 0);
+
+    uint32x4_t s3acc = vdupq_n_u32(0);
+    uint32x4_t adacc_prev = adacc;
+
+    uint16x8_t s2_0, s2_1, s2_2, s2_3;
+    s2_0 = s2_1 = s2_2 = s2_3 = vdupq_n_u16(0);
+
+    uint16x8_t s2_4, s2_5, s2_6, s2_7;
+    s2_4 = s2_5 = s2_6 = s2_7 = vdupq_n_u16(0);
+
+    size_t num_iter = len >> 2;
+    int rem = len & 3;
+
+    for (size_t i = 0; i < num_iter; ++i) {
+        uint8x16_t d0 = vld1q_u8(buf);
+        uint8x16_t d1 = vld1q_u8(buf + 16);
+        uint8x16_t d2 = vld1q_u8(buf + 32);
+        uint8x16_t d3 = vld1q_u8(buf + 48);
+
+        vst1q_u8(dst, d0);
+        vst1q_u8(dst + 16, d1);
+        vst1q_u8(dst + 32, d2);
+        vst1q_u8(dst + 48, d3);
+        dst += 64;
+
+        /* Unfortunately it doesn't look like there's a direct sum 8 bit to 32
+         * bit instruction, we'll have to make due summing to 16 bits first */
+        uint16x8x2_t hsum, hsum_fold;
+        hsum.val[0] = vpaddlq_u8(d0);
+        hsum.val[1] = vpaddlq_u8(d1);
+
+        hsum_fold.val[0] = vpadalq_u8(hsum.val[0], d2);
+        hsum_fold.val[1] = vpadalq_u8(hsum.val[1], d3);
+
+        adacc = vpadalq_u16(adacc, hsum_fold.val[0]);
+        s3acc = vaddq_u32(s3acc, adacc_prev);
+        adacc = vpadalq_u16(adacc, hsum_fold.val[1]);
+
+        /* If we do straight widening additions to the 16 bit values, we don't incur
+         * the usual penalties of a pairwise add. We can defer the multiplications
+         * until the very end. These will not overflow because we are incurring at
+         * most 408 loop iterations (NMAX / 64), and a given lane is only going to be
+         * summed into once. This means for the maximum input size, the largest value
+         * we will see is 255 * 102 = 26010, safely under uint16 max */
+        s2_0 = vaddw_u8(s2_0, vget_low_u8(d0));
+        s2_1 = vaddw_high_u8(s2_1, d0);
+        s2_2 = vaddw_u8(s2_2, vget_low_u8(d1));
+        s2_3 = vaddw_high_u8(s2_3, d1);
+        s2_4 = vaddw_u8(s2_4, vget_low_u8(d2));
+        s2_5 = vaddw_high_u8(s2_5, d2);
+        s2_6 = vaddw_u8(s2_6, vget_low_u8(d3));
+        s2_7 = vaddw_high_u8(s2_7, d3);
+
+        adacc_prev = adacc;
+        buf += 64;
+    }
+
+    s3acc = vshlq_n_u32(s3acc, 6);
+
+    if (rem) {
+        uint32x4_t s3acc_0 = vdupq_n_u32(0);
+        while (rem--) {
+            uint8x16_t d0 = vld1q_u8(buf);
+            vst1q_u8(dst, d0);
+            dst += 16;
+            uint16x8_t adler;
+            adler = vpaddlq_u8(d0);
+            s2_6 = vaddw_u8(s2_6, vget_low_u8(d0));
+            s2_7 = vaddw_high_u8(s2_7, d0);
+            adacc = vpadalq_u16(adacc, adler);
+            s3acc_0 = vaddq_u32(s3acc_0, adacc_prev);
+            adacc_prev = adacc;
+            buf += 16;
+        }
+
+        s3acc_0 = vshlq_n_u32(s3acc_0, 4);
+        s3acc = vaddq_u32(s3acc_0, s3acc);
+    }
+
+    uint16x8x4_t t0_t3 = vld1q_u16_x4(taps);
+    uint16x8x4_t t4_t7 = vld1q_u16_x4(taps + 32);
+
+    s2acc = vmlal_high_u16(s2acc, t0_t3.val[0], s2_0);
+    s2acc_0 = vmlal_u16(s2acc_0, vget_low_u16(t0_t3.val[0]), vget_low_u16(s2_0));
+    s2acc_1 = vmlal_high_u16(s2acc_1, t0_t3.val[1], s2_1);
+    s2acc_2 = vmlal_u16(s2acc_2, vget_low_u16(t0_t3.val[1]), vget_low_u16(s2_1));
+
+    s2acc = vmlal_high_u16(s2acc, t0_t3.val[2], s2_2);
+    s2acc_0 = vmlal_u16(s2acc_0, vget_low_u16(t0_t3.val[2]), vget_low_u16(s2_2));
+    s2acc_1 = vmlal_high_u16(s2acc_1, t0_t3.val[3], s2_3);
+    s2acc_2 = vmlal_u16(s2acc_2, vget_low_u16(t0_t3.val[3]), vget_low_u16(s2_3));
 
+    s2acc = vmlal_high_u16(s2acc, t4_t7.val[0], s2_4);
+    s2acc_0 = vmlal_u16(s2acc_0, vget_low_u16(t4_t7.val[0]), vget_low_u16(s2_4));
+    s2acc_1 = vmlal_high_u16(s2acc_1, t4_t7.val[1], s2_5);
+    s2acc_2 = vmlal_u16(s2acc_2, vget_low_u16(t4_t7.val[1]), vget_low_u16(s2_5));
+
+    s2acc = vmlal_high_u16(s2acc, t4_t7.val[2], s2_6);
+    s2acc_0 = vmlal_u16(s2acc_0, vget_low_u16(t4_t7.val[2]), vget_low_u16(s2_6));
+    s2acc_1 = vmlal_high_u16(s2acc_1, t4_t7.val[3], s2_7);
+    s2acc_2 = vmlal_u16(s2acc_2, vget_low_u16(t4_t7.val[3]), vget_low_u16(s2_7));
+
+    s2acc = vaddq_u32(s2acc_0, s2acc);
+    s2acc_2 = vaddq_u32(s2acc_1, s2acc_2);
+    s2acc = vaddq_u32(s2acc, s2acc_2);
+
+    uint32x2_t adacc2, s2acc2, as;
+    s2acc = vaddq_u32(s2acc, s3acc);
+    adacc2 = vpadd_u32(vget_low_u32(adacc), vget_high_u32(adacc));
+    s2acc2 = vpadd_u32(vget_low_u32(s2acc), vget_high_u32(s2acc));
+    as = vpadd_u32(adacc2, s2acc2);
+    s[0] = vget_lane_u32(as, 0);
+    s[1] = vget_lane_u32(as, 1);
+}
+
+Z_FORCEINLINE static void NEON_accum32(uint32_t *s, const uint8_t *buf, size_t len) {
     uint32x4_t adacc = vdupq_n_u32(0);
     uint32x4_t s2acc = vdupq_n_u32(0);
     uint32x4_t s2acc_0 = vdupq_n_u32(0);
@@ -141,22 +265,18 @@ static void NEON_handle_tail(uint32_t *pair, const uint8_t *buf, size_t len) {
     }
 }
 
-Z_INTERNAL uint32_t adler32_neon(uint32_t adler, const uint8_t *buf, size_t len) {
+Z_FORCEINLINE static uint32_t adler32_copy_impl(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len, const int COPY) {
     /* split Adler-32 into component sums */
     uint32_t sum2 = (adler >> 16) & 0xffff;
     adler &= 0xffff;
 
     /* in case user likes doing a byte at a time, keep it fast */
-    if (len == 1)
-        return adler32_len_1(adler, buf, sum2);
-
-    /* initial Adler-32 value (deferred check for len == 1 speed) */
-    if (buf == NULL)
-        return 1L;
+    if (UNLIKELY(len == 1))
+        return adler32_copy_len_1(adler, dst, src, sum2, COPY);
 
     /* in case short lengths are provided, keep it somewhat fast */
-    if (len < 16)
-        return adler32_len_16(adler, buf, len, sum2);
+    if (UNLIKELY(len < 16))
+        return adler32_copy_len_16(adler, dst, src, len, sum2, COPY);
 
     uint32_t pair[2];
     int n = NMAX;
@@ -171,12 +291,33 @@ Z_INTERNAL uint32_t adler32_neon(uint32_t adler, const uint8_t *buf, size_t len)
     /* If memory is not SIMD aligned, do scalar sums to an aligned
      * offset, provided that doing so doesn't completely eliminate
      * SIMD operation. Aligned loads are still faster on ARM, even
-     * though there's no explicit aligned load instruction */
-    unsigned int align_offset = ((uintptr_t)buf & 15);
-    unsigned int align_adj = (align_offset) ? 16 - align_offset : 0;
+     * though there's no explicit aligned load instruction. Note:
+     * on Android and iOS, their ABIs specify stricter alignment
+     * requirements for the 2,3,4x register ld1 variants. Clang for
+     * these platforms emits an alignment hint in the instruction for exactly
+     * 256 bits. Several ARM SIPs have small penalties for cacheline
+     * crossing loads as well (so really 512 bits is the optimal alignment
+     * of the buffer). 32 bytes should strike a balance, though. Clang and
+     * GCC on Linux will not emit this hint in the encoded instruction and
+     * it's unclear how many SIPs will benefit from it. For Android/iOS, we
+     * fallback to 4x loads and 4x stores, instead. In the copying variant we
+     * do this anyway, as ld1x4 seems to block ILP when stores are in the mix */
+    unsigned int align_offset = ((uintptr_t)src & 31);
+    unsigned int align_adj = (align_offset) ? 32 - align_offset : 0;
 
     if (align_offset && len >= (16 + align_adj)) {
-        NEON_handle_tail(pair, buf, align_adj);
+        NEON_handle_tail(pair, src, align_adj);
+
+        if (COPY) {
+            const uint8_t* __restrict src_noalias = src;
+            uint8_t* __restrict dst_noalias = dst;
+            unsigned cpy_len = align_adj;
+
+            while (cpy_len--) {
+                *dst_noalias++ = *src_noalias++;
+            }
+        }
+
         n -= align_adj;
         done += align_adj;
 
@@ -193,7 +334,11 @@ Z_INTERNAL uint32_t adler32_neon(uint32_t adler, const uint8_t *buf, size_t len)
         if (n < 16)
             break;
 
-        NEON_accum32(pair, buf + done, n >> 4);
+        if (COPY)
+            NEON_accum32_copy(pair, dst + done, src + done, n >> 4);
+        else
+            NEON_accum32(pair, src + done, n >> 4);
+
         pair[0] %= BASE;
         pair[1] %= BASE;
 
@@ -203,7 +348,14 @@ Z_INTERNAL uint32_t adler32_neon(uint32_t adler, const uint8_t *buf, size_t len)
 
     /* Handle the tail elements. */
     if (done < len) {
-        NEON_handle_tail(pair, (buf + done), len - done);
+        NEON_handle_tail(pair, (src + done), len - done);
+        if (COPY) {
+            const uint8_t* __restrict src_noalias = src + done;
+            uint8_t* __restrict dst_noalias = dst + done;
+            while (done++ != len) {
+                *dst_noalias++ = *src_noalias++;
+            }
+        }
         pair[0] %= BASE;
         pair[1] %= BASE;
     }
@@ -212,4 +364,12 @@ Z_INTERNAL uint32_t adler32_neon(uint32_t adler, const uint8_t *buf, size_t len)
     return (pair[1] << 16) | pair[0];
 }
 
+Z_INTERNAL uint32_t adler32_neon(uint32_t adler, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, NULL, src, len, 0);
+}
+
+Z_INTERNAL uint32_t adler32_copy_neon(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, dst, src, len, 1);
+}
+
 #endif
diff --git a/arch/arm/arm_features.c b/arch/arm/arm_features.c
index d0d49764..25dc1885 100644
--- a/arch/arm/arm_features.c
+++ b/arch/arm/arm_features.c
@@ -1,7 +1,7 @@
 #include "zbuild.h"
 #include "arm_features.h"
 
-#if defined(__linux__) && defined(HAVE_SYS_AUXV_H)
+#if defined(HAVE_SYS_AUXV_H)
 #  include <sys/auxv.h>
 #  ifdef ARM_ASM_HWCAP
 #    include <asm/hwcap.h>
@@ -25,12 +25,24 @@
 #  include <windows.h>
 #endif
 
-static int arm_has_crc32() {
-#if defined(__linux__) && defined(ARM_AUXV_HAS_CRC32)
-#  ifdef HWCAP_CRC32
-    return (getauxval(AT_HWCAP) & HWCAP_CRC32) != 0 ? 1 : 0;
+static int arm_has_crc32(void) {
+#if defined(ARM_AUXV_HAS_CRC32)
+#  if defined(__FreeBSD__) || defined(__OpenBSD__)
+#    ifdef HWCAP_CRC32
+       unsigned long hwcap = 0;
+       elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
+       return (hwcap & HWCAP_CRC32) != 0 ? 1 : 0;
+#    else
+       unsigned long hwcap2 = 0;
+       elf_aux_info(AT_HWCAP2, &hwcap2, sizeof(hwcap2));
+       return (hwcap2 & HWCAP2_CRC32) != 0 ? 1 : 0;
+#    endif
 #  else
-    return (getauxval(AT_HWCAP2) & HWCAP2_CRC32) != 0 ? 1 : 0;
+#    ifdef HWCAP_CRC32
+       return (getauxval(AT_HWCAP) & HWCAP_CRC32) != 0 ? 1 : 0;
+#    else
+       return (getauxval(AT_HWCAP2) & HWCAP2_CRC32) != 0 ? 1 : 0;
+#    endif
 #  endif
 #elif defined(__FreeBSD__) && defined(__aarch64__)
     return getenv("QEMU_EMULATING") == NULL
@@ -52,7 +64,114 @@ static int arm_has_crc32() {
       && hascrc32 == 1;
 #elif defined(_WIN32)
     return IsProcessorFeaturePresent(PF_ARM_V8_CRC32_INSTRUCTIONS_AVAILABLE);
-#elif defined(ARM_NOCHECK_ACLE)
+#elif defined(ARM_NOCHECK_CRC32)
+    return 1;
+#else
+    return 0;
+#endif
+}
+
+static int arm_has_pmull(void) {
+#if defined(__linux__) && defined(HAVE_SYS_AUXV_H)
+#  ifdef HWCAP_PMULL
+    return (getauxval(AT_HWCAP) & HWCAP_PMULL) != 0 ? 1 : 0;
+#  else
+    /* PMULL is part of crypto extension, check for AES as proxy */
+#    ifdef HWCAP_AES
+    return (getauxval(AT_HWCAP) & HWCAP_AES) != 0 ? 1 : 0;
+#    else
+    return 0;
+#    endif
+#  endif
+#elif defined(__FreeBSD__) && defined(__aarch64__)
+    /* Check for AES feature as PMULL is part of crypto extension */
+    return getenv("QEMU_EMULATING") == NULL
+      && ID_AA64ISAR0_AES_VAL(READ_SPECIALREG(id_aa64isar0_el1)) >= ID_AA64ISAR0_AES_BASE;
+#elif defined(__OpenBSD__) && defined(__aarch64__)
+    int haspmull = 0;
+    int isar0_mib[] = { CTL_MACHDEP, CPU_ID_AA64ISAR0 };
+    uint64_t isar0 = 0;
+    size_t len = sizeof(isar0);
+    if (sysctl(isar0_mib, 2, &isar0, &len, NULL, 0) != -1) {
+      if (ID_AA64ISAR0_AES(isar0) >= ID_AA64ISAR0_AES_BASE)
+          haspmull = 1;
+    }
+    return haspmull;
+#elif defined(__APPLE__)
+#  if defined(__aarch64__) || defined(_M_ARM64)
+    int haspmull;
+    size_t size = sizeof(haspmull);
+    return sysctlbyname("hw.optional.arm.FEAT_PMULL", &haspmull, &size, NULL, 0) == 0
+      && haspmull == 1;
+#  else
+    return 0;
+#  endif
+#elif defined(_WIN32)
+    /* Windows checks for crypto/AES support */
+#  ifdef PF_ARM_V8_CRYPTO_INSTRUCTIONS_AVAILABLE
+    return IsProcessorFeaturePresent(PF_ARM_V8_CRYPTO_INSTRUCTIONS_AVAILABLE);
+#  else
+    return 0;
+#  endif
+#elif defined(__ARM_FEATURE_CRYPTO) || defined(__ARM_FEATURE_AES)
+    /* Compile-time check */
+    return 1;
+#else
+    return 0;
+#endif
+}
+
+static int arm_has_eor3(void) {
+#if defined(__linux__) && defined(HAVE_SYS_AUXV_H)
+    /* EOR3 is part of SHA3 extension, check HWCAP2_SHA3 */
+#  ifdef HWCAP2_SHA3
+    return (getauxval(AT_HWCAP2) & HWCAP2_SHA3) != 0 ? 1 : 0;
+#  elif defined(HWCAP_SHA3)
+    return (getauxval(AT_HWCAP) & HWCAP_SHA3) != 0 ? 1 : 0;
+#  else
+    return 0;
+#  endif
+#elif defined(__FreeBSD__) && defined(__aarch64__)
+    /* FreeBSD: check for SHA3 in id_aa64isar0_el1 */
+#  ifdef ID_AA64ISAR0_SHA3_VAL
+    return getenv("QEMU_EMULATING") == NULL
+      && ID_AA64ISAR0_SHA3_VAL(READ_SPECIALREG(id_aa64isar0_el1)) >= ID_AA64ISAR0_SHA3_BASE;
+#  else
+    return 0;
+#  endif
+#elif defined(__OpenBSD__) && defined(__aarch64__)
+#  ifdef ID_AA64ISAR0_SHA3
+    int haseor3 = 0;
+    int isar0_mib[] = { CTL_MACHDEP, CPU_ID_AA64ISAR0 };
+    uint64_t isar0 = 0;
+    size_t len = sizeof(isar0);
+    if (sysctl(isar0_mib, 2, &isar0, &len, NULL, 0) != -1) {
+      if (ID_AA64ISAR0_SHA3(isar0) >= ID_AA64ISAR0_SHA3_IMPL)
+          haseor3 = 1;
+    }
+    return haseor3;
+#  else
+    return 0;
+#  endif
+#elif defined(__APPLE__)
+    /* All Apple Silicon (M1+) has SHA3/EOR3 support */
+#  if defined(__aarch64__) || defined(_M_ARM64)
+    int hassha3;
+    size_t size = sizeof(hassha3);
+    if (sysctlbyname("hw.optional.arm.FEAT_SHA3", &hassha3, &size, NULL, 0) == 0 && hassha3 == 1)
+        return 1;
+    /* Fallback to legacy name for older macOS versions */
+    size = sizeof(hassha3);
+    return sysctlbyname("hw.optional.armv8_2_sha3", &hassha3, &size, NULL, 0) == 0
+      && hassha3 == 1;
+#  else
+    return 0;
+#  endif
+#elif defined(_WIN32)
+    /* Windows: No direct API for SHA3, return 0 for now */
+    return 0;
+#elif defined(__ARM_FEATURE_SHA3)
+    /* Compile-time check */
     return 1;
 #else
     return 0;
@@ -60,13 +179,19 @@ static int arm_has_crc32() {
 }
 
 /* AArch64 has neon. */
-#if !defined(__aarch64__) && !defined(_M_ARM64) && !defined(_M_ARM64EC)
-static inline int arm_has_neon() {
-#if defined(__linux__) && defined(ARM_AUXV_HAS_NEON)
-#  ifdef HWCAP_ARM_NEON
-    return (getauxval(AT_HWCAP) & HWCAP_ARM_NEON) != 0 ? 1 : 0;
+#if defined(ARCH_ARM) && defined(ARCH_32BIT)
+static inline int arm_has_neon(void) {
+#if defined(ARM_AUXV_HAS_NEON)
+#  if defined(__FreeBSD__) || defined(__OpenBSD__)
+     unsigned long hwcap = 0;
+     elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
+     return (hwcap & HWCAP_NEON) != 0 ? 1 : 0;
 #  else
-    return (getauxval(AT_HWCAP) & HWCAP_NEON) != 0 ? 1 : 0;
+#    ifdef HWCAP_ARM_NEON
+       return (getauxval(AT_HWCAP) & HWCAP_ARM_NEON) != 0 ? 1 : 0;
+#    else
+       return (getauxval(AT_HWCAP) & HWCAP_NEON) != 0 ? 1 : 0;
+#    endif
 #  endif
 #elif defined(__APPLE__)
     int hasneon;
@@ -88,8 +213,8 @@ static inline int arm_has_neon() {
 #endif
 
 /* AArch64 does not have ARMv6 SIMD. */
-#if !defined(__aarch64__) && !defined(_M_ARM64) && !defined(_M_ARM64EC)
-static inline int arm_has_simd() {
+#if defined(ARCH_ARM) && defined(ARCH_32BIT)
+static inline int arm_has_simd(void) {
 #if defined(__linux__) && defined(HAVE_SYS_AUXV_H)
     const char *platform = (const char *)getauxval(AT_PLATFORM);
     return strncmp(platform, "v6l", 3) == 0
@@ -103,8 +228,89 @@ static inline int arm_has_simd() {
 }
 #endif
 
+#if defined(__aarch64__) && !defined(__APPLE__)
+/* MIDR_EL1 bit field definitions */
+#define MIDR_IMPLEMENTOR(midr)  (((midr) & (0xffU << 24)) >> 24)
+#define MIDR_PARTNUM(midr)      (((midr) & (0xfffU << 4)) >> 4)
+
+/* ARM CPU Implementer IDs */
+#define ARM_IMPLEMENTER_ARM      0x41
+#define ARM_IMPLEMENTER_QUALCOMM 0x51
+#define ARM_IMPLEMENTER_APPLE    0x61
+
+/* ARM CPU Part Numbers */
+
+/* Cortex-X series - Multiple PMULL lanes */
+#define ARM_PART_CORTEX_X1   0xd44
+#define ARM_PART_CORTEX_X1C  0xd4c
+#define ARM_PART_CORTEX_X2   0xd48
+#define ARM_PART_CORTEX_X3   0xd4e
+#define ARM_PART_CORTEX_X4   0xd82
+#define ARM_PART_CORTEX_X925 0xd85
+
+/* Neoverse V/N2 series - Multiple PMULL lanes */
+#define ARM_PART_NEOVERSE_N2 0xd49
+#define ARM_PART_NEOVERSE_V1 0xd40
+#define ARM_PART_NEOVERSE_V2 0xd4f
+#define ARM_PART_NEOVERSE_V3 0xd8e
+
+/* Snapdragon X Elite/Plus - Custom core */
+#define QUALCOMM_PART_ORYON 0x001
+#endif
+
+/* Determine if CPU has fast PMULL (multiple execution units) */
+static inline int arm_cpu_has_fast_pmull(void) {
+#if defined(__APPLE__)
+    /* On macOS, all Apple Silicon has fast PMULL */
+    return 1;
+#elif defined(__aarch64__)
+#  if defined(__linux__)
+    /* We have to support the CPUID feature in HWCAP */
+    if (!(getauxval(AT_HWCAP) & HWCAP_CPUID))
+        return 0;
+#  elif defined(__FreeBSD__) || defined(__OpenBSD__)
+    unsigned long hwcap = 0;
+    elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
+    if (!(hwcap & HWCAP_CPUID))
+        return 0;
+#  else
+    return 0;
+#  endif
+    uint64_t midr;
+    __asm__ ("mrs %0, midr_el1" : "=r" (midr));
+
+    uint32_t implementer = MIDR_IMPLEMENTOR(midr);
+    uint32_t part = MIDR_PARTNUM(midr);
+
+    if (implementer == ARM_IMPLEMENTER_APPLE) {
+        /* All Apple Silicon (M1+) have fast PMULL */
+        return 1;
+    } else if (implementer == ARM_IMPLEMENTER_ARM) {
+        /* ARM Cortex-X and Neoverse V/N2 series have multi-lane PMULL */
+        switch (part) {
+            case ARM_PART_CORTEX_X1:
+            case ARM_PART_CORTEX_X1C:
+            case ARM_PART_CORTEX_X2:
+            case ARM_PART_CORTEX_X3:
+            case ARM_PART_CORTEX_X4:
+            case ARM_PART_CORTEX_X925:
+            case ARM_PART_NEOVERSE_N2:
+            case ARM_PART_NEOVERSE_V1:
+            case ARM_PART_NEOVERSE_V2:
+            case ARM_PART_NEOVERSE_V3:
+                return 1;
+        }
+    } else if (implementer == ARM_IMPLEMENTER_QUALCOMM) {
+        /* Qualcomm Oryon (Snapdragon X Elite/Plus) has fast PMULL */
+        if (part == QUALCOMM_PART_ORYON)
+            return 1;
+    }
+#endif
+    return 0;
+}
+
 void Z_INTERNAL arm_check_features(struct arm_cpu_features *features) {
-#if defined(__aarch64__) || defined(_M_ARM64) || defined(_M_ARM64EC)
+#if defined(ARCH_ARM) && defined(ARCH_64BIT)
     features->has_simd = 0; /* never available */
     features->has_neon = 1; /* always available */
 #else
@@ -112,4 +318,7 @@ void Z_INTERNAL arm_check_features(struct arm_cpu_features *features) {
     features->has_neon = arm_has_neon();
 #endif
     features->has_crc32 = arm_has_crc32();
+    features->has_pmull = arm_has_pmull();
+    features->has_eor3 = arm_has_eor3();
+    features->has_fast_pmull = features->has_pmull && arm_cpu_has_fast_pmull();
 }
diff --git a/arch/arm/arm_features.h b/arch/arm/arm_features.h
index d968e02f..2f17a9dd 100644
--- a/arch/arm/arm_features.h
+++ b/arch/arm/arm_features.h
@@ -9,6 +9,9 @@ struct arm_cpu_features {
     int has_simd;
     int has_neon;
     int has_crc32;
+    int has_pmull;
+    int has_eor3;
+    int has_fast_pmull;
 };
 
 void Z_INTERNAL arm_check_features(struct arm_cpu_features *features);
diff --git a/arch/arm/arm_functions.h b/arch/arm/arm_functions.h
index 61c68271..b18af8f8 100644
--- a/arch/arm/arm_functions.h
+++ b/arch/arm/arm_functions.h
@@ -7,20 +7,25 @@
 
 #ifdef ARM_NEON
 uint32_t adler32_neon(uint32_t adler, const uint8_t *buf, size_t len);
-uint32_t chunksize_neon(void);
-uint8_t* chunkmemset_safe_neon(uint8_t *out, unsigned dist, unsigned len, unsigned left);
+uint32_t adler32_copy_neon(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+uint8_t* chunkmemset_safe_neon(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
 
 #  ifdef HAVE_BUILTIN_CTZLL
 uint32_t compare256_neon(const uint8_t *src0, const uint8_t *src1);
-uint32_t longest_match_neon(deflate_state *const s, Pos cur_match);
-uint32_t longest_match_slow_neon(deflate_state *const s, Pos cur_match);
+uint32_t longest_match_neon(deflate_state *const s, uint32_t cur_match);
+uint32_t longest_match_slow_neon(deflate_state *const s, uint32_t cur_match);
 #  endif
 void slide_hash_neon(deflate_state *s);
 void inflate_fast_neon(PREFIX3(stream) *strm, uint32_t start);
 #endif
 
-#ifdef ARM_ACLE
-uint32_t crc32_acle(uint32_t crc, const uint8_t *buf, size_t len);
+#ifdef ARM_CRC32
+uint32_t crc32_armv8(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_armv8(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+#endif
+#ifdef ARM_PMULL_EOR3
+uint32_t crc32_armv8_pmull_eor3(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_armv8_pmull_eor3(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
 #endif
 
 #ifdef ARM_SIMD
@@ -38,10 +43,10 @@ void slide_hash_armv6(deflate_state *s);
 #  if (defined(ARM_NEON) && (defined(__ARM_NEON__) || defined(__ARM_NEON))) || ARM_NOCHECK_NEON
 #    undef native_adler32
 #    define native_adler32 adler32_neon
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_neon
 #    undef native_chunkmemset_safe
 #    define native_chunkmemset_safe chunkmemset_safe_neon
-#    undef native_chunksize
-#    define native_chunksize chunksize_neon
 #    undef native_inflate_fast
 #    define native_inflate_fast inflate_fast_neon
 #    undef native_slide_hash
@@ -55,10 +60,19 @@ void slide_hash_armv6(deflate_state *s);
 #      define native_longest_match_slow longest_match_slow_neon
 #    endif
 #  endif
-// ARM - ACLE
-#  if defined(ARM_ACLE) && defined(__ARM_ACLE) && defined(__ARM_FEATURE_CRC32)
+// ARM - CRC32
+#  if (defined(ARM_CRC32) && defined(__ARM_FEATURE_CRC32))
+#    undef native_crc32
+#    define native_crc32 crc32_armv8
+#    undef native_crc32_copy
+#    define native_crc32_copy crc32_copy_armv8
+#  endif
+// ARM - PMULL EOR3
+#  if (defined(ARM_PMULL_EOR3) && defined(__ARM_FEATURE_CRC32) && defined(__ARM_FEATURE_CRYPTO) && defined(__ARM_FEATURE_SHA3))
 #    undef native_crc32
-#    define native_crc32 crc32_acle
+#    define native_crc32 crc32_armv8_pmull_eor3
+#    undef native_crc32_copy
+#    define native_crc32_copy crc32_copy_armv8_pmull_eor3
 #  endif
 #endif
 
diff --git a/arch/arm/chunkset_neon.c b/arch/arm/chunkset_neon.c
index 1c49ef56..271f7f92 100644
--- a/arch/arm/chunkset_neon.c
+++ b/arch/arm/chunkset_neon.c
@@ -5,49 +5,27 @@
 #ifdef ARM_NEON
 #include "neon_intrins.h"
 #include "zbuild.h"
-#include "arch/generic/chunk_permute_table.h"
+#include "zmemory.h"
+#include "arch/generic/chunk_128bit_perm_idx_lut.h"
 
 typedef uint8x16_t chunk_t;
 
-#define CHUNK_SIZE 16
-
 #define HAVE_CHUNKMEMSET_2
 #define HAVE_CHUNKMEMSET_4
 #define HAVE_CHUNKMEMSET_8
 #define HAVE_CHUNK_MAG
 
-static const lut_rem_pair perm_idx_lut[13] = {
-    {0, 1},      /* 3 */
-    {0, 0},      /* don't care */
-    {1 * 32, 1}, /* 5 */
-    {2 * 32, 4}, /* 6 */
-    {3 * 32, 2}, /* 7 */
-    {0 * 32, 0}, /* don't care */
-    {4 * 32, 7}, /* 9 */
-    {5 * 32, 6}, /* 10 */
-    {6 * 32, 5}, /* 11 */
-    {7 * 32, 4}, /* 12 */
-    {8 * 32, 3}, /* 13 */
-    {9 * 32, 2}, /* 14 */
-    {10 * 32, 1},/* 15 */
-};
 
 static inline void chunkmemset_2(uint8_t *from, chunk_t *chunk) {
-    uint16_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = vreinterpretq_u8_u16(vdupq_n_u16(tmp));
+    *chunk = vreinterpretq_u8_u16(vdupq_n_u16(zng_memread_2(from)));
 }
 
 static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
-    uint32_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = vreinterpretq_u8_u32(vdupq_n_u32(tmp));
+    *chunk = vreinterpretq_u8_u32(vdupq_n_u32(zng_memread_4(from)));
 }
 
 static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
-    uint64_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = vreinterpretq_u8_u64(vdupq_n_u64(tmp));
+    *chunk = vreinterpretq_u8_u64(vdupq_n_u64(zng_memread_8(from)));
 }
 
 #define CHUNKSIZE        chunksize_neon
@@ -72,7 +50,7 @@ static inline chunk_t GET_CHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t
     __msan_unpoison(buf + dist, 16 - dist);
 
     /* This version of table is only available on aarch64 */
-#if defined(_M_ARM64) || defined(_M_ARM64EC) || defined(__aarch64__)
+#if defined(ARCH_ARM) && defined(ARCH_64BIT)
     uint8x16_t ret_vec = vld1q_u8(buf);
 
     uint8x16_t perm_vec = vld1q_u8(permute_table + lut_rem.idx);
@@ -84,7 +62,9 @@ static inline chunk_t GET_CHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t
     a = vld1_u8(buf);
     b = vld1_u8(buf + 8);
     ret0 = vtbl1_u8(a, perm_vec0);
-    uint8x8x2_t ab = {{a, b}};
+    uint8x8x2_t ab;
+    ab.val[0] = a;
+    ab.val[1] = b;
     ret1 = vtbl2_u8(ab, perm_vec1);
     return vcombine_u8(ret0, ret1);
 #endif
diff --git a/arch/arm/compare256_neon.c b/arch/arm/compare256_neon.c
index 87d14c89..3d05152f 100644
--- a/arch/arm/compare256_neon.c
+++ b/arch/arm/compare256_neon.c
@@ -4,7 +4,7 @@
  */
 
 #include "zbuild.h"
-#include "zutil_p.h"
+#include "zmemory.h"
 #include "deflate.h"
 #include "fallback_builtins.h"
 
diff --git a/arch/arm/crc32_acle.c b/arch/arm/crc32_acle.c
deleted file mode 100644
index 116bcab1..00000000
--- a/arch/arm/crc32_acle.c
+++ /dev/null
@@ -1,78 +0,0 @@
-/* crc32_acle.c -- compute the CRC-32 of a data stream
- * Copyright (C) 1995-2006, 2010, 2011, 2012 Mark Adler
- * Copyright (C) 2016 Yang Zhang
- * For conditions of distribution and use, see copyright notice in zlib.h
- *
-*/
-
-#ifdef ARM_ACLE
-#include "acle_intrins.h"
-#include "zbuild.h"
-
-Z_INTERNAL Z_TARGET_CRC uint32_t crc32_acle(uint32_t crc, const uint8_t *buf, size_t len) {
-    Z_REGISTER uint32_t c;
-    Z_REGISTER const uint16_t *buf2;
-    Z_REGISTER const uint32_t *buf4;
-    Z_REGISTER const uint64_t *buf8;
-
-    c = ~crc;
-
-    if (UNLIKELY(len == 1)) {
-        c = __crc32b(c, *buf);
-        c = ~c;
-        return c;
-    }
-
-    if ((ptrdiff_t)buf & (sizeof(uint64_t) - 1)) {
-        if (len && ((ptrdiff_t)buf & 1)) {
-            c = __crc32b(c, *buf++);
-            len--;
-        }
-
-        if ((len >= sizeof(uint16_t)) && ((ptrdiff_t)buf & sizeof(uint16_t))) {
-            buf2 = (const uint16_t *) buf;
-            c = __crc32h(c, *buf2++);
-            len -= sizeof(uint16_t);
-            buf4 = (const uint32_t *) buf2;
-        } else {
-            buf4 = (const uint32_t *) buf;
-        }
-
-        if ((len >= sizeof(uint32_t)) && ((ptrdiff_t)buf & sizeof(uint32_t))) {
-            c = __crc32w(c, *buf4++);
-            len -= sizeof(uint32_t);
-        }
-
-        buf8 = (const uint64_t *) buf4;
-    } else {
-        buf8 = (const uint64_t *) buf;
-    }
-
-    while (len >= sizeof(uint64_t)) {
-        c = __crc32d(c, *buf8++);
-        len -= sizeof(uint64_t);
-    }
-
-    if (len >= sizeof(uint32_t)) {
-        buf4 = (const uint32_t *) buf8;
-        c = __crc32w(c, *buf4++);
-        len -= sizeof(uint32_t);
-        buf2 = (const uint16_t *) buf4;
-    } else {
-        buf2 = (const uint16_t *) buf8;
-    }
-
-    if (len >= sizeof(uint16_t)) {
-        c = __crc32h(c, *buf2++);
-        len -= sizeof(uint16_t);
-    }
-
-    buf = (const unsigned char *) buf2;
-    if (len) {
-        c = __crc32b(c, *buf);
-    }
-
-    c = ~c;
-    return c;
-}
-#endif
diff --git a/arch/arm/crc32_armv8.c b/arch/arm/crc32_armv8.c
new file mode 100644
index 00000000..8f72f3c0
--- /dev/null
+++ b/arch/arm/crc32_armv8.c
@@ -0,0 +1,70 @@
+/* crc32_armv8.c -- compute the CRC-32 of a data stream
+ * Copyright (C) 1995-2006, 2010, 2011, 2012 Mark Adler
+ * Copyright (C) 2016 Yang Zhang
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#if defined(ARM_CRC32)
+#include "acle_intrins.h"
+#include "zbuild.h"
+#include "crc32.h"
+
+Z_INTERNAL Z_TARGET_CRC uint32_t crc32_armv8(uint32_t crc, const uint8_t *buf, size_t len) {
+    uint32_t c = ~crc;
+
+    if (UNLIKELY(len == 1)) {
+        c = __crc32b(c, *buf);
+        c = ~c;
+        return c;
+    }
+
+    uintptr_t align_diff = ALIGN_DIFF(buf, 8);
+    if (align_diff) {
+        if (len && (align_diff & 1)) {
+            c = __crc32b(c, *buf++);
+            len--;
+        }
+
+        if (len >= 2 && (align_diff & 2)) {
+            c = __crc32h(c, *((uint16_t*)buf));
+            buf += 2;
+            len -= 2;
+        }
+
+        if (len >= 4 && (align_diff & 4)) {
+            c = __crc32w(c, *((uint32_t*)buf));
+            len -= 4;
+            buf += 4;
+        }
+    }
+
+    while (len >= 8) {
+        c = __crc32d(c, *((uint64_t*)buf));
+        len -= 8;
+        buf += 8;
+    }
+
+    if (len & 4) {
+        c = __crc32w(c, *((uint32_t*)buf));
+        buf += 4;
+    }
+
+    if (len & 2) {
+        c = __crc32h(c, *((uint16_t*)buf));
+        buf += 2;
+    }
+
+    if (len & 1) {
+        c = __crc32b(c, *buf);
+    }
+
+    c = ~c;
+    return c;
+}
+
+Z_INTERNAL Z_TARGET_CRC uint32_t crc32_copy_armv8(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_armv8(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
+#endif
diff --git a/arch/arm/crc32_armv8_pmull_eor3.c b/arch/arm/crc32_armv8_pmull_eor3.c
new file mode 100644
index 00000000..d7a15074
--- /dev/null
+++ b/arch/arm/crc32_armv8_pmull_eor3.c
@@ -0,0 +1,267 @@
+/* crc32_armv8_pmull_eor3.c -- ARMv8 CRC32 using PMULL + EOR3 (SHA3 extension)
+ * Copyright (C) 2025 Peter Cawley
+ *   https://github.com/corsix/fast-crc32
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ *
+ * This uses EOR3 (3-way XOR) from ARMv8.2-A SHA3 extension to save instructions.
+ * Uses 3-way parallel scalar CRC + 9 PMULL vector lanes, processing 192 bytes/iter.
+ */
+
+#if defined(ARM_PMULL_EOR3)
+#include "zbuild.h"
+#include "zutil.h"
+#include "acle_intrins.h"
+#include "neon_intrins.h"
+#include "crc32.h"
+
+/* Carryless multiply low 64 bits: a[0] * b[0] */
+static inline uint64x2_t clmul_lo(uint64x2_t a, uint64x2_t b) {
+    return vreinterpretq_u64_p128(vmull_p64(
+        vget_lane_p64(vreinterpret_p64_u64(vget_low_u64(a)), 0),
+        vget_lane_p64(vreinterpret_p64_u64(vget_low_u64(b)), 0)));
+}
+
+/* Carryless multiply high 64 bits: a[1] * b[1] */
+static inline uint64x2_t clmul_hi(uint64x2_t a, uint64x2_t b) {
+    return vreinterpretq_u64_p128(vmull_high_p64(vreinterpretq_p64_u64(a), vreinterpretq_p64_u64(b)));
+}
+
+/* Carryless multiply of two 32-bit scalars: a * b (returns 64-bit result in 128-bit vector) */
+static inline uint64x2_t clmul_scalar(uint32_t a, uint32_t b) {
+  return vreinterpretq_u64_p128(vmull_p64((poly64_t)a, (poly64_t)b));
+}
+
+/* Compute x^n mod P (CRC-32 polynomial) in log(n) time, where P = 0x104c11db7 */
+static uint32_t xnmodp(uint64_t n) {
+  uint64_t stack = ~(uint64_t)1;
+  uint32_t acc, low;
+  for (; n > 191; n = (n >> 1) - 16) {
+    stack = (stack << 1) + (n & 1);
+  }
+  stack = ~stack;
+  acc = ((uint32_t)0x80000000) >> (n & 31);
+  for (n >>= 5; n; --n) {
+    acc = __crc32w(acc, 0);
+  }
+  while ((low = stack & 1), stack >>= 1) {
+    poly8x8_t x = vreinterpret_p8_u64(vmov_n_u64(acc));
+    uint64_t y = vgetq_lane_u64(vreinterpretq_u64_p16(vmull_p8(x, x)), 0);
+    acc = __crc32d(0, y << low);
+  }
+  return acc;
+}
+
+/* Shift CRC forward by nbytes: equivalent to appending nbytes of zeros to the data stream */
+static inline uint64x2_t crc_shift(uint32_t crc, size_t nbytes) {
+  Assert(nbytes >= 5, "crc_shift requires nbytes >= 5");
+  return clmul_scalar(crc, xnmodp(nbytes * 8 - 33));
+}
+
+Z_INTERNAL Z_TARGET_PMULL_EOR3 uint32_t crc32_armv8_pmull_eor3(uint32_t crc, const uint8_t *buf, size_t len) {
+    uint32_t crc0 = ~crc;
+
+    if (UNLIKELY(len == 1)) {
+        crc0 = __crc32b(crc0, *buf);
+        return ~crc0;
+    }
+
+    /* Align to 16-byte boundary for vector path */
+    uintptr_t align_diff = ALIGN_DIFF(buf, 16);
+    if (align_diff) {
+        if (len && (align_diff & 1)) {
+            crc0 = __crc32b(crc0, *buf++);
+            len--;
+        }
+
+        if (len >= 2 && (align_diff & 2)) {
+            crc0 = __crc32h(crc0, *((uint16_t*)buf));
+            buf += 2;
+            len -= 2;
+        }
+
+        if (len >= 4 && (align_diff & 4)) {
+            crc0 = __crc32w(crc0, *((uint32_t*)buf));
+            len -= 4;
+            buf += 4;
+        }
+
+        if (len >= 8 && (align_diff & 8)) {
+            crc0 = __crc32d(crc0, *((uint64_t*)buf));
+            buf += 8;
+            len -= 8;
+        }
+    }
+
+    /* 3-way scalar CRC + 9-way PMULL folding (192 bytes/iter) */
+    if (len >= 192) {
+        const uint8_t *end = buf + len;
+        size_t blk = len / 192;                  /* Number of 192-byte blocks */
+        size_t klen = blk * 16;                  /* Scalar stride per CRC lane */
+        const uint8_t *buf2 = buf + klen * 3;    /* Vector data starts after scalar lanes */
+        uint32_t crc1 = 0, crc2 = 0;
+        uint64x2_t vc0, vc1, vc2;
+        uint64_t vc;
+
+        /* Load first 9 vector chunks (144 bytes) */
+        uint64x2_t x0 = vld1q_u64((const uint64_t*)buf2), y0;
+        uint64x2_t x1 = vld1q_u64((const uint64_t*)(buf2 + 16)), y1;
+        uint64x2_t x2 = vld1q_u64((const uint64_t*)(buf2 + 32)), y2;
+        uint64x2_t x3 = vld1q_u64((const uint64_t*)(buf2 + 48)), y3;
+        uint64x2_t x4 = vld1q_u64((const uint64_t*)(buf2 + 64)), y4;
+        uint64x2_t x5 = vld1q_u64((const uint64_t*)(buf2 + 80)), y5;
+        uint64x2_t x6 = vld1q_u64((const uint64_t*)(buf2 + 96)), y6;
+        uint64x2_t x7 = vld1q_u64((const uint64_t*)(buf2 + 112)), y7;
+        uint64x2_t x8 = vld1q_u64((const uint64_t*)(buf2 + 128)), y8;
+        uint64x2_t k;
+        /* k = {x^144 mod P, x^144+64 mod P} for 144-byte fold */
+        { static const uint64_t ALIGNED_(16) k_[] = {0x26b70c3d, 0x3f41287a}; k = vld1q_u64(k_); }
+        buf2 += 144;
+
+        /* Fold 9 vectors + 3-way parallel scalar CRC */
+        if (blk > 1) {
+            /* Only form a limit pointer when we have at least 2 blocks. */
+            const uint8_t *limit = buf + klen - 32;
+            while (buf <= limit) {
+                /* Fold all 9 vector lanes using PMULL */
+                y0 = clmul_lo(x0, k), x0 = clmul_hi(x0, k);
+                y1 = clmul_lo(x1, k), x1 = clmul_hi(x1, k);
+                y2 = clmul_lo(x2, k), x2 = clmul_hi(x2, k);
+                y3 = clmul_lo(x3, k), x3 = clmul_hi(x3, k);
+                y4 = clmul_lo(x4, k), x4 = clmul_hi(x4, k);
+                y5 = clmul_lo(x5, k), x5 = clmul_hi(x5, k);
+                y6 = clmul_lo(x6, k), x6 = clmul_hi(x6, k);
+                y7 = clmul_lo(x7, k), x7 = clmul_hi(x7, k);
+                y8 = clmul_lo(x8, k), x8 = clmul_hi(x8, k);
+
+                /* EOR3: combine hi*k, lo*k, and new data in one instruction */
+                x0 = veor3q_u64(x0, y0, vld1q_u64((const uint64_t*)buf2));
+                x1 = veor3q_u64(x1, y1, vld1q_u64((const uint64_t*)(buf2 + 16)));
+                x2 = veor3q_u64(x2, y2, vld1q_u64((const uint64_t*)(buf2 + 32)));
+                x3 = veor3q_u64(x3, y3, vld1q_u64((const uint64_t*)(buf2 + 48)));
+                x4 = veor3q_u64(x4, y4, vld1q_u64((const uint64_t*)(buf2 + 64)));
+                x5 = veor3q_u64(x5, y5, vld1q_u64((const uint64_t*)(buf2 + 80)));
+                x6 = veor3q_u64(x6, y6, vld1q_u64((const uint64_t*)(buf2 + 96)));
+                x7 = veor3q_u64(x7, y7, vld1q_u64((const uint64_t*)(buf2 + 112)));
+                x8 = veor3q_u64(x8, y8, vld1q_u64((const uint64_t*)(buf2 + 128)));
+
+                /* 3-way parallel scalar CRC (16 bytes each) */
+                crc0 = __crc32d(crc0, *(const uint64_t*)buf);
+                crc1 = __crc32d(crc1, *(const uint64_t*)(buf + klen));
+                crc2 = __crc32d(crc2, *(const uint64_t*)(buf + klen * 2));
+                crc0 = __crc32d(crc0, *(const uint64_t*)(buf + 8));
+                crc1 = __crc32d(crc1, *(const uint64_t*)(buf + klen + 8));
+                crc2 = __crc32d(crc2, *(const uint64_t*)(buf + klen * 2 + 8));
+                buf += 16;
+                buf2 += 144;
+            }
+        }
+
+        /* Reduce 9 vectors to 1 using tree reduction */
+        /* Step 1: x0 = fold(x0, x1), shift x2..x8 down */
+        { static const uint64_t ALIGNED_(16) k_[] = {0xae689191, 0xccaa009e}; k = vld1q_u64(k_); }
+        y0 = clmul_lo(x0, k), x0 = clmul_hi(x0, k);
+        x0 = veor3q_u64(x0, y0, x1);
+        x1 = x2, x2 = x3, x3 = x4, x4 = x5, x5 = x6, x6 = x7, x7 = x8;
+
+        /* Step 2: fold pairs (x0,x1), (x2,x3), (x4,x5), (x6,x7) */
+        y0 = clmul_lo(x0, k), x0 = clmul_hi(x0, k);
+        y2 = clmul_lo(x2, k), x2 = clmul_hi(x2, k);
+        y4 = clmul_lo(x4, k), x4 = clmul_hi(x4, k);
+        y6 = clmul_lo(x6, k), x6 = clmul_hi(x6, k);
+        x0 = veor3q_u64(x0, y0, x1);
+        x2 = veor3q_u64(x2, y2, x3);
+        x4 = veor3q_u64(x4, y4, x5);
+        x6 = veor3q_u64(x6, y6, x7);
+
+        /* Step 3: fold pairs (x0,x2), (x4,x6) */
+        { static const uint64_t ALIGNED_(16) k_[] = {0xf1da05aa, 0x81256527}; k = vld1q_u64(k_); }
+        y0 = clmul_lo(x0, k), x0 = clmul_hi(x0, k);
+        y4 = clmul_lo(x4, k), x4 = clmul_hi(x4, k);
+        x0 = veor3q_u64(x0, y0, x2);
+        x4 = veor3q_u64(x4, y4, x6);
+
+        /* Step 4: final fold (x0, x4) -> x0 */
+        { static const uint64_t ALIGNED_(16) k_[] = {0x8f352d95, 0x1d9513d7}; k = vld1q_u64(k_); }
+        y0 = clmul_lo(x0, k), x0 = clmul_hi(x0, k);
+        x0 = veor3q_u64(x0, y0, x4);
+
+        /* Process final scalar chunk */
+        crc0 = __crc32d(crc0, *(const uint64_t*)buf);
+        crc1 = __crc32d(crc1, *(const uint64_t*)(buf + klen));
+        crc2 = __crc32d(crc2, *(const uint64_t*)(buf + klen * 2));
+        crc0 = __crc32d(crc0, *(const uint64_t*)(buf + 8));
+        crc1 = __crc32d(crc1, *(const uint64_t*)(buf + klen + 8));
+        crc2 = __crc32d(crc2, *(const uint64_t*)(buf + klen * 2 + 8));
+
+        /* Shift and combine 3 scalar CRCs */
+        vc0 = crc_shift(crc0, klen * 2 + blk * 144);
+        vc1 = crc_shift(crc1, klen + blk * 144);
+        vc2 = crc_shift(crc2, blk * 144);
+        vc = vgetq_lane_u64(veor3q_u64(vc0, vc1, vc2), 0);
+
+        /* Final reduction: 128-bit vector + scalar CRCs -> 32-bit */
+        crc0 = __crc32d(0, vgetq_lane_u64(x0, 0));
+        crc0 = __crc32d(crc0, vc ^ vgetq_lane_u64(x0, 1));
+        buf = buf2;
+        len = end - buf;
+    }
+
+    /* 3-way scalar CRC (24 bytes/iter) */
+    if (len >= 80) {
+        size_t klen = ((len - 8) / 24) * 8;   /* Stride for 3-way parallel */
+        uint32_t crc1 = 0, crc2 = 0;
+        uint64x2_t vc0, vc1;
+        uint64_t vc;
+
+        /* 3-way parallel scalar CRC */
+        do {
+            crc0 = __crc32d(crc0, *(const uint64_t*)buf);
+            crc1 = __crc32d(crc1, *(const uint64_t*)(buf + klen));
+            crc2 = __crc32d(crc2, *(const uint64_t*)(buf + klen * 2));
+            buf += 8;
+            len -= 24;
+        } while (len >= 32);
+
+        /* Combine the 3 CRCs */
+        vc0 = crc_shift(crc0, klen * 2 + 8);
+        vc1 = crc_shift(crc1, klen + 8);
+        vc = vgetq_lane_u64(veorq_u64(vc0, vc1), 0);
+
+        /* Process final 8 bytes with combined CRC */
+        buf += klen * 2;
+        crc0 = crc2;
+        crc0 = __crc32d(crc0, *(const uint64_t*)buf ^ vc);
+        buf += 8;
+        len -= 8;
+    }
+
+    /* Process remaining bytes */
+    while (len >= 8) {
+        crc0 = __crc32d(crc0, *((uint64_t*)buf));
+        len -= 8;
+        buf += 8;
+    }
+
+    if (len & 4) {
+        crc0 = __crc32w(crc0, *((uint32_t*)buf));
+        buf += 4;
+    }
+
+    if (len & 2) {
+        crc0 = __crc32h(crc0, *((uint16_t*)buf));
+        buf += 2;
+    }
+
+    if (len & 1) {
+        crc0 = __crc32b(crc0, *buf);
+    }
+
+    return ~crc0;
+}
+
+Z_INTERNAL Z_TARGET_PMULL_EOR3 uint32_t crc32_copy_armv8_pmull_eor3(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_armv8_pmull_eor3(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
+#endif
diff --git a/arch/arm/neon_intrins.h b/arch/arm/neon_intrins.h
index a9e99ec8..ac9c86bf 100644
--- a/arch/arm/neon_intrins.h
+++ b/arch/arm/neon_intrins.h
@@ -1,14 +1,14 @@
 #ifndef ARM_NEON_INTRINS_H
 #define ARM_NEON_INTRINS_H
 
-#if defined(_MSC_VER) && (defined(_M_ARM64) || defined(_M_ARM64EC))
+#if defined(_MSC_VER) && defined(ARCH_ARM) && defined(ARCH_64BIT)
 /* arm64_neon.h is MSVC specific */
 #  include <arm64_neon.h>
 #else
 #  include <arm_neon.h>
 #endif
 
-#if defined(ARM_NEON) && !defined(__aarch64__) && !defined(_M_ARM64) && !defined(_M_ARM64EC)
+#if defined(ARM_NEON) && defined(ARCH_ARM) && defined(ARCH_32BIT)
 /* Compatibility shim for the _high family of functions */
 #define vmull_high_u8(a, b) vmull_u8(vget_high_u8(a), vget_high_u8(b))
 #define vmlal_high_u8(a, b, c) vmlal_u8(a, vget_high_u8(b), vget_high_u8(c))
@@ -25,8 +25,10 @@
     out.val[3] = vqsubq_u16(a.val[3], b); \
 } while (0)
 
-#  if defined(__clang__) && defined(__arm__) && defined(__ANDROID__)
-/* Clang for 32-bit Android has too strict alignment requirement (:256) for x4 NEON intrinsics */
+#  if defined(ARCH_ARM) && defined(ARCH_32BIT) && defined(__clang__) && \
+    (!defined(__clang_major__) || __clang_major__ < 20)
+/* Clang versions before 20 have too strict of an
+ * alignment requirement (:256) for x4 NEON intrinsics */
 #    undef ARM_NEON_HASLD4
 #    undef vld1q_u16_x4
 #    undef vld1q_u8_x4
@@ -36,20 +38,20 @@
 #  ifndef ARM_NEON_HASLD4
 
 static inline uint16x8x4_t vld1q_u16_x4(uint16_t const *a) {
-    uint16x8x4_t ret = (uint16x8x4_t) {{
-                          vld1q_u16(a),
-                          vld1q_u16(a+8),
-                          vld1q_u16(a+16),
-                          vld1q_u16(a+24)}};
+    uint16x8x4_t ret;
+    ret.val[0] = vld1q_u16(a);
+    ret.val[1] = vld1q_u16(a+8);
+    ret.val[2] = vld1q_u16(a+16);
+    ret.val[3] = vld1q_u16(a+24);
     return ret;
 }
 
 static inline uint8x16x4_t vld1q_u8_x4(uint8_t const *a) {
-    uint8x16x4_t ret = (uint8x16x4_t) {{
-                          vld1q_u8(a),
-                          vld1q_u8(a+16),
-                          vld1q_u8(a+32),
-                          vld1q_u8(a+48)}};
+    uint8x16x4_t ret;
+    ret.val[0] = vld1q_u8(a);
+    ret.val[1] = vld1q_u8(a+16);
+    ret.val[2] = vld1q_u8(a+32);
+    ret.val[3] = vld1q_u8(a+48);
     return ret;
 }
 
diff --git a/arch/arm/slide_hash_armv6.c b/arch/arm/slide_hash_armv6.c
index 07f71b59..da4f51e0 100644
--- a/arch/arm/slide_hash_armv6.c
+++ b/arch/arm/slide_hash_armv6.c
@@ -39,7 +39,8 @@ static inline void slide_hash_chain(Pos *table, uint32_t entries, uint16_t wsize
 }
 
 Z_INTERNAL void slide_hash_armv6(deflate_state *s) {
-    unsigned int wsize = s->w_size;
+    Assert(s->w_size <= UINT16_MAX, "w_size should fit in uint16_t");
+    uint16_t wsize = (uint16_t)s->w_size;
 
     slide_hash_chain(s->head, HASH_SIZE, wsize);
     slide_hash_chain(s->prev, wsize, wsize);
diff --git a/arch/arm/slide_hash_neon.c b/arch/arm/slide_hash_neon.c
index a601e609..f319f987 100644
--- a/arch/arm/slide_hash_neon.c
+++ b/arch/arm/slide_hash_neon.c
@@ -38,7 +38,8 @@ static inline void slide_hash_chain(Pos *table, uint32_t entries, uint16_t wsize
 }
 
 Z_INTERNAL void slide_hash_neon(deflate_state *s) {
-    unsigned int wsize = s->w_size;
+    Assert(s->w_size <= UINT16_MAX, "w_size should fit in uint16_t");
+    uint16_t wsize = (uint16_t)s->w_size;
 
     slide_hash_chain(s->head, HASH_SIZE, wsize);
     slide_hash_chain(s->prev, wsize, wsize);
diff --git a/arch/generic/Makefile.in b/arch/generic/Makefile.in
index 32c8242d..07a168f2 100644
--- a/arch/generic/Makefile.in
+++ b/arch/generic/Makefile.in
@@ -14,11 +14,10 @@ TOPDIR=$(SRCTOP)
 
 all: \
  adler32_c.o adler32_c.lo \
- adler32_fold_c.o adler32_fold_c.lo \
  chunkset_c.o chunkset_c.lo \
  compare256_c.o compare256_c.lo \
  crc32_braid_c.o crc32_braid_c.lo \
- crc32_fold_c.o crc32_fold_c.lo \
+ crc32_chorba_c.o crc32_chorba_c.lo \
  slide_hash_c.o slide_hash_c.lo
 
 
@@ -28,22 +27,16 @@ adler32_c.o: $(SRCDIR)/adler32_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/adler32_p.h
 adler32_c.lo: $(SRCDIR)/adler32_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/adler32_p.h
 	$(CC) $(SFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_c.c
 
-adler32_fold_c.o: $(SRCDIR)/adler32_fold_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/functable.h
-	$(CC) $(CFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_fold_c.c
-
-adler32_fold_c.lo: $(SRCDIR)/adler32_fold_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/functable.h
-	$(CC) $(SFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_fold_c.c
-
 chunkset_c.o: $(SRCDIR)/chunkset_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/chunkset_tpl.h $(SRCTOP)/inffast_tpl.h
 	$(CC) $(CFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_c.c
 
 chunkset_c.lo: $(SRCDIR)/chunkset_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/chunkset_tpl.h $(SRCTOP)/inffast_tpl.h
 	$(CC) $(SFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_c.c
 
-compare256_c.o: $(SRCDIR)/compare256_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/zutil_p.h $(SRCTOP)/deflate.h $(SRCTOP)/fallback_builtins.h
+compare256_c.o: $(SRCDIR)/compare256_c.c  $(SRCTOP)/zbuild.h $(SRCDIR)/compare256_p.h $(SRCTOP)/zmemory.h $(SRCTOP)/deflate.h $(SRCTOP)/fallback_builtins.h
 	$(CC) $(CFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_c.c
 
-compare256_c.lo: $(SRCDIR)/compare256_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/zutil_p.h $(SRCTOP)/deflate.h $(SRCTOP)/fallback_builtins.h
+compare256_c.lo: $(SRCDIR)/compare256_c.c  $(SRCTOP)/zbuild.h $(SRCDIR)/compare256_p.h $(SRCTOP)/zmemory.h $(SRCTOP)/deflate.h $(SRCTOP)/fallback_builtins.h
 	$(CC) $(SFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_c.c
 
 crc32_braid_c.o: $(SRCDIR)/crc32_braid_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/crc32_braid_p.h $(SRCTOP)/crc32_braid_tbl.h
@@ -52,11 +45,11 @@ crc32_braid_c.o: $(SRCDIR)/crc32_braid_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/crc32_b
 crc32_braid_c.lo: $(SRCDIR)/crc32_braid_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/crc32_braid_p.h $(SRCTOP)/crc32_braid_tbl.h
 	$(CC) $(SFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_braid_c.c
 
-crc32_fold_c.o: $(SRCDIR)/crc32_fold_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/functable.h
-	$(CC) $(CFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_fold_c.c
+crc32_chorba_c.o: $(SRCDIR)/crc32_chorba_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/crc32_braid_p.h $(SRCTOP)/crc32_braid_tbl.h
+	$(CC) $(CFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_chorba_c.c
 
-crc32_fold_c.lo: $(SRCDIR)/crc32_fold_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/functable.h
-	$(CC) $(SFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_fold_c.c
+crc32_chorba_c.lo: $(SRCDIR)/crc32_chorba_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/crc32_braid_p.h $(SRCTOP)/crc32_braid_tbl.h
+	$(CC) $(SFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_chorba_c.c
 
 slide_hash_c.o: $(SRCDIR)/slide_hash_c.c  $(SRCTOP)/zbuild.h $(SRCTOP)/deflate.h
 	$(CC) $(CFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/slide_hash_c.c
diff --git a/arch/generic/adler32_c.c b/arch/generic/adler32_c.c
index 64258c89..4bd55381 100644
--- a/arch/generic/adler32_c.c
+++ b/arch/generic/adler32_c.c
@@ -7,7 +7,6 @@
 #include "functable.h"
 #include "adler32_p.h"
 
-/* ========================================================================= */
 Z_INTERNAL uint32_t adler32_c(uint32_t adler, const uint8_t *buf, size_t len) {
     uint32_t sum2;
     unsigned n;
@@ -18,15 +17,11 @@ Z_INTERNAL uint32_t adler32_c(uint32_t adler, const uint8_t *buf, size_t len) {
 
     /* in case user likes doing a byte at a time, keep it fast */
     if (UNLIKELY(len == 1))
-        return adler32_len_1(adler, buf, sum2);
-
-    /* initial Adler-32 value (deferred check for len == 1 speed) */
-    if (UNLIKELY(buf == NULL))
-        return 1L;
+        return adler32_copy_len_1(adler, NULL, buf, sum2, 0);
 
     /* in case short lengths are provided, keep it somewhat fast */
     if (UNLIKELY(len < 16))
-        return adler32_len_16(adler, buf, len, sum2);
+        return adler32_copy_len_16(adler, NULL, buf, len, sum2, 0);
 
     /* do length NMAX blocks -- requires just one modulo operation */
     while (len >= NMAX) {
@@ -38,10 +33,10 @@ Z_INTERNAL uint32_t adler32_c(uint32_t adler, const uint8_t *buf, size_t len) {
 #endif
         do {
 #ifdef UNROLL_MORE
-            DO16(adler, sum2, buf);          /* 16 sums unrolled */
+            ADLER_DO16(adler, sum2, buf);          /* 16 sums unrolled */
             buf += 16;
 #else
-            DO8(adler, sum2, buf, 0);         /* 8 sums unrolled */
+            ADLER_DO8(adler, sum2, buf, 0);         /* 8 sums unrolled */
             buf += 8;
 #endif
         } while (--n);
@@ -50,5 +45,11 @@ Z_INTERNAL uint32_t adler32_c(uint32_t adler, const uint8_t *buf, size_t len) {
     }
 
     /* do remaining bytes (less than NMAX, still just one modulo) */
-    return adler32_len_64(adler, buf, len, sum2);
+    return adler32_copy_len_64(adler, NULL, buf, len, sum2, 0);
+}
+
+Z_INTERNAL uint32_t adler32_copy_c(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    adler = FUNCTABLE_CALL(adler32)(adler, src, len);
+    memcpy(dst, src, len);
+    return adler;
 }
diff --git a/arch/generic/adler32_fold_c.c b/arch/generic/adler32_fold_c.c
deleted file mode 100644
index 397dd104..00000000
--- a/arch/generic/adler32_fold_c.c
+++ /dev/null
@@ -1,15 +0,0 @@
-/* adler32_fold.c -- adler32 folding interface
- * Copyright (C) 2022 Adam Stylinski
- * For conditions of distribution and use, see copyright notice in zlib.h
- */
-
-#include "zbuild.h"
-#include "functable.h"
-
-#include <limits.h>
-
-Z_INTERNAL uint32_t adler32_fold_copy_c(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
-    adler = FUNCTABLE_CALL(adler32)(adler, src, len);
-    memcpy(dst, src, len);
-    return adler;
-}
diff --git a/arch/generic/chunk_128bit_perm_idx_lut.h b/arch/generic/chunk_128bit_perm_idx_lut.h
new file mode 100644
index 00000000..6e5098bf
--- /dev/null
+++ b/arch/generic/chunk_128bit_perm_idx_lut.h
@@ -0,0 +1,26 @@
+/* chunk_128bit_perm_idx_lut.h - shared SSSE3/NEON/LSX permutation idx lut for use with chunkmemset family of functions.
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#ifndef CHUNK_128BIT_PERM_IDX_LUT_H_
+#define CHUNK_128BIT_PERM_IDX_LUT_H_
+
+#include "chunk_permute_table.h"
+
+static const lut_rem_pair perm_idx_lut[13] = {
+    {0, 1},      /* 3 */
+    {0, 0},      /* don't care */
+    {1 * 32, 1}, /* 5 */
+    {2 * 32, 4}, /* 6 */
+    {3 * 32, 2}, /* 7 */
+    {0 * 32, 0}, /* don't care */
+    {4 * 32, 7}, /* 9 */
+    {5 * 32, 6}, /* 10 */
+    {6 * 32, 5}, /* 11 */
+    {7 * 32, 4}, /* 12 */
+    {8 * 32, 3}, /* 13 */
+    {9 * 32, 2}, /* 14 */
+    {10 * 32, 1},/* 15 */
+};
+
+#endif
diff --git a/arch/generic/chunk_256bit_perm_idx_lut.h b/arch/generic/chunk_256bit_perm_idx_lut.h
new file mode 100644
index 00000000..796a7df1
--- /dev/null
+++ b/arch/generic/chunk_256bit_perm_idx_lut.h
@@ -0,0 +1,47 @@
+/* chunk_256bit_perm_idx_lut.h - shared AVX512/AVX2/LASX permutation idx lut for use with chunkmemset family of functions.
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+#ifndef CHUNK_256BIT_PERM_IDX_LUT_H_
+#define CHUNK_256BIT_PERM_IDX_LUT_H_
+
+#include "chunk_permute_table.h"
+
+/* Populate don't cares so that this is a direct lookup (with some indirection into the permute table), because dist can
+ * never be 0 - 2, we'll start with an offset, subtracting 3 from the input */
+static const lut_rem_pair perm_idx_lut[29] = {
+    { 0, 2},                /* 3 */
+    { 0, 0},                /* don't care */
+    { 1 * 32, 2},           /* 5 */
+    { 2 * 32, 2},           /* 6 */
+    { 3 * 32, 4},           /* 7 */
+    { 0 * 32, 0},           /* don't care */
+    { 4 * 32, 5},           /* 9 */
+    { 5 * 32, 22},          /* 10 */
+    { 6 * 32, 21},          /* 11 */
+    { 7 * 32, 20},          /* 12 */
+    { 8 * 32, 6},           /* 13 */
+    { 9 * 32, 4},           /* 14 */
+    {10 * 32, 2},           /* 15 */
+    { 0 * 32, 0},           /* don't care */
+    {11 * 32, 15},          /* 17 */
+    {11 * 32 + 16, 14},     /* 18 */
+    {11 * 32 + 16 * 2, 13}, /* 19 */
+    {11 * 32 + 16 * 3, 12}, /* 20 */
+    {11 * 32 + 16 * 4, 11}, /* 21 */
+    {11 * 32 + 16 * 5, 10}, /* 22 */
+    {11 * 32 + 16 * 6,  9}, /* 23 */
+    {11 * 32 + 16 * 7,  8}, /* 24 */
+    {11 * 32 + 16 * 8,  7}, /* 25 */
+    {11 * 32 + 16 * 9,  6}, /* 26 */
+    {11 * 32 + 16 * 10, 5}, /* 27 */
+    {11 * 32 + 16 * 11, 4}, /* 28 */
+    {11 * 32 + 16 * 12, 3}, /* 29 */
+    {11 * 32 + 16 * 13, 2}, /* 30 */
+    {11 * 32 + 16 * 14, 1}  /* 31 */
+};
+
+static const uint16_t half_rem_vals[13] = {
+    1, 0, 1, 4, 2, 0, 7, 6, 5, 4, 3, 2, 1
+};
+
+#endif
diff --git a/arch/generic/chunkset_c.c b/arch/generic/chunkset_c.c
index 7b2bb7ba..0a585e6c 100644
--- a/arch/generic/chunkset_c.c
+++ b/arch/generic/chunkset_c.c
@@ -3,6 +3,7 @@
  */
 
 #include "zbuild.h"
+#include "zmemory.h"
 
 typedef uint64_t chunk_t;
 
@@ -12,21 +13,20 @@ typedef uint64_t chunk_t;
 #define HAVE_CHUNKMEMSET_8
 
 static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
-    uint8_t *dest = (uint8_t *)chunk;
-    memcpy(dest, from, sizeof(uint32_t));
-    memcpy(dest+4, from, sizeof(uint32_t));
+    uint32_t tmp = zng_memread_4(from);
+    *chunk = tmp | ((chunk_t)tmp << 32);
 }
 
 static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
-    memcpy(chunk, from, sizeof(uint64_t));
+    *chunk = zng_memread_8(from);
 }
 
 static inline void loadchunk(uint8_t const *s, chunk_t *chunk) {
-    memcpy(chunk, (uint8_t *)s, sizeof(uint64_t));
+    *chunk = zng_memread_8(s);
 }
 
 static inline void storechunk(uint8_t *out, chunk_t *chunk) {
-    memcpy(out, chunk, sizeof(uint64_t));
+    zng_memwrite_8(out, *chunk);
 }
 
 #define CHUNKSIZE        chunksize_c
diff --git a/arch/generic/compare256_c.c b/arch/generic/compare256_c.c
index 0c12cb3a..ad535523 100644
--- a/arch/generic/compare256_c.c
+++ b/arch/generic/compare256_c.c
@@ -4,178 +4,28 @@
  */
 
 #include "zbuild.h"
-#include "zutil_p.h"
-#include "deflate.h"
-#include "fallback_builtins.h"
-
-/* ALIGNED, byte comparison */
-static inline uint32_t compare256_c_static(const uint8_t *src0, const uint8_t *src1) {
-    uint32_t len = 0;
-
-    do {
-        if (*src0 != *src1)
-            return len;
-        src0 += 1, src1 += 1, len += 1;
-        if (*src0 != *src1)
-            return len;
-        src0 += 1, src1 += 1, len += 1;
-        if (*src0 != *src1)
-            return len;
-        src0 += 1, src1 += 1, len += 1;
-        if (*src0 != *src1)
-            return len;
-        src0 += 1, src1 += 1, len += 1;
-        if (*src0 != *src1)
-            return len;
-        src0 += 1, src1 += 1, len += 1;
-        if (*src0 != *src1)
-            return len;
-        src0 += 1, src1 += 1, len += 1;
-        if (*src0 != *src1)
-            return len;
-        src0 += 1, src1 += 1, len += 1;
-        if (*src0 != *src1)
-            return len;
-        src0 += 1, src1 += 1, len += 1;
-    } while (len < 256);
-
-    return 256;
-}
+#include "compare256_p.h"
+
+// Set optimal COMPARE256 function variant
+#if OPTIMAL_CMP == 8
+#  define COMPARE256          compare256_8
+#elif defined(HAVE_BUILTIN_CTZLL)
+#  define COMPARE256          compare256_64
+#elif defined(HAVE_BUILTIN_CTZ)
+#  define COMPARE256          compare256_32
+#else
+#  define COMPARE256          compare256_16
+#endif
 
 Z_INTERNAL uint32_t compare256_c(const uint8_t *src0, const uint8_t *src1) {
-    return compare256_c_static(src0, src1);
+    return COMPARE256(src0, src1);
 }
 
+// Generate longest_match_c
 #define LONGEST_MATCH       longest_match_c
-#define COMPARE256          compare256_c_static
-
 #include "match_tpl.h"
 
+// Generate longest_match_slow_c
 #define LONGEST_MATCH_SLOW
 #define LONGEST_MATCH       longest_match_slow_c
-#define COMPARE256          compare256_c_static
-
 #include "match_tpl.h"
-
-#if defined(UNALIGNED_OK) && BYTE_ORDER == LITTLE_ENDIAN
-/* 16-bit unaligned integer comparison */
-static inline uint32_t compare256_unaligned_16_static(const uint8_t *src0, const uint8_t *src1) {
-    uint32_t len = 0;
-
-    do {
-        if (zng_memcmp_2(src0, src1) != 0)
-            return len + (*src0 == *src1);
-        src0 += 2, src1 += 2, len += 2;
-
-        if (zng_memcmp_2(src0, src1) != 0)
-            return len + (*src0 == *src1);
-        src0 += 2, src1 += 2, len += 2;
-
-        if (zng_memcmp_2(src0, src1) != 0)
-            return len + (*src0 == *src1);
-        src0 += 2, src1 += 2, len += 2;
-
-        if (zng_memcmp_2(src0, src1) != 0)
-            return len + (*src0 == *src1);
-        src0 += 2, src1 += 2, len += 2;
-    } while (len < 256);
-
-    return 256;
-}
-
-Z_INTERNAL uint32_t compare256_unaligned_16(const uint8_t *src0, const uint8_t *src1) {
-    return compare256_unaligned_16_static(src0, src1);
-}
-
-#define LONGEST_MATCH       longest_match_unaligned_16
-#define COMPARE256          compare256_unaligned_16_static
-
-#include "match_tpl.h"
-
-#define LONGEST_MATCH_SLOW
-#define LONGEST_MATCH       longest_match_slow_unaligned_16
-#define COMPARE256          compare256_unaligned_16_static
-
-#include "match_tpl.h"
-
-#ifdef HAVE_BUILTIN_CTZ
-/* 32-bit unaligned integer comparison */
-static inline uint32_t compare256_unaligned_32_static(const uint8_t *src0, const uint8_t *src1) {
-    uint32_t len = 0;
-
-    do {
-        uint32_t sv, mv, diff;
-
-        memcpy(&sv, src0, sizeof(sv));
-        memcpy(&mv, src1, sizeof(mv));
-
-        diff = sv ^ mv;
-        if (diff) {
-            uint32_t match_byte = __builtin_ctz(diff) / 8;
-            return len + match_byte;
-        }
-
-        src0 += 4, src1 += 4, len += 4;
-    } while (len < 256);
-
-    return 256;
-}
-
-Z_INTERNAL uint32_t compare256_unaligned_32(const uint8_t *src0, const uint8_t *src1) {
-    return compare256_unaligned_32_static(src0, src1);
-}
-
-#define LONGEST_MATCH       longest_match_unaligned_32
-#define COMPARE256          compare256_unaligned_32_static
-
-#include "match_tpl.h"
-
-#define LONGEST_MATCH_SLOW
-#define LONGEST_MATCH       longest_match_slow_unaligned_32
-#define COMPARE256          compare256_unaligned_32_static
-
-#include "match_tpl.h"
-
-#endif
-
-#if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-/* UNALIGNED64_OK, 64-bit integer comparison */
-static inline uint32_t compare256_unaligned_64_static(const uint8_t *src0, const uint8_t *src1) {
-    uint32_t len = 0;
-
-    do {
-        uint64_t sv, mv, diff;
-
-        memcpy(&sv, src0, sizeof(sv));
-        memcpy(&mv, src1, sizeof(mv));
-
-        diff = sv ^ mv;
-        if (diff) {
-            uint64_t match_byte = __builtin_ctzll(diff) / 8;
-            return len + (uint32_t)match_byte;
-        }
-
-        src0 += 8, src1 += 8, len += 8;
-    } while (len < 256);
-
-    return 256;
-}
-
-Z_INTERNAL uint32_t compare256_unaligned_64(const uint8_t *src0, const uint8_t *src1) {
-    return compare256_unaligned_64_static(src0, src1);
-}
-
-#define LONGEST_MATCH       longest_match_unaligned_64
-#define COMPARE256          compare256_unaligned_64_static
-
-#include "match_tpl.h"
-
-#define LONGEST_MATCH_SLOW
-#define LONGEST_MATCH       longest_match_slow_unaligned_64
-#define COMPARE256          compare256_unaligned_64_static
-
-#include "match_tpl.h"
-
-#endif
-
-#endif
diff --git a/arch/generic/compare256_p.h b/arch/generic/compare256_p.h
new file mode 100644
index 00000000..ac934841
--- /dev/null
+++ b/arch/generic/compare256_p.h
@@ -0,0 +1,123 @@
+/* compare256_p.h -- 256 byte memory comparison with match length return
+ * Copyright (C) 2020 Nathan Moinvaziri
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include "zmemory.h"
+#include "deflate.h"
+#include "fallback_builtins.h"
+
+/* 8-bit integer comparison */
+static inline uint32_t compare256_8(const uint8_t *src0, const uint8_t *src1) {
+    uint32_t len = 0;
+
+    do {
+        if (*src0 != *src1)
+            return len;
+        src0 += 1, src1 += 1, len += 1;
+        if (*src0 != *src1)
+            return len;
+        src0 += 1, src1 += 1, len += 1;
+        if (*src0 != *src1)
+            return len;
+        src0 += 1, src1 += 1, len += 1;
+        if (*src0 != *src1)
+            return len;
+        src0 += 1, src1 += 1, len += 1;
+        if (*src0 != *src1)
+            return len;
+        src0 += 1, src1 += 1, len += 1;
+        if (*src0 != *src1)
+            return len;
+        src0 += 1, src1 += 1, len += 1;
+        if (*src0 != *src1)
+            return len;
+        src0 += 1, src1 += 1, len += 1;
+        if (*src0 != *src1)
+            return len;
+        src0 += 1, src1 += 1, len += 1;
+    } while (len < 256);
+
+    return 256;
+}
+
+/* 16-bit integer comparison */
+static inline uint32_t compare256_16(const uint8_t *src0, const uint8_t *src1) {
+    uint32_t len = 0;
+
+    do {
+        if (zng_memcmp_2(src0, src1) != 0)
+            return len + (*src0 == *src1);
+        src0 += 2, src1 += 2, len += 2;
+
+        if (zng_memcmp_2(src0, src1) != 0)
+            return len + (*src0 == *src1);
+        src0 += 2, src1 += 2, len += 2;
+
+        if (zng_memcmp_2(src0, src1) != 0)
+            return len + (*src0 == *src1);
+        src0 += 2, src1 += 2, len += 2;
+
+        if (zng_memcmp_2(src0, src1) != 0)
+            return len + (*src0 == *src1);
+        src0 += 2, src1 += 2, len += 2;
+    } while (len < 256);
+
+    return 256;
+}
+
+#ifdef HAVE_BUILTIN_CTZ
+/* 32-bit integer comparison */
+static inline uint32_t compare256_32(const uint8_t *src0, const uint8_t *src1) {
+    uint32_t len = 0;
+
+    do {
+        uint32_t sv, mv, diff;
+
+        sv = zng_memread_4(src0);
+        mv = zng_memread_4(src1);
+
+        diff = sv ^ mv;
+        if (diff) {
+#  if BYTE_ORDER == LITTLE_ENDIAN
+            uint32_t match_byte = __builtin_ctz(diff) / 8;
+#  else
+            uint32_t match_byte = __builtin_clz(diff) / 8;
+#  endif
+            return len + match_byte;
+        }
+
+        src0 += 4, src1 += 4, len += 4;
+    } while (len < 256);
+
+    return 256;
+}
+#endif
+
+#ifdef HAVE_BUILTIN_CTZLL
+/* 64-bit integer comparison */
+static inline uint32_t compare256_64(const uint8_t *src0, const uint8_t *src1) {
+    uint32_t len = 0;
+
+    do {
+        uint64_t sv, mv, diff;
+
+        sv = zng_memread_8(src0);
+        mv = zng_memread_8(src1);
+
+        diff = sv ^ mv;
+        if (diff) {
+#  if BYTE_ORDER == LITTLE_ENDIAN
+            uint64_t match_byte = __builtin_ctzll(diff) / 8;
+#  else
+            uint64_t match_byte = __builtin_clzll(diff) / 8;
+#  endif
+            return len + (uint32_t)match_byte;
+        }
+
+        src0 += 8, src1 += 8, len += 8;
+    } while (len < 256);
+
+    return 256;
+}
+#endif
diff --git a/arch/generic/crc32_braid_c.c b/arch/generic/crc32_braid_c.c
index 7d8028f6..c56ba97b 100644
--- a/arch/generic/crc32_braid_c.c
+++ b/arch/generic/crc32_braid_c.c
@@ -12,87 +12,84 @@
 #include "crc32_braid_tbl.h"
 
 /*
-  A CRC of a message is computed on N braids of words in the message, where
-  each word consists of W bytes (4 or 8). If N is 3, for example, then three
-  running sparse CRCs are calculated respectively on each braid, at these
+  A CRC of a message is computed on BRAID_N braids of words in the message, where
+  each word consists of BRAID_W bytes (4 or 8). If BRAID_N is 3, for example, then
+  three running sparse CRCs are calculated respectively on each braid, at these
   indices in the array of words: 0, 3, 6, ..., 1, 4, 7, ..., and 2, 5, 8, ...
-  This is done starting at a word boundary, and continues until as many blocks
-  of N * W bytes as are available have been processed. The results are combined
-  into a single CRC at the end. For this code, N must be in the range 1..6 and
-  W must be 4 or 8. The upper limit on N can be increased if desired by adding
-  more #if blocks, extending the patterns apparent in the code. In addition,
-  crc32 tables would need to be regenerated, if the maximum N value is increased.
-
-  N and W are chosen empirically by benchmarking the execution time on a given
-  processor. The choices for N and W below were based on testing on Intel Kaby
-  Lake i7, AMD Ryzen 7, ARM Cortex-A57, Sparc64-VII, PowerPC POWER9, and MIPS64
-  Octeon II processors. The Intel, AMD, and ARM processors were all fastest
-  with N=5, W=8. The Sparc, PowerPC, and MIPS64 were all fastest at N=5, W=4.
+  This is done starting at a word boundary, and continues until as many blocks of
+  BRAID_N * BRAID_W bytes as are available have been processed. The results are
+  combined into a single CRC at the end. For this code, BRAID_N must be in the
+  range 1..6 and BRAID_W must be 4 or 8. The upper limit on BRAID_N can be increased
+  if desired by adding more #if blocks, extending the patterns apparent in the code.
+  In addition, crc32 tables would need to be regenerated, if the maximum BRAID_N
+  value is increased.
+
+  BRAID_N and BRAID_W are chosen empirically by benchmarking the execution time
+  on a given processor. The choices for BRAID_N and BRAID_W below were based on
+  testing on Intel Kaby Lake i7, AMD Ryzen 7, ARM Cortex-A57, Sparc64-VII, PowerPC
+  POWER9, and MIPS64 Octeon II processors.
+  The Intel, AMD, and ARM processors were all fastest with BRAID_N=5, BRAID_W=8.
+  The Sparc, PowerPC, and MIPS64 were all fastest at BRAID_N=5, BRAID_W=4.
   They were all tested with either gcc or clang, all using the -O3 optimization
   level. Your mileage may vary.
 */
 
 /* ========================================================================= */
-#ifdef W
+#ifdef BRAID_W
 /*
-  Return the CRC of the W bytes in the word_t data, taking the
+  Return the CRC of the BRAID_W bytes in the word_t data, taking the
   least-significant byte of the word as the first byte of data, without any pre
   or post conditioning. This is used to combine the CRCs of each braid.
  */
-#if BYTE_ORDER == LITTLE_ENDIAN
+#  if BYTE_ORDER == LITTLE_ENDIAN
 static uint32_t crc_word(z_word_t data) {
     int k;
-    for (k = 0; k < W; k++)
+    for (k = 0; k < BRAID_W; k++)
         data = (data >> 8) ^ crc_table[data & 0xff];
     return (uint32_t)data;
 }
-#elif BYTE_ORDER == BIG_ENDIAN
+#  elif BYTE_ORDER == BIG_ENDIAN
 static z_word_t crc_word(z_word_t data) {
     int k;
-    for (k = 0; k < W; k++)
+    for (k = 0; k < BRAID_W; k++)
         data = (data << 8) ^
-            crc_big_table[(data >> ((W - 1) << 3)) & 0xff];
+            crc_big_table[(data >> ((BRAID_W - 1) << 3)) & 0xff];
     return data;
 }
-#endif /* BYTE_ORDER */
-
-#endif /* W */
+#  endif /* BYTE_ORDER */
+#endif /* BRAID_W */
 
 /* ========================================================================= */
-Z_INTERNAL uint32_t PREFIX(crc32_braid)(uint32_t crc, const uint8_t *buf, size_t len) {
-    uint32_t c;
-
-    /* Pre-condition the CRC */
-    c = (~crc) & 0xffffffff;
+Z_INTERNAL uint32_t crc32_braid_internal(uint32_t c, const uint8_t *buf, size_t len) {
 
-#ifdef W
+#ifdef BRAID_W
     /* If provided enough bytes, do a braided CRC calculation. */
-    if (len >= N * W + W - 1) {
+    if (len >= BRAID_N * BRAID_W + BRAID_W - 1) {
         size_t blks;
         z_word_t const *words;
         int k;
 
         /* Compute the CRC up to a z_word_t boundary. */
-        while (len && ((uintptr_t)buf & (W - 1)) != 0) {
-            len--;
-            DO1;
-        }
-
-        /* Compute the CRC on as many N z_word_t blocks as are available. */
-        blks = len / (N * W);
-        len -= blks * N * W;
+        size_t align_diff = (size_t)MIN(ALIGN_DIFF(buf, BRAID_W), len);
+        len -= align_diff;
+        while (align_diff--)
+            CRC_DO1;
+
+        /* Compute the CRC on as many BRAID_N z_word_t blocks as are available. */
+        blks = len / (BRAID_N * BRAID_W);
+        len -= blks * BRAID_N * BRAID_W;
         words = (z_word_t const *)buf;
 
         z_word_t crc0, word0, comb;
-#if N > 1
+#if BRAID_N > 1
         z_word_t crc1, word1;
-#if N > 2
+#if BRAID_N > 2
         z_word_t crc2, word2;
-#if N > 3
+#if BRAID_N > 3
         z_word_t crc3, word3;
-#if N > 4
+#if BRAID_N > 4
         z_word_t crc4, word4;
-#if N > 5
+#if BRAID_N > 5
         z_word_t crc5, word5;
 #endif
 #endif
@@ -101,15 +98,15 @@ Z_INTERNAL uint32_t PREFIX(crc32_braid)(uint32_t crc, const uint8_t *buf, size_t
 #endif
         /* Initialize the CRC for each braid. */
         crc0 = ZSWAPWORD(c);
-#if N > 1
+#if BRAID_N > 1
         crc1 = 0;
-#if N > 2
+#if BRAID_N > 2
         crc2 = 0;
-#if N > 3
+#if BRAID_N > 3
         crc3 = 0;
-#if N > 4
+#if BRAID_N > 4
         crc4 = 0;
-#if N > 5
+#if BRAID_N > 5
         crc5 = 0;
 #endif
 #endif
@@ -120,51 +117,51 @@ Z_INTERNAL uint32_t PREFIX(crc32_braid)(uint32_t crc, const uint8_t *buf, size_t
         while (--blks) {
             /* Load the word for each braid into registers. */
             word0 = crc0 ^ words[0];
-#if N > 1
+#if BRAID_N > 1
             word1 = crc1 ^ words[1];
-#if N > 2
+#if BRAID_N > 2
             word2 = crc2 ^ words[2];
-#if N > 3
+#if BRAID_N > 3
             word3 = crc3 ^ words[3];
-#if N > 4
+#if BRAID_N > 4
             word4 = crc4 ^ words[4];
-#if N > 5
+#if BRAID_N > 5
             word5 = crc5 ^ words[5];
 #endif
 #endif
 #endif
 #endif
 #endif
-            words += N;
+            words += BRAID_N;
 
             /* Compute and update the CRC for each word. The loop should get unrolled. */
             crc0 = BRAID_TABLE[0][word0 & 0xff];
-#if N > 1
+#if BRAID_N > 1
             crc1 = BRAID_TABLE[0][word1 & 0xff];
-#if N > 2
+#if BRAID_N > 2
             crc2 = BRAID_TABLE[0][word2 & 0xff];
-#if N > 3
+#if BRAID_N > 3
             crc3 = BRAID_TABLE[0][word3 & 0xff];
-#if N > 4
+#if BRAID_N > 4
             crc4 = BRAID_TABLE[0][word4 & 0xff];
-#if N > 5
+#if BRAID_N > 5
             crc5 = BRAID_TABLE[0][word5 & 0xff];
 #endif
 #endif
 #endif
 #endif
 #endif
-            for (k = 1; k < W; k++) {
+            for (k = 1; k < BRAID_W; k++) {
                 crc0 ^= BRAID_TABLE[k][(word0 >> (k << 3)) & 0xff];
-#if N > 1
+#if BRAID_N > 1
                 crc1 ^= BRAID_TABLE[k][(word1 >> (k << 3)) & 0xff];
-#if N > 2
+#if BRAID_N > 2
                 crc2 ^= BRAID_TABLE[k][(word2 >> (k << 3)) & 0xff];
-#if N > 3
+#if BRAID_N > 3
                 crc3 ^= BRAID_TABLE[k][(word3 >> (k << 3)) & 0xff];
-#if N > 4
+#if BRAID_N > 4
                 crc4 ^= BRAID_TABLE[k][(word4 >> (k << 3)) & 0xff];
-#if N > 5
+#if BRAID_N > 5
                 crc5 ^= BRAID_TABLE[k][(word5 >> (k << 3)) & 0xff];
 #endif
 #endif
@@ -174,42 +171,52 @@ Z_INTERNAL uint32_t PREFIX(crc32_braid)(uint32_t crc, const uint8_t *buf, size_t
             }
         }
 
-        /* Process the last block, combining the CRCs of the N braids at the same time. */
+        /* Process the last block, combining the CRCs of the BRAID_N braids at the same time. */
         comb = crc_word(crc0 ^ words[0]);
-#if N > 1
+#if BRAID_N > 1
         comb = crc_word(crc1 ^ words[1] ^ comb);
-#if N > 2
+#if BRAID_N > 2
         comb = crc_word(crc2 ^ words[2] ^ comb);
-#if N > 3
+#if BRAID_N > 3
         comb = crc_word(crc3 ^ words[3] ^ comb);
-#if N > 4
+#if BRAID_N > 4
         comb = crc_word(crc4 ^ words[4] ^ comb);
-#if N > 5
+#if BRAID_N > 5
         comb = crc_word(crc5 ^ words[5] ^ comb);
 #endif
 #endif
 #endif
 #endif
 #endif
-        words += N;
-        c = ZSWAPWORD(comb);
+        words += BRAID_N;
+        Assert(comb <= UINT32_MAX, "comb should fit in uint32_t");
+        c = (uint32_t)ZSWAPWORD(comb);
 
         /* Update the pointer to the remaining bytes to process. */
         buf = (const unsigned char *)words;
     }
 
-#endif /* W */
+#endif /* BRAID_W */
 
     /* Complete the computation of the CRC on any remaining bytes. */
     while (len >= 8) {
         len -= 8;
-        DO8;
+        CRC_DO8;
     }
     while (len) {
         len--;
-        DO1;
+        CRC_DO1;
     }
 
-    /* Return the CRC, post-conditioned. */
-    return c ^ 0xffffffff;
+    return c;
+}
+
+Z_INTERNAL uint32_t crc32_braid(uint32_t crc, const uint8_t *buf, size_t len) {
+    return ~crc32_braid_internal(~crc, buf, len);
+}
+
+Z_INTERNAL uint32_t crc32_copy_braid(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_braid(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
 }
diff --git a/arch/generic/crc32_chorba_c.c b/arch/generic/crc32_chorba_c.c
new file mode 100644
index 00000000..4be04f45
--- /dev/null
+++ b/arch/generic/crc32_chorba_c.c
@@ -0,0 +1,1491 @@
+#include "zbuild.h"
+#if defined(__EMSCRIPTEN__)
+#  include "zutil_p.h"
+#endif
+#include "zmemory.h"
+#include "crc32_braid_p.h"
+#include "crc32_braid_tbl.h"
+#include "generic_functions.h"
+
+/* Implement Chorba algorithm from https://arxiv.org/abs/2412.16398 */
+#define bitbuffersizebytes (16 * 1024 * sizeof(z_word_t))
+#define bitbuffersizezwords (bitbuffersizebytes / sizeof(z_word_t))
+#define bitbuffersizeqwords (bitbuffersizebytes / sizeof(uint64_t))
+
+#if defined(HAVE_MAY_ALIAS) && BRAID_W != 8
+    typedef uint64_t __attribute__ ((__may_alias__)) uint64a_t;
+#else
+    typedef uint64_t uint64a_t;
+#endif
+
+/**
+ * Implements the Chorba algorithm for CRC32 computation (https://arxiv.org/abs/2412.16398).
+ *
+ * This implementation processes data in three phases:
+ * 1. Initial pass: Zeros out bitbuffer
+ * 2. Intermediate pass: Processes half the values
+ * 3. Main pass: Processes remaining data
+ *
+ * @param crc Initial CRC value
+ * @param input Input data buffer
+ * @param len Length of input data
+ * @return Computed CRC32 value
+ *
+ * @note Requires minimum input size of 118960 + 512 bytes
+ * @note Uses 128KB temporary buffer
+ */
+Z_INTERNAL uint32_t crc32_chorba_118960_nondestructive (uint32_t crc, const z_word_t* input, size_t len) {
+#if defined(__EMSCRIPTEN__)
+    z_word_t* bitbuffer = (z_word_t*)zng_alloc(bitbuffersizebytes);
+#else
+    ALIGNED_(16) z_word_t bitbuffer[bitbuffersizezwords];
+#endif
+    const uint8_t* bitbufferbytes = (const uint8_t*) bitbuffer;
+    uint64a_t* bitbufferqwords = (uint64a_t*) bitbuffer;
+    const uint64a_t* inputqwords = (const uint64a_t*) input;
+
+    size_t i = 0;
+
+#if BYTE_ORDER == LITTLE_ENDIAN
+    z_word_t next1 = crc;
+#else
+    z_word_t next1 = ZSWAPWORD(crc);
+#endif
+
+    z_word_t next2 = 0;
+    z_word_t next3 = 0;
+    z_word_t next4 = 0;
+    z_word_t next5 = 0;
+    z_word_t next6 = 0;
+    z_word_t next7 = 0;
+    z_word_t next8 = 0;
+    z_word_t next9 = 0;
+    z_word_t next10 = 0;
+    z_word_t next11 = 0;
+    z_word_t next12 = 0;
+    z_word_t next13 = 0;
+    z_word_t next14 = 0;
+    z_word_t next15 = 0;
+    z_word_t next16 = 0;
+    z_word_t next17 = 0;
+    z_word_t next18 = 0;
+    z_word_t next19 = 0;
+    z_word_t next20 = 0;
+    z_word_t next21 = 0;
+    z_word_t next22 = 0;
+    crc = 0;
+
+    // do a first pass to zero out bitbuffer
+    for(; i < (14848 * sizeof(z_word_t)); i += (32 * sizeof(z_word_t))) {
+        z_word_t in1, in2, in3, in4, in5, in6, in7, in8;
+        z_word_t in9, in10, in11, in12, in13, in14, in15, in16;
+        z_word_t in17, in18, in19, in20, in21, in22, in23, in24;
+        z_word_t in25, in26, in27, in28, in29, in30, in31, in32;
+        int outoffset1 = ((i / sizeof(z_word_t)) + 14848) % bitbuffersizezwords;
+        int outoffset2 = ((i / sizeof(z_word_t)) + 14880) % bitbuffersizezwords;
+
+        in1 = input[i / sizeof(z_word_t) + 0] ^ next1;
+        in2 = input[i / sizeof(z_word_t) + 1] ^ next2;
+        in3 = input[i / sizeof(z_word_t) + 2] ^ next3;
+        in4 = input[i / sizeof(z_word_t) + 3] ^ next4;
+        in5 = input[i / sizeof(z_word_t) + 4] ^ next5;
+        in6 = input[i / sizeof(z_word_t) + 5] ^ next6;
+        in7 = input[i / sizeof(z_word_t) + 6] ^ next7;
+        in8 = input[i / sizeof(z_word_t) + 7] ^ next8 ^ in1;
+        in9 = input[i / sizeof(z_word_t) + 8] ^ next9 ^ in2;
+        in10 = input[i / sizeof(z_word_t) + 9] ^ next10 ^ in3;
+        in11 = input[i / sizeof(z_word_t) + 10] ^ next11 ^ in4;
+        in12 = input[i / sizeof(z_word_t) + 11] ^ next12 ^ in1 ^ in5;
+        in13 = input[i / sizeof(z_word_t) + 12] ^ next13 ^ in2 ^ in6;
+        in14 = input[i / sizeof(z_word_t) + 13] ^ next14 ^ in3 ^ in7;
+        in15 = input[i / sizeof(z_word_t) + 14] ^ next15 ^ in4 ^ in8;
+        in16 = input[i / sizeof(z_word_t) + 15] ^ next16 ^ in5 ^ in9;
+        in17 = input[i / sizeof(z_word_t) + 16] ^ next17 ^ in6 ^ in10;
+        in18 = input[i / sizeof(z_word_t) + 17] ^ next18 ^ in7 ^ in11;
+        in19 = input[i / sizeof(z_word_t) + 18] ^ next19 ^ in8 ^ in12;
+        in20 = input[i / sizeof(z_word_t) + 19] ^ next20 ^ in9 ^ in13;
+        in21 = input[i / sizeof(z_word_t) + 20] ^ next21 ^ in10 ^ in14;
+        in22 = input[i / sizeof(z_word_t) + 21] ^ next22 ^ in11 ^ in15;
+        in23 = input[i / sizeof(z_word_t) + 22] ^ in1 ^ in12 ^ in16;
+        in24 = input[i / sizeof(z_word_t) + 23] ^ in2 ^ in13 ^ in17;
+        in25 = input[i / sizeof(z_word_t) + 24] ^ in3 ^ in14 ^ in18;
+        in26 = input[i / sizeof(z_word_t) + 25] ^ in4 ^ in15 ^ in19;
+        in27 = input[i / sizeof(z_word_t) + 26] ^ in5 ^ in16 ^ in20;
+        in28 = input[i / sizeof(z_word_t) + 27] ^ in6 ^ in17 ^ in21;
+        in29 = input[i / sizeof(z_word_t) + 28] ^ in7 ^ in18 ^ in22;
+        in30 = input[i / sizeof(z_word_t) + 29] ^ in8 ^ in19 ^ in23;
+        in31 = input[i / sizeof(z_word_t) + 30] ^ in9 ^ in20 ^ in24;
+        in32 = input[i / sizeof(z_word_t) + 31] ^ in10 ^ in21 ^ in25;
+
+        next1 = in11 ^ in22 ^ in26;
+        next2 = in12 ^ in23 ^ in27;
+        next3 = in13 ^ in24 ^ in28;
+        next4 = in14 ^ in25 ^ in29;
+        next5 = in15 ^ in26 ^ in30;
+        next6 = in16 ^ in27 ^ in31;
+        next7 = in17 ^ in28 ^ in32;
+        next8 = in18 ^ in29;
+        next9 = in19 ^ in30;
+        next10 = in20 ^ in31;
+        next11 = in21 ^ in32;
+        next12 = in22;
+        next13 = in23;
+        next14 = in24;
+        next15 = in25;
+        next16 = in26;
+        next17 = in27;
+        next18 = in28;
+        next19 = in29;
+        next20 = in30;
+        next21 = in31;
+        next22 = in32;
+
+        bitbuffer[outoffset1 + 22] = in1;
+        bitbuffer[outoffset1 + 23] = in2;
+        bitbuffer[outoffset1 + 24] = in3;
+        bitbuffer[outoffset1 + 25] = in4;
+        bitbuffer[outoffset1 + 26] = in5;
+        bitbuffer[outoffset1 + 27] = in6;
+        bitbuffer[outoffset1 + 28] = in7;
+        bitbuffer[outoffset1 + 29] = in8;
+        bitbuffer[outoffset1 + 30] = in9;
+        bitbuffer[outoffset1 + 31] = in10;
+        bitbuffer[outoffset2 + 0] = in11;
+        bitbuffer[outoffset2 + 1] = in12;
+        bitbuffer[outoffset2 + 2] = in13;
+        bitbuffer[outoffset2 + 3] = in14;
+        bitbuffer[outoffset2 + 4] = in15;
+        bitbuffer[outoffset2 + 5] = in16;
+        bitbuffer[outoffset2 + 6] = in17;
+        bitbuffer[outoffset2 + 7] = in18;
+        bitbuffer[outoffset2 + 8] = in19;
+        bitbuffer[outoffset2 + 9] = in20;
+        bitbuffer[outoffset2 + 10] = in21;
+        bitbuffer[outoffset2 + 11] = in22;
+        bitbuffer[outoffset2 + 12] = in23;
+        bitbuffer[outoffset2 + 13] = in24;
+        bitbuffer[outoffset2 + 14] = in25;
+        bitbuffer[outoffset2 + 15] = in26;
+        bitbuffer[outoffset2 + 16] = in27;
+        bitbuffer[outoffset2 + 17] = in28;
+        bitbuffer[outoffset2 + 18] = in29;
+        bitbuffer[outoffset2 + 19] = in30;
+        bitbuffer[outoffset2 + 20] = in31;
+        bitbuffer[outoffset2 + 21] = in32;
+    }
+
+    // one intermediate pass where we pull half the values
+    for(; i < (14880 * sizeof(z_word_t)); i += (32 * sizeof(z_word_t))) {
+        z_word_t in1, in2, in3, in4, in5, in6, in7, in8;
+        z_word_t in9, in10, in11, in12, in13, in14, in15, in16;
+        z_word_t in17, in18, in19, in20, in21, in22, in23, in24;
+        z_word_t in25, in26, in27, in28, in29, in30, in31, in32;
+        int inoffset = (i / sizeof(z_word_t)) % bitbuffersizezwords;
+        int outoffset1 = ((i / sizeof(z_word_t)) + 14848) % bitbuffersizezwords;
+        int outoffset2 = ((i / sizeof(z_word_t)) + 14880) % bitbuffersizezwords;
+
+        in1 = input[i / sizeof(z_word_t) + 0] ^ next1;
+        in2 = input[i / sizeof(z_word_t) + 1] ^ next2;
+        in3 = input[i / sizeof(z_word_t) + 2] ^ next3;
+        in4 = input[i / sizeof(z_word_t) + 3] ^ next4;
+        in5 = input[i / sizeof(z_word_t) + 4] ^ next5;
+        in6 = input[i / sizeof(z_word_t) + 5] ^ next6;
+        in7 = input[i / sizeof(z_word_t) + 6] ^ next7;
+        in8 = input[i / sizeof(z_word_t) + 7] ^ next8 ^ in1;
+        in9 = input[i / sizeof(z_word_t) + 8] ^ next9 ^ in2;
+        in10 = input[i / sizeof(z_word_t) + 9] ^ next10 ^ in3;
+        in11 = input[i / sizeof(z_word_t) + 10] ^ next11 ^ in4;
+        in12 = input[i / sizeof(z_word_t) + 11] ^ next12 ^ in1 ^ in5;
+        in13 = input[i / sizeof(z_word_t) + 12] ^ next13 ^ in2 ^ in6;
+        in14 = input[i / sizeof(z_word_t) + 13] ^ next14 ^ in3 ^ in7;
+        in15 = input[i / sizeof(z_word_t) + 14] ^ next15 ^ in4 ^ in8;
+        in16 = input[i / sizeof(z_word_t) + 15] ^ next16 ^ in5 ^ in9;
+        in17 = input[i / sizeof(z_word_t) + 16] ^ next17 ^ in6 ^ in10;
+        in18 = input[i / sizeof(z_word_t) + 17] ^ next18 ^ in7 ^ in11;
+        in19 = input[i / sizeof(z_word_t) + 18] ^ next19 ^ in8 ^ in12;
+        in20 = input[i / sizeof(z_word_t) + 19] ^ next20 ^ in9 ^ in13;
+        in21 = input[i / sizeof(z_word_t) + 20] ^ next21 ^ in10 ^ in14;
+        in22 = input[i / sizeof(z_word_t) + 21] ^ next22 ^ in11 ^ in15;
+        in23 = input[i / sizeof(z_word_t) + 22] ^ in1 ^ in12 ^ in16 ^ bitbuffer[inoffset + 22];
+        in24 = input[i / sizeof(z_word_t) + 23] ^ in2 ^ in13 ^ in17 ^ bitbuffer[inoffset + 23];
+        in25 = input[i / sizeof(z_word_t) + 24] ^ in3 ^ in14 ^ in18 ^ bitbuffer[inoffset + 24];
+        in26 = input[i / sizeof(z_word_t) + 25] ^ in4 ^ in15 ^ in19 ^ bitbuffer[inoffset + 25];
+        in27 = input[i / sizeof(z_word_t) + 26] ^ in5 ^ in16 ^ in20 ^ bitbuffer[inoffset + 26];
+        in28 = input[i / sizeof(z_word_t) + 27] ^ in6 ^ in17 ^ in21 ^ bitbuffer[inoffset + 27];
+        in29 = input[i / sizeof(z_word_t) + 28] ^ in7 ^ in18 ^ in22 ^ bitbuffer[inoffset + 28];
+        in30 = input[i / sizeof(z_word_t) + 29] ^ in8 ^ in19 ^ in23 ^ bitbuffer[inoffset + 29];
+        in31 = input[i / sizeof(z_word_t) + 30] ^ in9 ^ in20 ^ in24 ^ bitbuffer[inoffset + 30];
+        in32 = input[i / sizeof(z_word_t) + 31] ^ in10 ^ in21 ^ in25 ^ bitbuffer[inoffset + 31];
+
+        next1 = in11 ^ in22 ^ in26;
+        next2 = in12 ^ in23 ^ in27;
+        next3 = in13 ^ in24 ^ in28;
+        next4 = in14 ^ in25 ^ in29;
+        next5 = in15 ^ in26 ^ in30;
+        next6 = in16 ^ in27 ^ in31;
+        next7 = in17 ^ in28 ^ in32;
+        next8 = in18 ^ in29;
+        next9 = in19 ^ in30;
+        next10 = in20 ^ in31;
+        next11 = in21 ^ in32;
+        next12 = in22;
+        next13 = in23;
+        next14 = in24;
+        next15 = in25;
+        next16 = in26;
+        next17 = in27;
+        next18 = in28;
+        next19 = in29;
+        next20 = in30;
+        next21 = in31;
+        next22 = in32;
+
+        bitbuffer[outoffset1 + 22] = in1;
+        bitbuffer[outoffset1 + 23] = in2;
+        bitbuffer[outoffset1 + 24] = in3;
+        bitbuffer[outoffset1 + 25] = in4;
+        bitbuffer[outoffset1 + 26] = in5;
+        bitbuffer[outoffset1 + 27] = in6;
+        bitbuffer[outoffset1 + 28] = in7;
+        bitbuffer[outoffset1 + 29] = in8;
+        bitbuffer[outoffset1 + 30] = in9;
+        bitbuffer[outoffset1 + 31] = in10;
+        bitbuffer[outoffset2 + 0] = in11;
+        bitbuffer[outoffset2 + 1] = in12;
+        bitbuffer[outoffset2 + 2] = in13;
+        bitbuffer[outoffset2 + 3] = in14;
+        bitbuffer[outoffset2 + 4] = in15;
+        bitbuffer[outoffset2 + 5] = in16;
+        bitbuffer[outoffset2 + 6] = in17;
+        bitbuffer[outoffset2 + 7] = in18;
+        bitbuffer[outoffset2 + 8] = in19;
+        bitbuffer[outoffset2 + 9] = in20;
+        bitbuffer[outoffset2 + 10] = in21;
+        bitbuffer[outoffset2 + 11] = in22;
+        bitbuffer[outoffset2 + 12] = in23;
+        bitbuffer[outoffset2 + 13] = in24;
+        bitbuffer[outoffset2 + 14] = in25;
+        bitbuffer[outoffset2 + 15] = in26;
+        bitbuffer[outoffset2 + 16] = in27;
+        bitbuffer[outoffset2 + 17] = in28;
+        bitbuffer[outoffset2 + 18] = in29;
+        bitbuffer[outoffset2 + 19] = in30;
+        bitbuffer[outoffset2 + 20] = in31;
+        bitbuffer[outoffset2 + 21] = in32;
+    }
+
+    for(; (i + (14870 + 64) * sizeof(z_word_t)) < len; i += (32 * sizeof(z_word_t))) {
+        z_word_t in1, in2, in3, in4, in5, in6, in7, in8;
+        z_word_t in9, in10, in11, in12, in13, in14, in15, in16;
+        z_word_t in17, in18, in19, in20, in21, in22, in23, in24;
+        z_word_t in25, in26, in27, in28, in29, in30, in31, in32;
+        int inoffset = (i / sizeof(z_word_t)) % bitbuffersizezwords;
+        int outoffset1 = ((i / sizeof(z_word_t)) + 14848) % bitbuffersizezwords;
+        int outoffset2 = ((i / sizeof(z_word_t)) + 14880) % bitbuffersizezwords;
+
+        in1 = input[i / sizeof(z_word_t) + 0] ^ next1 ^ bitbuffer[inoffset + 0];
+        in2 = input[i / sizeof(z_word_t) + 1] ^ next2 ^ bitbuffer[inoffset + 1];
+        in3 = input[i / sizeof(z_word_t) + 2] ^ next3 ^ bitbuffer[inoffset + 2];
+        in4 = input[i / sizeof(z_word_t) + 3] ^ next4 ^ bitbuffer[inoffset + 3];
+        in5 = input[i / sizeof(z_word_t) + 4] ^ next5 ^ bitbuffer[inoffset + 4];
+        in6 = input[i / sizeof(z_word_t) + 5] ^ next6 ^ bitbuffer[inoffset + 5];
+        in7 = input[i / sizeof(z_word_t) + 6] ^ next7 ^ bitbuffer[inoffset + 6];
+        in8 = input[i / sizeof(z_word_t) + 7] ^ next8 ^ in1 ^ bitbuffer[inoffset + 7];
+        in9 = input[i / sizeof(z_word_t) + 8] ^ next9 ^ in2 ^ bitbuffer[inoffset + 8];
+        in10 = input[i / sizeof(z_word_t) + 9] ^ next10 ^ in3 ^ bitbuffer[inoffset + 9];
+        in11 = input[i / sizeof(z_word_t) + 10] ^ next11 ^ in4 ^ bitbuffer[inoffset + 10];
+        in12 = input[i / sizeof(z_word_t) + 11] ^ next12 ^ in1 ^ in5 ^ bitbuffer[inoffset + 11];
+        in13 = input[i / sizeof(z_word_t) + 12] ^ next13 ^ in2 ^ in6 ^ bitbuffer[inoffset + 12];
+        in14 = input[i / sizeof(z_word_t) + 13] ^ next14 ^ in3 ^ in7 ^ bitbuffer[inoffset + 13];
+        in15 = input[i / sizeof(z_word_t) + 14] ^ next15 ^ in4 ^ in8 ^ bitbuffer[inoffset + 14];
+        in16 = input[i / sizeof(z_word_t) + 15] ^ next16 ^ in5 ^ in9 ^ bitbuffer[inoffset + 15];
+        in17 = input[i / sizeof(z_word_t) + 16] ^ next17 ^ in6 ^ in10 ^ bitbuffer[inoffset + 16];
+        in18 = input[i / sizeof(z_word_t) + 17] ^ next18 ^ in7 ^ in11 ^ bitbuffer[inoffset + 17];
+        in19 = input[i / sizeof(z_word_t) + 18] ^ next19 ^ in8 ^ in12 ^ bitbuffer[inoffset + 18];
+        in20 = input[i / sizeof(z_word_t) + 19] ^ next20 ^ in9 ^ in13 ^ bitbuffer[inoffset + 19];
+        in21 = input[i / sizeof(z_word_t) + 20] ^ next21 ^ in10 ^ in14 ^ bitbuffer[inoffset + 20];
+        in22 = input[i / sizeof(z_word_t) + 21] ^ next22 ^ in11 ^ in15 ^ bitbuffer[inoffset + 21];
+        in23 = input[i / sizeof(z_word_t) + 22] ^ in1 ^ in12 ^ in16 ^ bitbuffer[inoffset + 22];
+        in24 = input[i / sizeof(z_word_t) + 23] ^ in2 ^ in13 ^ in17 ^ bitbuffer[inoffset + 23];
+        in25 = input[i / sizeof(z_word_t) + 24] ^ in3 ^ in14 ^ in18 ^ bitbuffer[inoffset + 24];
+        in26 = input[i / sizeof(z_word_t) + 25] ^ in4 ^ in15 ^ in19 ^ bitbuffer[inoffset + 25];
+        in27 = input[i / sizeof(z_word_t) + 26] ^ in5 ^ in16 ^ in20 ^ bitbuffer[inoffset + 26];
+        in28 = input[i / sizeof(z_word_t) + 27] ^ in6 ^ in17 ^ in21 ^ bitbuffer[inoffset + 27];
+        in29 = input[i / sizeof(z_word_t) + 28] ^ in7 ^ in18 ^ in22 ^ bitbuffer[inoffset + 28];
+        in30 = input[i / sizeof(z_word_t) + 29] ^ in8 ^ in19 ^ in23 ^ bitbuffer[inoffset + 29];
+        in31 = input[i / sizeof(z_word_t) + 30] ^ in9 ^ in20 ^ in24 ^ bitbuffer[inoffset + 30];
+        in32 = input[i / sizeof(z_word_t) + 31] ^ in10 ^ in21 ^ in25 ^ bitbuffer[inoffset + 31];
+
+        next1 = in11 ^ in22 ^ in26;
+        next2 = in12 ^ in23 ^ in27;
+        next3 = in13 ^ in24 ^ in28;
+        next4 = in14 ^ in25 ^ in29;
+        next5 = in15 ^ in26 ^ in30;
+        next6 = in16 ^ in27 ^ in31;
+        next7 = in17 ^ in28 ^ in32;
+        next8 = in18 ^ in29;
+        next9 = in19 ^ in30;
+        next10 = in20 ^ in31;
+        next11 = in21 ^ in32;
+        next12 = in22;
+        next13 = in23;
+        next14 = in24;
+        next15 = in25;
+        next16 = in26;
+        next17 = in27;
+        next18 = in28;
+        next19 = in29;
+        next20 = in30;
+        next21 = in31;
+        next22 = in32;
+
+        bitbuffer[outoffset1 + 22] = in1;
+        bitbuffer[outoffset1 + 23] = in2;
+        bitbuffer[outoffset1 + 24] = in3;
+        bitbuffer[outoffset1 + 25] = in4;
+        bitbuffer[outoffset1 + 26] = in5;
+        bitbuffer[outoffset1 + 27] = in6;
+        bitbuffer[outoffset1 + 28] = in7;
+        bitbuffer[outoffset1 + 29] = in8;
+        bitbuffer[outoffset1 + 30] = in9;
+        bitbuffer[outoffset1 + 31] = in10;
+        bitbuffer[outoffset2 + 0] = in11;
+        bitbuffer[outoffset2 + 1] = in12;
+        bitbuffer[outoffset2 + 2] = in13;
+        bitbuffer[outoffset2 + 3] = in14;
+        bitbuffer[outoffset2 + 4] = in15;
+        bitbuffer[outoffset2 + 5] = in16;
+        bitbuffer[outoffset2 + 6] = in17;
+        bitbuffer[outoffset2 + 7] = in18;
+        bitbuffer[outoffset2 + 8] = in19;
+        bitbuffer[outoffset2 + 9] = in20;
+        bitbuffer[outoffset2 + 10] = in21;
+        bitbuffer[outoffset2 + 11] = in22;
+        bitbuffer[outoffset2 + 12] = in23;
+        bitbuffer[outoffset2 + 13] = in24;
+        bitbuffer[outoffset2 + 14] = in25;
+        bitbuffer[outoffset2 + 15] = in26;
+        bitbuffer[outoffset2 + 16] = in27;
+        bitbuffer[outoffset2 + 17] = in28;
+        bitbuffer[outoffset2 + 18] = in29;
+        bitbuffer[outoffset2 + 19] = in30;
+        bitbuffer[outoffset2 + 20] = in31;
+        bitbuffer[outoffset2 + 21] = in32;
+    }
+
+    bitbuffer[(i / sizeof(z_word_t) + 0) % bitbuffersizezwords] ^= next1;
+    bitbuffer[(i / sizeof(z_word_t) + 1) % bitbuffersizezwords] ^= next2;
+    bitbuffer[(i / sizeof(z_word_t) + 2) % bitbuffersizezwords] ^= next3;
+    bitbuffer[(i / sizeof(z_word_t) + 3) % bitbuffersizezwords] ^= next4;
+    bitbuffer[(i / sizeof(z_word_t) + 4) % bitbuffersizezwords] ^= next5;
+    bitbuffer[(i / sizeof(z_word_t) + 5) % bitbuffersizezwords] ^= next6;
+    bitbuffer[(i / sizeof(z_word_t) + 6) % bitbuffersizezwords] ^= next7;
+    bitbuffer[(i / sizeof(z_word_t) + 7) % bitbuffersizezwords] ^= next8;
+    bitbuffer[(i / sizeof(z_word_t) + 8) % bitbuffersizezwords] ^= next9;
+    bitbuffer[(i / sizeof(z_word_t) + 9) % bitbuffersizezwords] ^= next10;
+    bitbuffer[(i / sizeof(z_word_t) + 10) % bitbuffersizezwords] ^= next11;
+    bitbuffer[(i / sizeof(z_word_t) + 11) % bitbuffersizezwords] ^= next12;
+    bitbuffer[(i / sizeof(z_word_t) + 12) % bitbuffersizezwords] ^= next13;
+    bitbuffer[(i / sizeof(z_word_t) + 13) % bitbuffersizezwords] ^= next14;
+    bitbuffer[(i / sizeof(z_word_t) + 14) % bitbuffersizezwords] ^= next15;
+    bitbuffer[(i / sizeof(z_word_t) + 15) % bitbuffersizezwords] ^= next16;
+    bitbuffer[(i / sizeof(z_word_t) + 16) % bitbuffersizezwords] ^= next17;
+    bitbuffer[(i / sizeof(z_word_t) + 17) % bitbuffersizezwords] ^= next18;
+    bitbuffer[(i / sizeof(z_word_t) + 18) % bitbuffersizezwords] ^= next19;
+    bitbuffer[(i / sizeof(z_word_t) + 19) % bitbuffersizezwords] ^= next20;
+    bitbuffer[(i / sizeof(z_word_t) + 20) % bitbuffersizezwords] ^= next21;
+    bitbuffer[(i / sizeof(z_word_t) + 21) % bitbuffersizezwords] ^= next22;
+
+    for (int j = 14870; j < 14870 + 64; j++) {
+        bitbuffer[(j + (i / sizeof(z_word_t))) % bitbuffersizezwords] = 0;
+    }
+
+    uint64_t next1_64 = 0;
+    uint64_t next2_64 = 0;
+    uint64_t next3_64 = 0;
+    uint64_t next4_64 = 0;
+    uint64_t next5_64 = 0;
+    uint64_t final[9] = {0};
+
+    for(; (i + 72 < len); i += 32) {
+        uint64_t in1;
+        uint64_t in2;
+        uint64_t in3;
+        uint64_t in4;
+        uint64_t a1, a2, a3, a4;
+        uint64_t b1, b2, b3, b4;
+        uint64_t c1, c2, c3, c4;
+        uint64_t d1, d2, d3, d4;
+
+        uint64_t out1;
+        uint64_t out2;
+        uint64_t out3;
+        uint64_t out4;
+        uint64_t out5;
+
+        in1 = inputqwords[i / sizeof(uint64_t)] ^ bitbufferqwords[(i / sizeof(uint64_t)) % bitbuffersizeqwords];
+        in2 = inputqwords[i / sizeof(uint64_t) + 1] ^ bitbufferqwords[(i / sizeof(uint64_t) + 1) % bitbuffersizeqwords];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1_64;
+        in2 ^= next2_64;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = inputqwords[i / sizeof(uint64_t) + 2] ^ bitbufferqwords[(i / sizeof(uint64_t) + 2) % bitbuffersizeqwords];
+        in4 = inputqwords[i / sizeof(uint64_t) + 3] ^ bitbufferqwords[(i / sizeof(uint64_t) + 3) % bitbuffersizeqwords];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3_64 ^ a1;
+        in4 ^= next4_64 ^ a2 ^ b1;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1_64 = next5_64 ^ out1;
+        next2_64 = out2;
+        next3_64 = out3;
+        next4_64 = out4;
+        next5_64 = out5;
+
+    }
+
+#if BYTE_ORDER == BIG_ENDIAN
+    next1_64 = ZSWAP64(next1_64);
+    next2_64 = ZSWAP64(next2_64);
+    next3_64 = ZSWAP64(next3_64);
+    next4_64 = ZSWAP64(next4_64);
+    next5_64 = ZSWAP64(next5_64);
+#endif
+
+    memcpy(final, inputqwords + (i / sizeof(uint64_t)), len-i);
+    final[0] ^= next1_64;
+    final[1] ^= next2_64;
+    final[2] ^= next3_64;
+    final[3] ^= next4_64;
+    final[4] ^= next5_64;
+
+    uint8_t* final_bytes = (uint8_t*) final;
+
+    for(size_t j = 0; j < (len-i); j++) {
+        crc = crc_table[(crc ^ final_bytes[j] ^ bitbufferbytes[(j+i) % bitbuffersizebytes]) & 0xff] ^ (crc >> 8);
+    }
+
+#if defined(__EMSCRIPTEN__)
+    zng_free(bitbuffer);
+#endif
+    return crc;
+}
+
+#  if OPTIMAL_CMP == 64
+/* Implement Chorba algorithm from https://arxiv.org/abs/2412.16398 */
+Z_INTERNAL uint32_t crc32_chorba_32768_nondestructive (uint32_t crc, const uint64_t* input, size_t len) {
+    uint64_t bitbuffer[32768 / sizeof(uint64_t)];
+    const uint8_t* bitbufferbytes = (const uint8_t*) bitbuffer;
+    memset(bitbuffer, 0, 32768);
+#if BYTE_ORDER == LITTLE_ENDIAN
+    bitbuffer[0] = crc;
+#else
+    bitbuffer[0] = ZSWAP64(crc);
+#endif
+
+    crc = 0;
+
+    size_t i = 0;
+
+    for(; i + 300*8+64 < len; i += 64) {
+        uint64_t in1, in2, in3, in4;
+        uint64_t in5, in6, in7, in8;
+        size_t inoffset = (i/8);
+
+        in1 = input[i / sizeof(uint64_t) + 0] ^ bitbuffer[inoffset + 0];
+        in2 = input[i / sizeof(uint64_t) + 1] ^ bitbuffer[inoffset + 1];
+        in3 = input[i / sizeof(uint64_t) + 2] ^ bitbuffer[inoffset + 2];
+        in4 = input[i / sizeof(uint64_t) + 3] ^ bitbuffer[inoffset + 3];
+        in5 = input[i / sizeof(uint64_t) + 4] ^ bitbuffer[inoffset + 4];
+        in6 = input[i / sizeof(uint64_t) + 5] ^ bitbuffer[inoffset + 5];
+        in7 = input[i / sizeof(uint64_t) + 6] ^ bitbuffer[inoffset + 6];
+        in8 = input[i / sizeof(uint64_t) + 7] ^ bitbuffer[inoffset + 7];
+
+        // [0, 145, 183, 211]
+
+        bitbuffer[(i/8 + 0 + 145)] ^= in1;
+        bitbuffer[(i/8 + 1 + 145)] ^= in2;
+        bitbuffer[(i/8 + 2 + 145)] ^= in3;
+        bitbuffer[(i/8 + 3 + 145)] ^= in4;
+        bitbuffer[(i/8 + 4 + 145)] ^= in5;
+        bitbuffer[(i/8 + 5 + 145)] ^= in6;
+        bitbuffer[(i/8 + 6 + 145)] ^= in7;
+        bitbuffer[(i/8 + 7 + 145)] ^= in8;
+
+        bitbuffer[(i/8 + 0 + 183)] ^= in1;
+        bitbuffer[(i/8 + 1 + 183)] ^= in2;
+        bitbuffer[(i/8 + 2 + 183)] ^= in3;
+        bitbuffer[(i/8 + 3 + 183)] ^= in4;
+        bitbuffer[(i/8 + 4 + 183)] ^= in5;
+        bitbuffer[(i/8 + 5 + 183)] ^= in6;
+        bitbuffer[(i/8 + 6 + 183)] ^= in7;
+        bitbuffer[(i/8 + 7 + 183)] ^= in8;
+
+        bitbuffer[(i/8 + 0 + 211)] ^= in1;
+        bitbuffer[(i/8 + 1 + 211)] ^= in2;
+        bitbuffer[(i/8 + 2 + 211)] ^= in3;
+        bitbuffer[(i/8 + 3 + 211)] ^= in4;
+        bitbuffer[(i/8 + 4 + 211)] ^= in5;
+        bitbuffer[(i/8 + 5 + 211)] ^= in6;
+        bitbuffer[(i/8 + 6 + 211)] ^= in7;
+        bitbuffer[(i/8 + 7 + 211)] ^= in8;
+
+        bitbuffer[(i/8 + 0 + 300)] = in1;
+        bitbuffer[(i/8 + 1 + 300)] = in2;
+        bitbuffer[(i/8 + 2 + 300)] = in3;
+        bitbuffer[(i/8 + 3 + 300)] = in4;
+        bitbuffer[(i/8 + 4 + 300)] = in5;
+        bitbuffer[(i/8 + 5 + 300)] = in6;
+        bitbuffer[(i/8 + 6 + 300)] = in7;
+        bitbuffer[(i/8 + 7 + 300)] = in8;
+    }
+
+    uint64_t next1_64 = 0;
+    uint64_t next2_64 = 0;
+    uint64_t next3_64 = 0;
+    uint64_t next4_64 = 0;
+    uint64_t next5_64 = 0;
+    uint64_t final[9] = {0};
+
+    for(; (i + 72 < len); i += 32) {
+        uint64_t in1;
+        uint64_t in2;
+        uint64_t in3;
+        uint64_t in4;
+        uint64_t a1, a2, a3, a4;
+        uint64_t b1, b2, b3, b4;
+        uint64_t c1, c2, c3, c4;
+        uint64_t d1, d2, d3, d4;
+
+        uint64_t out1;
+        uint64_t out2;
+        uint64_t out3;
+        uint64_t out4;
+        uint64_t out5;
+
+        in1 = input[i / sizeof(z_word_t)] ^ bitbuffer[(i / sizeof(uint64_t))];
+        in2 = input[(i + 8) / sizeof(z_word_t)] ^ bitbuffer[(i / sizeof(uint64_t) + 1)];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1_64;
+        in2 ^= next2_64;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[(i + 16) / sizeof(z_word_t)] ^ bitbuffer[(i / sizeof(uint64_t) + 2)];
+        in4 = input[(i + 24) / sizeof(z_word_t)] ^ bitbuffer[(i / sizeof(uint64_t) + 3)];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3_64 ^ a1;
+        in4 ^= next4_64 ^ a2 ^ b1;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1_64 = next5_64 ^ out1;
+        next2_64 = out2;
+        next3_64 = out3;
+        next4_64 = out4;
+        next5_64 = out5;
+
+    }
+
+#if BYTE_ORDER == BIG_ENDIAN
+    next1_64 = ZSWAP64(next1_64);
+    next2_64 = ZSWAP64(next2_64);
+    next3_64 = ZSWAP64(next3_64);
+    next4_64 = ZSWAP64(next4_64);
+    next5_64 = ZSWAP64(next5_64);
+#endif
+
+    memcpy(final, input+(i / sizeof(uint64_t)), len-i);
+    final[0] ^= next1_64;
+    final[1] ^= next2_64;
+    final[2] ^= next3_64;
+    final[3] ^= next4_64;
+    final[4] ^= next5_64;
+
+    uint8_t* final_bytes = (uint8_t*) final;
+
+    for (size_t j = 0; j < (len-i); j++) {
+        crc = crc_table[(crc ^ final_bytes[j] ^ bitbufferbytes[(j+i)]) & 0xff] ^ (crc >> 8);
+    }
+
+    return crc;
+}
+
+/* Implement Chorba algorithm from https://arxiv.org/abs/2412.16398 */
+Z_INTERNAL uint32_t crc32_chorba_small_nondestructive (uint32_t crc, const uint64_t* input, size_t len) {
+    uint64_t final[9] = {0};
+    uint64_t next1 = crc;
+    crc = 0;
+    uint64_t next2 = 0;
+    uint64_t next3 = 0;
+    uint64_t next4 = 0;
+    uint64_t next5 = 0;
+
+    size_t i = 0;
+
+    /* This is weird, doing for vs while drops 10% off the exec time */
+    for(; (i + 256 + 40 + 32 + 32) < len; i += 32) {
+        uint64_t in1;
+        uint64_t in2;
+        uint64_t in3;
+        uint64_t in4;
+        uint64_t a1, a2, a3, a4;
+        uint64_t b1, b2, b3, b4;
+        uint64_t c1, c2, c3, c4;
+        uint64_t d1, d2, d3, d4;
+
+        uint64_t out1;
+        uint64_t out2;
+        uint64_t out3;
+        uint64_t out4;
+        uint64_t out5;
+
+        uint64_t chorba1 = input[i / sizeof(uint64_t)];
+        uint64_t chorba2 = input[i / sizeof(uint64_t) + 1];
+        uint64_t chorba3 = input[i / sizeof(uint64_t) + 2];
+        uint64_t chorba4 = input[i / sizeof(uint64_t) + 3];
+        uint64_t chorba5 = input[i / sizeof(uint64_t) + 4];
+        uint64_t chorba6 = input[i / sizeof(uint64_t) + 5];
+        uint64_t chorba7 = input[i / sizeof(uint64_t) + 6];
+        uint64_t chorba8 = input[i / sizeof(uint64_t) + 7];
+#if BYTE_ORDER == BIG_ENDIAN
+        chorba1 = ZSWAP64(chorba1);
+        chorba2 = ZSWAP64(chorba2);
+        chorba3 = ZSWAP64(chorba3);
+        chorba4 = ZSWAP64(chorba4);
+        chorba5 = ZSWAP64(chorba5);
+        chorba6 = ZSWAP64(chorba6);
+        chorba7 = ZSWAP64(chorba7);
+        chorba8 = ZSWAP64(chorba8);
+#endif
+        chorba1 ^= next1;
+        chorba2 ^= next2;
+        chorba3 ^= next3;
+        chorba4 ^= next4;
+        chorba5 ^= next5;
+        chorba7 ^= chorba1;
+        chorba8 ^= chorba2;
+        i += 8 * 8;
+
+        /* 0-3 */
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= chorba3;
+        in2 ^= chorba4 ^ chorba1;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= a1 ^ chorba5 ^ chorba2 ^ chorba1;
+        in4 ^= a2 ^ b1 ^ chorba6 ^ chorba3 ^ chorba2;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+
+        i += 32;
+
+        /* 4-7 */
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1 ^ chorba7 ^ chorba4 ^ chorba3;
+        in2 ^= next2 ^ chorba8 ^ chorba5 ^ chorba4;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3 ^ a1 ^ chorba6 ^ chorba5;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba7 ^ chorba6;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+
+        i += 32;
+
+        /* 8-11 */
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1 ^ chorba8 ^ chorba7 ^ chorba1;
+        in2 ^= next2 ^ chorba8 ^ chorba2;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3 ^ a1 ^ chorba3;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba4;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+
+        i += 32;
+
+        /* 12-15 */
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1 ^ chorba5 ^ chorba1;
+        in2 ^= next2 ^ chorba6 ^ chorba2 ^ chorba1;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3 ^ a1 ^ chorba7 ^ chorba3 ^ chorba2 ^ chorba1;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8 ^ chorba4 ^ chorba3 ^ chorba2;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+
+        i += 32;
+
+        /* 16-19 */
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1 ^ chorba5 ^ chorba4 ^ chorba3 ^ chorba1;
+        in2 ^= next2 ^ chorba6 ^ chorba5 ^ chorba4 ^ chorba1 ^ chorba2;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3 ^ a1 ^ chorba7 ^ chorba6 ^ chorba5 ^ chorba2 ^ chorba3;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8 ^ chorba7 ^ chorba6 ^ chorba3 ^ chorba4 ^ chorba1;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+
+        i += 32;
+
+        /* 20-23 */
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1 ^ chorba8 ^ chorba7 ^ chorba4 ^ chorba5 ^ chorba2 ^ chorba1;
+        in2 ^= next2 ^ chorba8 ^ chorba5 ^ chorba6 ^ chorba3 ^ chorba2;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3 ^ a1 ^ chorba7 ^ chorba6 ^ chorba4 ^ chorba3 ^ chorba1;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8 ^ chorba7 ^ chorba5 ^ chorba4 ^ chorba2 ^ chorba1;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+
+        i += 32;
+
+        /* 24-27 */
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1 ^ chorba8 ^ chorba6 ^ chorba5 ^ chorba3 ^ chorba2 ^ chorba1;
+        in2 ^= next2 ^ chorba7 ^ chorba6 ^ chorba4 ^ chorba3 ^ chorba2;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3 ^ a1 ^ chorba8 ^ chorba7 ^ chorba5 ^ chorba4 ^ chorba3;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8 ^ chorba6 ^ chorba5 ^ chorba4;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+
+        i += 32;
+
+        /* 28-31 */
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^= next1 ^ chorba7 ^ chorba6 ^ chorba5;
+        in2 ^= next2 ^ chorba8 ^ chorba7 ^ chorba6;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3 ^ a1 ^ chorba8 ^ chorba7;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+    }
+
+    for(; (i + 40 + 32) < len; i += 32) {
+        uint64_t in1;
+        uint64_t in2;
+        uint64_t in3;
+        uint64_t in4;
+        uint64_t a1, a2, a3, a4;
+        uint64_t b1, b2, b3, b4;
+        uint64_t c1, c2, c3, c4;
+        uint64_t d1, d2, d3, d4;
+
+        uint64_t out1;
+        uint64_t out2;
+        uint64_t out3;
+        uint64_t out4;
+        uint64_t out5;
+
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP64(in1);
+        in2 = ZSWAP64(in2);
+#endif
+        in1 ^=next1;
+        in2 ^=next2;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in3 = ZSWAP64(in3);
+        in4 = ZSWAP64(in4);
+#endif
+        in3 ^= next3 ^ a1;
+        in4 ^= next4 ^ a2 ^ b1;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+    }
+
+#if BYTE_ORDER == BIG_ENDIAN
+    next1 = ZSWAP64(next1);
+    next2 = ZSWAP64(next2);
+    next3 = ZSWAP64(next3);
+    next4 = ZSWAP64(next4);
+    next5 = ZSWAP64(next5);
+#endif
+
+    memcpy(final, input+(i / sizeof(uint64_t)), len-i);
+    final[0] ^= next1;
+    final[1] ^= next2;
+    final[2] ^= next3;
+    final[3] ^= next4;
+    final[4] ^= next5;
+
+    crc = crc32_braid_internal(crc, (uint8_t*) final, len-i);
+
+    return crc;
+}
+
+#else // OPTIMAL_CMP == 64
+
+Z_INTERNAL uint32_t crc32_chorba_small_nondestructive_32bit (uint32_t crc, const uint32_t* input, size_t len) {
+    uint32_t final[20] = {0};
+
+    uint32_t next1 = crc;
+    crc = 0;
+    uint32_t next2 = 0;
+    uint32_t next3 = 0;
+    uint32_t next4 = 0;
+    uint32_t next5 = 0;
+    uint32_t next6 = 0;
+    uint32_t next7 = 0;
+    uint32_t next8 = 0;
+    uint32_t next9 = 0;
+    uint32_t next10 = 0;
+
+    size_t i = 0;
+    for(; i + 80 < len; i += 40) {
+        uint32_t in1;
+        uint32_t in2;
+        uint32_t in3;
+        uint32_t in4;
+        uint32_t in5;
+        uint32_t in6;
+        uint32_t in7;
+        uint32_t in8;
+        uint32_t in9;
+        uint32_t in10;
+
+        uint32_t a1, a2, a3, a4, a6, a7;
+        uint32_t b1, b2, b3, b4, b6, b7;
+        uint32_t c1, c2, c3, c4, c6, c7;
+        uint32_t d1, d2, d3, d4, d6, d7;
+        uint32_t e1, e2, e3, e4, e6, e7;
+        uint32_t f1, f2, f3, f4, f6, f7;
+        uint32_t g1, g2, g3, g4, g6, g7;
+        uint32_t h1, h2, h3, h4, h6, h7;
+        uint32_t i1, i2, i3, i4, i6, i7;
+        uint32_t j1, j2, j3, j4, j6, j7;
+
+        uint32_t out1;
+        uint32_t out2;
+        uint32_t out3;
+        uint32_t out4;
+        uint32_t out5;
+        uint32_t out6;
+        uint32_t out7;
+        uint32_t out8;
+        uint32_t out9;
+        uint32_t out10;
+
+        in1 = input[i/sizeof(uint32_t) + 0];
+        in2 = input[i/sizeof(uint32_t) + 1];
+        in3 = input[i/sizeof(uint32_t) + 2];
+        in4 = input[i/sizeof(uint32_t) + 3];
+#if BYTE_ORDER == BIG_ENDIAN
+        in1 = ZSWAP32(in1);
+        in2 = ZSWAP32(in2);
+        in3 = ZSWAP32(in3);
+        in4 = ZSWAP32(in4);
+#endif
+        in1 ^= next1;
+        in2 ^= next2;
+        in3 ^= next3;
+        in4 ^= next4;
+
+        a1 = (in1 << 17);
+        a2 = (in1 >> 15) ^ (in1 << 23);
+        a3 = (in1 >> 9) ^ (in1 << 19);
+        a4 = (in1 >> 13);
+        a6 = (in1 << 12);
+        a7 = (in1 >> 20);
+
+        b1 = (in2 << 17);
+        b2 = (in2 >> 15) ^ (in2 << 23);
+        b3 = (in2 >> 9) ^ (in2 << 19);
+        b4 = (in2 >> 13);
+        b6 = (in2 << 12);
+        b7 = (in2 >> 20);
+
+        c1 = (in3 << 17);
+        c2 = (in3 >> 15) ^ (in3 << 23);
+        c3 = (in3 >> 9) ^ (in3 << 19);
+        c4 = (in3 >> 13);
+        c6 = (in3 << 12);
+        c7 = (in3 >> 20);
+
+        d1 = (in4 << 17);
+        d2 = (in4 >> 15) ^ (in4 << 23);
+        d3 = (in4 >> 9) ^ (in4 << 19);
+        d4 = (in4 >> 13);
+        d6 = (in4 << 12);
+        d7 = (in4 >> 20);
+
+        in5 = input[i/sizeof(uint32_t) + 4];
+        in6 = input[i/sizeof(uint32_t) + 5];
+        in7 = input[i/sizeof(uint32_t) + 6];
+        in8 = input[i/sizeof(uint32_t) + 7];
+#if BYTE_ORDER == BIG_ENDIAN
+        in5 = ZSWAP32(in5);
+        in6 = ZSWAP32(in6);
+        in7 = ZSWAP32(in7);
+        in8 = ZSWAP32(in8);
+#endif
+        in5 ^= next5 ^ a1;
+        in6 ^= next6 ^ a2 ^ b1;
+        in7 ^= next7 ^ a3 ^ b2 ^ c1;
+        in8 ^= next8 ^ a4 ^ b3 ^ c2 ^ d1;
+
+        e1 = (in5 << 17);
+        e2 = (in5 >> 15) ^ (in5 << 23);
+        e3 = (in5 >> 9) ^ (in5 << 19);
+        e4 = (in5 >> 13);
+        e6 = (in5 << 12);
+        e7 = (in5 >> 20);
+
+        f1 = (in6 << 17);
+        f2 = (in6 >> 15) ^ (in6 << 23);
+        f3 = (in6 >> 9) ^ (in6 << 19);
+        f4 = (in6 >> 13);
+        f6 = (in6 << 12);
+        f7 = (in6 >> 20);
+
+        g1 = (in7 << 17);
+        g2 = (in7 >> 15) ^ (in7 << 23);
+        g3 = (in7 >> 9) ^ (in7 << 19);
+        g4 = (in7 >> 13);
+        g6 = (in7 << 12);
+        g7 = (in7 >> 20);
+
+        h1 = (in8 << 17);
+        h2 = (in8 >> 15) ^ (in8 << 23);
+        h3 = (in8 >> 9) ^ (in8 << 19);
+        h4 = (in8 >> 13);
+        h6 = (in8 << 12);
+        h7 = (in8 >> 20);
+
+        in9 = input[i/sizeof(uint32_t) + 8];
+        in10 = input[i/sizeof(uint32_t) + 9];
+#if BYTE_ORDER == BIG_ENDIAN
+        in9 = ZSWAP32(in9);
+        in10 = ZSWAP32(in10);
+#endif
+        in9 ^= next9 ^ b4 ^ c3 ^ d2 ^ e1;
+        in10 ^= next10 ^ a6 ^ c4 ^ d3 ^ e2 ^ f1;
+
+        i1 = (in9 << 17);
+        i2 = (in9 >> 15) ^ (in9 << 23);
+        i3 = (in9 >> 9) ^ (in9 << 19);
+        i4 = (in9 >> 13);
+        i6 = (in9 << 12);
+        i7 = (in9 >> 20);
+
+        j1 = (in10 << 17);
+        j2 = (in10 >> 15) ^ (in10 << 23);
+        j3 = (in10 >> 9) ^ (in10 << 19);
+        j4 = (in10 >> 13);
+        j6 = (in10 << 12);
+        j7 = (in10 >> 20);
+
+        out1 = a7 ^ b6 ^ d4 ^ e3 ^ f2 ^ g1;
+        out2 = b7 ^ c6 ^ e4 ^ f3 ^ g2 ^ h1;
+        out3 = c7 ^ d6 ^ f4 ^ g3 ^ h2 ^ i1;
+        out4 = d7 ^ e6 ^ g4 ^ h3 ^ i2 ^ j1;
+        out5 = e7 ^ f6 ^ h4 ^ i3 ^ j2;
+        out6 = f7 ^ g6 ^ i4 ^ j3;
+        out7 = g7 ^ h6 ^ j4;
+        out8 = h7 ^ i6;
+        out9 = i7 ^ j6;
+        out10 = j7;
+
+        next1 = out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        next6 = out6;
+        next7 = out7;
+        next8 = out8;
+        next9 = out9;
+        next10 = out10;
+
+    }
+#if BYTE_ORDER == BIG_ENDIAN
+    next1 = ZSWAP32(next1);
+    next2 = ZSWAP32(next2);
+    next3 = ZSWAP32(next3);
+    next4 = ZSWAP32(next4);
+    next5 = ZSWAP32(next5);
+    next6 = ZSWAP32(next6);
+    next7 = ZSWAP32(next7);
+    next8 = ZSWAP32(next8);
+    next9 = ZSWAP32(next9);
+    next10 = ZSWAP32(next10);
+#endif
+
+    memcpy(final, input+(i/sizeof(uint32_t)), len-i);
+    final[0] ^= next1;
+    final[1] ^= next2;
+    final[2] ^= next3;
+    final[3] ^= next4;
+    final[4] ^= next5;
+    final[5] ^= next6;
+    final[6] ^= next7;
+    final[7] ^= next8;
+    final[8] ^= next9;
+    final[9] ^= next10;
+
+    crc = crc32_braid_internal(crc, (uint8_t*) final, len-i);
+
+    return crc;
+}
+#endif // OPTIMAL_CMP == 64
+
+Z_INTERNAL uint32_t crc32_chorba(uint32_t crc, const uint8_t *buf, size_t len) {
+    uint64_t *aligned_buf;
+    uint32_t c = ~crc;
+    uintptr_t align_diff = ALIGN_DIFF(buf, 8);
+
+    if (len > align_diff + CHORBA_SMALL_THRESHOLD) {
+        if (align_diff) {
+            c = crc32_braid_internal(c, buf, align_diff);
+            len -= align_diff;
+        }
+        aligned_buf = (uint64_t*)(buf + align_diff);
+        if(len > CHORBA_LARGE_THRESHOLD) {
+            c = crc32_chorba_118960_nondestructive(c, (z_word_t*)aligned_buf, len);
+#  if OPTIMAL_CMP == 64
+        } else if (len > CHORBA_MEDIUM_LOWER_THRESHOLD && len <= CHORBA_MEDIUM_UPPER_THRESHOLD) {
+            c = crc32_chorba_32768_nondestructive(c, (uint64_t*)aligned_buf, len);
+#  endif
+        } else {
+#  if OPTIMAL_CMP == 64
+            c = crc32_chorba_small_nondestructive(c, (uint64_t*)aligned_buf, len);
+#  else
+            c = crc32_chorba_small_nondestructive_32bit(c, (uint32_t*)aligned_buf, len);
+#  endif
+        }
+    } else {
+        // Process too short lengths using crc32_braid
+        c = crc32_braid_internal(c, buf, len);
+    }
+
+    /* Return the CRC, post-conditioned. */
+    return ~c;
+}
+
+uint32_t crc32_copy_chorba(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_chorba(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
diff --git a/arch/generic/crc32_fold_c.c b/arch/generic/crc32_fold_c.c
deleted file mode 100644
index 43930e97..00000000
--- a/arch/generic/crc32_fold_c.c
+++ /dev/null
@@ -1,31 +0,0 @@
-/* crc32_fold.c -- crc32 folding interface
- * Copyright (C) 2021 Nathan Moinvaziri
- * For conditions of distribution and use, see copyright notice in zlib.h
- */
-#include "zbuild.h"
-#include "zutil.h"
-#include "functable.h"
-#include "crc32.h"
-
-Z_INTERNAL uint32_t crc32_fold_reset_c(crc32_fold *crc) {
-    crc->value = CRC32_INITIAL_VALUE;
-    return crc->value;
-}
-
-Z_INTERNAL void crc32_fold_copy_c(crc32_fold *crc, uint8_t *dst, const uint8_t *src, size_t len) {
-    crc->value = FUNCTABLE_CALL(crc32)(crc->value, src, len);
-    memcpy(dst, src, len);
-}
-
-Z_INTERNAL void crc32_fold_c(crc32_fold *crc, const uint8_t *src, size_t len, uint32_t init_crc) {
-    /* Note: while this is basically the same thing as the vanilla CRC function, we still need
-     * a functable entry for it so that we can generically dispatch to this function with the
-     * same arguments for the versions that _do_ do a folding CRC but we don't want a copy. The
-     * init_crc is an unused argument in this context */
-    Z_UNUSED(init_crc);
-    crc->value = FUNCTABLE_CALL(crc32)(crc->value, src, len);
-}
-
-Z_INTERNAL uint32_t crc32_fold_final_c(crc32_fold *crc) {
-    return crc->value;
-}
diff --git a/arch/generic/generic_functions.h b/arch/generic/generic_functions.h
index 997dd4d0..be6327d1 100644
--- a/arch/generic/generic_functions.h
+++ b/arch/generic/generic_functions.h
@@ -6,101 +6,61 @@
 #define GENERIC_FUNCTIONS_H_
 
 #include "zendian.h"
-
-Z_INTERNAL uint32_t crc32_fold_reset_c(crc32_fold *crc);
-Z_INTERNAL void     crc32_fold_copy_c(crc32_fold *crc, uint8_t *dst, const uint8_t *src, size_t len);
-Z_INTERNAL void     crc32_fold_c(crc32_fold *crc, const uint8_t *src, size_t len, uint32_t init_crc);
-Z_INTERNAL uint32_t crc32_fold_final_c(crc32_fold *crc);
-
-Z_INTERNAL uint32_t adler32_fold_copy_c(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
-
+#include "deflate.h"
+#include "crc32_braid_p.h"
 
 typedef uint32_t (*adler32_func)(uint32_t adler, const uint8_t *buf, size_t len);
+typedef uint32_t (*adler32_copy_func)(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
 typedef uint32_t (*compare256_func)(const uint8_t *src0, const uint8_t *src1);
-typedef uint32_t (*crc32_func)(uint32_t crc32, const uint8_t *buf, size_t len);
+typedef uint32_t (*crc32_func)(uint32_t crc, const uint8_t *buf, size_t len);
+typedef uint32_t (*crc32_copy_func)(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+typedef void     (*slide_hash_func)(deflate_state *s);
 
-uint32_t adler32_c(uint32_t adler, const uint8_t *buf, size_t len);
 
-uint32_t chunksize_c(void);
-uint8_t* chunkmemset_safe_c(uint8_t *out, unsigned dist, unsigned len, unsigned left);
-void     inflate_fast_c(PREFIX3(stream) *strm, uint32_t start);
+uint32_t adler32_c(uint32_t adler, const uint8_t *buf, size_t len);
+uint32_t adler32_copy_c(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
 
-uint32_t PREFIX(crc32_braid)(uint32_t crc, const uint8_t *buf, size_t len);
+uint8_t* chunkmemset_safe_c(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
 
 uint32_t compare256_c(const uint8_t *src0, const uint8_t *src1);
-#if defined(UNALIGNED_OK) && BYTE_ORDER == LITTLE_ENDIAN
-uint32_t compare256_unaligned_16(const uint8_t *src0, const uint8_t *src1);
-#  ifdef HAVE_BUILTIN_CTZ
-    uint32_t compare256_unaligned_32(const uint8_t *src0, const uint8_t *src1);
-#  endif
-#  if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-    uint32_t compare256_unaligned_64(const uint8_t *src0, const uint8_t *src1);
-#  endif
-#endif
-
-typedef void (*slide_hash_func)(deflate_state *s);
-
-void     slide_hash_c(deflate_state *s);
 
-uint32_t longest_match_c(deflate_state *const s, Pos cur_match);
-#  if defined(UNALIGNED_OK) && BYTE_ORDER == LITTLE_ENDIAN
-    uint32_t longest_match_unaligned_16(deflate_state *const s, Pos cur_match);
-#    ifdef HAVE_BUILTIN_CTZ
-        uint32_t longest_match_unaligned_32(deflate_state *const s, Pos cur_match);
-#    endif
-#    if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-        uint32_t longest_match_unaligned_64(deflate_state *const s, Pos cur_match);
-#    endif
-#  endif
+uint32_t crc32_braid(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_braid_internal(uint32_t c, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_braid(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+
+#ifndef WITHOUT_CHORBA
+  uint32_t crc32_chorba(uint32_t crc, const uint8_t *buf, size_t len);
+  uint32_t crc32_chorba_118960_nondestructive (uint32_t crc, const z_word_t* input, size_t len);
+  uint32_t crc32_chorba_32768_nondestructive (uint32_t crc, const uint64_t* input, size_t len);
+  uint32_t crc32_chorba_small_nondestructive (uint32_t crc, const uint64_t* input, size_t len);
+  uint32_t crc32_chorba_small_nondestructive_32bit (uint32_t crc, const uint32_t* input, size_t len);
+  uint32_t crc32_copy_chorba(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+#endif
 
-uint32_t longest_match_slow_c(deflate_state *const s, Pos cur_match);
-#  if defined(UNALIGNED_OK) && BYTE_ORDER == LITTLE_ENDIAN
-    uint32_t longest_match_slow_unaligned_16(deflate_state *const s, Pos cur_match);
-    uint32_t longest_match_slow_unaligned_32(deflate_state *const s, Pos cur_match);
-#    ifdef UNALIGNED64_OK
-        uint32_t longest_match_slow_unaligned_64(deflate_state *const s, Pos cur_match);
-#    endif
-#  endif
+void     inflate_fast_c(PREFIX3(stream) *strm, uint32_t start);
 
+uint32_t longest_match_c(deflate_state *const s, uint32_t cur_match);
+uint32_t longest_match_slow_c(deflate_state *const s, uint32_t cur_match);
 
-// Select generic implementation for longest_match, longest_match_slow, longest_match_slow functions.
-#if defined(UNALIGNED_OK) && BYTE_ORDER == LITTLE_ENDIAN
-#  if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-#    define longest_match_generic longest_match_unaligned_64
-#    define longest_match_slow_generic longest_match_slow_unaligned_64
-#    define compare256_generic compare256_unaligned_64
-#  elif defined(HAVE_BUILTIN_CTZ)
-#    define longest_match_generic longest_match_unaligned_32
-#    define longest_match_slow_generic longest_match_slow_unaligned_32
-#    define compare256_generic compare256_unaligned_32
-#  else
-#    define longest_match_generic longest_match_unaligned_16
-#    define longest_match_slow_generic longest_match_slow_unaligned_16
-#    define compare256_generic compare256_unaligned_16
-#  endif
-#else
-#  define longest_match_generic longest_match_c
-#  define longest_match_slow_generic longest_match_slow_c
-#  define compare256_generic compare256_c
-#endif
-
+void     slide_hash_c(deflate_state *s);
 
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 // Generic code
 #  define native_adler32 adler32_c
-#  define native_adler32_fold_copy adler32_fold_copy_c
+#  define native_adler32_copy adler32_copy_c
 #  define native_chunkmemset_safe chunkmemset_safe_c
-#  define native_chunksize chunksize_c
-#  define native_crc32 PREFIX(crc32_braid)
-#  define native_crc32_fold crc32_fold_c
-#  define native_crc32_fold_copy crc32_fold_copy_c
-#  define native_crc32_fold_final crc32_fold_final_c
-#  define native_crc32_fold_reset crc32_fold_reset_c
+#ifndef WITHOUT_CHORBA
+#  define native_crc32 crc32_chorba
+#  define native_crc32_copy crc32_copy_chorba
+#else
+#  define native_crc32 crc32_braid
+#  define native_crc32_copy crc32_copy_braid
+#endif
 #  define native_inflate_fast inflate_fast_c
 #  define native_slide_hash slide_hash_c
-#  define native_longest_match longest_match_generic
-#  define native_longest_match_slow longest_match_slow_generic
-#  define native_compare256 compare256_generic
+#  define native_longest_match longest_match_c
+#  define native_longest_match_slow longest_match_slow_c
+#  define native_compare256 compare256_c
 #endif
 
 #endif
diff --git a/arch/loongarch/Makefile.in b/arch/loongarch/Makefile.in
new file mode 100644
index 00000000..86baed15
--- /dev/null
+++ b/arch/loongarch/Makefile.in
@@ -0,0 +1,99 @@
+# Makefile for zlib-ng
+# Copyright (C) 1995-2013 Jean-loup Gailly, Mark Adler
+# Copyright (C) 2024 Hans Kristian Rosbach
+# Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+# For conditions of distribution and use, see copyright notice in zlib.h
+
+CC=
+CFLAGS=
+SFLAGS=
+INCLUDES=
+SUFFIX=
+
+LSXFLAG=-mlsx
+LASXFLAG=-mlasx
+
+SRCDIR=.
+SRCTOP=../..
+TOPDIR=$(SRCTOP)
+
+all: \
+	loongarch_features.o loongarch_features.lo \
+	crc32_la.o crc32_la.lo \
+	adler32_lasx.o adler32_lasx.lo \
+	adler32_lsx.o adler32_lsx.lo \
+	chunkset_lasx.o chunkset_lasx.lo \
+	chunkset_lsx.o chunkset_lsx.lo \
+	compare256_lasx.o compare256_lasx.lo \
+	compare256_lsx.o compare256_lsx.lo \
+	slide_hash_lasx.o slide_hash_lasx.lo \
+	slide_hash_lsx.o slide_hash_lsx.lo
+
+loongarch_features.o: $(SRCDIR)/loongarch_features.c
+	$(CC) $(CFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/loongarch_features.c
+
+loongarch_features.lo: $(SRCDIR)/loongarch_features.c
+	$(CC) $(SFLAGS) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/loongarch_features.c
+
+crc32_la.o: $(SRCDIR)/crc32_la.c
+	$(CC) $(CFLAGS) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_la.c
+
+crc32_la.lo: $(SRCDIR)/crc32_la.c
+	$(CC) $(SFLAGS) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_la.c
+
+adler32_lasx.o:
+	$(CC) $(CFLAGS) $(LASXFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_lasx.c
+
+adler32_lasx.lo:
+	$(CC) $(SFLAGS) $(LASXFLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_lasx.c
+
+adler32_lsx.o:
+	$(CC) $(CFLAGS) $(LSXFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_lsx.c
+
+adler32_lsx.lo:
+	$(CC) $(SFLAGS) $(LSXFLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_lsx.c
+
+chunkset_lasx.o:
+	$(CC) $(CFLAGS) $(LASXFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_lasx.c
+
+chunkset_lasx.lo:
+	$(CC) $(SFLAGS) $(LASXFLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_lasx.c
+
+chunkset_lsx.o:
+	$(CC) $(CFLAGS) $(LSXFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_lsx.c
+
+chunkset_lsx.lo:
+	$(CC) $(SFLAGS) $(LSXFLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_lsx.c
+
+compare256_lasx.o:
+	$(CC) $(CFLAGS) $(LASXFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_lasx.c
+
+compare256_lasx.lo:
+	$(CC) $(SFLAGS) $(LASXFLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_lasx.c
+
+compare256_lsx.o:
+	$(CC) $(CFLAGS) $(LSXFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_lsx.c
+
+compare256_lsx.lo:
+	$(CC) $(SFLAGS) $(LSXFLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_lsx.c
+
+slide_hash_lasx.o:
+	$(CC) $(CFLAGS) $(LASXFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/slide_hash_lasx.c
+
+slide_hash_lasx.lo:
+	$(CC) $(SFLAGS) $(LASXFLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/slide_hash_lasx.c
+
+slide_hash_lsx.o:
+	$(CC) $(CFLAGS) $(LSXFLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/slide_hash_lsx.c
+
+slide_hash_lsx.lo:
+	$(CC) $(SFLAGS) $(LSXFLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/slide_hash_lsx.c
+
+mostlyclean: clean
+clean:
+	rm -f *.o *.lo *~
+	rm -rf objs
+	rm -f *.gcda *.gcno *.gcov
+
+distclean: clean
+	rm -f Makefile
diff --git a/arch/loongarch/adler32_lasx.c b/arch/loongarch/adler32_lasx.c
new file mode 100644
index 00000000..d93f41b0
--- /dev/null
+++ b/arch/loongarch/adler32_lasx.c
@@ -0,0 +1,155 @@
+/* adler32_lasx.c -- compute the Adler-32 checksum of a data stream, based on Intel AVX2 implementation
+ * Copyright (C) 1995-2011 Mark Adler
+ * Copyright (C) 2022 Adam Stylinski
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * Authors:
+ *   Brian Bockelman <bockelman@gmail.com>
+ *   Adam Stylinski <kungfujesus06@gmail.com>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#ifdef LOONGARCH_LASX
+
+#include "zbuild.h"
+#include "adler32_p.h"
+
+#include <lasxintrin.h>
+#include "lasxintrin_ext.h"
+
+
+/* 32 bit horizontal sum */
+static inline uint32_t hsum256(__m256i x) {
+    __m256i sum1 = __lasx_xvadd_w(x, __lasx_xvbsrl_v(x, 8));
+    __m256i sum2 = __lasx_xvadd_w(sum1, __lasx_xvpermi_d(sum1, 0x2));
+    __m256i sum3 = __lasx_xvadd_w(sum2, __lasx_xvbsrl_v(sum2, 4));
+    return (uint32_t)__lasx_xvpickve2gr_wu(sum3, 0);
+}
+
+static inline uint32_t partial_hsum256(__m256i x) {
+    __m256i sum1 = __lasx_xvadd_w(x, __lasx_xvbsrl_v(x, 8));
+    __m256i sum2 = __lasx_xvadd_w(sum1, __lasx_xvpermi_d(sum1, 0x2));
+    return (uint32_t)__lasx_xvpickve2gr_wu(sum2, 0);
+}
+
+extern uint32_t adler32_copy_lsx(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+extern uint32_t adler32_lsx(uint32_t adler, const uint8_t *src, size_t len);
+
+Z_FORCEINLINE static uint32_t adler32_copy_impl(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len, const int COPY) {
+    uint32_t adler0, adler1;
+    adler1 = (adler >> 16) & 0xffff;
+    adler0 = adler & 0xffff;
+
+rem_peel:
+    if (len < 16) {
+        return adler32_copy_len_16(adler0, dst, src, len, adler1, COPY);
+    } else if (len < 32) {
+        if (COPY) {
+            return adler32_copy_lsx(adler, dst, src, len);
+        } else {
+            return adler32_lsx(adler, src, len);
+        }
+    }
+
+    __m256i vs1, vs2, vs2_0;
+
+    const __m256i dot2v = (__m256i)((v32i8){ 64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47,
+                                             46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33 });
+    const __m256i dot2v_0 = (__m256i)((v32i8){ 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15,
+                                               14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 });
+    const __m256i dot3v = __lasx_xvreplgr2vr_h(1);
+    const __m256i zero = __lasx_xvldi(0);
+
+    while (len >= 32) {
+        vs1 = __lasx_xvinsgr2vr_w(zero, adler0, 0);
+        vs2 = __lasx_xvinsgr2vr_w(zero, adler1, 0);
+
+        __m256i vs1_0 = vs1;
+        __m256i vs3 = __lasx_xvldi(0);
+        vs2_0 = vs3;
+
+        size_t k = MIN(len, NMAX);
+        k -= k % 32;
+        len -= k;
+
+        while (k >= 64) {
+            __m256i vbuf = __lasx_xvld(src, 0);
+            __m256i vbuf_0 = __lasx_xvld(src, 32);
+            src += 64;
+            k -= 64;
+
+            __m256i vs1_sad = lasx_sad_bu(vbuf, zero);
+            __m256i vs1_sad2 = lasx_sad_bu(vbuf_0, zero);
+
+            if (COPY) {
+                __lasx_xvst(vbuf, dst, 0);
+                __lasx_xvst(vbuf_0, dst, 32);
+                dst += 64;
+            }
+
+            vs1 = __lasx_xvadd_w(vs1, vs1_sad);
+            vs3 = __lasx_xvadd_w(vs3, vs1_0);
+            __m256i v_short_sum2 = lasx_maddubs_w_h(vbuf, dot2v); // sum 32 uint8s to 16 shorts
+            __m256i v_short_sum2_0 = lasx_maddubs_w_h(vbuf_0, dot2v_0); // sum 32 uint8s to 16 shorts
+            __m256i vsum2 = lasx_madd_w_h(v_short_sum2, dot3v); // sum 16 shorts to 8 uint32s
+            __m256i vsum2_0 = lasx_madd_w_h(v_short_sum2_0, dot3v); // sum 16 shorts to 8 uint32s
+            vs1 = __lasx_xvadd_w(vs1_sad2, vs1);
+            vs2 = __lasx_xvadd_w(vsum2, vs2);
+            vs2_0 = __lasx_xvadd_w(vsum2_0, vs2_0);
+            vs1_0 = vs1;
+        }
+
+        vs2 = __lasx_xvadd_w(vs2_0, vs2);
+        vs3 = __lasx_xvslli_w(vs3, 6);
+        vs2 = __lasx_xvadd_w(vs3, vs2);
+        vs3 = __lasx_xvldi(0);
+
+        while (k >= 32) {
+            /*
+               vs1 = adler + sum(c[i])
+               vs2 = sum2 + 32 vs1 + sum( (32-i+1) c[i] )
+            */
+            __m256i vbuf = __lasx_xvld(src, 0);
+            src += 32;
+            k -= 32;
+
+            __m256i vs1_sad = lasx_sad_bu(vbuf, zero); // Sum of abs diff, resulting in 2 x int32's
+
+            if (COPY) {
+                __lasx_xvst(vbuf, dst, 0);
+                dst += 32;
+            }
+
+            vs1 = __lasx_xvadd_w(vs1, vs1_sad);
+            vs3 = __lasx_xvadd_w(vs3, vs1_0);
+            __m256i v_short_sum2 = lasx_maddubs_w_h(vbuf, dot2v_0); // sum 32 uint8s to 16 shorts
+            __m256i vsum2 = lasx_madd_w_h(v_short_sum2, dot3v); // sum 16 shorts to 8 uint32s
+            vs2 = __lasx_xvadd_w(vsum2, vs2);
+            vs1_0 = vs1;
+        }
+
+        /* Defer the multiplication with 32 to outside of the loop */
+        vs3 = __lasx_xvslli_w(vs3, 5);
+        vs2 = __lasx_xvadd_w(vs2, vs3);
+
+        adler0 = partial_hsum256(vs1) % BASE;
+        adler1 = hsum256(vs2) % BASE;
+    }
+
+    adler = adler0 | (adler1 << 16);
+
+    if (len) {
+        goto rem_peel;
+    }
+
+    return adler;
+}
+
+Z_INTERNAL uint32_t adler32_lasx(uint32_t adler, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, NULL, src, len, 0);
+}
+
+Z_INTERNAL uint32_t adler32_copy_lasx(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, dst, src, len, 1);
+}
+
+#endif
diff --git a/arch/loongarch/adler32_lsx.c b/arch/loongarch/adler32_lsx.c
new file mode 100644
index 00000000..8f277b43
--- /dev/null
+++ b/arch/loongarch/adler32_lsx.c
@@ -0,0 +1,148 @@
+/* adler32_lsx.c -- compute the Adler-32 checksum of a data stream, based on Intel SSE4.2 implementation
+ * Copyright (C) 1995-2011 Mark Adler
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * Authors:
+ *   Adam Stylinski <kungfujesus06@gmail.com>
+ *   Brian Bockelman <bockelman@gmail.com>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include "zbuild.h"
+#include "adler32_p.h"
+
+#ifdef LOONGARCH_LSX
+
+#include <lsxintrin.h>
+#include "lsxintrin_ext.h"
+
+static inline uint32_t partial_hsum(__m128i x) {
+    __m128i second_int = __lsx_vbsrl_v(x, 8);
+    __m128i sum = __lsx_vadd_w(x, second_int);
+    return __lsx_vpickve2gr_w(sum, 0);
+}
+
+static inline uint32_t hsum(__m128i x) {
+    __m128i sum1 = __lsx_vilvh_d(x, x);
+    __m128i sum2 = __lsx_vadd_w(x, sum1);
+    __m128i sum3 = __lsx_vshuf4i_w(sum2, 0x01);
+    __m128i sum4 = __lsx_vadd_w(sum2, sum3);
+    return __lsx_vpickve2gr_w(sum4, 0);
+}
+
+Z_FORCEINLINE static uint32_t adler32_copy_impl(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len, const int COPY) {
+    uint32_t adler0, adler1;
+    adler1 = (adler >> 16) & 0xffff;
+    adler0 = adler & 0xffff;
+
+rem_peel:
+    if (len < 16)
+        return adler32_copy_len_16(adler0, dst, src, len, adler1, COPY);
+
+    __m128i vbuf, vbuf_0;
+    __m128i vs1_0, vs3, vs1, vs2, vs2_0, v_sad_sum1, v_short_sum2, v_short_sum2_0,
+            v_sad_sum2, vsum2, vsum2_0;
+    __m128i zero = __lsx_vldi(0);
+    const __m128i dot2v = (__m128i)((v16i8){ 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17 });
+    const __m128i dot2v_0 = (__m128i)((v16i8){ 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 });
+    const __m128i dot3v = __lsx_vreplgr2vr_h(1);
+    size_t k;
+
+    while (len >= 16) {
+
+        k = MIN(len, NMAX);
+        k -= k % 16;
+        len -= k;
+
+        vs1 = __lsx_vinsgr2vr_w(zero, adler0, 0);
+        vs2 = __lsx_vinsgr2vr_w(zero, adler1, 0);
+
+        vs3 = __lsx_vldi(0);
+        vs2_0 = __lsx_vldi(0);
+        vs1_0 = vs1;
+
+        while (k >= 32) {
+            /*
+               vs1 = adler + sum(c[i])
+               vs2 = sum2 + 16 vs1 + sum( (16-i+1) c[i] )
+            */
+            vbuf = __lsx_vld(src, 0);
+            vbuf_0 = __lsx_vld(src, 16);
+            src += 32;
+            k -= 32;
+
+            v_sad_sum1 = lsx_sad_bu(vbuf, zero);
+            v_sad_sum2 = lsx_sad_bu(vbuf_0, zero);
+
+            if (COPY) {
+                __lsx_vst(vbuf, dst, 0);
+                __lsx_vst(vbuf_0, dst, 16);
+                dst += 32;
+            }
+
+            v_short_sum2 = __lsx_vsadd_h(__lsx_vmulwev_h_bu_b(vbuf, dot2v), __lsx_vmulwod_h_bu_b(vbuf, dot2v));
+            v_short_sum2_0 = __lsx_vsadd_h(__lsx_vmulwev_h_bu_b(vbuf_0, dot2v_0), __lsx_vmulwod_h_bu_b(vbuf_0, dot2v_0));
+
+            vs1 = __lsx_vadd_w(v_sad_sum1, vs1);
+            vs3 = __lsx_vadd_w(vs1_0, vs3);
+
+            vsum2 = __lsx_vmaddwod_w_h(__lsx_vmulwev_w_h(v_short_sum2, dot3v), v_short_sum2, dot3v);
+            vsum2_0 = __lsx_vmaddwod_w_h(__lsx_vmulwev_w_h(v_short_sum2_0, dot3v), v_short_sum2_0, dot3v);
+            vs1 = __lsx_vadd_w(v_sad_sum2, vs1);
+            vs2 = __lsx_vadd_w(vsum2, vs2);
+            vs2_0 = __lsx_vadd_w(vsum2_0, vs2_0);
+            vs1_0 = vs1;
+        }
+
+        vs2 = __lsx_vadd_w(vs2_0, vs2);
+        vs3 = __lsx_vslli_w(vs3, 5);
+        vs2 = __lsx_vadd_w(vs3, vs2);
+        vs3 = __lsx_vldi(0);
+
+        while (k >= 16) {
+            /*
+               vs1 = adler + sum(c[i])
+               vs2 = sum2 + 16 vs1 + sum( (16-i+1) c[i] )
+            */
+            vbuf = __lsx_vld(src, 0);
+            src += 16;
+            k -= 16;
+
+            v_sad_sum1 = lsx_sad_bu(vbuf, zero);
+            v_short_sum2 = __lsx_vsadd_h(__lsx_vmulwev_h_bu_b(vbuf, dot2v_0), __lsx_vmulwod_h_bu_b(vbuf, dot2v_0));
+
+            vs1 = __lsx_vadd_w(v_sad_sum1, vs1);
+            vs3 = __lsx_vadd_w(vs1_0, vs3);
+            vsum2 = __lsx_vmaddwod_w_h(__lsx_vmulwev_w_h(v_short_sum2, dot3v), v_short_sum2, dot3v);
+            vs2 = __lsx_vadd_w(vsum2, vs2);
+            vs1_0 = vs1;
+
+            if (COPY) {
+                __lsx_vst(vbuf, dst, 0);
+                dst += 16;
+            }
+        }
+
+        vs3 = __lsx_vslli_w(vs3, 4);
+        vs2 = __lsx_vadd_w(vs2, vs3);
+
+        adler0 = partial_hsum(vs1) % BASE;
+        adler1 = hsum(vs2) % BASE;
+    }
+
+    /* If this is true, there's fewer than 16 elements remaining */
+    if (len) {
+        goto rem_peel;
+    }
+
+    return adler0 | (adler1 << 16);
+}
+
+Z_INTERNAL uint32_t adler32_lsx(uint32_t adler, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, NULL, src, len, 0);
+}
+
+Z_INTERNAL uint32_t adler32_copy_lsx(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, dst, src, len, 1);
+}
+
+#endif
diff --git a/arch/loongarch/chunkset_lasx.c b/arch/loongarch/chunkset_lasx.c
new file mode 100644
index 00000000..6ac43909
--- /dev/null
+++ b/arch/loongarch/chunkset_lasx.c
@@ -0,0 +1,124 @@
+/* chunkset_lasx.c -- LASX inline functions to copy small data chunks, based on Intel AVX2 implementation
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+#include "zbuild.h"
+#include "zmemory.h"
+
+#ifdef LOONGARCH_LASX
+
+#include <lasxintrin.h>
+#include "lasxintrin_ext.h"
+#include "lsxintrin_ext.h"
+
+#include "arch/generic/chunk_256bit_perm_idx_lut.h"
+
+typedef __m256i chunk_t;
+typedef __m128i halfchunk_t;
+
+#define HAVE_CHUNKMEMSET_2
+#define HAVE_CHUNKMEMSET_4
+#define HAVE_CHUNKMEMSET_8
+#define HAVE_CHUNKMEMSET_16
+#define HAVE_CHUNK_MAG
+#define HAVE_HALF_CHUNK
+
+static inline void chunkmemset_2(uint8_t *from, chunk_t *chunk) {
+    *chunk = __lasx_xvreplgr2vr_h(zng_memread_2(from));
+}
+
+static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
+    *chunk = __lasx_xvreplgr2vr_w(zng_memread_4(from));
+}
+
+static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
+    *chunk = __lasx_xvreplgr2vr_d(zng_memread_8(from));
+}
+
+static inline void chunkmemset_16(uint8_t *from, chunk_t *chunk) {
+    *chunk = lasx_broadcast_128(__lsx_vld(from, 0));
+}
+
+static inline void loadchunk(uint8_t const *s, chunk_t *chunk) {
+    *chunk = __lasx_xvld(s, 0);
+}
+
+static inline void storechunk(uint8_t *out, chunk_t *chunk) {
+    __lasx_xvst(*chunk, out, 0);
+}
+
+static inline chunk_t GET_CHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t dist) {
+    lut_rem_pair lut_rem = perm_idx_lut[dist - 3];
+    __m256i ret_vec;
+    /* While technically we only need to read 4 or 8 bytes into this vector register for a lot of cases, GCC is
+     * compiling this to a shared load for all branches, preferring the simpler code.  Given that the buf value isn't in
+     * GPRs to begin with the 256 bit load is _probably_ just as inexpensive */
+    *chunk_rem = lut_rem.remval;
+
+    /* See note in chunkset_ssse3.c for why this is ok */
+    __msan_unpoison(buf + dist, 32 - dist);
+
+    if (dist < 16) {
+        /* This simpler case still requires us to shuffle in 128 bit lanes, so we must apply a static offset after
+         * broadcasting the first vector register to both halves. This is _marginally_ faster than doing two separate
+         * shuffles and combining the halves later */
+        __m256i perm_vec = __lasx_xvld(permute_table+lut_rem.idx, 0);
+        __m128i ret_vec0 = __lsx_vld(buf, 0);
+        ret_vec = __lasx_concat_128(ret_vec0, ret_vec0);
+        ret_vec = lasx_shuffle_b(ret_vec, perm_vec);
+    }  else {
+        __m128i ret_vec0 = __lsx_vld(buf, 0);
+        __m128i ret_vec1 = __lsx_vld(buf, 16);
+        /* Take advantage of the fact that only the latter half of the 256 bit vector will actually differ */
+        __m128i perm_vec1 = __lsx_vld(permute_table + lut_rem.idx, 0);
+        __m128i xlane_permutes = __lsx_vslt_b(perm_vec1, __lsx_vreplgr2vr_b(16));
+        __m128i xlane_res  = lsx_shuffle_b(ret_vec0, perm_vec1);
+        /* Since we can't wrap twice, we can simply keep the later half exactly how it is instead of having to _also_
+         * shuffle those values */
+        __m128i latter_half = __lsx_vbitsel_v(ret_vec1, xlane_res, xlane_permutes);
+        ret_vec = __lasx_concat_128(ret_vec0, latter_half);
+    }
+
+    return ret_vec;
+}
+
+static inline void loadhalfchunk(uint8_t const *s, halfchunk_t *chunk) {
+    *chunk = __lsx_vld(s, 0);
+}
+
+static inline void storehalfchunk(uint8_t *out, halfchunk_t *chunk) {
+    __lsx_vst(*chunk, out, 0);
+}
+
+static inline chunk_t halfchunk2whole(halfchunk_t *chunk) {
+    /* We zero extend mostly to appease some memory sanitizers. These bytes are ultimately
+     * unlikely to be actually written or read from */
+    return lasx_zext_128(*chunk);
+}
+
+static inline halfchunk_t GET_HALFCHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t dist) {
+    lut_rem_pair lut_rem = perm_idx_lut[dist - 3];
+    __m128i perm_vec, ret_vec;
+    __msan_unpoison(buf + dist, 16 - dist);
+    ret_vec = __lsx_vld(buf, 0);
+    *chunk_rem = half_rem_vals[dist - 3];
+
+    perm_vec = __lsx_vld(permute_table + lut_rem.idx, 0);
+    ret_vec = lsx_shuffle_b(ret_vec, perm_vec);
+
+    return ret_vec;
+}
+
+#define CHUNKSIZE        chunksize_lasx
+#define CHUNKCOPY        chunkcopy_lasx
+#define CHUNKUNROLL      chunkunroll_lasx
+#define CHUNKMEMSET      chunkmemset_lasx
+#define CHUNKMEMSET_SAFE chunkmemset_safe_lasx
+
+#include "chunkset_tpl.h"
+
+#define INFLATE_FAST     inflate_fast_lasx
+
+#include "inffast_tpl.h"
+
+#endif
diff --git a/arch/loongarch/chunkset_lsx.c b/arch/loongarch/chunkset_lsx.c
new file mode 100644
index 00000000..0253de2c
--- /dev/null
+++ b/arch/loongarch/chunkset_lsx.c
@@ -0,0 +1,72 @@
+/* chunkset_lsx.c -- LSX inline functions to copy small data chunks, based on Intel SSSE3 implementation
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include "zbuild.h"
+#include "zmemory.h"
+
+#if defined(LOONGARCH_LSX)
+#include <lsxintrin.h>
+#include "lsxintrin_ext.h"
+#include "arch/generic/chunk_128bit_perm_idx_lut.h"
+
+typedef __m128i chunk_t;
+
+#define HAVE_CHUNKMEMSET_2
+#define HAVE_CHUNKMEMSET_4
+#define HAVE_CHUNKMEMSET_8
+#define HAVE_CHUNK_MAG
+
+
+static inline void chunkmemset_2(uint8_t *from, chunk_t *chunk) {
+    *chunk = __lsx_vreplgr2vr_h(zng_memread_2(from));
+}
+
+static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
+    *chunk = __lsx_vreplgr2vr_w(zng_memread_4(from));
+}
+
+static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
+    *chunk = __lsx_vreplgr2vr_d(zng_memread_8(from));
+}
+
+static inline void loadchunk(uint8_t const *s, chunk_t *chunk) {
+    *chunk = __lsx_vld(s, 0);
+}
+
+static inline void storechunk(uint8_t *out, chunk_t *chunk) {
+    __lsx_vst(*chunk, out, 0);
+}
+
+static inline chunk_t GET_CHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t dist) {
+    lut_rem_pair lut_rem = perm_idx_lut[dist - 3];
+    __m128i perm_vec, ret_vec;
+    /* Important to note:
+     * This is _not_ to subvert the memory sanitizer but to instead unpoison some
+     * bytes we willingly and purposefully load uninitialized that we swizzle over
+     * in a vector register, anyway.  If what we assume is wrong about what is used,
+     * the memory sanitizer will still usefully flag it */
+    __msan_unpoison(buf + dist, 16 - dist);
+    ret_vec = __lsx_vld(buf, 0);
+    *chunk_rem = lut_rem.remval;
+
+    perm_vec = __lsx_vld(permute_table + lut_rem.idx, 0);
+    ret_vec = lsx_shuffle_b(ret_vec, perm_vec);
+
+    return ret_vec;
+}
+
+#define CHUNKSIZE        chunksize_lsx
+#define CHUNKMEMSET      chunkmemset_lsx
+#define CHUNKMEMSET_SAFE chunkmemset_safe_lsx
+#define CHUNKCOPY        chunkcopy_lsx
+#define CHUNKUNROLL      chunkunroll_lsx
+
+#include "chunkset_tpl.h"
+
+#define INFLATE_FAST     inflate_fast_lsx
+
+#include "inffast_tpl.h"
+
+#endif
diff --git a/arch/loongarch/compare256_lasx.c b/arch/loongarch/compare256_lasx.c
new file mode 100644
index 00000000..7cc05d99
--- /dev/null
+++ b/arch/loongarch/compare256_lasx.c
@@ -0,0 +1,63 @@
+/* compare256_lasx.c -- LASX version of compare256, based on Intel AVX2 implementation
+ * Copyright Mika T. Lindqvist  <postmaster@raasu.org>
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include "zbuild.h"
+#include "zmemory.h"
+#include "deflate.h"
+#include "fallback_builtins.h"
+
+#if defined(LOONGARCH_LASX) && defined(HAVE_BUILTIN_CTZ)
+
+#include <lasxintrin.h>
+#include "lasxintrin_ext.h"
+
+static inline uint32_t compare256_lasx_static(const uint8_t *src0, const uint8_t *src1) {
+    uint32_t len = 0;
+
+    do {
+        __m256i ymm_src0, ymm_src1, ymm_cmp;
+        ymm_src0 = __lasx_xvld(src0, 0);
+        ymm_src1 = __lasx_xvld(src1, 0);
+        ymm_cmp = __lasx_xvseq_b(ymm_src0, ymm_src1); /* non-identical bytes = 00, identical bytes = FF */
+        unsigned mask = (unsigned)lasx_movemask_b(ymm_cmp);
+        if (mask != 0xFFFFFFFF) {
+            uint32_t match_byte = (uint32_t)__builtin_ctz(~mask); /* Invert bits so identical = 0 */
+            return len + match_byte;
+        }
+
+        src0 += 32, src1 += 32, len += 32;
+
+        ymm_src0 = __lasx_xvld(src0, 0);
+        ymm_src1 = __lasx_xvld(src1, 0);
+        ymm_cmp = __lasx_xvseq_b(ymm_src0, ymm_src1);
+        mask = (unsigned)lasx_movemask_b(ymm_cmp);
+        if (mask != 0xFFFFFFFF) {
+            uint32_t match_byte = (uint32_t)__builtin_ctz(~mask);
+            return len + match_byte;
+        }
+
+        src0 += 32, src1 += 32, len += 32;
+    } while (len < 256);
+
+    return 256;
+}
+
+Z_INTERNAL uint32_t compare256_lasx(const uint8_t *src0, const uint8_t *src1) {
+    return compare256_lasx_static(src0, src1);
+}
+
+#define LONGEST_MATCH       longest_match_lasx
+#define COMPARE256          compare256_lasx_static
+
+#include "match_tpl.h"
+
+#define LONGEST_MATCH_SLOW
+#define LONGEST_MATCH       longest_match_slow_lasx
+#define COMPARE256          compare256_lasx_static
+
+#include "match_tpl.h"
+
+#endif
diff --git a/arch/loongarch/compare256_lsx.c b/arch/loongarch/compare256_lsx.c
new file mode 100644
index 00000000..72b40cdd
--- /dev/null
+++ b/arch/loongarch/compare256_lsx.c
@@ -0,0 +1,99 @@
+/* compare256_lsx.c -- LSX version of compare256, based on Intel SSE implementation
+ * Copyright Adam Stylinski <kungfujesus06@gmail.com>
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include "zbuild.h"
+#include "zmemory.h"
+#include "deflate.h"
+#include "fallback_builtins.h"
+
+#if defined(LOONGARCH_LSX) && defined(HAVE_BUILTIN_CTZ)
+
+#include <lsxintrin.h>
+#include "lsxintrin_ext.h"
+
+static inline uint32_t compare256_lsx_static(const uint8_t *src0, const uint8_t *src1) {
+    uint32_t len = 0;
+    int align_offset = ((uintptr_t)src0) & 15;
+    const uint8_t *end0 = src0 + 256;
+    const uint8_t *end1 = src1 + 256;
+    __m128i xmm_src0, xmm_src1, xmm_cmp;
+
+    /* Do the first load unaligned, than all subsequent ones we have at least
+     * one aligned load. Sadly aligning both loads is probably unrealistic */
+    xmm_src0 = __lsx_vld(src0, 0);
+    xmm_src1 = __lsx_vld(src1, 0);
+    xmm_cmp = __lsx_vseq_b(xmm_src0, xmm_src1);
+
+    unsigned mask = (unsigned)lsx_movemask_b(xmm_cmp);
+
+    /* Compiler _may_ turn this branch into a ptest + movemask,
+     * since a lot of those uops are shared and fused */
+    if (mask != 0xFFFF) {
+        uint32_t match_byte = (uint32_t)__builtin_ctz(~mask);
+        return len + match_byte;
+    }
+
+    int align_adv = 16 - align_offset;
+    len += align_adv;
+    src0 += align_adv;
+    src1 += align_adv;
+
+    /* Do a flooring division (should just be a shift right) */
+    int num_iter = (256 - len) / 16;
+
+    for (int i = 0; i < num_iter; ++i) {
+        xmm_src0 = __lsx_vld(src0, 0);
+        xmm_src1 = __lsx_vld(src1, 0);
+        xmm_cmp = __lsx_vseq_b(xmm_src0, xmm_src1);
+
+        mask = (unsigned)lsx_movemask_b(xmm_cmp);
+
+        /* Compiler _may_ turn this branch into a ptest + movemask,
+         * since a lot of those uops are shared and fused */
+        if (mask != 0xFFFF) {
+            uint32_t match_byte = (uint32_t)__builtin_ctz(~mask);
+            return len + match_byte;
+        }
+
+        len += 16, src0 += 16, src1 += 16;
+    }
+
+    if (align_offset) {
+        src0 = end0 - 16;
+        src1 = end1 - 16;
+        len = 256 - 16;
+
+        xmm_src0 = __lsx_vld(src0, 0);
+        xmm_src1 = __lsx_vld(src1, 0);
+        xmm_cmp = __lsx_vseq_b(xmm_src0, xmm_src1);
+
+        mask = (unsigned)lsx_movemask_b(xmm_cmp);
+
+        if (mask != 0xFFFF) {
+            uint32_t match_byte = (uint32_t)__builtin_ctz(~mask);
+            return len + match_byte;
+        }
+    }
+
+    return 256;
+}
+
+Z_INTERNAL uint32_t compare256_lsx(const uint8_t *src0, const uint8_t *src1) {
+    return compare256_lsx_static(src0, src1);
+}
+
+#define LONGEST_MATCH       longest_match_lsx
+#define COMPARE256          compare256_lsx_static
+
+#include "match_tpl.h"
+
+#define LONGEST_MATCH_SLOW
+#define LONGEST_MATCH       longest_match_slow_lsx
+#define COMPARE256          compare256_lsx_static
+
+#include "match_tpl.h"
+
+#endif
diff --git a/arch/loongarch/crc32_la.c b/arch/loongarch/crc32_la.c
new file mode 100644
index 00000000..912488c7
--- /dev/null
+++ b/arch/loongarch/crc32_la.c
@@ -0,0 +1,71 @@
+/* crc32_la.c - LoongArch version of crc32
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#if defined(LOONGARCH_CRC)
+#include "zbuild.h"
+#include "crc32.h"
+#include <stdint.h>
+#include <larchintrin.h>
+
+Z_INTERNAL uint32_t crc32_loongarch64(uint32_t crc, const uint8_t *buf, size_t len) {
+    uint32_t c = ~crc;
+
+    if (UNLIKELY(len == 1)) {
+        c = (uint32_t)__crc_w_b_w((char)(*buf), (int)c);
+        c = ~c;
+        return c;
+    }
+
+    uintptr_t align_diff = ALIGN_DIFF(buf, 8);
+    if (align_diff) {
+        if (len && (align_diff & 1)) {
+            c = (uint32_t)__crc_w_b_w((char)(*buf++), (int)c);
+            len--;
+        }
+
+        if (len >= 2 && (align_diff & 2)) {
+            c = (uint32_t)__crc_w_h_w((short)*((uint16_t*)buf), (int)c);
+            buf += 2;
+            len -= 2;
+        }
+
+        if (len >= 4 && (align_diff & 4)) {
+            c = (uint32_t)__crc_w_w_w((int)*((uint32_t*)buf), (int)c);
+            len -= 4;
+            buf += 4;
+        }
+
+    }
+
+    while (len >= 8) {
+        c = (uint32_t)__crc_w_d_w((long int)*((uint64_t*)buf), (int)c);
+        len -= 8;
+        buf += 8;
+    }
+
+    if (len & 4) {
+        c = (uint32_t)__crc_w_w_w((int)*((uint32_t*)buf), (int)c);
+        buf += 4;
+    }
+
+    if (len & 2) {
+        c = (uint32_t)__crc_w_h_w((short)*((uint16_t*)buf), (int)c);
+        buf += 2;
+    }
+
+    if (len & 1) {
+        c = (uint32_t)__crc_w_b_w((char)(*buf), (int)c);
+    }
+
+    c = ~c;
+    return c;
+}
+
+Z_INTERNAL uint32_t crc32_copy_loongarch64(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_loongarch64(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
+#endif
diff --git a/arch/loongarch/lasxintrin_ext.h b/arch/loongarch/lasxintrin_ext.h
new file mode 100644
index 00000000..b1e72cff
--- /dev/null
+++ b/arch/loongarch/lasxintrin_ext.h
@@ -0,0 +1,61 @@
+/* lasxintrin_ext.h
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+#ifndef LASXINTRIN_EXT_H
+#define LASXINTRIN_EXT_H
+
+#include <lsxintrin.h>
+#include <lasxintrin.h>
+
+
+static inline __m256i lasx_zext_128(__m128i src) {
+#ifdef __loongarch_asx_sx_conv
+    return __lasx_insert_128_lo(__lasx_xvldi(0), src);
+#else
+    __m256i dest = __lasx_xvldi(0);
+    __asm__ volatile ("xvpermi.q %u0,%u2,0x30\n" : "=f"(dest) : "0"(dest), "f"(src));
+    return dest;
+#endif
+}
+
+#ifndef __loongarch_asx_sx_conv
+static inline __m256i __lasx_concat_128(__m128i lo, __m128i hi) {
+    __m256i dest;
+    __asm__ volatile ("xvpermi.q %u0,%u2,0x02\n" : "=f"(dest) : "0"(lo), "f"(hi));
+    return dest;
+}
+#endif
+
+static inline __m256i lasx_broadcast_128(__m128i in) {
+    return __lasx_concat_128(in, in);
+}
+
+static inline __m256i lasx_sad_bu(__m256i a, __m256i b) {
+    __m256i tmp = __lasx_xvabsd_bu(a, b);
+    tmp = __lasx_xvhaddw_hu_bu(tmp, tmp);
+    tmp = __lasx_xvhaddw_wu_hu(tmp, tmp);
+    return __lasx_xvhaddw_du_wu(tmp, tmp);
+}
+
+static inline __m256i lasx_maddubs_w_h(__m256i a, __m256i b) {
+    return __lasx_xvsadd_h(__lasx_xvmulwod_h_bu_b(a, b), __lasx_xvmulwev_h_bu_b(a, b));
+}
+
+static inline __m256i lasx_madd_w_h(__m256i a, __m256i b) {
+    return __lasx_xvmaddwod_w_h(__lasx_xvmulwev_w_h(a, b), a, b);
+}
+
+static inline int lasx_movemask_b(__m256i v) {
+    v = __lasx_xvmskltz_b(v);
+    return __lasx_xvpickve2gr_w(v, 0) | (__lasx_xvpickve2gr_w(v, 4) << 16);
+}
+
+/* See: lsx_shuffle_b */
+static inline __m256i lasx_shuffle_b(__m256i a, __m256i b) {
+    __m256i msb_mask = __lasx_xvslti_b(b, 0);
+    __m256i dst = __lasx_xvshuf_b(a, a, __lasx_xvandi_b(b, 0xF));
+    return __lasx_xvand_v(dst, __lasx_xvnor_v(msb_mask, msb_mask));
+}
+
+#endif // include guard LASXINTRIN_EXT_H
diff --git a/arch/loongarch/loongarch_features.c b/arch/loongarch/loongarch_features.c
new file mode 100644
index 00000000..d044817e
--- /dev/null
+++ b/arch/loongarch/loongarch_features.c
@@ -0,0 +1,27 @@
+/* loongarch_features.c -- check for LoongArch features.
+ *
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ *
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include "zbuild.h"
+#include "loongarch_features.h"
+
+#include <larchintrin.h>
+
+/*
+ * https://loongson.github.io/LoongArch-Documentation/LoongArch-Vol1-EN.html
+ *
+ * Word number Bit number  Annotation  Implication
+ * 0x1         25          CRC         1 indicates support for CRC instruction
+ * 0x1         6           LSX         1 indicates support for 128-bit vector extension
+ * 0x1         7           LASX        1 indicates support for 256-bit vector expansion
+ */
+
+void Z_INTERNAL loongarch_check_features(struct loongarch_cpu_features *features) {
+    unsigned int w1 = __cpucfg(0x1);
+    features->has_crc = w1 & 0x2000000;
+    features->has_lsx = w1 & 0x40;
+    features->has_lasx = w1 & 0x80;
+}
diff --git a/arch/loongarch/loongarch_features.h b/arch/loongarch/loongarch_features.h
new file mode 100644
index 00000000..27c90b14
--- /dev/null
+++ b/arch/loongarch/loongarch_features.h
@@ -0,0 +1,19 @@
+/* loongarch_features.h -- check for LoongArch features.
+ *
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ *
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#ifndef LOONGARCH_FEATURES_H_
+#define LOONGARCH_FEATURES_H_
+
+struct loongarch_cpu_features {
+    int has_crc;
+    int has_lsx;
+    int has_lasx;
+};
+
+void Z_INTERNAL loongarch_check_features(struct loongarch_cpu_features *features);
+
+#endif /* LOONGARCH_FEATURES_H_ */
diff --git a/arch/loongarch/loongarch_functions.h b/arch/loongarch/loongarch_functions.h
new file mode 100644
index 00000000..939a3a03
--- /dev/null
+++ b/arch/loongarch/loongarch_functions.h
@@ -0,0 +1,92 @@
+/* loongarch_functions.h -- LoongArch implementations for arch-specific functions.
+ *
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ *
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#ifndef LOONGARCH_FUNCTIONS_H_
+#define LOONGARCH_FUNCTIONS_H_
+
+#ifdef LOONGARCH_CRC
+uint32_t crc32_loongarch64(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_loongarch64(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+#endif
+
+#ifdef LOONGARCH_LSX
+uint32_t adler32_lsx(uint32_t adler, const uint8_t *src, size_t len);
+uint32_t adler32_copy_lsx(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+void slide_hash_lsx(deflate_state *s);
+#  ifdef HAVE_BUILTIN_CTZ
+    uint32_t compare256_lsx(const uint8_t *src0, const uint8_t *src1);
+    uint32_t longest_match_lsx(deflate_state *const s, uint32_t cur_match);
+    uint32_t longest_match_slow_lsx(deflate_state *const s, uint32_t cur_match);
+#  endif
+uint8_t* chunkmemset_safe_lsx(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
+void inflate_fast_lsx(PREFIX3(stream) *strm, uint32_t start);
+#endif
+
+#ifdef LOONGARCH_LASX
+uint32_t adler32_lasx(uint32_t adler, const uint8_t *src, size_t len);
+uint32_t adler32_copy_lasx(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+void slide_hash_lasx(deflate_state *s);
+#  ifdef HAVE_BUILTIN_CTZ
+    uint32_t compare256_lasx(const uint8_t *src0, const uint8_t *src1);
+    uint32_t longest_match_lasx(deflate_state *const s, uint32_t cur_match);
+    uint32_t longest_match_slow_lasx(deflate_state *const s, uint32_t cur_match);
+#  endif
+uint8_t* chunkmemset_safe_lasx(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
+void inflate_fast_lasx(PREFIX3(stream) *strm, uint32_t start);
+#endif
+
+#ifdef DISABLE_RUNTIME_CPU_DETECTION
+// LOONGARCH - CRC32 - All known CPUs has crc instructions
+#  if defined(LOONGARCH_CRC)
+#    undef native_crc32
+#    define native_crc32 crc32_loongarch64
+#    undef native_crc32_copy
+#    define native_crc32_copy crc32_copy_loongarch64
+#  endif
+#  if defined(LOONGARCH_LSX) && defined(__loongarch_sx)
+#    undef native_adler32
+#    define native_adler32 adler32_lsx
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_lsx
+#    undef native_slide_hash
+#    define native_slide_hash slide_hash_lsx
+#    undef native_chunkmemset_safe
+#    define native_chunkmemset_safe chunkmemset_safe_lsx
+#    undef native_inflate_fast
+#    define native_inflate_fast inflate_fast_lsx
+#    ifdef HAVE_BUILTIN_CTZ
+#      undef native_compare256
+#      define native_compare256 compare256_lsx
+#      undef native_longest_match
+#      define native_longest_match longest_match_lsx
+#      undef native_longest_match_slow
+#      define native_longest_match_slow longest_match_slow_lsx
+#    endif
+#  endif
+#  if defined(LOONGARCH_LASX) && defined(__loongarch_asx)
+#    undef native_adler32
+#    define native_adler32 adler32_lasx
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_lasx
+#    undef native_slide_hash
+#    define native_slide_hash slide_hash_lasx
+#    undef native_chunkmemset_safe
+#    define native_chunkmemset_safe chunkmemset_safe_lasx
+#    undef native_inflate_fast
+#    define native_inflate_fast inflate_fast_lasx
+#    ifdef HAVE_BUILTIN_CTZ
+#      undef native_compare256
+#      define native_compare256 compare256_lasx
+#      undef native_longest_match
+#      define native_longest_match longest_match_lasx
+#      undef native_longest_match_slow
+#      define native_longest_match_slow longest_match_slow_lasx
+#    endif
+#  endif
+#endif
+
+#endif /* LOONGARCH_FUNCTIONS_H_ */
diff --git a/arch/loongarch/lsxintrin_ext.h b/arch/loongarch/lsxintrin_ext.h
new file mode 100644
index 00000000..0a0503b9
--- /dev/null
+++ b/arch/loongarch/lsxintrin_ext.h
@@ -0,0 +1,33 @@
+/* lsxintrin_ext.h
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+#ifndef LSXINTRIN_EXT_H
+#define LSXINTRIN_EXT_H
+
+#include <lsxintrin.h>
+
+
+static inline __m128i lsx_sad_bu(__m128i a, __m128i b) {
+    __m128i tmp = __lsx_vabsd_bu(a, b);
+    tmp = __lsx_vhaddw_hu_bu(tmp, tmp);
+    tmp = __lsx_vhaddw_wu_hu(tmp, tmp);
+    return __lsx_vhaddw_du_wu(tmp, tmp);
+}
+
+static inline int lsx_movemask_b(__m128i v) {
+    return __lsx_vpickve2gr_w(__lsx_vmskltz_b(v), 0);
+}
+
+static inline __m128i lsx_shuffle_b(__m128i a, __m128i b) {
+    /* most significant bit is set - negative 8-bit integer */
+    __m128i msb_mask = __lsx_vslti_b(b, 0);
+
+    /* shuffle, clear msb in indices vector b */
+    __m128i dst = __lsx_vshuf_b(a, a, __lsx_vandi_b(b, 0xF));
+
+    /* invert and apply mask - clear dst-element if b-msb is set */
+    return __lsx_vand_v(dst, __lsx_vnor_v(msb_mask, msb_mask));
+}
+
+#endif // include guard LSXINTRIN_EXT_H
diff --git a/arch/loongarch/slide_hash_lasx.c b/arch/loongarch/slide_hash_lasx.c
new file mode 100644
index 00000000..0779d9ab
--- /dev/null
+++ b/arch/loongarch/slide_hash_lasx.c
@@ -0,0 +1,41 @@
+/*
+ * LASX optimized hash slide, based on Intel AVX2 implementation
+ *
+ * Copyright (C) 2017 Intel Corporation
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * Authors:
+ *   Arjan van de Ven   <arjan@linux.intel.com>
+ *   Jim Kukunas        <james.t.kukunas@linux.intel.com>
+ *   Mika T. Lindqvist  <postmaster@raasu.org>
+ *
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+#include "zbuild.h"
+#include "deflate.h"
+
+#include <lasxintrin.h>
+
+static inline void slide_hash_chain(Pos *table, uint32_t entries, const __m256i wsize) {
+    table += entries;
+    table -= 16;
+
+    do {
+        __m256i value, result;
+
+        value = __lasx_xvld(table, 0);
+        result = __lasx_xvssub_hu(value, wsize);
+        __lasx_xvst(result, table, 0);
+
+        table -= 16;
+        entries -= 16;
+    } while (entries > 0);
+}
+
+Z_INTERNAL void slide_hash_lasx(deflate_state *s) {
+    Assert(s->w_size <= UINT16_MAX, "w_size should fit in uint16_t");
+    uint16_t wsize = (uint16_t)s->w_size;
+    const __m256i ymm_wsize = __lasx_xvreplgr2vr_h((short)wsize);
+
+    slide_hash_chain(s->head, HASH_SIZE, ymm_wsize);
+    slide_hash_chain(s->prev, wsize, ymm_wsize);
+}
diff --git a/arch/loongarch/slide_hash_lsx.c b/arch/loongarch/slide_hash_lsx.c
new file mode 100644
index 00000000..ad235c47
--- /dev/null
+++ b/arch/loongarch/slide_hash_lsx.c
@@ -0,0 +1,64 @@
+/*
+ * LSX optimized hash slide, based on Intel SSE implementation
+ *
+ * Copyright (C) 2017 Intel Corporation
+ * Copyright (C) 2025 Vladislav Shchapov <vladislav@shchapov.ru>
+ * Authors:
+ *   Arjan van de Ven   <arjan@linux.intel.com>
+ *   Jim Kukunas        <james.t.kukunas@linux.intel.com>
+ *
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+#include "zbuild.h"
+#include "deflate.h"
+
+#include <lsxintrin.h>
+#include <assert.h>
+
+static inline void slide_hash_chain(Pos *table0, Pos *table1, uint32_t entries0,
+                                    uint32_t entries1, const __m128i wsize) {
+    uint32_t entries;
+    Pos *table;
+    __m128i value0, value1, result0, result1;
+
+    int on_chain = 0;
+
+next_chain:
+    table = (on_chain) ? table1 : table0;
+    entries = (on_chain) ? entries1 : entries0;
+
+    table += entries;
+    table -= 16;
+
+    /* ZALLOC allocates this pointer unless the user chose a custom allocator.
+     * Our alloc function is aligned to 64 byte boundaries */
+    do {
+        value0 = __lsx_vld(table, 0);
+        value1 = __lsx_vld(table, 16);
+        result0 = __lsx_vssub_hu(value0, wsize);
+        result1 = __lsx_vssub_hu(value1, wsize);
+        __lsx_vst(result0, table, 0);
+        __lsx_vst(result1, table, 16);
+
+        table -= 16;
+        entries -= 16;
+    } while (entries > 0);
+
+    ++on_chain;
+    if (on_chain > 1) {
+        return;
+    } else {
+        goto next_chain;
+    }
+}
+
+Z_INTERNAL void slide_hash_lsx(deflate_state *s) {
+    Assert(s->w_size <= UINT16_MAX, "w_size should fit in uint16_t");
+    uint16_t wsize = (uint16_t)s->w_size;
+    const __m128i xmm_wsize = __lsx_vreplgr2vr_h((short)wsize);
+
+    assert(((uintptr_t)s->head & 15) == 0);
+    assert(((uintptr_t)s->prev & 15) == 0);
+
+    slide_hash_chain(s->head, s->prev, HASH_SIZE, wsize, xmm_wsize);
+}
diff --git a/arch/power/adler32_power8.c b/arch/power/adler32_power8.c
index 4aaea9f5..dfa3f7be 100644
--- a/arch/power/adler32_power8.c
+++ b/arch/power/adler32_power8.c
@@ -52,21 +52,17 @@ static inline vector unsigned int vec_sumsu(vector unsigned int __a, vector unsi
     return __a;
 }
 
-Z_INTERNAL uint32_t adler32_power8(uint32_t adler, const uint8_t *buf, size_t len) {
+Z_FORCEINLINE static uint32_t adler32_impl(uint32_t adler, const uint8_t *buf, size_t len) {
     uint32_t s1 = adler & 0xffff;
     uint32_t s2 = (adler >> 16) & 0xffff;
 
     /* in case user likes doing a byte at a time, keep it fast */
     if (UNLIKELY(len == 1))
-        return adler32_len_1(s1, buf, s2);
-
-    /* If buffer is empty or len=0 we need to return adler initial value.  */
-    if (UNLIKELY(buf == NULL))
-        return 1;
+        return adler32_copy_len_1(s1, NULL, buf, s2, 0);
 
     /* This is faster than VSX code for len < 64.  */
     if (len < 64)
-        return adler32_len_64(s1, buf, len, s2);
+        return adler32_copy_len_64(s1, NULL, buf, len, s2, 0);
 
     /* Use POWER VSX instructions for len >= 64. */
     const vector unsigned int v_zeros = { 0 };
@@ -147,7 +143,17 @@ Z_INTERNAL uint32_t adler32_power8(uint32_t adler, const uint8_t *buf, size_t le
     s2 = vs2[0] % BASE;
 
     /* Process tail (len < 16).  */
-    return adler32_len_16(s1, buf, len, s2);
+    return adler32_copy_len_16(s1, NULL, buf, len, s2, 0);
+}
+
+Z_INTERNAL uint32_t adler32_power8(uint32_t adler, const uint8_t *buf, size_t len) {
+    return adler32_impl(adler, buf, len);
 }
 
+/* VSX/VMX stores can have higher latency than optimized memcpy on POWER8+ */
+Z_INTERNAL uint32_t adler32_copy_power8(uint32_t adler, uint8_t *dst, const uint8_t *buf, size_t len) {
+    adler = adler32_impl(adler, buf, len);
+    memcpy(dst, buf, len);
+    return adler;
+}
 #endif /* POWER8_VSX */
diff --git a/arch/power/adler32_vmx.c b/arch/power/adler32_vmx.c
index 3470c28a..e8a6bd71 100644
--- a/arch/power/adler32_vmx.c
+++ b/arch/power/adler32_vmx.c
@@ -118,12 +118,12 @@ static void vmx_accum32(uint32_t *s, const uint8_t *buf, size_t len) {
     vec_ste(s2acc, 0, s+1);
 }
 
-Z_INTERNAL uint32_t adler32_vmx(uint32_t adler, const uint8_t *buf, size_t len) {
+Z_FORCEINLINE static uint32_t adler32_impl(uint32_t adler, const uint8_t *buf, size_t len) {
     uint32_t sum2;
     uint32_t pair[16] ALIGNED_(16);
     memset(&pair[2], 0, 14);
     int n = NMAX;
-    unsigned int done = 0, i;
+    unsigned int done = 0;
 
     /* Split Adler-32 into component sums, it can be supplied by
      * the caller sites (e.g. in a PNG file).
@@ -135,34 +135,24 @@ Z_INTERNAL uint32_t adler32_vmx(uint32_t adler, const uint8_t *buf, size_t len)
 
     /* in case user likes doing a byte at a time, keep it fast */
     if (UNLIKELY(len == 1))
-        return adler32_len_1(adler, buf, sum2);
-
-    /* initial Adler-32 value (deferred check for len == 1 speed) */
-    if (UNLIKELY(buf == NULL))
-        return 1L;
+        return adler32_copy_len_1(adler, NULL, buf, sum2, 0);
 
     /* in case short lengths are provided, keep it somewhat fast */
     if (UNLIKELY(len < 16))
-        return adler32_len_16(adler, buf, len, sum2);
+        return adler32_copy_len_16(adler, NULL, buf, len, sum2, 0);
 
     // Align buffer
-    unsigned int al = 0;
-    if ((uintptr_t)buf & 0xf) {
-        al = 16-((uintptr_t)buf & 0xf);
-        if (al > len) {
-            al=len;
-        }
-        vmx_handle_head_or_tail(pair, buf, al);
-
-        done += al;
+    size_t align_len = (size_t)MIN(ALIGN_DIFF(buf, 16), len);
+    if (align_len) {
+        vmx_handle_head_or_tail(pair, buf, align_len);
+        done += align_len;
         /* Rather than rebasing, we can reduce the max sums for the
          * first round only */
-        n -= al;
+        n -= align_len;
     }
-    for (i = al; i < len; i += n) {
+    for (size_t i = align_len; i < len; i += n) {
         int remaining = (int)(len-i);
-        n = MIN(remaining, (i == al) ? n : NMAX);
-
+        n = MIN(remaining, (i == align_len) ? n : NMAX);
         if (n < 16)
             break;
 
@@ -183,4 +173,15 @@ Z_INTERNAL uint32_t adler32_vmx(uint32_t adler, const uint8_t *buf, size_t len)
     /* D = B * 65536 + A, see: https://en.wikipedia.org/wiki/Adler-32. */
     return (pair[1] << 16) | pair[0];
 }
+
+Z_INTERNAL uint32_t adler32_vmx(uint32_t adler, const uint8_t *buf, size_t len) {
+    return adler32_impl(adler, buf, len);
+}
+
+/* VMX stores can have higher latency than optimized memcpy */
+Z_INTERNAL uint32_t adler32_copy_vmx(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    adler = adler32_impl(adler, src, len);
+    memcpy(dst, src, len);
+    return adler;
+}
 #endif
diff --git a/arch/power/chunkset_power8.c b/arch/power/chunkset_power8.c
index aef19732..673fe0e1 100644
--- a/arch/power/chunkset_power8.c
+++ b/arch/power/chunkset_power8.c
@@ -5,6 +5,7 @@
 #ifdef POWER8_VSX
 #include <altivec.h>
 #include "zbuild.h"
+#include "zmemory.h"
 
 typedef vector unsigned char chunk_t;
 
@@ -15,21 +16,15 @@ typedef vector unsigned char chunk_t;
 #define HAVE_CHUNKMEMSET_8
 
 static inline void chunkmemset_2(uint8_t *from, chunk_t *chunk) {
-    uint16_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = (vector unsigned char)vec_splats(tmp);
+    *chunk = (vector unsigned char)vec_splats(zng_memread_2(from));
 }
 
 static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
-    uint32_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = (vector unsigned char)vec_splats(tmp);
+    *chunk = (vector unsigned char)vec_splats(zng_memread_4(from));
 }
 
 static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
-    uint64_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = (vector unsigned char)vec_splats((unsigned long long)tmp);
+    *chunk = (vector unsigned char)vec_splats((unsigned long long)zng_memread_8(from));
 }
 
 static inline void loadchunk(uint8_t const *s, chunk_t *chunk) {
diff --git a/arch/power/compare256_power9.c b/arch/power/compare256_power9.c
index c8be498e..2875719c 100644
--- a/arch/power/compare256_power9.c
+++ b/arch/power/compare256_power9.c
@@ -6,7 +6,7 @@
 #ifdef POWER9
 #include <altivec.h>
 #include "zbuild.h"
-#include "zutil_p.h"
+#include "zmemory.h"
 #include "deflate.h"
 #include "zendian.h"
 
diff --git a/arch/power/crc32_power8.c b/arch/power/crc32_power8.c
index 1cb5f299..05e11702 100644
--- a/arch/power/crc32_power8.c
+++ b/arch/power/crc32_power8.c
@@ -32,9 +32,7 @@
 #include "crc32_constants.h"
 #include "crc32_braid_tbl.h"
 
-#if defined (__clang__)
-#include "fallback_builtins.h"
-#endif
+#include "power_intrins.h"
 
 #define MAX_SIZE    32768
 #define VMX_ALIGN	16
@@ -54,9 +52,6 @@ Z_INTERNAL uint32_t crc32_power8(uint32_t crc, const unsigned char *p, size_t _l
 
     unsigned long len = (unsigned long) _len;
 
-    if (p == (const unsigned char *) 0x0)
-        return 0;
-
     crc ^= 0xffffffff;
 
     if (len < VMX_ALIGN + VMX_ALIGN_MASK) {
@@ -65,7 +60,7 @@ Z_INTERNAL uint32_t crc32_power8(uint32_t crc, const unsigned char *p, size_t _l
     }
 
     if ((unsigned long)p & VMX_ALIGN_MASK) {
-        prealign = VMX_ALIGN - ((unsigned long)p & VMX_ALIGN_MASK);
+        prealign = (unsigned int)ALIGN_DIFF(p, VMX_ALIGN);
         crc = crc32_align(crc, p, prealign);
         len -= prealign;
         p += prealign;
@@ -85,6 +80,12 @@ out:
     return crc;
 }
 
+Z_INTERNAL uint32_t crc32_copy_power8(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_power8(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
+
 /* When we have a load-store in a single-dispatch group and address overlap
  * such that forward is not allowed (load-hit-store) the group must be flushed.
  * A group ending NOP prevents the flush.
diff --git a/arch/power/power_features.c b/arch/power/power_features.c
index 4939d1c1..d3c55c6a 100644
--- a/arch/power/power_features.c
+++ b/arch/power/power_features.c
@@ -19,7 +19,7 @@
 void Z_INTERNAL power_check_features(struct power_cpu_features *features) {
 #ifdef PPC_FEATURES
     unsigned long hwcap;
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
     elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
 #else
     hwcap = getauxval(AT_HWCAP);
@@ -31,7 +31,7 @@ void Z_INTERNAL power_check_features(struct power_cpu_features *features) {
 
 #ifdef POWER_FEATURES
     unsigned long hwcap2;
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
     elf_aux_info(AT_HWCAP2, &hwcap2, sizeof(hwcap2));
 #else
     hwcap2 = getauxval(AT_HWCAP2);
diff --git a/arch/power/power_functions.h b/arch/power/power_functions.h
index cb6b7650..86f21ad6 100644
--- a/arch/power/power_functions.h
+++ b/arch/power/power_functions.h
@@ -9,22 +9,24 @@
 
 #ifdef PPC_VMX
 uint32_t adler32_vmx(uint32_t adler, const uint8_t *buf, size_t len);
+uint32_t adler32_copy_vmx(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
 void slide_hash_vmx(deflate_state *s);
 #endif
 
 #ifdef POWER8_VSX
 uint32_t adler32_power8(uint32_t adler, const uint8_t *buf, size_t len);
-uint32_t chunksize_power8(void);
-uint8_t* chunkmemset_safe_power8(uint8_t *out, unsigned dist, unsigned len, unsigned left);
+uint32_t adler32_copy_power8(uint32_t adler, uint8_t *dst, const uint8_t *buf, size_t len);
+uint8_t* chunkmemset_safe_power8(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
 uint32_t crc32_power8(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_power8(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
 void slide_hash_power8(deflate_state *s);
 void inflate_fast_power8(PREFIX3(stream) *strm, uint32_t start);
 #endif
 
 #ifdef POWER9
 uint32_t compare256_power9(const uint8_t *src0, const uint8_t *src1);
-uint32_t longest_match_power9(deflate_state *const s, Pos cur_match);
-uint32_t longest_match_slow_power9(deflate_state *const s, Pos cur_match);
+uint32_t longest_match_power9(deflate_state *const s, uint32_t cur_match);
+uint32_t longest_match_slow_power9(deflate_state *const s, uint32_t cur_match);
 #endif
 
 
@@ -33,6 +35,8 @@ uint32_t longest_match_slow_power9(deflate_state *const s, Pos cur_match);
 #  if defined(PPC_VMX) && defined(__ALTIVEC__)
 #    undef native_adler32
 #    define native_adler32 adler32_vmx
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_vmx
 #    undef native_slide_hash
 #    define native_slide_hash slide_hash_vmx
 #  endif
@@ -40,10 +44,10 @@ uint32_t longest_match_slow_power9(deflate_state *const s, Pos cur_match);
 #  if defined(POWER8_VSX) && defined(_ARCH_PWR8) && defined(__VSX__)
 #    undef native_adler32
 #    define native_adler32 adler32_power8
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_power8
 #    undef native_chunkmemset_safe
 #    define native_chunkmemset_safe chunkmemset_safe_power8
-#    undef native_chunksize
-#    define native_chunksize chunksize_power8
 #    undef native_inflate_fast
 #    define native_inflate_fast inflate_fast_power8
 #    undef native_slide_hash
@@ -52,6 +56,8 @@ uint32_t longest_match_slow_power9(deflate_state *const s, Pos cur_match);
 #  if defined(POWER8_VSX_CRC32) && defined(_ARCH_PWR8) && defined(__VSX__)
 #    undef native_crc32
 #    define native_crc32 crc32_power8
+#    undef native_crc32_copy
+#    define native_crc32_copy crc32_copy_power8
 #  endif
 // Power9
 #  if defined(POWER9) && defined(_ARCH_PWR9)
diff --git a/arch/power/fallback_builtins.h b/arch/power/power_intrins.h
similarity index 91%
rename from arch/power/fallback_builtins.h
rename to arch/power/power_intrins.h
index ed958461..cf719865 100644
--- a/arch/power/fallback_builtins.h
+++ b/arch/power/power_intrins.h
@@ -9,9 +9,10 @@
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 
-#ifndef POWER_BUILTINS_H
-#define POWER_BUILTINS_H
+#ifndef POWER_INTRINS_H
+#define POWER_INTRINS_H
 
+#if defined (__clang__)
 /*
  * These stubs fix clang incompatibilities with GCC builtins.
  */
@@ -29,3 +30,5 @@ vec_ld(int __a, const __vector unsigned long long* __b) {
 }
 
 #endif
+
+#endif
diff --git a/arch/power/slide_ppc_tpl.h b/arch/power/slide_ppc_tpl.h
index 5c17e38f..680a7f8e 100644
--- a/arch/power/slide_ppc_tpl.h
+++ b/arch/power/slide_ppc_tpl.h
@@ -24,7 +24,8 @@ static inline void slide_hash_chain(Pos *table, uint32_t entries, uint16_t wsize
 }
 
 void Z_INTERNAL SLIDE_PPC(deflate_state *s) {
-    uint16_t wsize = s->w_size;
+    Assert(s->w_size <= UINT16_MAX, "w_size should fit in uint16_t");
+    uint16_t wsize = (uint16_t)s->w_size;
 
     slide_hash_chain(s->head, HASH_SIZE, wsize);
     slide_hash_chain(s->prev, wsize, wsize);
diff --git a/arch/riscv/Makefile.in b/arch/riscv/Makefile.in
new file mode 100644
index 00000000..43176eee
--- /dev/null
+++ b/arch/riscv/Makefile.in
@@ -0,0 +1,72 @@
+# Makefile for zlib-ng
+# Copyright (C) 1995-2013 Jean-loup Gailly, Mark Adler
+# Copyright (C) 2024 Hans Kristian Rosbach
+# Copyright (C) 2025 Yin Tong <yintong.ustc@bytedance.com>, ByteDance
+# For conditions of distribution and use, see copyright notice in zlib.h
+
+CC=
+CFLAGS=
+SFLAGS=
+INCLUDES=
+SUFFIX=
+
+SRCDIR=.
+SRCTOP=../..
+TOPDIR=$(SRCTOP)
+
+RVVFLAG=
+RVVZBCFLAG=
+ZBCFLAG=
+
+all: \
+	riscv_features.o riscv_features.lo \
+	adler32_rvv.o adler32_rvv.lo \
+	chunkset_rvv.o chunkset_rvv.lo \
+	compare256_rvv.o compare256_rvv.lo \
+	slide_hash_rvv.o slide_hash_rvv.lo \
+        crc32_zbc.o crc32_zbc.lo
+
+riscv_features.o: $(SRCDIR)/riscv_features.c
+	$(CC) $(CFLAGS) $(RVVZBCFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/riscv_features.c
+
+riscv_features.lo: $(SRCDIR)/riscv_features.c
+	$(CC) $(SFLAGS) $(RVVZBCFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/riscv_features.c
+
+adler32_rvv.o: $(SRCDIR)/adler32_rvv.c
+	$(CC) $(CFLAGS) $(RVVFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_rvv.c
+
+adler32_rvv.lo: $(SRCDIR)/adler32_rvv.c
+	$(CC) $(SFLAGS) $(RVVFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/adler32_rvv.c
+
+chunkset_rvv.o: $(SRCDIR)/chunkset_rvv.c
+	$(CC) $(CFLAGS) $(RVVFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_rvv.c
+
+chunkset_rvv.lo: $(SRCDIR)/chunkset_rvv.c
+	$(CC) $(SFLAGS) $(RVVFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_rvv.c
+
+compare256_rvv.o: $(SRCDIR)/compare256_rvv.c
+	$(CC) $(CFLAGS) $(RVVFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_rvv.c
+
+compare256_rvv.lo: $(SRCDIR)/compare256_rvv.c
+	$(CC) $(SFLAGS) $(RVVFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_rvv.c
+
+slide_hash_rvv.o: $(SRCDIR)/slide_hash_rvv.c
+	$(CC) $(CFLAGS) $(RVVFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/slide_hash_rvv.c
+
+slide_hash_rvv.lo: $(SRCDIR)/slide_hash_rvv.c
+	$(CC) $(SFLAGS) $(RVVFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/slide_hash_rvv.c
+
+crc32_zbc.o: $(SRCDIR)/crc32_zbc.c
+	$(CC) $(CFLAGS) $(ZBCFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_zbc.c
+
+crc32_zbc.lo: $(SRCDIR)/crc32_zbc.c
+	$(CC) $(SFLAGS) $(ZBCFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/crc32_zbc.c
+
+mostlyclean: clean
+clean:
+	rm -f *.o *.lo *~
+	rm -rf objs
+	rm -f *.gcda *.gcno *.gcov
+
+distclean: clean
+	rm -f Makefile
diff --git a/arch/riscv/adler32_rvv.c b/arch/riscv/adler32_rvv.c
index d0f9aaa5..9ae31b30 100644
--- a/arch/riscv/adler32_rvv.c
+++ b/arch/riscv/adler32_rvv.c
@@ -12,26 +12,18 @@
 #include "zbuild.h"
 #include "adler32_p.h"
 
-static inline uint32_t adler32_rvv_impl(uint32_t adler, uint8_t* restrict dst, const uint8_t *src, size_t len, int COPY) {
+Z_FORCEINLINE static uint32_t adler32_copy_impl(uint32_t adler, uint8_t* restrict dst, const uint8_t *src, size_t len, int COPY) {
     /* split Adler-32 into component sums */
     uint32_t sum2 = (adler >> 16) & 0xffff;
     adler &= 0xffff;
 
     /* in case user likes doing a byte at a time, keep it fast */
-    if (len == 1) {
-        if (COPY) memcpy(dst, src, 1);
-        return adler32_len_1(adler, src, sum2);
-    }
-
-    /* initial Adler-32 value (deferred check for len == 1 speed) */
-    if (src == NULL)
-        return 1L;
+    if (UNLIKELY(len == 1))
+        return adler32_copy_len_1(adler, dst, src, sum2, COPY);
 
     /* in case short lengths are provided, keep it somewhat fast */
-    if (len < 16) {
-        if (COPY) memcpy(dst, src, len);
-        return adler32_len_16(adler, src, len, sum2);
-    }
+    if (UNLIKELY(len < 16))
+        return adler32_copy_len_16(adler, dst, src, len, sum2, COPY);
 
     size_t left = len;
     size_t vl = __riscv_vsetvlmax_e8m1();
@@ -72,6 +64,7 @@ static inline uint32_t adler32_rvv_impl(uint32_t adler, uint8_t* restrict dst, c
         /* do modulo once each block of NMAX size */
         if (++cnt >= nmax_limit) {
             v_adler32_prev_accu = __riscv_vremu_vx_u32m4(v_adler32_prev_accu, BASE, vl);
+            v_buf32_accu = __riscv_vremu_vx_u32m4(v_buf32_accu, BASE, vl);
             cnt = 0;
         }
     }
@@ -99,16 +92,19 @@ static inline uint32_t adler32_rvv_impl(uint32_t adler, uint8_t* restrict dst, c
 
     vuint32m1_t v_sum2_sum = __riscv_vmv_s_x_u32m1(0, vl);
     v_sum2_sum = __riscv_vredsum_vs_u32m4_u32m1(v_sum32_accu, v_sum2_sum, vl);
-    uint32_t sum2_sum = __riscv_vmv_x_s_u32m1_u32(v_sum2_sum);
+    uint32_t sum2_sum = __riscv_vmv_x_s_u32m1_u32(v_sum2_sum) % BASE;
 
-    sum2 += (sum2_sum + adler * (len - left));
+    sum2 += (sum2_sum + adler * ((len - left) % BASE));
 
     vuint32m1_t v_adler_sum = __riscv_vmv_s_x_u32m1(0, vl);
     v_adler_sum = __riscv_vredsum_vs_u32m4_u32m1(v_buf32_accu, v_adler_sum, vl);
-    uint32_t adler_sum = __riscv_vmv_x_s_u32m1_u32(v_adler_sum);
+    uint32_t adler_sum = __riscv_vmv_x_s_u32m1_u32(v_adler_sum) % BASE;
 
     adler += adler_sum;
 
+    sum2 %= BASE;
+    adler %= BASE;
+
     while (left--) {
         if (COPY) *dst++ = *src;
         adler += *src++;
@@ -121,12 +117,12 @@ static inline uint32_t adler32_rvv_impl(uint32_t adler, uint8_t* restrict dst, c
     return adler | (sum2 << 16);
 }
 
-Z_INTERNAL uint32_t adler32_fold_copy_rvv(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
-    return adler32_rvv_impl(adler, dst, src, len, 1);
+Z_INTERNAL uint32_t adler32_rvv(uint32_t adler, const uint8_t *buf, size_t len) {
+    return adler32_copy_impl(adler, NULL, buf, len, 0);
 }
 
-Z_INTERNAL uint32_t adler32_rvv(uint32_t adler, const uint8_t *buf, size_t len) {
-    return adler32_rvv_impl(adler, NULL, buf, len, 0);
+Z_INTERNAL uint32_t adler32_copy_rvv(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, dst, src, len, 1);
 }
 
 #endif // RISCV_RVV
diff --git a/arch/riscv/chunkset_rvv.c b/arch/riscv/chunkset_rvv.c
index ee43bde2..45ff8d33 100644
--- a/arch/riscv/chunkset_rvv.c
+++ b/arch/riscv/chunkset_rvv.c
@@ -86,30 +86,31 @@ static inline void storechunk(uint8_t *out, chunk_t *chunk) {
  */
 static inline uint8_t* CHUNKCOPY(uint8_t *out, uint8_t const *from, unsigned len) {
     Assert(len > 0, "chunkcopy should never have a length 0");
-    int32_t align = ((len - 1) % sizeof(chunk_t)) + 1;
-    memcpy(out, from, sizeof(chunk_t));
-    out += align;
-    from += align;
-    len -= align;
     ptrdiff_t dist = out - from;
-    if (dist >= len) {
+    if (dist < 0 || dist >= len) {
         memcpy(out, from, len);
         out += len;
         from += len;
         return out;
     }
-    if (dist >= sizeof(chunk_t)) {
-        dist = (dist / sizeof(chunk_t)) * sizeof(chunk_t);
-        memcpy(out, from, dist);
-        out += dist;
-        from += dist;
-        len -= dist;
+
+    int32_t align = ((len - 1) % sizeof(chunk_t)) + 1;
+    memcpy(out, from, sizeof(chunk_t));
+    out += align;
+    from += align;
+    len -= align;
+
+    size_t vl = (dist / sizeof(chunk_t)) * sizeof(chunk_t);
+    while (len > dist) {
+        memcpy(out, from, vl);
+        out += vl;
+        from += vl;
+        len -= vl;
     }
-    while (len > 0) {
-        memcpy(out, from, sizeof(chunk_t));
-        out += sizeof(chunk_t);
-        from += sizeof(chunk_t);
-        len -= sizeof(chunk_t);
+
+    if (len > 0) {
+        memcpy(out, from, len);
+        out += len;
     }
     return out;
 }
@@ -118,4 +119,4 @@ static inline uint8_t* CHUNKCOPY(uint8_t *out, uint8_t const *from, unsigned len
 
 #define INFLATE_FAST     inflate_fast_rvv
 
-#include "inffast_tpl.h"
+#include "inffast_tpl.h"
\ No newline at end of file
diff --git a/arch/riscv/compare256_rvv.c b/arch/riscv/compare256_rvv.c
index 3d6c3e3a..3ddb4db0 100644
--- a/arch/riscv/compare256_rvv.c
+++ b/arch/riscv/compare256_rvv.c
@@ -7,7 +7,7 @@
 #ifdef RISCV_RVV
 
 #include "zbuild.h"
-#include "zutil_p.h"
+#include "zmemory.h"
 #include "deflate.h"
 #include "fallback_builtins.h"
 
diff --git a/arch/riscv/crc32_zbc.c b/arch/riscv/crc32_zbc.c
new file mode 100644
index 00000000..60d27dd9
--- /dev/null
+++ b/arch/riscv/crc32_zbc.c
@@ -0,0 +1,103 @@
+/* crc32_zbc.c - RISCV Zbc version of crc32
+ * Copyright (C) 2025 ByteDance. All rights reserved.
+ * Contributed by Yin Tong <yintong.ustc@bytedance.com>
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#if defined(RISCV_CRC32_ZBC)
+#include "zbuild.h"
+#include "arch_functions.h"
+#include <stdint.h>
+
+#define CLMUL_MIN_LEN 16   // Minimum size of buffer for _crc32_clmul
+#define CLMUL_CHUNK_LEN 16 // Length of chunk for clmul
+
+#define CONSTANT_R3 0x1751997d0ULL
+#define CONSTANT_R4 0x0ccaa009eULL
+#define CONSTANT_R5 0x163cd6124ULL
+#define MASK32 0xFFFFFFFF
+#define CRCPOLY_TRUE_LE_FULL 0x1DB710641ULL
+#define CONSTANT_RU 0x1F7011641ULL
+
+static inline uint64_t clmul(uint64_t a, uint64_t b) {
+    uint64_t res;
+    __asm__ volatile("clmul %0, %1, %2" : "=r"(res) : "r"(a), "r"(b));
+    return res;
+}
+
+static inline uint64_t clmulh(uint64_t a, uint64_t b) {
+    uint64_t res;
+    __asm__ volatile("clmulh %0, %1, %2" : "=r"(res) : "r"(a), "r"(b));
+    return res;
+}
+
+Z_FORCEINLINE static uint32_t crc32_clmul_impl(uint64_t crc, const unsigned char *buf, uint64_t len) {
+    const uint64_t *buf64 = (const uint64_t *)buf;
+    uint64_t low = buf64[0] ^ crc;
+    uint64_t high = buf64[1];
+
+    if (len < 16)
+        goto finish_fold;
+    len -= 16;
+    buf64 += 2;
+
+    // process each 16-byte block
+    while (len >= 16) {
+        uint64_t t2 = clmul(CONSTANT_R4, high);
+        uint64_t t3 = clmulh(CONSTANT_R4, high);
+
+        uint64_t t0_new = clmul(CONSTANT_R3, low);
+        uint64_t t1_new = clmulh(CONSTANT_R3, low);
+
+        // Combine the results and XOR with new data
+        low = t0_new ^ t2;
+        high = t1_new ^ t3;
+        low ^= buf64[0];
+        high ^= buf64[1];
+
+        buf64 += 2;
+        len -= 16;
+    }
+
+finish_fold:
+    // Fold the 128-bit result into 64 bits
+    uint64_t fold_t3 = clmulh(low, CONSTANT_R4);
+    uint64_t fold_t2 = clmul(low, CONSTANT_R4);
+    low = high ^ fold_t2;
+    high = fold_t3;
+
+    // Combine the low and high parts and perform polynomial reduction
+    uint64_t combined = (low >> 32) | ((high & MASK32) << 32);
+    uint64_t reduced_low = clmul(low & MASK32, CONSTANT_R5) ^ combined;
+
+    // Barrett reduction step
+    uint64_t barrett = clmul(reduced_low & MASK32, CONSTANT_RU) & MASK32;
+    barrett = clmul(barrett, CRCPOLY_TRUE_LE_FULL);
+    uint64_t final = barrett ^ reduced_low;
+
+    // Return the high 32 bits as the final CRC
+    return (uint32_t)(final >> 32);
+}
+
+Z_INTERNAL uint32_t crc32_riscv64_zbc(uint32_t crc, const uint8_t *buf, size_t len) {
+    if (len < CLMUL_MIN_LEN) {
+        return crc32_braid(crc, buf, len);
+    }
+
+    uint64_t unaligned_length = len % CLMUL_CHUNK_LEN;
+    if (unaligned_length) {
+        crc = crc32_braid(crc, buf, unaligned_length);
+        buf += unaligned_length;
+        len -= unaligned_length;
+    }
+
+    crc = crc32_clmul_impl(~crc, buf, len);
+    return ~crc;
+}
+
+Z_INTERNAL uint32_t crc32_copy_riscv64_zbc(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_riscv64_zbc(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
+#endif
diff --git a/arch/riscv/riscv_features.c b/arch/riscv/riscv_features.c
index 1e3f45e0..7c04a0ee 100644
--- a/arch/riscv/riscv_features.c
+++ b/arch/riscv/riscv_features.c
@@ -11,29 +11,7 @@
 #include "riscv_features.h"
 
 #define ISA_V_HWCAP (1 << ('v' - 'a'))
-
-int Z_INTERNAL is_kernel_version_greater_or_equal_to_6_5() {
-    struct utsname buffer;
-    uname(&buffer);
-
-    int major, minor;
-    if (sscanf(buffer.release, "%d.%d", &major, &minor) != 2) {
-        // Something bad with uname()
-        return 0;
-    }
-
-    if (major > 6 || major == 6 && minor >= 5)
-        return 1;
-    return 0;
-}
-
-void Z_INTERNAL riscv_check_features_compile_time(struct riscv_cpu_features *features) {
-#if defined(__riscv_v) && defined(__linux__)
-    features->has_rvv = 1;
-#else
-    features->has_rvv = 0;
-#endif
-}
+#define ISA_ZBC_HWCAP (1 << 29)
 
 void Z_INTERNAL riscv_check_features_runtime(struct riscv_cpu_features *features) {
 #if defined(__linux__) && defined(HAVE_SYS_AUXV_H)
@@ -42,11 +20,27 @@ void Z_INTERNAL riscv_check_features_runtime(struct riscv_cpu_features *features
     unsigned long hw_cap = 0;
 #endif
     features->has_rvv = hw_cap & ISA_V_HWCAP;
+    features->has_zbc = hw_cap & ISA_ZBC_HWCAP;
 }
 
 void Z_INTERNAL riscv_check_features(struct riscv_cpu_features *features) {
-    if (is_kernel_version_greater_or_equal_to_6_5())
-        riscv_check_features_runtime(features);
-    else
-        riscv_check_features_compile_time(features);
+    riscv_check_features_runtime(features);
+#ifdef RISCV_RVV
+    if (features->has_rvv) {
+        size_t e8m1_vec_len;
+        intptr_t vtype_reg_val;
+        // Check that a vuint8m1_t vector is at least 16 bytes and that tail
+        // agnostic and mask agnostic mode are supported
+        //
+        __asm__ volatile(
+                "vsetvli %0, zero, e8, m1, ta, ma\n\t"
+                "csrr %1, vtype"
+                : "=r"(e8m1_vec_len), "=r"(vtype_reg_val));
+
+        // The RVV target is supported if the VILL bit of VTYPE (the MSB bit of
+        // VTYPE) is not set and the length of a vuint8m1_t vector is at least 16
+        // bytes
+        features->has_rvv = (vtype_reg_val >= 0 && e8m1_vec_len >= 16);
+    }
+#endif
 }
diff --git a/arch/riscv/riscv_features.h b/arch/riscv/riscv_features.h
index b1593acc..42855a1b 100644
--- a/arch/riscv/riscv_features.h
+++ b/arch/riscv/riscv_features.h
@@ -11,6 +11,7 @@
 
 struct riscv_cpu_features {
     int has_rvv;
+    int has_zbc;
 };
 
 void Z_INTERNAL riscv_check_features(struct riscv_cpu_features *features);
diff --git a/arch/riscv/riscv_functions.h b/arch/riscv/riscv_functions.h
index 015b2fbd..e87989cc 100644
--- a/arch/riscv/riscv_functions.h
+++ b/arch/riscv/riscv_functions.h
@@ -11,28 +11,30 @@
 
 #ifdef RISCV_RVV
 uint32_t adler32_rvv(uint32_t adler, const uint8_t *buf, size_t len);
-uint32_t adler32_fold_copy_rvv(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
-uint32_t chunksize_rvv(void);
-uint8_t* chunkmemset_safe_rvv(uint8_t *out, unsigned dist, unsigned len, unsigned left);
+uint32_t adler32_copy_rvv(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+uint8_t* chunkmemset_safe_rvv(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
 uint32_t compare256_rvv(const uint8_t *src0, const uint8_t *src1);
 
-uint32_t longest_match_rvv(deflate_state *const s, Pos cur_match);
-uint32_t longest_match_slow_rvv(deflate_state *const s, Pos cur_match);
+uint32_t longest_match_rvv(deflate_state *const s, uint32_t cur_match);
+uint32_t longest_match_slow_rvv(deflate_state *const s, uint32_t cur_match);
 void slide_hash_rvv(deflate_state *s);
 void inflate_fast_rvv(PREFIX3(stream) *strm, uint32_t start);
 #endif
 
+#ifdef RISCV_CRC32_ZBC
+uint32_t crc32_riscv64_zbc(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_riscv64_zbc(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+#endif
+
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 // RISCV - RVV
 #  if defined(RISCV_RVV) && defined(__riscv_v) && defined(__linux__)
 #    undef native_adler32
 #    define native_adler32 adler32_rvv
-#    undef native_adler32_fold_copy
-#    define native_adler32_fold_copy adler32_fold_copy_rvv
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_rvv
 #    undef native_chunkmemset_safe
 #    define native_chunkmemset_safe chunkmemset_safe_rvv
-#    undef native_chunksize
-#    define native_chunksize chunksize_rvv
 #    undef native_compare256
 #    define native_compare256 compare256_rvv
 #    undef native_inflate_fast
@@ -44,6 +46,14 @@ void inflate_fast_rvv(PREFIX3(stream) *strm, uint32_t start);
 #    undef native_slide_hash
 #    define native_slide_hash slide_hash_rvv
 #  endif
+
+// RISCV - CRC32
+#  if (defined(RISCV_CRC32_ZBC) && defined (__riscv_zbc))
+#    undef native_crc32
+#    define native_crc32 crc32_riscv64_zbc
+#    undef native_crc32_copy
+#    define native_crc32_copy crc32_copy_riscv64_zbc
+#  endif
 #endif
 
 #endif /* RISCV_FUNCTIONS_H_ */
diff --git a/arch/riscv/slide_hash_rvv.c b/arch/riscv/slide_hash_rvv.c
index ac28bbd9..6f53d7a1 100644
--- a/arch/riscv/slide_hash_rvv.c
+++ b/arch/riscv/slide_hash_rvv.c
@@ -23,6 +23,7 @@ static inline void slide_hash_chain(Pos *table, uint32_t entries, uint16_t wsize
 }
 
 Z_INTERNAL void slide_hash_rvv(deflate_state *s) {
+    Assert(s->w_size <= UINT16_MAX, "w_size should fit in uint16_t");
     uint16_t wsize = (uint16_t)s->w_size;
 
     slide_hash_chain(s->head, HASH_SIZE, wsize);
diff --git a/arch/s390/README.md b/arch/s390/README.md
index 7b383cc9..c56ffd76 100644
--- a/arch/s390/README.md
+++ b/arch/s390/README.md
@@ -222,56 +222,44 @@ need for constantly changing the patch.
 ## Configuring the builder.
 
 ### Install prerequisites.
-
 ```
 sudo dnf install podman
 ```
 
-### Add actions-runner service.
+### Create a config file, needs github personal access token.
+Access token needs permissions; Repo Admin RW, Org Self-hosted runners RW.
+For details, consult
+https://docs.github.com/en/rest/actions/self-hosted-runners?apiVersion=2022-11-28#create-a-registration-token-for-a-repository
 
+#### Create file /etc/actions-runner:
 ```
-sudo cp self-hosted-builder/actions-runner.service /etc/systemd/system/
-sudo systemctl daemon-reload
+REPO=<owner>/<name>
+PAT_TOKEN=<github_pat_***>
 ```
 
-### Create a config file, needs github personal access token.
-
+#### Set permissions on /etc/actions-runner:
 ```
-# Create file /etc/actions-runner
-repo=<owner>/<name>
-access_token=<ghp_***>
+chmod 600 /etc/actions-runner
 ```
 
-Access token should have the repo scope, consult
-https://docs.github.com/en/rest/reference/actions#create-a-registration-token-for-a-repository
-for details.
+### Add actions-runner service.
+```
+sudo cp self-hosted-builder/actions-runner.service /etc/systemd/system/
+sudo systemctl daemon-reload
+```
 
 ### Autostart actions-runner.
-
 ```
 $ sudo systemctl enable --now actions-runner
 ```
 
-## Rebuilding the container
-
-In order to update the `gaplib-actions-runner` podman container, e.g. to get the
-latest OS security fixes, follow these steps:
+### Add auto-rebuild cronjob
+```
+sudo cp self-hosted-builder/actions-runner-rebuild.sh /etc/cron.weekly/
+chmod +x /etc/cron.weekly/actions-runner-rebuild.sh
 ```
-# Stop actions-runner service
-sudo systemctl stop actions-runner
-
-# Delete old container
-sudo podman container rm gaplib-actions-runner
-
-# Delete old image
-sudo podman image rm localhost/zlib-ng/actions-runner
-
-# Build image
-sudo podman build --squash -f Dockerfile.zlib-ng --tag zlib-ng/actions-runner --build-arg .
-
-# Build container
-sudo podman create --name=gaplib-actions-runner --env-file=/etc/actions-runner --init --interactive --volume=actions-runner-temp:/home/actions-runner zlib-ng/actions-runner
 
-# Start actions-runner service
-sudo systemctl start actions-runner
+## Building / Rebuilding the container
+```
+sudo /etc/cron.weekly/actions-runner-rebuild.sh
 ```
diff --git a/arch/s390/crc32-vx.c b/arch/s390/crc32-vx.c
index b3dcbf70..de805d15 100644
--- a/arch/s390/crc32-vx.c
+++ b/arch/s390/crc32-vx.c
@@ -202,21 +202,27 @@ uint32_t Z_INTERNAL crc32_s390_vx(uint32_t crc, const unsigned char *buf, size_t
     size_t prealign, aligned, remaining;
 
     if (len < VX_MIN_LEN + VX_ALIGN_MASK)
-        return PREFIX(crc32_braid)(crc, buf, len);
+        return crc32_braid(crc, buf, len);
 
     if ((uintptr_t)buf & VX_ALIGN_MASK) {
-        prealign = VX_ALIGNMENT - ((uintptr_t)buf & VX_ALIGN_MASK);
+        prealign = (size_t)ALIGN_DIFF(buf, VX_ALIGNMENT);
         len -= prealign;
-        crc = PREFIX(crc32_braid)(crc, buf, prealign);
+        crc = crc32_braid(crc, buf, prealign);
         buf += prealign;
     }
     aligned = len & ~VX_ALIGN_MASK;
     remaining = len & VX_ALIGN_MASK;
 
-    crc = crc32_le_vgfm_16(crc ^ 0xffffffff, buf, aligned) ^ 0xffffffff;
+    crc = ~crc32_le_vgfm_16(~crc, buf, aligned);
 
     if (remaining)
-        crc = PREFIX(crc32_braid)(crc, buf + aligned, remaining);
+        crc = crc32_braid(crc, buf + aligned, remaining);
 
     return crc;
 }
+
+Z_INTERNAL uint32_t crc32_copy_s390_vx(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_s390_vx(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
diff --git a/arch/s390/dfltcc_deflate.c b/arch/s390/dfltcc_deflate.c
index 90b4b96e..f9495003 100644
--- a/arch/s390/dfltcc_deflate.c
+++ b/arch/s390/dfltcc_deflate.c
@@ -15,6 +15,7 @@
 
 #include "zbuild.h"
 #include "deflate.h"
+#include "deflate_p.h"
 #include "trees_emit.h"
 #include "dfltcc_deflate.h"
 #include "dfltcc_detail.h"
@@ -59,7 +60,7 @@ static inline int dfltcc_can_deflate_with_params(PREFIX3(streamp) strm, int leve
 int Z_INTERNAL PREFIX(dfltcc_can_deflate)(PREFIX3(streamp) strm) {
     deflate_state *state = (deflate_state *)strm->state;
 
-    return dfltcc_can_deflate_with_params(strm, state->level, state->w_bits, state->strategy, state->reproducible);
+    return dfltcc_can_deflate_with_params(strm, state->level, W_BITS(state), state->strategy, state->reproducible);
 }
 
 static inline void dfltcc_gdht(PREFIX3(streamp) strm) {
@@ -90,8 +91,10 @@ static inline dfltcc_cc dfltcc_cmpr(PREFIX3(streamp) strm) {
 static inline void send_eobs(PREFIX3(streamp) strm, const struct dfltcc_param_v0 *param) {
     deflate_state *state = (deflate_state *)strm->state;
 
-    send_bits(state, PREFIX(bi_reverse)(param->eobs >> (15 - param->eobl), param->eobl), param->eobl, state->bi_buf, state->bi_valid);
-    PREFIX(flush_pending)(strm);
+    send_bits(state, bi_reverse((uint16_t)(param->eobs >> (15 - param->eobl)), param->eobl),
+        param->eobl, state->bi_buf, state->bi_valid);
+
+    flush_pending_inline(strm);
     if (state->pending != 0) {
         /* The remaining data is located in pending_out[0:pending]. If someone
          * calls put_byte() - this might happen in deflate() - the byte will be
@@ -225,7 +228,7 @@ again:
     if (state->wrap == 1)
         param->cv = strm->adler;
     else if (state->wrap == 2)
-        param->cv = ZSWAP32(state->crc_fold.value);
+        param->cv = ZSWAP32(strm->adler);
 
     /* When opening a block, choose a Huffman-Table Type */
     if (!param->bcf) {
@@ -259,7 +262,7 @@ again:
     if (state->wrap == 1)
         strm->adler = param->cv;
     else if (state->wrap == 2)
-        state->crc_fold.value = ZSWAP32(param->cv);
+        strm->adler = ZSWAP32(param->cv);
 
     /* Unmask the input data */
     strm->avail_in += masked_avail_in;
@@ -318,7 +321,7 @@ static int dfltcc_was_deflate_used(PREFIX3(streamp) strm) {
 int Z_INTERNAL PREFIX(dfltcc_deflate_params)(PREFIX3(streamp) strm, int level, int strategy, int *flush) {
     deflate_state *state = (deflate_state *)strm->state;
     int could_deflate = PREFIX(dfltcc_can_deflate)(strm);
-    int can_deflate = dfltcc_can_deflate_with_params(strm, level, state->w_bits, strategy, state->reproducible);
+    int can_deflate = dfltcc_can_deflate_with_params(strm, level, W_BITS(state), strategy, state->reproducible);
 
     if (can_deflate == could_deflate)
         /* We continue to work in the same mode - no changes needed */
diff --git a/arch/s390/s390_features.c b/arch/s390/s390_features.c
index 629025d5..1f90a926 100644
--- a/arch/s390/s390_features.c
+++ b/arch/s390/s390_features.c
@@ -6,7 +6,7 @@
 #endif
 
 #ifndef HWCAP_S390_VXRS
-#define HWCAP_S390_VXRS HWCAP_S390_VX
+#define HWCAP_S390_VXRS (1 << 11)
 #endif
 
 void Z_INTERNAL s390_check_features(struct s390_cpu_features *features) {
diff --git a/arch/s390/s390_functions.h b/arch/s390/s390_functions.h
index e9c67978..7de83abb 100644
--- a/arch/s390/s390_functions.h
+++ b/arch/s390/s390_functions.h
@@ -7,13 +7,23 @@
 
 #ifdef S390_CRC32_VX
 uint32_t crc32_s390_vx(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_s390_vx(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+
+#ifdef __clang__
+#  if ((__clang_major__ == 18) || (__clang_major__ == 19 && (__clang_minor__ < 1 || (__clang_minor__ == 1 && __clang_patchlevel__ < 2))))
+# error CRC32-VX optimizations are broken due to compiler bug in Clang versions: 18.0.0 <= clang_version < 19.1.2. \
+        Either disable the zlib-ng CRC32-VX optimization, or switch to another compiler/compiler version.
+#  endif
 #endif
 
+#endif
 
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 #  if defined(S390_CRC32_VX) && defined(__zarch__) && __ARCH__ >= 11 && defined(__VX__)
 #    undef native_crc32
-#    define native_crc32 = crc32_s390_vx
+#    define native_crc32 crc32_s390_vx
+#    undef native_crc32_copy
+#    define native_crc32_copy crc32_copy_s390_vx
 #  endif
 #endif
 
diff --git a/arch/s390/self-hosted-builder/actions-runner b/arch/s390/self-hosted-builder/actions-runner
new file mode 100755
index 00000000..aabc8025
--- /dev/null
+++ b/arch/s390/self-hosted-builder/actions-runner
@@ -0,0 +1,62 @@
+#!/bin/bash
+
+#
+# Ephemeral runner startup script.
+#
+# Expects the following environment variables:
+#
+# - REPO=<owner>
+# - PAT_TOKEN=<github_pat_***>
+#
+
+set -e -u
+
+# Validate required environment variables
+if [ -z "${REPO:-}" ] || [ -z "${PAT_TOKEN:-}" ]; then
+    echo "Error: REPO and/or PAT_TOKEN environment variables not found"
+    exit 1
+fi
+
+# Check the cached registration token.
+TOKEN_FILE=registration-token.json
+if [ -f $TOKEN_FILE ]; then
+    set +e
+    EXPIRES=$(jq --raw-output .expires_at "$TOKEN_FILE" 2>/dev/null)
+    STATUS=$?
+    set -e
+else
+    STATUS=1
+    EXPIRES=""
+fi
+
+if [[ $STATUS -ne 0 || -z "$EXPIRES" || "$EXPIRES" == "null" || $(date +%s) -ge $(date -d "$EXPIRES" +%s) ]]; then
+    # Refresh the cached registration token.
+    curl \
+        -sS \
+        -X POST \
+        -H "Accept: application/vnd.github+json" \
+        -H "Authorization: Bearer $PAT_TOKEN" \
+        "https://api.github.com/repos/$REPO/actions/runners/registration-token" \
+        -o "$TOKEN_FILE"
+fi
+
+REG_TOKEN=$(jq --raw-output .token "$TOKEN_FILE")
+if [ $REG_TOKEN = "null" ]; then
+    echo "Failed to get registration token"
+    exit 1
+fi
+
+# (Re-)register the runner.
+./config.sh remove --token "$REG_TOKEN" || true
+set -x
+./config.sh \
+    --url "https://github.com/$REPO" \
+    --token "$REG_TOKEN" \
+    --unattended \
+    --disableupdate \
+    --replace \
+    --labels z15 \
+    --ephemeral
+
+# Run one job.
+./run.sh
diff --git a/arch/s390/self-hosted-builder/actions-runner-rebuild.sh b/arch/s390/self-hosted-builder/actions-runner-rebuild.sh
new file mode 100644
index 00000000..0fcd67d4
--- /dev/null
+++ b/arch/s390/self-hosted-builder/actions-runner-rebuild.sh
@@ -0,0 +1,49 @@
+#!/usr/bin/bash
+set -ex
+
+TMPDIR="$(mktemp -d)"
+
+if [ -f actions-runner.Dockerfile ]; then
+    MODE=1
+    cp actions-runner.Dockerfile actions-runner entrypoint $TMPDIR
+    cd $TMPDIR
+else
+    MODE=2
+    cd $TMPDIR
+    wget https://raw.githubusercontent.com/zlib-ng/zlib-ng/refs/heads/develop/arch/s390/self-hosted-builder/actions-runner.Dockerfile
+    wget https://raw.githubusercontent.com/zlib-ng/zlib-ng/refs/heads/develop/arch/s390/self-hosted-builder/actions-runner
+    wget https://raw.githubusercontent.com/zlib-ng/zlib-ng/refs/heads/develop/arch/s390/self-hosted-builder/entrypoint
+fi
+
+# Stop service
+systemctl stop actions-runner || true
+
+# Delete old container
+podman container rm gaplib-actions-runner || true
+
+# Delete old image
+podman image rm localhost/zlib-ng/actions-runner || true
+
+# Build new image
+podman build --squash -f actions-runner.Dockerfile --tag zlib-ng/actions-runner . 2>&1 | tee /var/log/actions-runner-build.log
+
+# Create new container
+podman create --replace --name=gaplib-actions-runner --env-file=/etc/actions-runner --init \
+       zlib-ng/actions-runner 2>&1 | tee -a /var/log/actions-runner-build.log
+
+# Start service
+systemctl start actions-runner || true
+
+# Cleanup
+podman image prune -af || true
+
+# Clean up tempfile
+if [ "$MODE" == "2" ] ; then
+    cd $TMPDIR
+    rm actions-runner.Dockerfile
+    rm actions-runner
+    rm entrypoint
+    cd ..
+    rmdir $TMPDIR
+    echo "Deleted tempfiles."
+fi
diff --git a/arch/s390/self-hosted-builder/actions-runner.Dockerfile b/arch/s390/self-hosted-builder/actions-runner.Dockerfile
index cf5c3e72..3faa078a 100644
--- a/arch/s390/self-hosted-builder/actions-runner.Dockerfile
+++ b/arch/s390/self-hosted-builder/actions-runner.Dockerfile
@@ -1,26 +1,25 @@
 # Self-Hosted IBM Z Github Actions Runner.
 
-FROM    almalinux:9
+FROM    almalinux:10
 
 RUN     dnf update -y -q && \
-        dnf install -y -q --enablerepo=crb wget git which sudo jq \
-            cmake make automake autoconf m4 libtool ninja-build python3-pip \
+        dnf install -y -q --enablerepo=crb wget git which sudo jq sed \
+            cmake make automake autoconf m4 libtool ninja-build \
+            python3-pip python3-devel python3-lxml \
             gcc gcc-c++ clang llvm-toolset glibc-all-langpacks langpacks-en \
             glibc-static libstdc++-static libstdc++-devel libxslt-devel libxml2-devel
 
-RUN     dnf install -y -q dotnet-sdk-6.0 && \
+RUN     dnf install -y -q dotnet-sdk-8.0 && \
         echo "Using SDK - `dotnet --version`"
 
-COPY    runner-s390x.patch /tmp/runner.patch
-COPY    runner-global.json /tmp/global.json
-
 RUN     cd /tmp && \
         git clone -q https://github.com/actions/runner && \
         cd runner && \
-        git checkout $(git describe --tags $(git rev-list --tags --max-count=1)) -b build && \
-        git apply /tmp/runner.patch && \
-        cp -f /tmp/global.json src/global.json
-
+        git checkout $(git tag --sort=-v:refname | grep '^v[0-9]' | head -n1) && \
+        git log -n 1 && \
+        wget https://github.com/ppc64le/gaplib/raw/refs/heads/main/patches/runner-main-sdk8-s390x.patch -O runner-sdk-8.patch && \
+        git apply --whitespace=nowarn runner-sdk-8.patch && \
+        sed -i'' -e /version/s/8......\"$/$8.0.100\"/ src/global.json
 
 RUN     cd /tmp/runner/src && \
         ./dev.sh layout && \
@@ -33,15 +32,15 @@ RUN     useradd -c "Action Runner" -m actions-runner && \
 RUN     tar -xf /tmp/runner/_package/*.tar.gz -C /home/actions-runner && \
         chown -R actions-runner:actions-runner /home/actions-runner
 
-#VOLUME  /home/actions-runner
-
+# Cleanup
 RUN     rm -rf /tmp/runner /var/cache/dnf/* /tmp/runner.patch /tmp/global.json && \
         dnf clean all
 
 USER    actions-runner
 
 # Scripts.
-COPY    fs/ /
+COPY    --chmod=555 entrypoint /usr/bin/
+COPY    --chmod=555 actions-runner /usr/bin/
 WORKDIR /home/actions-runner
 ENTRYPOINT ["/usr/bin/entrypoint"]
 CMD     ["/usr/bin/actions-runner"]
diff --git a/arch/s390/self-hosted-builder/actions-runner.service b/arch/s390/self-hosted-builder/actions-runner.service
index b6c20b65..79560cde 100644
--- a/arch/s390/self-hosted-builder/actions-runner.service
+++ b/arch/s390/self-hosted-builder/actions-runner.service
@@ -10,8 +10,8 @@ Environment=PODMAN_SYSTEMD_UNIT=%n
 Restart=always
 TimeoutStopSec=61
 ExecStart=/usr/bin/podman start gaplib-actions-runner
-ExecStop=/usr/bin/podman stop -t 1 gaplib-actions-runner
-ExecStopPost=/usr/bin/podman stop -t 1 gaplib-actions-runner
+ExecStop=/usr/bin/podman stop -t 30 gaplib-actions-runner
+ExecStopPost=/usr/bin/podman stop -t 10 gaplib-actions-runner
 Type=forking
 
 [Install]
diff --git a/arch/s390/self-hosted-builder/fs/usr/bin/entrypoint b/arch/s390/self-hosted-builder/entrypoint
similarity index 100%
rename from arch/s390/self-hosted-builder/fs/usr/bin/entrypoint
rename to arch/s390/self-hosted-builder/entrypoint
diff --git a/arch/s390/self-hosted-builder/fs/usr/bin/actions-runner b/arch/s390/self-hosted-builder/fs/usr/bin/actions-runner
deleted file mode 100755
index c9d8227d..00000000
--- a/arch/s390/self-hosted-builder/fs/usr/bin/actions-runner
+++ /dev/null
@@ -1,40 +0,0 @@
-#!/bin/bash
-
-#
-# Ephemeral runner startup script.
-#
-# Expects the following environment variables:
-#
-# - repo=<owner>/<name>
-# - access_token=<ghp_***>
-#
-
-set -e -u
-
-# Check the cached registration token.
-token_file=registration-token.json
-set +e
-expires_at=$(jq --raw-output .expires_at "$token_file" 2>/dev/null)
-status=$?
-set -e
-if [[ $status -ne 0 || $(date +%s) -ge $(date -d "$expires_at" +%s) ]]; then
-    # Refresh the cached registration token.
-    curl \
-        -X POST \
-        -H "Accept: application/vnd.github.v3+json" \
-        -H "Authorization: token $access_token" \
-        "https://api.github.com/repos/$repo/actions/runners/registration-token" \
-        -o "$token_file"
-fi
-
-# (Re-)register the runner.
-registration_token=$(jq --raw-output .token "$token_file")
-./config.sh remove --token "$registration_token" || true
-./config.sh \
-    --url "https://github.com/$repo" \
-    --token "$registration_token" \
-    --labels z15 \
-    --ephemeral
-
-# Run one job.
-./run.sh
diff --git a/arch/s390/self-hosted-builder/runner-global.json b/arch/s390/self-hosted-builder/runner-global.json
deleted file mode 100644
index e7028fe0..00000000
--- a/arch/s390/self-hosted-builder/runner-global.json
+++ /dev/null
@@ -1,5 +0,0 @@
-{
-  "sdk": {
-    "version": "6.0.421"
-  }
-}
diff --git a/arch/s390/self-hosted-builder/runner-s390x.patch b/arch/s390/self-hosted-builder/runner-s390x.patch
deleted file mode 100644
index 8260f3cc..00000000
--- a/arch/s390/self-hosted-builder/runner-s390x.patch
+++ /dev/null
@@ -1,243 +0,0 @@
-diff --git a/src/Directory.Build.props b/src/Directory.Build.props
-index 9db5fac..f02e235 100644
---- a/src/Directory.Build.props
-+++ b/src/Directory.Build.props
-@@ -44,6 +44,9 @@
-   <PropertyGroup Condition="'$(BUILD_OS)' == 'Linux' AND '$(PackageRuntime)' == 'linux-arm64'">
-     <DefineConstants>$(DefineConstants);ARM64</DefineConstants>
-   </PropertyGroup>
-+  <PropertyGroup Condition="'$(BUILD_OS)' == 'Linux' AND '$(PackageRuntime)' == 'linux-s390x'">
-+    <DefineConstants>$(DefineConstants);S390X</DefineConstants>
-+  </PropertyGroup>
- 
-   <!-- Set TRACE/DEBUG vars -->
-   <PropertyGroup>
-diff --git a/src/Misc/externals.sh b/src/Misc/externals.sh
-index 383221e..1555f67 100755
---- a/src/Misc/externals.sh
-+++ b/src/Misc/externals.sh
-@@ -189,3 +189,8 @@ if [[ "$PACKAGERUNTIME" == "linux-arm" ]]; then
-     acquireExternalTool "$NODE_URL/v${NODE16_VERSION}/node-v${NODE16_VERSION}-linux-armv7l.tar.gz" node16 fix_nested_dir
-     acquireExternalTool "$NODE_URL/v${NODE20_VERSION}/node-v${NODE20_VERSION}-linux-armv7l.tar.gz" node20 fix_nested_dir
- fi
-+
-+if [[ "$PACKAGERUNTIME" == "linux-s390x" ]]; then
-+    acquireExternalTool "$NODE_URL/v${NODE16_VERSION}/node-v${NODE16_VERSION}-linux-s390x.tar.gz" node16 fix_nested_dir
-+    acquireExternalTool "$NODE_URL/v${NODE20_VERSION}/node-v${NODE20_VERSION}-linux-s390x.tar.gz" node20 fix_nested_dir
-+fi
-diff --git a/src/Misc/layoutroot/config.sh b/src/Misc/layoutroot/config.sh
-index 14cc6ba..9b5b8e6 100755
---- a/src/Misc/layoutroot/config.sh
-+++ b/src/Misc/layoutroot/config.sh
-@@ -20,25 +20,29 @@ then
- 
-     message="Execute sudo ./bin/installdependencies.sh to install any missing Dotnet Core 6.0 dependencies."
- 
--    ldd ./bin/libcoreclr.so | grep 'not found'
--    if [ $? -eq 0 ]; then
--        echo "Dependencies is missing for Dotnet Core 6.0"
--        echo $message
--        exit 1
--    fi
-+    ARCH=`uname -m`
-+    if [ "${ARCH}" != "s390x" -a "${ARCH}" != "ppc64le" ]
-+    then
-+        ldd ./bin/libcoreclr.so | grep 'not found'
-+        if [ $? -eq 0 ]; then
-+            echo "Dependencies is missing for Dotnet Core 6.0"
-+            echo $message
-+            exit 1
-+        fi
- 
--    ldd ./bin/libSystem.Security.Cryptography.Native.OpenSsl.so | grep 'not found'
--    if [ $? -eq 0 ]; then
--        echo "Dependencies is missing for Dotnet Core 6.0"
--        echo $message
--        exit 1
--    fi
-+        ldd ./bin/libSystem.Security.Cryptography.Native.OpenSsl.so | grep 'not found'
-+        if [ $? -eq 0 ]; then
-+            echo "Dependencies is missing for Dotnet Core 6.0"
-+            echo $message
-+            exit 1
-+        fi
- 
--    ldd ./bin/libSystem.IO.Compression.Native.so | grep 'not found'
--    if [ $? -eq 0 ]; then
--        echo "Dependencies is missing for Dotnet Core 6.0"
--        echo $message
--        exit 1
-+        ldd ./bin/libSystem.IO.Compression.Native.so | grep 'not found'
-+        if [ $? -eq 0 ]; then
-+            echo "Dependencies is missing for Dotnet Core 6.0"
-+            echo $message
-+            exit 1
-+        fi
-     fi
- 
-     if ! [ -x "$(command -v ldconfig)" ]; then
-diff --git a/src/Runner.Common/Constants.cs b/src/Runner.Common/Constants.cs
-index 177e3c9..9545981 100644
---- a/src/Runner.Common/Constants.cs
-+++ b/src/Runner.Common/Constants.cs
-@@ -58,7 +58,8 @@ namespace GitHub.Runner.Common
-             X86,
-             X64,
-             Arm,
--            Arm64
-+            Arm64,
-+	    S390x
-         }
- 
-         public static class Runner
-@@ -81,6 +82,8 @@ namespace GitHub.Runner.Common
-             public static readonly Architecture PlatformArchitecture = Architecture.Arm;
- #elif ARM64
-             public static readonly Architecture PlatformArchitecture = Architecture.Arm64;
-+#elif S390X
-+            public static readonly Architecture PlatformArchitecture = Architecture.S390x;
- #else
-             public static readonly Architecture PlatformArchitecture = Architecture.X64;
- #endif
-diff --git a/src/Runner.Common/Util/VarUtil.cs b/src/Runner.Common/Util/VarUtil.cs
-index 97273a1..2a34430 100644
---- a/src/Runner.Common/Util/VarUtil.cs
-+++ b/src/Runner.Common/Util/VarUtil.cs
-@@ -53,6 +53,8 @@ namespace GitHub.Runner.Common.Util
-                         return "ARM";
-                     case Constants.Architecture.Arm64:
-                         return "ARM64";
-+                    case Constants.Architecture.S390x:
-+                        return "S390X";
-                     default:
-                         throw new NotSupportedException(); // Should never reach here.
-                 }
-diff --git a/src/Test/L0/ConstantGenerationL0.cs b/src/Test/L0/ConstantGenerationL0.cs
-index 2042485..a9d8b46 100644
---- a/src/Test/L0/ConstantGenerationL0.cs
-+++ b/src/Test/L0/ConstantGenerationL0.cs
-@@ -20,6 +20,7 @@ namespace GitHub.Runner.Common.Tests
-                 "linux-x64",
-                 "linux-arm",
-                 "linux-arm64",
-+                "linux-s390x",
-                 "osx-x64",
-                 "osx-arm64"
-             };
-diff --git a/src/Test/L0/Listener/SelfUpdaterL0.cs b/src/Test/L0/Listener/SelfUpdaterL0.cs
-index 26ba65e..6791df3 100644
---- a/src/Test/L0/Listener/SelfUpdaterL0.cs
-+++ b/src/Test/L0/Listener/SelfUpdaterL0.cs
-@@ -1,4 +1,4 @@
--#if !(OS_WINDOWS && ARM64)
-+#if !(OS_WINDOWS && ARM64) && !S390X
- using System;
- using System.Collections.Generic;
- using System.IO;
-@@ -16,6 +16,7 @@ using Xunit;
- 
- namespace GitHub.Runner.Common.Tests.Listener
- {
-+#if !S390X // Self-update is not currently supported on S390X
-     public sealed class SelfUpdaterL0
-     {
-         private Mock<IRunnerServer> _runnerServer;
-@@ -291,5 +292,6 @@ namespace GitHub.Runner.Common.Tests.Listener
-             }
-         }
-     }
-+#endif
- }
- #endif
-diff --git a/src/Test/L0/Listener/SelfUpdaterV2L0.cs b/src/Test/L0/Listener/SelfUpdaterV2L0.cs
-index 5115a6b..dd8d198 100644
---- a/src/Test/L0/Listener/SelfUpdaterV2L0.cs
-+++ b/src/Test/L0/Listener/SelfUpdaterV2L0.cs
-@@ -1,4 +1,4 @@
--#if !(OS_WINDOWS && ARM64)
-+#if !(OS_WINDOWS && ARM64) && !S390X
- using System;
- using System.Collections.Generic;
- using System.IO;
-diff --git a/src/Test/L0/Worker/StepHostL0.cs b/src/Test/L0/Worker/StepHostL0.cs
-index f6b5889..26f8e21 100644
---- a/src/Test/L0/Worker/StepHostL0.cs
-+++ b/src/Test/L0/Worker/StepHostL0.cs
-@@ -31,7 +31,7 @@ namespace GitHub.Runner.Common.Tests.Worker
-             return hc;
-         }
- 
--#if OS_LINUX
-+#if OS_LINUX && !S390X
-         [Fact]
-         [Trait("Level", "L0")]
-         [Trait("Category", "Worker")]
-diff --git a/src/dev.sh b/src/dev.sh
-index fa637d1..8c66f37 100755
---- a/src/dev.sh
-+++ b/src/dev.sh
-@@ -54,6 +54,7 @@ elif [[ "$CURRENT_PLATFORM" == 'linux' ]]; then
-         case $CPU_NAME in
-             armv7l) RUNTIME_ID="linux-arm";;
-             aarch64) RUNTIME_ID="linux-arm64";;
-+            s390x) RUNTIME_ID="linux-s390x";;
-         esac
-     fi
- elif [[ "$CURRENT_PLATFORM" == 'darwin' ]]; then
-@@ -80,7 +81,7 @@ if [[ "$CURRENT_PLATFORM" == 'windows' ]]; then
-         exit 1
-     fi
- elif [[ "$CURRENT_PLATFORM" == 'linux' ]]; then
--    if [[ ("$RUNTIME_ID" != 'linux-x64') && ("$RUNTIME_ID" != 'linux-x86') && ("$RUNTIME_ID" != 'linux-arm64') && ("$RUNTIME_ID" != 'linux-arm') ]]; then
-+	if [[ ("$RUNTIME_ID" != 'linux-x64') && ("$RUNTIME_ID" != 'linux-x86') && ("$RUNTIME_ID" != 'linux-arm64') && ("$RUNTIME_ID" != 'linux-arm')  && ("$RUNTIME_ID" != 'linux-s390x') ]]; then
-        echo "Failed: Can't build $RUNTIME_ID package $CURRENT_PLATFORM" >&2
-        exit 1
-     fi
-@@ -199,7 +200,8 @@ function package ()
-     popd > /dev/null
- }
- 
--if [[ (! -d "${DOTNETSDK_INSTALLDIR}") || (! -e "${DOTNETSDK_INSTALLDIR}/.${DOTNETSDK_VERSION}") || (! -e "${DOTNETSDK_INSTALLDIR}/dotnet") ]]; then
-+if [[ "${RUNTIME_ID}" != "linux-s390x" && ((! -d "${DOTNETSDK_INSTALLDIR}") || (! -e "${DOTNETSDK_INSTALLDIR}/.${DOTNETSDK_VERSION}") || (! -e "${DOTNETSDK_INSTALLDIR}/dotnet")) ]]; then
-+
- 
-     # Download dotnet SDK to ../_dotnetsdk directory
-     heading "Ensure Dotnet SDK"
-@@ -224,8 +226,10 @@ if [[ (! -d "${DOTNETSDK_INSTALLDIR}") || (! -e "${DOTNETSDK_INSTALLDIR}/.${DOTN
-     echo "${DOTNETSDK_VERSION}" > "${DOTNETSDK_INSTALLDIR}/.${DOTNETSDK_VERSION}"
- fi
- 
--echo "Prepend ${DOTNETSDK_INSTALLDIR} to %PATH%"
--export PATH=${DOTNETSDK_INSTALLDIR}:$PATH
-+if [[ -d "${DOTNETSDK_INSTALLDIR}" ]]; then
-+    echo "Prepend ${DOTNETSDK_INSTALLDIR} to %PATH%"
-+    export PATH=${DOTNETSDK_INSTALLDIR}:$PATH
-+fi
- 
- heading "Dotnet SDK Version"
- dotnet --version
-diff --git a/src/dir.proj b/src/dir.proj
-index 056a312..8370922 100644
---- a/src/dir.proj
-+++ b/src/dir.proj
-@@ -41,8 +41,18 @@
-     </ItemGroup>
- 
-     <Target Name="Build" DependsOnTargets="GenerateConstant">
--        <MSBuild Targets="Restore" Projects="@(ProjectFiles)" StopOnFirstFailure="true" />
--        <MSBuild Targets="Publish" Projects="@(ProjectFiles)" BuildInParallel="false" StopOnFirstFailure="true" Properties="Configuration=$(BUILDCONFIG);PackageRuntime=$(PackageRuntime);Version=$(RunnerVersion);RuntimeIdentifier=$(PackageRuntime);PublishDir=$(MSBuildProjectDirectory)/../_layout/bin" />
-+        <PropertyGroup>
-+            <!-- Normally we want to publish a self-contained app for $(PackageRuntime) -->
-+            <PublishRuntimeIdentifier>RuntimeIdentifier=$(PackageRuntime)</PublishRuntimeIdentifier>
-+            <!-- However, on s390x there are no apphost or runtime packages on nuget.org, so self-contained publishing is not supported.
-+                 Perform a non-self-contained publish using the current runtime identifier (normally something like rhel.8-s390x) instead.
-+                 In addition, when not using an explicit runtime identifier, the SDK will copy runtime assets from dependent packages;
-+                 as this would confuse the expected layout, disable that behavior as well.  -->
-+            <PublishRuntimeIdentifier Condition="'$(PackageRuntime)' == 'linux-s390x'">SelfContained=false;CopyLocalRuntimeTargetAssets=false</PublishRuntimeIdentifier>
-+        </PropertyGroup>
-+
-+        <MSBuild Targets="Restore" Projects="@(ProjectFiles)" StopOnFirstFailure="true" Properties="$(PublishRuntimeIdentifier)" />
-+        <MSBuild Targets="Publish" Projects="@(ProjectFiles)" BuildInParallel="false" StopOnFirstFailure="true" Properties="Configuration=$(BUILDCONFIG);PackageRuntime=$(PackageRuntime);Version=$(RunnerVersion);$(PublishRuntimeIdentifier);PublishDir=$(MSBuildProjectDirectory)/../_layout/bin" />
-         <Exec Command="%22$(DesktopMSBuild)%22 Runner.Service/Windows/RunnerService.csproj /p:Configuration=$(BUILDCONFIG) /p:PackageRuntime=$(PackageRuntime) /p:OutputPath=%22$(MSBuildProjectDirectory)/../_layout/bin%22" ConsoleToMSBuild="true" Condition="'$(PackageRuntime)' == 'win-x64' Or '$(PackageRuntime)' == 'win-x86' Or '$(PackageRuntime)' == 'win-arm64'" />
-     </Target>
-
diff --git a/arch/x86/Makefile.in b/arch/x86/Makefile.in
index c13cd179..4972dd72 100644
--- a/arch/x86/Makefile.in
+++ b/arch/x86/Makefile.in
@@ -8,11 +8,12 @@ SFLAGS=
 INCLUDES=
 SUFFIX=
 
-AVX512FLAG=-mavx512f -mavx512dq -mavx512vl -mavx512bw
-AVX512VNNIFLAG=-mavx512vnni
-AVX2FLAG=-mavx2
+AVX512FLAG=-mavx512f -mavx512dq -mavx512vl -mavx512bw -mbmi2
+AVX512VNNIFLAG=-mavx512vnni -mbmi2
+AVX2FLAG=-mavx2 -mbmi2
 SSE2FLAG=-msse2
 SSSE3FLAG=-mssse3
+SSE41FLAG=-msse4.1
 SSE42FLAG=-msse4.2
 PCLMULFLAG=-mpclmul
 VPCLMULFLAG=-mvpclmulqdq
@@ -31,9 +32,13 @@ all: \
 	adler32_sse42.o adler32_sse42.lo \
 	adler32_ssse3.o adler32_ssse3.lo \
 	chunkset_avx2.o chunkset_avx2.lo \
+	chunkset_avx512.o chunkset_avx512.lo \
 	chunkset_sse2.o chunkset_sse2.lo \
 	chunkset_ssse3.o chunkset_ssse3.lo \
+	chorba_sse2.o chorba_sse2.lo \
+	chorba_sse41.o chorba_sse41.lo \
 	compare256_avx2.o compare256_avx2.lo \
+	compare256_avx512.o compare256_avx512.lo \
 	compare256_sse2.o compare256_sse2.lo \
 	crc32_pclmulqdq.o crc32_pclmulqdq.lo \
 	crc32_vpclmulqdq.o crc32_vpclmulqdq.lo \
@@ -52,6 +57,12 @@ chunkset_avx2.o:
 chunkset_avx2.lo:
 	$(CC) $(SFLAGS) $(AVX2FLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_avx2.c
 
+chunkset_avx512.o:
+	$(CC) $(CFLAGS) $(AVX512FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_avx512.c
+
+chunkset_avx512.lo:
+	$(CC) $(SFLAGS) $(AVX512FLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_avx512.c
+
 chunkset_sse2.o:
 	$(CC) $(CFLAGS) $(SSE2FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_sse2.c
 
@@ -64,12 +75,30 @@ chunkset_ssse3.o:
 chunkset_ssse3.lo:
 	$(CC) $(SFLAGS) $(SSSE3FLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/chunkset_ssse3.c
 
+chorba_sse2.o:
+	$(CC) $(CFLAGS) $(SSE2FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/chorba_sse2.c
+
+chorba_sse2.lo:
+	$(CC) $(SFLAGS) $(SSE2FLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/chorba_sse2.c
+
+chorba_sse41.o:
+	$(CC) $(CFLAGS) $(SSE41FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/chorba_sse41.c
+
+chorba_sse41.lo:
+	$(CC) $(SFLAGS) $(SSE41FLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/chorba_sse41.c
+
 compare256_avx2.o:
 	$(CC) $(CFLAGS) $(AVX2FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_avx2.c
 
 compare256_avx2.lo:
 	$(CC) $(SFLAGS) $(AVX2FLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_avx2.c
 
+compare256_avx512.o:
+	$(CC) $(CFLAGS) $(AVX512FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_avx512.c
+
+compare256_avx512.lo:
+	$(CC) $(SFLAGS) $(AVX512FLAG) $(NOLTOFLAG) -DPIC $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_avx512.c
+
 compare256_sse2.o:
 	$(CC) $(CFLAGS) $(SSE2FLAG) $(NOLTOFLAG) $(INCLUDES) -c -o $@ $(SRCDIR)/compare256_sse2.c
 
diff --git a/arch/x86/adler32_avx2.c b/arch/x86/adler32_avx2.c
index 38e7f068..bf748eb8 100644
--- a/arch/x86/adler32_avx2.c
+++ b/arch/x86/adler32_avx2.c
@@ -15,36 +15,31 @@
 #include "adler32_avx2_p.h"
 #include "x86_intrins.h"
 
-extern uint32_t adler32_fold_copy_sse42(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+extern uint32_t adler32_copy_sse42(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
 extern uint32_t adler32_ssse3(uint32_t adler, const uint8_t *src, size_t len);
 
-static inline uint32_t adler32_fold_copy_impl(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len, const int COPY) {
-    if (src == NULL) return 1L;
-    if (len == 0) return adler;
-
+Z_FORCEINLINE static uint32_t adler32_copy_impl(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len, const int COPY) {
     uint32_t adler0, adler1;
     adler1 = (adler >> 16) & 0xffff;
     adler0 = adler & 0xffff;
 
 rem_peel:
     if (len < 16) {
-        if (COPY) {
-            return adler32_copy_len_16(adler0, src, dst, len, adler1);
-        } else {
-            return adler32_len_16(adler0, src, len, adler1);
-        }
+        return adler32_copy_len_16(adler0, dst, src, len, adler1, COPY);
     } else if (len < 32) {
         if (COPY) {
-            return adler32_fold_copy_sse42(adler, dst, src, len);
+            return adler32_copy_sse42(adler, dst, src, len);
         } else {
             return adler32_ssse3(adler, src, len);
         }
     }
 
-    __m256i vs1, vs2;
+    __m256i vs1, vs2, vs2_0;
 
-    const __m256i dot2v = _mm256_setr_epi8(32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15,
-                                           14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1);
+    const __m256i dot2v = _mm256_setr_epi8(64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47,
+                                           46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33);
+    const __m256i dot2v_0 = _mm256_setr_epi8(32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15,
+                                             14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1);
     const __m256i dot3v = _mm256_set1_epi16(1);
     const __m256i zero = _mm256_setzero_si256();
 
@@ -53,11 +48,44 @@ rem_peel:
         vs2 = _mm256_zextsi128_si256(_mm_cvtsi32_si128(adler1));
         __m256i vs1_0 = vs1;
         __m256i vs3 = _mm256_setzero_si256();
+        vs2_0 = vs3;
 
         size_t k = MIN(len, NMAX);
         k -= k % 32;
         len -= k;
 
+        while (k >= 64) {
+            __m256i vbuf = _mm256_loadu_si256((__m256i*)src);
+            __m256i vbuf_0 = _mm256_loadu_si256((__m256i*)(src + 32));
+            src += 64;
+            k -= 64;
+
+            __m256i vs1_sad = _mm256_sad_epu8(vbuf, zero);
+            __m256i vs1_sad2 = _mm256_sad_epu8(vbuf_0, zero);
+
+            if (COPY) {
+                _mm256_storeu_si256((__m256i*)dst, vbuf);
+                _mm256_storeu_si256((__m256i*)(dst + 32), vbuf_0);
+                dst += 64;
+            }
+
+            vs1 = _mm256_add_epi32(vs1, vs1_sad);
+            vs3 = _mm256_add_epi32(vs3, vs1_0);
+            __m256i v_short_sum2 = _mm256_maddubs_epi16(vbuf, dot2v); // sum 32 uint8s to 16 shorts
+            __m256i v_short_sum2_0 = _mm256_maddubs_epi16(vbuf_0, dot2v_0); // sum 32 uint8s to 16 shorts
+            __m256i vsum2 = _mm256_madd_epi16(v_short_sum2, dot3v); // sum 16 shorts to 8 uint32s
+            __m256i vsum2_0 = _mm256_madd_epi16(v_short_sum2_0, dot3v); // sum 16 shorts to 8 uint32s
+            vs1 = _mm256_add_epi32(vs1_sad2, vs1);
+            vs2 = _mm256_add_epi32(vsum2, vs2);
+            vs2_0 = _mm256_add_epi32(vsum2_0, vs2_0);
+            vs1_0 = vs1;
+        }
+
+        vs2 = _mm256_add_epi32(vs2_0, vs2);
+        vs3 = _mm256_slli_epi32(vs3, 6);
+        vs2 = _mm256_add_epi32(vs3, vs2);
+        vs3 = _mm256_setzero_si256();
+
         while (k >= 32) {
             /*
                vs1 = adler + sum(c[i])
@@ -73,10 +101,10 @@ rem_peel:
                 _mm256_storeu_si256((__m256i*)dst, vbuf);
                 dst += 32;
             }
- 
+
             vs1 = _mm256_add_epi32(vs1, vs1_sad);
             vs3 = _mm256_add_epi32(vs3, vs1_0);
-            __m256i v_short_sum2 = _mm256_maddubs_epi16(vbuf, dot2v); // sum 32 uint8s to 16 shorts
+            __m256i v_short_sum2 = _mm256_maddubs_epi16(vbuf, dot2v_0); // sum 32 uint8s to 16 shorts
             __m256i vsum2 = _mm256_madd_epi16(v_short_sum2, dot3v); // sum 16 shorts to 8 uint32s
             vs2 = _mm256_add_epi32(vsum2, vs2);
             vs1_0 = vs1;
@@ -135,11 +163,11 @@ rem_peel:
 }
 
 Z_INTERNAL uint32_t adler32_avx2(uint32_t adler, const uint8_t *src, size_t len) {
-    return adler32_fold_copy_impl(adler, NULL, src, len, 0);
+    return adler32_copy_impl(adler, NULL, src, len, 0);
 }
 
-Z_INTERNAL uint32_t adler32_fold_copy_avx2(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
-    return adler32_fold_copy_impl(adler, dst, src, len, 1);
+Z_INTERNAL uint32_t adler32_copy_avx2(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, dst, src, len, 1);
 }
 
 #endif
diff --git a/arch/x86/adler32_avx512.c b/arch/x86/adler32_avx512.c
index 626c4807..5fffbd36 100644
--- a/arch/x86/adler32_avx512.c
+++ b/arch/x86/adler32_avx512.c
@@ -15,10 +15,7 @@
 #include "x86_intrins.h"
 #include "adler32_avx512_p.h"
 
-static inline uint32_t adler32_fold_copy_impl(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len, const int COPY) {
-    if (src == NULL) return 1L;
-    if (len == 0) return adler;
-
+Z_FORCEINLINE static uint32_t adler32_copy_impl(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len, const int COPY) {
     uint32_t adler0, adler1;
     adler1 = (adler >> 16) & 0xffff;
     adler0 = adler & 0xffff;
@@ -26,7 +23,7 @@ static inline uint32_t adler32_fold_copy_impl(uint32_t adler, uint8_t *dst, cons
 rem_peel:
     if (len < 64) {
         /* This handles the remaining copies, just call normal adler checksum after this */
-        if (COPY) {
+        if (COPY && len) {
             __mmask64 storemask = (0xFFFFFFFFFFFFFFFFUL >> (64 - len));
             __m512i copy_vec = _mm512_maskz_loadu_epi8(storemask, src);
             _mm512_mask_storeu_epi8(dst, storemask, copy_vec);
@@ -96,13 +93,12 @@ rem_peel:
     return adler;
 }
 
-Z_INTERNAL uint32_t adler32_fold_copy_avx512(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
-    return adler32_fold_copy_impl(adler, dst, src, len, 1);
+Z_INTERNAL uint32_t adler32_avx512(uint32_t adler, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, NULL, src, len, 0);
 }
 
-Z_INTERNAL uint32_t adler32_avx512(uint32_t adler, const uint8_t *src, size_t len) {
-    return adler32_fold_copy_impl(adler, NULL, src, len, 0);
+Z_INTERNAL uint32_t adler32_copy_avx512(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    return adler32_copy_impl(adler, dst, src, len, 1);
 }
 
 #endif
-
diff --git a/arch/x86/adler32_avx512_p.h b/arch/x86/adler32_avx512_p.h
index 5b79d2ab..74226905 100644
--- a/arch/x86/adler32_avx512_p.h
+++ b/arch/x86/adler32_avx512_p.h
@@ -3,6 +3,17 @@
 
 #include <immintrin.h>
 #include <stdint.h>
+
+/* Written because Visual C++ toolchains before v142 have constant overflow in AVX512 intrinsic macros */
+#if defined(_MSC_VER) && !defined(_MM_K0_REG8)
+#  undef _mm512_extracti64x4_epi64
+#  define _mm512_extracti64x4_epi64(v1, e1) _mm512_maskz_extracti64x4_epi64(UINT8_MAX, v1, e1)
+#  undef _mm512_set1_epi16
+#  define _mm512_set1_epi16(e1) _mm512_maskz_set1_epi16(UINT32_MAX, e1)
+#  undef _mm512_maddubs_epi16
+#  define _mm512_maddubs_epi16(v1, v2) _mm512_maskz_maddubs_epi16(UINT32_MAX, v1, v2)
+#endif
+
 /* Written because *_add_epi32(a) sets off ubsan */
 static inline uint32_t _mm512_reduce_add_epu32(__m512i x) {
     __m256i a = _mm512_extracti64x4_epi64(x, 1);
diff --git a/arch/x86/adler32_avx512_vnni.c b/arch/x86/adler32_avx512_vnni.c
index 4c5cfc1c..741176ca 100644
--- a/arch/x86/adler32_avx512_vnni.c
+++ b/arch/x86/adler32_avx512_vnni.c
@@ -18,9 +18,6 @@
 #include "adler32_avx2_p.h"
 
 Z_INTERNAL uint32_t adler32_avx512_vnni(uint32_t adler, const uint8_t *src, size_t len) {
-    if (src == NULL) return 1L;
-    if (len == 0) return adler;
-
     uint32_t adler0, adler1;
     adler1 = (adler >> 16) & 0xffff;
     adler0 = adler & 0xffff;
@@ -109,10 +106,8 @@ rem_peel:
     return adler;
 }
 
-Z_INTERNAL uint32_t adler32_fold_copy_avx512_vnni(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
-    if (src == NULL) return 1L;
-    if (len == 0) return adler;
-
+/* Use 256-bit vectors when copying because 512-bit variant is slower. */
+Z_INTERNAL uint32_t adler32_copy_avx512_vnni(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
     uint32_t adler0, adler1;
     adler1 = (adler >> 16) & 0xffff;
     adler0 = adler & 0xffff;
diff --git a/arch/x86/adler32_sse42.c b/arch/x86/adler32_sse42.c
index df0739d1..e9178488 100644
--- a/arch/x86/adler32_sse42.c
+++ b/arch/x86/adler32_sse42.c
@@ -13,15 +13,14 @@
 
 #ifdef X86_SSE42
 
-Z_INTERNAL uint32_t adler32_fold_copy_sse42(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+Z_INTERNAL uint32_t adler32_copy_sse42(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
     uint32_t adler0, adler1;
     adler1 = (adler >> 16) & 0xffff;
     adler0 = adler & 0xffff;
 
 rem_peel:
-    if (len < 16) {
-       return adler32_copy_len_16(adler0, src, dst, len, adler1);
-    }
+    if (UNLIKELY(len < 16))
+       return adler32_copy_len_16(adler0, dst, src, len, adler1, 1);
 
     __m128i vbuf, vbuf_0;
     __m128i vs1_0, vs3, vs1, vs2, vs2_0, v_sad_sum1, v_short_sum2, v_short_sum2_0,
diff --git a/arch/x86/adler32_ssse3.c b/arch/x86/adler32_ssse3.c
index 15e2f78b..d3f8f089 100644
--- a/arch/x86/adler32_ssse3.c
+++ b/arch/x86/adler32_ssse3.c
@@ -14,7 +14,7 @@
 
 #include <immintrin.h>
 
-Z_INTERNAL uint32_t adler32_ssse3(uint32_t adler, const uint8_t *buf, size_t len) {
+Z_FORCEINLINE static uint32_t adler32_impl(uint32_t adler, const uint8_t *buf, size_t len) {
     uint32_t sum2;
 
      /* split Adler-32 into component sums */
@@ -23,15 +23,11 @@ Z_INTERNAL uint32_t adler32_ssse3(uint32_t adler, const uint8_t *buf, size_t len
 
     /* in case user likes doing a byte at a time, keep it fast */
     if (UNLIKELY(len == 1))
-        return adler32_len_1(adler, buf, sum2);
-
-    /* initial Adler-32 value (deferred check for len == 1 speed) */
-    if (UNLIKELY(buf == NULL))
-        return 1L;
+        return adler32_copy_len_1(adler, NULL, buf, sum2, 0);
 
     /* in case short lengths are provided, keep it somewhat fast */
     if (UNLIKELY(len < 16))
-        return adler32_len_16(adler, buf, len, sum2);
+        return adler32_copy_len_16(adler, NULL, buf, len, sum2, 0);
 
     const __m128i dot2v = _mm_setr_epi8(32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17);
     const __m128i dot2v_0 = _mm_setr_epi8(16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1);
@@ -150,7 +146,17 @@ unaligned_jmp:
     }
 
     /* Process tail (len < 16).  */
-    return adler32_len_16(adler, buf, len, sum2);
+    return adler32_copy_len_16(adler, NULL, buf, len, sum2, 0);
+}
+
+Z_INTERNAL uint32_t adler32_ssse3(uint32_t adler, const uint8_t *buf, size_t len) {
+    return adler32_impl(adler, buf, len);
 }
 
+/* SSSE3 unaligned stores have a huge penalty, so we use memcpy. */
+Z_INTERNAL uint32_t adler32_copy_ssse3(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len) {
+    adler = adler32_impl(adler, src, len);
+    memcpy(dst, src, len);
+    return adler;
+}
 #endif
diff --git a/arch/x86/chorba_sse2.c b/arch/x86/chorba_sse2.c
new file mode 100644
index 00000000..4d7e7d1f
--- /dev/null
+++ b/arch/x86/chorba_sse2.c
@@ -0,0 +1,882 @@
+#if defined(X86_SSE2) && !defined(WITHOUT_CHORBA_SSE)
+
+#include "zbuild.h"
+#include "crc32_braid_p.h"
+#include "crc32_braid_tbl.h"
+#include "crc32.h"
+#include <emmintrin.h>
+#include "arch/x86/x86_intrins.h"
+#include "arch_functions.h"
+
+#define READ_NEXT(in, off, a, b) do { \
+        a = _mm_load_si128((__m128i*)(in + off / sizeof(uint64_t))); \
+        b = _mm_load_si128((__m128i*)(in + off / sizeof(uint64_t) + 2)); \
+        } while (0);
+
+#define NEXT_ROUND(invec, a, b, c, d) do { \
+        a = _mm_xor_si128(_mm_slli_epi64(invec, 17), _mm_slli_epi64(invec, 55)); \
+        b = _mm_xor_si128(_mm_xor_si128(_mm_srli_epi64(invec, 47), _mm_srli_epi64(invec, 9)), _mm_slli_epi64(invec, 19)); \
+        c = _mm_xor_si128(_mm_srli_epi64(invec, 45), _mm_slli_epi64(invec, 44)); \
+        d  = _mm_srli_epi64(invec, 20); \
+        } while (0);
+
+Z_INTERNAL uint32_t chorba_small_nondestructive_sse2(uint32_t crc, const uint64_t* buf, size_t len) {
+    const uint64_t* input = buf;
+    ALIGNED_(16) uint64_t final[9] = {0};
+    uint64_t next1 = crc;
+    crc = 0;
+    uint64_t next2 = 0;
+    uint64_t next3 = 0;
+    uint64_t next4 = 0;
+    uint64_t next5 = 0;
+
+    __m128i next12 = _mm_cvtsi64_si128(next1);
+    __m128i next34 = _mm_setzero_si128();
+    __m128i next56 = _mm_setzero_si128();
+    __m128i ab1, ab2, ab3, ab4, cd1, cd2, cd3, cd4;
+
+    size_t i = 0;
+
+    /* This is weird, doing for vs while drops 10% off the exec time */
+    for(; (i + 256 + 40 + 32 + 32) < len; i += 32) {
+        __m128i in1in2, in3in4;
+
+        /*
+        uint64_t chorba1 = input[i / sizeof(uint64_t)];
+        uint64_t chorba2 = input[i / sizeof(uint64_t) + 1];
+        uint64_t chorba3 = input[i / sizeof(uint64_t) + 2];
+        uint64_t chorba4 = input[i / sizeof(uint64_t) + 3];
+        uint64_t chorba5 = input[i / sizeof(uint64_t) + 4];
+        uint64_t chorba6 = input[i / sizeof(uint64_t) + 5];
+        uint64_t chorba7 = input[i / sizeof(uint64_t) + 6];
+        uint64_t chorba8 = input[i / sizeof(uint64_t) + 7];
+        */
+
+        const uint64_t *inputPtr = input + (i / sizeof(uint64_t));
+        const __m128i *inputPtr128 = (__m128i*)inputPtr;
+        __m128i chorba12 = _mm_load_si128(inputPtr128++);
+        __m128i chorba34 = _mm_load_si128(inputPtr128++);
+        __m128i chorba56 = _mm_load_si128(inputPtr128++);
+        __m128i chorba78 = _mm_load_si128(inputPtr128++);
+
+        chorba12 = _mm_xor_si128(chorba12, next12);
+        chorba34 = _mm_xor_si128(chorba34, next34);
+        chorba56 = _mm_xor_si128(chorba56, next56);
+        chorba78 = _mm_xor_si128(chorba78, chorba12);
+        __m128i chorba45 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(chorba34), _mm_castsi128_pd(chorba56), 1));
+        __m128i chorba23 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(chorba12),
+                                                           _mm_castsi128_pd(chorba34), 1));
+        /*
+        chorba1 ^= next1;
+        chorba2 ^= next2;
+        chorba3 ^= next3;
+        chorba4 ^= next4;
+        chorba5 ^= next5;
+        chorba7 ^= chorba1;
+        chorba8 ^= chorba2;
+        */
+        i += 8 * 8;
+
+        /* 0-3 */
+        /*in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];*/
+        READ_NEXT(input, i, in1in2, in3in4);
+        __m128i chorba34xor = _mm_xor_si128(chorba34, _mm_unpacklo_epi64(_mm_setzero_si128(), chorba12));
+        in1in2 = _mm_xor_si128(in1in2, chorba34xor);
+        /*
+        in1 ^= chorba3;
+        in2 ^= chorba4 ^ chorba1;
+        */
+
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+        /*
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+
+        */
+
+        in3in4 = _mm_xor_si128(in3in4, ab1);
+        /* _hopefully_ we don't get a huge domain switching penalty for this. This seems to be the best sequence */
+        __m128i chorba56xor = _mm_xor_si128(chorba56, _mm_unpacklo_epi64(_mm_setzero_si128(), ab2));
+
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba56xor, chorba23));
+        in3in4 = _mm_xor_si128(in3in4, chorba12);
+
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+        /*
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+        in3 ^= a1 ^ chorba5 ^ chorba2 ^ chorba1;
+        in4 ^= b1 ^a2 ^ chorba6 ^ chorba3 ^ chorba2;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+
+        __m128i b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        __m128i a4_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab4);
+        a4_ = _mm_xor_si128(b2c2, a4_);
+        next12 = _mm_xor_si128(ab3, a4_);
+        next12 = _mm_xor_si128(next12, cd1);
+
+        __m128i d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        __m128i b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+
+        /*out1 = a3 ^ b2 ^ c1;
+        out2 = b3 ^ c2 ^ d1 ^ a4;*/
+        next34 = _mm_xor_si128(cd3, _mm_xor_si128(b4c4, d2_));
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+
+        //out3 = b4 ^ c3 ^ d2;
+        //out4 = c4 ^ d3;
+
+        //out5 = d4;
+
+        /*
+        next1 = out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+
+        i += 32;
+
+        /* 4-7 */
+        /*in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];*/
+        READ_NEXT(input, i, in1in2, in3in4);
+
+        in1in2 = _mm_xor_si128(in1in2, next12);
+        in1in2 = _mm_xor_si128(in1in2, chorba78);
+        in1in2 = _mm_xor_si128(in1in2, chorba45);
+        in1in2 = _mm_xor_si128(in1in2, chorba34);
+
+        /*
+        in1 ^= next1 ^ chorba7 ^ chorba4 ^ chorba3;
+        in2 ^= next2 ^ chorba8 ^ chorba5 ^ chorba4;
+        */
+
+        /*
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+        */
+
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+
+        /*
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+
+        in3 ^= next3 ^ a1 ^ chorba6 ^ chorba5;
+        in4 ^= next4 ^ b1 ^ a2  ^ chorba7 ^ chorba6;
+        */
+        in3in4 = _mm_xor_si128(in3in4, next34);
+        in3in4 = _mm_xor_si128(in3in4, ab1);
+        in3in4 = _mm_xor_si128(in3in4, chorba56);
+        __m128i chorba67 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(chorba56), _mm_castsi128_pd(chorba78), 1));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba67, _mm_unpacklo_epi64(_mm_setzero_si128(), ab2)));
+
+        /*
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        ///*
+        b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        a4_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab4);
+        a4_ = _mm_xor_si128(b2c2, a4_);
+        next12 = _mm_xor_si128(ab3, cd1);
+
+        next12 = _mm_xor_si128(next12, a4_);
+        next12 = _mm_xor_si128(next12, next56);
+        b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+        next34 = _mm_xor_si128(b4c4, cd3);
+        d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        next34 = _mm_xor_si128(next34, d2_);
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+        //*/
+
+        /*
+        out1 = a3 ^ b2 ^ c1;
+        out2 = b3 ^ c2 ^ d1 ^ a4;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+
+        i += 32;
+
+        /* 8-11 */
+        /*
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+        in1 ^= next1 ^ chorba8 ^ chorba7 ^ chorba1;
+        in2 ^= next2 ^ chorba8 ^ chorba2;
+        */
+
+        READ_NEXT(input, i, in1in2, in3in4);
+
+        __m128i chorba80 = _mm_unpackhi_epi64(chorba78, _mm_setzero_si128());
+        __m128i next12_chorba12 = _mm_xor_si128(next12, chorba12);
+        in1in2 = _mm_xor_si128(in1in2, chorba80);
+        in1in2 = _mm_xor_si128(in1in2, chorba78);
+        in1in2 = _mm_xor_si128(in1in2, next12_chorba12);
+
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+
+        /*
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+        */
+
+        /*in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];*/
+        in3in4 = _mm_xor_si128(next34, in3in4);
+        in3in4 = _mm_xor_si128(in3in4, ab1);
+        __m128i a2_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab2);
+        in3in4 = _mm_xor_si128(in3in4, chorba34);
+        in3in4 = _mm_xor_si128(in3in4, a2_);
+
+        /*
+        in3 ^= next3 ^ a1 ^ chorba3;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba4;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+
+
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        a4_ = _mm_unpacklo_epi64(next56, ab4);
+        next12 = _mm_xor_si128(a4_, ab3);
+        next12 = _mm_xor_si128(next12, cd1);
+        b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+        d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        next12 = _mm_xor_si128(next12, b2c2);
+        next34 = _mm_xor_si128(b4c4, cd3);
+        next34 = _mm_xor_si128(next34, d2_);
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+
+        /*
+        out1 =      a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+
+        i += 32;
+
+        /* 12-15 */
+        /*
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+        */
+        READ_NEXT(input, i, in1in2, in3in4);
+        in1in2 = _mm_xor_si128(in1in2, next12);
+        __m128i chorb56xorchorb12 = _mm_xor_si128(chorba56, chorba12);
+        in1in2 = _mm_xor_si128(in1in2, chorb56xorchorb12);
+        __m128i chorb1_ = _mm_unpacklo_epi64(_mm_setzero_si128(), chorba12);
+        in1in2 = _mm_xor_si128(in1in2, chorb1_);
+
+
+        /*
+        in1 ^= next1 ^ chorba5 ^ chorba1;
+        in2 ^= next2 ^ chorba6 ^ chorba2 ^ chorba1;
+
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+        */
+
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+
+        /*
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+        in3 ^= next3 ^ a1 ^ chorba7 ^ chorba3 ^ chorba2 ^ chorba1;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8 ^ chorba4 ^ chorba3 ^ chorba2;
+        */
+
+        in3in4 = _mm_xor_si128(next34, in3in4);
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(ab1, chorba78));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba34, chorba12));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba23, _mm_unpacklo_epi64(_mm_setzero_si128(), ab2)));
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        /*
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+
+        ///*
+        a4_ = _mm_unpacklo_epi64(next56, ab4);
+        next12 = _mm_xor_si128(_mm_xor_si128(a4_, ab3), cd1);
+        b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+        d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        next12 = _mm_xor_si128(next12, b2c2);
+        next34 = _mm_xor_si128(b4c4, cd3);
+        next34 = _mm_xor_si128(next34, d2_);
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+        //*/
+
+        /*
+        out1 =      a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+
+        i += 32;
+
+        /* 16-19 */
+        /*
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+        in1 ^= next1 ^ chorba5 ^ chorba4 ^ chorba3 ^ chorba1;
+        in2 ^= next2 ^ chorba6 ^ chorba5 ^ chorba4 ^ chorba1 ^ chorba2;
+        */
+        ///*
+        READ_NEXT(input, i, in1in2, in3in4);
+        __m128i chorba1_ = _mm_unpacklo_epi64(_mm_setzero_si128(), chorba12);
+        in1in2 = _mm_xor_si128(_mm_xor_si128(next12, in1in2), _mm_xor_si128(chorba56, chorba45));
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(chorba12, chorba34));
+        in1in2 = _mm_xor_si128(chorba1_, in1in2);
+
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+        //*/
+
+        /*
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+        */
+
+        /*
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+        */
+        ///*
+        a2_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab2);
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(ab1, chorba78));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba56, chorba34));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba23, chorba67));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba1_, a2_));
+        in3in4 = _mm_xor_si128(in3in4, next34);
+        //*/
+        /*
+        in3 ^= next3 ^ a1 ^ chorba7 ^ chorba6 ^ chorba5 ^ chorba2 ^ chorba3;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8 ^ chorba7 ^ chorba6 ^ chorba3 ^ chorba4 ^ chorba1;
+        */
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        /*
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+
+        a4_ = _mm_unpacklo_epi64(next56, ab4);
+        next12 = _mm_xor_si128(_mm_xor_si128(a4_, ab3), cd1);
+        b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+        d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        next12 = _mm_xor_si128(next12, b2c2);
+        next34 = _mm_xor_si128(b4c4, cd3);
+        next34 = _mm_xor_si128(next34, d2_);
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+
+        /*
+        out1 =      a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+
+        i += 32;
+
+        /* 20-23 */
+        /*
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+        in1 ^= next1 ^ chorba8 ^ chorba7 ^ chorba4 ^ chorba5 ^ chorba2 ^ chorba1;
+        in2 ^= next2 ^ chorba8 ^ chorba5 ^ chorba6 ^ chorba3 ^ chorba2;
+        */
+
+        READ_NEXT(input, i, in1in2, in3in4);
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(next12, chorba78));
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(chorba45, chorba56));
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(chorba23, chorba12));
+        in1in2 = _mm_xor_si128(in1in2, chorba80);
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+
+        /*
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+        */
+
+        /*
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+        in3 ^= next3 ^ a1 ^ chorba7 ^ chorba6 ^ chorba4 ^ chorba3 ^ chorba1;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8 ^ chorba7 ^ chorba5 ^ chorba4 ^ chorba2 ^ chorba1;
+        */
+        a2_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab2);
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(next34, ab1));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba78, chorba67));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba45, chorba34));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba1_, a2_));
+        in3in4 = _mm_xor_si128(in3in4, chorba12);
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        /*
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+
+        /*
+        out1 =      a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+
+        a4_ = _mm_unpacklo_epi64(next56, ab4);
+        next12 = _mm_xor_si128(_mm_xor_si128(a4_, ab3), cd1);
+        b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+        d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        next12 = _mm_xor_si128(next12, b2c2);
+        next34 = _mm_xor_si128(b4c4, cd3);
+        next34 = _mm_xor_si128(next34, d2_);
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+
+        i += 32;
+
+        /* 24-27 */
+        /*
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+        in1 ^= next1 ^ chorba8 ^ chorba6 ^ chorba5 ^ chorba3 ^ chorba2 ^ chorba1;
+        in2 ^= next2 ^ chorba7 ^ chorba6 ^ chorba4 ^ chorba3 ^ chorba2;
+        */
+
+        READ_NEXT(input, i, in1in2, in3in4);
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(next12, chorba67));
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(chorba56, chorba34));
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(chorba23, chorba12));
+        in1in2 = _mm_xor_si128(in1in2, chorba80);
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+
+        /*
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+        */
+
+        /*in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+        in3 ^= next3 ^ a1 ^ chorba8 ^ chorba7 ^ chorba5 ^ chorba4 ^ chorba3;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8 ^ chorba6 ^ chorba5 ^ chorba4;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+        a2_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab2);
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(next34, ab1));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba78, chorba56));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba45, chorba34));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba80, a2_));
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        a4_ = _mm_unpacklo_epi64(next56, ab4);
+        next12 = _mm_xor_si128(_mm_xor_si128(a4_, ab3), cd1);
+        b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+        d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        next12 = _mm_xor_si128(next12, b2c2);
+        next34 = _mm_xor_si128(b4c4, cd3);
+        next34 = _mm_xor_si128(next34, d2_);
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+
+        /*
+        out1 =      a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+        i += 32;
+
+        /* 28-31 */
+        /*
+        in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];
+        in1 ^= next1 ^ chorba7 ^ chorba6 ^ chorba5;
+        in2 ^= next2 ^ chorba8 ^ chorba7 ^ chorba6;
+        */
+        READ_NEXT(input, i, in1in2, in3in4);
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(next12, chorba78));
+        in1in2 = _mm_xor_si128(in1in2, _mm_xor_si128(chorba67, chorba56));
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+
+        /*
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+        */
+
+        /*
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+        in3 ^= next3 ^ a1 ^ chorba8 ^ chorba7;
+        in4 ^= next4 ^ a2 ^ b1 ^ chorba8;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+        a2_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab2);
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(next34, ab1));
+        in3in4 = _mm_xor_si128(in3in4, _mm_xor_si128(chorba78, chorba80));
+        in3in4 = _mm_xor_si128(a2_, in3in4);
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        /*
+        out1 =      a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+        */
+
+        /*
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+
+        a4_ = _mm_unpacklo_epi64(next56, ab4);
+        next12 = _mm_xor_si128(_mm_xor_si128(a4_, ab3), cd1);
+        b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+        d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        next12 = _mm_xor_si128(next12, b2c2);
+        next34 = _mm_xor_si128(b4c4, cd3);
+        next34 = _mm_xor_si128(next34, d2_);
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+    }
+
+    for(; (i + 40 + 32) < len; i += 32) {
+        __m128i in1in2, in3in4;
+
+        /*in1 = input[i / sizeof(uint64_t)];
+        in2 = input[i / sizeof(uint64_t) + 1];*/
+        //READ_NEXT_UNALIGNED(input, i, in1in2, in3in4);
+        READ_NEXT(input, i, in1in2, in3in4);
+        in1in2 = _mm_xor_si128(in1in2, next12);
+
+        /*
+        in1 ^=next1;
+        in2 ^=next2;
+        */
+
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+        /*
+        a1 = (in1 << 17) ^ (in1 << 55);
+        a2 = (in1 >> 47) ^ (in1 >> 9) ^ (in1 << 19);
+        a3 = (in1 >> 45) ^ (in1 << 44);
+        a4 = (in1 >> 20);
+
+        b1 = (in2 << 17) ^ (in2 << 55);
+        b2 = (in2 >> 47) ^ (in2 >> 9) ^ (in2 << 19);
+        b3 = (in2 >> 45) ^ (in2 << 44);
+        b4 = (in2 >> 20);
+        */
+
+        /*
+        in3 = input[i / sizeof(uint64_t) + 2];
+        in4 = input[i / sizeof(uint64_t) + 3];
+        in3 ^= next3 ^ a1;
+        in4 ^= next4 ^ a2 ^ b1;
+
+        c1 = (in3 << 17) ^ (in3 << 55);
+        c2 = (in3 >> 47) ^ (in3 >> 9) ^ (in3 << 19);
+        c3 = (in3 >> 45) ^ (in3 << 44);
+        c4 = (in3 >> 20);
+
+        d1 = (in4 << 17) ^ (in4 << 55);
+        d2 = (in4 >> 47) ^ (in4 >> 9) ^ (in4 << 19);
+        d3 = (in4 >> 45) ^ (in4 << 44);
+        d4 = (in4 >> 20);
+        */
+
+        __m128i a2_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab2);
+        __m128i ab1_next34 = _mm_xor_si128(next34, ab1);
+        in3in4 = _mm_xor_si128(in3in4, ab1_next34);
+        in3in4 = _mm_xor_si128(a2_, in3in4);
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        /*
+
+        out1 = a3 ^ b2 ^ c1;
+        out2 = a4 ^ b3 ^ c2 ^ d1;
+        out3 = b4 ^ c3 ^ d2;
+        out4 = c4 ^ d3;
+        out5 = d4;
+
+        next1 = next5 ^ out1;
+        next2 = out2;
+        next3 = out3;
+        next4 = out4;
+        next5 = out5;
+        */
+
+        __m128i b2c2 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab2), _mm_castsi128_pd(cd2), 1));
+        __m128i a4_ = _mm_unpacklo_epi64(_mm_setzero_si128(), ab4);
+        a4_ = _mm_xor_si128(b2c2, a4_);
+        next12 = _mm_xor_si128(ab3, a4_);
+        next12 = _mm_xor_si128(next12, cd1);
+
+        __m128i d2_ = _mm_unpackhi_epi64(cd2, _mm_setzero_si128());
+        __m128i b4c4 = _mm_castpd_si128(_mm_shuffle_pd(_mm_castsi128_pd(ab4), _mm_castsi128_pd(cd4), 1));
+        next12 = _mm_xor_si128(next12, next56);
+        next34 = _mm_xor_si128(cd3, _mm_xor_si128(b4c4, d2_));
+        next56 = _mm_unpackhi_epi64(cd4, _mm_setzero_si128());
+    }
+
+    next1 = _mm_cvtsi128_si64(next12);
+    next2 = _mm_cvtsi128_si64(_mm_unpackhi_epi64(next12, next12));
+    next3 = _mm_cvtsi128_si64(next34);
+    next4 = _mm_cvtsi128_si64(_mm_unpackhi_epi64(next34, next34));
+    next5 = _mm_cvtsi128_si64(next56);
+
+    /* Skip the call to memcpy */
+    size_t copy_len = len - i;
+    __m128i *final128 = (__m128i*)final;
+    __m128i *input128 = (__m128i*)(input + i/ sizeof(uint64_t));
+    while (copy_len >= 64) {
+        _mm_store_si128(final128++, _mm_load_si128(input128++));
+        _mm_store_si128(final128++, _mm_load_si128(input128++));
+        _mm_store_si128(final128++, _mm_load_si128(input128++));
+        _mm_store_si128(final128++, _mm_load_si128(input128++));
+         copy_len -= 64;
+    }
+
+    while (copy_len >= 16) {
+        _mm_store_si128(final128++, _mm_load_si128(input128++));
+        copy_len -= 16;
+    }
+
+    uint8_t *src_bytes = (uint8_t*)input128;
+    uint8_t *dst_bytes = (uint8_t*)final128;
+    while (copy_len--) {
+       *dst_bytes++ = *src_bytes++;
+    }
+
+    final[0] ^= next1;
+    final[1] ^= next2;
+    final[2] ^= next3;
+    final[3] ^= next4;
+    final[4] ^= next5;
+
+    /* We perform the same loop that braid_internal is doing but we'll skip
+     * the function call for this tiny tail */
+    uint8_t *final_bytes = (uint8_t*)final;
+    size_t rem = len - i;
+
+    while (rem--) {
+        crc = crc_table[(crc ^ *final_bytes++) & 0xff] ^ (crc >> 8);
+    }
+
+    return crc;
+}
+
+Z_INTERNAL uint32_t crc32_chorba_sse2(uint32_t crc, const uint8_t *buf, size_t len) {
+    uint64_t *aligned_buf;
+    uint32_t c = ~crc;
+    uintptr_t align_diff = ALIGN_DIFF(buf, 16);
+
+    if (len > align_diff + CHORBA_SMALL_THRESHOLD_64BIT) {
+        if (align_diff) {
+            c = crc32_braid_internal(c, buf, align_diff);
+            len -= align_diff;
+        }
+        aligned_buf = (uint64_t*)(buf + align_diff);
+#if !defined(WITHOUT_CHORBA)
+        if (len > CHORBA_LARGE_THRESHOLD) {
+            c = crc32_chorba_118960_nondestructive(c, (z_word_t*)aligned_buf, len);
+        } else
+#endif
+        {
+            c = chorba_small_nondestructive_sse2(c, aligned_buf, len);
+        }
+    } else {
+        // Process too short lengths using crc32_braid
+        c = crc32_braid_internal(c, buf, len);
+    }
+
+    /* Return the CRC, post-conditioned. */
+    return ~c;
+}
+
+Z_INTERNAL uint32_t crc32_copy_chorba_sse2(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_chorba_sse2(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
+#endif
diff --git a/arch/x86/chorba_sse41.c b/arch/x86/chorba_sse41.c
new file mode 100644
index 00000000..aa1c7a27
--- /dev/null
+++ b/arch/x86/chorba_sse41.c
@@ -0,0 +1,342 @@
+#if defined(X86_SSE41) && !defined(WITHOUT_CHORBA_SSE)
+
+#include "zbuild.h"
+#include "crc32_braid_p.h"
+#include "crc32_braid_tbl.h"
+#include "crc32.h"
+#include <emmintrin.h>
+#include <smmintrin.h>
+#include "arch/x86/x86_intrins.h"
+#include "arch_functions.h"
+
+#define READ_NEXT(in, off, a, b) do { \
+        a = _mm_load_si128((__m128i*)(in + off / sizeof(uint64_t))); \
+        b = _mm_load_si128((__m128i*)(in + off / sizeof(uint64_t) + 2)); \
+        } while (0);
+
+#define NEXT_ROUND(invec, a, b, c, d) do { \
+        a = _mm_xor_si128(_mm_slli_epi64(invec, 17), _mm_slli_epi64(invec, 55)); \
+        b = _mm_xor_si128(_mm_xor_si128(_mm_srli_epi64(invec, 47), _mm_srli_epi64(invec, 9)), _mm_slli_epi64(invec, 19)); \
+        c = _mm_xor_si128(_mm_srli_epi64(invec, 45), _mm_slli_epi64(invec, 44)); \
+        d  = _mm_srli_epi64(invec, 20); \
+        } while (0);
+
+#define REALIGN_CHORBA(in0, in1, in2, in3, out0, out1, out2, out3, out4, shift) do { \
+        out0 = _mm_slli_si128(in0, shift); \
+        out1 = _mm_alignr_epi8(in1, in0, shift); \
+        out2 = _mm_alignr_epi8(in2, in1, shift); \
+        out3 = _mm_alignr_epi8(in3, in2, shift); \
+        out4 = _mm_srli_si128(in3, shift); \
+        } while (0)
+
+#define STORE4(out0, out1, out2, out3, out) do { \
+        _mm_store_si128(out++, out0); \
+        _mm_store_si128(out++, out1); \
+        _mm_store_si128(out++, out2); \
+        _mm_store_si128(out++, out3); \
+    } while (0)
+
+#define READ4(out0, out1, out2, out3, in) do { \
+    out0 = _mm_load_si128(in++); \
+    out1 = _mm_load_si128(in++); \
+    out2 = _mm_load_si128(in++); \
+    out3 = _mm_load_si128(in++); \
+    } while (0)
+
+/* This is intentionally shifted one down to compensate for the deferred store from
+ * the last iteration */
+#define READ4_WITHXOR(out0, out1, out2, out3, xor0, xor1, xor2, xor3, in) do { \
+    out0 = _mm_xor_si128(in[1], xor0); \
+    out1 = _mm_xor_si128(in[2], xor1); \
+    out2 = _mm_xor_si128(in[3], xor2); \
+    out3 = _mm_xor_si128(in[4], xor3); \
+    } while (0)
+
+Z_FORCEINLINE static uint32_t crc32_chorba_32768_nondestructive_sse41(uint32_t crc, const uint64_t* buf, size_t len) {
+    const uint64_t* input = buf;
+    ALIGNED_(16) uint64_t bitbuffer[32768 / sizeof(uint64_t)];
+    __m128i *bitbuffer_v = (__m128i*)bitbuffer;
+    const uint8_t* bitbufferbytes = (const uint8_t*) bitbuffer;
+    __m128i z = _mm_setzero_si128();
+
+    __m128i *bitbuf128 = &bitbuffer_v[64];
+    __m128i *bitbuf144 = &bitbuffer_v[72];
+    __m128i *bitbuf182 = &bitbuffer_v[91];
+    __m128i *bitbuf210 = &bitbuffer_v[105];
+    __m128i *bitbuf300 = &bitbuffer_v[150];
+    __m128i *bitbuf0 = bitbuf128;
+    __m128i *inptr = (__m128i*)input;
+
+    /* We only need to zero out the bytes between the 128'th value and the 144th
+     * that are actually read */
+    __m128i *z_cursor = bitbuf128;
+    for (size_t i = 0; i < 2; ++i) {
+        STORE4(z, z, z, z, z_cursor);
+    }
+
+    /* We only need to zero out the bytes between the 144'th value and the 182nd that
+     * are actually read */
+    z_cursor = bitbuf144 + 8;
+    for (size_t i = 0; i < 11; ++i) {
+        _mm_store_si128(z_cursor++, z);
+    }
+
+    /* We only need to zero out the bytes between the 182nd value and the 210th that
+     * are actually read. */
+    z_cursor = bitbuf182;
+    for (size_t i = 0; i < 4; ++i) {
+        STORE4(z, z, z, z, z_cursor);
+    }
+
+    /* We need to mix this in */
+    __m128i init_crc = _mm_cvtsi64_si128(crc);
+    crc = 0;
+
+    size_t i = 0;
+
+    /* Previous iteration runs carried over */
+    __m128i buf144 = z;
+    __m128i buf182 = z;
+    __m128i buf210 = z;
+
+    for(; i + 300*8+64 < len && i < 22 * 8; i += 64) {
+        __m128i in12, in34, in56, in78,
+                in_1, in23, in45, in67, in8_;
+
+        READ4(in12, in34, in56, in78, inptr);
+
+        if (i == 0) {
+            in12 = _mm_xor_si128(in12, init_crc);
+        }
+
+        REALIGN_CHORBA(in12, in34, in56, in78,
+                       in_1, in23, in45, in67, in8_, 8);
+
+        __m128i a = _mm_xor_si128(buf144, in_1);
+
+        STORE4(a, in23, in45, in67, bitbuf144);
+        buf144 = in8_;
+
+        __m128i e = _mm_xor_si128(buf182, in_1);
+        STORE4(e, in23, in45, in67, bitbuf182);
+        buf182 = in8_;
+
+        __m128i m = _mm_xor_si128(buf210, in_1);
+        STORE4(m, in23, in45, in67, bitbuf210);
+        buf210 = in8_;
+
+        STORE4(in12, in34, in56, in78, bitbuf300);
+    }
+
+    for(; i + 300*8+64 < len && i < 32 * 8; i += 64) {
+        __m128i in12, in34, in56, in78,
+                in_1, in23, in45, in67, in8_;
+        READ4(in12, in34, in56, in78, inptr);
+
+        REALIGN_CHORBA(in12, in34, in56, in78,
+                       in_1, in23, in45, in67, in8_, 8);
+
+        __m128i a = _mm_xor_si128(buf144, in_1);
+
+        STORE4(a, in23, in45, in67, bitbuf144);
+        buf144 = in8_;
+
+        __m128i e, f, g, h;
+        e = _mm_xor_si128(buf182, in_1);
+        READ4_WITHXOR(f, g, h, buf182, in23, in45, in67, in8_, bitbuf182);
+        STORE4(e, f, g, h, bitbuf182);
+
+        __m128i m = _mm_xor_si128(buf210, in_1);
+        STORE4(m, in23, in45, in67, bitbuf210);
+        buf210 = in8_;
+
+        STORE4(in12, in34, in56, in78, bitbuf300);
+    }
+
+    for(; i + 300*8+64 < len && i < 84 * 8; i += 64) {
+        __m128i in12, in34, in56, in78,
+                in_1, in23, in45, in67, in8_;
+        READ4(in12, in34, in56, in78, inptr);
+
+        REALIGN_CHORBA(in12, in34, in56, in78,
+                       in_1, in23, in45, in67, in8_, 8);
+
+        __m128i a, b, c, d;
+        a = _mm_xor_si128(buf144, in_1);
+        READ4_WITHXOR(b, c, d, buf144, in23, in45, in67, in8_, bitbuf144);
+        STORE4(a, b, c, d, bitbuf144);
+
+        __m128i e, f, g, h;
+        e = _mm_xor_si128(buf182, in_1);
+        READ4_WITHXOR(f, g, h, buf182, in23, in45, in67, in8_, bitbuf182);
+        STORE4(e, f, g, h, bitbuf182);
+
+        __m128i m = _mm_xor_si128(buf210, in_1);
+        STORE4(m, in23, in45, in67, bitbuf210);
+        buf210 = in8_;
+
+        STORE4(in12, in34, in56, in78, bitbuf300);
+    }
+
+    for(; i + 300*8+64 < len; i += 64) {
+        __m128i in12, in34, in56, in78,
+                in_1, in23, in45, in67, in8_;
+
+        if (i < 128 * 8) {
+            READ4(in12, in34, in56, in78, inptr);
+        } else {
+            in12 = _mm_xor_si128(_mm_load_si128(inptr++), _mm_load_si128(bitbuf0++));
+            in34 = _mm_xor_si128(_mm_load_si128(inptr++), _mm_load_si128(bitbuf0++));
+            in56 = _mm_xor_si128(_mm_load_si128(inptr++), _mm_load_si128(bitbuf0++));
+            in78 = _mm_xor_si128(_mm_load_si128(inptr++), _mm_load_si128(bitbuf0++));
+        }
+
+        // [0, 145, 183, 211]
+
+        /* Pre Penryn CPUs the unpack should be faster */
+        REALIGN_CHORBA(in12, in34, in56, in78,
+                       in_1, in23, in45, in67, in8_, 8);
+
+        __m128i a, b, c, d;
+        a = _mm_xor_si128(buf144, in_1);
+        READ4_WITHXOR(b, c, d, buf144, in23, in45, in67, in8_, bitbuf144);
+        STORE4(a, b, c, d, bitbuf144);
+
+        __m128i e, f, g, h;
+        e = _mm_xor_si128(buf182, in_1);
+        READ4_WITHXOR(f, g, h, buf182, in23, in45, in67, in8_, bitbuf182);
+        STORE4(e, f, g, h, bitbuf182);
+
+        __m128i n, o, p;
+        __m128i m = _mm_xor_si128(buf210, in_1);
+
+        /* Couldn't tell you why but despite knowing that this is always false,
+         * removing this branch with GCC makes things significantly slower. Some
+         * loop bodies must be being joined or something */
+        if (i < 84 * 8) {
+            n = in23;
+            o = in45;
+            p = in67;
+            buf210 = in8_;
+        } else {
+            READ4_WITHXOR(n, o, p, buf210, in23, in45, in67, in8_, bitbuf210);
+        }
+
+        STORE4(m, n, o, p, bitbuf210);
+        STORE4(in12, in34, in56, in78, bitbuf300);
+    }
+
+    /* Second half of stores bubbled out */
+    _mm_store_si128(bitbuf144, buf144);
+    _mm_store_si128(bitbuf182, buf182);
+    _mm_store_si128(bitbuf210, buf210);
+
+    /* We also have to zero out the tail */
+    size_t left_to_z = len - (300*8 + i);
+    __m128i *bitbuf_tail = (__m128i*)(bitbuffer + 300 + i/8);
+    while (left_to_z >= 64) {
+       STORE4(z, z, z, z, bitbuf_tail);
+       left_to_z -= 64;
+    }
+
+    while (left_to_z >= 16) {
+       _mm_store_si128(bitbuf_tail++, z);
+       left_to_z -= 16;
+    }
+
+    uint8_t *tail_bytes = (uint8_t*)bitbuf_tail;
+    while (left_to_z--) {
+       *tail_bytes++ = 0;
+    }
+
+    ALIGNED_(16) uint64_t final[9] = {0};
+    __m128i next12, next34, next56;
+    next12 = z;
+    next34 = z;
+    next56 = z;
+
+    for(; (i + 72 < len); i += 32) {
+        __m128i in1in2, in3in4;
+        __m128i in1in2_, in3in4_;
+        __m128i ab1, ab2, ab3, ab4;
+        __m128i cd1, cd2, cd3, cd4;
+
+        READ_NEXT(input, i, in1in2, in3in4);
+        READ_NEXT(bitbuffer, i, in1in2_, in3in4_);
+
+        in1in2 = _mm_xor_si128(_mm_xor_si128(in1in2, in1in2_), next12);
+        in3in4 = _mm_xor_si128(in3in4, in3in4_);
+
+        NEXT_ROUND(in1in2, ab1, ab2, ab3, ab4);
+
+        __m128i a2_ = _mm_slli_si128(ab2, 8);
+        __m128i ab1_next34 = _mm_xor_si128(next34, ab1);
+        in3in4 = _mm_xor_si128(in3in4, ab1_next34);
+        in3in4 = _mm_xor_si128(a2_, in3in4);
+        NEXT_ROUND(in3in4, cd1, cd2, cd3, cd4);
+
+        __m128i b2c2 = _mm_alignr_epi8(cd2, ab2, 8);
+        __m128i a4_ = _mm_slli_si128(ab4, 8);
+        a4_ = _mm_xor_si128(b2c2, a4_);
+        next12 = _mm_xor_si128(ab3, a4_);
+        next12 = _mm_xor_si128(next12, cd1);
+
+        __m128i d2_ = _mm_srli_si128(cd2, 8);
+        __m128i b4c4 = _mm_alignr_epi8(cd4, ab4, 8);
+        next12 = _mm_xor_si128(next12, next56);
+        next34 = _mm_xor_si128(cd3, _mm_xor_si128(b4c4, d2_));
+        next56 = _mm_srli_si128(cd4, 8);
+    }
+
+    memcpy(final, input+(i / sizeof(uint64_t)), len-i);
+    __m128i *final128 = (__m128i*)final;
+    _mm_store_si128(final128, _mm_xor_si128(_mm_load_si128(final128), next12));
+    ++final128;
+    _mm_store_si128(final128, _mm_xor_si128(_mm_load_si128(final128), next34));
+    ++final128;
+    _mm_store_si128(final128, _mm_xor_si128(_mm_load_si128(final128), next56));
+
+    uint8_t* final_bytes = (uint8_t*) final;
+
+    for(size_t j = 0; j < (len-i); j++) {
+        crc = crc_table[(crc ^ final_bytes[j] ^ bitbufferbytes[(j+i)]) & 0xff] ^ (crc >> 8);
+    }
+    return crc;
+}
+
+Z_INTERNAL uint32_t crc32_chorba_sse41(uint32_t crc, const uint8_t *buf, size_t len) {
+    uint64_t *aligned_buf;
+    uint32_t c = ~crc;
+    uintptr_t align_diff = ALIGN_DIFF(buf, 16);
+
+    if (len > align_diff + CHORBA_SMALL_THRESHOLD_64BIT) {
+        if (align_diff) {
+            c = crc32_braid_internal(c, buf, align_diff);
+            len -= align_diff;
+        }
+        aligned_buf = (uint64_t*)(buf + align_diff);
+#if !defined(WITHOUT_CHORBA)
+        if (len > CHORBA_LARGE_THRESHOLD) {
+            c = crc32_chorba_118960_nondestructive(c, (z_word_t*)aligned_buf, len);
+        } else
+#endif
+        if (len > CHORBA_MEDIUM_LOWER_THRESHOLD && len <= CHORBA_MEDIUM_UPPER_THRESHOLD) {
+            c = crc32_chorba_32768_nondestructive_sse41(c, aligned_buf, len);
+        } else {
+            c = chorba_small_nondestructive_sse2(c, aligned_buf, len);
+        }
+    } else {
+        // Process too short lengths using crc32_braid
+        c = crc32_braid_internal(c, buf, len);
+    }
+
+    /* Return the CRC, post-conditioned. */
+    return ~c;
+}
+
+Z_INTERNAL uint32_t crc32_copy_chorba_sse41(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    crc = crc32_chorba_sse41(crc, src, len);
+    memcpy(dst, src, len);
+    return crc;
+}
+#endif
diff --git a/arch/x86/chunkset_avx2.c b/arch/x86/chunkset_avx2.c
index 70620b91..7e3ffc2c 100644
--- a/arch/x86/chunkset_avx2.c
+++ b/arch/x86/chunkset_avx2.c
@@ -2,70 +2,43 @@
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 #include "zbuild.h"
+#include "zmemory.h"
 
 #ifdef X86_AVX2
+#include "arch/generic/chunk_256bit_perm_idx_lut.h"
 #include <immintrin.h>
-#include "../generic/chunk_permute_table.h"
+#include "x86_intrins.h"
 
 typedef __m256i chunk_t;
-
-#define CHUNK_SIZE 32
+typedef __m128i halfchunk_t;
 
 #define HAVE_CHUNKMEMSET_2
 #define HAVE_CHUNKMEMSET_4
 #define HAVE_CHUNKMEMSET_8
+#define HAVE_CHUNKMEMSET_16
 #define HAVE_CHUNK_MAG
-
-/* Populate don't cares so that this is a direct lookup (with some indirection into the permute table), because dist can
- * never be 0 - 2, we'll start with an offset, subtracting 3 from the input */
-static const lut_rem_pair perm_idx_lut[29] = {
-    { 0, 2},                /* 3 */
-    { 0, 0},                /* don't care */
-    { 1 * 32, 2},           /* 5 */
-    { 2 * 32, 2},           /* 6 */
-    { 3 * 32, 4},           /* 7 */
-    { 0 * 32, 0},           /* don't care */
-    { 4 * 32, 5},           /* 9 */
-    { 5 * 32, 22},          /* 10 */
-    { 6 * 32, 21},          /* 11 */
-    { 7 * 32, 20},          /* 12 */
-    { 8 * 32, 6},           /* 13 */
-    { 9 * 32, 4},           /* 14 */
-    {10 * 32, 2},           /* 15 */
-    { 0 * 32, 0},           /* don't care */
-    {11 * 32, 15},          /* 17 */
-    {11 * 32 + 16, 14},     /* 18 */
-    {11 * 32 + 16 * 2, 13}, /* 19 */
-    {11 * 32 + 16 * 3, 12}, /* 20 */
-    {11 * 32 + 16 * 4, 11}, /* 21 */
-    {11 * 32 + 16 * 5, 10}, /* 22 */
-    {11 * 32 + 16 * 6,  9}, /* 23 */
-    {11 * 32 + 16 * 7,  8}, /* 24 */
-    {11 * 32 + 16 * 8,  7}, /* 25 */
-    {11 * 32 + 16 * 9,  6}, /* 26 */
-    {11 * 32 + 16 * 10, 5}, /* 27 */
-    {11 * 32 + 16 * 11, 4}, /* 28 */
-    {11 * 32 + 16 * 12, 3}, /* 29 */
-    {11 * 32 + 16 * 13, 2}, /* 30 */
-    {11 * 32 + 16 * 14, 1}  /* 31 */
-};
+#define HAVE_HALF_CHUNK
 
 static inline void chunkmemset_2(uint8_t *from, chunk_t *chunk) {
-    int16_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm256_set1_epi16(tmp);
+    *chunk = _mm256_set1_epi16(zng_memread_2(from));
 }
 
 static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
-    int32_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm256_set1_epi32(tmp);
+    *chunk = _mm256_set1_epi32(zng_memread_4(from));
 }
 
 static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
-    int64_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm256_set1_epi64x(tmp);
+    *chunk = _mm256_set1_epi64x(zng_memread_8(from));
+}
+
+static inline void chunkmemset_16(uint8_t *from, chunk_t *chunk) {
+    /* See explanation in chunkset_avx512.c */
+#if defined(_MSC_VER) && _MSC_VER <= 1900
+    halfchunk_t half = _mm_loadu_si128((__m128i*)from);
+    *chunk = _mm256_inserti128_si256(_mm256_castsi128_si256(half), half, 1);
+#else
+    *chunk = _mm256_broadcastsi128_si256(_mm_loadu_si128((__m128i*)from));
+#endif
 }
 
 static inline void loadchunk(uint8_t const *s, chunk_t *chunk) {
@@ -91,18 +64,11 @@ static inline chunk_t GET_CHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t
         /* This simpler case still requires us to shuffle in 128 bit lanes, so we must apply a static offset after
          * broadcasting the first vector register to both halves. This is _marginally_ faster than doing two separate
          * shuffles and combining the halves later */
-        const __m256i permute_xform =
-            _mm256_setr_epi8(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
-                             16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16);
         __m256i perm_vec = _mm256_load_si256((__m256i*)(permute_table+lut_rem.idx));
         __m128i ret_vec0 = _mm_loadu_si128((__m128i*)buf);
-        perm_vec = _mm256_add_epi8(perm_vec, permute_xform);
         ret_vec = _mm256_inserti128_si256(_mm256_castsi128_si256(ret_vec0), ret_vec0, 1);
         ret_vec = _mm256_shuffle_epi8(ret_vec, perm_vec);
-    } else if (dist == 16) {
-        __m128i ret_vec0 = _mm_loadu_si128((__m128i*)buf);
-        return _mm256_inserti128_si256(_mm256_castsi128_si256(ret_vec0), ret_vec0, 1);
-    } else {
+    }  else {
         __m128i ret_vec0 = _mm_loadu_si128((__m128i*)buf);
         __m128i ret_vec1 = _mm_loadu_si128((__m128i*)(buf + 16));
         /* Take advantage of the fact that only the latter half of the 256 bit vector will actually differ */
@@ -118,6 +84,33 @@ static inline chunk_t GET_CHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t
     return ret_vec;
 }
 
+static inline void loadhalfchunk(uint8_t const *s, halfchunk_t *chunk) {
+    *chunk = _mm_loadu_si128((__m128i *)s);
+}
+
+static inline void storehalfchunk(uint8_t *out, halfchunk_t *chunk) {
+    _mm_storeu_si128((__m128i *)out, *chunk);
+}
+
+static inline chunk_t halfchunk2whole(halfchunk_t *chunk) {
+    /* We zero extend mostly to appease some memory sanitizers. These bytes are ultimately
+     * unlikely to be actually written or read from */
+    return _mm256_zextsi128_si256(*chunk);
+}
+
+static inline halfchunk_t GET_HALFCHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t dist) {
+    lut_rem_pair lut_rem = perm_idx_lut[dist - 3];
+    __m128i perm_vec, ret_vec;
+    __msan_unpoison(buf + dist, 16 - dist);
+    ret_vec = _mm_loadu_si128((__m128i*)buf);
+    *chunk_rem = half_rem_vals[dist - 3];
+
+    perm_vec = _mm_load_si128((__m128i*)(permute_table + lut_rem.idx));
+    ret_vec = _mm_shuffle_epi8(ret_vec, perm_vec);
+
+    return ret_vec;
+}
+
 #define CHUNKSIZE        chunksize_avx2
 #define CHUNKCOPY        chunkcopy_avx2
 #define CHUNKUNROLL      chunkunroll_avx2
diff --git a/arch/x86/chunkset_avx512.c b/arch/x86/chunkset_avx512.c
new file mode 100644
index 00000000..3c46b4bf
--- /dev/null
+++ b/arch/x86/chunkset_avx512.c
@@ -0,0 +1,185 @@
+/* chunkset_avx512.c -- AVX512 inline functions to copy small data chunks.
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+#include "zbuild.h"
+#include "zmemory.h"
+
+#ifdef X86_AVX512
+
+#include "arch/generic/chunk_256bit_perm_idx_lut.h"
+#include <immintrin.h>
+#include "x86_intrins.h"
+
+typedef __m256i chunk_t;
+typedef __m128i halfchunk_t;
+typedef __mmask32 mask_t;
+typedef __mmask16 halfmask_t;
+
+#define HAVE_CHUNKMEMSET_2
+#define HAVE_CHUNKMEMSET_4
+#define HAVE_CHUNKMEMSET_8
+#define HAVE_CHUNKMEMSET_16
+#define HAVE_CHUNK_MAG
+#define HAVE_HALF_CHUNK
+#define HAVE_MASKED_READWRITE
+#define HAVE_CHUNKCOPY
+#define HAVE_HALFCHUNKCOPY
+
+static inline halfmask_t gen_half_mask(unsigned len) {
+   return (halfmask_t)_bzhi_u32(0xFFFF, len);
+}
+
+static inline mask_t gen_mask(unsigned len) {
+   return (mask_t)_bzhi_u32(0xFFFFFFFF, len);
+}
+
+static inline void chunkmemset_2(uint8_t *from, chunk_t *chunk) {
+    *chunk = _mm256_set1_epi16(zng_memread_2(from));
+}
+
+static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
+    *chunk = _mm256_set1_epi32(zng_memread_4(from));
+}
+
+static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
+    *chunk = _mm256_set1_epi64x(zng_memread_8(from));
+}
+
+static inline void chunkmemset_16(uint8_t *from, chunk_t *chunk) {
+    /* Unfortunately there seems to be a compiler bug in Visual Studio 2015 where
+     * the load is dumped to the stack with an aligned move for this memory-register
+     * broadcast. The vbroadcasti128 instruction is 2 fewer cycles and this dump to
+     * stack doesn't exist if compiled with optimizations. For the sake of working
+     * properly in a debugger, let's take the 2 cycle penalty */
+#if defined(_MSC_VER) && _MSC_VER <= 1900
+    halfchunk_t half = _mm_loadu_si128((__m128i*)from);
+    *chunk = _mm256_inserti128_si256(_mm256_castsi128_si256(half), half, 1);
+#else
+    *chunk = _mm256_broadcastsi128_si256(_mm_loadu_si128((__m128i*)from));
+#endif
+}
+
+static inline void loadchunk(uint8_t const *s, chunk_t *chunk) {
+    *chunk = _mm256_loadu_si256((__m256i *)s);
+}
+
+static inline void storechunk(uint8_t *out, chunk_t *chunk) {
+    _mm256_storeu_si256((__m256i *)out, *chunk);
+}
+
+static inline uint8_t* CHUNKCOPY(uint8_t *out, uint8_t const *from, unsigned len) {
+    Assert(len > 0, "chunkcopy should never have a length 0");
+
+    chunk_t chunk;
+    uint32_t rem = len % sizeof(chunk_t);
+
+    if (len < sizeof(chunk_t)) {
+        mask_t rem_mask = gen_mask(rem);
+        chunk = _mm256_maskz_loadu_epi8(rem_mask, from);
+        _mm256_mask_storeu_epi8(out, rem_mask, chunk);
+        return out + rem;
+    }
+
+    loadchunk(from, &chunk);
+    rem = (rem == 0) ? sizeof(chunk_t) : rem;
+    storechunk(out, &chunk);
+    out += rem;
+    from += rem;
+    len -= rem;
+
+    while (len > 0) {
+        loadchunk(from, &chunk);
+        storechunk(out, &chunk);
+        out += sizeof(chunk_t);
+        from += sizeof(chunk_t);
+        len -= sizeof(chunk_t);
+    }
+
+    return out;
+}
+
+/* MSVC compiler decompression bug when optimizing for size */
+#if defined(_MSC_VER) && _MSC_VER < 1943
+#  pragma optimize("", off)
+#endif
+static inline chunk_t GET_CHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t dist) {
+    lut_rem_pair lut_rem = perm_idx_lut[dist - 3];
+    __m256i ret_vec;
+    *chunk_rem = lut_rem.remval;
+
+    /* See the AVX2 implementation for more detailed comments. This is that + some masked
+     * loads to avoid an out of bounds read on the heap */
+
+    if (dist < 16) {
+        __m256i perm_vec = _mm256_load_si256((__m256i*)(permute_table+lut_rem.idx));
+        halfmask_t load_mask = gen_half_mask(dist);
+        __m128i ret_vec0 = _mm_maskz_loadu_epi8(load_mask, buf);
+        ret_vec = _mm256_inserti128_si256(_mm256_castsi128_si256(ret_vec0), ret_vec0, 1);
+        ret_vec = _mm256_shuffle_epi8(ret_vec, perm_vec);
+    }  else {
+        halfmask_t load_mask = gen_half_mask(dist - 16);
+        __m128i ret_vec0 = _mm_loadu_si128((__m128i*)buf);
+        __m128i ret_vec1 = _mm_maskz_loadu_epi8(load_mask, (__m128i*)(buf + 16));
+        __m128i perm_vec1 = _mm_load_si128((__m128i*)(permute_table + lut_rem.idx));
+        halfmask_t xlane_mask = _mm_cmp_epi8_mask(perm_vec1, _mm_set1_epi8(15), _MM_CMPINT_LE);
+        __m128i latter_half = _mm_mask_shuffle_epi8(ret_vec1, xlane_mask, ret_vec0, perm_vec1);
+        ret_vec = _mm256_inserti128_si256(_mm256_castsi128_si256(ret_vec0), latter_half, 1);
+    }
+
+    return ret_vec;
+}
+#if defined(_MSC_VER) && _MSC_VER < 1943
+#  pragma optimize("", on)
+#endif
+
+static inline void storehalfchunk(uint8_t *out, halfchunk_t *chunk) {
+    _mm_storeu_si128((__m128i *)out, *chunk);
+}
+
+static inline chunk_t halfchunk2whole(halfchunk_t *chunk) {
+    /* We zero extend mostly to appease some memory sanitizers. These bytes are ultimately
+     * unlikely to be actually written or read from */
+    return _mm256_zextsi128_si256(*chunk);
+}
+
+static inline halfchunk_t GET_HALFCHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t dist) {
+    lut_rem_pair lut_rem = perm_idx_lut[dist - 3];
+    __m128i perm_vec, ret_vec;
+    halfmask_t load_mask = gen_half_mask(dist);
+    ret_vec = _mm_maskz_loadu_epi8(load_mask, buf);
+    *chunk_rem = half_rem_vals[dist - 3];
+
+    perm_vec = _mm_load_si128((__m128i*)(permute_table + lut_rem.idx));
+    ret_vec = _mm_shuffle_epi8(ret_vec, perm_vec);
+
+    return ret_vec;
+}
+
+static inline uint8_t* HALFCHUNKCOPY(uint8_t *out, uint8_t const *from, unsigned len) {
+    Assert(len > 0, "chunkcopy should never have a length 0");
+    halfchunk_t chunk;
+
+    uint32_t rem = len % sizeof(halfchunk_t);
+    if (rem == 0) {
+        rem = sizeof(halfchunk_t);
+    }
+
+    halfmask_t rem_mask = gen_half_mask(rem);
+    chunk = _mm_maskz_loadu_epi8(rem_mask, from);
+    _mm_mask_storeu_epi8(out, rem_mask, chunk);
+
+    return out + rem;
+}
+
+#define CHUNKSIZE        chunksize_avx512
+#define CHUNKUNROLL      chunkunroll_avx512
+#define CHUNKMEMSET      chunkmemset_avx512
+#define CHUNKMEMSET_SAFE chunkmemset_safe_avx512
+
+#include "chunkset_tpl.h"
+
+#define INFLATE_FAST     inflate_fast_avx512
+
+#include "inffast_tpl.h"
+
+#endif
diff --git a/arch/x86/chunkset_sse2.c b/arch/x86/chunkset_sse2.c
index c402c0ee..dcfe2c70 100644
--- a/arch/x86/chunkset_sse2.c
+++ b/arch/x86/chunkset_sse2.c
@@ -3,34 +3,27 @@
  */
 
 #include "zbuild.h"
+#include "zmemory.h"
 
 #ifdef X86_SSE2
 #include <immintrin.h>
 
 typedef __m128i chunk_t;
 
-#define CHUNK_SIZE 16
-
 #define HAVE_CHUNKMEMSET_2
 #define HAVE_CHUNKMEMSET_4
 #define HAVE_CHUNKMEMSET_8
 
 static inline void chunkmemset_2(uint8_t *from, chunk_t *chunk) {
-    int16_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm_set1_epi16(tmp);
+    *chunk = _mm_set1_epi16(zng_memread_2(from));
 }
 
 static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
-    int32_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm_set1_epi32(tmp);
+    *chunk = _mm_set1_epi32(zng_memread_4(from));
 }
 
 static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
-    int64_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm_set1_epi64x(tmp);
+    *chunk = _mm_set1_epi64x(zng_memread_8(from));
 }
 
 static inline void loadchunk(uint8_t const *s, chunk_t *chunk) {
diff --git a/arch/x86/chunkset_ssse3.c b/arch/x86/chunkset_ssse3.c
index 722ecd3d..7778e525 100644
--- a/arch/x86/chunkset_ssse3.c
+++ b/arch/x86/chunkset_ssse3.c
@@ -3,53 +3,30 @@
  */
 
 #include "zbuild.h"
+#include "zmemory.h"
 
 #if defined(X86_SSSE3)
 #include <immintrin.h>
-#include "../generic/chunk_permute_table.h"
+#include "arch/generic/chunk_128bit_perm_idx_lut.h"
 
 typedef __m128i chunk_t;
 
-#define CHUNK_SIZE 16
-
 #define HAVE_CHUNKMEMSET_2
 #define HAVE_CHUNKMEMSET_4
 #define HAVE_CHUNKMEMSET_8
 #define HAVE_CHUNK_MAG
 
-static const lut_rem_pair perm_idx_lut[13] = {
-    {0, 1},      /* 3 */
-    {0, 0},      /* don't care */
-    {1 * 32, 1}, /* 5 */
-    {2 * 32, 4}, /* 6 */
-    {3 * 32, 2}, /* 7 */
-    {0 * 32, 0}, /* don't care */
-    {4 * 32, 7}, /* 9 */
-    {5 * 32, 6}, /* 10 */
-    {6 * 32, 5}, /* 11 */
-    {7 * 32, 4}, /* 12 */
-    {8 * 32, 3}, /* 13 */
-    {9 * 32, 2}, /* 14 */
-    {10 * 32, 1},/* 15 */
-};
-
 
 static inline void chunkmemset_2(uint8_t *from, chunk_t *chunk) {
-    int16_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm_set1_epi16(tmp);
+    *chunk = _mm_set1_epi16(zng_memread_2(from));
 }
 
 static inline void chunkmemset_4(uint8_t *from, chunk_t *chunk) {
-    int32_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm_set1_epi32(tmp);
+    *chunk = _mm_set1_epi32(zng_memread_4(from));
 }
 
 static inline void chunkmemset_8(uint8_t *from, chunk_t *chunk) {
-    int64_t tmp;
-    memcpy(&tmp, from, sizeof(tmp));
-    *chunk = _mm_set1_epi64x(tmp);
+    *chunk = _mm_set1_epi64x(zng_memread_8(from));
 }
 
 static inline void loadchunk(uint8_t const *s, chunk_t *chunk) {
diff --git a/arch/x86/compare256_avx2.c b/arch/x86/compare256_avx2.c
index d2c835e4..8a0213c3 100644
--- a/arch/x86/compare256_avx2.c
+++ b/arch/x86/compare256_avx2.c
@@ -4,7 +4,7 @@
  */
 
 #include "zbuild.h"
-#include "zutil_p.h"
+#include "zmemory.h"
 #include "deflate.h"
 #include "fallback_builtins.h"
 
diff --git a/arch/x86/compare256_avx512.c b/arch/x86/compare256_avx512.c
new file mode 100644
index 00000000..a1ebe0e5
--- /dev/null
+++ b/arch/x86/compare256_avx512.c
@@ -0,0 +1,97 @@
+/* compare256_avx512.c -- AVX512 version of compare256
+ * Copyright (C) 2025 Hans Kristian Rosbach
+ * Based on AVX2 implementation by Mika T. Lindqvist
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include "zbuild.h"
+#include "zmemory.h"
+#include "deflate.h"
+#include "fallback_builtins.h"
+
+#if defined(X86_AVX512) && defined(HAVE_BUILTIN_CTZLL)
+
+#include <immintrin.h>
+#ifdef _MSC_VER
+#  include <nmmintrin.h>
+#endif
+
+static inline uint32_t compare256_avx512_static(const uint8_t *src0, const uint8_t *src1) {
+    __m512i zmm_src0_4, zmm_src1_4;
+    __m512i zmm_src0_3, zmm_src1_3;
+    __m512i zmm_src0_2, zmm_src1_2;
+    __m512i zmm_src0_1, zmm_src1_1;
+    __m128i xmm_src0_0, xmm_src1_0;
+    uint64_t mask_1, mask_2, mask_3, mask_4;
+    uint32_t mask_0;
+
+    // First do a 16byte round before increasing to 64bytes, this reduces the
+    // penalty for the short matches, and those are usually the most common ones.
+    // This requires us to overlap on the last round, giving a small penalty
+    // on matches of 192+ bytes (Still faster than AVX2 though).
+
+    // 16 bytes
+    xmm_src0_0 = _mm_loadu_si128((__m128i*)src0);
+    xmm_src1_0 = _mm_loadu_si128((__m128i*)src1);
+    mask_0 = (uint32_t)_mm_cmpeq_epu8_mask(xmm_src0_0, xmm_src1_0); // zero-extended to use __builtin_ctz
+    if (mask_0 != 0x0000FFFF) {
+        // There is potential for using __builtin_ctzg/__builtin_ctzs/_tzcnt_u16/__tzcnt_u16 here
+        uint32_t match_byte = (uint32_t)__builtin_ctz(~mask_0); /* Invert bits so identical = 0 */
+        return match_byte;
+    }
+
+    // 64 bytes
+    zmm_src0_1 = _mm512_loadu_si512((__m512i*)(src0 + 16));
+    zmm_src1_1 = _mm512_loadu_si512((__m512i*)(src1 + 16));
+    mask_1 = _mm512_cmpeq_epu8_mask(zmm_src0_1, zmm_src1_1);
+    if (mask_1 != 0xFFFFFFFFFFFFFFFF) {
+        uint32_t match_byte = (uint32_t)__builtin_ctzll(~mask_1);
+        return 16 + match_byte;
+    }
+
+    // 64 bytes
+    zmm_src0_2 = _mm512_loadu_si512((__m512i*)(src0 + 80));
+    zmm_src1_2 = _mm512_loadu_si512((__m512i*)(src1 + 80));
+    mask_2 = _mm512_cmpeq_epu8_mask(zmm_src0_2, zmm_src1_2);
+    if (mask_2 != 0xFFFFFFFFFFFFFFFF) {
+        uint32_t match_byte = (uint32_t)__builtin_ctzll(~mask_2);
+        return 80 + match_byte;
+    }
+
+    // 64 bytes
+    zmm_src0_3 = _mm512_loadu_si512((__m512i*)(src0 + 144));
+    zmm_src1_3 = _mm512_loadu_si512((__m512i*)(src1 + 144));
+    mask_3 = _mm512_cmpeq_epu8_mask(zmm_src0_3, zmm_src1_3);
+    if (mask_3 != 0xFFFFFFFFFFFFFFFF) {
+        uint32_t match_byte = (uint32_t)__builtin_ctzll(~mask_3);
+        return 144 + match_byte;
+    }
+
+    // 64 bytes (overlaps the previous 16 bytes for fast tail processing)
+    zmm_src0_4 = _mm512_loadu_si512((__m512i*)(src0 + 192));
+    zmm_src1_4 = _mm512_loadu_si512((__m512i*)(src1 + 192));
+    mask_4 = _mm512_cmpeq_epu8_mask(zmm_src0_4, zmm_src1_4);
+    if (mask_4 != 0xFFFFFFFFFFFFFFFF) {
+        uint32_t match_byte = (uint32_t)__builtin_ctzll(~mask_4);
+        return 192 + match_byte;
+    }
+
+    return 256;
+}
+
+Z_INTERNAL uint32_t compare256_avx512(const uint8_t *src0, const uint8_t *src1) {
+    return compare256_avx512_static(src0, src1);
+}
+
+#define LONGEST_MATCH       longest_match_avx512
+#define COMPARE256          compare256_avx512_static
+
+#include "match_tpl.h"
+
+#define LONGEST_MATCH_SLOW
+#define LONGEST_MATCH       longest_match_slow_avx512
+#define COMPARE256          compare256_avx512_static
+
+#include "match_tpl.h"
+
+#endif
diff --git a/arch/x86/compare256_sse2.c b/arch/x86/compare256_sse2.c
index 216bb3a7..25b65316 100644
--- a/arch/x86/compare256_sse2.c
+++ b/arch/x86/compare256_sse2.c
@@ -4,7 +4,7 @@
  */
 
 #include "zbuild.h"
-#include "zutil_p.h"
+#include "zmemory.h"
 #include "deflate.h"
 #include "fallback_builtins.h"
 
diff --git a/arch/x86/crc32_fold_pclmulqdq_tpl.h b/arch/x86/crc32_fold_pclmulqdq_tpl.h
deleted file mode 100644
index 1ffe201d..00000000
--- a/arch/x86/crc32_fold_pclmulqdq_tpl.h
+++ /dev/null
@@ -1,199 +0,0 @@
-/*
- * Compute the CRC32 using a parallelized folding approach with the PCLMULQDQ
- * instruction.
- *
- * A white paper describing this algorithm can be found at:
- *     doc/crc-pclmulqdq.pdf
- *
- * Copyright (C) 2013 Intel Corporation. All rights reserved.
- * Copyright (C) 2016 Marian Beermann (support for initial value)
- * Authors:
- *     Wajdi Feghali   <wajdi.k.feghali@intel.com>
- *     Jim Guilford    <james.guilford@intel.com>
- *     Vinodh Gopal    <vinodh.gopal@intel.com>
- *     Erdinc Ozturk   <erdinc.ozturk@intel.com>
- *     Jim Kukunas     <james.t.kukunas@linux.intel.com>
- *
- * For conditions of distribution and use, see copyright notice in zlib.h
- */
-
-#ifdef COPY
-Z_INTERNAL void CRC32_FOLD_COPY(crc32_fold *crc, uint8_t *dst, const uint8_t *src, size_t len) {
-#else
-Z_INTERNAL void CRC32_FOLD(crc32_fold *crc, const uint8_t *src, size_t len, uint32_t init_crc) {
-#endif
-    unsigned long algn_diff;
-    __m128i xmm_t0, xmm_t1, xmm_t2, xmm_t3;
-    __m128i xmm_crc0, xmm_crc1, xmm_crc2, xmm_crc3;
-    __m128i xmm_crc_part = _mm_setzero_si128();
-    char ALIGNED_(16) partial_buf[16] = { 0 };
-#ifndef COPY
-    __m128i xmm_initial = _mm_cvtsi32_si128(init_crc);
-    int32_t first = init_crc != 0;
-
-    /* The CRC functions don't call this for input < 16, as a minimum of 16 bytes of input is needed
-     * for the aligning load that occurs.  If there's an initial CRC, to carry it forward through
-     * the folded CRC there must be 16 - src % 16 + 16 bytes available, which by definition can be
-     * up to 15 bytes + one full vector load. */
-    assert(len >= 16 || first == 0);
-#endif
-    crc32_fold_load((__m128i *)crc->fold, &xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
-
-    if (len < 16) {
-        if (len == 0)
-            return;
-
-        memcpy(partial_buf, src, len);
-        xmm_crc_part = _mm_load_si128((const __m128i *)partial_buf);
-#ifdef COPY
-        memcpy(dst, partial_buf, len);
-#endif
-        goto partial;
-    }
-
-    algn_diff = ((uintptr_t)16 - ((uintptr_t)src & 0xF)) & 0xF;
-    if (algn_diff) {
-        xmm_crc_part = _mm_loadu_si128((__m128i *)src);
-#ifdef COPY
-        _mm_storeu_si128((__m128i *)dst, xmm_crc_part);
-        dst += algn_diff;
-#else
-        XOR_INITIAL128(xmm_crc_part);
-
-        if (algn_diff < 4 && init_crc != 0) {
-            xmm_t0 = xmm_crc_part;
-            if (len >= 32) {
-                xmm_crc_part = _mm_loadu_si128((__m128i*)src + 1);
-                fold_1(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
-                xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t0);
-            } else {
-                memcpy(partial_buf, src + 16, len - 16);
-                xmm_crc_part = _mm_load_si128((__m128i*)partial_buf);
-                fold_1(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
-                xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t0);
-                src += 16;
-                len -= 16;
-#ifdef COPY
-                dst -= algn_diff;
-#endif
-                goto partial;
-            }
-
-            src += 16;
-            len -= 16;
-        }
-#endif
-
-        partial_fold(algn_diff, &xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, &xmm_crc_part);
-
-        src += algn_diff;
-        len -= algn_diff;
-    }
-
-#ifdef X86_VPCLMULQDQ
-    if (len >= 256) {
-#ifdef COPY
-        size_t n = fold_16_vpclmulqdq_copy(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, dst, src, len);
-        dst += n;
-#else
-        size_t n = fold_16_vpclmulqdq(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, src, len,
-            xmm_initial, first);
-        first = 0;
-#endif
-        len -= n;
-        src += n;
-    }
-#endif
-
-    while (len >= 64) {
-        len -= 64;
-        xmm_t0 = _mm_load_si128((__m128i *)src);
-        xmm_t1 = _mm_load_si128((__m128i *)src + 1);
-        xmm_t2 = _mm_load_si128((__m128i *)src + 2);
-        xmm_t3 = _mm_load_si128((__m128i *)src + 3);
-        src += 64;
-
-        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
-#ifdef COPY
-        _mm_storeu_si128((__m128i *)dst, xmm_t0);
-        _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
-        _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
-        _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
-        dst += 64;
-#else
-        XOR_INITIAL128(xmm_t0);
-#endif
-
-        xmm_crc0 = _mm_xor_si128(xmm_crc0, xmm_t0);
-        xmm_crc1 = _mm_xor_si128(xmm_crc1, xmm_t1);
-        xmm_crc2 = _mm_xor_si128(xmm_crc2, xmm_t2);
-        xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t3);
-    }
-
-    /*
-     * len = num bytes left - 64
-     */
-    if (len >= 48) {
-        len -= 48;
-
-        xmm_t0 = _mm_load_si128((__m128i *)src);
-        xmm_t1 = _mm_load_si128((__m128i *)src + 1);
-        xmm_t2 = _mm_load_si128((__m128i *)src + 2);
-        src += 48;
-#ifdef COPY
-        _mm_storeu_si128((__m128i *)dst, xmm_t0);
-        _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
-        _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
-        dst += 48;
-#else
-        XOR_INITIAL128(xmm_t0);
-#endif
-        fold_3(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
-
-        xmm_crc1 = _mm_xor_si128(xmm_crc1, xmm_t0);
-        xmm_crc2 = _mm_xor_si128(xmm_crc2, xmm_t1);
-        xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t2);
-    } else if (len >= 32) {
-        len -= 32;
-
-        xmm_t0 = _mm_load_si128((__m128i *)src);
-        xmm_t1 = _mm_load_si128((__m128i *)src + 1);
-        src += 32;
-#ifdef COPY
-        _mm_storeu_si128((__m128i *)dst, xmm_t0);
-        _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
-        dst += 32;
-#else
-        XOR_INITIAL128(xmm_t0);
-#endif
-        fold_2(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
-
-        xmm_crc2 = _mm_xor_si128(xmm_crc2, xmm_t0);
-        xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t1);
-    } else if (len >= 16) {
-        len -= 16;
-        xmm_t0 = _mm_load_si128((__m128i *)src);
-        src += 16;
-#ifdef COPY
-        _mm_storeu_si128((__m128i *)dst, xmm_t0);
-        dst += 16;
-#else
-        XOR_INITIAL128(xmm_t0);
-#endif
-        fold_1(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
-
-        xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t0);
-    }
-
-partial:
-    if (len) {
-        memcpy(&xmm_crc_part, src, len);
-#ifdef COPY
-        _mm_storeu_si128((__m128i *)partial_buf, xmm_crc_part);
-        memcpy(dst, partial_buf, len);
-#endif
-        partial_fold(len, &xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, &xmm_crc_part);
-    }
-
-    crc32_fold_save((__m128i *)crc->fold, &xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
-}
diff --git a/arch/x86/crc32_fold_vpclmulqdq_tpl.h b/arch/x86/crc32_fold_vpclmulqdq_tpl.h
deleted file mode 100644
index 3ea5c330..00000000
--- a/arch/x86/crc32_fold_vpclmulqdq_tpl.h
+++ /dev/null
@@ -1,107 +0,0 @@
-/* crc32_fold_vpclmulqdq_tpl.h -- VPCMULQDQ-based CRC32 folding template.
- * Copyright Wangyang Guo (wangyang.guo@intel.com)
- * For conditions of distribution and use, see copyright notice in zlib.h
- */
-
-#ifdef COPY
-static size_t fold_16_vpclmulqdq_copy(__m128i *xmm_crc0, __m128i *xmm_crc1,
-    __m128i *xmm_crc2, __m128i *xmm_crc3, uint8_t *dst, const uint8_t *src, size_t len) {
-#else
-static size_t fold_16_vpclmulqdq(__m128i *xmm_crc0, __m128i *xmm_crc1,
-    __m128i *xmm_crc2, __m128i *xmm_crc3, const uint8_t *src, size_t len,
-    __m128i init_crc, int32_t first) {
-    __m512i zmm_initial = _mm512_zextsi128_si512(init_crc);
-#endif
-    __m512i zmm_t0, zmm_t1, zmm_t2, zmm_t3;
-    __m512i zmm_crc0, zmm_crc1, zmm_crc2, zmm_crc3;
-    __m512i z0, z1, z2, z3;
-    size_t len_tmp = len;
-    const __m512i zmm_fold4 = _mm512_set4_epi32(
-        0x00000001, 0x54442bd4, 0x00000001, 0xc6e41596);
-    const __m512i zmm_fold16 = _mm512_set4_epi32(
-        0x00000001, 0x1542778a, 0x00000001, 0x322d1430);
-
-    // zmm register init
-    zmm_crc0 = _mm512_setzero_si512();
-    zmm_t0 = _mm512_loadu_si512((__m512i *)src);
-#ifndef COPY
-    XOR_INITIAL512(zmm_t0);
-#endif
-    zmm_crc1 = _mm512_loadu_si512((__m512i *)src + 1);
-    zmm_crc2 = _mm512_loadu_si512((__m512i *)src + 2);
-    zmm_crc3 = _mm512_loadu_si512((__m512i *)src + 3);
-
-    /* already have intermediate CRC in xmm registers
-        * fold4 with 4 xmm_crc to get zmm_crc0
-    */
-    zmm_crc0 = _mm512_inserti32x4(zmm_crc0, *xmm_crc0, 0);
-    zmm_crc0 = _mm512_inserti32x4(zmm_crc0, *xmm_crc1, 1);
-    zmm_crc0 = _mm512_inserti32x4(zmm_crc0, *xmm_crc2, 2);
-    zmm_crc0 = _mm512_inserti32x4(zmm_crc0, *xmm_crc3, 3);
-    z0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x01);
-    zmm_crc0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x10);
-    zmm_crc0 = _mm512_ternarylogic_epi32(zmm_crc0, z0, zmm_t0, 0x96);
-
-#ifdef COPY
-    _mm512_storeu_si512((__m512i *)dst, zmm_t0);
-    _mm512_storeu_si512((__m512i *)dst + 1, zmm_crc1);
-    _mm512_storeu_si512((__m512i *)dst + 2, zmm_crc2);
-    _mm512_storeu_si512((__m512i *)dst + 3, zmm_crc3);
-    dst += 256;
-#endif
-    len -= 256;
-    src += 256;
-
-    // fold-16 loops
-    while (len >= 256) {
-        zmm_t0 = _mm512_loadu_si512((__m512i *)src);
-        zmm_t1 = _mm512_loadu_si512((__m512i *)src + 1);
-        zmm_t2 = _mm512_loadu_si512((__m512i *)src + 2);
-        zmm_t3 = _mm512_loadu_si512((__m512i *)src + 3);
-
-        z0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold16, 0x01);
-        z1 = _mm512_clmulepi64_epi128(zmm_crc1, zmm_fold16, 0x01);
-        z2 = _mm512_clmulepi64_epi128(zmm_crc2, zmm_fold16, 0x01);
-        z3 = _mm512_clmulepi64_epi128(zmm_crc3, zmm_fold16, 0x01);
-
-        zmm_crc0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold16, 0x10);
-        zmm_crc1 = _mm512_clmulepi64_epi128(zmm_crc1, zmm_fold16, 0x10);
-        zmm_crc2 = _mm512_clmulepi64_epi128(zmm_crc2, zmm_fold16, 0x10);
-        zmm_crc3 = _mm512_clmulepi64_epi128(zmm_crc3, zmm_fold16, 0x10);
-
-        zmm_crc0 = _mm512_ternarylogic_epi32(zmm_crc0, z0, zmm_t0, 0x96);
-        zmm_crc1 = _mm512_ternarylogic_epi32(zmm_crc1, z1, zmm_t1, 0x96);
-        zmm_crc2 = _mm512_ternarylogic_epi32(zmm_crc2, z2, zmm_t2, 0x96);
-        zmm_crc3 = _mm512_ternarylogic_epi32(zmm_crc3, z3, zmm_t3, 0x96);
-
-#ifdef COPY
-        _mm512_storeu_si512((__m512i *)dst, zmm_t0);
-        _mm512_storeu_si512((__m512i *)dst + 1, zmm_t1);
-        _mm512_storeu_si512((__m512i *)dst + 2, zmm_t2);
-        _mm512_storeu_si512((__m512i *)dst + 3, zmm_t3);
-        dst += 256;
-#endif
-        len -= 256;
-        src += 256;
-    }
-    // zmm_crc[0,1,2,3] -> zmm_crc0
-    z0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x01);
-    zmm_crc0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x10);
-    zmm_crc0 = _mm512_ternarylogic_epi32(zmm_crc0, z0, zmm_crc1, 0x96);
-
-    z0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x01);
-    zmm_crc0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x10);
-    zmm_crc0 = _mm512_ternarylogic_epi32(zmm_crc0, z0, zmm_crc2, 0x96);
-
-    z0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x01);
-    zmm_crc0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x10);
-    zmm_crc0 = _mm512_ternarylogic_epi32(zmm_crc0, z0, zmm_crc3, 0x96);
-
-    // zmm_crc0 -> xmm_crc[0, 1, 2, 3]
-    *xmm_crc0 = _mm512_extracti32x4_epi32(zmm_crc0, 0);
-    *xmm_crc1 = _mm512_extracti32x4_epi32(zmm_crc0, 1);
-    *xmm_crc2 = _mm512_extracti32x4_epi32(zmm_crc0, 2);
-    *xmm_crc3 = _mm512_extracti32x4_epi32(zmm_crc0, 3);
-
-    return (len_tmp - len);  // return n bytes processed
-}
diff --git a/arch/x86/crc32_pclmulqdq.c b/arch/x86/crc32_pclmulqdq.c
index 9383b7a2..c8be1b43 100644
--- a/arch/x86/crc32_pclmulqdq.c
+++ b/arch/x86/crc32_pclmulqdq.c
@@ -19,12 +19,13 @@
 
 #ifdef X86_PCLMULQDQ_CRC
 
-#define CRC32_FOLD_COPY  crc32_fold_pclmulqdq_copy
-#define CRC32_FOLD       crc32_fold_pclmulqdq
-#define CRC32_FOLD_RESET crc32_fold_pclmulqdq_reset
-#define CRC32_FOLD_FINAL crc32_fold_pclmulqdq_final
-#define CRC32            crc32_pclmulqdq
-
 #include "crc32_pclmulqdq_tpl.h"
 
+Z_INTERNAL uint32_t crc32_pclmulqdq(uint32_t crc, const uint8_t *buf, size_t len) {
+    return crc32_copy_impl(crc, NULL, buf, len, 0);
+}
+
+Z_INTERNAL uint32_t crc32_copy_pclmulqdq(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    return crc32_copy_impl(crc, dst, src, len, 1);
+}
 #endif
diff --git a/arch/x86/crc32_pclmulqdq_tpl.h b/arch/x86/crc32_pclmulqdq_tpl.h
index 3a4f6af5..625a90fc 100644
--- a/arch/x86/crc32_pclmulqdq_tpl.h
+++ b/arch/x86/crc32_pclmulqdq_tpl.h
@@ -1,10 +1,10 @@
-/*
- * Compute the CRC32 using a parallelized folding approach with the PCLMULQDQ
- * instruction.
+/* crc32_pclmulqdq_tpl.h -- Compute the CRC32 using a parallelized folding
+ * approach with the PCLMULQDQ and VPCMULQDQ instructions.
  *
  * A white paper describing this algorithm can be found at:
  *     doc/crc-pclmulqdq.pdf
  *
+ * Copyright (C) 2020 Wangyang Guo (wangyang.guo@intel.com) (VPCLMULQDQ support)
  * Copyright (C) 2013 Intel Corporation. All rights reserved.
  * Copyright (C) 2016 Marian Beermann (support for initial value)
  * Authors:
@@ -22,354 +22,586 @@
 #include <immintrin.h>
 #include <wmmintrin.h>
 #include <smmintrin.h> // _mm_extract_epi32
-#ifdef X86_VPCLMULQDQ
-#  include <immintrin.h>
-#endif
 
 #include "crc32.h"
 #include "crc32_braid_p.h"
 #include "crc32_braid_tbl.h"
 #include "x86_intrins.h"
-#include <assert.h>
 
 #ifdef X86_VPCLMULQDQ
-static size_t fold_16_vpclmulqdq(__m128i *xmm_crc0, __m128i *xmm_crc1,
-    __m128i *xmm_crc2, __m128i *xmm_crc3, const uint8_t *src, size_t len, __m128i init_crc,
-    int32_t first);
-static size_t fold_16_vpclmulqdq_copy(__m128i *xmm_crc0, __m128i *xmm_crc1,
-    __m128i *xmm_crc2, __m128i *xmm_crc3, uint8_t *dst, const uint8_t *src, size_t len);
+#  if defined(_MSC_VER) && _MSC_VER < 1920
+     /* Use epi32 variants for older MSVC toolchains (v141/v140) to avoid cast warnings */
+#    define z512_xor3_epi64(a, b, c)     _mm512_ternarylogic_epi32(a, b, c, 0x96)
+#    define z512_inserti64x2(a, b, imm)  _mm512_inserti32x4(a, b, imm)
+#    define z512_extracti64x2(a, imm)    _mm512_extracti32x4_epi32(a, imm)
+#  else
+#    define z512_xor3_epi64(a, b, c)     _mm512_ternarylogic_epi64(a, b, c, 0x96)
+#    define z512_inserti64x2(a, b, imm)  _mm512_inserti64x2(a, b, imm)
+#    define z512_extracti64x2(a, imm)    _mm512_extracti64x2_epi64(a, imm)
+#  endif
+#  ifdef __AVX512VL__
+#    define z128_xor3_epi64(a, b, c)  _mm_ternarylogic_epi64(a, b, c, 0x96)
+#  endif
 #endif
 
-static void fold_1(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3) {
-    const __m128i xmm_fold4 = _mm_set_epi32( 0x00000001, 0x54442bd4,
-                                             0x00000001, 0xc6e41596);
-    __m128i x_tmp3;
-    __m128 ps_crc0, ps_crc3, ps_res;
-
-    x_tmp3 = *xmm_crc3;
+#ifndef z128_xor3_epi64
+#  define z128_xor3_epi64(a, b, c)    _mm_xor_si128(_mm_xor_si128(a, b), c)
+#endif
 
-    *xmm_crc3 = *xmm_crc0;
-    *xmm_crc0 = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x01);
-    *xmm_crc3 = _mm_clmulepi64_si128(*xmm_crc3, xmm_fold4, 0x10);
-    ps_crc0 = _mm_castsi128_ps(*xmm_crc0);
-    ps_crc3 = _mm_castsi128_ps(*xmm_crc3);
-    ps_res = _mm_xor_ps(ps_crc0, ps_crc3);
+static inline void fold_1(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3, const __m128i xmm_fold4) {
+    __m128i x_low  = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x01);
+    __m128i x_high = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x10);
 
     *xmm_crc0 = *xmm_crc1;
     *xmm_crc1 = *xmm_crc2;
-    *xmm_crc2 = x_tmp3;
-    *xmm_crc3 = _mm_castps_si128(ps_res);
-}
-
-static void fold_2(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3) {
-    const __m128i xmm_fold4 = _mm_set_epi32( 0x00000001, 0x54442bd4,
-                                             0x00000001, 0xc6e41596);
-    __m128i x_tmp3, x_tmp2;
-    __m128 ps_crc0, ps_crc1, ps_crc2, ps_crc3, ps_res31, ps_res20;
-
-    x_tmp3 = *xmm_crc3;
-    x_tmp2 = *xmm_crc2;
-
-    *xmm_crc3 = *xmm_crc1;
-    *xmm_crc1 = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x01);
-    *xmm_crc3 = _mm_clmulepi64_si128(*xmm_crc3, xmm_fold4, 0x10);
-    ps_crc3 = _mm_castsi128_ps(*xmm_crc3);
-    ps_crc1 = _mm_castsi128_ps(*xmm_crc1);
-    ps_res31 = _mm_xor_ps(ps_crc3, ps_crc1);
-
-    *xmm_crc2 = *xmm_crc0;
-    *xmm_crc0 = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x01);
-    *xmm_crc2 = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold4, 0x10);
-    ps_crc0 = _mm_castsi128_ps(*xmm_crc0);
-    ps_crc2 = _mm_castsi128_ps(*xmm_crc2);
-    ps_res20 = _mm_xor_ps(ps_crc0, ps_crc2);
-
-    *xmm_crc0 = x_tmp2;
-    *xmm_crc1 = x_tmp3;
-    *xmm_crc2 = _mm_castps_si128(ps_res20);
-    *xmm_crc3 = _mm_castps_si128(ps_res31);
+    *xmm_crc2 = *xmm_crc3;
+    *xmm_crc3 = _mm_xor_si128(x_low, x_high);
 }
 
-static void fold_3(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3) {
-    const __m128i xmm_fold4 = _mm_set_epi32( 0x00000001, 0x54442bd4,
-                                             0x00000001, 0xc6e41596);
-    __m128i x_tmp3;
-    __m128 ps_crc0, ps_crc1, ps_crc2, ps_crc3, ps_res32, ps_res21, ps_res10;
-
-    x_tmp3 = *xmm_crc3;
-
-    *xmm_crc3 = *xmm_crc2;
-    *xmm_crc2 = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold4, 0x01);
-    *xmm_crc3 = _mm_clmulepi64_si128(*xmm_crc3, xmm_fold4, 0x10);
-    ps_crc2 = _mm_castsi128_ps(*xmm_crc2);
-    ps_crc3 = _mm_castsi128_ps(*xmm_crc3);
-    ps_res32 = _mm_xor_ps(ps_crc2, ps_crc3);
-
-    *xmm_crc2 = *xmm_crc1;
-    *xmm_crc1 = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x01);
-    *xmm_crc2 = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold4, 0x10);
-    ps_crc1 = _mm_castsi128_ps(*xmm_crc1);
-    ps_crc2 = _mm_castsi128_ps(*xmm_crc2);
-    ps_res21 = _mm_xor_ps(ps_crc1, ps_crc2);
-
-    *xmm_crc1 = *xmm_crc0;
-    *xmm_crc0 = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x01);
-    *xmm_crc1 = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x10);
-    ps_crc0 = _mm_castsi128_ps(*xmm_crc0);
-    ps_crc1 = _mm_castsi128_ps(*xmm_crc1);
-    ps_res10 = _mm_xor_ps(ps_crc0, ps_crc1);
-
-    *xmm_crc0 = x_tmp3;
-    *xmm_crc1 = _mm_castps_si128(ps_res10);
-    *xmm_crc2 = _mm_castps_si128(ps_res21);
-    *xmm_crc3 = _mm_castps_si128(ps_res32);
-}
-
-static void fold_4(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3) {
-    const __m128i xmm_fold4 = _mm_set_epi32( 0x00000001, 0x54442bd4,
-                                             0x00000001, 0xc6e41596);
-    __m128i x_tmp0, x_tmp1, x_tmp2, x_tmp3;
-    __m128 ps_crc0, ps_crc1, ps_crc2, ps_crc3;
-    __m128 ps_t0, ps_t1, ps_t2, ps_t3;
-    __m128 ps_res0, ps_res1, ps_res2, ps_res3;
-
-    x_tmp0 = *xmm_crc0;
-    x_tmp1 = *xmm_crc1;
-    x_tmp2 = *xmm_crc2;
-    x_tmp3 = *xmm_crc3;
-
-    *xmm_crc0 = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x01);
-    x_tmp0 = _mm_clmulepi64_si128(x_tmp0, xmm_fold4, 0x10);
-    ps_crc0 = _mm_castsi128_ps(*xmm_crc0);
-    ps_t0 = _mm_castsi128_ps(x_tmp0);
-    ps_res0 = _mm_xor_ps(ps_crc0, ps_t0);
-
-    *xmm_crc1 = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x01);
-    x_tmp1 = _mm_clmulepi64_si128(x_tmp1, xmm_fold4, 0x10);
-    ps_crc1 = _mm_castsi128_ps(*xmm_crc1);
-    ps_t1 = _mm_castsi128_ps(x_tmp1);
-    ps_res1 = _mm_xor_ps(ps_crc1, ps_t1);
-
-    *xmm_crc2 = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold4, 0x01);
-    x_tmp2 = _mm_clmulepi64_si128(x_tmp2, xmm_fold4, 0x10);
-    ps_crc2 = _mm_castsi128_ps(*xmm_crc2);
-    ps_t2 = _mm_castsi128_ps(x_tmp2);
-    ps_res2 = _mm_xor_ps(ps_crc2, ps_t2);
-
-    *xmm_crc3 = _mm_clmulepi64_si128(*xmm_crc3, xmm_fold4, 0x01);
-    x_tmp3 = _mm_clmulepi64_si128(x_tmp3, xmm_fold4, 0x10);
-    ps_crc3 = _mm_castsi128_ps(*xmm_crc3);
-    ps_t3 = _mm_castsi128_ps(x_tmp3);
-    ps_res3 = _mm_xor_ps(ps_crc3, ps_t3);
-
-    *xmm_crc0 = _mm_castps_si128(ps_res0);
-    *xmm_crc1 = _mm_castps_si128(ps_res1);
-    *xmm_crc2 = _mm_castps_si128(ps_res2);
-    *xmm_crc3 = _mm_castps_si128(ps_res3);
-}
+static inline void fold_2(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3, const __m128i xmm_fold4) {
+    __m128i x_low0  = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x01);
+    __m128i x_high0 = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x10);
+    __m128i x_low1  = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x01);
+    __m128i x_high1 = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x10);
 
-static const unsigned ALIGNED_(32) pshufb_shf_table[60] = {
-    0x84838281, 0x88878685, 0x8c8b8a89, 0x008f8e8d, /* shl 15 (16 - 1)/shr1 */
-    0x85848382, 0x89888786, 0x8d8c8b8a, 0x01008f8e, /* shl 14 (16 - 3)/shr2 */
-    0x86858483, 0x8a898887, 0x8e8d8c8b, 0x0201008f, /* shl 13 (16 - 4)/shr3 */
-    0x87868584, 0x8b8a8988, 0x8f8e8d8c, 0x03020100, /* shl 12 (16 - 4)/shr4 */
-    0x88878685, 0x8c8b8a89, 0x008f8e8d, 0x04030201, /* shl 11 (16 - 5)/shr5 */
-    0x89888786, 0x8d8c8b8a, 0x01008f8e, 0x05040302, /* shl 10 (16 - 6)/shr6 */
-    0x8a898887, 0x8e8d8c8b, 0x0201008f, 0x06050403, /* shl  9 (16 - 7)/shr7 */
-    0x8b8a8988, 0x8f8e8d8c, 0x03020100, 0x07060504, /* shl  8 (16 - 8)/shr8 */
-    0x8c8b8a89, 0x008f8e8d, 0x04030201, 0x08070605, /* shl  7 (16 - 9)/shr9 */
-    0x8d8c8b8a, 0x01008f8e, 0x05040302, 0x09080706, /* shl  6 (16 -10)/shr10*/
-    0x8e8d8c8b, 0x0201008f, 0x06050403, 0x0a090807, /* shl  5 (16 -11)/shr11*/
-    0x8f8e8d8c, 0x03020100, 0x07060504, 0x0b0a0908, /* shl  4 (16 -12)/shr12*/
-    0x008f8e8d, 0x04030201, 0x08070605, 0x0c0b0a09, /* shl  3 (16 -13)/shr13*/
-    0x01008f8e, 0x05040302, 0x09080706, 0x0d0c0b0a, /* shl  2 (16 -14)/shr14*/
-    0x0201008f, 0x06050403, 0x0a090807, 0x0e0d0c0b  /* shl  1 (16 -15)/shr15*/
-};
-
-static void partial_fold(const size_t len, __m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2,
-                         __m128i *xmm_crc3, __m128i *xmm_crc_part) {
-    const __m128i xmm_fold4 = _mm_set_epi32( 0x00000001, 0x54442bd4,
-                                             0x00000001, 0xc6e41596);
-    const __m128i xmm_mask3 = _mm_set1_epi32((int32_t)0x80808080);
-
-    __m128i xmm_shl, xmm_shr, xmm_tmp1, xmm_tmp2, xmm_tmp3;
-    __m128i xmm_a0_0, xmm_a0_1;
-    __m128 ps_crc3, psa0_0, psa0_1, ps_res;
-
-    xmm_shl = _mm_load_si128((__m128i *)(pshufb_shf_table + (4 * (len - 1))));
-    xmm_shr = xmm_shl;
-    xmm_shr = _mm_xor_si128(xmm_shr, xmm_mask3);
-
-    xmm_a0_0 = _mm_shuffle_epi8(*xmm_crc0, xmm_shl);
-
-    *xmm_crc0 = _mm_shuffle_epi8(*xmm_crc0, xmm_shr);
-    xmm_tmp1 = _mm_shuffle_epi8(*xmm_crc1, xmm_shl);
-    *xmm_crc0 = _mm_or_si128(*xmm_crc0, xmm_tmp1);
-
-    *xmm_crc1 = _mm_shuffle_epi8(*xmm_crc1, xmm_shr);
-    xmm_tmp2 = _mm_shuffle_epi8(*xmm_crc2, xmm_shl);
-    *xmm_crc1 = _mm_or_si128(*xmm_crc1, xmm_tmp2);
-
-    *xmm_crc2 = _mm_shuffle_epi8(*xmm_crc2, xmm_shr);
-    xmm_tmp3 = _mm_shuffle_epi8(*xmm_crc3, xmm_shl);
-    *xmm_crc2 = _mm_or_si128(*xmm_crc2, xmm_tmp3);
-
-    *xmm_crc3 = _mm_shuffle_epi8(*xmm_crc3, xmm_shr);
-    *xmm_crc_part = _mm_shuffle_epi8(*xmm_crc_part, xmm_shl);
-    *xmm_crc3 = _mm_or_si128(*xmm_crc3, *xmm_crc_part);
-
-    xmm_a0_1 = _mm_clmulepi64_si128(xmm_a0_0, xmm_fold4, 0x10);
-    xmm_a0_0 = _mm_clmulepi64_si128(xmm_a0_0, xmm_fold4, 0x01);
-
-    ps_crc3 = _mm_castsi128_ps(*xmm_crc3);
-    psa0_0 = _mm_castsi128_ps(xmm_a0_0);
-    psa0_1 = _mm_castsi128_ps(xmm_a0_1);
-
-    ps_res = _mm_xor_ps(ps_crc3, psa0_0);
-    ps_res = _mm_xor_ps(ps_res, psa0_1);
-
-    *xmm_crc3 = _mm_castps_si128(ps_res);
+    *xmm_crc0 = *xmm_crc2;
+    *xmm_crc1 = *xmm_crc3;
+    *xmm_crc2 = _mm_xor_si128(x_low0, x_high0);
+    *xmm_crc3 = _mm_xor_si128(x_low1, x_high1);
 }
 
-static inline void crc32_fold_load(__m128i *fold, __m128i *fold0, __m128i *fold1, __m128i *fold2, __m128i *fold3) {
-    *fold0 = _mm_load_si128(fold + 0);
-    *fold1 = _mm_load_si128(fold + 1);
-    *fold2 = _mm_load_si128(fold + 2);
-    *fold3 = _mm_load_si128(fold + 3);
+static inline void fold_3(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3, const __m128i xmm_fold4) {
+    __m128i x_low0  = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x01);
+    __m128i x_high0 = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x10);
+    __m128i x_low1  = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x01);
+    __m128i x_high1 = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x10);
+    __m128i x_low2  = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold4, 0x01);
+    __m128i x_high2 = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold4, 0x10);
+
+    *xmm_crc0 = *xmm_crc3;
+    *xmm_crc1 = _mm_xor_si128(x_low0, x_high0);
+    *xmm_crc2 = _mm_xor_si128(x_low1, x_high1);
+    *xmm_crc3 = _mm_xor_si128(x_low2, x_high2);
 }
 
-static inline void crc32_fold_save(__m128i *fold, const __m128i *fold0, const __m128i *fold1,
-                                   const __m128i *fold2, const __m128i *fold3) {
-    _mm_storeu_si128(fold + 0, *fold0);
-    _mm_storeu_si128(fold + 1, *fold1);
-    _mm_storeu_si128(fold + 2, *fold2);
-    _mm_storeu_si128(fold + 3, *fold3);
+static inline void fold_4(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3, const __m128i xmm_fold4) {
+    __m128i x_low0  = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x01);
+    __m128i x_high0 = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold4, 0x10);
+    __m128i x_low1  = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x01);
+    __m128i x_high1 = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold4, 0x10);
+    __m128i x_low2  = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold4, 0x01);
+    __m128i x_high2 = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold4, 0x10);
+    __m128i x_low3  = _mm_clmulepi64_si128(*xmm_crc3, xmm_fold4, 0x01);
+    __m128i x_high3 = _mm_clmulepi64_si128(*xmm_crc3, xmm_fold4, 0x10);
+
+    *xmm_crc0 = _mm_xor_si128(x_low0, x_high0);
+    *xmm_crc1 = _mm_xor_si128(x_low1, x_high1);
+    *xmm_crc2 = _mm_xor_si128(x_low2, x_high2);
+    *xmm_crc3 = _mm_xor_si128(x_low3, x_high3);
 }
 
-Z_INTERNAL uint32_t CRC32_FOLD_RESET(crc32_fold *crc) {
-    __m128i xmm_crc0 = _mm_cvtsi32_si128(0x9db42487);
-    __m128i xmm_zero = _mm_setzero_si128();
-    crc32_fold_save((__m128i *)crc->fold, &xmm_crc0, &xmm_zero, &xmm_zero, &xmm_zero);
-    return 0;
+static inline void fold_12(__m128i *xmm_crc0, __m128i *xmm_crc1, __m128i *xmm_crc2, __m128i *xmm_crc3) {
+    const __m128i xmm_fold12 = _mm_set_epi64x(0x596C8D81, 0xF5E48C85);
+    __m128i x_low0  = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold12, 0x01);
+    __m128i x_high0 = _mm_clmulepi64_si128(*xmm_crc0, xmm_fold12, 0x10);
+    __m128i x_low1  = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold12, 0x01);
+    __m128i x_high1 = _mm_clmulepi64_si128(*xmm_crc1, xmm_fold12, 0x10);
+    __m128i x_low2  = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold12, 0x01);
+    __m128i x_high2 = _mm_clmulepi64_si128(*xmm_crc2, xmm_fold12, 0x10);
+    __m128i x_low3  = _mm_clmulepi64_si128(*xmm_crc3, xmm_fold12, 0x01);
+    __m128i x_high3 = _mm_clmulepi64_si128(*xmm_crc3, xmm_fold12, 0x10);
+
+    *xmm_crc0 = _mm_xor_si128(x_low0, x_high0);
+    *xmm_crc1 = _mm_xor_si128(x_low1, x_high1);
+    *xmm_crc2 = _mm_xor_si128(x_low2, x_high2);
+    *xmm_crc3 = _mm_xor_si128(x_low3, x_high3);
 }
 
-#define ONCE(op)                 if (first) { first = 0; op; }
-#define XOR_INITIAL128(where)    ONCE(where = _mm_xor_si128(where, xmm_initial))
 #ifdef X86_VPCLMULQDQ
-#  define XOR_INITIAL512(where)  ONCE(where = _mm512_xor_si512(where, zmm_initial))
-#endif
-
-#ifdef X86_VPCLMULQDQ
-#  include "crc32_fold_vpclmulqdq_tpl.h"
-#endif
-#include "crc32_fold_pclmulqdq_tpl.h"
-#define COPY
-#ifdef X86_VPCLMULQDQ
-#  include "crc32_fold_vpclmulqdq_tpl.h"
+static inline void fold_16(__m512i *zmm_crc0, __m512i *zmm_crc1, __m512i *zmm_crc2, __m512i *zmm_crc3,
+    const __m512i zmm_t0, const __m512i zmm_t1, const __m512i zmm_t2, const __m512i zmm_t3, const __m512i zmm_fold16) {
+    __m512i z_low0  = _mm512_clmulepi64_epi128(*zmm_crc0, zmm_fold16, 0x01);
+    __m512i z_high0 = _mm512_clmulepi64_epi128(*zmm_crc0, zmm_fold16, 0x10);
+    __m512i z_low1  = _mm512_clmulepi64_epi128(*zmm_crc1, zmm_fold16, 0x01);
+    __m512i z_high1 = _mm512_clmulepi64_epi128(*zmm_crc1, zmm_fold16, 0x10);
+    __m512i z_low2  = _mm512_clmulepi64_epi128(*zmm_crc2, zmm_fold16, 0x01);
+    __m512i z_high2 = _mm512_clmulepi64_epi128(*zmm_crc2, zmm_fold16, 0x10);
+    __m512i z_low3  = _mm512_clmulepi64_epi128(*zmm_crc3, zmm_fold16, 0x01);
+    __m512i z_high3 = _mm512_clmulepi64_epi128(*zmm_crc3, zmm_fold16, 0x10);
+
+    *zmm_crc0 = z512_xor3_epi64(z_low0, z_high0, zmm_t0);
+    *zmm_crc1 = z512_xor3_epi64(z_low1, z_high1, zmm_t1);
+    *zmm_crc2 = z512_xor3_epi64(z_low2, z_high2, zmm_t2);
+    *zmm_crc3 = z512_xor3_epi64(z_low3, z_high3, zmm_t3);
+}
 #endif
-#include "crc32_fold_pclmulqdq_tpl.h"
-
-static const unsigned ALIGNED_(16) crc_k[] = {
-    0xccaa009e, 0x00000000, /* rk1 */
-    0x751997d0, 0x00000001, /* rk2 */
-    0xccaa009e, 0x00000000, /* rk5 */
-    0x63cd6124, 0x00000001, /* rk6 */
-    0xf7011640, 0x00000001, /* rk7 */
-    0xdb710640, 0x00000001  /* rk8 */
-};
 
-static const unsigned ALIGNED_(16) crc_mask[4] = {
-    0xFFFFFFFF, 0xFFFFFFFF, 0x00000000, 0x00000000
-};
+static inline uint32_t crc32_copy_small(uint32_t crc, uint8_t *dst, const uint8_t *buf, size_t len, const int COPY) {
+    uint32_t c = ~crc;
 
-static const unsigned ALIGNED_(16) crc_mask2[4] = {
-    0x00000000, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
-};
+    while (len) {
+        len--;
+        if (COPY) {
+            *dst++ = *buf;
+        }
+        CRC_DO1;
+    }
 
-Z_INTERNAL uint32_t CRC32_FOLD_FINAL(crc32_fold *crc) {
-    const __m128i xmm_mask  = _mm_load_si128((__m128i *)crc_mask);
-    const __m128i xmm_mask2 = _mm_load_si128((__m128i *)crc_mask2);
-    __m128i xmm_crc0, xmm_crc1, xmm_crc2, xmm_crc3;
-    __m128i x_tmp0, x_tmp1, x_tmp2, crc_fold;
+    return ~c;
+}
 
-    crc32_fold_load((__m128i *)crc->fold, &xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
+Z_FORCEINLINE static uint32_t crc32_copy_impl(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len, const int COPY) {
+    size_t copy_len = len;
+    if (len >= 16) {
+        /* Calculate 16-byte alignment offset */
+        uintptr_t align_diff = ALIGN_DIFF(src, 16);
 
-    /*
-     * k1
-     */
-    crc_fold = _mm_load_si128((__m128i *)crc_k);
+        /* If total length is less than (alignment bytes + 16), use the faster small method.
+         * Handles both initially small buffers and cases where alignment would leave < 16 bytes */
+        copy_len = len < align_diff + 16 ? len : align_diff;
+    }
 
-    x_tmp0 = _mm_clmulepi64_si128(xmm_crc0, crc_fold, 0x10);
-    xmm_crc0 = _mm_clmulepi64_si128(xmm_crc0, crc_fold, 0x01);
-    xmm_crc1 = _mm_xor_si128(xmm_crc1, x_tmp0);
-    xmm_crc1 = _mm_xor_si128(xmm_crc1, xmm_crc0);
+    if (copy_len > 0) {
+        crc = crc32_copy_small(crc, dst, src, copy_len, COPY);
+        src += copy_len;
+        len -= copy_len;
+        if (COPY) {
+            dst += copy_len;
+        }
+    }
 
-    x_tmp1 = _mm_clmulepi64_si128(xmm_crc1, crc_fold, 0x10);
-    xmm_crc1 = _mm_clmulepi64_si128(xmm_crc1, crc_fold, 0x01);
-    xmm_crc2 = _mm_xor_si128(xmm_crc2, x_tmp1);
-    xmm_crc2 = _mm_xor_si128(xmm_crc2, xmm_crc1);
+    if (len == 0)
+        return crc;
 
-    x_tmp2 = _mm_clmulepi64_si128(xmm_crc2, crc_fold, 0x10);
-    xmm_crc2 = _mm_clmulepi64_si128(xmm_crc2, crc_fold, 0x01);
-    xmm_crc3 = _mm_xor_si128(xmm_crc3, x_tmp2);
-    xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_crc2);
+    const __m128i xmm_fold4 = _mm_set_epi32(0x00000001, 0x54442bd4, 0x00000001, 0xc6e41596);
 
-    /*
-     * k5
-     */
-    crc_fold = _mm_load_si128((__m128i *)(crc_k + 4));
+    __m128i xmm_t0, xmm_t1, xmm_t2, xmm_t3;
+    __m128i xmm_crc0 = _mm_cvtsi32_si128(0x9db42487);
+    __m128i xmm_crc1 = _mm_setzero_si128();
+    __m128i xmm_crc2 = _mm_setzero_si128();
+    __m128i xmm_crc3 = _mm_setzero_si128();
+
+    if (crc != 0) {
+        // Process the first 16 bytes and handle initial CRC
+        len -= 16;
+        xmm_t0 = _mm_load_si128((__m128i *)src);
+        src += 16;
+
+        fold_1(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            dst += 16;
+        }
+        xmm_crc3 = z128_xor3_epi64(xmm_crc3, xmm_t0, _mm_cvtsi32_si128(crc));
+    }
 
-    xmm_crc0 = xmm_crc3;
-    xmm_crc3 = _mm_clmulepi64_si128(xmm_crc3, crc_fold, 0);
-    xmm_crc0 = _mm_srli_si128(xmm_crc0, 8);
-    xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_crc0);
+#ifdef X86_VPCLMULQDQ
+    if (len >= 256) {
+        len -= 256;
+
+        __m512i zmm_crc0, zmm_crc1, zmm_crc2, zmm_crc3;
+        __m512i zmm_t0, zmm_t1, zmm_t2, zmm_t3;
+        __m512i z_low0, z_high0;
+        const __m512i zmm_fold4 = _mm512_set4_epi32(
+            0x00000001, 0x54442bd4, 0x00000001, 0xc6e41596);
+        const __m512i zmm_fold16 = _mm512_set4_epi32(
+            0x00000001, 0x1542778a, 0x00000001, 0x322d1430);
+
+        zmm_crc0 = _mm512_loadu_si512((__m512i *)src);
+        zmm_crc1 = _mm512_loadu_si512((__m512i *)src + 1);
+        zmm_crc2 = _mm512_loadu_si512((__m512i *)src + 2);
+        zmm_crc3 = _mm512_loadu_si512((__m512i *)src + 3);
+        src += 256;
+        if (COPY) {
+            _mm512_storeu_si512((__m512i *)dst, zmm_crc0);
+            _mm512_storeu_si512((__m512i *)dst + 1, zmm_crc1);
+            _mm512_storeu_si512((__m512i *)dst + 2, zmm_crc2);
+            _mm512_storeu_si512((__m512i *)dst + 3, zmm_crc3);
+            dst += 256;
+        }
+
+        // Fold existing xmm state into first 64 bytes
+        zmm_t0 = _mm512_castsi128_si512(xmm_crc0);
+        zmm_t0 = z512_inserti64x2(zmm_t0, xmm_crc1, 1);
+        zmm_t0 = z512_inserti64x2(zmm_t0, xmm_crc2, 2);
+        zmm_t0 = z512_inserti64x2(zmm_t0, xmm_crc3, 3);
+
+        z_low0 = _mm512_clmulepi64_epi128(zmm_t0, zmm_fold4, 0x01);
+        z_high0 = _mm512_clmulepi64_epi128(zmm_t0, zmm_fold4, 0x10);
+        zmm_crc0 = z512_xor3_epi64(zmm_crc0, z_low0, z_high0);
+
+        while (len >= 256) {
+            len -= 256;
+            zmm_t0 = _mm512_loadu_si512((__m512i *)src);
+            zmm_t1 = _mm512_loadu_si512((__m512i *)src + 1);
+            zmm_t2 = _mm512_loadu_si512((__m512i *)src + 2);
+            zmm_t3 = _mm512_loadu_si512((__m512i *)src + 3);
+            src += 256;
+
+            fold_16(&zmm_crc0, &zmm_crc1, &zmm_crc2, &zmm_crc3, zmm_t0, zmm_t1, zmm_t2, zmm_t3, zmm_fold16);
+            if (COPY) {
+                _mm512_storeu_si512((__m512i *)dst, zmm_t0);
+                _mm512_storeu_si512((__m512i *)dst + 1, zmm_t1);
+                _mm512_storeu_si512((__m512i *)dst + 2, zmm_t2);
+                _mm512_storeu_si512((__m512i *)dst + 3, zmm_t3);
+                dst += 256;
+            }
+        }
+
+        // zmm_crc[0,1,2,3] -> zmm_crc0
+        z_low0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x01);
+        z_high0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x10);
+        zmm_crc0 = z512_xor3_epi64(z_low0, z_high0, zmm_crc1);
+
+        z_low0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x01);
+        z_high0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x10);
+        zmm_crc0 = z512_xor3_epi64(z_low0, z_high0, zmm_crc2);
+
+        z_low0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x01);
+        z_high0 = _mm512_clmulepi64_epi128(zmm_crc0, zmm_fold4, 0x10);
+        zmm_crc0 = z512_xor3_epi64(z_low0, z_high0, zmm_crc3);
+
+        // zmm_crc0 -> xmm_crc[0, 1, 2, 3]
+        xmm_crc0 = z512_extracti64x2(zmm_crc0, 0);
+        xmm_crc1 = z512_extracti64x2(zmm_crc0, 1);
+        xmm_crc2 = z512_extracti64x2(zmm_crc0, 2);
+        xmm_crc3 = z512_extracti64x2(zmm_crc0, 3);
+    }
+#else
+    /* Implement Chorba algorithm from https://arxiv.org/abs/2412.16398
+     * We interleave the PCLMUL-base folds with 8x scaled generator
+     * polynomial copies; we read 8x QWORDS and then XOR them into
+     * the stream at the following offsets: 6, 9, 10, 16, 20, 22,
+     * 24, 25, 27, 28, 30, 31, 32 - this is detailed in the paper
+     * as "generator_64_bits_unrolled_8" */
+#ifndef __AVX512VL__
+    if (!COPY) {
+#endif
+    while (len >= 512 + 64 + 16*8) {
+        __m128i chorba8 = _mm_load_si128((__m128i *)src);
+        __m128i chorba7 = _mm_load_si128((__m128i *)src + 1);
+        __m128i chorba6 = _mm_load_si128((__m128i *)src + 2);
+        __m128i chorba5 = _mm_load_si128((__m128i *)src + 3);
+        __m128i chorba4 = _mm_load_si128((__m128i *)src + 4);
+        __m128i chorba3 = _mm_load_si128((__m128i *)src + 5);
+        __m128i chorba2 = _mm_load_si128((__m128i *)src + 6);
+        __m128i chorba1 = _mm_load_si128((__m128i *)src + 7);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, chorba8);
+            _mm_storeu_si128((__m128i *)dst + 1, chorba7);
+            _mm_storeu_si128((__m128i *)dst + 2, chorba6);
+            _mm_storeu_si128((__m128i *)dst + 3, chorba5);
+            _mm_storeu_si128((__m128i *)dst + 4, chorba4);
+            _mm_storeu_si128((__m128i *)dst + 5, chorba3);
+            _mm_storeu_si128((__m128i *)dst + 6, chorba2);
+            _mm_storeu_si128((__m128i *)dst + 7, chorba1);
+            dst += 16*8;
+        }
+
+        chorba2 = _mm_xor_si128(chorba2, chorba8);
+        chorba1 = _mm_xor_si128(chorba1, chorba7);
+        src += 16*8;
+        len -= 16*8;
+
+        xmm_t0 = _mm_load_si128((__m128i *)src);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 1);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 2);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 3);
+
+        fold_12(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = z128_xor3_epi64(xmm_t0, chorba6, xmm_crc0);
+        xmm_crc1 = _mm_xor_si128(z128_xor3_epi64(xmm_t1, chorba5, chorba8), xmm_crc1);
+        xmm_crc2 = z128_xor3_epi64(z128_xor3_epi64(xmm_t2, chorba4, chorba8), chorba7, xmm_crc2);
+        xmm_crc3 = z128_xor3_epi64(z128_xor3_epi64(xmm_t3, chorba3, chorba7), chorba6, xmm_crc3);
+
+        xmm_t0 = _mm_load_si128((__m128i *)src + 4);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 5);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 6);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 7);
+
+        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = z128_xor3_epi64(z128_xor3_epi64(xmm_t0, chorba2, chorba6), chorba5, xmm_crc0);
+        xmm_crc1 = z128_xor3_epi64(z128_xor3_epi64(xmm_t1, chorba1, chorba4), chorba5, xmm_crc1);
+        xmm_crc2 = _mm_xor_si128(z128_xor3_epi64(xmm_t2, chorba3, chorba4), xmm_crc2);
+        xmm_crc3 = _mm_xor_si128(z128_xor3_epi64(xmm_t3, chorba2, chorba3), xmm_crc3);
+
+        xmm_t0 = _mm_load_si128((__m128i *)src + 8);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 9);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 10);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 11);
+
+        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = z128_xor3_epi64(z128_xor3_epi64(xmm_t0, chorba1, chorba2), chorba8, xmm_crc0);
+        xmm_crc1 = _mm_xor_si128(z128_xor3_epi64(xmm_t1, chorba1, chorba7), xmm_crc1);
+        xmm_crc2 = z128_xor3_epi64(xmm_t2, chorba6, xmm_crc2);
+        xmm_crc3 = z128_xor3_epi64(xmm_t3, chorba5, xmm_crc3);
+
+        xmm_t0 = _mm_load_si128((__m128i *)src + 12);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 13);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 14);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 15);
+
+        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = _mm_xor_si128(z128_xor3_epi64(xmm_t0, chorba4, chorba8), xmm_crc0);
+        xmm_crc1 = z128_xor3_epi64(z128_xor3_epi64(xmm_t1, chorba3, chorba8), chorba7, xmm_crc1);
+        xmm_crc2 = _mm_xor_si128(z128_xor3_epi64(z128_xor3_epi64(xmm_t2, chorba2, chorba8), chorba7, chorba6), xmm_crc2);
+        xmm_crc3 = _mm_xor_si128(z128_xor3_epi64(z128_xor3_epi64(xmm_t3, chorba1, chorba7), chorba6, chorba5), xmm_crc3);
+
+        xmm_t0 = _mm_load_si128((__m128i *)src + 16);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 17);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 18);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 19);
+
+        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = _mm_xor_si128(z128_xor3_epi64(z128_xor3_epi64(xmm_t0, chorba4, chorba8), chorba6, chorba5), xmm_crc0);
+        xmm_crc1 = z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t1, chorba3, chorba4), chorba8, chorba7), chorba5, xmm_crc1);
+        xmm_crc2 = z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t2, chorba2, chorba3), chorba4, chorba7), chorba6, xmm_crc2);
+        xmm_crc3 = _mm_xor_si128(z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t3, chorba1, chorba2), chorba3, chorba8), chorba6, chorba5), xmm_crc3);
+
+        xmm_t0 = _mm_load_si128((__m128i *)src + 20);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 21);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 22);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 23);
+
+        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = _mm_xor_si128(z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t0, chorba1, chorba2), chorba4, chorba8), chorba7, chorba5), xmm_crc0);
+        xmm_crc1 = z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t1, chorba1, chorba3), chorba4, chorba7), chorba6, xmm_crc1);
+        xmm_crc2 = z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t2, chorba2, chorba3), chorba8, chorba6), chorba5, xmm_crc2);
+        xmm_crc3 = _mm_xor_si128(z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t3, chorba1, chorba2), chorba4, chorba8), chorba7, chorba5), xmm_crc3);
+
+        xmm_t0 = _mm_load_si128((__m128i *)src + 24);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 25);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 26);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 27);
+
+        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = _mm_xor_si128(z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t0, chorba1, chorba3), chorba4, chorba8), chorba7, chorba6), xmm_crc0);
+        xmm_crc1 = z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t1, chorba2, chorba3), chorba7, chorba6), chorba5, xmm_crc1);
+        xmm_crc2 = z128_xor3_epi64(z128_xor3_epi64(z128_xor3_epi64(xmm_t2, chorba1, chorba2), chorba4, chorba6), chorba5, xmm_crc2);
+        xmm_crc3 = _mm_xor_si128(z128_xor3_epi64(z128_xor3_epi64(xmm_t3, chorba1, chorba3), chorba4, chorba5), xmm_crc3);
+
+        xmm_t0 = _mm_load_si128((__m128i *)src + 28);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 29);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 30);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 31);
+
+        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = z128_xor3_epi64(z128_xor3_epi64(xmm_t0, chorba2, chorba3), chorba4, xmm_crc0);
+        xmm_crc1 = z128_xor3_epi64(z128_xor3_epi64(xmm_t1, chorba1, chorba2), chorba3, xmm_crc1);
+        xmm_crc2 = _mm_xor_si128(z128_xor3_epi64(xmm_t2, chorba1, chorba2), xmm_crc2);
+        xmm_crc3 = z128_xor3_epi64(xmm_t3, chorba1, xmm_crc3);
+
+        len -= 512;
+        src += 512;
+    }
+#ifndef __AVX512VL__
+    }
+#endif
 
-    xmm_crc0 = xmm_crc3;
-    xmm_crc3 = _mm_slli_si128(xmm_crc3, 4);
-    xmm_crc3 = _mm_clmulepi64_si128(xmm_crc3, crc_fold, 0x10);
-    xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_crc0);
-    xmm_crc3 = _mm_and_si128(xmm_crc3, xmm_mask2);
+#endif  /* X86_VPCLMULQDQ */
+
+    while (len >= 64) {
+        len -= 64;
+        xmm_t0 = _mm_load_si128((__m128i *)src);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 1);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 2);
+        xmm_t3 = _mm_load_si128((__m128i *)src + 3);
+        src += 64;
+
+        fold_4(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            _mm_storeu_si128((__m128i *)dst + 3, xmm_t3);
+            dst += 64;
+        }
+
+        xmm_crc0 = _mm_xor_si128(xmm_crc0, xmm_t0);
+        xmm_crc1 = _mm_xor_si128(xmm_crc1, xmm_t1);
+        xmm_crc2 = _mm_xor_si128(xmm_crc2, xmm_t2);
+        xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t3);
+    }
 
     /*
-     * k7
+     * len = num bytes left - 64
      */
-    xmm_crc1 = xmm_crc3;
-    xmm_crc2 = xmm_crc3;
-    crc_fold = _mm_load_si128((__m128i *)(crc_k + 8));
-
-    xmm_crc3 = _mm_clmulepi64_si128(xmm_crc3, crc_fold, 0);
-    xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_crc2);
-    xmm_crc3 = _mm_and_si128(xmm_crc3, xmm_mask);
-
-    xmm_crc2 = xmm_crc3;
-    xmm_crc3 = _mm_clmulepi64_si128(xmm_crc3, crc_fold, 0x10);
-    xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_crc2);
-    xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_crc1);
+    if (len >= 48) {
+        len -= 48;
+
+        xmm_t0 = _mm_load_si128((__m128i *)src);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 1);
+        xmm_t2 = _mm_load_si128((__m128i *)src + 2);
+        src += 48;
+
+        fold_3(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            _mm_storeu_si128((__m128i *)dst + 2, xmm_t2);
+            dst += 48;
+        }
+
+        xmm_crc1 = _mm_xor_si128(xmm_crc1, xmm_t0);
+        xmm_crc2 = _mm_xor_si128(xmm_crc2, xmm_t1);
+        xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t2);
+    } else if (len >= 32) {
+        len -= 32;
+
+        xmm_t0 = _mm_load_si128((__m128i *)src);
+        xmm_t1 = _mm_load_si128((__m128i *)src + 1);
+        src += 32;
+
+        fold_2(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            _mm_storeu_si128((__m128i *)dst + 1, xmm_t1);
+            dst += 32;
+        }
+
+        xmm_crc2 = _mm_xor_si128(xmm_crc2, xmm_t0);
+        xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t1);
+    } else if (len >= 16) {
+        len -= 16;
+        xmm_t0 = _mm_load_si128((__m128i *)src);
+        src += 16;
+
+        fold_1(&xmm_crc0, &xmm_crc1, &xmm_crc2, &xmm_crc3, xmm_fold4);
+        if (COPY) {
+            _mm_storeu_si128((__m128i *)dst, xmm_t0);
+            dst += 16;
+        }
+
+        xmm_crc3 = _mm_xor_si128(xmm_crc3, xmm_t0);
+    }
 
-    crc->value = ~((uint32_t)_mm_extract_epi32(xmm_crc3, 2));
+    const __m128i k12 = _mm_set_epi32(0x00000001, 0x751997d0, 0x00000000, 0xccaa009e);
+    const __m128i barrett_k = _mm_set_epi32(0x00000001, 0xdb710640, 0xb4e5b025, 0xf7011641);
+
+    /* Fold 4x128-bit into a single 128-bit value using k1/k2 constants */
+    __m128i x_low0  = _mm_clmulepi64_si128(xmm_crc0, k12, 0x01);
+    __m128i x_high0 = _mm_clmulepi64_si128(xmm_crc0, k12, 0x10);
+    xmm_crc1 = z128_xor3_epi64(xmm_crc1, x_low0, x_high0);
+
+    __m128i x_low1  = _mm_clmulepi64_si128(xmm_crc1, k12, 0x01);
+    __m128i x_high1 = _mm_clmulepi64_si128(xmm_crc1, k12, 0x10);
+    xmm_crc2 = z128_xor3_epi64(xmm_crc2, x_low1, x_high1);
+
+    __m128i x_low2  = _mm_clmulepi64_si128(xmm_crc2, k12, 0x01);
+    __m128i x_high2 = _mm_clmulepi64_si128(xmm_crc2, k12, 0x10);
+    xmm_crc3 = z128_xor3_epi64(xmm_crc3, x_low2, x_high2);
+
+    /* Fold remaining bytes into the 128-bit state */
+    if (len) {
+        const __m128i xmm_mask3 = _mm_set1_epi32((int32_t)0x80808080);
+        const __m128i xmm_seq = _mm_setr_epi8(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15);
+
+        /* Create masks to shift bytes for partial input */
+        __m128i xmm_shl = _mm_add_epi8(xmm_seq, _mm_set1_epi8((char)len - 16));
+        __m128i xmm_shr = _mm_xor_si128(xmm_shl, xmm_mask3);
+
+        /* Shift out bytes from crc3 to make space for new data */
+        __m128i xmm_overflow = _mm_shuffle_epi8(xmm_crc3, xmm_shl);
+        xmm_crc3 = _mm_shuffle_epi8(xmm_crc3, xmm_shr);
+
+        /* Insert the partial input into crc3 */
+#if defined(__AVX512BW__) && defined(__AVX512VL__)
+        __mmask16 k = (1 << len) - 1;
+        __m128i xmm_crc_part = _mm_maskz_loadu_epi8(k, src);
+        if (COPY) {
+            _mm_mask_storeu_epi8(dst, k, xmm_crc_part);
+        }
+#else
+        __m128i xmm_crc_part = _mm_setzero_si128();
+        memcpy(&xmm_crc_part, src, len);
+        if (COPY) {
+            memcpy(dst, src, len);
+        }
+#endif
+        __m128i part_aligned = _mm_shuffle_epi8(xmm_crc_part, xmm_shl);
+        xmm_crc3 = _mm_xor_si128(xmm_crc3, part_aligned);
 
-    return crc->value;
-}
+        /* Fold the bytes that were shifted out back into crc3 */
+        __m128i ovf_low  = _mm_clmulepi64_si128(xmm_overflow, k12, 0x01);
+        __m128i ovf_high = _mm_clmulepi64_si128(xmm_overflow, k12, 0x10);
+        xmm_crc3 = z128_xor3_epi64(xmm_crc3, ovf_low, ovf_high);
+    }
 
-static inline uint32_t crc32_small(uint32_t crc, const uint8_t *buf, size_t len) {
-    uint32_t c = (~crc) & 0xffffffff;
+    /* Reduce 128-bits to 32-bits using two-stage Barrett reduction */
+    __m128i x_tmp0 = _mm_clmulepi64_si128(xmm_crc3, barrett_k, 0x00);
+    __m128i x_tmp1 = _mm_clmulepi64_si128(x_tmp0, barrett_k, 0x10);
 
-    while (len) {
-        len--;
-        DO1;
-    }
+    x_tmp1 = _mm_blend_epi16(x_tmp1, _mm_setzero_si128(), 0xcf);
+    x_tmp0 = _mm_xor_si128(x_tmp1, xmm_crc3);
 
-    return c ^ 0xffffffff;
-}
+    __m128i x_res_a = _mm_clmulepi64_si128(x_tmp0, barrett_k, 0x01);
+    __m128i x_res_b = _mm_clmulepi64_si128(x_res_a, barrett_k, 0x10);
 
-Z_INTERNAL uint32_t CRC32(uint32_t crc32, const uint8_t *buf, size_t len) {
-    /* For lens smaller than ~12, crc32_small method is faster.
-     * But there are also minimum requirements for the pclmul functions due to alignment */
-    if (len < 16)
-        return crc32_small(crc32, buf, len);
+    crc = ((uint32_t)_mm_extract_epi32(x_res_b, 2));
 
-    crc32_fold ALIGNED_(16) crc_state;
-    CRC32_FOLD_RESET(&crc_state);
-    CRC32_FOLD(&crc_state, buf, len, crc32);
-    return CRC32_FOLD_FINAL(&crc_state);
+    return ~crc;
 }
diff --git a/arch/x86/crc32_vpclmulqdq.c b/arch/x86/crc32_vpclmulqdq.c
index cad35b14..793d8ab9 100644
--- a/arch/x86/crc32_vpclmulqdq.c
+++ b/arch/x86/crc32_vpclmulqdq.c
@@ -6,12 +6,13 @@
 #ifdef X86_VPCLMULQDQ_CRC
 
 #define X86_VPCLMULQDQ
-#define CRC32_FOLD_COPY  crc32_fold_vpclmulqdq_copy
-#define CRC32_FOLD       crc32_fold_vpclmulqdq
-#define CRC32_FOLD_RESET crc32_fold_vpclmulqdq_reset
-#define CRC32_FOLD_FINAL crc32_fold_vpclmulqdq_final
-#define CRC32            crc32_vpclmulqdq
-
 #include "crc32_pclmulqdq_tpl.h"
 
+Z_INTERNAL uint32_t crc32_vpclmulqdq(uint32_t crc, const uint8_t *buf, size_t len) {
+    return crc32_copy_impl(crc, NULL, buf, len, 0);
+}
+
+Z_INTERNAL uint32_t crc32_copy_vpclmulqdq(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    return crc32_copy_impl(crc, dst, src, len, 1);
+}
 #endif
diff --git a/arch/x86/slide_hash_avx2.c b/arch/x86/slide_hash_avx2.c
index f49ad333..10000123 100644
--- a/arch/x86/slide_hash_avx2.c
+++ b/arch/x86/slide_hash_avx2.c
@@ -21,9 +21,9 @@ static inline void slide_hash_chain(Pos *table, uint32_t entries, const __m256i
     do {
         __m256i value, result;
 
-        value = _mm256_loadu_si256((__m256i *)table);
+        value = _mm256_load_si256((__m256i *)table);
         result = _mm256_subs_epu16(value, wsize);
-        _mm256_storeu_si256((__m256i *)table, result);
+        _mm256_store_si256((__m256i *)table, result);
 
         table -= 16;
         entries -= 16;
@@ -31,6 +31,7 @@ static inline void slide_hash_chain(Pos *table, uint32_t entries, const __m256i
 }
 
 Z_INTERNAL void slide_hash_avx2(deflate_state *s) {
+    Assert(s->w_size <= UINT16_MAX, "w_size should fit in uint16_t");
     uint16_t wsize = (uint16_t)s->w_size;
     const __m256i ymm_wsize = _mm256_set1_epi16((short)wsize);
 
diff --git a/arch/x86/slide_hash_sse2.c b/arch/x86/slide_hash_sse2.c
index cfdf7bee..6900a59d 100644
--- a/arch/x86/slide_hash_sse2.c
+++ b/arch/x86/slide_hash_sse2.c
@@ -52,6 +52,7 @@ next_chain:
 }
 
 Z_INTERNAL void slide_hash_sse2(deflate_state *s) {
+    Assert(s->w_size <= UINT16_MAX, "w_size should fit in uint16_t");
     uint16_t wsize = (uint16_t)s->w_size;
     const __m128i xmm_wsize = _mm_set1_epi16((short)wsize);
 
diff --git a/arch/x86/x86_features.c b/arch/x86/x86_features.c
index 58cb4df3..bed1df3d 100644
--- a/arch/x86/x86_features.c
+++ b/arch/x86/x86_features.c
@@ -10,9 +10,10 @@
 #include "zbuild.h"
 #include "x86_features.h"
 
-#ifdef _MSC_VER
-#  include <intrin.h>
-#else
+
+#if defined(HAVE_CPUID_MS)
+#   include <intrin.h>
+#elif defined(HAVE_CPUID_GNU)
 // Newer versions of GCC and clang come with cpuid.h
 #  include <cpuid.h>
 #  ifdef X86_HAVE_XSAVE_INTRIN
@@ -27,7 +28,7 @@
 #include <string.h>
 
 static inline void cpuid(int info, unsigned* eax, unsigned* ebx, unsigned* ecx, unsigned* edx) {
-#ifdef _MSC_VER
+#if defined(HAVE_CPUID_MS)
     unsigned int registers[4];
     __cpuid((int *)registers, info);
 
@@ -35,14 +36,17 @@ static inline void cpuid(int info, unsigned* eax, unsigned* ebx, unsigned* ecx,
     *ebx = registers[1];
     *ecx = registers[2];
     *edx = registers[3];
-#else
+#elif defined(HAVE_CPUID_GNU)
     *eax = *ebx = *ecx = *edx = 0;
     __cpuid(info, *eax, *ebx, *ecx, *edx);
+#else
+    /* When using this fallback, the faster SSE/AVX code is disabled */
+    *eax = *ebx = *ecx = *edx = 0;
 #endif
 }
 
 static inline void cpuidex(int info, int subinfo, unsigned* eax, unsigned* ebx, unsigned* ecx, unsigned* edx) {
-#ifdef _MSC_VER
+#if defined(HAVE_CPUID_MS)
     unsigned int registers[4];
     __cpuidex((int *)registers, info, subinfo);
 
@@ -50,19 +54,25 @@ static inline void cpuidex(int info, int subinfo, unsigned* eax, unsigned* ebx,
     *ebx = registers[1];
     *ecx = registers[2];
     *edx = registers[3];
-#else
+#elif defined(HAVE_CPUID_GNU)
     *eax = *ebx = *ecx = *edx = 0;
     __cpuid_count(info, subinfo, *eax, *ebx, *ecx, *edx);
+#else
+    /* When using this fallback, the faster SSE/AVX code is disabled */
+    *eax = *ebx = *ecx = *edx = 0;
 #endif
 }
 
 static inline uint64_t xgetbv(unsigned int xcr) {
 #if defined(_MSC_VER) || defined(X86_HAVE_XSAVE_INTRIN)
     return _xgetbv(xcr);
-#else
+#elif defined(__GNUC__)
     uint32_t eax, edx;
     __asm__ ( ".byte 0x0f, 0x01, 0xd0" : "=a"(eax), "=d"(edx) : "c"(xcr));
     return (uint64_t)(edx) << 32 | eax;
+#else
+    /* When using this fallback, some of the faster code is disabled */
+    return 0;
 #endif
 }
 
@@ -75,6 +85,7 @@ void Z_INTERNAL x86_check_features(struct x86_cpu_features *features) {
 
     features->has_sse2 = edx & 0x4000000;
     features->has_ssse3 = ecx & 0x200;
+    features->has_sse41 = ecx & 0x80000;
     features->has_sse42 = ecx & 0x100000;
     features->has_pclmulqdq = ecx & 0x2;
 
@@ -86,11 +97,11 @@ void Z_INTERNAL x86_check_features(struct x86_cpu_features *features) {
     }
 
     if (maxbasic >= 7) {
+        // Reference: https://software.intel.com/sites/default/files/article/405250/how-to-detect-new-instruction-support-in-the-4th-generation-intel-core-processor-family.pdf
         cpuidex(7, 0, &eax, &ebx, &ecx, &edx);
 
-        // check BMI1 bit
-        // Reference: https://software.intel.com/sites/default/files/article/405250/how-to-detect-new-instruction-support-in-the-4th-generation-intel-core-processor-family.pdf
-        features->has_vpclmulqdq = ecx & 0x400;
+        // check BMI2 bit
+        features->has_bmi2 = ebx & 0x100;
 
         // check AVX2 bit if the OS supports saving YMM registers
         if (features->has_os_save_ymm) {
@@ -108,8 +119,9 @@ void Z_INTERNAL x86_check_features(struct x86_cpu_features *features) {
                 features->has_avx512vl = ebx & 0x80000000;
             }
             features->has_avx512_common = features->has_avx512f && features->has_avx512dq && features->has_avx512bw \
-              && features->has_avx512vl;
+              && features->has_avx512vl && features->has_bmi2;
             features->has_avx512vnni = ecx & 0x800;
+            features->has_vpclmulqdq = ecx & 0x400;
         }
     }
 }
diff --git a/arch/x86/x86_features.h b/arch/x86/x86_features.h
index 6daa5e38..2118b8e8 100644
--- a/arch/x86/x86_features.h
+++ b/arch/x86/x86_features.h
@@ -14,8 +14,10 @@ struct x86_cpu_features {
     int has_avx512vl;
     int has_avx512_common; // Enabled when AVX512(F,DQ,BW,VL) are all enabled.
     int has_avx512vnni;
+    int has_bmi2;
     int has_sse2;
     int has_ssse3;
+    int has_sse41;
     int has_sse42;
     int has_pclmulqdq;
     int has_vpclmulqdq;
diff --git a/arch/x86/x86_functions.h b/arch/x86/x86_functions.h
index 5aa9b317..9523ec0d 100644
--- a/arch/x86/x86_functions.h
+++ b/arch/x86/x86_functions.h
@@ -6,75 +6,90 @@
 #ifndef X86_FUNCTIONS_H_
 #define X86_FUNCTIONS_H_
 
+/* So great news, your compiler is broken and causes stack smashing. Rather than
+ * notching out its compilation we'll just remove the assignment in the functable.
+ * Further context:
+ * https://developercommunity.visualstudio.com/t/Stack-corruption-with-v142-toolchain-whe/10853479 */
+#if defined(_MSC_VER) && defined(ARCH_32BIT) && _MSC_VER >= 1920 && _MSC_VER <= 1929
+#define NO_CHORBA_SSE
+#endif
+
 #ifdef X86_SSE2
-uint32_t chunksize_sse2(void);
-uint8_t* chunkmemset_safe_sse2(uint8_t *out, unsigned dist, unsigned len, unsigned left);
+uint8_t* chunkmemset_safe_sse2(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
 
 #  ifdef HAVE_BUILTIN_CTZ
     uint32_t compare256_sse2(const uint8_t *src0, const uint8_t *src1);
-    uint32_t longest_match_sse2(deflate_state *const s, Pos cur_match);
-    uint32_t longest_match_slow_sse2(deflate_state *const s, Pos cur_match);
-    void slide_hash_sse2(deflate_state *s);
+    uint32_t longest_match_sse2(deflate_state *const s, uint32_t cur_match);
+    uint32_t longest_match_slow_sse2(deflate_state *const s, uint32_t cur_match);
 #  endif
+    void slide_hash_sse2(deflate_state *s);
     void inflate_fast_sse2(PREFIX3(stream)* strm, uint32_t start);
+#  if !defined(WITHOUT_CHORBA_SSE)
+    uint32_t crc32_chorba_sse2(uint32_t crc, const uint8_t *buf, size_t len);
+    uint32_t crc32_copy_chorba_sse2(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+    uint32_t chorba_small_nondestructive_sse2(uint32_t c, const uint64_t *aligned_buf, size_t aligned_len);
+#  endif
 #endif
 
 #ifdef X86_SSSE3
 uint32_t adler32_ssse3(uint32_t adler, const uint8_t *buf, size_t len);
-uint8_t* chunkmemset_safe_ssse3(uint8_t *out, unsigned dist, unsigned len, unsigned left);
+uint32_t adler32_copy_ssse3(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+uint8_t* chunkmemset_safe_ssse3(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
 void inflate_fast_ssse3(PREFIX3(stream) *strm, uint32_t start);
 #endif
 
+#if defined(X86_SSE41) && !defined(WITHOUT_CHORBA_SSE)
+    uint32_t crc32_chorba_sse41(uint32_t crc, const uint8_t *buf, size_t len);
+    uint32_t crc32_copy_chorba_sse41(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
+#endif
+
 #ifdef X86_SSE42
-uint32_t adler32_fold_copy_sse42(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+uint32_t adler32_copy_sse42(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
 #endif
 
 #ifdef X86_AVX2
 uint32_t adler32_avx2(uint32_t adler, const uint8_t *buf, size_t len);
-uint32_t adler32_fold_copy_avx2(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
-uint32_t chunksize_avx2(void);
-uint8_t* chunkmemset_safe_avx2(uint8_t *out, unsigned dist, unsigned len, unsigned left);
+uint32_t adler32_copy_avx2(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+uint8_t* chunkmemset_safe_avx2(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
 
 #  ifdef HAVE_BUILTIN_CTZ
     uint32_t compare256_avx2(const uint8_t *src0, const uint8_t *src1);
-    uint32_t longest_match_avx2(deflate_state *const s, Pos cur_match);
-    uint32_t longest_match_slow_avx2(deflate_state *const s, Pos cur_match);
-    void slide_hash_avx2(deflate_state *s);
+    uint32_t longest_match_avx2(deflate_state *const s, uint32_t cur_match);
+    uint32_t longest_match_slow_avx2(deflate_state *const s, uint32_t cur_match);
 #  endif
+    void slide_hash_avx2(deflate_state *s);
     void inflate_fast_avx2(PREFIX3(stream)* strm, uint32_t start);
 #endif
 #ifdef X86_AVX512
 uint32_t adler32_avx512(uint32_t adler, const uint8_t *buf, size_t len);
-uint32_t adler32_fold_copy_avx512(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+uint32_t adler32_copy_avx512(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+uint8_t* chunkmemset_safe_avx512(uint8_t *out, uint8_t *from, unsigned len, unsigned left);
+void inflate_fast_avx512(PREFIX3(stream)* strm, uint32_t start);
+#  ifdef HAVE_BUILTIN_CTZLL
+    uint32_t compare256_avx512(const uint8_t *src0, const uint8_t *src1);
+    uint32_t longest_match_avx512(deflate_state *const s, uint32_t cur_match);
+    uint32_t longest_match_slow_avx512(deflate_state *const s, uint32_t cur_match);
+#  endif
 #endif
 #ifdef X86_AVX512VNNI
 uint32_t adler32_avx512_vnni(uint32_t adler, const uint8_t *buf, size_t len);
-uint32_t adler32_fold_copy_avx512_vnni(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+uint32_t adler32_copy_avx512_vnni(uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
 #endif
 
 #ifdef X86_PCLMULQDQ_CRC
-uint32_t crc32_fold_pclmulqdq_reset(crc32_fold *crc);
-void     crc32_fold_pclmulqdq_copy(crc32_fold *crc, uint8_t *dst, const uint8_t *src, size_t len);
-void     crc32_fold_pclmulqdq(crc32_fold *crc, const uint8_t *src, size_t len, uint32_t init_crc);
-uint32_t crc32_fold_pclmulqdq_final(crc32_fold *crc);
-uint32_t crc32_pclmulqdq(uint32_t crc32, const uint8_t *buf, size_t len);
+uint32_t crc32_pclmulqdq(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_pclmulqdq(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
 #endif
 #ifdef X86_VPCLMULQDQ_CRC
-uint32_t crc32_fold_vpclmulqdq_reset(crc32_fold *crc);
-void     crc32_fold_vpclmulqdq_copy(crc32_fold *crc, uint8_t *dst, const uint8_t *src, size_t len);
-void     crc32_fold_vpclmulqdq(crc32_fold *crc, const uint8_t *src, size_t len, uint32_t init_crc);
-uint32_t crc32_fold_vpclmulqdq_final(crc32_fold *crc);
-uint32_t crc32_vpclmulqdq(uint32_t crc32, const uint8_t *buf, size_t len);
+uint32_t crc32_vpclmulqdq(uint32_t crc, const uint8_t *buf, size_t len);
+uint32_t crc32_copy_vpclmulqdq(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
 #endif
 
-
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 // X86 - SSE2
-#  if (defined(X86_SSE2) && defined(__SSE2__)) || defined(__x86_64__) || defined(_M_X64) || defined(X86_NOCHECK_SSE2)
+#  if (defined(X86_SSE2) && defined(__SSE2__)) || (defined(ARCH_X86) && defined(ARCH_64BIT))
 #    undef native_chunkmemset_safe
 #    define native_chunkmemset_safe chunkmemset_safe_sse2
-#    undef native_chunksize
-#    define native_chunksize chunksize_sse2
 #    undef native_inflate_fast
 #    define native_inflate_fast inflate_fast_sse2
 #    undef native_slide_hash
@@ -86,46 +101,50 @@ uint32_t crc32_vpclmulqdq(uint32_t crc32, const uint8_t *buf, size_t len);
 #      define native_longest_match longest_match_sse2
 #      undef native_longest_match_slow
 #      define native_longest_match_slow longest_match_slow_sse2
+#      if !defined(WITHOUT_CHORBA_SSE)
+#        undef native_crc32
+#        define native_crc32 crc32_chorba_sse2
+#      endif
 #    endif
-#endif
+#  endif
 // X86 - SSSE3
 #  if defined(X86_SSSE3) && defined(__SSSE3__)
 #    undef native_adler32
 #    define native_adler32 adler32_ssse3
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_ssse3
 #    undef native_chunkmemset_safe
 #    define native_chunkmemset_safe chunkmemset_safe_ssse3
 #    undef native_inflate_fast
 #    define native_inflate_fast inflate_fast_ssse3
 #  endif
+// X86 - SSE4.1
+#  if defined(X86_SSE41) && defined(__SSE4_1__) && !defined(WITHOUT_CHORBA_SSE)
+#   undef native_crc32
+#   define native_crc32 crc32_chorba_sse41
+#   undef native_crc32_copy
+#   define native_crc32_copy crc32_copy_chorba_sse41
+#  endif
 // X86 - SSE4.2
 #  if defined(X86_SSE42) && defined(__SSE4_2__)
-#    undef native_adler32_fold_copy
-#    define native_adler32_fold_copy adler32_fold_copy_sse42
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_sse42
 #  endif
-
 // X86 - PCLMUL
-#if defined(X86_PCLMULQDQ_CRC) && defined(__PCLMUL__)
-#  undef native_crc32
-#  define native_crc32 crc32_pclmulqdq
-#  undef native_crc32_fold
-#  define native_crc32_fold crc32_fold_pclmulqdq
-#  undef native_crc32_fold_copy
-#  define native_crc32_fold_copy crc32_fold_pclmulqdq_copy
-#  undef native_crc32_fold_final
-#  define native_crc32_fold_final crc32_fold_pclmulqdq_final
-#  undef native_crc32_fold_reset
-#  define native_crc32_fold_reset crc32_fold_pclmulqdq_reset
-#endif
-// X86 - AVX
+#  if defined(X86_PCLMULQDQ_CRC) && defined(__PCLMUL__)
+#    undef native_crc32
+#    define native_crc32 crc32_pclmulqdq
+#    undef native_crc32_copy
+#    define native_crc32_copy crc32_copy_pclmulqdq
+#  endif
+// X86 - AVX2
 #  if defined(X86_AVX2) && defined(__AVX2__)
 #    undef native_adler32
 #    define native_adler32 adler32_avx2
-#    undef native_adler32_fold_copy
-#    define native_adler32_fold_copy adler32_fold_copy_avx2
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_avx2
 #    undef native_chunkmemset_safe
 #    define native_chunkmemset_safe chunkmemset_safe_avx2
-#    undef native_chunksize
-#    define native_chunksize chunksize_avx2
 #    undef native_inflate_fast
 #    define native_inflate_fast inflate_fast_avx2
 #    undef native_slide_hash
@@ -139,32 +158,37 @@ uint32_t crc32_vpclmulqdq(uint32_t crc32, const uint8_t *buf, size_t len);
 #      define native_longest_match_slow longest_match_slow_avx2
 #    endif
 #  endif
-
 // X86 - AVX512 (F,DQ,BW,Vl)
 #  if defined(X86_AVX512) && defined(__AVX512F__) && defined(__AVX512DQ__) && defined(__AVX512BW__) && defined(__AVX512VL__)
 #    undef native_adler32
 #    define native_adler32 adler32_avx512
-#    undef native_adler32_fold_copy
-#    define native_adler32_fold_copy adler32_fold_copy_avx512
+#    undef native_adler32_copy
+#    define native_adler32_copy adler32_copy_avx512
+#    undef native_chunkmemset_safe
+#    define native_chunkmemset_safe chunkmemset_safe_avx512
+#    undef native_inflate_fast
+#    define native_inflate_fast inflate_fast_avx512
+#    ifdef HAVE_BUILTIN_CTZLL
+#      undef native_compare256
+#      define native_compare256 compare256_avx512
+#      undef native_longest_match
+#      define native_longest_match longest_match_avx512
+#      undef native_longest_match_slow
+#      define native_longest_match_slow longest_match_slow_avx512
+#    endif
 // X86 - AVX512 (VNNI)
 #    if defined(X86_AVX512VNNI) && defined(__AVX512VNNI__)
 #      undef native_adler32
 #      define native_adler32 adler32_avx512_vnni
-#      undef native_adler32_fold_copy
-#      define native_adler32_fold_copy adler32_fold_copy_avx512_vnni
+#      undef native_adler32_copy
+#      define native_adler32_copy adler32_copy_avx512_vnni
 #    endif
 // X86 - VPCLMULQDQ
 #    if defined(__PCLMUL__) && defined(__AVX512F__) && defined(__VPCLMULQDQ__)
 #      undef native_crc32
 #      define native_crc32 crc32_vpclmulqdq
-#      undef native_crc32_fold
-#      define native_crc32_fold crc32_fold_vpclmulqdq
-#      undef native_crc32_fold_copy
-#      define native_crc32_fold_copy crc32_fold_vpclmulqdq_copy
-#      undef native_crc32_fold_final
-#      define native_crc32_fold_final crc32_fold_vpclmulqdq_final
-#      undef native_crc32_fold_reset
-#      define native_crc32_fold_reset crc32_fold_vpclmulqdq_reset
+#      undef native_crc32_copy
+#      define native_crc32_copy crc32_copy_vpclmulqdq
 #    endif
 #  endif
 #endif
diff --git a/arch/x86/x86_intrins.h b/arch/x86/x86_intrins.h
index 0e596d18..1d1df5eb 100644
--- a/arch/x86/x86_intrins.h
+++ b/arch/x86/x86_intrins.h
@@ -1,6 +1,10 @@
 #ifndef X86_INTRINS_H
 #define X86_INTRINS_H
 
+#ifdef __SSE2__
+#include <emmintrin.h>
+#endif
+
 /* Unfortunately GCC didn't support these things until version 10.
  * Similarly, AppleClang didn't support them in Xcode 9.2 but did in 9.3.
  */
@@ -84,4 +88,39 @@ static inline __m512i _mm512_zextsi128_si512(__m128i a) {
 #endif // __AVX512F__
 #endif // defined(_MSC_VER) && _MSC_VER < 1914
 
+/* Visual C++ toolchains before v142 have constant overflow in AVX512 intrinsics */
+#if defined(_MSC_VER) && defined(__AVX512F__) && !defined(_MM_K0_REG8)
+#  undef _mm512_extracti32x4_epi32
+#  define _mm512_extracti32x4_epi32(v1, e1) _mm512_maskz_extracti32x4_epi32(UINT8_MAX, v1, e1)
+#endif
+
+#if defined(_MSC_VER) && !defined(__clang__)
+#include <intrin.h>
+/* For whatever reason this intrinsic is 64 bit only with MSVC?
+ * While we don't have 64 bit GPRs, it should at least be able to move it to stack
+ * or shuffle it over 2 registers */
+#ifdef ARCH_32BIT
+/* So, while we can't move directly to a GPR, hopefully this move to
+ * a stack resident variable doesn't equate to something awful */
+static inline int64_t _mm_cvtsi128_si64(__m128i a) {
+    union { __m128i v; int64_t i; } u;
+    u.v = a;
+    return u.i;
+}
+
+static inline __m128i _mm_cvtsi64_si128(int64_t a) {
+   return _mm_set_epi64x(0, a);
+}
+#endif
+#endif
+
+#if defined(__GNUC__) && defined(ARCH_X86) && defined(ARCH_32BIT) && !defined(__clang__)
+static inline int64_t _mm_cvtsi128_si64(__m128i a) {
+    union { __m128i v; int64_t i; } u;
+    u.v = a;
+    return u.i;
+}
+#define _mm_cvtsi64_si128(a) _mm_set_epi64x(0, a)
+#endif
+
 #endif // include guard X86_INTRINS_H
diff --git a/arch_functions.h b/arch_functions.h
index 9a7f8d93..a53b2f7b 100644
--- a/arch_functions.h
+++ b/arch_functions.h
@@ -24,6 +24,8 @@
 #  include "arch/s390/s390_functions.h"
 #elif defined(RISCV_FEATURES)
 #  include "arch/riscv/riscv_functions.h"
+#elif defined(LOONGARCH_FEATURES)
+#  include "arch/loongarch/loongarch_functions.h"
 #endif
 
 #endif
diff --git a/chunkset_tpl.h b/chunkset_tpl.h
index f5cc5c04..2087e66f 100644
--- a/chunkset_tpl.h
+++ b/chunkset_tpl.h
@@ -5,12 +5,8 @@
 #include "zbuild.h"
 #include <stdlib.h>
 
-#if CHUNK_SIZE == 32 && defined(X86_SSSE3)
-extern uint8_t* chunkmemset_ssse3(uint8_t *out, unsigned dist, unsigned len);
-#endif
-
 /* Returns the chunk size */
-Z_INTERNAL uint32_t CHUNKSIZE(void) {
+static inline size_t CHUNKSIZE(void) {
     return sizeof(chunk_t);
 }
 
@@ -73,50 +69,111 @@ static inline uint8_t* CHUNKUNROLL(uint8_t *out, unsigned *dist, unsigned *len)
 static inline chunk_t GET_CHUNK_MAG(uint8_t *buf, uint32_t *chunk_rem, uint32_t dist) {
         /* This code takes string of length dist from "from" and repeats
          * it for as many times as can fit in a chunk_t (vector register) */
-        uint32_t cpy_dist;
-        uint32_t bytes_remaining = sizeof(chunk_t);
+        uint64_t cpy_dist;
+        uint64_t bytes_remaining = sizeof(chunk_t);
         chunk_t chunk_load;
         uint8_t *cur_chunk = (uint8_t *)&chunk_load;
         while (bytes_remaining) {
             cpy_dist = MIN(dist, bytes_remaining);
-            memcpy(cur_chunk, buf, cpy_dist);
+            memcpy(cur_chunk, buf, (size_t)cpy_dist);
             bytes_remaining -= cpy_dist;
             cur_chunk += cpy_dist;
             /* This allows us to bypass an expensive integer division since we're effectively
              * counting in this loop, anyway */
-            *chunk_rem = cpy_dist;
+            *chunk_rem = (uint32_t)cpy_dist;
         }
 
         return chunk_load;
 }
 #endif
 
+#if defined(HAVE_HALF_CHUNK) && !defined(HAVE_HALFCHUNKCOPY)
+static inline uint8_t* HALFCHUNKCOPY(uint8_t *out, uint8_t const *from, unsigned len) {
+    halfchunk_t chunk;
+    int32_t align = ((len - 1) % sizeof(halfchunk_t)) + 1;
+    loadhalfchunk(from, &chunk);
+    storehalfchunk(out, &chunk);
+    out += align;
+    from += align;
+    len -= align;
+    while (len > 0) {
+        loadhalfchunk(from, &chunk);
+        storehalfchunk(out, &chunk);
+        out += sizeof(halfchunk_t);
+        from += sizeof(halfchunk_t);
+        len -= sizeof(halfchunk_t);
+    }
+    return out;
+}
+#endif
+
 /* Copy DIST bytes from OUT - DIST into OUT + DIST * k, for 0 <= k < LEN/DIST.
    Return OUT + LEN. */
-Z_INTERNAL uint8_t* CHUNKMEMSET(uint8_t *out, unsigned dist, unsigned len) {
+static inline uint8_t* CHUNKMEMSET(uint8_t *out, uint8_t *from, unsigned len) {
     /* Debug performance related issues when len < sizeof(uint64_t):
        Assert(len >= sizeof(uint64_t), "chunkmemset should be called on larger chunks"); */
-    Assert(dist > 0, "chunkmemset cannot have a distance 0");
-    /* Only AVX2 */
-#if CHUNK_SIZE == 32 && defined(X86_SSSE3)
-    if (len <= 16) {
-        return chunkmemset_ssse3(out, dist, len);
-    }
-#endif
+    Assert(from != out, "chunkmemset cannot have a distance 0");
 
-    uint8_t *from = out - dist;
+    chunk_t chunk_load;
+    uint32_t chunk_mod = 0;
+    uint32_t adv_amount;
+    int64_t sdist = out - from;
+    uint64_t dist = llabs(sdist);
+
+    /* We are supporting the case for when we are reading bytes from ahead in the buffer.
+     * We now have to handle this, though it wasn't _quite_ clear if this rare circumstance
+     * always needed to be handled here or if we're just now seeing it because we are
+     * dispatching to this function, more */
+    if (sdist < 0 && dist < len) {
+#ifdef HAVE_MASKED_READWRITE
+        /* We can still handle this case if we can mitigate over writing _and_ we
+         * fit the entirety of the copy length with one load */
+        if (len <= sizeof(chunk_t)) {
+            /* Tempting to add a goto to the block below but hopefully most compilers
+             * collapse these identical code segments as one label to jump to */
+            return CHUNKCOPY(out, from, len);
+        }
+#endif
+        /* Here the memmove semantics match perfectly, as when this happens we are
+         * effectively sliding down the contents of memory by dist bytes */
+        memmove(out, from, len);
+        return out + len;
+    }
 
     if (dist == 1) {
         memset(out, *from, len);
         return out + len;
-    } else if (dist > sizeof(chunk_t)) {
-        return CHUNKCOPY(out, out - dist, len);
+    } else if (dist >= sizeof(chunk_t)) {
+        return CHUNKCOPY(out, from, len);
     }
 
-    chunk_t chunk_load;
-    uint32_t chunk_mod = 0;
+    /* Only AVX2+ as there's 128 bit vectors and 256 bit. We allow for shorter vector
+     * lengths because they serve to allow more cases to fall into chunkcopy, as the
+     * distance of the shorter length is still deemed a safe distance. We rewrite this
+     * here rather than calling the ssse3 variant directly now because doing so required
+     * dispatching to another function and broke inlining for this function entirely. We
+     * also can merge an assert and some remainder peeling behavior into the same code blocks,
+     * making the code a little smaller.  */
+#ifdef HAVE_HALF_CHUNK
+    if (len <= sizeof(halfchunk_t)) {
+        if (dist >= sizeof(halfchunk_t))
+            return HALFCHUNKCOPY(out, from, len);
+
+        if ((dist % 2) != 0 || dist == 6) {
+            halfchunk_t halfchunk_load = GET_HALFCHUNK_MAG(from, &chunk_mod, (unsigned)dist);
+
+            if (len == sizeof(halfchunk_t)) {
+                storehalfchunk(out, &halfchunk_load);
+                len -= sizeof(halfchunk_t);
+                out += sizeof(halfchunk_t);
+            }
+
+            chunk_load = halfchunk2whole(&halfchunk_load);
+            goto rem_bytes;
+        }
+    }
+#endif
 
-    /* TODO: possibly build up a permutation table for this if not an even modulus */
 #ifdef HAVE_CHUNKMEMSET_2
     if (dist == 2) {
         chunkmemset_2(from, &chunk_load);
@@ -130,36 +187,37 @@ Z_INTERNAL uint8_t* CHUNKMEMSET(uint8_t *out, unsigned dist, unsigned len) {
 #ifdef HAVE_CHUNKMEMSET_8
     if (dist == 8) {
         chunkmemset_8(from, &chunk_load);
-    } else if (dist == sizeof(chunk_t)) {
-        loadchunk(from, &chunk_load);
     } else
 #endif
-    {
-        chunk_load = GET_CHUNK_MAG(from, &chunk_mod, dist);
-    }
+#ifdef HAVE_CHUNKMEMSET_16
+    if (dist == 16) {
+        chunkmemset_16(from, &chunk_load);
+    } else
+#endif
+    chunk_load = GET_CHUNK_MAG(from, &chunk_mod, (unsigned)dist);
 
-    /* If we're lucky enough and dist happens to be an even modulus of our vector length,
-     * we can do two stores per loop iteration, which for most ISAs, especially x86, is beneficial */
-    if (chunk_mod == 0) {
-        while (len >= (2 * sizeof(chunk_t))) {
-            storechunk(out, &chunk_load);
-            storechunk(out + sizeof(chunk_t), &chunk_load);
-            out += 2 * sizeof(chunk_t);
-            len -= 2 * sizeof(chunk_t);
-        }
+    adv_amount = sizeof(chunk_t) - chunk_mod;
+
+    while (len >= (2 * sizeof(chunk_t))) {
+        storechunk(out, &chunk_load);
+        storechunk(out + adv_amount, &chunk_load);
+        out += 2 * adv_amount;
+        len -= 2 * adv_amount;
     }
 
     /* If we don't have a "dist" length that divides evenly into a vector
      * register, we can write the whole vector register but we need only
      * advance by the amount of the whole string that fits in our chunk_t.
      * If we do divide evenly into the vector length, adv_amount = chunk_t size*/
-    uint32_t adv_amount = sizeof(chunk_t) - chunk_mod;
     while (len >= sizeof(chunk_t)) {
         storechunk(out, &chunk_load);
         len -= adv_amount;
         out += adv_amount;
     }
 
+#ifdef HAVE_HALF_CHUNK
+rem_bytes:
+#endif
     if (len) {
         memcpy(out, &chunk_load, len);
         out += len;
@@ -168,33 +226,58 @@ Z_INTERNAL uint8_t* CHUNKMEMSET(uint8_t *out, unsigned dist, unsigned len) {
     return out;
 }
 
-Z_INTERNAL uint8_t* CHUNKMEMSET_SAFE(uint8_t *out, unsigned dist, unsigned len, unsigned left) {
-#if !defined(UNALIGNED64_OK)
-#  if !defined(UNALIGNED_OK)
+Z_INTERNAL uint8_t* CHUNKMEMSET_SAFE(uint8_t *out, uint8_t *from, unsigned len, unsigned left) {
+#if OPTIMAL_CMP < 32
     static const uint32_t align_mask = 7;
-#  else
+#elif OPTIMAL_CMP == 32
     static const uint32_t align_mask = 3;
-#  endif
 #endif
 
     len = MIN(len, left);
-    uint8_t *from = out - dist;
-#if !defined(UNALIGNED64_OK)
+
+#if OPTIMAL_CMP < 64
     while (((uintptr_t)out & align_mask) && (len > 0)) {
         *out++ = *from++;
         --len;
         --left;
     }
 #endif
-    if (left < (unsigned)(3 * sizeof(chunk_t))) {
+
+#ifndef HAVE_MASKED_READWRITE
+    if (UNLIKELY(left < sizeof(chunk_t))) {
         while (len > 0) {
             *out++ = *from++;
             --len;
         }
+
         return out;
     }
+#endif
+
     if (len)
-        return CHUNKMEMSET(out, dist, len);
+        out = CHUNKMEMSET(out, from, len);
 
     return out;
 }
+
+static inline uint8_t *CHUNKCOPY_SAFE(uint8_t *out, uint8_t *from, uint64_t len, uint8_t *safe)
+{
+    if (out == from)
+        return out + len;
+
+    uint64_t safelen = (safe - out);
+    len = MIN(len, safelen);
+
+#ifndef HAVE_MASKED_READWRITE
+    uint64_t from_dist = (uint64_t)llabs(safe - from);
+    if (UNLIKELY(from_dist < sizeof(chunk_t) || safelen < sizeof(chunk_t))) {
+        while (len--) {
+            *out++ = *from++;
+        }
+
+        return out;
+    }
+#endif
+
+    return CHUNKMEMSET(out, from, (unsigned)len);
+}
diff --git a/cmake/detect-arch.c b/cmake/detect-arch.c
index 92590182..6a33f8bb 100644
--- a/cmake/detect-arch.c
+++ b/cmake/detect-arch.c
@@ -8,7 +8,8 @@
     #error archfound x86_64
 
 // x86
-#elif defined(__i386) || defined(_M_IX86)
+#elif defined(__i386__) || defined(__i486__) || defined(__i586__) || defined(__i686__) || \
+      defined(__i386) || defined(_M_IX86)
     #error archfound i686
 
 // ARM
@@ -32,7 +33,7 @@
     #endif
 
 // PowerPC
-#elif defined(__powerpc__) || defined(_ppc__) || defined(__PPC__)
+#elif defined(__powerpc__) || defined(__ppc__) || defined(__PPC__)
     #if defined(__64BIT__) || defined(__powerpc64__) || defined(__ppc64__)
         #if __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__
             #error archfound powerpc64le
diff --git a/cmake/detect-arch.cmake b/cmake/detect-arch.cmake
index dfdc6013..f7ca6f1b 100644
--- a/cmake/detect-arch.cmake
+++ b/cmake/detect-arch.cmake
@@ -1,28 +1,17 @@
 # detect-arch.cmake -- Detect compiler architecture and set ARCH and BASEARCH
 # Copyright (C) 2019 Hans Kristian Rosbach
 # Licensed under the Zlib license, see LICENSE.md for details
-set(ARCHDETECT_FOUND TRUE)
-
 if(CMAKE_OSX_ARCHITECTURES)
     # If multiple architectures are requested (universal build), pick only the first
     list(GET CMAKE_OSX_ARCHITECTURES 0 ARCH)
 elseif(MSVC)
-    if("${MSVC_C_ARCHITECTURE_ID}" STREQUAL "X86")
-        set(ARCH "i686")
-    elseif("${MSVC_C_ARCHITECTURE_ID}" STREQUAL "x64")
-        set(ARCH "x86_64")
-    elseif("${MSVC_C_ARCHITECTURE_ID}" STREQUAL "ARM" OR "${MSVC_C_ARCHITECTURE_ID}" STREQUAL "ARMV7")
-        set(ARCH "arm")
-    elseif ("${MSVC_C_ARCHITECTURE_ID}" STREQUAL "ARM64" OR "${MSVC_C_ARCHITECTURE_ID}" STREQUAL "ARM64EC")
-        set(ARCH "aarch64")
-    endif()
+    set(ARCH ${MSVC_C_ARCHITECTURE_ID})
 elseif(EMSCRIPTEN)
     set(ARCH "wasm32")
 elseif(CMAKE_CROSSCOMPILING)
     set(ARCH ${CMAKE_C_COMPILER_TARGET})
 else()
     # Let preprocessor parse archdetect.c and raise an error containing the arch identifier
-    enable_language(C)
     try_run(
         run_result_unused
         compile_result_unused
@@ -47,58 +36,142 @@ else()
     message(STATUS "Arch detected: '${ARCH}'")
 endif()
 
+# Convert ARCH to lowercase
+string(TOLOWER "${ARCH}" ARCH)
+
 # Base arch detection
-if("${ARCH}" MATCHES "(x86_64|AMD64|i[3-6]86)")
+if("${ARCH}" MATCHES "(x86(_32|_64)?|amd64|x64|i[3-6]86)")
     set(BASEARCH "x86")
     set(BASEARCH_X86_FOUND TRUE)
-elseif("${ARCH}" MATCHES "(arm(v[0-9])?|aarch64|cortex)")
+    add_compile_definitions(ARCH_X86)
+    if("${ARCH}" MATCHES "(x86_64|amd64|x64)")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
+elseif("${ARCH}" MATCHES "(aarch64|arm64(ec)?|aarch32|arm(v[0-9])?|cortex)")
     set(BASEARCH "arm")
     set(BASEARCH_ARM_FOUND TRUE)
-elseif("${ARCH}" MATCHES "ppc(64(le)?)?|powerpc(64(le)?)?")
+    add_compile_definitions(ARCH_ARM)
+    if("${ARCH}" MATCHES "(aarch64|arm64(ec)?)")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
+elseif("${ARCH}" MATCHES "(ppc|powerpc)(64)?(le)?")
     set(BASEARCH "ppc")
     set(BASEARCH_PPC_FOUND TRUE)
+    add_compile_definitions(ARCH_POWER)
+    if("${ARCH}" MATCHES "(ppc|powerpc)64(le)?")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
 elseif("${ARCH}" MATCHES "alpha")
     set(BASEARCH "alpha")
     set(BASEARCH_ALPHA_FOUND TRUE)
+    add_compile_definitions(ARCH_ALPHA)
+    set(ARCH_BITS 64)
 elseif("${ARCH}" MATCHES "blackfin")
     set(BASEARCH "blackfin")
     set(BASEARCH_BLACKFIN_FOUND TRUE)
+    add_compile_definitions(ARCH_BLACKFIN)
+    set(ARCH_BITS 32)
 elseif("${ARCH}" MATCHES "ia64")
     set(BASEARCH "ia64")
     set(BASEARCH_IA64_FOUND TRUE)
-elseif("${ARCH}" MATCHES "mips")
+    add_compile_definitions(ARCH_IA64)
+    set(ARCH_BITS 64)
+elseif("${ARCH}" MATCHES "mips(isa)?(64)?")
     set(BASEARCH "mips")
     set(BASEARCH_MIPS_FOUND TRUE)
+    add_compile_definitions(ARCH_MIPS)
+    if("${ARCH}" MATCHES "mips(isa)?64")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
 elseif("${ARCH}" MATCHES "m68k")
     set(BASEARCH "m68k")
     set(BASEARCH_M68K_FOUND TRUE)
+    add_compile_definitions(ARCH_M68K)
+    set(ARCH_BITS 32)
 elseif("${ARCH}" MATCHES "sh")
     set(BASEARCH "sh")
     set(BASEARCH_SH_FOUND TRUE)
-elseif("${ARCH}" MATCHES "sparc[89]?")
+    add_compile_definitions(ARCH_SH)
+    set(ARCH_BITS 32)
+elseif("${ARCH}" MATCHES "sparc(v)?[89]?(64)?")
     set(BASEARCH "sparc")
     set(BASEARCH_SPARC_FOUND TRUE)
+    add_compile_definitions(ARCH_SPARC)
+    if("${ARCH}" MATCHES "(sparc64|sparc(v)?9)")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
 elseif("${ARCH}" MATCHES "s3[679]0x?")
     set(BASEARCH "s360")
     set(BASEARCH_S360_FOUND TRUE)
-elseif("${ARCH}" MATCHES "parisc")
+    add_compile_definitions(ARCH_S390)
+    if("${ARCH}" MATCHES "s3[679]0x")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
+elseif("${ARCH}" MATCHES "(parisc|hppa)(64)?")
     set(BASEARCH "parisc")
     set(BASEARCH_PARISC_FOUND TRUE)
+    add_compile_definitions(ARCH_PARISC)
+    if("${ARCH}" MATCHES "(parisc|hppa)64")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
 elseif("${ARCH}" MATCHES "rs6000")
     set(BASEARCH "rs6000")
     set(BASEARCH_RS6000_FOUND TRUE)
+    add_compile_definitions(ARCH_RS6000)
+    set(ARCH_BITS 32)
 elseif("${ARCH}" MATCHES "riscv(32|64)")
     set(BASEARCH "riscv")
     set(BASEARCH_RISCV_FOUND TRUE)
-elseif("${ARCH}" MATCHES "loongarch64")
+    add_compile_definitions(ARCH_RISCV)
+    if("${ARCH}" MATCHES "riscv64")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
+elseif("${ARCH}" MATCHES "(loong64|loongarch64)")
     set(BASEARCH "loongarch")
     set(BASEARCH_LOONGARCH_FOUND TRUE)
-elseif("${ARCH}" MATCHES "wasm32")
+    add_compile_definitions(ARCH_LOONGARCH)
+    set(ARCH_BITS 64)
+elseif("${ARCH}" MATCHES "wasm(32|64)")
     set(BASEARCH "wasm32")
     set(BASEARCH_WASM32_FOUND TRUE)
+    add_compile_definitions(ARCH_WASM)
+    if("${ARCH}" MATCHES "wasm64")
+        set(ARCH_BITS 64)
+    else()
+        set(ARCH_BITS 32)
+    endif()
 else()
     set(BASEARCH "x86")
     set(BASEARCH_X86_FOUND TRUE)
+    add_compile_definitions(ARCH_X86)
+    set(ARCH_BITS 32)
     message(STATUS "Basearch '${ARCH}' not recognized, defaulting to 'x86'.")
 endif()
-message(STATUS "Basearch of '${ARCH}' has been detected as: '${BASEARCH}'")
+
+if (ARCH_BITS EQUAL 64)
+    set(ARCH_64BIT TRUE)
+    set(ARCH_32BIT FALSE)
+    add_compile_definitions(ARCH_64BIT)
+else()
+    set(ARCH_64BIT FALSE)
+    set(ARCH_32BIT TRUE)
+    add_compile_definitions(ARCH_32BIT)
+endif()
+
+message(STATUS "Basearch of '${ARCH}' (${ARCH_BITS}bit) has been detected as: '${BASEARCH}'")
diff --git a/cmake/detect-coverage.cmake b/cmake/detect-coverage.cmake
index 8e67a085..1ebec71f 100644
--- a/cmake/detect-coverage.cmake
+++ b/cmake/detect-coverage.cmake
@@ -1,38 +1,42 @@
 # detect-coverage.cmake -- Detect supported compiler coverage flags
 # Licensed under the Zlib license, see LICENSE.md for details
 
+# Attempt to enable gcov-style code coverage
 macro(add_code_coverage)
-    # Check for -coverage flag support for Clang/GCC
-    if(CMAKE_VERSION VERSION_LESS 3.14)
-        set(CMAKE_REQUIRED_LIBRARIES -lgcov)
-    else()
-        set(CMAKE_REQUIRED_LINK_OPTIONS -coverage)
-    endif()
-    check_c_compiler_flag(-coverage HAVE_COVERAGE)
-    set(CMAKE_REQUIRED_LIBRARIES)
+    # Check for --coverage flag support
+    set(CMAKE_REQUIRED_LINK_OPTIONS -coverage)
+    check_c_compiler_flag("--coverage" HAVE_COVERAGE)
     set(CMAKE_REQUIRED_LINK_OPTIONS)
-
     if(HAVE_COVERAGE)
-        add_compile_options(-coverage)
-        add_link_options(-coverage)
-        message(STATUS "Code coverage enabled using: -coverage")
-    else()
-        # Some versions of GCC don't support -coverage shorthand
-        if(CMAKE_VERSION VERSION_LESS 3.14)
-            set(CMAKE_REQUIRED_LIBRARIES -lgcov)
+        # Check for --coverage -fcondition-coverage flag support
+        set(CMAKE_REQUIRED_LINK_OPTIONS -coverage -fcondition-coverage)
+        check_c_compiler_flag("--coverage -fcondition-coverage -Wno-coverage-too-many-conditions" HAVE_CONDITION_COVERAGE)
+        set(CMAKE_REQUIRED_LINK_OPTIONS)
+
+        if(HAVE_CONDITION_COVERAGE)
+            # Both --coverage and -fcondition-coverage supported
+            add_link_options(-coverage -fcondition-coverage)
+            add_compile_options(--coverage -fcondition-coverage -Wno-coverage-too-many-conditions)
+            message(STATUS "Code coverage enabled using: --coverage -fcondition-coverage")
         else()
-            set(CMAKE_REQUIRED_LINK_OPTIONS -lgcov -fprofile-arcs)
+            # Only --coverage supported.
+            add_link_options(-coverage)
+            add_compile_options(--coverage)
+            message(STATUS "Code coverage enabled using: --coverage")
         endif()
-        check_c_compiler_flag("-ftest-coverage -fprofile-arcs -fprofile-values" HAVE_TEST_COVERAGE)
-        set(CMAKE_REQUIRED_LIBRARIES)
+    else()
+        # Some versions of GCC don't support --coverage shorthand
+        set(CMAKE_REQUIRED_LINK_OPTIONS -lgcov -fprofile-arcs)
+        check_c_compiler_flag("-ftest-coverage -fprofile-arcs" HAVE_TEST_COVERAGE)
         set(CMAKE_REQUIRED_LINK_OPTIONS)
 
         if(HAVE_TEST_COVERAGE)
-            add_compile_options(-ftest-coverage -fprofile-arcs -fprofile-values)
             add_link_options(-lgcov -fprofile-arcs)
-            message(STATUS "Code coverage enabled using: -ftest-coverage")
+            add_compile_options(-ftest-coverage -fprofile-arcs)
+            message(STATUS "Code coverage enabled using: -ftest-coverage -fprofile-arcs")
         else()
-            message(WARNING "Compiler does not support code coverage")
+            # Failed to enable coverage, this is fatal to avoid silent failures in CI
+            message(FATAL_ERROR "WITH_CODE_COVERAGE requested, but unable to turn on code coverage with compiler/linker")
             set(WITH_CODE_COVERAGE OFF)
         endif()
     endif()
diff --git a/cmake/detect-intrinsics.cmake b/cmake/detect-intrinsics.cmake
index 14f82fcb..510910d2 100644
--- a/cmake/detect-intrinsics.cmake
+++ b/cmake/detect-intrinsics.cmake
@@ -1,22 +1,46 @@
 # detect-intrinsics.cmake -- Detect compiler intrinsics support
 # Licensed under the Zlib license, see LICENSE.md for details
 
-macro(check_acle_compiler_flag)
+macro(check_armv8_compiler_flag)
     if(NOT NATIVEFLAG)
         if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
             check_c_compiler_flag("-march=armv8-a+crc" HAVE_MARCH_ARMV8_CRC)
             if(HAVE_MARCH_ARMV8_CRC)
-                set(ACLEFLAG "-march=armv8-a+crc" CACHE INTERNAL "Compiler option to enable ACLE support")
+                set(ARMV8FLAG "-march=armv8-a+crc" CACHE INTERNAL "Compiler option to enable ARMv8 support")
             else()
                 check_c_compiler_flag("-march=armv8-a+crc+simd" HAVE_MARCH_ARMV8_CRC_SIMD)
                 if(HAVE_MARCH_ARMV8_CRC_SIMD)
-                    set(ACLEFLAG "-march=armv8-a+crc+simd" CACHE INTERNAL "Compiler option to enable ACLE support")
+                    set(ARMV8FLAG "-march=armv8-a+crc+simd" CACHE INTERNAL "Compiler option to enable ARMv8 support")
+                else()
+                    check_c_compiler_flag("-Wa,-march=armv8-a+crc" HAVE_WA_MARCH_ARMV8_CRC)
+                    if(HAVE_WA_MARCH_ARMV8_CRC)
+                        set(ARMV8FLAG "-Wa,-march=armv8-a+crc" CACHE INTERNAL "Compiler option to enable ARMv8 support")
+                    else()
+                        check_c_compiler_flag("-Wa,-march=armv8-a+crc+simd" HAVE_WA_MARCH_ARMV8_CRC_SIMD)
+                        if(HAVE_WA_MARCH_ARMV8_CRC_SIMD)
+                            set(ARMV8FLAG "-Wa,-march=armv8-a+crc+simd" CACHE INTERNAL "Compiler option to enable ARMv8 support")
+                        endif()
+                    endif()
                 endif()
             endif()
         endif()
     endif()
-    # Check whether compiler supports ARMv8 CRC intrinsics
-    set(CMAKE_REQUIRED_FLAGS "${ACLEFLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
+    # Check whether compiler supports ARMv8 inline asm
+    set(CMAKE_REQUIRED_FLAGS "${ARMV8FLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
+    check_c_source_compiles(
+        "unsigned int f(unsigned int a, unsigned int b) {
+            unsigned int c;
+        #ifdef __aarch64__
+            __asm__( \"crc32w %w0, %w1, %w2\" : \"=r\" (c) : \"r\" (a), \"r\" (b));
+        #else
+            __asm__( \"crc32w %0, %1, %2\" : \"=r\" (c) : \"r\" (a), \"r\" (b));
+        #endif
+            return (int)c;
+        }
+        int main(void) { return f(1,2); }"
+        HAVE_ARMV8_INLINE_ASM
+    )
+    # Check whether compiler supports ARMv8 intrinsics
     check_c_source_compiles(
         "#if defined(_MSC_VER)
         #include <intrin.h>
@@ -27,7 +51,41 @@ macro(check_acle_compiler_flag)
             return __crc32w(a, b);
         }
         int main(void) { return 0; }"
-        HAVE_ACLE_FLAG
+        HAVE_ARMV8_INTRIN
+    )
+    set(CMAKE_REQUIRED_FLAGS)
+endmacro()
+
+macro(check_armv8_pmull_eor3_compiler_flag)
+    if(NOT NATIVEFLAG)
+        if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+            check_c_compiler_flag("-march=armv8.2-a+crc+crypto+sha3" HAVE_MARCH_ARMV8_CRYPTO_SHA3)
+            if(HAVE_MARCH_ARMV8_CRYPTO_SHA3)
+                set(PMULLEOR3FLAG "-march=armv8.2-a+crc+crypto+sha3" CACHE INTERNAL "Compiler option to enable ARMv8 PMULL+EOR3 support")
+            else()
+                check_c_compiler_flag("-march=armv8-a+crc+crypto+sha3" HAVE_MARCH_ARMV8A_CRYPTO_SHA3)
+                if(HAVE_MARCH_ARMV8A_CRYPTO_SHA3)
+                    set(PMULLEOR3FLAG "-march=armv8-a+crc+crypto+sha3" CACHE INTERNAL "Compiler option to enable ARMv8 PMULL+EOR3 support")
+                endif()
+            endif()
+        endif()
+    endif()
+    # Check whether compiler supports ARMv8 PMULL + EOR3 intrinsics
+    set(CMAKE_REQUIRED_FLAGS "${PMULLEOR3FLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
+    check_c_source_compiles(
+        "#if defined(_MSC_VER) && (defined(_M_ARM64) || defined(_M_ARM64EC))
+        #  include <arm64_neon.h>
+        #else
+        #  include <arm_neon.h>
+        #endif
+        poly128_t f(poly64_t a, poly64_t b) {
+            return vmull_p64(a, b);
+        }
+        uint64x2_t g(uint64x2_t a, uint64x2_t b, uint64x2_t c) {
+            return veor3q_u64(a, b, c);
+        }
+        int main(void) { return 0; }"
+        HAVE_ARMV8_PMULL_EOR3_INTRIN
     )
     set(CMAKE_REQUIRED_FLAGS)
 endmacro()
@@ -38,6 +96,11 @@ macro(check_armv6_compiler_flag)
             check_c_compiler_flag("-march=armv6" HAVE_MARCH_ARMV6)
             if(HAVE_MARCH_ARMV6)
                 set(ARMV6FLAG "-march=armv6" CACHE INTERNAL "Compiler option to enable ARMv6 support")
+            else()
+                check_c_compiler_flag("-Wa,-march=armv6" HAVE_WA_MARCH_ARMV6)
+                if(HAVE_WA_MARCH_ARMV6)
+                    set(ARMV6FLAG "-Wa,-march=armv6" CACHE INTERNAL "Compiler option to enable ARMv6 support")
+                endif()
             endif()
         endif()
     endif()
@@ -46,7 +109,7 @@ macro(check_armv6_compiler_flag)
     check_c_source_compiles(
         "unsigned int f(unsigned int a, unsigned int b) {
             unsigned int c;
-            __asm__ __volatile__ ( \"uqsub16 %0, %1, %2\" : \"=r\" (c) : \"r\" (a), \"r\" (b) );
+            __asm__( \"uqsub16 %0, %1, %2\" : \"=r\" (c) : \"r\" (a), \"r\" (b) );
             return (int)c;
         }
         int main(void) { return f(1,2); }"
@@ -66,7 +129,7 @@ macro(check_armv6_compiler_flag)
             return __uqsub16(a, b);
         #endif
         }
-        int main(void) { return 0; }"
+        int main(void) { return f(1,2); }"
         HAVE_ARMV6_INTRIN
     )
     set(CMAKE_REQUIRED_FLAGS)
@@ -76,14 +139,14 @@ macro(check_avx512_intrinsics)
     if(NOT NATIVEFLAG)
         if(CMAKE_C_COMPILER_ID MATCHES "Intel")
             if(CMAKE_HOST_UNIX OR APPLE)
-                set(AVX512FLAG "-mavx512f -mavx512dq -mavx512bw -mavx512vl")
+                set(AVX512FLAG "-mavx512f -mavx512dq -mavx512bw -mavx512vl -mbmi2")
             else()
                 set(AVX512FLAG "/arch:AVX512")
             endif()
-        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
             # For CPUs that can benefit from AVX512, it seems GCC generates suboptimal
             # instruction scheduling unless you specify a reasonable -mtune= target
-            set(AVX512FLAG "-mavx512f -mavx512dq -mavx512bw -mavx512vl")
+            set(AVX512FLAG "-mavx512f -mavx512dq -mavx512bw -mavx512vl -mbmi2")
             if(NOT MSVC)
                 check_c_compiler_flag("-mtune=cascadelake" HAVE_CASCADE_LAKE)
                 if(HAVE_CASCADE_LAKE)
@@ -108,18 +171,19 @@ macro(check_avx512_intrinsics)
         int main(void) { return 0; }"
         HAVE_AVX512_INTRIN
     )
+    set(CMAKE_REQUIRED_FLAGS)
 endmacro()
 
 macro(check_avx512vnni_intrinsics)
     if(NOT NATIVEFLAG)
         if(CMAKE_C_COMPILER_ID MATCHES "Intel")
             if(CMAKE_HOST_UNIX OR APPLE OR CMAKE_C_COMPILER_ID MATCHES "IntelLLVM")
-                set(AVX512VNNIFLAG "-mavx512f -mavx512dq -mavx512bw -mavx512vl -mavx512vnni")
+                set(AVX512VNNIFLAG "-mavx512f -mavx512dq -mavx512bw -mavx512vl -mavx512vnni -mbmi2")
             else()
                 set(AVX512VNNIFLAG "/arch:AVX512")
             endif()
-        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
-            set(AVX512VNNIFLAG "-mavx512f -mavx512dq -mavx512bw -mavx512vl -mavx512vnni")
+        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
+            set(AVX512VNNIFLAG "-mavx512f -mavx512dq -mavx512bw -mavx512vl -mavx512vnni -mbmi2")
             if(NOT MSVC)
                 check_c_compiler_flag("-mtune=cascadelake" HAVE_CASCADE_LAKE)
                 if(HAVE_CASCADE_LAKE)
@@ -137,11 +201,15 @@ macro(check_avx512vnni_intrinsics)
     set(CMAKE_REQUIRED_FLAGS "${AVX512VNNIFLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
     check_c_source_compiles(
         "#include <immintrin.h>
-        __m512i f(__m512i x, __m512i y) {
-            __m512i z = _mm512_setzero_epi32();
-            return _mm512_dpbusd_epi32(z, x, y);
-        }
-        int main(void) { return 0; }"
+        int main(void) {
+            const __m512i z512 = _mm512_setzero_si512();
+            const __m256i z256 = _mm256_setzero_si256();
+            volatile __m512i r512 = _mm512_dpbusd_epi32(z512, z512, z512);
+            volatile __m256i r256 = _mm256_dpbusd_epi32(z256, z256, z256);
+            (void)r512;
+            (void)r256;
+            return 0;
+        }"
         HAVE_AVX512VNNI_INTRIN
     )
     set(CMAKE_REQUIRED_FLAGS)
@@ -151,12 +219,12 @@ macro(check_avx2_intrinsics)
     if(NOT NATIVEFLAG)
         if(CMAKE_C_COMPILER_ID MATCHES "Intel")
             if(CMAKE_HOST_UNIX OR APPLE)
-                set(AVX2FLAG "-mavx2")
+                set(AVX2FLAG "-mavx2 -mbmi2")
             else()
                 set(AVX2FLAG "/arch:AVX2")
             endif()
-        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
-            set(AVX2FLAG "-mavx2")
+        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
+            set(AVX2FLAG "-mavx2 -mbmi2")
         elseif(MSVC)
             set(AVX2FLAG "/arch:AVX2")
         endif()
@@ -178,7 +246,7 @@ endmacro()
 macro(check_neon_compiler_flag)
     if(NOT NATIVEFLAG)
         if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
-            if("${ARCH}" MATCHES "aarch64")
+            if(ARCH_64BIT)
                 set(NEONFLAG "-march=armv8-a+simd")
             else()
                 set(NEONFLAG "-mfpu=neon")
@@ -197,7 +265,7 @@ macro(check_neon_compiler_flag)
         NEON_AVAILABLE FAIL_REGEX "not supported")
     # Check whether compiler native flag is enough for NEON support
     # Some GCC versions don't enable FPU (vector unit) when using -march=native
-    if(NEON_AVAILABLE AND NATIVEFLAG AND (NOT "${ARCH}" MATCHES "aarch64"))
+    if(NEON_AVAILABLE AND NATIVEFLAG AND ARCH_32BIT)
         check_c_source_compiles(
             "#include <arm_neon.h>
             uint8x16_t f(uint8x16_t x, uint8x16_t y) {
@@ -241,7 +309,7 @@ endmacro()
 macro(check_neon_ld4_intrinsics)
     if(NOT NATIVEFLAG)
         if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
-            if("${ARCH}" MATCHES "aarch64")
+            if(ARCH_64BIT)
                 set(NEONFLAG "-march=armv8-a+simd")
             else()
                 set(NEONFLAG "-mfpu=neon")
@@ -264,12 +332,12 @@ endmacro()
 
 macro(check_pclmulqdq_intrinsics)
     if(NOT NATIVEFLAG)
-        if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "IntelLLVM")
+        if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "IntelLLVM" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
             set(PCLMULFLAG "-mpclmul")
         endif()
     endif()
     # Check whether compiler supports PCLMULQDQ intrinsics
-    if(NOT (APPLE AND "${ARCH}" MATCHES "i386"))
+    if(NOT (APPLE AND ARCH_32BIT))
         # The pclmul code currently crashes on Mac in 32bit mode. Avoid for now.
         set(CMAKE_REQUIRED_FLAGS "${PCLMULFLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
         check_c_source_compiles(
@@ -287,12 +355,12 @@ endmacro()
 
 macro(check_vpclmulqdq_intrinsics)
     if(NOT NATIVEFLAG)
-        if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "IntelLLVM")
+        if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "IntelLLVM" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
             set(VPCLMULFLAG "-mvpclmulqdq -mavx512f")
         endif()
     endif()
     # Check whether compiler supports VPCLMULQDQ intrinsics
-    if(NOT (APPLE AND "${ARCH}" MATCHES "i386"))
+    if(NOT (APPLE AND ARCH_32BIT))
         set(CMAKE_REQUIRED_FLAGS "${VPCLMULFLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
         check_c_source_compiles(
             "#include <immintrin.h>
@@ -356,7 +424,7 @@ macro(check_ppc_intrinsics)
         #include <machine/cpu.h>
         #endif
         int main() {
-        #ifdef __FreeBSD__
+        #if defined(__FreeBSD__) || defined(__OpenBSD__)
             unsigned long hwcap;
             elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
             return (hwcap & PPC_FEATURE_HAS_ALTIVEC);
@@ -383,7 +451,7 @@ macro(check_power8_intrinsics)
         #include <machine/cpu.h>
         #endif
         int main() {
-        #ifdef __FreeBSD__
+        #if defined(__FreeBSD__) || defined(__OpenBSD__)
             unsigned long hwcap;
             elf_aux_info(AT_HWCAP2, &hwcap, sizeof(hwcap));
             return (hwcap & PPC_FEATURE2_ARCH_2_07);
@@ -429,11 +497,33 @@ macro(check_rvv_intrinsics)
     set(CMAKE_REQUIRED_FLAGS)
 endmacro()
 
+macro(check_riscv_zbc_ext)
+    if(NOT NATIVEFLAG)
+        if(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+            set(RISCVZBCFLAG "-march=rv64gc_zbc")
+        endif()
+    endif()
+    # Check whether compiler supports RISC-V Zbc inline asm
+    # gcc-11 / clang-14 at least
+    set(CMAKE_REQUIRED_FLAGS "${RISCVZBCFLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
+    check_c_source_compiles(
+        "#include <stdint.h>
+        uint64_t f(uint64_t a, uint64_t b) {
+            uint64_t c;
+            __asm__ __volatile__ (\"clmul %[result], %[input_a], %[input_b]\" : [result] \"=r\" (c) : [input_a] \"r\" (a), [input_b] \"r\" (b));
+            return c;
+        }
+        int main(void) { return f(1, 2); }"
+        HAVE_RISCV_ZBC
+    )
+    set(CMAKE_REQUIRED_FLAGS)
+endmacro()
+
 macro(check_s390_intrinsics)
     check_c_source_compiles(
         "#include <sys/auxv.h>
         #ifndef HWCAP_S390_VXRS
-        #define HWCAP_S390_VXRS HWCAP_S390_VX
+        #define HWCAP_S390_VXRS (1 << 11)
         #endif
         int main() {
             return (getauxval(AT_HWCAP) & HWCAP_S390_VXRS);
@@ -456,7 +546,7 @@ macro(check_power9_intrinsics)
         #include <machine/cpu.h>
         #endif
         int main() {
-        #ifdef __FreeBSD__
+        #if defined(__FreeBSD__) || defined(__OpenBSD__)
             unsigned long hwcap;
             elf_aux_info(AT_HWCAP2, &hwcap, sizeof(hwcap));
             return (hwcap & PPC_FEATURE2_ARCH_3_00);
@@ -493,10 +583,10 @@ macro(check_sse2_intrinsics)
                 set(SSE2FLAG "/arch:SSE2")
             endif()
         elseif(MSVC)
-            if(NOT "${ARCH}" MATCHES "x86_64")
+            if(ARCH_32BIT)
                 set(SSE2FLAG "/arch:SSE2")
             endif()
-        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
             set(SSE2FLAG "-msse2")
         endif()
     endif()
@@ -519,7 +609,7 @@ macro(check_ssse3_intrinsics)
             else()
                 set(SSSE3FLAG "/arch:SSSE3")
             endif()
-        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
             set(SSSE3FLAG "-mssse3")
         endif()
     endif()
@@ -534,6 +624,30 @@ macro(check_ssse3_intrinsics)
         int main(void) { return 0; }"
         HAVE_SSSE3_INTRIN
     )
+    set(CMAKE_REQUIRED_FLAGS)
+endmacro()
+
+macro(check_sse41_intrinsics)
+    if(NOT NATIVEFLAG)
+        if(CMAKE_C_COMPILER_ID MATCHES "Intel")
+            if(CMAKE_HOST_UNIX OR APPLE)
+                set(SSE41FLAG "-msse4.1")
+            else()
+                set(SSE41FLAG "/arch:SSE4.1")
+            endif()
+        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
+            set(SSE41FLAG "-msse4.1")
+        endif()
+    endif()
+    # Check whether compiler supports SSE4.1 intrinsics
+    set(CMAKE_REQUIRED_FLAGS "${SSE41FLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
+    check_c_source_compiles(
+        "#include <smmintrin.h>
+        __m128i f(__m128i a, __m128i b) { return _mm_min_epi32(a, b); }
+        int main(void) { return 0; }"
+        HAVE_SSE41_INTRIN
+    )
+    set(CMAKE_REQUIRED_FLAGS)
 endmacro()
 
 macro(check_sse42_intrinsics)
@@ -544,7 +658,7 @@ macro(check_sse42_intrinsics)
             else()
                 set(SSE42FLAG "/arch:SSE4.2")
             endif()
-        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+        elseif(CMAKE_C_COMPILER_ID MATCHES "GNU" OR CMAKE_C_COMPILER_ID MATCHES "Clang" OR CMAKE_C_COMPILER_ID MATCHES "NVHPC")
             set(SSE42FLAG "-msse4.2")
         endif()
     endif()
@@ -602,3 +716,51 @@ macro(check_xsave_intrinsics)
         HAVE_XSAVE_INTRIN FAIL_REGEX "not supported")
     set(CMAKE_REQUIRED_FLAGS)
 endmacro()
+
+macro(check_la64_crc_intrinsics)
+    # Check whether compiler supports "crc" intrinsic
+    set(CMAKE_REQUIRED_FLAGS "${NATIVEFLAG} ${ZNOLTOFLAG}")
+    check_c_source_compiles(
+        "#include <larchintrin.h>
+        int main(void) {
+            char ch = 'a';
+            int crc = __crc_w_b_w(ch, 0);
+            return crc;
+        }"
+        HAVE_LA64_CRC_INTRIN)
+    set(CMAKE_REQUIRED_FLAGS)
+endmacro()
+
+macro(check_lsx_intrinsics)
+    if(NOT NATIVEFLAG)
+        set(LSXFLAG "-mlsx")
+    endif()
+    # Check whether compiler supports LSX intrinsics
+    set(CMAKE_REQUIRED_FLAGS "${LSXFLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
+    check_c_source_compiles(
+        "#include <lsxintrin.h>
+        __m128i f(__m128i a, __m128i b) {
+            return __lsx_vabsd_b(a, b);
+        }
+        int main(void) { return 0; }"
+        HAVE_LSX_INTRIN
+    )
+    set(CMAKE_REQUIRED_FLAGS)
+endmacro()
+
+macro(check_lasx_intrinsics)
+    if(NOT NATIVEFLAG)
+        set(LASXFLAG "-mlasx")
+    endif()
+    # Check whether compiler supports LASX intrinsics
+    set(CMAKE_REQUIRED_FLAGS "${LASXFLAG} ${NATIVEFLAG} ${ZNOLTOFLAG}")
+    check_c_source_compiles(
+        "#include <lasxintrin.h>
+        __m256i f(__m256i a, __m256i b) {
+            return __lasx_xvabsd_b(a, b);
+        }
+        int main(void) { return 0; }"
+        HAVE_LASX_INTRIN
+    )
+    set(CMAKE_REQUIRED_FLAGS)
+endmacro()
diff --git a/cmake/detect-sanitizer.cmake b/cmake/detect-sanitizer.cmake
index f9521ec2..b71c1a37 100644
--- a/cmake/detect-sanitizer.cmake
+++ b/cmake/detect-sanitizer.cmake
@@ -111,6 +111,7 @@ endmacro()
 
 macro(add_undefined_sanitizer)
     set(known_checks
+        alignment
         array-bounds
         bool
         bounds
@@ -137,10 +138,6 @@ macro(add_undefined_sanitizer)
         vptr
         )
 
-    # Only check for alignment sanitizer flag if unaligned access is not supported
-    if(NOT WITH_UNALIGNED)
-        list(APPEND known_checks alignment)
-    endif()
     # Object size sanitizer has no effect at -O0 and produces compiler warning if enabled
     if(NOT CMAKE_C_FLAGS MATCHES "-O0")
         list(APPEND known_checks object-size)
@@ -153,12 +150,6 @@ macro(add_undefined_sanitizer)
         add_compile_options(-fsanitize=${supported_checks})
         add_link_options(-fsanitize=${supported_checks})
 
-        # Group sanitizer flag -fsanitize=undefined will automatically add alignment, even if
-        # it is not in our sanitize flag list, so we need to explicitly disable alignment sanitizing.
-        if(WITH_UNALIGNED)
-            add_compile_options(-fno-sanitize=alignment)
-        endif()
-
         add_common_sanitizer_flags()
     else()
         message(STATUS "Undefined behavior sanitizer is not supported")
diff --git a/cmake/fallback-macros.cmake b/cmake/fallback-macros.cmake
index 8bc6cf25..d2375cdc 100644
--- a/cmake/fallback-macros.cmake
+++ b/cmake/fallback-macros.cmake
@@ -1,19 +1,29 @@
 # fallback-macros.cmake -- CMake fallback macros
-# Copyright (C) 2022 Nathan Moinvaziri
+# Copyright (C) 2026 Vladislav Shchapov
 # Licensed under the Zlib license, see LICENSE.md for details
 
-# CMake less than version 3.5.2
-if(NOT COMMAND add_compile_options)
-    macro(add_compile_options options)
-        string(APPEND CMAKE_C_FLAGS ${options})
-        string(APPEND CMAKE_CXX_FLAGS ${options})
-    endmacro()
-endif()
+# Workaround for FetchContent EXCLUDE_FROM_ALL implementation for CMake before 3.28.
+# The EXCLUDE_FROM_ALL argument for FetchContent_Declare added in version 3.28.
+# Before CMake 3.28, FetchContent_MakeAvailable would add dependencies to the ALL target.
+macro(ZNG_FetchContent_MakeAvailable)
+    if(CMAKE_VERSION VERSION_LESS 3.28)
+        foreach(__zng_contentName IN ITEMS ${ARGV})
+            string(TOLOWER ${__zng_contentName} __zng_contentNameLower)
+            FetchContent_GetProperties(${__zng_contentName})
+            if(NOT ${__zng_contentNameLower}_POPULATED)
+                FetchContent_Populate(${__zng_contentName})
+                add_subdirectory(${${__zng_contentNameLower}_SOURCE_DIR} ${${__zng_contentNameLower}_BINARY_DIR} EXCLUDE_FROM_ALL)
+            endif()
+        endforeach()
+        unset(__zng_contentName)
+        unset(__zng_contentNameLower)
+    else()
+        FetchContent_MakeAvailable(${ARGV})
+    endif()
+endmacro()
 
-# CMake less than version 3.14
-if(NOT COMMAND add_link_options)
-    macro(add_link_options options)
-        string(APPEND CMAKE_EXE_LINKER_FLAGS ${options})
-        string(APPEND CMAKE_SHARED_LINKER_FLAGS ${options})
-    endmacro()
+if(CMAKE_VERSION VERSION_LESS 3.28)
+    set(ZNG_FetchContent_Declare_EXCLUDE_FROM_ALL)
+else()
+    set(ZNG_FetchContent_Declare_EXCLUDE_FROM_ALL EXCLUDE_FROM_ALL)
 endif()
diff --git a/cmake/toolchain-loongarch64-gcc.cmake b/cmake/toolchain-loongarch64-gcc.cmake
new file mode 100644
index 00000000..7e10c701
--- /dev/null
+++ b/cmake/toolchain-loongarch64-gcc.cmake
@@ -0,0 +1,28 @@
+# Export configurable variables for the try_compile() command.
+set(CMAKE_TRY_COMPILE_PLATFORM_VARIABLES COMPILER_SUFFIX)
+
+set(CMAKE_SYSTEM_NAME Linux)
+set(CMAKE_SYSTEM_PROCESSOR loongarch64)
+set(CMAKE_SYSTEM_VERSION 1)
+
+set(CMAKE_C_COMPILER_TARGET loongarch64-linux-gnu)
+set(CMAKE_CXX_COMPILER_TARGET loongarch64-linux-gnu)
+
+set(CMAKE_CROSSCOMPILING TRUE)
+set(CMAKE_CROSSCOMPILING_EMULATOR qemu-loongarch64 -cpu la464-loongarch-cpu -L /usr/${CMAKE_C_COMPILER_TARGET}/)
+
+set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
+set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
+set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
+set(CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY)
+
+find_program(C_COMPILER_FULL_PATH NAMES ${CMAKE_C_COMPILER_TARGET}-gcc${COMPILER_SUFFIX})
+if(NOT C_COMPILER_FULL_PATH)
+    message(FATAL_ERROR "Cross-compiler for ${CMAKE_C_COMPILER_TARGET} not found")
+endif()
+set(CMAKE_C_COMPILER ${C_COMPILER_FULL_PATH})
+
+find_program(CXX_COMPILER_FULL_PATH NAMES g++${COMPILER_SUFFIX}-${CMAKE_CXX_COMPILER_TARGET} ${CMAKE_CXX_COMPILER_TARGET}-g++${COMPILER_SUFFIX})
+if(CXX_COMPILER_FULL_PATH)
+    set(CMAKE_CXX_COMPILER ${CXX_COMPILER_FULL_PATH})
+endif()
diff --git a/cmake/toolchain-riscv-clang.cmake b/cmake/toolchain-riscv-clang.cmake
new file mode 100644
index 00000000..71fa7f4c
--- /dev/null
+++ b/cmake/toolchain-riscv-clang.cmake
@@ -0,0 +1,16 @@
+set(CMAKE_SYSTEM_NAME Linux)
+set(CMAKE_SYSTEM_PROCESSOR riscv64)
+set(CMAKE_SYSTEM_VERSION 1)
+
+set(CMAKE_C_COMPILER clang)
+set(CMAKE_C_COMPILER_TARGET riscv64-linux-gnu)
+set(CMAKE_CXX_COMPILER clang++)
+set(CMAKE_CXX_COMPILER_TARGET riscv64-linux-gnu)
+
+set(CMAKE_CROSSCOMPILING TRUE)
+set(CMAKE_CROSSCOMPILING_EMULATOR qemu-riscv64 -cpu rv64,zba=true,zbb=true,zbc=true,zbs=true,v=true,vlen=512,elen=64,vext_spec=v1.0 -L /usr/${CMAKE_C_COMPILER_TARGET}/)
+
+set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
+set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
+set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
+set(CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY)
diff --git a/cmake/toolchain-riscv.cmake b/cmake/toolchain-riscv.cmake
index 9cf8fdb7..241f2a7d 100644
--- a/cmake/toolchain-riscv.cmake
+++ b/cmake/toolchain-riscv.cmake
@@ -1,28 +1,25 @@
+set(CMAKE_SYSTEM_NAME Linux)
+set(CMAKE_SYSTEM_PROCESSOR riscv64)
+set(CMAKE_SYSTEM_VERSION 1)
+
+set(CMAKE_C_COMPILER_TARGET riscv64-linux-gnu)
+set(CMAKE_CXX_COMPILER_TARGET riscv64-linux-gnu)
+
 set(CMAKE_CROSSCOMPILING TRUE)
-set(CMAKE_SYSTEM_NAME "Linux")
-set(CMAKE_SYSTEM_PROCESSOR "riscv64")
+set(CMAKE_CROSSCOMPILING_EMULATOR qemu-riscv64 -cpu rv64,zba=true,zbb=true,zbc=true,zbs=true,v=true,vlen=512,elen=64,vext_spec=v1.0 -L /usr/${CMAKE_C_COMPILER_TARGET}/)
 
-# Avoid to use system path for cross-compile
-set(CMAKE_FIND_USE_CMAKE_SYSTEM_PATH FALSE)
+set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
+set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
+set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
+set(CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY)
 
-set(TOOLCHAIN_PATH "" CACHE STRING "The toolchain path.")
-if(NOT TOOLCHAIN_PATH)
-  set(TOOLCHAIN_PATH ${CMAKE_SOURCE_DIR}/prebuilt-riscv-toolchain-qemu/riscv-clang)
+find_program(C_COMPILER_FULL_PATH NAMES ${CMAKE_C_COMPILER_TARGET}-gcc)
+if(NOT C_COMPILER_FULL_PATH)
+    message(FATAL_ERROR "Cross-compiler for ${CMAKE_C_COMPILER_TARGET} not found")
 endif()
+set(CMAKE_C_COMPILER ${C_COMPILER_FULL_PATH})
 
-set(TOOLCHAIN_PREFIX "riscv64-unknown-linux-gnu-" CACHE STRING "The toolchain prefix.")
-set(QEMU_PATH "" CACHE STRING "The qemu path.")
-if(NOT QEMU_PATH)
-  set(QEMU_PATH ${CMAKE_SOURCE_DIR}/prebuilt-riscv-toolchain-qemu/riscv-qemu/bin/qemu-riscv64)
+find_program(CXX_COMPILER_FULL_PATH NAMES g++-${CMAKE_CXX_COMPILER_TARGET} ${CMAKE_CXX_COMPILER_TARGET}-g++)
+if(CXX_COMPILER_FULL_PATH)
+    set(CMAKE_CXX_COMPILER ${CXX_COMPILER_FULL_PATH})
 endif()
-
-# toolchain setting
-set(CMAKE_C_COMPILER "${TOOLCHAIN_PATH}/bin/${TOOLCHAIN_PREFIX}clang")
-set(CMAKE_CXX_COMPILER "${TOOLCHAIN_PATH}/bin/${TOOLCHAIN_PREFIX}clang++")
-
-# disable auto-vectorizer
-add_compile_options(-fno-vectorize -fno-slp-vectorize)
-
-# emulator setting
-set(QEMU_CPU_OPTION "rv64,zba=true,zbb=true,zbc=true,zbs=true,v=true,vlen=512,elen=64,vext_spec=v1.0")
-set(CMAKE_CROSSCOMPILING_EMULATOR ${QEMU_PATH} -cpu ${QEMU_CPU_OPTION} -L ${TOOLCHAIN_PATH}/sysroot/)
diff --git a/compare256_rle.h b/compare256_rle.h
index 0f3998d4..5edfd734 100644
--- a/compare256_rle.h
+++ b/compare256_rle.h
@@ -4,12 +4,13 @@
  */
 
 #include "zbuild.h"
+#include "zmemory.h"
 #include "fallback_builtins.h"
 
 typedef uint32_t (*compare256_rle_func)(const uint8_t* src0, const uint8_t* src1);
 
-/* ALIGNED, byte comparison */
-static inline uint32_t compare256_rle_c(const uint8_t *src0, const uint8_t *src1) {
+/* 8-bit integer comparison */
+static inline uint32_t compare256_rle_8(const uint8_t *src0, const uint8_t *src1) {
     uint32_t len = 0;
 
     do {
@@ -42,29 +43,24 @@ static inline uint32_t compare256_rle_c(const uint8_t *src0, const uint8_t *src1
     return 256;
 }
 
-#ifdef UNALIGNED_OK
-/* 16-bit unaligned integer comparison */
-static inline uint32_t compare256_rle_unaligned_16(const uint8_t *src0, const uint8_t *src1) {
+/* 16-bit integer comparison */
+static inline uint32_t compare256_rle_16(const uint8_t *src0, const uint8_t *src1) {
     uint32_t len = 0;
-    uint16_t src0_cmp, src1_cmp;
+    uint16_t src0_cmp;
 
-    memcpy(&src0_cmp, src0, sizeof(src0_cmp));
+    src0_cmp = zng_memread_2(src0);
 
     do {
-        memcpy(&src1_cmp, src1, sizeof(src1_cmp));
-        if (src0_cmp != src1_cmp)
+        if (src0_cmp != zng_memread_2(src1))
             return len + (*src0 == *src1);
         src1 += 2, len += 2;
-        memcpy(&src1_cmp, src1, sizeof(src1_cmp));
-        if (src0_cmp != src1_cmp)
+        if (src0_cmp != zng_memread_2(src1))
             return len + (*src0 == *src1);
         src1 += 2, len += 2;
-        memcpy(&src1_cmp, src1, sizeof(src1_cmp));
-        if (src0_cmp != src1_cmp)
+        if (src0_cmp != zng_memread_2(src1))
             return len + (*src0 == *src1);
         src1 += 2, len += 2;
-        memcpy(&src1_cmp, src1, sizeof(src1_cmp));
-        if (src0_cmp != src1_cmp)
+        if (src0_cmp != zng_memread_2(src1))
             return len + (*src0 == *src1);
         src1 += 2, len += 2;
     } while (len < 256);
@@ -73,22 +69,26 @@ static inline uint32_t compare256_rle_unaligned_16(const uint8_t *src0, const ui
 }
 
 #ifdef HAVE_BUILTIN_CTZ
-/* 32-bit unaligned integer comparison */
-static inline uint32_t compare256_rle_unaligned_32(const uint8_t *src0, const uint8_t *src1) {
+/* 32-bit integer comparison */
+static inline uint32_t compare256_rle_32(const uint8_t *src0, const uint8_t *src1) {
     uint32_t sv, len = 0;
     uint16_t src0_cmp;
 
-    memcpy(&src0_cmp, src0, sizeof(src0_cmp));
+    src0_cmp = zng_memread_2(src0);
     sv = ((uint32_t)src0_cmp << 16) | src0_cmp;
 
     do {
         uint32_t mv, diff;
 
-        memcpy(&mv, src1, sizeof(mv));
+        mv = zng_memread_4(src1);
 
         diff = sv ^ mv;
         if (diff) {
+#if BYTE_ORDER == LITTLE_ENDIAN
             uint32_t match_byte = __builtin_ctz(diff) / 8;
+#else
+            uint32_t match_byte = __builtin_clz(diff) / 8;
+#endif
             return len + match_byte;
         }
 
@@ -97,28 +97,31 @@ static inline uint32_t compare256_rle_unaligned_32(const uint8_t *src0, const ui
 
     return 256;
 }
-
 #endif
 
-#if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-/* 64-bit unaligned integer comparison */
-static inline uint32_t compare256_rle_unaligned_64(const uint8_t *src0, const uint8_t *src1) {
+#ifdef HAVE_BUILTIN_CTZLL
+/* 64-bit integer comparison */
+static inline uint32_t compare256_rle_64(const uint8_t *src0, const uint8_t *src1) {
     uint32_t src0_cmp32, len = 0;
     uint16_t src0_cmp;
     uint64_t sv;
 
-    memcpy(&src0_cmp, src0, sizeof(src0_cmp));
+    src0_cmp = zng_memread_2(src0);
     src0_cmp32 = ((uint32_t)src0_cmp << 16) | src0_cmp;
     sv = ((uint64_t)src0_cmp32 << 32) | src0_cmp32;
 
     do {
         uint64_t mv, diff;
 
-        memcpy(&mv, src1, sizeof(mv));
+        mv = zng_memread_8(src1);
 
         diff = sv ^ mv;
         if (diff) {
+#if BYTE_ORDER == LITTLE_ENDIAN
             uint64_t match_byte = __builtin_ctzll(diff) / 8;
+#else
+            uint64_t match_byte = __builtin_clzll(diff) / 8;
+#endif
             return len + (uint32_t)match_byte;
         }
 
@@ -127,8 +130,4 @@ static inline uint32_t compare256_rle_unaligned_64(const uint8_t *src0, const ui
 
     return 256;
 }
-
-#endif
-
 #endif
-
diff --git a/compress.c b/compress.c
index 66118e4f..cc6e8d96 100644
--- a/compress.c
+++ b/compress.c
@@ -28,8 +28,8 @@
    memory, Z_BUF_ERROR if there was not enough room in the output buffer,
    Z_STREAM_ERROR if the level parameter is invalid.
 */
-int Z_EXPORT PREFIX(compress2)(unsigned char *dest, z_uintmax_t *destLen, const unsigned char *source,
-                        z_uintmax_t sourceLen, int level) {
+z_int32_t Z_EXPORT PREFIX(compress2)(unsigned char *dest, z_uintmax_t *destLen, const unsigned char *source,
+                        z_uintmax_t sourceLen, z_int32_t level) {
     PREFIX3(stream) stream;
     int err;
     const unsigned int max = (unsigned int)-1;
@@ -70,7 +70,7 @@ int Z_EXPORT PREFIX(compress2)(unsigned char *dest, z_uintmax_t *destLen, const
 
 /* ===========================================================================
  */
-int Z_EXPORT PREFIX(compress)(unsigned char *dest, z_uintmax_t *destLen, const unsigned char *source, z_uintmax_t sourceLen) {
+z_int32_t Z_EXPORT PREFIX(compress)(unsigned char *dest, z_uintmax_t *destLen, const unsigned char *source, z_uintmax_t sourceLen) {
     return PREFIX(compress2)(dest, destLen, source, sourceLen, Z_DEFAULT_COMPRESSION);
 }
 
diff --git a/configure b/configure
index 8e693fe7..c3ef99dd 100755
--- a/configure
+++ b/configure
@@ -29,11 +29,17 @@ if [ -n "${CHOST}" ]; then
     CROSS_PREFIX="${CHOST}-"
     ARCH="$(echo "${NORM_CHOST}" | sed -e 's/-.*//')"
 else
-    ARCH="$(uname -m)"
+    # BSD systems use uname -p for architecture names vs port names
+    case "$(uname -s)" in
+      *BSD | *bsd* | DragonFly)
+          ARCH="$(uname -p)" ;;
+      *)
+          ARCH="$(uname -m)" ;;
+    esac
 fi
 
 case "${ARCH}" in
-    x86_64)
+    amd64 | x86_64)
         case "${CFLAGS}" in
             *-m32*)
                 ARCH=i686
@@ -83,42 +89,55 @@ bindir=${bindir-'${exec_prefix}/bin'}
 libdir=${libdir-'${exec_prefix}/lib'}
 sharedlibdir=${sharedlibdir-'${libdir}'}
 includedir=${includedir-'${prefix}/include'}
+installnamedir=${installnamedir-'@rpath'}
 mandir=${mandir-'${prefix}/share/man'}
 shared_ext='.so'
 shared=1
 gzfileops=1
-unalignedok=1
 compat=0
 cover=0
 build32=0
 build64=0
 buildvpclmulqdq=1
-buildacle=1
+buildarmv8=1
 buildarmv6=1
 buildaltivec=1
 buildpower8=1
 buildpower9=1
 buildneon=1
+buildrvv=1
+buildzbc=1
 builddfltccdeflate=0
 builddfltccinflate=0
 buildcrc32vx=1
+buildcrc32la=1
 floatabi=
-forcesse2=0
 # For CPUs that can benefit from AVX512, it seems GCC generates suboptimal
 # instruction scheduling unless you specify a reasonable -mtune= target
-avx512flag="-mavx512f -mavx512dq -mavx512bw -mavx512vl"
+avx512flag="-mavx512f -mavx512dq -mavx512bw -mavx512vl -mbmi2"
 avx512vnniflag="${avx512flag} -mavx512vnni"
-avx2flag="-mavx2"
+avx2flag="-mavx2 -mbmi2"
 sse2flag="-msse2"
 ssse3flag="-mssse3"
+sse41flag="-msse4.1"
 sse42flag="-msse4.2"
 pclmulflag="-mpclmul"
 vpclmulflag="-mvpclmulqdq -mavx512f"
 xsaveflag="-mxsave"
-acleflag=
+lsxflag="-mlsx"
+lasxflag="-mlasx"
+armv8flag=
+pmulleor3flag=
 neonflag=
+rvvflag=
+rvvzbcflag=
+zbcflag=
+# We need to set defaults so we can test if either RVV or ZBC or both are disabled
+HAVE_RVV_INTRIN=0
+HAVE_ZBC_EXT=0
 armv6flag=
-noltoflag="-fno-lto"
+# Set default for noltoflag based on compiler being gcc compatible or not
+noltoflag=
 vgfmaflag="-march=z13"
 vmxflag="-maltivec"
 symbol_prefix=""
@@ -159,25 +178,28 @@ case "$1" in
       echo 'usage:' | tee -a configure.log
       echo '  configure [--prefix=PREFIX]  [--eprefix=EXPREFIX]' | tee -a configure.log
       echo '    [--static] [--32] [--64] [--libdir=LIBDIR] [--sharedlibdir=LIBDIR]' | tee -a configure.log
-      echo '    [--includedir=INCLUDEDIR] [--archs="-arch i386 -arch x86_64"]' | tee -a configure.log
+      echo '    [--includedir=INCLUDEDIR] [--installnamedir="@rpath"] [--mandir=MANDIR] [--archs="-arch i386 -arch x86_64"]' | tee -a configure.log
       echo '    [--sprefix=SYMBOL_PREFIX]   Adds a prefix to all exported symbols' | tee -a configure.log
       echo '    [--warn]                    Enables extra compiler warnings' | tee -a configure.log
       echo '    [--debug]                   Enables extra debug prints during operation' | tee -a configure.log
       echo '    [--zlib-compat]             Compiles for zlib-compatible API instead of zlib-ng API' | tee -a configure.log
-      echo '    [--without-unaligned]       Compiles without fast unaligned access' | tee -a configure.log
       echo '    [--without-gzfileops]       Compiles without the gzfile parts of the API enabled' | tee -a configure.log
       echo '    [--without-optimizations]   Compiles without support for optional instruction sets' | tee -a configure.log
       echo '    [--without-new-strategies]  Compiles without using new additional deflate strategies' | tee -a configure.log
-      echo '    [--without-acle]            Compiles without ARM C Language Extensions' | tee -a configure.log
-      echo '    [--without-neon]            Compiles without ARM Neon SIMD instruction set' | tee -a configure.log
+      echo '    [--without-vpclmulqdq]      Compiles without x86 VPCLMUL instruction set' | tee -a configure.log
       echo '    [--without-armv6]           Compiles without ARMv6 SIMD instruction set' | tee -a configure.log
+      echo '    [--without-armv8]           Compiles without ARMv8 CRC32 instruction set' | tee -a configure.log
+      echo '    [--without-neon]            Compiles without ARM Neon SIMD instruction set' | tee -a configure.log
+      echo '    [--without-rvv]             Compiles without RISC-V RVV instruction set' | tee -a configure.log
+      echo '    [--without-zbc]             Compiles without RISC-V ZBC instruction set' | tee -a configure.log
       echo '    [--without-altivec]         Compiles without PPC AltiVec support' | tee -a configure.log
       echo '    [--without-power8]          Compiles without Power8 instruction set' | tee -a configure.log
+      echo '    [--without-power9]          Compiles without Power9 instruction set' | tee -a configure.log
       echo '    [--with-dfltcc-deflate]     Use DEFLATE CONVERSION CALL instruction for compression on IBM Z' | tee -a configure.log
       echo '    [--with-dfltcc-inflate]     Use DEFLATE CONVERSION CALL instruction for decompression on IBM Z' | tee -a configure.log
       echo '    [--without-crc32-vx]        Build without vectorized CRC32 on IBM Z' | tee -a configure.log
+      echo '    [--without-crc32-la]        Build without vectorized CRC32 on Loongarch' | tee -a configure.log
       echo '    [--with-reduced-mem]        Reduced memory usage for special cases (reduces performance)' | tee -a configure.log
-      echo '    [--force-sse2]              Assume SSE2 instructions are always available (disabled by default on x86, enabled on x86_64)' | tee -a configure.log
         exit 0 ;;
     -p*=* | --prefix=*) prefix=$(echo $1 | sed 's/.*=//'); shift ;;
     -e*=* | --eprefix=*) exec_prefix=$(echo $1 | sed 's/.*=//'); shift ;;
@@ -185,6 +207,8 @@ case "$1" in
     -l*=* | --libdir=*) libdir=$(echo $1 | sed 's/.*=//'); shift ;;
     --sharedlibdir=*) sharedlibdir=$(echo $1 | sed 's/.*=//'); shift ;;
     -i*=* | --includedir=*) includedir=$(echo $1 | sed 's/.*=//');shift ;;
+    --installnamedir=*) installnamedir=$(echo $1 | sed 's/.*=//'); shift ;;
+    --mandir=*) mandir=$(echo $1 | sed 's/.*=//');shift ;;
     -u*=* | --uname=*) uname=$(echo $1 | sed 's/.*=//');shift ;;
     -p* | --prefix) prefix="$2"; shift; shift ;;
     -e* | --eprefix) exec_prefix="$2"; shift; shift ;;
@@ -194,23 +218,26 @@ case "$1" in
     -s* | --shared | --enable-shared) shared=1; shift ;;
     -t | --static) shared=0; shift ;;
     --zlib-compat) compat=1; shift ;;
-    --without-unaligned) unalignedok=0; shift ;;
     --without-gzfileops) gzfileops=0; shift ;;
     --cover) cover=1; shift ;;
     -3* | --32) build32=1; shift ;;
     -6* | --64) build64=1; shift ;;
     --without-vpclmulqdq) buildvpclmulqdq=0; shift ;;
-    --without-acle) buildacle=0; shift ;;
+    --without-armv8) buildarmv8=0; shift ;;
+    # Provided for backward compatibility
+    --without-acle) buildarmv8=0; shift ;;
     --without-neon) buildneon=0; shift ;;
     --without-armv6) buildarmv6=0; shift ;;
     --without-altivec) buildaltivec=0 ; shift ;;
+    --without-rvv) buildrvv=0 ; shift ;;
+    --without-zbc) buildzbc=0 ; shift ;;
     --without-power8) buildpower8=0 ; shift ;;
     --without-power9) buildpower9=0 ; shift ;;
     --with-dfltcc-deflate) builddfltccdeflate=1; shift ;;
     --with-dfltcc-inflate) builddfltccinflate=1; shift ;;
     --without-crc32-vx) buildcrc32vx=0; shift ;;
+    --without-crc32-la) buildcrc32la=0; shift ;;
     --with-reduced-mem) reducedmem=1; shift ;;
-    --force-sse2) forcesse2=1; shift ;;
     -a*=* | --archs=*) ARCHS=$(echo $1 | sed 's/.*=//'); shift ;;
     --sysconfdir=*) echo "ignored option: --sysconfdir" | tee -a configure.log; shift ;;
     --localstatedir=*) echo "ignored option: --localstatedir" | tee -a configure.log; shift ;;
@@ -315,32 +342,59 @@ if test "$gcc" -eq 1 && ($cc $CFLAGS -c $test.c) >> configure.log 2>&1; then
       # Honor user choice if gcc is multilib and 64-bit is requested
       if test $build64 -eq 1; then
         ARCH=x86_64
+        ARCH_64BIT=1
       else
         ARCH=$CC_ARCH
+        ARCH_32BIT=1
       fi ;;
-    x86_64)
+    amd64 | x86_64)
       # Honor user choice if gcc is multilib and 32-bit is requested
       if test $build32 -ne 1; then
         ARCH=$CC_ARCH
+        ARCH_64BIT=1
+      else
+        ARCH=i686
+        ARCH_32BIT=1
       fi ;;
     arm | armeb)
       ARCH=arm
+      ARCH_32BIT=1
       if test "${uname}" = "eabi"; then
         uname=arm
       fi ;;
     armv8l)
-      ARCH=armv8-a ;;
+      ARCH=armv8-a
+      ARCH_32BIT=1 ;;
     aarch64 | aarch64_be | arm64)
       if test "${uname}" = "elf"; then
         uname=aarch64
       fi
-      ARCH=aarch64 ;;
+      ARCH=aarch64
+      ARCH_64BIT=1 ;;
+    mips | mipsel)
+      ARCH=mips
+      ARCH_32BIT=1 ;;
+    mips64 | mips64el)
+      ARCH=mips64
+      ARCH_64BIT=1 ;;
     powerpc | ppc)
-      ARCH=powerpc ;;
+      ARCH=powerpc
+      ARCH_32BIT=1 ;;
     powerpc64 | ppc64)
-      ARCH=powerpc64 ;;
+      ARCH=powerpc64
+      ARCH_64BIT=1 ;;
     powerpc64le | ppc64le)
-      ARCH=powerpc64le ;;
+      ARCH=powerpc64le
+      ARCH_64BIT=1 ;;
+    riscv64)
+      ARCH=riscv64
+      ARCH_64BIT=1 ;;
+    s390x)
+      ARCH=s390x
+      ARCH_64BIT=1 ;;
+    loongarch64)
+      ARCH=loongarch64
+      ARCH_64BIT=1 ;;
   esac
   CFLAGS="-O2 ${CFLAGS}"
   if test -n "${ARCHS}"; then
@@ -363,7 +417,7 @@ if test "$gcc" -eq 1 && ($cc $CFLAGS -c $test.c) >> configure.log 2>&1; then
     uname=$( (uname -s || echo unknown) 2>/dev/null)
   fi
   case "$uname" in
-  Linux* | linux* | GNU | GNU/* | solaris*)
+  Linux* | linux* | GNU | GNU/* | solaris* | Haiku)
         LDSHARED=${LDSHARED-"$cc"}
         LDSHAREDFLAGS="-shared -Wl,-soname,${LIBNAME}.so.${VER1}" ;;
   *BSD | *bsd* | DragonFly)
@@ -472,7 +526,7 @@ if test "$gcc" -eq 1 && ($cc $CFLAGS -c $test.c) >> configure.log 2>&1; then
              SHAREDLIBM=${LIBNAME}.$VER1$shared_ext
              SHAREDTARGET=$SHAREDLIBV
              LDSHARED=${LDSHARED-"$cc"}
-             LDSHAREDFLAGS="-dynamiclib -install_name @rpath/${SHAREDLIBM} -compatibility_version ${VER1} -current_version ${VER3}"
+             LDSHAREDFLAGS="-dynamiclib -install_name ${installnamedir}/${SHAREDLIBM} -compatibility_version ${VER1} -current_version ${VER3}"
              if "${CROSS_PREFIX}libtool" -V 2>&1 | grep Apple > /dev/null; then
                  AR="${CROSS_PREFIX}libtool"
              elif libtool -V 2>&1 | grep Apple > /dev/null; then
@@ -540,11 +594,17 @@ case "$uname" in
 esac
 
 # Simplify some later conditionals
+LINUX=0
+FREEBSD=0
+OPENBSD=0
+
 case "$uname" in
 Linux* | linux*)
   LINUX=1 ;;
-*)
-  LINUX=0 ;;
+FreeBSD*)
+  FREEBSD=1 ;;
+OpenBSD*)
+  OPENBSD=1 ;;
 esac
 
 # destination names for shared library if not defined above
@@ -630,6 +690,44 @@ fi
 
 echo >> configure.log
 
+ADDITIONAL_CHECK_FLAGS=""
+
+# Check for -Werror=unguarded-availability compiler support
+echo "" > test.c
+  cat > $test.c <<EOF
+int main() { return 0; }
+EOF
+if $cc $CFLAGS -Werror=unguarded-availability -c $test.c >> configure.log 2>&1; then
+  echo "Checking for -Werror=unguarded-availability... Yes." | tee -a configure.log
+  ADDITIONAL_CHECK_FLAGS="$ADDITIONAL_CHECK_FLAGS -Werror=unguarded-availability"
+else
+  echo "Checking for -Werror=unguarded-availability... No." | tee -a configure.log
+fi
+
+# Check for -Werror=unguarded-availability-new compiler support
+echo "" > test.c
+  cat > $test.c <<EOF
+int main() { return 0; }
+EOF
+if $cc $CFLAGS -Werror=unguarded-availability-new -c $test.c >> configure.log 2>&1; then
+  echo "Checking for -Werror=unguarded-availability-new... Yes." | tee -a configure.log
+  ADDITIONAL_CHECK_FLAGS="$ADDITIONAL_CHECK_FLAGS -Werror=unguarded-availability-new"
+else
+  echo "Checking for -Werror=unguarded-availability-new... No." | tee -a configure.log
+fi
+
+# Check for -Werror=unused-command-line-argument compiler support
+echo "" > test.c
+  cat > $test.c <<EOF
+int main() { return 0; }
+EOF
+if $cc $CFLAGS -Werror=unused-command-line-argument -c $test.c >> configure.log 2>&1; then
+  echo "Checking for -Werror=unused-command-line-argument... Yes." | tee -a configure.log
+  ADDITIONAL_CHECK_FLAGS="$ADDITIONAL_CHECK_FLAGS -Werror=unused-command-line-argument"
+else
+  echo "Checking for -Werror=unused-command-line-argument... No." | tee -a configure.log
+fi
+
 # check for version script support
 cat > $test.c <<EOF
 int foo(void) { return 0; }
@@ -643,7 +741,8 @@ cat > $test.map <<EOF
 };
 EOF
 if test $shared -eq 1; then
-  LDVERSIONSCRIPT="-Wl,--version-script,$SRCDIR/$MAPNAME"
+  sed < $SRCDIR/zlib${SUFFIX}.map.in "s/@ZLIB_SYMBOL_PREFIX@/$symbol_prefix/g" > zlib${SUFFIX}.map
+  LDVERSIONSCRIPT="-Wl,--version-script,$BUILDDIR/$MAPNAME"
   if try $CC -c $SFLAGS $test.c && try $LDSHARED $LDVERSIONSCRIPT $LDSHAREDFLAGS $LDFLAGS -o $test$shared_ext $test.o $LDSHAREDLIBC; then
     echo "Checking for version script support... $LDVERSIONSCRIPT." | tee -a configure.log
   else
@@ -686,7 +785,7 @@ int main(void) {
   return 0;
 }
 EOF
-  if try $CC $CFLAGS -o $test $test.c $LDSHAREDLIBC; then
+  if try $CC $CFLAGS $ADDITIONAL_CHECK_FLAGS -o $test $test.c $LDSHAREDLIBC; then
     echo "Checking for fseeko... Yes." | tee -a configure.log
   else
     CFLAGS="${CFLAGS} -DNO_FSEEKO"
@@ -696,42 +795,57 @@ EOF
 fi
 echo >> configure.log
 
+# check for cpuid support: GNU extensions
 cat > $test.c <<EOF
-#define _POSIX_C_SOURCE 200112L
-#include <stdlib.h>
+#include <cpuid.h>
+#include <stdio.h>
+static inline void cpuid_gnu(int info, unsigned int *eax, unsigned int *ebx, unsigned int *ecx, unsigned int *edx) {
+    *eax = *ebx = *ecx = *edx = 0;
+    __cpuid(info, *eax, *ebx, *ecx, *edx);
+}
+
 int main(void) {
-  void *ptr = 0;
-  int ret = posix_memalign(&ptr, 64, 10);
-  if (ptr)
-    free(ptr);
-  return ret;
+  unsigned int eax, ebx, ecx, edx;
+  cpuid_gnu(0, &eax, &ebx, &ecx, &edx);
+  printf("%d\n", eax);
+  return eax;
 }
 EOF
 if try $CC $CFLAGS -o $test $test.c $LDSHAREDLIBC; then
-  echo "Checking for posix_memalign... Yes." | tee -a configure.log
-  CFLAGS="${CFLAGS} -DHAVE_POSIX_MEMALIGN"
-  SFLAGS="${SFLAGS} -DHAVE_POSIX_MEMALIGN"
+  echo "Checking for GNU style __cpuid... Yes." | tee -a configure.log
+  CFLAGS="${CFLAGS} -DHAVE_CPUID_GNU"
+  SFLAGS="${SFLAGS} -DHAVE_CPUID_GNU"
 else
-  echo "Checking for posix_memalign... No." | tee -a configure.log
+  echo "Checking for GNU style __cpuid... No." | tee -a configure.log
 fi
 echo >> configure.log
 
+# check for cpuid support: MSVC extensions
 cat > $test.c <<EOF
-#define _ISOC11_SOURCE 1
-#include <stdlib.h>
+#include <intrin.h>
+#include <stdio.h>
+static inline void cpuid_ms(int info, unsigned int *eax, unsigned int *ebx, unsigned int *ecx, unsigned int *edx) {
+    unsigned int registers[4];
+    __cpuid((int *)registers, info);
+    *eax = registers[0];
+    *ebx = registers[1];
+    *ecx = registers[2];
+    *edx = registers[3];
+}
+
 int main(void) {
-  void *ptr = aligned_alloc(64, 10);
-  if (ptr)
-    free(ptr);
+  unsigned int eax, ebx, ecx, edx;
+  cpuid_ms(0, &eax, &ebx, &ecx, &edx);
+  printf("%d\n", eax);
   return 0;
 }
 EOF
 if try $CC $CFLAGS -o $test $test.c $LDSHAREDLIBC; then
-  echo "Checking for aligned_alloc... Yes." | tee -a configure.log
-  CFLAGS="${CFLAGS} -DHAVE_ALIGNED_ALLOC"
-  SFLAGS="${SFLAGS} -DHAVE_ALIGNED_ALLOC"
+  echo "Checking for MS style __cpuid... Yes." | tee -a configure.log
+  CFLAGS="${CFLAGS} -DHAVE_CPUID_MS"
+  SFLAGS="${SFLAGS} -DHAVE_CPUID_MS"
 else
-  echo "Checking for aligned_alloc... No." | tee -a configure.log
+  echo "Checking for MS style __cpuid... No." | tee -a configure.log
 fi
 echo >> configure.log
 
@@ -741,7 +855,7 @@ cat > $test.c <<EOF
 #include <errno.h>
 int main() { return strlen(strerror(errno)); }
 EOF
-if try $CC $CFLAGS -o $test $test.c $LDSHAREDLIBC; then
+if try $CC $CFLAGS $ADDITIONAL_CHECK_FLAGS -o $test $test.c $LDSHAREDLIBC; then
   echo "Checking for strerror... Yes." | tee -a configure.log
 else
   CFLAGS="${CFLAGS} -DNO_STRERROR"
@@ -753,7 +867,7 @@ fi
 cat > $test.c <<EOF
 #include <sys/auxv.h>
 int main() {
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
   int test;
   return elf_aux_info(AT_PAGESZ, &test, sizeof(test));
 #else
@@ -766,7 +880,7 @@ if try $CC $CFLAGS -o $test $test.c $LDSHAREDLIBC; then
   CFLAGS="${CFLAGS} -DHAVE_SYS_AUXV_H"
   SFLAGS="${SFLAGS} -DHAVE_SYS_AUXV_H"
 else
-  echo "Checking for getauxval() in sys/auxv.h... No." | tee -a configure.log
+  echo "Checking for getauxval() or elf_aux_info() in sys/auxv.h... No." | tee -a configure.log
 fi
 
 # We need to remove consigured files (zconf.h etc) from source directory if building outside of it
@@ -776,8 +890,8 @@ if [ "$SRCDIR" != "$BUILDDIR" ]; then
     rm -f $SRCDIR/zlib_name_mangling${SUFFIX}.h
 fi
 
-# Rename @ZLIB_SYMBOL_PREFIX@ to $symbol_prefix in gzread.c, zlib.h and zlib_name_mangling.h
-sed < $SRCDIR/gzread.c.in "s/@ZLIB_SYMBOL_PREFIX@/$symbol_prefix/g" > gzread.c
+# Substitute @ZLIB_SYMBOL_PREFIX@ with $symbol_prefix in gzread_mangle.h, zlib.h and zlib_name_mangling.h
+sed < $SRCDIR/gzread_mangle.h.in "s/@ZLIB_SYMBOL_PREFIX@/$symbol_prefix/g" > gzread_mangle.h
 sed < $SRCDIR/zlib${SUFFIX}.h.in "s/@ZLIB_SYMBOL_PREFIX@/$symbol_prefix/g" > zlib${SUFFIX}.h
 if [ ! -z "$symbol_prefix" ]; then
   sed < $SRCDIR/zlib_name_mangling${SUFFIX}.h.in "s/@ZLIB_SYMBOL_PREFIX@/$symbol_prefix/g" > zlib_name_mangling${SUFFIX}.h
@@ -808,6 +922,22 @@ fi
 
 echo >> configure.log
 
+# check for linux/auxvec.h
+cat > $test.c <<EOF
+#include <linux/auxvec.h>
+int main() { return 0; }
+EOF
+if try $CC -c $CFLAGS $test.c; then
+  echo "Checking for linux/auxvec.h... Yes." | tee -a configure.log
+  CFLAGS="${CFLAGS} -DHAVE_LINUX_AUXVEC_H"
+  SFLAGS="${SFLAGS} -DHAVE_LINUX_AUXVEC_H"
+else
+  echo "Checking for linux/auxvec.h... No." | tee -a configure.log
+fi
+
+echo >> configure.log
+
+
 # check for ptrdiff_t and save result in zconf.h
 printf "Checking for ptrdiff_t... " | tee -a configure.log
 cat > $test.c <<EOF
@@ -875,13 +1005,6 @@ else
   PIC_TESTOBJG="\$(OBJG)"
 fi
 
-# set architecture alignment requirements
-if test $unalignedok -eq 0; then
-  CFLAGS="${CFLAGS} -DNO_UNALIGNED"
-  SFLAGS="${SFLAGS} -DNO_UNALIGNED"
-  echo "Unaligned reads manually disabled." | tee -a configure.log
-fi
-
 # enable reduced memory configuration
 if test $reducedmem -eq 1; then
   echo "Configuring for reduced memory environment." | tee -a configure.log
@@ -926,7 +1049,7 @@ echo "" > test.c
   cat > $test.c <<EOF
 int main() { return 0; }
 EOF
-if test "$gcc" -eq 1 && ($cc $CFLAGS -fno-semantic-interposition -c $test.c) >> configure.log 2>&1; then
+if test "$gcc" -eq 1 && ($cc $CFLAGS $ADDITIONAL_CHECK_FLAGS -fno-semantic-interposition -c $test.c) >> configure.log 2>&1; then
   echo "Checking for -fno-semantic-interposition... Yes." | tee -a configure.log
   SFLAGS="$SFLAGS -fno-semantic-interposition"
 else
@@ -940,6 +1063,7 @@ int main() { return 0; }
 EOF
   if $cc $CFLAGS -fno-lto -c $test.c >> configure.log 2>&1; then
     echo "Checking for -fno-lto... Yes." | tee -a configure.log
+    noltoflag="-fno-lto"
   else
     echo "Checking for -fno-lto... No." | tee -a configure.log
     noltoflag=""
@@ -1115,11 +1239,15 @@ check_avx512vnni_intrinsics() {
     # Check whether compiler supports AVX512-VNNI intrinsics
     cat > $test.c << EOF
 #include <immintrin.h>
-__m512i f(__m512i x, __m512i y) {
-    __m512i z = _mm512_setzero_epi32();
-    return _mm512_dpbusd_epi32(z, x, y);
+int main(void) {
+    const __m512i z512 = _mm512_setzero_si512();
+    const __m256i z256 = _mm256_setzero_si256();
+    volatile __m512i r512 = _mm512_dpbusd_epi32(z512, z512, z512);
+    volatile __m256i r256 = _mm256_dpbusd_epi32(z256, z256, z256);
+    (void)r512;
+    (void)r256;
+    return 0;
 }
-int main(void) { return 0; }
 EOF
     if try ${CC} ${CFLAGS} ${avx512vnniflag} $test.c; then
         echo "Checking for AVX512VNNI intrinsics ... Yes." | tee -a configure.log
@@ -1130,25 +1258,58 @@ EOF
     fi
 }
 
-check_acle_compiler_flag() {
+check_armv8_intrinsics() {
     # Check whether -march=armv8-a+crc works correctly
     cat > $test.c << EOF
 int main() { return 0; }
 EOF
     if try $CC -c $CFLAGS -march=armv8-a+crc $test.c; then
         echo "Check whether -march=armv8-a+crc works ... Yes." | tee -a configure.log
-        acleflag="-march=armv8-a+crc"
+        armv8flag="-march=armv8-a+crc"
     else
         echo "Check whether -march=armv8-a+crc works ... No." | tee -a configure.log
         if try $CC -c $CFLAGS -march=armv8-a+crc+simd $test.c; then
             echo "Check whether -march=armv8-a+crc+simd works ... Yes." | tee -a configure.log
-            acleflag="-march=armv8-a+crc+simd"
+            armv8flag="-march=armv8-a+crc+simd"
         else
             echo "Check whether -march=armv8-a+crc+simd works ... No." | tee -a configure.log
+            if try $CC -c $CFLAGS -Wa,-march=armv8-a+crc $test.c; then
+                echo "Check whether -Wa,-march=armv8-a+crc works ... Yes." | tee -a configure.log
+                armv8flag="-Wa,-march=armv8-a+crc"
+            else
+                echo "Check whether -Wa,-march=armv8-a+crc works ... No." | tee -a configure.log
+                if try $CC -c $CFLAGS -Wa,-march=armv8-a+crc+simd $test.c; then
+                    echo "Check whether -Wa,-march=armv8-a+crc+simd works ... Yes." | tee -a configure.log
+                    armv8flag="-Wa,-march=armv8-a+crc+simd"
+                else
+                    echo "Check whether -Wa,-march=armv8-a+crc+simd works ... No." | tee -a configure.log
+                fi
+            fi
         fi
     fi
 
-    # Check whether compiler supports ARMv8 CRC intrinsics
+    # Check whether compiler supports ARMv8 inline asm
+    cat > $test.c << EOF
+unsigned int f(unsigned int a, unsigned int b) {
+    unsigned int c;
+#ifdef __aarch64__
+    __asm__("crc32w %w0, %w1, %w2" : "=r" (c) : "r"(a), "r"(b));
+#else
+    __asm__("crc32w %0, %1, %2" : "=r" (c) : "r"(a), "r"(b));
+#endif
+    return c;
+}
+int main(void) { return 0; }
+EOF
+    if try ${CC} ${CFLAGS} ${armv8flag} $test.c; then
+        echo "Checking for ARMv8 inline assembly ... Yes." | tee -a configure.log
+        HAVE_ARMV8_INLINE_ASM=1
+    else
+        echo "Checking for ARMv8 inline assembly ... No." | tee -a configure.log
+        HAVE_ARMV8_INLINE_ASM=0
+    fi
+
+    # Check whether compiler supports ARMv8 intrinsics
     cat > $test.c << EOF
 #include <arm_acle.h>
 unsigned int f(unsigned int a, unsigned int b) {
@@ -1156,12 +1317,55 @@ unsigned int f(unsigned int a, unsigned int b) {
 }
 int main(void) { return 0; }
 EOF
-    if try ${CC} ${CFLAGS} ${acleflag} $test.c; then
-        echo "Checking for ARMv8 CRC intrinsics ... Yes." | tee -a configure.log
-        ACLE_AVAILABLE=1
+    if try ${CC} ${CFLAGS} ${armv8flag} $test.c; then
+        echo "Checking for ARMv8 intrinsics ... Yes." | tee -a configure.log
+        HAVE_ARMV8_INTRIN=1
     else
-        echo "Checking for ARMv8 CRC intrinsics ... No." | tee -a configure.log
-        ACLE_AVAILABLE=0
+        echo "Checking for ARMv8 intrinsics ... No." | tee -a configure.log
+        HAVE_ARMV8_INTRIN=0
+    fi
+}
+
+check_armv8_pmull_eor3_intrinsics() {
+    # Check whether -march=armv8.2-a+crc+crypto+sha3 works correctly
+    cat > $test.c << EOF
+int main() { return 0; }
+EOF
+    if try $CC -c $CFLAGS -march=armv8.2-a+crc+crypto+sha3 $test.c; then
+        echo "Check whether -march=armv8.2-a+crc+crypto+sha3 works ... Yes." | tee -a configure.log
+        pmulleor3flag="-march=armv8.2-a+crc+crypto+sha3"
+    else
+        echo "Check whether -march=armv8.2-a+crc+crypto+sha3 works ... No." | tee -a configure.log
+        if try $CC -c $CFLAGS -march=armv8-a+crc+crypto+sha3 $test.c; then
+            echo "Check whether -march=armv8-a+crc+crypto+sha3 works ... Yes." | tee -a configure.log
+            pmulleor3flag="-march=armv8-a+crc+crypto+sha3"
+        else
+            echo "Check whether -march=armv8-a+crc+crypto+sha3 works ... No." | tee -a configure.log
+            pmulleor3flag=""
+        fi
+    fi
+
+    # Check whether compiler supports ARMv8 PMULL + EOR3 intrinsics
+    if test -n "$pmulleor3flag"; then
+        cat > $test.c << EOF
+#include <arm_neon.h>
+poly128_t f(poly64_t a, poly64_t b) {
+    return vmull_p64(a, b);
+}
+uint64x2_t g(uint64x2_t a, uint64x2_t b, uint64x2_t c) {
+    return veor3q_u64(a, b, c);
+}
+int main(void) { return 0; }
+EOF
+        if try ${CC} ${CFLAGS} ${pmulleor3flag} $test.c; then
+            echo "Checking for ARMv8 PMULL+EOR3 intrinsics ... Yes." | tee -a configure.log
+            HAVE_PMULL_EOR3_INTRIN=1
+        else
+            echo "Checking for ARMv8 PMULL+EOR3 intrinsics ... No." | tee -a configure.log
+            HAVE_PMULL_EOR3_INTRIN=0
+        fi
+    else
+        HAVE_PMULL_EOR3_INTRIN=0
     fi
 }
 
@@ -1218,13 +1422,19 @@ EOF
         echo "Check whether -march=armv6 works ... Yes." | tee -a configure.log
     else
         echo "Check whether -march=armv6 works ... No." | tee -a configure.log
+        if try $CC -c $CFLAGS -Wa,-march=armv6 $test.c; then
+            armv6flag=-Wa,-march=armv6
+            echo "Check whether -Wa,-march=armv6 works ... Yes." | tee -a configure.log
+        else
+            echo "Check whether -Wa,-march=armv6 works ... No." | tee -a configure.log
+        fi
     fi
 
     # Check whether compiler supports ARMv6 inline asm
     cat > $test.c << EOF
 unsigned int f(unsigned int a, unsigned int b) {
     unsigned int c;
-    __asm__ __volatile__ ( "uqsub16 %0, %1, %2" : "=r" (c) : "r" (a), "r" (b) );
+    __asm__("uqsub16 %0, %1, %2" : "=r" (c) : "r" (a), "r" (b));
     return c;
 }
 int main(void) { return 0; }
@@ -1243,7 +1453,7 @@ EOF
 unsigned int f(unsigned int a, unsigned int b) {
     return __uqsub16(a, b);
 }
-int main(void) { return 0; }
+int main(void) { return f(1, 2); }
 EOF
     if try ${CC} ${CFLAGS} ${armv6flag} $test.c; then
         echo "Checking for ARMv6 intrinsics ... Yes." | tee -a configure.log
@@ -1343,7 +1553,7 @@ EOF
 #endif
 #include <sys/auxv.h>
 int main() {
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
   unsigned long hwcap;
   elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
   return (hwcap & PPC_FEATURE_HAS_ALTIVEC);
@@ -1369,7 +1579,7 @@ check_power8_intrinsics() {
 #endif
 #include <sys/auxv.h>
 int main() {
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
   unsigned long hwcap;
   elf_aux_info(AT_HWCAP2, &hwcap, sizeof(hwcap));
   return (hwcap & PPC_FEATURE2_ARCH_2_07);
@@ -1395,7 +1605,7 @@ check_power9_intrinsics() {
 #endif
 #include <sys/auxv.h>
 int main() {
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
   unsigned long hwcap;
   elf_aux_info(AT_HWCAP2, &hwcap, sizeof(hwcap));
   return (hwcap & PPC_FEATURE2_ARCH_3_00);
@@ -1429,6 +1639,22 @@ EOF
     fi
 }
 
+check_sse41_intrinsics() {
+    # Check whether compiler supports SSE4.1 intrinsics
+    cat > $test.c << EOF
+#include <smmintrin.h>
+__m128i f(__m128i a, __m128i b) { return _mm_min_epi32(a, b); }
+int main(void) { return 0; }
+EOF
+    if try ${CC} ${CFLAGS} ${sse41flag} $test.c; then
+        echo "Checking for SSE4.1 intrinsics ... Yes." | tee -a configure.log
+        HAVE_SSE41_INTRIN=1
+    else
+        echo "Checking for SSE4.1 intrinsics ... No." | tee -a configure.log
+        HAVE_SSE41_INTRIN=0
+    fi
+}
+
 check_sse42_intrinsics() {
     # Check whether compiler supports SSE4.2 intrinsics
     cat > $test.c << EOF
@@ -1500,21 +1726,169 @@ EOF
     fi
 }
 
+check_la64_crc_intrinsics() {
+    # Check whether "crc" intrinsic is available
+
+    cat > $test.c << EOF
+#include <larchintrin.h>
+int main(void) {
+    char ch = 'a';
+    int crc = __crc_w_b_w(ch, 0);
+    return crc;
+}
+EOF
+    printf "Checking for CRC support... " | tee -a configure.log
+    if try $CC -c $CFLAGS $test.c; then
+        HAVE_LA64_CRC_INTRIN=1
+        echo "Yes." | tee -a configure.log
+    else
+        HAVE_LA64_CRC_INTRIN=0
+        echo "No." | tee -a configure.log
+    fi
+}
+
+check_lsx_intrinsics() {
+    # Check whether compiler supports LSX intrinsics
+    cat > $test.c << EOF
+#include <lsxintrin.h>
+__m128i f(__m128i a, __m128i b) {
+    return __lsx_vabsd_b(a, b);
+}
+int main(void) { return 0; }
+EOF
+    if try ${CC} ${CFLAGS} ${lsxflag} $test.c; then
+        echo "Checking for LSX intrinsics ... Yes." | tee -a configure.log
+        HAVE_LSX_INTRIN=1
+    else
+        echo "Checking for LSX intrinsics ... No." | tee -a configure.log
+        HAVE_LSX_INTRIN=0
+    fi
+}
+
+check_lasx_intrinsics() {
+    # Check whether compiler supports LASX intrinsics
+    cat > $test.c << EOF
+#include <lasxintrin.h>
+__m256i f(__m256i a, __m256i b) {
+    return __lasx_xvabsd_b(a, b);
+}
+int main(void) { return 0; }
+EOF
+    if try ${CC} ${CFLAGS} ${lasxflag} $test.c; then
+        echo "Checking for LASX intrinsics ... Yes." | tee -a configure.log
+        HAVE_LASX_INTRIN=1
+    else
+        echo "Checking for LASX intrinsics ... No." | tee -a configure.log
+        HAVE_LASX_INTRIN=0
+    fi
+}
+
+check_rvv_compiler_flag() {
+    cat > $test.c << EOF
+int main() { return 0; }
+EOF
+    if try $CC -c $CFLAGS -march=rv64gcv $test.c; then
+        echo "Check whether -march=rv64gcv works ... Yes." | tee -a configure.log
+        rvvflag="-march=rv64gcv"
+    else
+        echo "Check whether -march=rv64gcv works ... No." | tee -a configure.log
+        if try $CC -c $CFLAGS -march=rv64gc_zve64x $test.c; then
+            echo "Check whether -march=rv64gc_zve64x works ... Yes." | tee -a configure.log
+            rvvflag="-march=rv64gc_zve64x"
+        else
+            echo "Check whether -march=rv64gc_zve64x works ... No." | tee -a configure.log
+            rvvflag=""
+        fi
+    fi
+
+    cat > $test.c << EOF
+#include <riscv_vector.h>
+int main(void) {
+    size_t vl = __riscv_vsetvlmax_e8m1();
+    return vl;
+}
+EOF
+    if [ -n "$rvvflag" ] && try ${CC} ${CFLAGS} ${rvvflag} $test.c; then
+        echo "Checking for RISC-V Vector intrinsics ... Yes." | tee -a configure.log
+        HAVE_RVV_INTRIN=1
+        rvvzbcflag="${rvvflag}"
+    else
+        echo "Checking for RISC-V Vector intrinsics ... No." | tee -a configure.log
+        HAVE_RVV_INTRIN=0
+    fi
+}
+
+check_zbc_compiler_flag() {
+    cat > $test.c << EOF
+int main() { return 0; }
+EOF
+    if try $CC -c $CFLAGS -march=rv64gc_zbc $test.c; then
+        echo "Check whether -march=rv64gc_zbc works ... Yes." | tee -a configure.log
+        zbcflag="-march=rv64gc_zbc"
+        if test $buildrvv -eq 1 -a "$HAVE_RVV_INTRIN" -eq 1; then
+            rvvzbcflag="${rvvflag}_zbc"
+        else
+            rvvzbcflag="${zbcflag}"
+        fi
+    else
+        echo "Check whether -march=rv64gc_zbc works ... No." | tee -a configure.log
+        zbcflag=""
+    fi
+
+  cat > $test.c << EOF
+#include <stdint.h>
+uint64_t f(uint64_t a, uint64_t b) {
+    uint64_t c;
+    __asm__ __volatile__ ("clmul %[result], %[input_a], %[input_b]" : [result] "=r" (c) : [input_a] "r" (a), [input_b] "r" (b));
+    return c;
+}
+int main(void) { return f(1, 2); }
+EOF
+    if [ -n "$zbcflag" ] && try ${CC} ${CFLAGS} ${zbcflag} $test.c; then
+        echo "Checking for RISC-V ZBC extension ... Yes." | tee -a configure.log
+        HAVE_ZBC_EXT=1
+    else
+        echo "Checking for RISC-V ZBC extension ... No." | tee -a configure.log
+        HAVE_ZBC_EXT=0
+    fi
+}
+
 # Check whether to disable deflate_medium and deflate_quick
 if test $without_new_strategies -eq 1; then
     CFLAGS="${CFLAGS} -DNO_QUICK_STRATEGY -DNO_MEDIUM_STRATEGY"
     SFLAGS="${SFLAGS} -DNO_QUICK_STRATEGY -DNO_MEDIUM_STRATEGY"
 fi
 
+# CMake can exclude building some of the generic fallback functions,
+# configure does not have the detection code to do so.
+CFLAGS="${CFLAGS} -DWITH_ALL_FALLBACKS"
+SFLAGS="${SFLAGS} -DWITH_ALL_FALLBACKS"
+
+if test $without_optimizations -eq 0; then
+    CFLAGS="${CFLAGS} -DWITH_OPTIM"
+    SFLAGS="${SFLAGS} -DWITH_OPTIM"
+fi
+
 ARCHDIR='arch/generic'
 ARCH_STATIC_OBJS=''
 ARCH_SHARED_OBJS=''
 
+# Set ARCH bitness defines
+if test -n "$ARCH_64BIT"; then
+    CFLAGS="${CFLAGS} -DARCH_64BIT"
+    SFLAGS="${SFLAGS} -DARCH_64BIT"
+elif test -n "$ARCH_32BIT"; then
+    CFLAGS="${CFLAGS} -DARCH_32BIT"
+    SFLAGS="${SFLAGS} -DARCH_32BIT"
+fi
+
 # Set ARCH specific FLAGS
 case "${ARCH}" in
     # x86/amd64 specific optimizations
-    i386 | i486 | i586 | i686 |x86_64)
+    i386 | i486 | i586 | i686 | amd64 | x86_64)
         ARCHDIR=arch/x86
+        CFLAGS="${CFLAGS} -DARCH_X86"
+        SFLAGS="${SFLAGS} -DARCH_X86"
 
         # Enable arch-specific optimizations
         if test $without_optimizations -eq 0; then
@@ -1538,13 +1912,8 @@ case "${ARCH}" in
             if test ${HAVE_SSE2_INTRIN} -eq 1; then
                 CFLAGS="${CFLAGS} -DX86_SSE2"
                 SFLAGS="${SFLAGS} -DX86_SSE2"
-                ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} chunkset_sse2.o compare256_sse2.o slide_hash_sse2.o"
-                ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} chunkset_sse2.lo compare256_sse2.lo slide_hash_sse2.lo"
-
-                if test $forcesse2 -eq 1; then
-                    CFLAGS="${CFLAGS} -DX86_NOCHECK_SSE2"
-                    SFLAGS="${SFLAGS} -DX86_NOCHECK_SSE2"
-                fi
+                ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} chunkset_sse2.o chorba_sse2.o compare256_sse2.o slide_hash_sse2.o"
+                ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} chunkset_sse2.lo chorba_sse2.lo compare256_sse2.lo slide_hash_sse2.lo"
             fi
 
             check_ssse3_intrinsics
@@ -1556,6 +1925,15 @@ case "${ARCH}" in
                 ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} adler32_ssse3.lo chunkset_ssse3.lo"
             fi
 
+            check_sse41_intrinsics
+
+            if test ${HAVE_SSE41_INTRIN} -eq 1; then
+                CFLAGS="${CFLAGS} -DX86_SSE41"
+                SFLAGS="${SFLAGS} -DX86_SSE41"
+                ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} chorba_sse41.o"
+                ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} chorba_sse41.lo"
+            fi
+
             check_sse42_intrinsics
 
             if test ${HAVE_SSE42_INTRIN} -eq 1; then
@@ -1588,8 +1966,8 @@ case "${ARCH}" in
             if test ${HAVE_AVX512_INTRIN} -eq 1; then
                 CFLAGS="${CFLAGS} -DX86_AVX512"
                 SFLAGS="${SFLAGS} -DX86_AVX512"
-                ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} adler32_avx512.o"
-                ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} adler32_avx512.lo"
+                ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} adler32_avx512.o chunkset_avx512.o compare256_avx512.o"
+                ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} adler32_avx512.lo chunkset_avx512.lo compare256_avx512.lo"
             fi
 
             check_mtune_cascadelake_compiler_flag
@@ -1639,6 +2017,8 @@ case "${ARCH}" in
         esac
 
         ARCHDIR=arch/arm
+        CFLAGS="${CFLAGS} -DARCH_ARM"
+        SFLAGS="${SFLAGS} -DARCH_ARM"
 
         cat > $test.c << EOF
 int main() { return 0; }
@@ -1746,15 +2126,52 @@ EOF
                 fi
             fi
 
-            if test $buildacle -eq 1; then
-                check_acle_compiler_flag
-
-                if test $ACLE_AVAILABLE -eq 1; then
-                    CFLAGS="${CFLAGS} -DARM_ACLE"
-                    SFLAGS="${SFLAGS} -DARM_ACLE"
+            if test $FREEBSD -eq 1 -o $OPENBSD -eq 1; then
+                if test "$ARCH" = "aarch64"; then
+                    cat > $test.c <<EOF
+#include <sys/auxv.h>
+int main() {
+    unsigned long hwcap;
+    elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
+    return (hwcap & HWCAP_CRC32);
+}
+EOF
+                    if try $CC -c $CFLAGS $test.c; then
+                        CFLAGS="${CFLAGS} -DARM_AUXV_HAS_CRC32"
+                        SFLAGS="${SFLAGS} -DARM_AUXV_HAS_CRC32"
+                    else
+                        echo "HWCAP_CRC32 not present in sys/auxv.h; cannot detect support at runtime." | tee -a configure.log
+                    fi
+                else
+                    cat > $test.c <<EOF
+#include <sys/auxv.h>
+int main() {
+    unsigned long hwcap2;
+    elf_aux_info(AT_HWCAP2, &hwcap2, sizeof(hwcap2));
+    return (hwcap2 & HWCAP2_CRC32);
+}
+EOF
+                    if try $CC -c $CFLAGS $test.c; then
+                        CFLAGS="${CFLAGS} -DARM_AUXV_HAS_CRC32"
+                        SFLAGS="${SFLAGS} -DARM_AUXV_HAS_CRC32"
+                    else
+                        echo "HWCAP2_CRC32 not present in sys/auxv.h; cannot detect support at runtime." | tee -a configure.log
+                    fi
 
-                    ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} crc32_acle.o"
-                    ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} crc32_acle.lo"
+                    cat > $test.c <<EOF
+#include <sys/auxv.h>
+int main() {
+    unsigned long hwcap;
+    elf_aux_info(AT_HWCAP, &hwcap, sizeof(hwcap));
+    return (hwcap & HWCAP_NEON);
+}
+EOF
+                    if try $CC -c $CFLAGS $test.c; then
+                        CFLAGS="${CFLAGS} -DARM_AUXV_HAS_NEON"
+                        SFLAGS="${SFLAGS} -DARM_AUXV_HAS_NEON"
+                    else
+                        echo "HWCAP_NEON not present in sys/auxv.h; cannot detect support at runtime." | tee -a configure.log
+                    fi
                 fi
             fi
 
@@ -1794,6 +2211,35 @@ EOF
                 fi
             fi
 
+            if test $buildarmv8 -eq 1; then
+                check_armv8_intrinsics
+
+                if test $HAVE_ARMV8_INTRIN -eq 1 || test $HAVE_ARMV8_INLINE_ASM -eq 1; then
+                    CFLAGS="${CFLAGS} -DARM_CRC32"
+                    SFLAGS="${SFLAGS} -DARM_CRC32"
+
+                    if test $HAVE_ARMV8_INTRIN -eq 1; then
+                        CFLAGS="${CFLAGS} -DARM_CRC32_INTRIN"
+                        SFLAGS="${SFLAGS} -DARM_CRC32_INTRIN"
+                    fi
+
+                    ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} crc32_armv8.o"
+                    ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} crc32_armv8.lo"
+
+                    # Check for PMULL support (requires NEON too)
+                    if test $buildneon -eq 1 && test $NEON_AVAILABLE -eq 1; then
+                        # Check for PMULL+EOR3 support (ARMv8.2-A SHA3 extension)
+                        check_armv8_pmull_eor3_intrinsics
+
+                        if test $HAVE_PMULL_EOR3_INTRIN -eq 1; then
+                            CFLAGS="${CFLAGS} -DARM_PMULL_EOR3"
+                            SFLAGS="${SFLAGS} -DARM_PMULL_EOR3"
+                            ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} crc32_armv8_pmull_eor3.o"
+                            ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} crc32_armv8_pmull_eor3.lo"
+                        fi
+                    fi
+                fi
+            fi
         fi
     ;;
     powerpc*)
@@ -1810,6 +2256,8 @@ EOF
         esac
 
         ARCHDIR=arch/power
+        CFLAGS="${CFLAGS} -DARCH_POWER"
+        SFLAGS="${SFLAGS} -DARCH_POWER"
 
         if test $without_optimizations -eq 0; then
 
@@ -1856,9 +2304,51 @@ EOF
             fi
         fi
     ;;
+    riscv64)
+        [ ! -z $CROSS_PREFIX ] && QEMU_ARCH=riscv64
+        ARCHDIR=arch/riscv
+        CFLAGS="${CFLAGS} -DARCH_RISCV"
+        SFLAGS="${SFLAGS} -DARCH_RISCV"
+
+        if test $without_optimizations -eq 0; then
+            if test $buildrvv -eq 1 -o $buildzbc -eq 1; then
+                CFLAGS="${CFLAGS} -DRISCV_FEATURES"
+                SFLAGS="${SFLAGS} -DRISCV_FEATURES"
+
+                ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} riscv_features.o"
+                ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} riscv_features.lo"
+            fi
+            if test $buildrvv -eq 1; then
+            check_rvv_compiler_flag
+
+                if test $HAVE_RVV_INTRIN -eq 1; then
+                    CFLAGS="${CFLAGS} -DRISCV_FEATURES -DRISCV_RVV"
+                    SFLAGS="${SFLAGS} -DRISCV_FEATURES -DRISCV_RVV"
+
+                    ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} adler32_rvv.o chunkset_rvv.o compare256_rvv.o slide_hash_rvv.o"
+                    ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} adler32_rvv.lo chunkset_rvv.lo compare256_rvv.lo slide_hash_rvv.lo"
+
+                    ARCH="${ARCH}+rvv"
+                fi
+            fi
+            if test $buildzbc -eq 1; then
+            check_zbc_compiler_flag
+
+                if test $HAVE_ZBC_EXT -eq 1; then
+                    CFLAGS="${CFLAGS} -DRISCV_CRC32_ZBC"
+                    SFLAGS="${SFLAGS} -DRISCV_CRC32_ZBC"
+
+                    ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} crc32_zbc.o"
+                    ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} crc32_zbc.lo"
+                fi
+            fi
+        fi
+    ;;
     s390x)
         [ ! -z $CROSS_PREFIX ] && QEMU_ARCH=s390x
         ARCHDIR=arch/s390
+        CFLAGS="${CFLAGS} -DARCH_S390"
+        SFLAGS="${SFLAGS} -DARCH_S390"
 
         if test $without_optimizations -eq 0; then
             if test $buildcrc32vx -eq 1; then
@@ -1896,6 +2386,50 @@ EOF
             fi
         fi
     ;;
+    # loongarch specific optimizations
+    loongarch64)
+        ARCHDIR=arch/loongarch
+        CFLAGS="${CFLAGS} -DARCH_LOONGARCH"
+        SFLAGS="${SFLAGS} -DARCH_LOONGARCH"
+
+        # Enable arch-specific optimizations
+        if test $without_optimizations -eq 0; then
+            CFLAGS="${CFLAGS} -DLOONGARCH_FEATURES"
+            SFLAGS="${SFLAGS} -DLOONGARCH_FEATURES"
+
+            ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} loongarch_features.o"
+            ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} loongarch_features.lo"
+
+            if test $buildcrc32la -eq 1; then
+                check_la64_crc_intrinsics
+                if test $HAVE_LA64_CRC_INTRIN -eq 1; then
+                    CFLAGS="${CFLAGS} -DLOONGARCH_CRC"
+                    SFLAGS="${SFLAGS} -DLOONGARCH_CRC"
+                    ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} crc32_la.o"
+                    ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} crc32_la.lo"
+                fi
+            fi
+
+            check_lsx_intrinsics
+            if test $HAVE_LSX_INTRIN -eq 1; then
+                CFLAGS="${CFLAGS} -DLOONGARCH_LSX"
+                SFLAGS="${SFLAGS} -DLOONGARCH_LSX"
+
+                ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} adler32_lsx.o chunkset_lsx.o compare256_lsx.o slide_hash_lsx.o"
+                ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} adler32_lsx.lo chunkset_lsx.lo compare256_lsx.lo slide_hash_lsx.lo"
+            fi
+
+            check_lasx_intrinsics
+            if test $HAVE_LASX_INTRIN -eq 1; then
+                CFLAGS="${CFLAGS} -DLOONGARCH_LASX"
+                SFLAGS="${SFLAGS} -DLOONGARCH_LASX"
+
+                ARCH_STATIC_OBJS="${ARCH_STATIC_OBJS} adler32_lasx.o chunkset_lasx.o compare256_lasx.o slide_hash_lasx.o"
+                ARCH_SHARED_OBJS="${ARCH_SHARED_OBJS} adler32_lasx.lo chunkset_lasx.lo compare256_lasx.lo slide_hash_lasx.lo"
+            fi
+        fi
+    ;;
+
     *)
         [ ! -z $CROSS_PREFIX ] && QEMU_ARCH=$ARCH
     ;;
@@ -1945,6 +2479,7 @@ echo TEST = $TEST >> configure.log
 echo VER = $VER >> configure.log
 echo exec_prefix = $exec_prefix >> configure.log
 echo includedir = $includedir >> configure.log
+echo installnamedir = $installnamedir >> configure.log
 echo bindir = $bindir >> configure.log
 echo libdir = $libdir >> configure.log
 echo mandir = $mandir >> configure.log
@@ -1958,9 +2493,12 @@ echo sse42flag = $sse42flag >> configure.log
 echo pclmulflag = $pclmulflag >> configure.log
 echo vpclmulflag = $vpclmulflag >> configure.log
 echo xsaveflag = $xsaveflag >> configure.log
-echo acleflag = $acleflag >> configure.log
+echo armv8flag = $armv8flag >> configure.log
+echo pmulleor3flag = $pmulleor3flag >> configure.log
 echo neonflag = $neonflag >> configure.log
 echo armv6flag = $armv6flag >> configure.log
+echo lsxflag = $lsxflag >> configure.log
+echo lasxflag = $lasxflag >> configure.log
 echo ARCHDIR = ${ARCHDIR} >> configure.log
 echo ARCH_STATIC_OBJS = ${ARCH_STATIC_OBJS} >> configure.log
 echo ARCH_SHARED_OBJS = ${ARCH_SHARED_OBJS} >> configure.log
@@ -1976,7 +2514,7 @@ replace_in_file() {
 
 # update Makefile with the configure results
 
-INCLUDES="-I$SRCDIR -I$SRCDIR/$ARCHDIR -I$SRCDIR/arch/generic"
+INCLUDES="-I$SRCDIR"
 if [ "$SRCDIR" != "$BUILDDIR" ]; then INCLUDES="-I$BUILDDIR ${INCLUDES}"; fi
 
 sed < $SRCDIR/Makefile.in "
@@ -2016,6 +2554,7 @@ sed < $SRCDIR/Makefile.in "
 /^libdir *=/s#=.*#= $libdir#
 /^sharedlibdir *=/s#=.*#= $sharedlibdir#
 /^includedir *=/s#=.*#= $includedir#
+/^installnamedir *=/s#=.*#= $installnamedir#
 /^mandir *=/s#=.*#= $mandir#
 /^SRCDIR *=/s#=.*#=$SRCDIR#
 /^INCLUDES *=/s#=.*#=$INCLUDES#
@@ -2038,7 +2577,7 @@ for file in $SRCDIR/*.c $SRCDIR/test/*.c $SRCDIR/test/fuzz/*.c $SRCDIR/$ARCHDIR/
     fi
 
     short_name=$(echo $file | sed -e "s#$SRCDIR/##g")
-    incs=$(grep -h include $file | sed -n 's/# *\include *"\(.*\.h\)".*/\1/p' | sort | uniq)
+    incs=$(grep -h include $file | sed -n 's/# *include *"\(.*\.h\)".*/\1/p' | sort | uniq)
     includes=$(for i in $incs; do
                    # Check that the include file exists in the current dir,
                    # otherwise it may be one of the system include header.
@@ -2095,16 +2634,23 @@ sed < $SRCDIR/$ARCHDIR/Makefile.in "
 /^AVX512VNNIFLAG *=/s#=.*#=$avx512vnniflag#
 /^SSE2FLAG *=/s#=.*#=$sse2flag#
 /^SSSE3FLAG *=/s#=.*#=$ssse3flag#
+/^SSE41FLAG *=/s#=.*#=$sse41flag#
 /^SSE42FLAG *=/s#=.*#=$sse42flag#
 /^PCLMULFLAG *=/s#=.*#=$pclmulflag#
 /^VPCLMULFLAG *=/s#=.*#=$vpclmulflag#
 /^XSAVEFLAG *=/s#=.*#=$xsaveflag#
-/^ACLEFLAG *=/s#=.*#=$acleflag#
+/^ARMV8FLAG *=/s#=.*#=$armv8flag#
+/^PMULLEOR3FLAG *=/s#=.*#=$pmulleor3flag#
 /^NEONFLAG *=/s#=.*#=$neonflag#
 /^ARMV6FLAG *=/s#=.*#=$armv6flag#
 /^NOLTOFLAG *=/s#=.*#=$noltoflag#
 /^VGFMAFLAG *=/s#=.*#=$vgfmaflag#
 /^PPCFLAGS *=/s#=.*#=$vmxflag#
+/^RVVFLAG *=/s#=.*#=$rvvflag#
+/^RVVZBCFLAG *=/s#=.*#=$rvvzbcflag#
+/^ZBCFLAG *=/s#=.*#=$zbcflag#
+/^LSXFLAG *=/s#=.*#=$lsxflag#
+/^LASXFLAG *=/s#=.*#=$lasxflag#
 " > $ARCHDIR/Makefile
 
 # Append header files dependencies.
@@ -2113,7 +2659,7 @@ for file in $SRCDIR/$ARCHDIR/*.c; do
         continue
     fi
 
-    incs=$(grep -h include $file | sed -n 's/# *\include *"\(.*\.h\)".*/\1/p' | sort | uniq)
+    incs=$(grep -h include $file | sed -n 's/# *include *"\(.*\.h\)".*/\1/p' | sort | uniq)
     includes=$(for i in $incs; do
                    # Check that the include file exists in the current dir,
                    # otherwise it may be one of the system include header.
@@ -2215,6 +2761,7 @@ sed < $SRCDIR/zlib.pc.in "
 /^libdir *=/s#=.*#=$libdir#
 /^sharedlibdir *=/s#=.*#=$sharedlibdir#
 /^includedir *=/s#=.*#=$includedir#
+/^installnamedir *=/s#=.*#=$installnamedir#
 /^mandir *=/s#=.*#=$mandir#
 /^LDFLAGS *=/s#=.*#=$LDFLAGS#
 " | sed -e "
diff --git a/cpu_features.c b/cpu_features.c
index 3585172e..fde65192 100644
--- a/cpu_features.c
+++ b/cpu_features.c
@@ -19,5 +19,7 @@ Z_INTERNAL void cpu_check_features(struct cpu_features *features) {
     s390_check_features(&features->s390);
 #elif defined(RISCV_FEATURES)
     riscv_check_features(&features->riscv);
+#elif defined(LOONGARCH_FEATURES)
+    loongarch_check_features(&features->loongarch);
 #endif
 }
diff --git a/cpu_features.h b/cpu_features.h
index 8708724b..2b6cc4e8 100644
--- a/cpu_features.h
+++ b/cpu_features.h
@@ -18,6 +18,8 @@
 #  include "arch/s390/s390_features.h"
 #elif defined(RISCV_FEATURES)
 #  include "arch/riscv/riscv_features.h"
+#elif defined(LOONGARCH_FEATURES)
+#  include "arch/loongarch/loongarch_features.h"
 #endif
 
 struct cpu_features {
@@ -31,6 +33,8 @@ struct cpu_features {
     struct s390_cpu_features s390;
 #elif defined(RISCV_FEATURES)
     struct riscv_cpu_features riscv;
+#elif defined(LOONGARCH_FEATURES)
+    struct loongarch_cpu_features loongarch;
 #else
     char empty;
 #endif
diff --git a/crc32.c b/crc32.c
index 54f6ecd4..e31fff62 100644
--- a/crc32.c
+++ b/crc32.c
@@ -19,24 +19,28 @@ const uint32_t * Z_EXPORT PREFIX(get_crc_table)(void) {
 
 #ifdef ZLIB_COMPAT
 unsigned long Z_EXPORT PREFIX(crc32_z)(unsigned long crc, const unsigned char *buf, size_t len) {
-    if (buf == NULL) return 0;
-
+    if (buf == NULL)
+        return CRC32_INITIAL_VALUE;
     return (unsigned long)FUNCTABLE_CALL(crc32)((uint32_t)crc, buf, len);
 }
 #else
 uint32_t Z_EXPORT PREFIX(crc32_z)(uint32_t crc, const unsigned char *buf, size_t len) {
-    if (buf == NULL) return 0;
-
+    if (buf == NULL)
+        return CRC32_INITIAL_VALUE;
     return FUNCTABLE_CALL(crc32)(crc, buf, len);
 }
 #endif
 
 #ifdef ZLIB_COMPAT
 unsigned long Z_EXPORT PREFIX(crc32)(unsigned long crc, const unsigned char *buf, unsigned int len) {
-    return (unsigned long)PREFIX(crc32_z)((uint32_t)crc, buf, len);
+    if (buf == NULL)
+        return CRC32_INITIAL_VALUE;
+    return (unsigned long)FUNCTABLE_CALL(crc32)((uint32_t)crc, buf, len);
 }
 #else
 uint32_t Z_EXPORT PREFIX(crc32)(uint32_t crc, const unsigned char *buf, uint32_t len) {
-    return PREFIX(crc32_z)(crc, buf, len);
+    if (buf == NULL)
+        return CRC32_INITIAL_VALUE;
+    return FUNCTABLE_CALL(crc32)(crc, buf, len);
 }
 #endif
diff --git a/crc32.h b/crc32.h
index 8c3d7a8a..e2057775 100644
--- a/crc32.h
+++ b/crc32.h
@@ -5,12 +5,15 @@
 #ifndef CRC32_H_
 #define CRC32_H_
 
-#define CRC32_FOLD_BUFFER_SIZE (16 * 4)
-/* sizeof(__m128i) * (4 folds) */
-
-typedef struct crc32_fold_s {
-    uint8_t fold[CRC32_FOLD_BUFFER_SIZE];
-    uint32_t value;
-} crc32_fold;
+/* Size thresholds for Chorba algorithm variants */
+#define CHORBA_LARGE_THRESHOLD (sizeof(z_word_t) * 64 * 1024)
+#define CHORBA_MEDIUM_UPPER_THRESHOLD 32768
+#define CHORBA_MEDIUM_LOWER_THRESHOLD 8192
+#define CHORBA_SMALL_THRESHOLD_64BIT 72
+#if OPTIMAL_CMP == 64
+#  define CHORBA_SMALL_THRESHOLD 72
+#else
+#  define CHORBA_SMALL_THRESHOLD 80
+#endif
 
 #endif
diff --git a/crc32_braid_p.h b/crc32_braid_p.h
index 003bf919..2bb6202f 100644
--- a/crc32_braid_p.h
+++ b/crc32_braid_p.h
@@ -3,51 +3,27 @@
 
 #include "zendian.h"
 
-/* Define N */
-#ifdef Z_TESTN
-#  define N Z_TESTN
-#else
-#  define N 5
-#endif
-#if N < 1 || N > 6
-#  error N must be in 1..6
-#endif
+/* Define BRAID_N, valid range is 1..6 */
+#define BRAID_N 5
 
-/*
-  Define W and the associated z_word_t type. If W is not defined, then a
-  braided calculation is not used, and the associated tables and code are not
-  compiled.
+/* Define BRAID_W and the associated z_word_t type. If BRAID_W is not defined, then a braided
+   calculation is not used, and the associated tables and code are not compiled.
  */
-#ifdef Z_TESTW
-#  if Z_TESTW-1 != -1
-#    define W Z_TESTW
-#  endif
+#ifdef ARCH_64BIT
+#  define BRAID_W 8
+    typedef uint64_t z_word_t;
 #else
-#  ifndef W
-#    if defined(__x86_64__) || defined(_M_AMD64) || defined(__aarch64__) || defined(_M_ARM64) || defined(__powerpc64__)
-#      define W 8
-#    else
-#      define W 4
-#    endif
-#  endif
-#endif
-#ifdef W
-#  if W == 8
-     typedef uint64_t z_word_t;
-#  else
-#    undef W
-#    define W 4
-     typedef uint32_t z_word_t;
-#  endif
+#  define BRAID_W 4
+    typedef uint32_t z_word_t;
 #endif
 
 #if BYTE_ORDER == LITTLE_ENDIAN
 #  define ZSWAPWORD(word) (word)
 #  define BRAID_TABLE crc_braid_table
 #elif BYTE_ORDER == BIG_ENDIAN
-#  if W == 8
+#  if BRAID_W == 8
 #    define ZSWAPWORD(word) ZSWAP64(word)
-#  elif W == 4
+#  elif BRAID_W == 4
 #    define ZSWAPWORD(word) ZSWAP32(word)
 #  endif
 #  define BRAID_TABLE crc_braid_big_table
@@ -55,8 +31,8 @@
 #  error "No endian defined"
 #endif
 
-#define DO1 c = crc_table[(c ^ *buf++) & 0xff] ^ (c >> 8)
-#define DO8 DO1; DO1; DO1; DO1; DO1; DO1; DO1; DO1
+#define CRC_DO1 c = crc_table[(c ^ *buf++) & 0xff] ^ (c >> 8)
+#define CRC_DO8 CRC_DO1; CRC_DO1; CRC_DO1; CRC_DO1; CRC_DO1; CRC_DO1; CRC_DO1; CRC_DO1
 
 /* CRC polynomial. */
 #define POLY 0xedb88320         /* p(x) reflected, with x^32 implied */
diff --git a/crc32_braid_tbl.h b/crc32_braid_tbl.h
index 84d79a69..5e39a1c4 100644
--- a/crc32_braid_tbl.h
+++ b/crc32_braid_tbl.h
@@ -59,9 +59,8 @@ static const uint32_t crc_table[] = {
     0x5d681b02, 0x2a6f2b94, 0xb40bbe37, 0xc30c8ea1, 0x5a05df1b,
     0x2d02ef8d};
 
-#ifdef W
-
-#if W == 8
+#ifdef BRAID_W
+#  if BRAID_W == 8
 
 static const z_word_t crc_big_table[] = {
     0x0000000000000000, 0x9630077700000000, 0x2c610eee00000000,
@@ -151,7 +150,7 @@ static const z_word_t crc_big_table[] = {
     0x37be0bb400000000, 0xa18e0cc300000000, 0x1bdf055a00000000,
     0x8def022d00000000};
 
-#else /* W == 4 */
+#  else /* BRAID_W == 4 */
 
 static const z_word_t crc_big_table[] = {
     0x00000000, 0x96300777, 0x2c610eee, 0xba510999, 0x19c46d07,
@@ -207,13 +206,11 @@ static const z_word_t crc_big_table[] = {
     0x021b685d, 0x942b6f2a, 0x37be0bb4, 0xa18e0cc3, 0x1bdf055a,
     0x8def022d};
 
-#endif
-
-#endif /* W */
+#  endif
+#endif /* BRAID_W */
 
-#if N == 1
-
-#if W == 8
+#if BRAID_N == 1
+#  if BRAID_W == 8
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0xccaa009e, 0x4225077d, 0x8e8f07e3, 0x844a0efa,
@@ -1323,7 +1320,7 @@ static const z_word_t crc_braid_big_table[][256] = {
     0x0501c4a800000000, 0x9b016e6400000000, 0x7806e1ea00000000,
     0xe6064b2600000000}};
 
-#else /* W == 4 */
+#  else /* BRAID_W == 4 */
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0xb8bc6765, 0xaa09c88b, 0x12b5afee, 0x8f629757,
@@ -1745,12 +1742,10 @@ static const z_word_t crc_braid_big_table[][256] = {
     0xc3f6dbe9, 0xa6916751, 0x1fa9b0cc, 0x7ace0c74, 0x9461b966,
     0xf10605de}};
 
-#endif /* W */
-
-#endif /* N == 1 */
-#if N == 2
-
-#if W == 8
+#  endif /* BRAID_W */
+#endif /* BRAID_N == 1 */
+#if BRAID_N == 2
+#  if BRAID_W == 8
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0xae689191, 0x87a02563, 0x29c8b4f2, 0xd4314c87,
@@ -2860,7 +2855,7 @@ static const z_word_t crc_braid_big_table[][256] = {
     0x258db92400000000, 0xb41cd18a00000000, 0x46a819a300000000,
     0xd739710d00000000}};
 
-#else /* W == 4 */
+#  else /* BRAID_W == 4 */
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0xccaa009e, 0x4225077d, 0x8e8f07e3, 0x844a0efa,
@@ -3282,12 +3277,10 @@ static const z_word_t crc_braid_big_table[][256] = {
     0x8208ab6e, 0x1c0801a2, 0x0501c4a8, 0x9b016e64, 0x7806e1ea,
     0xe6064b26}};
 
-#endif /* W */
-
-#endif /* N == 2 */
-#if N == 3
-
-#if W == 8
+#  endif /* BRAID_W */
+#endif /* BRAID_N == 2 */
+#if BRAID_N == 3
+#  if BRAID_W == 8
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0x81256527, 0xd93bcc0f, 0x581ea928, 0x69069e5f,
@@ -4397,7 +4390,7 @@ static const z_word_t crc_braid_big_table[][256] = {
     0x792cd35100000000, 0x5e49f6d000000000, 0x76e0e88800000000,
     0x5185cd0900000000}};
 
-#else /* W == 4 */
+#  else /* BRAID_W == 4 */
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0x9ba54c6f, 0xec3b9e9f, 0x779ed2f0, 0x03063b7f,
@@ -4819,12 +4812,10 @@ static const z_word_t crc_braid_big_table[][256] = {
     0x7506baae, 0x1a4a1f35, 0x95a38741, 0xfaef22da, 0x0a3dbcad,
     0x65711936}};
 
-#endif /* W */
-
-#endif /* N == 3 */
-#if N == 4
-
-#if W == 8
+#  endif /* BRAID_W */
+#endif /* BRAID_N == 3 */
+#if BRAID_N == 4
+#  if BRAID_W == 8
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0xf1da05aa, 0x38c50d15, 0xc91f08bf, 0x718a1a2a,
@@ -5934,7 +5925,7 @@ static const z_word_t crc_braid_big_table[][256] = {
     0xa951db2a00000000, 0x035401db00000000, 0xbc5c1e1200000000,
     0x1659c4e300000000}};
 
-#else /* W == 4 */
+#  else /* BRAID_W == 4 */
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0xae689191, 0x87a02563, 0x29c8b4f2, 0xd4314c87,
@@ -6356,12 +6347,10 @@ static const z_word_t crc_braid_big_table[][256] = {
     0xc1e42877, 0x507540d9, 0x258db924, 0xb41cd18a, 0x46a819a3,
     0xd739710d}};
 
-#endif /* W */
-
-#endif /* N == 4 */
-#if N == 5
-
-#if W == 8
+#  endif /* BRAID_W */
+#endif /* BRAID_N == 4 */
+#if BRAID_N == 5
+#  if BRAID_W == 8
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0xaf449247, 0x85f822cf, 0x2abcb088, 0xd08143df,
@@ -7471,7 +7460,7 @@ static const z_word_t crc_braid_big_table[][256] = {
     0xedc528c300000000, 0xaa576c6c00000000, 0x22e7d04600000000,
     0x657594e900000000}};
 
-#else /* W == 4 */
+#  else /* BRAID_W == 4 */
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0x65673b46, 0xcace768c, 0xafa94dca, 0x4eedeb59,
@@ -7893,12 +7882,10 @@ static const z_word_t crc_braid_big_table[][256] = {
     0x2abb26f3, 0x6c804196, 0xff260577, 0xb91d6212, 0x7350cbbd,
     0x356bacd8}};
 
-#endif /* W */
-
-#endif /* N == 5 */
-#if N == 6
-
-#if W == 8
+#  endif /* BRAID_W */
+#endif /* BRAID_N == 5 */
+#if BRAID_N == 6
+#  if BRAID_W == 8
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0x3db1ecdc, 0x7b63d9b8, 0x46d23564, 0xf6c7b370,
@@ -9008,7 +8995,7 @@ static const z_word_t crc_braid_big_table[][256] = {
     0xcc95bac300000000, 0x10790bfe00000000, 0x744cd9b800000000,
     0xa8a0688500000000}};
 
-#else /* W == 4 */
+#  else /* BRAID_W == 4 */
 
 static const uint32_t crc_braid_table[][256] = {
    {0x00000000, 0x81256527, 0xd93bcc0f, 0x581ea928, 0x69069e5f,
@@ -9430,9 +9417,8 @@ static const z_word_t crc_braid_big_table[][256] = {
     0x297eeee1, 0x0e1bcb60, 0x792cd351, 0x5e49f6d0, 0x76e0e888,
     0x5185cd09}};
 
-#endif /* W */
-
-#endif /* N == 6 */
+#  endif /* BRAID_W */
+#endif /* BRAID_N == 6 */
 
 static const uint32_t x2n_table[] = {
     0x40000000, 0x20000000, 0x08000000, 0x00800000, 0x00008000,
diff --git a/deflate.c b/deflate.c
index 66b5506a..a9645ce8 100644
--- a/deflate.c
+++ b/deflate.c
@@ -48,9 +48,10 @@
  */
 
 #include "zbuild.h"
+#include "functable.h"
 #include "deflate.h"
 #include "deflate_p.h"
-#include "functable.h"
+#include "insert_string_p.h"
 
 /* Avoid conflicts with zlib.h macros */
 #ifdef ZLIB_COMPAT
@@ -66,45 +67,6 @@ const char PREFIX(deflate_copyright)[] = " deflate 1.3.1 Copyright 1995-2024 Jea
   copyright string in the executable of your product.
  */
 
-/* ===========================================================================
- *  Architecture-specific hooks.
- */
-#ifdef S390_DFLTCC_DEFLATE
-#  include "arch/s390/dfltcc_deflate.h"
-/* DFLTCC instructions require window to be page-aligned */
-#  define PAD_WINDOW            PAD_4096
-#  define WINDOW_PAD_SIZE       4096
-#  define HINT_ALIGNED_WINDOW   HINT_ALIGNED_4096
-#else
-#  define PAD_WINDOW            PAD_64
-#  define WINDOW_PAD_SIZE       64
-#  define HINT_ALIGNED_WINDOW   HINT_ALIGNED_64
-/* Adjust the window size for the arch-specific deflate code. */
-#  define DEFLATE_ADJUST_WINDOW_SIZE(n) (n)
-/* Invoked at the beginning of deflateSetDictionary(). Useful for checking arch-specific window data. */
-#  define DEFLATE_SET_DICTIONARY_HOOK(strm, dict, dict_len) do {} while (0)
-/* Invoked at the beginning of deflateGetDictionary(). Useful for adjusting arch-specific window data. */
-#  define DEFLATE_GET_DICTIONARY_HOOK(strm, dict, dict_len) do {} while (0)
-/* Invoked at the end of deflateResetKeep(). Useful for initializing arch-specific extension blocks. */
-#  define DEFLATE_RESET_KEEP_HOOK(strm) do {} while (0)
-/* Invoked at the beginning of deflateParams(). Useful for updating arch-specific compression parameters. */
-#  define DEFLATE_PARAMS_HOOK(strm, level, strategy, hook_flush) do {} while (0)
-/* Returns whether the last deflate(flush) operation did everything it's supposed to do. */
-#  define DEFLATE_DONE(strm, flush) 1
-/* Adjusts the upper bound on compressed data length based on compression parameters and uncompressed data length.
- * Useful when arch-specific deflation code behaves differently than regular zlib-ng algorithms. */
-#  define DEFLATE_BOUND_ADJUST_COMPLEN(strm, complen, sourceLen) do {} while (0)
-/* Returns whether an optimistic upper bound on compressed data length should *not* be used.
- * Useful when arch-specific deflation code behaves differently than regular zlib-ng algorithms. */
-#  define DEFLATE_NEED_CONSERVATIVE_BOUND(strm) 0
-/* Invoked for each deflate() call. Useful for plugging arch-specific deflation code. */
-#  define DEFLATE_HOOK(strm, flush, bstate) 0
-/* Returns whether zlib-ng should compute a checksum. Set to 0 if arch-specific deflation code already does that. */
-#  define DEFLATE_NEED_CHECKSUM(strm) 1
-/* Returns whether reproducibility parameter can be set to a given value. */
-#  define DEFLATE_CAN_SET_REPRODUCIBLE(strm, reproducible) 1
-#endif
-
 /* ===========================================================================
  *  Function prototypes.
  */
@@ -120,7 +82,6 @@ Z_INTERNAL block_state deflate_rle   (deflate_state *s, int flush);
 Z_INTERNAL block_state deflate_huff  (deflate_state *s, int flush);
 static void lm_set_level         (deflate_state *s, int level);
 static void lm_init              (deflate_state *s);
-Z_INTERNAL unsigned read_buf  (PREFIX3(stream) *strm, unsigned char *buf, unsigned size);
 
 /* ===========================================================================
  * Local data
@@ -204,7 +165,7 @@ Z_INTERNAL deflate_allocs* alloc_deflate(PREFIX3(stream) *strm, int windowBits,
 
     /* Define sizes */
     int window_size = DEFLATE_ADJUST_WINDOW_SIZE((1 << windowBits) * 2);
-    int prev_size = (1 << windowBits) * sizeof(Pos);
+    int prev_size = (1 << windowBits) * (int)sizeof(Pos);
     int head_size = HASH_SIZE * sizeof(Pos);
     int pending_size = lit_bufsize * LIT_BUFS;
     int state_size = sizeof(deflate_state);
@@ -239,7 +200,7 @@ Z_INTERNAL deflate_allocs* alloc_deflate(PREFIX3(stream) *strm, int windowBits,
     int total_size = PAD_64(curr_size + (WINDOW_PAD_SIZE - 1));
 
     /* Allocate buffer, align to 64-byte cacheline, and zerofill the resulting buffer */
-    char *original_buf = strm->zalloc(strm->opaque, 1, total_size);
+    char *original_buf = (char *)strm->zalloc(strm->opaque, 1, total_size);
     if (original_buf == NULL)
         return NULL;
 
@@ -248,7 +209,7 @@ Z_INTERNAL deflate_allocs* alloc_deflate(PREFIX3(stream) *strm, int windowBits,
 
     /* Initialize alloc_bufs */
     deflate_allocs *alloc_bufs  = (struct deflate_allocs_s *)(buff + alloc_pos);
-    alloc_bufs->buf_start = (char *)original_buf;
+    alloc_bufs->buf_start = original_buf;
     alloc_bufs->zfree = strm->zfree;
 
     /* Assign buffers */
@@ -341,9 +302,7 @@ int32_t ZNG_CONDEXPORT PREFIX(deflateInit2)(PREFIX3(stream) *strm, int32_t level
 
     s->wrap = wrap;
     s->gzhead = NULL;
-    s->w_bits = (unsigned int)windowBits;
-    s->w_size = 1 << s->w_bits;
-    s->w_mask = s->w_size - 1;
+    s->w_size = 1 << windowBits;
 
     s->high_water = 0;      /* nothing written to s->window yet */
 
@@ -390,13 +349,6 @@ int32_t ZNG_CONDEXPORT PREFIX(deflateInit2)(PREFIX3(stream) *strm, int32_t level
 
     s->pending_buf_size = s->lit_bufsize * 4;
 
-    if (s->window == NULL || s->prev == NULL || s->head == NULL || s->pending_buf == NULL) {
-        s->status = FINISH_STATE;
-        strm->msg = ERR_MSG(Z_MEM_ERROR);
-        PREFIX(deflateEnd)(strm);
-        return Z_MEM_ERROR;
-    }
-
 #ifdef LIT_MEM
     s->d_buf = (uint16_t *)(s->pending_buf + (s->lit_bufsize << 1));
     s->l_buf = s->pending_buf + (s->lit_bufsize << 2);
@@ -455,6 +407,7 @@ static int deflateStateCheck(PREFIX3(stream) *strm) {
 /* ========================================================================= */
 int32_t Z_EXPORT PREFIX(deflateSetDictionary)(PREFIX3(stream) *strm, const uint8_t *dictionary, uint32_t dictLength) {
     deflate_state *s;
+    insert_string_cb insert_string_func;
     unsigned int str, n;
     int wrap;
     uint32_t avail;
@@ -467,6 +420,11 @@ int32_t Z_EXPORT PREFIX(deflateSetDictionary)(PREFIX3(stream) *strm, const uint8
     if (wrap == 2 || (wrap == 1 && s->status != INIT_STATE) || s->lookahead)
         return Z_STREAM_ERROR;
 
+    if (s->level >= 9)
+        insert_string_func = insert_string_roll;
+    else
+        insert_string_func = insert_string;
+
     /* when using zlib wrappers, compute Adler-32 for provided dictionary */
     if (wrap == 1)
         strm->adler = FUNCTABLE_CALL(adler32)(strm->adler, dictionary, dictLength);
@@ -494,7 +452,7 @@ int32_t Z_EXPORT PREFIX(deflateSetDictionary)(PREFIX3(stream) *strm, const uint8
     while (s->lookahead >= STD_MIN_MATCH) {
         str = s->strstart;
         n = s->lookahead - (STD_MIN_MATCH - 1);
-        s->insert_string(s, str, n);
+        insert_string_func(s, str, n);
         s->strstart = str + n;
         s->lookahead = STD_MIN_MATCH - 1;
         PREFIX(fill_window)(s);
@@ -556,7 +514,7 @@ int32_t Z_EXPORT PREFIX(deflateResetKeep)(PREFIX3(stream) *strm) {
 
 #ifdef GZIP
     if (s->wrap == 2) {
-        strm->adler = FUNCTABLE_CALL(crc32_fold_reset)(&s->crc_fold);
+        strm->adler = CRC32_INITIAL_VALUE;
     } else
 #endif
         strm->adler = ADLER32_INITIAL_VALUE;
@@ -753,12 +711,13 @@ unsigned long Z_EXPORT PREFIX(deflateBound)(PREFIX3(stream) *strm, unsigned long
         break;
 #endif
     default:                                /* for compiler happiness */
+        Z_UNREACHABLE();
         wraplen = ZLIB_WRAPLEN;
     }
 
     /* if not default parameters, return conservative bound */
     if (DEFLATE_NEED_CONSERVATIVE_BOUND(strm) ||  /* hook for IBM Z DFLTCC */
-            s->w_bits != MAX_WBITS || HASH_BITS < 15) {
+            W_BITS(s) != MAX_WBITS || HASH_BITS < 15) {
         if (s->level == 0) {
             /* upper bound for stored blocks with length 127 (memLevel == 1) --
                ~4% overhead plus a small constant */
@@ -781,29 +740,10 @@ unsigned long Z_EXPORT PREFIX(deflateBound)(PREFIX3(stream) *strm, unsigned long
 }
 
 /* =========================================================================
- * Flush as much pending output as possible. All deflate() output, except for
- * some deflate_stored() output, goes through this function so some
- * applications may wish to modify it to avoid allocating a large
- * strm->next_out buffer and copying into it. (See also read_buf()).
+ * Flush as much pending output as possible. See flush_pending_inline()
  */
 Z_INTERNAL void PREFIX(flush_pending)(PREFIX3(stream) *strm) {
-    uint32_t len;
-    deflate_state *s = strm->state;
-
-    zng_tr_flush_bits(s);
-    len = MIN(s->pending, strm->avail_out);
-    if (len == 0)
-        return;
-
-    Tracev((stderr, "[FLUSH]"));
-    memcpy(strm->next_out, s->pending_out, len);
-    strm->next_out  += len;
-    s->pending_out  += len;
-    strm->total_out += len;
-    strm->avail_out -= len;
-    s->pending      -= len;
-    if (s->pending == 0)
-        s->pending_out = s->pending_buf;
+    flush_pending_inline(strm);
 }
 
 /* ===========================================================================
@@ -837,7 +777,7 @@ int32_t Z_EXPORT PREFIX(deflate)(PREFIX3(stream) *strm, int32_t flush) {
 
     /* Flush as much pending output as possible */
     if (s->pending != 0) {
-        PREFIX(flush_pending)(strm);
+        flush_pending_inline(strm);
         if (strm->avail_out == 0) {
             /* Since avail_out is 0, deflate will be called again with
              * more output space, but possibly with both pending and
@@ -867,7 +807,7 @@ int32_t Z_EXPORT PREFIX(deflate)(PREFIX3(stream) *strm, int32_t flush) {
         s->status = BUSY_STATE;
     if (s->status == INIT_STATE) {
         /* zlib header */
-        unsigned int header = (Z_DEFLATED + ((s->w_bits-8)<<4)) << 8;
+        unsigned int header = (Z_DEFLATED + ((W_BITS(s)-8)<<4)) << 8;
         unsigned int level_flags;
 
         if (s->strategy >= Z_HUFFMAN_ONLY || s->level < 2)
@@ -901,7 +841,7 @@ int32_t Z_EXPORT PREFIX(deflate)(PREFIX3(stream) *strm, int32_t flush) {
 #ifdef GZIP
     if (s->status == GZIP_STATE) {
         /* gzip header */
-        FUNCTABLE_CALL(crc32_fold_reset)(&s->crc_fold);
+        strm->adler = CRC32_INITIAL_VALUE;
         put_byte(s, 31);
         put_byte(s, 139);
         put_byte(s, 8);
@@ -1018,12 +958,12 @@ int32_t Z_EXPORT PREFIX(deflate)(PREFIX3(stream) *strm, int32_t flush) {
                 }
             }
             put_short(s, (uint16_t)strm->adler);
-            FUNCTABLE_CALL(crc32_fold_reset)(&s->crc_fold);
+            strm->adler = CRC32_INITIAL_VALUE;
         }
         s->status = BUSY_STATE;
 
         /* Compression must start with an empty pending buffer */
-        PREFIX(flush_pending)(strm);
+        flush_pending_inline(strm);
         if (s->pending != 0) {
             s->last_flush = -1;
             return Z_OK;
@@ -1089,8 +1029,6 @@ int32_t Z_EXPORT PREFIX(deflate)(PREFIX3(stream) *strm, int32_t flush) {
     /* Write the trailer */
 #ifdef GZIP
     if (s->wrap == 2) {
-        strm->adler = FUNCTABLE_CALL(crc32_fold_final)(&s->crc_fold);
-
         put_uint32(s, strm->adler);
         put_uint32(s, (uint32_t)strm->total_in);
     } else
@@ -1099,7 +1037,7 @@ int32_t Z_EXPORT PREFIX(deflate)(PREFIX3(stream) *strm, int32_t flush) {
         if (s->wrap == 1)
             put_uint32_msb(s, strm->adler);
     }
-    PREFIX(flush_pending)(strm);
+    flush_pending_inline(strm);
     /* If avail_out is zero, the application will call deflate again
      * to flush the rest.
      */
@@ -1139,7 +1077,7 @@ int32_t Z_EXPORT PREFIX(deflateCopy)(PREFIX3(stream) *dest, PREFIX3(stream) *sou
 
     memcpy((void *)dest, (void *)source, sizeof(PREFIX3(stream)));
 
-    deflate_allocs *alloc_bufs = alloc_deflate(dest, ss->w_bits, ss->lit_bufsize);
+    deflate_allocs *alloc_bufs = alloc_deflate(dest, W_BITS(ss), ss->lit_bufsize);
     if (alloc_bufs == NULL)
         return Z_MEM_ERROR;
 
@@ -1180,37 +1118,6 @@ int32_t Z_EXPORT PREFIX(deflateCopy)(PREFIX3(stream) *dest, PREFIX3(stream) *sou
     return Z_OK;
 }
 
-/* ===========================================================================
- * Read a new buffer from the current input stream, update the adler32
- * and total number of bytes read.  All deflate() input goes through
- * this function so some applications may wish to modify it to avoid
- * allocating a large strm->next_in buffer and copying from it.
- * (See also flush_pending()).
- */
-Z_INTERNAL unsigned PREFIX(read_buf)(PREFIX3(stream) *strm, unsigned char *buf, unsigned size) {
-    uint32_t len = MIN(strm->avail_in, size);
-    if (len == 0)
-        return 0;
-
-    strm->avail_in  -= len;
-
-    if (!DEFLATE_NEED_CHECKSUM(strm)) {
-        memcpy(buf, strm->next_in, len);
-#ifdef GZIP
-    } else if (strm->state->wrap == 2) {
-        FUNCTABLE_CALL(crc32_fold_copy)(&strm->state->crc_fold, buf, strm->next_in, len);
-#endif
-    } else if (strm->state->wrap == 1) {
-        strm->adler = FUNCTABLE_CALL(adler32_fold_copy)(strm->adler, buf, strm->next_in, len);
-    } else {
-        memcpy(buf, strm->next_in, len);
-    }
-    strm->next_in  += len;
-    strm->total_in += len;
-
-    return len;
-}
-
 /* ===========================================================================
  * Set longest match variables based on level configuration
  */
@@ -1219,20 +1126,6 @@ static void lm_set_level(deflate_state *s, int level) {
     s->good_match       = configuration_table[level].good_length;
     s->nice_match       = configuration_table[level].nice_length;
     s->max_chain_length = configuration_table[level].max_chain;
-
-    /* Use rolling hash for deflate_slow algorithm with level 9. It allows us to
-     * properly lookup different hash chains to speed up longest_match search. Since hashing
-     * method changes depending on the level we cannot put this into functable. */
-    if (s->max_chain_length > 1024) {
-        s->update_hash = &update_hash_roll;
-        s->insert_string = &insert_string_roll;
-        s->quick_insert_string = &quick_insert_string_roll;
-    } else {
-        s->update_hash = update_hash;
-        s->insert_string = insert_string;
-        s->quick_insert_string = quick_insert_string;
-    }
-
     s->level = level;
 }
 
@@ -1270,12 +1163,21 @@ static void lm_init(deflate_state *s) {
  */
 
 void Z_INTERNAL PREFIX(fill_window)(deflate_state *s) {
+    PREFIX3(stream) *strm = s->strm;
+    insert_string_cb insert_string_func;
+    unsigned char *window = s->window;
     unsigned n;
     unsigned int more;    /* Amount of free space at the end of the window. */
     unsigned int wsize = s->w_size;
+    int level = s->level;
 
     Assert(s->lookahead < MIN_LOOKAHEAD, "already enough lookahead");
 
+    if (level >= 9)
+        insert_string_func = insert_string_roll;
+    else
+        insert_string_func = insert_string;
+
     do {
         more = s->window_size - s->lookahead - s->strstart;
 
@@ -1283,7 +1185,7 @@ void Z_INTERNAL PREFIX(fill_window)(deflate_state *s) {
          * move the upper half to the lower one to make room in the upper half.
          */
         if (s->strstart >= wsize+MAX_DIST(s)) {
-            memcpy(s->window, s->window+wsize, (unsigned)wsize);
+            memcpy(window, window + wsize, (unsigned)wsize);
             if (s->match_start >= wsize) {
                 s->match_start -= wsize;
             } else {
@@ -1297,7 +1199,7 @@ void Z_INTERNAL PREFIX(fill_window)(deflate_state *s) {
             FUNCTABLE_CALL(slide_hash)(s);
             more += wsize;
         }
-        if (s->strm->avail_in == 0)
+        if (strm->avail_in == 0)
             break;
 
         /* If there was no sliding:
@@ -1313,30 +1215,30 @@ void Z_INTERNAL PREFIX(fill_window)(deflate_state *s) {
          */
         Assert(more >= 2, "more < 2");
 
-        n = PREFIX(read_buf)(s->strm, s->window + s->strstart + s->lookahead, more);
+        n = read_buf(strm, window + s->strstart + s->lookahead, more);
         s->lookahead += n;
 
         /* Initialize the hash value now that we have some input: */
         if (s->lookahead + s->insert >= STD_MIN_MATCH) {
             unsigned int str = s->strstart - s->insert;
-            if (UNLIKELY(s->max_chain_length > 1024)) {
-                s->ins_h = s->update_hash(s->window[str], s->window[str+1]);
+            if (UNLIKELY(level >= 9)) {
+                s->ins_h = update_hash_roll(window[str], window[str+1]);
             } else if (str >= 1) {
-                s->quick_insert_string(s, str + 2 - STD_MIN_MATCH);
+                quick_insert_string(s, str + 2 - STD_MIN_MATCH);
             }
             unsigned int count = s->insert;
             if (UNLIKELY(s->lookahead == 1)) {
                 count -= 1;
             }
             if (count > 0) {
-                s->insert_string(s, str, count);
+                insert_string_func(s, str, count);
                 s->insert -= count;
             }
         }
         /* If the whole input has less than STD_MIN_MATCH bytes, ins_h is garbage,
          * but this is not important since only literal bytes will be emitted.
          */
-    } while (s->lookahead < MIN_LOOKAHEAD && s->strm->avail_in != 0);
+    } while (s->lookahead < MIN_LOOKAHEAD && strm->avail_in != 0);
 
     /* If the WIN_INIT bytes after the end of the current data have never been
      * written, then zero those bytes in order to avoid memory check reports of
@@ -1356,7 +1258,7 @@ void Z_INTERNAL PREFIX(fill_window)(deflate_state *s) {
             init = s->window_size - curr;
             if (init > WIN_INIT)
                 init = WIN_INIT;
-            memset(s->window + curr, 0, init);
+            memset(window + curr, 0, init);
             s->high_water = curr + init;
         } else if (s->high_water < curr + WIN_INIT) {
             /* High water mark at or above current data, but below current data
@@ -1366,7 +1268,7 @@ void Z_INTERNAL PREFIX(fill_window)(deflate_state *s) {
             init = curr + WIN_INIT - s->high_water;
             if (init > s->window_size - s->high_water)
                 init = s->window_size - s->high_water;
-            memset(s->window + s->high_water, 0, init);
+            memset(window + s->high_water, 0, init);
             s->high_water += init;
         }
     }
diff --git a/deflate.h b/deflate.h
index e122ae1a..4957b940 100644
--- a/deflate.h
+++ b/deflate.h
@@ -12,6 +12,7 @@
 
 #include "zutil.h"
 #include "zendian.h"
+#include "zmemory.h"
 #include "crc32.h"
 
 #ifdef S390_DFLTCC_DEFLATE
@@ -118,17 +119,9 @@ typedef uint16_t Pos;
 /* Type definitions for hash callbacks */
 typedef struct internal_state deflate_state;
 
-typedef uint32_t (* update_hash_cb)        (uint32_t h, uint32_t val);
 typedef void     (* insert_string_cb)      (deflate_state *const s, uint32_t str, uint32_t count);
-typedef Pos      (* quick_insert_string_cb)(deflate_state *const s, uint32_t str);
-
-uint32_t update_hash             (uint32_t h, uint32_t val);
 void     insert_string           (deflate_state *const s, uint32_t str, uint32_t count);
-Pos      quick_insert_string     (deflate_state *const s, uint32_t str);
-
-uint32_t update_hash_roll        (uint32_t h, uint32_t val);
 void     insert_string_roll      (deflate_state *const s, uint32_t str, uint32_t count);
-Pos      quick_insert_string_roll(deflate_state *const s, uint32_t str);
 
 /* Struct for memory allocation handling */
 typedef struct deflate_allocs_s {
@@ -142,6 +135,7 @@ typedef struct deflate_allocs_s {
 } deflate_allocs;
 
 struct ALIGNED_(64) internal_state {
+                /* Cacheline 0 */
     PREFIX3(stream)      *strm;            /* pointer back to this zlib stream */
     unsigned char        *pending_buf;     /* output still pending */
     unsigned char        *pending_out;     /* next pending byte to output to the stream */
@@ -154,17 +148,19 @@ struct ALIGNED_(64) internal_state {
     int                  last_flush;       /* value of flush param for previous deflate call */
     int                  reproducible;     /* Whether reproducible compression results are required. */
 
-    int block_open;
+    unsigned int block_open;
     /* Whether or not a block is currently open for the QUICK deflation scheme.
      * This is set to 1 if there is an active block, or 0 if the block was just closed.
      */
 
-                /* used by deflate.c: */
+                /* Cacheline 1 */
 
-    unsigned int  w_size;            /* LZ77 window size (32K by default) */
-    unsigned int  w_bits;            /* log2(w_size)  (8..16) */
-    unsigned int  w_mask;            /* w_size - 1 */
-    unsigned int  lookahead;         /* number of valid bytes ahead in window */
+    unsigned int  lookahead;    /* number of valid bytes ahead in window */
+    unsigned int strstart;      /* start of string to insert */
+    unsigned int  w_size;       /* LZ77 window size (32K by default) */
+
+    int block_start;            /* Window position at the beginning of the current output block.
+                                 * Gets negative when the window is moved backwards. */
 
     unsigned int high_water;
     /* High water mark offset in window for initialized bytes -- bytes above
@@ -198,15 +194,12 @@ struct ALIGNED_(64) internal_state {
 
     uint32_t ins_h; /* hash index of string to be inserted */
 
-    int block_start;
-    /* Window position at the beginning of the current output block. Gets
-     * negative when the window is moved backwards.
-     */
-
     unsigned int match_length;       /* length of best match */
-    Pos          prev_match;         /* previous match */
     int          match_available;    /* set if previous match exists */
-    unsigned int strstart;           /* start of string to insert */
+    uint32_t     prev_match;         /* previous match (used by deflate_slow) */
+
+                /* Cacheline 2 */
+
     unsigned int match_start;        /* start of matching string */
 
     unsigned int prev_length;
@@ -226,24 +219,28 @@ struct ALIGNED_(64) internal_state {
 #   define max_insert_length  max_lazy_match
     /* Insert new strings in the hash table only if the match length is not
      * greater than this length. This saves time but degrades compression.
-     * max_insert_length is used only for compression levels <= 3.
+     * max_insert_length is used only for compression levels <= 6.
      */
 
-    update_hash_cb          update_hash;
-    insert_string_cb        insert_string;
-    quick_insert_string_cb  quick_insert_string;
-    /* Hash function callbacks that can be configured depending on the deflate
-     * algorithm being used */
+    int level;                  /* compression level (1..9) */
+    int strategy;               /* favor or force Huffman coding*/
+    unsigned int good_match;    /* Use a faster search when the previous match is longer than this */
+    int nice_match;             /* Stop searching when current match exceeds this */
+    unsigned int matches;       /* number of string matches in current block */
+    unsigned int insert;        /* bytes at end of window left to insert */
 
-    int level;    /* compression level (1..9) */
-    int strategy; /* favor or force Huffman coding*/
+    uint64_t bi_buf;            /* Output buffer.
+                                 * Bits are inserted starting at the bottom (least significant bits). */
+    int32_t bi_valid;           /* Number of valid bits in bi_buf.
+                                 * All bits above the last valid bit are always zero. */
 
-    unsigned int good_match;
-    /* Use a faster search when the previous match is longer than this */
+    int heap_len;               /* number of elements in the heap */
+    int heap_max;               /* element of largest frequency */
 
-    int nice_match; /* Stop searching when current match exceeds this */
+    int32_t padding1[1];
 
-    struct crc32_fold_s ALIGNED_(16) crc_fold;
+                /* Cacheline 3 */
+    uint8_t ALIGNED_(16) padding4[68];
 
                 /* used by trees.c: */
     /* Didn't use ct_data typedef below to suppress compiler warning */
@@ -259,8 +256,6 @@ struct ALIGNED_(64) internal_state {
     /* number of codes at each bit length for an optimal tree */
 
     int heap[2*L_CODES+1];      /* heap used to build the Huffman trees */
-    int heap_len;               /* number of elements in the heap */
-    int heap_max;               /* element of largest frequency */
     /* The sons of heap[n] are heap[2*n] and heap[2*n+1]. heap[0] is not used.
      * The same heap array is used to build all trees.
      */
@@ -301,14 +296,8 @@ struct ALIGNED_(64) internal_state {
     unsigned int sym_next;        /* running index in symbol buffer */
     unsigned int sym_end;         /* symbol table full when sym_next reaches this */
 
-    unsigned long opt_len;        /* bit length of current block with optimal trees */
-    unsigned long static_len;     /* bit length of current block with static trees */
-    unsigned int matches;         /* number of string matches in current block */
-    unsigned int insert;          /* bytes at end of window left to insert */
-
-    /* compressed_len and bits_sent are only used if ZLIB_DEBUG is defined */
-    unsigned long compressed_len; /* total bit length of compressed file mod 2^32 */
-    unsigned long bits_sent;      /* bit length of compressed data sent mod 2^32 */
+    unsigned int opt_len;         /* bit length of current block with optimal trees */
+    unsigned int static_len;      /* bit length of current block with static trees */
 
     deflate_allocs *alloc_bufs;
 
@@ -316,14 +305,14 @@ struct ALIGNED_(64) internal_state {
     arch_deflate_state arch;      /* architecture-specific extensions */
 #endif
 
-    uint64_t bi_buf;
-    /* Output buffer. bits are inserted starting at the bottom (least significant bits). */
-
-    int32_t bi_valid;
-    /* Number of valid bits in bi_buf.  All bits above the last valid bit are always zero. */
+    /* compressed_len and bits_sent are only used if ZLIB_DEBUG is defined */
+#ifdef ZLIB_DEBUG
+    unsigned long compressed_len; /* total bit length of compressed file mod 2^32 */
+    unsigned long bits_sent;      /* bit length of compressed data sent mod 2^32 */
+#endif
 
     /* Reserved for future use and alignment purposes */
-    int32_t reserved[11];
+    int32_t reserved[19];
 };
 
 typedef enum {
@@ -348,7 +337,7 @@ static inline void put_short(deflate_state *s, uint16_t w) {
 #if BYTE_ORDER == BIG_ENDIAN
     w = ZSWAP16(w);
 #endif
-    memcpy(&s->pending_buf[s->pending], &w, sizeof(w));
+    zng_memwrite_2(&s->pending_buf[s->pending], w);
     s->pending += 2;
 }
 
@@ -360,7 +349,7 @@ static inline void put_short_msb(deflate_state *s, uint16_t w) {
 #if BYTE_ORDER == LITTLE_ENDIAN
     w = ZSWAP16(w);
 #endif
-    memcpy(&s->pending_buf[s->pending], &w, sizeof(w));
+    zng_memwrite_2(&s->pending_buf[s->pending], w);
     s->pending += 2;
 }
 
@@ -372,7 +361,7 @@ static inline void put_uint32(deflate_state *s, uint32_t dw) {
 #if BYTE_ORDER == BIG_ENDIAN
     dw = ZSWAP32(dw);
 #endif
-    memcpy(&s->pending_buf[s->pending], &dw, sizeof(dw));
+    zng_memwrite_4(&s->pending_buf[s->pending], dw);
     s->pending += 4;
 }
 
@@ -384,7 +373,7 @@ static inline void put_uint32_msb(deflate_state *s, uint32_t dw) {
 #if BYTE_ORDER == LITTLE_ENDIAN
     dw = ZSWAP32(dw);
 #endif
-    memcpy(&s->pending_buf[s->pending], &dw, sizeof(dw));
+    zng_memwrite_4(&s->pending_buf[s->pending], dw);
     s->pending += 4;
 }
 
@@ -396,7 +385,7 @@ static inline void put_uint64(deflate_state *s, uint64_t lld) {
 #if BYTE_ORDER == BIG_ENDIAN
     lld = ZSWAP64(lld);
 #endif
-    memcpy(&s->pending_buf[s->pending], &lld, sizeof(lld));
+    zng_memwrite_8(&s->pending_buf[s->pending], lld);
     s->pending += 8;
 }
 
@@ -410,6 +399,32 @@ static inline void put_uint64(deflate_state *s, uint64_t lld) {
  * distances are limited to MAX_DIST instead of WSIZE.
  */
 
+#define W_MASK(s)  ((s)->w_size - 1)
+/* Window mask: w_size is always a power of 2, so w_mask = w_size - 1 */
+
+#ifdef HAVE_BUILTIN_CTZ
+#  define W_BITS(s)  ((unsigned int)__builtin_ctz((s)->w_size))
+#else
+/* Fallback for w_size which is always a power of 2 between 256 and 32768 */
+static inline unsigned int compute_w_bits(unsigned int w_size) {
+    /* Switch ordered by likelihood - most common first (MAX_WBITS=15 -> 32768) */
+    switch (w_size) {
+        case 32768: return 15;  /* MAX_WBITS default */
+        case 16384: return 14;
+        case  8192: return 13;
+        case  4096: return 12;
+        case  2048: return 11;
+        case  1024: return 10;
+        case   512: return  9;
+        case   256: return  8;
+    }
+    Assert(w_size >= 256 && w_size <= 32768, "invalid w_size");
+    return 0;
+}
+#  define W_BITS(s)  compute_w_bits((s)->w_size)
+#endif
+/* Window bits: log2(w_size), computed from w_size since w_size is a power of 2 */
+
 #define WIN_INIT STD_MAX_MATCH
 /* Number of bytes after end of data in window to initialize in order to avoid
    memory checker errors from longest match routines */
@@ -424,7 +439,6 @@ void Z_INTERNAL zng_tr_flush_block(deflate_state *s, char *buf, uint32_t stored_
 void Z_INTERNAL zng_tr_flush_bits(deflate_state *s);
 void Z_INTERNAL zng_tr_align(deflate_state *s);
 void Z_INTERNAL zng_tr_stored_block(deflate_state *s, char *buf, uint32_t stored_len, int last);
-uint16_t Z_INTERNAL PREFIX(bi_reverse)(unsigned code, int len);
 void Z_INTERNAL PREFIX(flush_pending)(PREFIX3(streamp) strm);
 #define d_code(dist) ((dist) < 256 ? zng_dist_code[dist] : zng_dist_code[256+((dist)>>7)])
 /* Mapping from a distance to a distance code. dist is the distance - 1 and
@@ -445,4 +459,43 @@ void Z_INTERNAL PREFIX(flush_pending)(PREFIX3(streamp) strm);
 #  define sent_bits_align(s)
 #endif
 
+/* ===========================================================================
+ *  Architecture-specific hooks.
+ */
+#ifdef S390_DFLTCC_DEFLATE
+#  include "arch/s390/dfltcc_deflate.h"
+/* DFLTCC instructions require window to be page-aligned */
+#  define PAD_WINDOW            PAD_4096
+#  define WINDOW_PAD_SIZE       4096
+#  define HINT_ALIGNED_WINDOW   HINT_ALIGNED_4096
+#else
+#  define PAD_WINDOW            PAD_64
+#  define WINDOW_PAD_SIZE       64
+#  define HINT_ALIGNED_WINDOW   HINT_ALIGNED_64
+/* Adjust the window size for the arch-specific deflate code. */
+#  define DEFLATE_ADJUST_WINDOW_SIZE(n) (n)
+/* Invoked at the beginning of deflateSetDictionary(). Useful for checking arch-specific window data. */
+#  define DEFLATE_SET_DICTIONARY_HOOK(strm, dict, dict_len) do {} while (0)
+/* Invoked at the beginning of deflateGetDictionary(). Useful for adjusting arch-specific window data. */
+#  define DEFLATE_GET_DICTIONARY_HOOK(strm, dict, dict_len) do {} while (0)
+/* Invoked at the end of deflateResetKeep(). Useful for initializing arch-specific extension blocks. */
+#  define DEFLATE_RESET_KEEP_HOOK(strm) do {} while (0)
+/* Invoked at the beginning of deflateParams(). Useful for updating arch-specific compression parameters. */
+#  define DEFLATE_PARAMS_HOOK(strm, level, strategy, hook_flush) do {} while (0)
+/* Returns whether the last deflate(flush) operation did everything it's supposed to do. */
+#  define DEFLATE_DONE(strm, flush) 1
+/* Adjusts the upper bound on compressed data length based on compression parameters and uncompressed data length.
+ * Useful when arch-specific deflation code behaves differently than regular zlib-ng algorithms. */
+#  define DEFLATE_BOUND_ADJUST_COMPLEN(strm, complen, sourceLen) do {} while (0)
+/* Returns whether an optimistic upper bound on compressed data length should *not* be used.
+ * Useful when arch-specific deflation code behaves differently than regular zlib-ng algorithms. */
+#  define DEFLATE_NEED_CONSERVATIVE_BOUND(strm) 0
+/* Invoked for each deflate() call. Useful for plugging arch-specific deflation code. */
+#  define DEFLATE_HOOK(strm, flush, bstate) 0
+/* Returns whether zlib-ng should compute a checksum. Set to 0 if arch-specific deflation code already does that. */
+#  define DEFLATE_NEED_CHECKSUM(strm) 1
+/* Returns whether reproducibility parameter can be set to a given value. */
+#  define DEFLATE_CAN_SET_REPRODUCIBLE(strm, reproducible) 1
+#endif
+
 #endif /* DEFLATE_H_ */
diff --git a/deflate_fast.c b/deflate_fast.c
index 2d0444cd..1f3909c7 100644
--- a/deflate_fast.c
+++ b/deflate_fast.c
@@ -5,9 +5,11 @@
  */
 
 #include "zbuild.h"
+#include "zmemory.h"
 #include "deflate.h"
 #include "deflate_p.h"
 #include "functable.h"
+#include "insert_string_p.h"
 
 /* ===========================================================================
  * Compress as much as possible from the input stream, return the current
@@ -17,12 +19,13 @@
  * matches. It is used only for the fast compression options.
  */
 Z_INTERNAL block_state deflate_fast(deflate_state *s, int flush) {
-    Pos hash_head;        /* head of the hash chain */
+    unsigned char *window = s->window;
     int bflush = 0;       /* set if current block must be flushed */
-    int64_t dist;
     uint32_t match_len = 0;
 
     for (;;) {
+        uint8_t lc;
+
         /* Make sure that we always have enough lookahead, except
          * at the end of the input file. We need STD_MAX_MATCH bytes
          * for the next match, plus WANT_MIN_MATCH bytes to insert the
@@ -41,8 +44,14 @@ Z_INTERNAL block_state deflate_fast(deflate_state *s, int flush) {
          * dictionary, and set hash_head to the head of the hash chain:
          */
         if (s->lookahead >= WANT_MIN_MATCH) {
-            hash_head = quick_insert_string(s, s->strstart);
-            dist = (int64_t)s->strstart - hash_head;
+#if BYTE_ORDER == LITTLE_ENDIAN
+            uint32_t str_val = zng_memread_4(window + s->strstart);
+#else
+            uint32_t str_val = ZSWAP32(zng_memread_4(window + s->strstart));
+#endif
+            uint32_t hash_head = quick_insert_value(s, s->strstart, str_val);
+            int64_t dist = (int64_t)s->strstart - hash_head;
+            lc = (uint8_t)str_val;
 
             /* Find the longest match, discarding those <= prev_length.
              * At this point we have always match length < WANT_MIN_MATCH
@@ -52,12 +61,16 @@ Z_INTERNAL block_state deflate_fast(deflate_state *s, int flush) {
                  * of window index 0 (in particular we have to avoid a match
                  * of the string with itself at the start of the input file).
                  */
-                match_len = FUNCTABLE_CALL(longest_match)(s, hash_head);
+                match_len = FUNCTABLE_CALL(longest_match)(s, (uint32_t)hash_head);
                 /* longest_match() sets match_start */
             }
+        } else {
+            lc = window[s->strstart];
         }
 
         if (match_len >= WANT_MIN_MATCH) {
+            Assert(s->strstart <= UINT16_MAX, "strstart should fit in uint16_t");
+            Assert(s->match_start <= UINT16_MAX, "match_start should fit in uint16_t");
             check_match(s, s->strstart, s->match_start, match_len);
 
             bflush = zng_tr_tally_dist(s, s->strstart - s->match_start, match_len - STD_MIN_MATCH);
@@ -71,7 +84,7 @@ Z_INTERNAL block_state deflate_fast(deflate_state *s, int flush) {
                 match_len--; /* string at strstart already in table */
                 s->strstart++;
 
-                insert_string(s, s->strstart, match_len);
+                insert_string_static(s, s->strstart, match_len);
                 s->strstart += match_len;
             } else {
                 s->strstart += match_len;
@@ -84,7 +97,7 @@ Z_INTERNAL block_state deflate_fast(deflate_state *s, int flush) {
             match_len = 0;
         } else {
             /* No match, output a literal byte */
-            bflush = zng_tr_tally_lit(s, s->window[s->strstart]);
+            bflush = zng_tr_tally_lit(s, lc);
             s->lookahead--;
             s->strstart++;
         }
@@ -92,6 +105,7 @@ Z_INTERNAL block_state deflate_fast(deflate_state *s, int flush) {
             FLUSH_BLOCK(s, 0);
     }
     s->insert = s->strstart < (STD_MIN_MATCH - 1) ? s->strstart : (STD_MIN_MATCH - 1);
+
     if (UNLIKELY(flush == Z_FINISH)) {
         FLUSH_BLOCK(s, 1);
         return finish_done;
diff --git a/deflate_medium.c b/deflate_medium.c
index 2aeebe20..3849beeb 100644
--- a/deflate_medium.c
+++ b/deflate_medium.c
@@ -11,6 +11,7 @@
 #include "deflate.h"
 #include "deflate_p.h"
 #include "functable.h"
+#include "insert_string_p.h"
 
 struct match {
     uint16_t match_start;
@@ -45,12 +46,10 @@ static void insert_match(deflate_state *s, struct match match) {
     if (UNLIKELY(s->lookahead <= (unsigned int)(match.match_length + WANT_MIN_MATCH)))
         return;
 
-    /* string at strstart already in table */
-    match.strstart++;
-    match.match_length--;
-
     /* matches that are not long enough we need to emit as literals */
-    if (LIKELY(match.match_length < WANT_MIN_MATCH - 1)) {
+    if (LIKELY(match.match_length < WANT_MIN_MATCH)) {
+        match.strstart++;
+        match.match_length--;
         if (UNLIKELY(match.match_length > 0)) {
             if (match.strstart >= match.orgstart) {
                 if (match.strstart + match.match_length - 1 >= match.orgstart) {
@@ -65,25 +64,43 @@ static void insert_match(deflate_state *s, struct match match) {
         return;
     }
 
-    /* Insert into hash table. */
-    if (LIKELY(match.strstart >= match.orgstart)) {
-        if (LIKELY(match.strstart + match.match_length - 1 >= match.orgstart)) {
-            insert_string(s, match.strstart, match.match_length);
-        } else {
-            insert_string(s, match.strstart, match.orgstart - match.strstart + 1);
+    /* Insert new strings in the hash table only if the match length
+     * is not too large. This saves time but degrades compression.
+     */
+    if (match.match_length <= 16 * s->max_insert_length && s->lookahead >= WANT_MIN_MATCH) {
+        match.match_length--; /* string at strstart already in table */
+        match.strstart++;
+
+        if (LIKELY(match.strstart >= match.orgstart)) {
+            if (LIKELY(match.strstart + match.match_length - 1 >= match.orgstart)) {
+                insert_string(s, match.strstart, match.match_length);
+            } else {
+                insert_string(s, match.strstart, match.orgstart - match.strstart + 1);
+            }
+        } else if (match.orgstart < match.strstart + match.match_length) {
+            insert_string(s, match.orgstart, match.strstart + match.match_length - match.orgstart);
         }
-    } else if (match.orgstart < match.strstart + match.match_length) {
-        insert_string(s, match.orgstart, match.strstart + match.match_length - match.orgstart);
+        match.strstart += match.match_length;
+        match.match_length = 0;
+    } else {
+        match.strstart += match.match_length;
+        match.match_length = 0;
+
+        if (match.strstart >= (STD_MIN_MATCH - 2))
+            quick_insert_string(s, match.strstart + 2 - STD_MIN_MATCH);
+
+        /* If lookahead < WANT_MIN_MATCH, ins_h is garbage, but it does not
+         * matter since it will be recomputed at next deflate call.
+         */
     }
-    match.strstart += match.match_length;
-    match.match_length = 0;
 }
 
 static void fizzle_matches(deflate_state *s, struct match *current, struct match *next) {
-    Pos limit;
+    unsigned char *window;
     unsigned char *match, *orig;
-    int changed = 0;
     struct match c, n;
+    int changed = 0;
+    Pos limit;
     /* step zero: sanity checks */
 
     if (current->match_length <= 1)
@@ -95,8 +112,10 @@ static void fizzle_matches(deflate_state *s, struct match *current, struct match
     if (UNLIKELY(current->match_length > 1 + next->strstart))
         return;
 
-    match = s->window - current->match_length + 1 + next->match_start;
-    orig  = s->window - current->match_length + 1 + next->strstart;
+    window = s->window;
+
+    match = window - current->match_length + 1 + next->match_start;
+    orig  = window - current->match_length + 1 + next->strstart;
 
     /* quick exit check.. if this fails then don't bother with anything else */
     if (LIKELY(*match != *orig))
@@ -108,8 +127,8 @@ static void fizzle_matches(deflate_state *s, struct match *current, struct match
     /* step one: try to move the "next" match to the left as much as possible */
     limit = next->strstart > MAX_DIST(s) ? next->strstart - (Pos)MAX_DIST(s) : 0;
 
-    match = s->window + n.match_start - 1;
-    orig = s->window + n.strstart - 1;
+    match = window + n.match_start - 1;
+    orig = window + n.strstart - 1;
 
     while (*match == *orig) {
         if (UNLIKELY(c.match_length < 1))
@@ -154,7 +173,7 @@ Z_INTERNAL block_state deflate_medium(deflate_state *s, int flush) {
     memset(&next_match, 0, sizeof(struct match));
 
     for (;;) {
-        Pos hash_head = 0;    /* head of the hash chain */
+        uint32_t hash_head = 0;    /* head of the hash chain */
         int bflush = 0;       /* set if current block must be flushed */
         int64_t dist;
 
diff --git a/deflate_p.h b/deflate_p.h
index 7c74ebf5..7b5d5601 100644
--- a/deflate_p.h
+++ b/deflate_p.h
@@ -9,13 +9,16 @@
 #ifndef DEFLATE_P_H
 #define DEFLATE_P_H
 
+#include "functable.h"
+#include "fallback_builtins.h"
+
 /* Forward declare common non-inlined functions declared in deflate.c */
 
 #ifdef ZLIB_DEBUG
 /* ===========================================================================
  * Check that the match at match_start is indeed a match.
  */
-static inline void check_match(deflate_state *s, Pos start, Pos match, int length) {
+static inline void check_match(deflate_state *s, uint32_t start, uint32_t match, int length) {
     /* check that the match length is valid*/
     if (length < STD_MIN_MATCH || length > STD_MAX_MATCH) {
         fprintf(stderr, " start %u, match %u, length %d\n", start, match, length);
@@ -48,7 +51,6 @@ static inline void check_match(deflate_state *s, Pos start, Pos match, int lengt
 #endif
 
 Z_INTERNAL void PREFIX(flush_pending)(PREFIX3(stream) *strm);
-Z_INTERNAL unsigned PREFIX(read_buf)(PREFIX3(stream) *strm, unsigned char *buf, unsigned size);
 
 /* ===========================================================================
  * Save the match info and tally the frequency counts. Return true if
@@ -78,8 +80,10 @@ static inline int zng_tr_tally_dist(deflate_state* s, uint32_t dist, uint32_t le
     /* dist: distance of matched string */
     /* len: match length-STD_MIN_MATCH */
 #ifdef LIT_MEM
-    s->d_buf[s->sym_next] = dist;
-    s->l_buf[s->sym_next++] = len;
+    Assert(dist <= UINT16_MAX, "dist should fit in uint16_t");
+    Assert(len <= UINT8_MAX, "len should fit in uint8_t");
+    s->d_buf[s->sym_next] = (uint16_t)dist;
+    s->l_buf[s->sym_next++] = (uint8_t)len;
 #else
     s->sym_buf[s->sym_next++] = (uint8_t)(dist);
     s->sym_buf[s->sym_next++] = (uint8_t)(dist >> 8);
@@ -95,6 +99,73 @@ static inline int zng_tr_tally_dist(deflate_state* s, uint32_t dist, uint32_t le
     return (s->sym_next == s->sym_end);
 }
 
+/* =========================================================================
+ * Flush as much pending output as possible. All deflate() output, except for some
+ * deflate_stored() output, goes through this function so some applications may wish to
+ * modify it to avoid allocating a large strm->next_out buffer and copying into it.
+ * See also read_buf().
+ */
+Z_FORCEINLINE static void flush_pending_inline(PREFIX3(stream) *strm) {
+    uint32_t len;
+    deflate_state *s = strm->state;
+
+    zng_tr_flush_bits(s);
+    len = MIN(s->pending, strm->avail_out);
+    if (len == 0)
+        return;
+
+    Tracev((stderr, "[FLUSH]"));
+    memcpy(strm->next_out, s->pending_out, len);
+    strm->next_out  += len;
+    s->pending_out  += len;
+    strm->total_out += len;
+    strm->avail_out -= len;
+    s->pending      -= len;
+    if (s->pending == 0)
+        s->pending_out = s->pending_buf;
+}
+
+/* ===========================================================================
+ * Reverse the first len bits of a code using bit manipulation
+ */
+Z_FORCEINLINE static uint16_t bi_reverse(uint16_t code, int len) {
+    /* code: the value to invert */
+    /* len: its bit length */
+    Assert(len >= 1 && len <= 15, "code length must be 1-15");
+    return __builtin_bitreverse16(code) >> (16 - len);
+}
+
+/* ===========================================================================
+ * Read a new buffer from the current input stream, update the adler32 and total number of
+ * bytes read.  All deflate() input goes through this function so some applications may wish
+ * to modify it to avoid allocating a large strm->next_in buffer and copying from it.
+ * See also flush_pending_inline().
+ */
+Z_FORCEINLINE static unsigned read_buf(PREFIX3(stream) *strm, unsigned char *buf, unsigned size) {
+    deflate_state *s = strm->state;
+    uint32_t len = MIN(strm->avail_in, size);
+
+    if (len == 0)
+        return 0;
+
+    if (!DEFLATE_NEED_CHECKSUM(strm)) {
+        memcpy(buf, strm->next_in, len);
+#ifdef GZIP
+    } else if (s->wrap == 2) {
+        strm->adler = FUNCTABLE_CALL(crc32_copy)(strm->adler, buf, strm->next_in, len);
+#endif
+    } else if (s->wrap == 1) {
+        strm->adler = FUNCTABLE_CALL(adler32_copy)(strm->adler, buf, strm->next_in, len);
+    } else {
+        memcpy(buf, strm->next_in, len);
+    }
+
+    strm->avail_in -= len;
+    strm->next_in  += len;
+    strm->total_in += len;
+    return len;
+}
+
 /* ===========================================================================
  * Flush the current block, with given end-of-file flag.
  * IN assertion: strstart is set to the end of the current match.
@@ -121,6 +192,6 @@ static inline int zng_tr_tally_dist(deflate_state* s, uint32_t dist, uint32_t le
 /* Compression function. Returns the block state after the call. */
 typedef block_state (*compress_func) (deflate_state *s, int flush);
 /* Match function. Returns the longest match. */
-typedef uint32_t    (*match_func)    (deflate_state *const s, Pos cur_match);
+typedef uint32_t    (*match_func)    (deflate_state *const s, uint32_t cur_match);
 
 #endif
diff --git a/deflate_quick.c b/deflate_quick.c
index 5a1937b6..a191070d 100644
--- a/deflate_quick.c
+++ b/deflate_quick.c
@@ -18,18 +18,19 @@
  */
 
 #include "zbuild.h"
-#include "zutil_p.h"
+#include "zmemory.h"
 #include "deflate.h"
 #include "deflate_p.h"
 #include "functable.h"
 #include "trees_emit.h"
+#include "insert_string_p.h"
 
 extern const ct_data static_ltree[L_CODES+2];
 extern const ct_data static_dtree[D_CODES];
 
 #define QUICK_START_BLOCK(s, last) { \
     zng_tr_emit_tree(s, STATIC_TREES, last); \
-    s->block_open = 1 + (int)last; \
+    s->block_open = 1 + last; \
     s->block_start = (int)s->strstart; \
 }
 
@@ -45,12 +46,9 @@ extern const ct_data static_dtree[D_CODES];
 }
 
 Z_INTERNAL block_state deflate_quick(deflate_state *s, int flush) {
-    Pos hash_head;
-    int64_t dist;
-    unsigned match_len, last;
+    unsigned char *window;
+    unsigned last = (flush == Z_FINISH) ? 1 : 0;
 
-
-    last = (flush == Z_FINISH) ? 1 : 0;
     if (UNLIKELY(last && s->block_open != 2)) {
         /* Emit end of previous block */
         QUICK_END_BLOCK(s, 0);
@@ -62,7 +60,11 @@ Z_INTERNAL block_state deflate_quick(deflate_state *s, int flush) {
         QUICK_START_BLOCK(s, last);
     }
 
+    window = s->window;
+
     for (;;) {
+        uint8_t lc;
+
         if (UNLIKELY(s->pending + ((BIT_BUF_SIZE + 7) >> 3) >= s->pending_buf_size)) {
             PREFIX(flush_pending)(s->strm);
             if (s->strm->avail_out == 0) {
@@ -86,22 +88,33 @@ Z_INTERNAL block_state deflate_quick(deflate_state *s, int flush) {
         }
 
         if (LIKELY(s->lookahead >= WANT_MIN_MATCH)) {
-            hash_head = quick_insert_string(s, s->strstart);
-            dist = (int64_t)s->strstart - hash_head;
+#if BYTE_ORDER == LITTLE_ENDIAN
+            uint32_t str_val = zng_memread_4(window + s->strstart);
+#else
+            uint32_t str_val = ZSWAP32(zng_memread_4(window + s->strstart));
+#endif
+            uint32_t hash_head = quick_insert_value(s, s->strstart, str_val);
+            int64_t dist = (int64_t)s->strstart - hash_head;
+            lc = (uint8_t)str_val;
 
             if (dist <= MAX_DIST(s) && dist > 0) {
-                const uint8_t *str_start = s->window + s->strstart;
-                const uint8_t *match_start = s->window + hash_head;
+                const uint8_t *match_start = window + hash_head;
+#if BYTE_ORDER == LITTLE_ENDIAN
+                uint32_t match_val = zng_memread_4(match_start);
+#else
+                uint32_t match_val = ZSWAP32(zng_memread_4(match_start));
+#endif
 
-                if (zng_memcmp_2(str_start, match_start) == 0) {
-                    match_len = FUNCTABLE_CALL(compare256)(str_start+2, match_start+2) + 2;
+                if (str_val == match_val) {
+                    const uint8_t *str_start = window + s->strstart;
+                    uint32_t match_len = FUNCTABLE_CALL(compare256)(str_start+2, match_start+2) + 2;
 
                     if (match_len >= WANT_MIN_MATCH) {
                         if (UNLIKELY(match_len > s->lookahead))
                             match_len = s->lookahead;
-                        if (UNLIKELY(match_len > STD_MAX_MATCH))
-                            match_len = STD_MAX_MATCH;
 
+                        Assert(match_len <= STD_MAX_MATCH, "match too long");
+                        Assert(s->strstart <= UINT16_MAX, "strstart should fit in uint16_t");
                         check_match(s, s->strstart, hash_head, match_len);
 
                         zng_tr_emit_dist(s, static_ltree, static_dtree, match_len - STD_MIN_MATCH, (uint32_t)dist);
@@ -111,9 +124,10 @@ Z_INTERNAL block_state deflate_quick(deflate_state *s, int flush) {
                     }
                 }
             }
+        } else {
+            lc = window[s->strstart];
         }
-
-        zng_tr_emit_lit(s, static_ltree, s->window[s->strstart]);
+        zng_tr_emit_lit(s, static_ltree, lc);
         s->strstart++;
         s->lookahead--;
     }
diff --git a/deflate_rle.c b/deflate_rle.c
index ee442141..e468bc6b 100644
--- a/deflate_rle.c
+++ b/deflate_rle.c
@@ -5,21 +5,19 @@
  */
 
 #include "zbuild.h"
-#include "compare256_rle.h"
 #include "deflate.h"
 #include "deflate_p.h"
 #include "functable.h"
+#include "compare256_rle.h"
 
-#ifdef UNALIGNED_OK
-#  if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-#    define compare256_rle compare256_rle_unaligned_64
-#  elif defined(HAVE_BUILTIN_CTZ)
-#    define compare256_rle compare256_rle_unaligned_32
-#  else
-#    define compare256_rle compare256_rle_unaligned_16
-#  endif
+#if OPTIMAL_CMP == 8
+#  define compare256_rle compare256_rle_8
+#elif defined(HAVE_BUILTIN_CTZLL)
+#  define compare256_rle compare256_rle_64
+#elif defined(HAVE_BUILTIN_CTZ)
+#  define compare256_rle compare256_rle_32
 #else
-#  define compare256_rle compare256_rle_c
+#  define compare256_rle compare256_rle_16
 #endif
 
 /* ===========================================================================
@@ -58,6 +56,7 @@ Z_INTERNAL block_state deflate_rle(deflate_state *s, int flush) {
 
         /* Emit match if have run of STD_MIN_MATCH or longer, else emit literal */
         if (match_len >= STD_MIN_MATCH) {
+            Assert(s->strstart <= UINT16_MAX, "strstart should fit in uint16_t");
             check_match(s, s->strstart, s->strstart - 1, match_len);
 
             bflush = zng_tr_tally_dist(s, 1, match_len - STD_MIN_MATCH);
diff --git a/deflate_slow.c b/deflate_slow.c
index de70cc1b..96274e04 100644
--- a/deflate_slow.c
+++ b/deflate_slow.c
@@ -8,6 +8,7 @@
 #include "deflate.h"
 #include "deflate_p.h"
 #include "functable.h"
+#include "insert_string_p.h"
 
 /* ===========================================================================
  * Same as deflate_medium, but achieves better compression. We use a lazy
@@ -15,16 +16,19 @@
  * no better match at the next window position.
  */
 Z_INTERNAL block_state deflate_slow(deflate_state *s, int flush) {
-    Pos hash_head;           /* head of hash chain */
-    int bflush;              /* set if current block must be flushed */
-    int64_t dist;
-    uint32_t match_len;
     match_func longest_match;
+    insert_string_cb insert_string_func;
+    unsigned char *window = s->window;
+    int bflush;              /* set if current block must be flushed */
+    int level = s->level;
 
-    if (s->max_chain_length <= 1024)
-        longest_match = FUNCTABLE_FPTR(longest_match);
-    else
+    if (level >= 9) {
         longest_match = FUNCTABLE_FPTR(longest_match_slow);
+        insert_string_func = insert_string_roll;
+    } else {
+        longest_match = FUNCTABLE_FPTR(longest_match);
+        insert_string_func = insert_string;
+    }
 
     /* Process the input block. */
     for (;;) {
@@ -45,16 +49,19 @@ Z_INTERNAL block_state deflate_slow(deflate_state *s, int flush) {
         /* Insert the string window[strstart .. strstart+2] in the
          * dictionary, and set hash_head to the head of the hash chain:
          */
-        hash_head = 0;
+        uint32_t hash_head = 0;
         if (LIKELY(s->lookahead >= WANT_MIN_MATCH)) {
-            hash_head = s->quick_insert_string(s, s->strstart);
+            if (level >= 9)
+                hash_head = quick_insert_string_roll(s, s->strstart);
+            else
+                hash_head = quick_insert_string(s, s->strstart);
         }
 
         /* Find the longest match, discarding those <= prev_length.
          */
-        s->prev_match = (Pos)s->match_start;
-        match_len = STD_MIN_MATCH - 1;
-        dist = (int64_t)s->strstart - hash_head;
+        s->prev_match = s->match_start;
+        uint32_t match_len = STD_MIN_MATCH - 1;
+        int64_t dist = (int64_t)s->strstart - hash_head;
 
         if (dist <= MAX_DIST(s) && dist > 0 && s->prev_length < s->max_lazy_match && hash_head != 0) {
             /* To simplify the code, we prevent matches with the string
@@ -78,7 +85,8 @@ Z_INTERNAL block_state deflate_slow(deflate_state *s, int flush) {
             unsigned int max_insert = s->strstart + s->lookahead - STD_MIN_MATCH;
             /* Do not insert strings in hash table beyond this. */
 
-            check_match(s, s->strstart-1, s->prev_match, s->prev_length);
+            Assert((s->strstart-1) <= UINT16_MAX, "strstart-1 should fit in uint16_t");
+            check_match(s, s->strstart - 1, s->prev_match, s->prev_length);
 
             bflush = zng_tr_tally_dist(s, s->strstart -1 - s->prev_match, s->prev_length - STD_MIN_MATCH);
 
@@ -95,7 +103,7 @@ Z_INTERNAL block_state deflate_slow(deflate_state *s, int flush) {
                 unsigned int insert_cnt = mov_fwd;
                 if (UNLIKELY(insert_cnt > max_insert - s->strstart))
                     insert_cnt = max_insert - s->strstart;
-                s->insert_string(s, s->strstart + 1, insert_cnt);
+                insert_string_func(s, s->strstart + 1, insert_cnt);
             }
             s->prev_length = 0;
             s->match_available = 0;
@@ -109,7 +117,7 @@ Z_INTERNAL block_state deflate_slow(deflate_state *s, int flush) {
              * single literal. If there was a match but the current match
              * is longer, truncate the previous match to a single literal.
              */
-            bflush = zng_tr_tally_lit(s, s->window[s->strstart-1]);
+            bflush = zng_tr_tally_lit(s, window[s->strstart-1]);
             if (UNLIKELY(bflush))
                 FLUSH_BLOCK_ONLY(s, 0);
             s->prev_length = match_len;
@@ -129,7 +137,7 @@ Z_INTERNAL block_state deflate_slow(deflate_state *s, int flush) {
     }
     Assert(flush != Z_NO_FLUSH, "no flush?");
     if (UNLIKELY(s->match_available)) {
-        Z_UNUSED(zng_tr_tally_lit(s, s->window[s->strstart-1]));
+        Z_UNUSED(zng_tr_tally_lit(s, window[s->strstart-1]));
         s->match_available = 0;
     }
     s->insert = s->strstart < (STD_MIN_MATCH - 1) ? s->strstart : (STD_MIN_MATCH - 1);
diff --git a/deflate_stored.c b/deflate_stored.c
index 9e5acfbf..b8665ac0 100644
--- a/deflate_stored.c
+++ b/deflate_stored.c
@@ -29,7 +29,8 @@ Z_INTERNAL block_state deflate_stored(deflate_state *s, int flush) {
      * this is 32K. This can be as small as 507 bytes for memLevel == 1. For
      * large input and output buffers, the stored block size will be larger.
      */
-    unsigned min_block = MIN(s->pending_buf_size - 5, s->w_size);
+    unsigned int w_size = s->w_size;
+    unsigned min_block = MIN(s->pending_buf_size - 5, w_size);
 
     /* Copy as many min_block or larger stored blocks directly to next_out as
      * possible. If flushing, copy the remaining available input to next_out as
@@ -94,7 +95,7 @@ Z_INTERNAL block_state deflate_stored(deflate_state *s, int flush) {
          * the check value.
          */
         if (len) {
-            PREFIX(read_buf)(s->strm, s->strm->next_out, len);
+            read_buf(s->strm, s->strm->next_out, len);
             s->strm->next_out += len;
             s->strm->avail_out -= len;
             s->strm->total_out += len;
@@ -112,23 +113,23 @@ Z_INTERNAL block_state deflate_stored(deflate_state *s, int flush) {
         /* If any input was used, then no unused input remains in the window,
          * therefore s->block_start == s->strstart.
          */
-        if (used >= s->w_size) {    /* supplant the previous history */
+        if (used >= w_size) {    /* supplant the previous history */
             s->matches = 2;         /* clear hash */
-            memcpy(s->window, s->strm->next_in - s->w_size, s->w_size);
-            s->strstart = s->w_size;
+            memcpy(s->window, s->strm->next_in - w_size, w_size);
+            s->strstart = w_size;
             s->insert = s->strstart;
         } else {
             if (s->window_size - s->strstart <= used) {
                 /* Slide the window down. */
-                s->strstart -= s->w_size;
-                memcpy(s->window, s->window + s->w_size, s->strstart);
+                s->strstart -= w_size;
+                memcpy(s->window, s->window + w_size, s->strstart);
                 if (s->matches < 2)
                     s->matches++;   /* add a pending slide_hash() */
                 s->insert = MIN(s->insert, s->strstart);
             }
             memcpy(s->window + s->strstart, s->strm->next_in - used, used);
             s->strstart += used;
-            s->insert += MIN(used, s->w_size - s->insert);
+            s->insert += MIN(used, w_size - s->insert);
         }
         s->block_start = (int)s->strstart;
     }
@@ -144,22 +145,22 @@ Z_INTERNAL block_state deflate_stored(deflate_state *s, int flush) {
 
     /* Fill the window with any remaining input. */
     have = s->window_size - s->strstart;
-    if (s->strm->avail_in > have && s->block_start >= (int)s->w_size) {
+    if (s->strm->avail_in > have && s->block_start >= (int)w_size) {
         /* Slide the window down. */
-        s->block_start -= (int)s->w_size;
-        s->strstart -= s->w_size;
-        memcpy(s->window, s->window + s->w_size, s->strstart);
+        s->block_start -= (int)w_size;
+        s->strstart -= w_size;
+        memcpy(s->window, s->window + w_size, s->strstart);
         if (s->matches < 2)
             s->matches++;           /* add a pending slide_hash() */
-        have += s->w_size;          /* more space now */
+        have += w_size;          /* more space now */
         s->insert = MIN(s->insert, s->strstart);
     }
 
     have = MIN(have, s->strm->avail_in);
     if (have) {
-        PREFIX(read_buf)(s->strm, s->window + s->strstart, have);
+        read_buf(s->strm, s->window + s->strstart, have);
         s->strstart += have;
-        s->insert += MIN(have, s->w_size - s->insert);
+        s->insert += MIN(have, w_size - s->insert);
     }
     s->high_water = MAX(s->high_water, s->strstart);
 
@@ -171,7 +172,7 @@ Z_INTERNAL block_state deflate_stored(deflate_state *s, int flush) {
     have = (s->bi_valid + 42) >> 3;         /* number of header bytes */
         /* maximum stored block length that will fit in pending: */
     have = MIN(s->pending_buf_size - have, MAX_STORED);
-    min_block = MIN(have, s->w_size);
+    min_block = MIN(have, w_size);
     left = (int)s->strstart - s->block_start;
     if (left >= min_block || ((left || flush == Z_FINISH) && flush != Z_NO_FLUSH && s->strm->avail_in == 0 && left <= have)) {
         len = MIN(left, have);
diff --git a/doc/txtvsbin.txt b/doc/txtvsbin.txt
index 3d0f0634..2a901eaa 100644
--- a/doc/txtvsbin.txt
+++ b/doc/txtvsbin.txt
@@ -38,15 +38,15 @@ The Algorithm
 
 The algorithm works by dividing the set of bytecodes [0..255] into three
 categories:
-- The white list of textual bytecodes:
+- The allow list of textual bytecodes:
   9 (TAB), 10 (LF), 13 (CR), 32 (SPACE) to 255.
 - The gray list of tolerated bytecodes:
   7 (BEL), 8 (BS), 11 (VT), 12 (FF), 26 (SUB), 27 (ESC).
-- The black list of undesired, non-textual bytecodes:
+- The block list of undesired, non-textual bytecodes:
   0 (NUL) to 6, 14 to 31.
 
-If a file contains at least one byte that belongs to the white list and
-no byte that belongs to the black list, then the file is categorized as
+If a file contains at least one byte that belongs to the allow list and
+no byte that belongs to the block list, then the file is categorized as
 plain text; otherwise, it is categorized as binary.  (The boundary case,
 when the file is empty, automatically falls into the latter category.)
 
@@ -84,9 +84,9 @@ consistent results, regardless what alphabet encoding is being used.
 results on a text encoded, say, using ISO-8859-16 versus UTF-8.)
 
 There is an extra category of plain text files that are "polluted" with
-one or more black-listed codes, either by mistake or by peculiar design
+one or more block-listed codes, either by mistake or by peculiar design
 considerations.  In such cases, a scheme that tolerates a small fraction
-of black-listed codes would provide an increased recall (i.e. more true
+of block-listed codes would provide an increased recall (i.e. more true
 positives).  This, however, incurs a reduced precision overall, since
 false positives are more likely to appear in binary files that contain
 large chunks of textual data.  Furthermore, "polluted" plain text should
diff --git a/fallback_builtins.h b/fallback_builtins.h
index 8303508f..8ac84210 100644
--- a/fallback_builtins.h
+++ b/fallback_builtins.h
@@ -1,8 +1,12 @@
 #ifndef FALLBACK_BUILTINS_H
 #define FALLBACK_BUILTINS_H
 
+/* Provide fallback for compilers that don't support __has_builtin */
+#  ifndef __has_builtin
+#    define __has_builtin(x) 0
+#  endif
+
 #if defined(_MSC_VER) && !defined(__clang__)
-#if defined(_M_IX86) || defined(_M_AMD64) || defined(_M_IA64) ||  defined(_M_ARM) || defined(_M_ARM64) || defined(_M_ARM64EC)
 
 #include <intrin.h>
 
@@ -12,36 +16,69 @@
  * If tzcnt instruction is not supported, the cpu will itself execute bsf instead.
  * Performance tzcnt/bsf is identical on Intel cpu, tzcnt is faster than bsf on AMD cpu.
  */
-static __forceinline int __builtin_ctz(unsigned int value) {
+Z_FORCEINLINE static int __builtin_ctz(unsigned int value) {
     Assert(value != 0, "Invalid input value: 0");
-# if defined(X86_FEATURES) && !(_MSC_VER < 1700)
+#  if defined(X86_FEATURES) && !(_MSC_VER < 1700)
     return (int)_tzcnt_u32(value);
-# else
+#  else
     unsigned long trailing_zero;
     _BitScanForward(&trailing_zero, value);
     return (int)trailing_zero;
-# endif
+#  endif
 }
-#define HAVE_BUILTIN_CTZ
+#  define HAVE_BUILTIN_CTZ
 
-#ifdef _M_AMD64
+#  ifdef ARCH_64BIT
 /* This is not a general purpose replacement for __builtin_ctzll. The function expects that value is != 0.
  * Because of that assumption trailing_zero is not initialized and the return value is not checked.
  */
-static __forceinline int __builtin_ctzll(unsigned long long value) {
+Z_FORCEINLINE static int __builtin_ctzll(unsigned long long value) {
     Assert(value != 0, "Invalid input value: 0");
-# if defined(X86_FEATURES) && !(_MSC_VER < 1700)
+#  if defined(X86_FEATURES) && !(_MSC_VER < 1700)
     return (int)_tzcnt_u64(value);
-# else
+#  else
     unsigned long trailing_zero;
     _BitScanForward64(&trailing_zero, value);
     return (int)trailing_zero;
-# endif
+#  endif
+}
+#  define HAVE_BUILTIN_CTZLL
+#  endif // ARCH_64BIT
+
+#endif // _MSC_VER && !__clang__
+
+#if !__has_builtin(__builtin_bitreverse16)
+
+#  if defined(ARCH_ARM) && defined(ARCH_64BIT) && !defined(_MSC_VER)
+/* ARM bit reversal for 16-bit values using rbit instruction */
+Z_FORCEINLINE static uint16_t __builtin_bitreverse16(uint16_t value) {
+    uint32_t res;
+#    if __has_builtin(__builtin_rbit)
+    res = __builtin_rbit((uint32_t)value);
+#    else
+    __asm__ volatile("rbit %w0, %w1" : "=r"(res) : "r"((uint32_t)value));
+#    endif
+    return (uint16_t)(res >> 16);
+}
+#  elif defined(ARCH_LOONGARCH)
+/* LoongArch bit reversal for 16-bit values */
+Z_FORCEINLINE static uint16_t __builtin_bitreverse16(uint16_t value) {
+    uint32_t res;
+    __asm__ volatile("bitrev.w %0, %1" : "=r"(res) : "r"(value));
+    return (uint16_t)(res >> 16);
+}
+#  else
+/* Bit reversal for 8-bit values using multiplication method */
+#    define bitrev8(value) \
+    (uint8_t)((((uint8_t)(value) * 0x80200802ULL) & 0x0884422110ULL) * 0x0101010101ULL >> 32)
+
+/* General purpose bit reversal for 16-bit values */
+Z_FORCEINLINE static uint16_t __builtin_bitreverse16(uint16_t value) {
+    return ((bitrev8(value >> 8) | (uint16_t)bitrev8(value) << 8));
 }
-#define HAVE_BUILTIN_CTZLL
-#endif // Microsoft AMD64
+#    undef bitrev8
+#  endif
 
-#endif // Microsoft AMD64/IA64/x86/ARM/ARM64 test
-#endif // _MSC_VER & !clang
+#endif // __builtin_bitreverse16
 
 #endif // include guard FALLBACK_BUILTINS_H
diff --git a/functable.c b/functable.c
index 495d11ed..0e8911e1 100644
--- a/functable.c
+++ b/functable.c
@@ -5,14 +5,15 @@
 #ifndef DISABLE_RUNTIME_CPU_DETECTION
 
 #include "zbuild.h"
-#include "functable.h"
-#include "cpu_features.h"
-#include "arch_functions.h"
 
 #if defined(_MSC_VER)
 #  include <intrin.h>
 #endif
 
+#include "functable.h"
+#include "cpu_features.h"
+#include "arch_functions.h"
+
 /* Platform has pointer size atomic store */
 #if defined(__GNUC__) || defined(__clang__)
 #  define FUNCTABLE_ASSIGN(VAR, FUNC_NAME) \
@@ -21,7 +22,7 @@
 #elif defined(_MSC_VER)
 #  define FUNCTABLE_ASSIGN(VAR, FUNC_NAME) \
     _InterlockedExchangePointer((void * volatile *)&(functable.FUNC_NAME), (void *)(VAR.FUNC_NAME))
-#  if defined(_M_ARM) || defined(_M_ARM64)
+#  ifdef ARCH_ARM
 #    define FUNCTABLE_BARRIER() do { \
     _ReadWriteBarrier();  \
     __dmb(0xB); /* _ARM_BARRIER_ISH */ \
@@ -37,43 +38,90 @@
 #  define FUNCTABLE_BARRIER() do { /* Empty */ } while (0)
 #endif
 
-static void force_init_empty(void) {
-    // empty
+/* Verify all pointers are valid before assigning, return 1 on failure
+ * This allows inflateinit/deflateinit functions to gracefully return Z_VERSION_ERROR
+ * if functable initialization fails.
+ */
+#define FUNCTABLE_VERIFY_ASSIGN(VAR, FUNC_NAME) \
+    if (!VAR.FUNC_NAME) { \
+        fprintf(stderr, "Zlib-ng functable failed initialization!\n"); \
+        return 1; \
+    } \
+    FUNCTABLE_ASSIGN(VAR, FUNC_NAME);
+
+/* Functable init & abort on failure.
+ * Abort is needed because some stub functions are reachable without first
+ * calling any inflateinit/deflateinit functions, and have no error propagation.
+ */
+#define FUNCTABLE_INIT_ABORT \
+    if (init_functable()) { \
+        fprintf(stderr, "Zlib-ng functable failed initialization!\n"); \
+        abort(); \
+    };
+
+// Empty stub, used when functable has already been initialized
+static int force_init_empty(void) {
+    return 0;
 }
 
-static void init_functable(void) {
+/* Functable initialization.
+ * Selects the best available optimized functions appropriate for the runtime cpu.
+ */
+static int init_functable(void) {
     struct functable_s ft;
     struct cpu_features cf;
 
+    memset(&ft, 0, sizeof(struct functable_s));
     cpu_check_features(&cf);
-
-    // Generic code
     ft.force_init = &force_init_empty;
+
+    // Set up generic C code fallbacks
+#ifndef WITH_ALL_FALLBACKS
+#  if defined(ARCH_X86) && defined(ARCH_64BIT) && defined(X86_SSE2)
+    // x86_64 always has SSE2, so we can use SSE2 functions as fallbacks where available.
+    ft.adler32 = &adler32_c;
+    ft.adler32_copy = &adler32_copy_c;
+    ft.crc32 = &crc32_braid;
+    ft.crc32_copy = &crc32_copy_braid;
+#    ifndef HAVE_BUILTIN_CTZ
+    ft.longest_match = &longest_match_c;
+    ft.longest_match_slow = &longest_match_slow_c;
+    ft.compare256 = &compare256_c;
+#    endif
+#  endif
+#else // WITH_ALL_FALLBACKS
     ft.adler32 = &adler32_c;
-    ft.adler32_fold_copy = &adler32_fold_copy_c;
+    ft.adler32_copy = &adler32_copy_c;
     ft.chunkmemset_safe = &chunkmemset_safe_c;
-    ft.chunksize = &chunksize_c;
-    ft.crc32 = &PREFIX(crc32_braid);
-    ft.crc32_fold = &crc32_fold_c;
-    ft.crc32_fold_copy = &crc32_fold_copy_c;
-    ft.crc32_fold_final = &crc32_fold_final_c;
-    ft.crc32_fold_reset = &crc32_fold_reset_c;
+    ft.crc32 = &crc32_braid;
+    ft.crc32_copy = &crc32_copy_braid;
     ft.inflate_fast = &inflate_fast_c;
     ft.slide_hash = &slide_hash_c;
-    ft.longest_match = &longest_match_generic;
-    ft.longest_match_slow = &longest_match_slow_generic;
-    ft.compare256 = &compare256_generic;
+    ft.longest_match = &longest_match_c;
+    ft.longest_match_slow = &longest_match_slow_c;
+    ft.compare256 = &compare256_c;
+#endif
 
     // Select arch-optimized functions
+#ifdef WITH_OPTIM
+
+    // Chorba generic C fallback
+#ifndef WITHOUT_CHORBA
+    ft.crc32 = &crc32_chorba;
+    ft.crc32_copy = &crc32_copy_chorba;
+#endif
 
     // X86 - SSE2
 #ifdef X86_SSE2
-#  if !defined(__x86_64__) && !defined(_M_X64) && !defined(X86_NOCHECK_SSE2)
+#  ifdef ARCH_32BIT
     if (cf.x86.has_sse2)
 #  endif
     {
         ft.chunkmemset_safe = &chunkmemset_safe_sse2;
-        ft.chunksize = &chunksize_sse2;
+#  if !defined(WITHOUT_CHORBA_SSE)
+        ft.crc32 = &crc32_chorba_sse2;
+        ft.crc32_copy = &crc32_copy_chorba_sse2;
+#  endif
         ft.inflate_fast = &inflate_fast_sse2;
         ft.slide_hash = &slide_hash_sse2;
 #  ifdef HAVE_BUILTIN_CTZ
@@ -87,33 +135,43 @@ static void init_functable(void) {
 #ifdef X86_SSSE3
     if (cf.x86.has_ssse3) {
         ft.adler32 = &adler32_ssse3;
+        ft.adler32_copy = &adler32_copy_ssse3;
         ft.chunkmemset_safe = &chunkmemset_safe_ssse3;
         ft.inflate_fast = &inflate_fast_ssse3;
     }
 #endif
+
+    // X86 - SSE4.1
+#if defined(X86_SSE41) && !defined(WITHOUT_CHORBA_SSE)
+    if (cf.x86.has_sse41) {
+        ft.crc32 = &crc32_chorba_sse41;
+        ft.crc32_copy = &crc32_copy_chorba_sse41;
+    }
+#endif
+
     // X86 - SSE4.2
 #ifdef X86_SSE42
     if (cf.x86.has_sse42) {
-        ft.adler32_fold_copy = &adler32_fold_copy_sse42;
+        ft.adler32_copy = &adler32_copy_sse42;
     }
 #endif
     // X86 - PCLMUL
 #ifdef X86_PCLMULQDQ_CRC
     if (cf.x86.has_pclmulqdq) {
         ft.crc32 = &crc32_pclmulqdq;
-        ft.crc32_fold = &crc32_fold_pclmulqdq;
-        ft.crc32_fold_copy = &crc32_fold_pclmulqdq_copy;
-        ft.crc32_fold_final = &crc32_fold_pclmulqdq_final;
-        ft.crc32_fold_reset = &crc32_fold_pclmulqdq_reset;
+        ft.crc32_copy = &crc32_copy_pclmulqdq;
     }
 #endif
     // X86 - AVX
 #ifdef X86_AVX2
-    if (cf.x86.has_avx2) {
+    /* BMI2 support is all but implicit with AVX2 but let's sanity check this just in case. Enabling BMI2 allows for
+     * flagless shifts, resulting in fewer flag stalls for the pipeline, and allows us to set destination registers
+     * for the shift results as an operand, eliminating several register-register moves when the original value needs
+     * to remain intact. They also allow for a count operand that isn't the CL register, avoiding contention there */
+    if (cf.x86.has_avx2 && cf.x86.has_bmi2) {
         ft.adler32 = &adler32_avx2;
-        ft.adler32_fold_copy = &adler32_fold_copy_avx2;
+        ft.adler32_copy = &adler32_copy_avx2;
         ft.chunkmemset_safe = &chunkmemset_safe_avx2;
-        ft.chunksize = &chunksize_avx2;
         ft.inflate_fast = &inflate_fast_avx2;
         ft.slide_hash = &slide_hash_avx2;
 #  ifdef HAVE_BUILTIN_CTZ
@@ -127,23 +185,27 @@ static void init_functable(void) {
 #ifdef X86_AVX512
     if (cf.x86.has_avx512_common) {
         ft.adler32 = &adler32_avx512;
-        ft.adler32_fold_copy = &adler32_fold_copy_avx512;
+        ft.adler32_copy = &adler32_copy_avx512;
+        ft.chunkmemset_safe = &chunkmemset_safe_avx512;
+        ft.inflate_fast = &inflate_fast_avx512;
+#  ifdef HAVE_BUILTIN_CTZLL
+        ft.compare256 = &compare256_avx512;
+        ft.longest_match = &longest_match_avx512;
+        ft.longest_match_slow = &longest_match_slow_avx512;
+#  endif
     }
 #endif
 #ifdef X86_AVX512VNNI
     if (cf.x86.has_avx512vnni) {
         ft.adler32 = &adler32_avx512_vnni;
-        ft.adler32_fold_copy = &adler32_fold_copy_avx512_vnni;
+        ft.adler32_copy = &adler32_copy_avx512_vnni;
     }
 #endif
     // X86 - VPCLMULQDQ
 #ifdef X86_VPCLMULQDQ_CRC
     if (cf.x86.has_pclmulqdq && cf.x86.has_avx512_common && cf.x86.has_vpclmulqdq) {
         ft.crc32 = &crc32_vpclmulqdq;
-        ft.crc32_fold = &crc32_fold_vpclmulqdq;
-        ft.crc32_fold_copy = &crc32_fold_vpclmulqdq_copy;
-        ft.crc32_fold_final = &crc32_fold_vpclmulqdq_final;
-        ft.crc32_fold_reset = &crc32_fold_vpclmulqdq_reset;
+        ft.crc32_copy = &crc32_copy_vpclmulqdq;
     }
 #endif
 
@@ -164,8 +226,8 @@ static void init_functable(void) {
 #  endif
     {
         ft.adler32 = &adler32_neon;
+        ft.adler32_copy = &adler32_copy_neon;
         ft.chunkmemset_safe = &chunkmemset_safe_neon;
-        ft.chunksize = &chunksize_neon;
         ft.inflate_fast = &inflate_fast_neon;
         ft.slide_hash = &slide_hash_neon;
 #  ifdef HAVE_BUILTIN_CTZLL
@@ -175,18 +237,26 @@ static void init_functable(void) {
 #  endif
     }
 #endif
-    // ARM - ACLE
-#ifdef ARM_ACLE
+    // ARM - CRC32
+#ifdef ARM_CRC32
     if (cf.arm.has_crc32) {
-        ft.crc32 = &crc32_acle;
+        ft.crc32 = &crc32_armv8;
+        ft.crc32_copy = &crc32_copy_armv8;
+    }
+#endif
+    // ARM - PMULL EOR3
+#ifdef ARM_PMULL_EOR3
+    if (cf.arm.has_crc32 && cf.arm.has_pmull && cf.arm.has_eor3 && cf.arm.has_fast_pmull) {
+        ft.crc32 = &crc32_armv8_pmull_eor3;
+        ft.crc32_copy = &crc32_copy_armv8_pmull_eor3;
     }
 #endif
-
 
     // Power - VMX
 #ifdef PPC_VMX
     if (cf.power.has_altivec) {
         ft.adler32 = &adler32_vmx;
+        ft.adler32_copy = &adler32_copy_vmx;
         ft.slide_hash = &slide_hash_vmx;
     }
 #endif
@@ -194,15 +264,17 @@ static void init_functable(void) {
 #ifdef POWER8_VSX
     if (cf.power.has_arch_2_07) {
         ft.adler32 = &adler32_power8;
+        ft.adler32_copy = &adler32_copy_power8;
         ft.chunkmemset_safe = &chunkmemset_safe_power8;
-        ft.chunksize = &chunksize_power8;
         ft.inflate_fast = &inflate_fast_power8;
         ft.slide_hash = &slide_hash_power8;
     }
 #endif
 #ifdef POWER8_VSX_CRC32
-    if (cf.power.has_arch_2_07)
+    if (cf.power.has_arch_2_07) {
         ft.crc32 = &crc32_power8;
+        ft.crc32_copy = &crc32_copy_power8;
+    }
 #endif
     // Power9
 #ifdef POWER9
@@ -218,9 +290,8 @@ static void init_functable(void) {
 #ifdef RISCV_RVV
     if (cf.riscv.has_rvv) {
         ft.adler32 = &adler32_rvv;
-        ft.adler32_fold_copy = &adler32_fold_copy_rvv;
+        ft.adler32_copy = &adler32_copy_rvv;
         ft.chunkmemset_safe = &chunkmemset_safe_rvv;
-        ft.chunksize = &chunksize_rvv;
         ft.compare256 = &compare256_rvv;
         ft.inflate_fast = &inflate_fast_rvv;
         ft.longest_match = &longest_match_rvv;
@@ -229,106 +300,131 @@ static void init_functable(void) {
     }
 #endif
 
+    // RISCV - ZBC
+#ifdef RISCV_CRC32_ZBC
+    if (cf.riscv.has_zbc) {
+        ft.crc32 = &crc32_riscv64_zbc;
+        ft.crc32_copy = &crc32_copy_riscv64_zbc;
+    }
+#endif
 
     // S390
 #ifdef S390_CRC32_VX
-    if (cf.s390.has_vx)
+    if (cf.s390.has_vx) {
         ft.crc32 = crc32_s390_vx;
+        ft.crc32_copy = crc32_copy_s390_vx;
+    }
+#endif
+
+    // LOONGARCH
+#ifdef LOONGARCH_CRC
+    if (cf.loongarch.has_crc) {
+        ft.crc32 = crc32_loongarch64;
+        ft.crc32_copy = crc32_copy_loongarch64;
+    }
+#endif
+#ifdef LOONGARCH_LSX
+    if (cf.loongarch.has_lsx) {
+        ft.adler32 = &adler32_lsx;
+        ft.adler32_copy = &adler32_copy_lsx;
+        ft.slide_hash = slide_hash_lsx;
+#  ifdef HAVE_BUILTIN_CTZ
+        ft.compare256 = &compare256_lsx;
+        ft.longest_match = &longest_match_lsx;
+        ft.longest_match_slow = &longest_match_slow_lsx;
+#  endif
+        ft.chunkmemset_safe = &chunkmemset_safe_lsx;
+        ft.inflate_fast = &inflate_fast_lsx;
+    }
+#endif
+#ifdef LOONGARCH_LASX
+    if (cf.loongarch.has_lasx) {
+        ft.adler32 = &adler32_lasx;
+        ft.adler32_copy = &adler32_copy_lasx;
+        ft.slide_hash = slide_hash_lasx;
+#  ifdef HAVE_BUILTIN_CTZ
+        ft.compare256 = &compare256_lasx;
+        ft.longest_match = &longest_match_lasx;
+        ft.longest_match_slow = &longest_match_slow_lasx;
+#  endif
+        ft.chunkmemset_safe = &chunkmemset_safe_lasx;
+        ft.inflate_fast = &inflate_fast_lasx;
+    }
 #endif
 
+#endif // WITH_OPTIM
+
     // Assign function pointers individually for atomic operation
     FUNCTABLE_ASSIGN(ft, force_init);
-    FUNCTABLE_ASSIGN(ft, adler32);
-    FUNCTABLE_ASSIGN(ft, adler32_fold_copy);
-    FUNCTABLE_ASSIGN(ft, chunkmemset_safe);
-    FUNCTABLE_ASSIGN(ft, chunksize);
-    FUNCTABLE_ASSIGN(ft, compare256);
-    FUNCTABLE_ASSIGN(ft, crc32);
-    FUNCTABLE_ASSIGN(ft, crc32_fold);
-    FUNCTABLE_ASSIGN(ft, crc32_fold_copy);
-    FUNCTABLE_ASSIGN(ft, crc32_fold_final);
-    FUNCTABLE_ASSIGN(ft, crc32_fold_reset);
-    FUNCTABLE_ASSIGN(ft, inflate_fast);
-    FUNCTABLE_ASSIGN(ft, longest_match);
-    FUNCTABLE_ASSIGN(ft, longest_match_slow);
-    FUNCTABLE_ASSIGN(ft, slide_hash);
+    FUNCTABLE_VERIFY_ASSIGN(ft, adler32);
+    FUNCTABLE_VERIFY_ASSIGN(ft, adler32_copy);
+    FUNCTABLE_VERIFY_ASSIGN(ft, chunkmemset_safe);
+    FUNCTABLE_VERIFY_ASSIGN(ft, compare256);
+    FUNCTABLE_VERIFY_ASSIGN(ft, crc32);
+    FUNCTABLE_VERIFY_ASSIGN(ft, crc32_copy);
+    FUNCTABLE_VERIFY_ASSIGN(ft, inflate_fast);
+    FUNCTABLE_VERIFY_ASSIGN(ft, longest_match);
+    FUNCTABLE_VERIFY_ASSIGN(ft, longest_match_slow);
+    FUNCTABLE_VERIFY_ASSIGN(ft, slide_hash);
 
     // Memory barrier for weak memory order CPUs
     FUNCTABLE_BARRIER();
+
+    return Z_OK;
 }
 
 /* stub functions */
-static void force_init_stub(void) {
-    init_functable();
+static int force_init_stub(void) {
+    return init_functable();
 }
 
 static uint32_t adler32_stub(uint32_t adler, const uint8_t* buf, size_t len) {
-    init_functable();
+    FUNCTABLE_INIT_ABORT;
     return functable.adler32(adler, buf, len);
 }
 
-static uint32_t adler32_fold_copy_stub(uint32_t adler, uint8_t* dst, const uint8_t* src, size_t len) {
-    init_functable();
-    return functable.adler32_fold_copy(adler, dst, src, len);
-}
-
-static uint8_t* chunkmemset_safe_stub(uint8_t* out, unsigned dist, unsigned len, unsigned left) {
-    init_functable();
-    return functable.chunkmemset_safe(out, dist, len, left);
+static uint32_t adler32_copy_stub(uint32_t adler, uint8_t* dst, const uint8_t* src, size_t len) {
+    FUNCTABLE_INIT_ABORT;
+    return functable.adler32_copy(adler, dst, src, len);
 }
 
-static uint32_t chunksize_stub(void) {
-    init_functable();
-    return functable.chunksize();
+static uint8_t* chunkmemset_safe_stub(uint8_t* out, uint8_t *from, unsigned len, unsigned left) {
+    FUNCTABLE_INIT_ABORT;
+    return functable.chunkmemset_safe(out, from, len, left);
 }
 
 static uint32_t compare256_stub(const uint8_t* src0, const uint8_t* src1) {
-    init_functable();
+    FUNCTABLE_INIT_ABORT;
     return functable.compare256(src0, src1);
 }
 
 static uint32_t crc32_stub(uint32_t crc, const uint8_t* buf, size_t len) {
-    init_functable();
+    FUNCTABLE_INIT_ABORT;
     return functable.crc32(crc, buf, len);
 }
 
-static void crc32_fold_stub(crc32_fold* crc, const uint8_t* src, size_t len, uint32_t init_crc) {
-    init_functable();
-    functable.crc32_fold(crc, src, len, init_crc);
-}
-
-static void crc32_fold_copy_stub(crc32_fold* crc, uint8_t* dst, const uint8_t* src, size_t len) {
-    init_functable();
-    functable.crc32_fold_copy(crc, dst, src, len);
-}
-
-static uint32_t crc32_fold_final_stub(crc32_fold* crc) {
-    init_functable();
-    return functable.crc32_fold_final(crc);
-}
-
-static uint32_t crc32_fold_reset_stub(crc32_fold* crc) {
-    init_functable();
-    return functable.crc32_fold_reset(crc);
+static uint32_t crc32_copy_stub(uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len) {
+    FUNCTABLE_INIT_ABORT;
+    return functable.crc32_copy(crc, dst, src, len);
 }
 
 static void inflate_fast_stub(PREFIX3(stream) *strm, uint32_t start) {
-    init_functable();
+    FUNCTABLE_INIT_ABORT;
     functable.inflate_fast(strm, start);
 }
 
-static uint32_t longest_match_stub(deflate_state* const s, Pos cur_match) {
-    init_functable();
+static uint32_t longest_match_stub(deflate_state* const s, uint32_t cur_match) {
+    FUNCTABLE_INIT_ABORT;
     return functable.longest_match(s, cur_match);
 }
 
-static uint32_t longest_match_slow_stub(deflate_state* const s, Pos cur_match) {
-    init_functable();
+static uint32_t longest_match_slow_stub(deflate_state* const s, uint32_t cur_match) {
+    FUNCTABLE_INIT_ABORT;
     return functable.longest_match_slow(s, cur_match);
 }
 
 static void slide_hash_stub(deflate_state* s) {
-    init_functable();
+    FUNCTABLE_INIT_ABORT;
     functable.slide_hash(s);
 }
 
@@ -336,15 +432,11 @@ static void slide_hash_stub(deflate_state* s) {
 Z_INTERNAL struct functable_s functable = {
     force_init_stub,
     adler32_stub,
-    adler32_fold_copy_stub,
+    adler32_copy_stub,
     chunkmemset_safe_stub,
-    chunksize_stub,
     compare256_stub,
     crc32_stub,
-    crc32_fold_stub,
-    crc32_fold_copy_stub,
-    crc32_fold_final_stub,
-    crc32_fold_reset_stub,
+    crc32_copy_stub,
     inflate_fast_stub,
     longest_match_stub,
     longest_match_slow_stub,
diff --git a/functable.h b/functable.h
index 173a030c..0fa2e972 100644
--- a/functable.h
+++ b/functable.h
@@ -24,20 +24,16 @@
 #else
 
 struct functable_s {
-    void     (* force_init)         (void);
+    int      (* force_init)         (void);
     uint32_t (* adler32)            (uint32_t adler, const uint8_t *buf, size_t len);
-    uint32_t (* adler32_fold_copy)  (uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
-    uint8_t* (* chunkmemset_safe)   (uint8_t *out, unsigned dist, unsigned len, unsigned left);
-    uint32_t (* chunksize)          (void);
+    uint32_t (* adler32_copy)       (uint32_t adler, uint8_t *dst, const uint8_t *src, size_t len);
+    uint8_t* (* chunkmemset_safe)   (uint8_t *out, uint8_t *from, unsigned len, unsigned left);
     uint32_t (* compare256)         (const uint8_t *src0, const uint8_t *src1);
     uint32_t (* crc32)              (uint32_t crc, const uint8_t *buf, size_t len);
-    void     (* crc32_fold)         (struct crc32_fold_s *crc, const uint8_t *src, size_t len, uint32_t init_crc);
-    void     (* crc32_fold_copy)    (struct crc32_fold_s *crc, uint8_t *dst, const uint8_t *src, size_t len);
-    uint32_t (* crc32_fold_final)   (struct crc32_fold_s *crc);
-    uint32_t (* crc32_fold_reset)   (struct crc32_fold_s *crc);
+    uint32_t (* crc32_copy)         (uint32_t crc, uint8_t *dst, const uint8_t *src, size_t len);
     void     (* inflate_fast)       (PREFIX3(stream) *strm, uint32_t start);
-    uint32_t (* longest_match)      (deflate_state *const s, Pos cur_match);
-    uint32_t (* longest_match_slow) (deflate_state *const s, Pos cur_match);
+    uint32_t (* longest_match)      (deflate_state *const s, uint32_t cur_match);
+    uint32_t (* longest_match_slow) (deflate_state *const s, uint32_t cur_match);
     void     (* slide_hash)         (deflate_state *s);
 };
 
@@ -46,7 +42,7 @@ Z_INTERNAL extern struct functable_s functable;
 
 /* Explicitly indicate functions are conditionally dispatched.
  */
-#  define FUNCTABLE_INIT functable.force_init()
+#  define FUNCTABLE_INIT if (functable.force_init()) {return Z_VERSION_ERROR;}
 #  define FUNCTABLE_CALL(name) functable.name
 #  define FUNCTABLE_FPTR(name) functable.name
 
diff --git a/gzguts.h b/gzguts.h
index 14f23911..67dc280d 100644
--- a/gzguts.h
+++ b/gzguts.h
@@ -112,6 +112,7 @@ typedef struct {
     unsigned want;          /* requested buffer size, default is GZBUFSIZE */
     unsigned char *in;      /* input buffer (double-sized when writing) */
     unsigned char *out;     /* output buffer (double-sized when reading) */
+    unsigned char *buffers; /* Pointer to the real input/output buffer allocation */
     int direct;             /* 0 if processing gzip, 1 if transparent */
         /* just for reading */
     int how;                /* 0: get header, 1: copy, 2: decompress */
@@ -134,7 +135,11 @@ typedef struct {
 typedef gz_state *gz_statep;
 
 /* shared functions */
-void Z_INTERNAL gz_error(gz_state *, int, const char *);
+void Z_INTERNAL PREFIX(gz_error)(gz_state *, int, const char *);
+int  Z_INTERNAL gz_buffer_alloc(gz_state *state);
+void Z_INTERNAL gz_buffer_free(gz_state *state);
+void Z_INTERNAL gz_state_free(gz_state *state);
+
 #ifdef ZLIB_COMPAT
 unsigned Z_INTERNAL gz_intmax(void);
 #endif
diff --git a/gzlib.c b/gzlib.c
index b8a506b6..016a0a6d 100644
--- a/gzlib.c
+++ b/gzlib.c
@@ -4,6 +4,7 @@
  */
 
 #include "zbuild.h"
+#include "zutil.h"
 #include "zutil_p.h"
 #include "gzguts.h"
 
@@ -18,9 +19,38 @@
 #endif
 
 /* Local functions */
+static gzFile gz_state_init(void);
 static void gz_reset(gz_state *);
 static gzFile gz_open(const void *, int, const char *);
 
+/* Initialize struct for gzFile state */
+static gzFile gz_state_init(void) {
+    /* allocate gzFile structure to return */
+    gz_state *state = (gz_state *)zng_alloc(sizeof(gz_state));
+    if (state == NULL)
+        return NULL;
+
+    state->strm.zalloc = NULL;
+    state->strm.zfree = NULL;
+    state->strm.opaque = NULL;
+    state->strm.next_in = NULL;
+
+    state->size = 0;
+    state->want = GZBUFSIZE;
+    state->in = NULL;
+    state->out = NULL;
+    state->direct = 0;
+    state->mode = GZ_NONE;
+    state->level = Z_DEFAULT_COMPRESSION;
+    state->strategy = Z_DEFAULT_STRATEGY;
+    state->msg = NULL;
+    return (gzFile)state;
+}
+
+void Z_INTERNAL gz_state_free(gz_state *state) {
+    zng_free(state);
+}
+
 /* Reset gzip file state */
 static void gz_reset(gz_state *state) {
     state->x.have = 0;              /* no output data available */
@@ -32,11 +62,49 @@ static void gz_reset(gz_state *state) {
     else                            /* for writing ... */
         state->reset = 0;           /* no deflateReset pending */
     state->seek = 0;                /* no seek request pending */
-    gz_error(state, Z_OK, NULL);    /* clear error */
+    PREFIX(gz_error)(state, Z_OK, NULL);    /* clear error */
     state->x.pos = 0;               /* no uncompressed data yet */
     state->strm.avail_in = 0;       /* no input data yet */
 }
 
+/* Allocate in/out buffers for gzFile */
+int Z_INTERNAL gz_buffer_alloc(gz_state *state) {
+    int want = state->want;
+    int in_size = want, out_size = want;
+
+    if (state->mode == GZ_WRITE) {
+        in_size = want * 2; // double input buffer for compression (ref: gzprintf)
+        if (state->direct)
+            out_size = 0; // output buffer not needed in write + direct mode
+    } else if (state->mode == GZ_READ) {
+        out_size = want * 2;  // double output buffer for decompression
+    }
+
+    state->buffers = (unsigned char *)zng_alloc_aligned((in_size + out_size), 64);
+    state->in = state->buffers;
+    if (out_size) {
+        state->out = state->buffers + (in_size); // Outbuffer goes after inbuffer
+    }
+
+    /* Return error if memory allocation failed */
+    if (state->in == NULL || (out_size && state->out == NULL)) {
+        gz_buffer_free(state);
+        PREFIX(gz_error)(state, Z_MEM_ERROR, "out of memory");
+        return -1;
+    }
+
+    state->size = want; // mark state as initialized
+    return 0;
+}
+
+void Z_INTERNAL gz_buffer_free(gz_state *state) {
+    zng_free_aligned(state->buffers);
+    state->buffers = NULL;
+    state->out = NULL;
+    state->in = NULL;
+    state->size = 0;
+}
+
 /* Open a gzip file either by name or file descriptor. */
 static gzFile gz_open(const void *path, int fd, const char *mode) {
     gz_state *state;
@@ -53,19 +121,12 @@ static gzFile gz_open(const void *path, int fd, const char *mode) {
     if (path == NULL)
         return NULL;
 
-    /* allocate gzFile structure to return */
-    state = (gz_state *)zng_alloc(sizeof(gz_state));
+    /* Initialize gzFile state */
+    state = (gz_state *)gz_state_init();
     if (state == NULL)
         return NULL;
-    state->size = 0;            /* no buffers allocated yet */
-    state->want = GZBUFSIZE;    /* requested buffer size */
-    state->msg = NULL;          /* no error message yet */
 
     /* interpret mode */
-    state->mode = GZ_NONE;
-    state->level = Z_DEFAULT_COMPRESSION;
-    state->strategy = Z_DEFAULT_STRATEGY;
-    state->direct = 0;
     while (*mode) {
         if (*mode >= '0' && *mode <= '9') {
             state->level = *mode - '0';
@@ -83,7 +144,7 @@ static gzFile gz_open(const void *path, int fd, const char *mode) {
                 break;
 #endif
             case '+':       /* can't read and write at the same time */
-                zng_free(state);
+                gz_state_free(state);
                 return NULL;
             case 'b':       /* ignore -- will request binary anyway */
                 break;
@@ -121,14 +182,14 @@ static gzFile gz_open(const void *path, int fd, const char *mode) {
 
     /* must provide an "r", "w", or "a" */
     if (state->mode == GZ_NONE) {
-        zng_free(state);
+        gz_state_free(state);
         return NULL;
     }
 
     /* can't force transparent read */
     if (state->mode == GZ_READ) {
         if (state->direct) {
-            zng_free(state);
+            gz_state_free(state);
             return NULL;
         }
         state->direct = 1;      /* for empty file */
@@ -145,7 +206,7 @@ static gzFile gz_open(const void *path, int fd, const char *mode) {
         len = strlen((const char *)path);
     state->path = (char *)malloc(len + 1);
     if (state->path == NULL) {
-        zng_free(state);
+        gz_state_free(state);
         return NULL;
     }
 #ifdef WIDECHAR
@@ -190,7 +251,7 @@ static gzFile gz_open(const void *path, int fd, const char *mode) {
         open((const char *)path, oflag, 0666));
     if (state->fd == -1) {
         free(state->path);
-        zng_free(state);
+        gz_state_free(state);
         return NULL;
     }
     if (state->mode == GZ_APPEND) {
@@ -224,14 +285,13 @@ gzFile Z_EXPORT PREFIX4(gzopen)(const char *path, const char *mode) {
 
 /* -- see zlib.h -- */
 gzFile Z_EXPORT PREFIX(gzdopen)(int fd, const char *mode) {
-    char *path;         /* identifier for error messages */
     gzFile gz;
+    char path[32];         /* identifier for error messages */
 
-    if (fd == -1 || (path = (char *)malloc(7 + 3 * sizeof(int))) == NULL)
+    if (fd == -1)
         return NULL;
-    (void)snprintf(path, 7 + 3 * sizeof(int), "<fd:%d>", fd); /* for debugging */
+    (void)snprintf(path, 32, "<fd:%d>", fd); /* for debugging */
     gz = gz_open(path, fd, mode);
-    free(path);
     return gz;
 }
 
@@ -242,7 +302,7 @@ gzFile Z_EXPORT PREFIX(gzopen_w)(const wchar_t *path, const char *mode) {
 }
 #endif
 
-int Z_EXPORT PREFIX(gzclose)(gzFile file) {
+z_int32_t Z_EXPORT PREFIX(gzclose)(gzFile file) {
 #ifndef NO_GZCOMPRESS
     gz_state *state;
 
@@ -257,7 +317,7 @@ int Z_EXPORT PREFIX(gzclose)(gzFile file) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzbuffer)(gzFile file, unsigned size) {
+z_int32_t Z_EXPORT PREFIX(gzbuffer)(gzFile file, z_uint32_t size) {
     gz_state *state;
 
     /* get internal structure and check integrity */
@@ -281,7 +341,7 @@ int Z_EXPORT PREFIX(gzbuffer)(gzFile file, unsigned size) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzrewind)(gzFile file) {
+z_int32_t Z_EXPORT PREFIX(gzrewind)(gzFile file) {
     gz_state *state;
 
     /* get internal structure */
@@ -337,7 +397,7 @@ z_off64_t Z_EXPORT PREFIX4(gzseek)(gzFile file, z_off64_t offset, int whence) {
         state->eof = 0;
         state->past = 0;
         state->seek = 0;
-        gz_error(state, Z_OK, NULL);
+        PREFIX(gz_error)(state, Z_OK, NULL);
         state->strm.avail_in = 0;
         state->x.pos += offset;
         return state->x.pos;
@@ -439,7 +499,7 @@ z_off_t Z_EXPORT PREFIX(gzoffset)(gzFile file) {
 #endif
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzeof)(gzFile file) {
+z_int32_t Z_EXPORT PREFIX(gzeof)(gzFile file) {
     gz_state *state;
 
     /* get internal structure and check integrity */
@@ -454,7 +514,7 @@ int Z_EXPORT PREFIX(gzeof)(gzFile file) {
 }
 
 /* -- see zlib.h -- */
-const char * Z_EXPORT PREFIX(gzerror)(gzFile file, int *errnum) {
+const char * Z_EXPORT PREFIX(gzerror)(gzFile file, z_int32_t *errnum) {
     gz_state *state;
 
     /* get internal structure and check integrity */
@@ -486,7 +546,7 @@ void Z_EXPORT PREFIX(gzclearerr)(gzFile file) {
         state->eof = 0;
         state->past = 0;
     }
-    gz_error(state, Z_OK, NULL);
+    PREFIX(gz_error)(state, Z_OK, NULL);
 }
 
 /* Create an error message in allocated memory and set state->err and
@@ -495,7 +555,7 @@ void Z_EXPORT PREFIX(gzclearerr)(gzFile file) {
    memory).  Simply save the error message as a static string.  If there is an
    allocation failure constructing the error message, then convert the error to
    out of memory. */
-void Z_INTERNAL gz_error(gz_state *state, int err, const char *msg) {
+void Z_INTERNAL PREFIX(gz_error)(gz_state *state, int err, const char *msg) {
     /* free previously allocated message and clear */
     if (state->msg != NULL) {
         if (state->err != Z_MEM_ERROR)
diff --git a/gzread.c.in b/gzread.c
similarity index 89%
rename from gzread.c.in
rename to gzread.c
index 1fc7b370..3e321a03 100644
--- a/gzread.c.in
+++ b/gzread.c
@@ -6,8 +6,10 @@
 #include "zbuild.h"
 #include "zutil_p.h"
 #include "gzguts.h"
+#include "gzread_mangle.h"
 
 /* Local functions */
+static int gz_read_init(gz_state *state);
 static int gz_load(gz_state *, unsigned char *, unsigned, unsigned *);
 static int gz_avail(gz_state *);
 static int gz_look(gz_state *);
@@ -16,6 +18,27 @@ static int gz_fetch(gz_state *);
 static int gz_skip(gz_state *, z_off64_t);
 static size_t gz_read(gz_state *, void *, size_t);
 
+static int gz_read_init(gz_state *state) {
+    /* Allocate gz buffers */
+    if (gz_buffer_alloc(state) != 0) {
+        PREFIX(gz_error)(state, Z_MEM_ERROR, "out of memory");
+        return -1;
+    }
+
+    /* Initialize inflate state */
+    int ret = PREFIX(inflateInit2)(&(state->strm), MAX_WBITS + 16);
+    if (ret != Z_OK) {
+        gz_buffer_free(state);
+        if (ret == Z_MEM_ERROR) {
+            PREFIX(gz_error)(state, Z_MEM_ERROR, "out of memory");
+        } else {
+            PREFIX(gz_error)(state, Z_STREAM_ERROR, "invalid compression parameters");
+        }
+        return -1;
+    }
+    return 0;
+}
+
 /* Use read() to load a buffer -- return -1 on error, otherwise 0.  Read from
    state->fd, and update state->eof, state->err, and state->msg as appropriate.
    This function needs to loop on read(), since read() is not guaranteed to
@@ -31,7 +54,7 @@ static int gz_load(gz_state *state, unsigned char *buf, unsigned len, unsigned *
         *have += (unsigned)ret;
     } while (*have < len);
     if (ret < 0) {
-        gz_error(state, Z_ERRNO, zstrerror());
+        PREFIX(gz_error)(state, Z_ERRNO, zstrerror());
         return -1;
     }
     if (ret == 0)
@@ -81,33 +104,9 @@ static int gz_avail(gz_state *state) {
 static int gz_look(gz_state *state) {
     PREFIX3(stream) *strm = &(state->strm);
 
-    /* allocate read buffers and inflate memory */
-    if (state->size == 0) {
-        /* allocate buffers */
-        state->in = (unsigned char *)zng_alloc(state->want);
-        state->out = (unsigned char *)zng_alloc(state->want << 1);
-        if (state->in == NULL || state->out == NULL) {
-            zng_free(state->out);
-            zng_free(state->in);
-            gz_error(state, Z_MEM_ERROR, "out of memory");
-            return -1;
-        }
-        state->size = state->want;
-
-        /* allocate inflate memory */
-        state->strm.zalloc = NULL;
-        state->strm.zfree = NULL;
-        state->strm.opaque = NULL;
-        state->strm.avail_in = 0;
-        state->strm.next_in = NULL;
-        if (PREFIX(inflateInit2)(&(state->strm), MAX_WBITS + 16) != Z_OK) {    /* gunzip */
-            zng_free(state->out);
-            zng_free(state->in);
-            state->size = 0;
-            gz_error(state, Z_MEM_ERROR, "out of memory");
-            return -1;
-        }
-    }
+    /* allocate memory if this is the first time through */
+    if (state->size == 0 && gz_read_init(state) == -1)
+        return -1;
 
     /* get at least the magic bytes in the input buffer */
     if (strm->avail_in < 2) {
@@ -170,22 +169,22 @@ static int gz_decomp(gz_state *state) {
         if (strm->avail_in == 0 && gz_avail(state) == -1)
             return -1;
         if (strm->avail_in == 0) {
-            gz_error(state, Z_BUF_ERROR, "unexpected end of file");
+            PREFIX(gz_error)(state, Z_BUF_ERROR, "unexpected end of file");
             break;
         }
 
         /* decompress and handle errors */
         ret = PREFIX(inflate)(strm, Z_NO_FLUSH);
         if (ret == Z_STREAM_ERROR || ret == Z_NEED_DICT) {
-            gz_error(state, Z_STREAM_ERROR, "internal error: inflate stream corrupt");
+            PREFIX(gz_error)(state, Z_STREAM_ERROR, "internal error: inflate stream corrupt");
             return -1;
         }
         if (ret == Z_MEM_ERROR) {
-            gz_error(state, Z_MEM_ERROR, "out of memory");
+            PREFIX(gz_error)(state, Z_MEM_ERROR, "out of memory");
             return -1;
         }
         if (ret == Z_DATA_ERROR) {              /* deflate stream invalid */
-            gz_error(state, Z_DATA_ERROR, strm->msg == NULL ? "compressed data error" : strm->msg);
+            PREFIX(gz_error)(state, Z_DATA_ERROR, strm->msg == NULL ? "compressed data error" : strm->msg);
             return -1;
         }
     } while (strm->avail_out && ret != Z_STREAM_END);
@@ -210,6 +209,7 @@ static int gz_decomp(gz_state *state) {
    end of the input file has been reached and all data has been processed.  */
 static int gz_fetch(gz_state *state) {
     PREFIX3(stream) *strm = &(state->strm);
+    Assert(state->x.have == 0, "Invalid state->x.have");
 
     do {
         switch (state->how) {
@@ -230,6 +230,10 @@ static int gz_fetch(gz_state *state) {
             strm->next_out = state->out;
             if (gz_decomp(state) == -1)
                 return -1;
+            continue;
+        default:    // Can't happen
+            Z_UNREACHABLE();
+            return -1;
         }
     } while (state->x.have == 0 && (!state->eof || strm->avail_in));
     return 0;
@@ -342,7 +346,7 @@ static size_t gz_read(gz_state *state, void *buf, size_t len) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzread)(gzFile file, void *buf, unsigned len) {
+z_int32_t Z_EXPORT PREFIX(gzread)(gzFile file, void *buf, z_uint32_t len) {
     gz_state *state;
 
     /* get internal structure */
@@ -357,8 +361,8 @@ int Z_EXPORT PREFIX(gzread)(gzFile file, void *buf, unsigned len) {
 
     /* since an int is returned, make sure len fits in one, otherwise return
        with an error (this avoids a flaw in the interface) */
-    if ((int)len < 0) {
-        gz_error(state, Z_STREAM_ERROR, "request does not fit in an int");
+    if ((z_int32_t)len < 0) {
+        PREFIX(gz_error)(state, Z_STREAM_ERROR, "request does not fit in an int");
         return -1;
     }
 
@@ -370,7 +374,7 @@ int Z_EXPORT PREFIX(gzread)(gzFile file, void *buf, unsigned len) {
         return -1;
 
     /* return the number of bytes read (this is assured to fit in an int) */
-    return (int)len;
+    return (z_int32_t)len;
 }
 
 /* -- see zlib.h -- */
@@ -394,7 +398,7 @@ size_t Z_EXPORT PREFIX(gzfread)(void *buf, size_t size, size_t nitems, gzFile fi
 
     /* compute bytes to read -- error on overflow */
     if (size && SIZE_MAX / size < nitems) {
-        gz_error(state, Z_STREAM_ERROR, "request does not fit in a size_t");
+        PREFIX(gz_error)(state, Z_STREAM_ERROR, "request does not fit in a size_t");
         return 0;
     }
     len = nitems * size;
@@ -404,9 +408,7 @@ size_t Z_EXPORT PREFIX(gzfread)(void *buf, size_t size, size_t nitems, gzFile fi
 }
 
 /* -- see zlib.h -- */
-#undef @ZLIB_SYMBOL_PREFIX@gzgetc
-#undef @ZLIB_SYMBOL_PREFIX@zng_gzgetc
-int Z_EXPORT PREFIX(gzgetc)(gzFile file) {
+z_int32_t Z_EXPORT PREFIX(gzgetc)(gzFile file) {
     unsigned char buf[1];
     gz_state *state;
 
@@ -437,7 +439,7 @@ int Z_EXPORT PREFIX(gzgetc_)(gzFile file) {
 #endif
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzungetc)(int c, gzFile file) {
+z_int32_t Z_EXPORT PREFIX(gzungetc)(z_int32_t c, gzFile file) {
     gz_state *state;
 
     /* get internal structure */
@@ -476,7 +478,7 @@ int Z_EXPORT PREFIX(gzungetc)(int c, gzFile file) {
 
     /* if no room, give up (must have already done a gzungetc()) */
     if (state->x.have == (state->size << 1)) {
-        gz_error(state, Z_DATA_ERROR, "out of room to push characters");
+        PREFIX(gz_error)(state, Z_DATA_ERROR, "out of room to push characters");
         return -1;
     }
 
@@ -497,7 +499,7 @@ int Z_EXPORT PREFIX(gzungetc)(int c, gzFile file) {
 }
 
 /* -- see zlib.h -- */
-char * Z_EXPORT PREFIX(gzgets)(gzFile file, char *buf, int len) {
+char * Z_EXPORT PREFIX(gzgets)(gzFile file, char *buf, z_int32_t len) {
     unsigned left, n;
     char *str;
     unsigned char *eol;
@@ -558,7 +560,7 @@ char * Z_EXPORT PREFIX(gzgets)(gzFile file, char *buf, int len) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzdirect)(gzFile file) {
+z_int32_t Z_EXPORT PREFIX(gzdirect)(gzFile file) {
     gz_state *state;
 
     /* get internal structure */
@@ -577,7 +579,7 @@ int Z_EXPORT PREFIX(gzdirect)(gzFile file) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzclose_r)(gzFile file) {
+z_int32_t Z_EXPORT PREFIX(gzclose_r)(gzFile file) {
     int ret, err;
     gz_state *state;
 
@@ -594,11 +596,10 @@ int Z_EXPORT PREFIX(gzclose_r)(gzFile file) {
     /* free memory and close file */
     if (state->size) {
         PREFIX(inflateEnd)(&(state->strm));
-        zng_free(state->out);
-        zng_free(state->in);
+        gz_buffer_free(state);
     }
     err = state->err == Z_BUF_ERROR ? Z_BUF_ERROR : Z_OK;
-    gz_error(state, Z_OK, NULL);
+    PREFIX(gz_error)(state, Z_OK, NULL);
     free(state->path);
     ret = close(state->fd);
     zng_free(state);
diff --git a/gzread_mangle.h.in b/gzread_mangle.h.in
new file mode 100644
index 00000000..bd4c2b13
--- /dev/null
+++ b/gzread_mangle.h.in
@@ -0,0 +1,7 @@
+/* gzread_mangle.h.in -- gzgetc name mangling helper
+ * This file undefines the macro from zlib.h/zlib-ng.h to allow the real
+ * function to be defined in gzread.c. This is tricky because the prefix
+ * is not known ahead of time, thus the need for sed or similar.
+ */
+#undef @ZLIB_SYMBOL_PREFIX@gzgetc
+#undef @ZLIB_SYMBOL_PREFIX@zng_gzgetc
diff --git a/gzwrite.c b/gzwrite.c
index 08e0ce9a..5d1fdd77 100644
--- a/gzwrite.c
+++ b/gzwrite.c
@@ -9,7 +9,7 @@
 #include "gzguts.h"
 
 /* Local functions */
-static int gz_init(gz_state *);
+static int gz_write_init(gz_state *);
 static int gz_comp(gz_state *, int);
 static int gz_zero(gz_state *, z_off64_t);
 static size_t gz_write(gz_state *, void const *, size_t);
@@ -17,47 +17,31 @@ static size_t gz_write(gz_state *, void const *, size_t);
 /* Initialize state for writing a gzip file.  Mark initialization by setting
    state->size to non-zero.  Return -1 on a memory allocation failure, or 0 on
    success. */
-static int gz_init(gz_state *state) {
-    int ret;
+static int gz_write_init(gz_state *state) {
     PREFIX3(stream) *strm = &(state->strm);
 
-    /* allocate input buffer (double size for gzprintf) */
-    state->in = (unsigned char *)zng_alloc(state->want << 1);
-    if (state->in == NULL) {
-        gz_error(state, Z_MEM_ERROR, "out of memory");
+    /* Allocate gz buffers */
+    if (gz_buffer_alloc(state) != 0) {
+        PREFIX(gz_error)(state, Z_MEM_ERROR, "out of memory");
         return -1;
     }
-    memset(state->in, 0, state->want << 1);
 
-    /* only need output buffer and deflate state if compressing */
+    /* only need deflate state if compressing */
     if (!state->direct) {
-        /* allocate output buffer */
-        state->out = (unsigned char *)zng_alloc(state->want);
-        if (state->out == NULL) {
-            zng_free(state->in);
-            gz_error(state, Z_MEM_ERROR, "out of memory");
-            return -1;
-        }
-
         /* allocate deflate memory, set up for gzip compression */
-        strm->zalloc = NULL;
-        strm->zfree = NULL;
-        strm->opaque = NULL;
-        ret = PREFIX(deflateInit2)(strm, state->level, Z_DEFLATED, MAX_WBITS + 16, DEF_MEM_LEVEL, state->strategy);
+        int ret = PREFIX(deflateInit2)(strm, state->level, Z_DEFLATED, MAX_WBITS + 16, DEF_MEM_LEVEL, state->strategy);
         if (ret != Z_OK) {
-            zng_free(state->out);
-            zng_free(state->in);
-            gz_error(state, Z_MEM_ERROR, "out of memory");
+            gz_buffer_free(state);
+            if (ret == Z_MEM_ERROR) {
+                PREFIX(gz_error)(state, Z_MEM_ERROR, "out of memory");
+            } else {
+                PREFIX(gz_error)(state, Z_STREAM_ERROR, "invalid compression parameters");
+            }
             return -1;
         }
         strm->next_in = NULL;
-    }
 
-    /* mark state as initialized */
-    state->size = state->want;
-
-    /* initialize write buffer if compressing */
-    if (!state->direct) {
+        /* initialize write buffer */
         strm->avail_out = state->size;
         strm->next_out = state->out;
         state->x.next = strm->next_out;
@@ -66,7 +50,7 @@ static int gz_init(gz_state *state) {
 }
 
 /* Compress whatever is at avail_in and next_in and write to the output file.
-   Return -1 if there is an error writing to the output file or if gz_init()
+   Return -1 if there is an error writing to the output file or if gz_write_init()
    fails to allocate memory, otherwise 0.  flush is assumed to be a valid
    deflate() flush value.  If flush is Z_FINISH, then the deflate() state is
    reset to start a new gzip stream.  If gz->direct is true, then simply write
@@ -78,14 +62,14 @@ static int gz_comp(gz_state *state, int flush) {
     PREFIX3(stream) *strm = &(state->strm);
 
     /* allocate memory if this is the first time through */
-    if (state->size == 0 && gz_init(state) == -1)
+    if (state->size == 0 && gz_write_init(state) == -1)
         return -1;
 
     /* write directly if requested */
     if (state->direct) {
         got = write(state->fd, strm->next_in, strm->avail_in);
         if (got < 0 || (unsigned)got != strm->avail_in) {
-            gz_error(state, Z_ERRNO, zstrerror());
+            PREFIX(gz_error)(state, Z_ERRNO, zstrerror());
             return -1;
         }
         strm->avail_in = 0;
@@ -109,7 +93,7 @@ static int gz_comp(gz_state *state, int flush) {
         if (strm->avail_out == 0 || (flush != Z_NO_FLUSH && (flush != Z_FINISH || ret == Z_STREAM_END))) {
             have = (unsigned)(strm->next_out - state->x.next);
             if (have && ((got = write(state->fd, state->x.next, (unsigned long)have)) < 0 || (unsigned)got != have)) {
-                gz_error(state, Z_ERRNO, zstrerror());
+                PREFIX(gz_error)(state, Z_ERRNO, zstrerror());
                 return -1;
             }
             if (strm->avail_out == 0) {
@@ -124,7 +108,7 @@ static int gz_comp(gz_state *state, int flush) {
         have = strm->avail_out;
         ret = PREFIX(deflate)(strm, flush);
         if (ret == Z_STREAM_ERROR) {
-            gz_error(state, Z_STREAM_ERROR, "internal error: deflate stream corrupt");
+            PREFIX(gz_error)(state, Z_STREAM_ERROR, "internal error: deflate stream corrupt");
             return -1;
         }
         have -= strm->avail_out;
@@ -176,7 +160,7 @@ static size_t gz_write(gz_state *state, void const *buf, size_t len) {
         return 0;
 
     /* allocate memory if this is the first time through */
-    if (state->size == 0 && gz_init(state) == -1)
+    if (state->size == 0 && gz_write_init(state) == -1)
         return 0;
 
     /* check for seek request */
@@ -231,7 +215,7 @@ static size_t gz_write(gz_state *state, void const *buf, size_t len) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzwrite)(gzFile file, void const *buf, unsigned len) {
+z_int32_t Z_EXPORT PREFIX(gzwrite)(gzFile file, void const *buf, z_uint32_t len) {
     gz_state *state;
 
     /* get internal structure */
@@ -245,13 +229,13 @@ int Z_EXPORT PREFIX(gzwrite)(gzFile file, void const *buf, unsigned len) {
 
     /* since an int is returned, make sure len fits in one, otherwise return
        with an error (this avoids a flaw in the interface) */
-    if ((int)len < 0) {
-        gz_error(state, Z_DATA_ERROR, "requested length does not fit in int");
+    if ((z_int32_t)len < 0) {
+        PREFIX(gz_error)(state, Z_DATA_ERROR, "requested length does not fit in int");
         return 0;
     }
 
     /* write len bytes from buf (the return value will fit in an int) */
-    return (int)gz_write(state, buf, len);
+    return (z_int32_t)gz_write(state, buf, len);
 }
 
 /* -- see zlib.h -- */
@@ -275,7 +259,7 @@ size_t Z_EXPORT PREFIX(gzfwrite)(void const *buf, size_t size, size_t nitems, gz
     /* compute bytes to read -- error on overflow */
     len = nitems * size;
     if (len / size != nitems) {
-        gz_error(state, Z_STREAM_ERROR, "request does not fit in a size_t");
+        PREFIX(gz_error)(state, Z_STREAM_ERROR, "request does not fit in a size_t");
         return 0;
     }
 
@@ -284,7 +268,7 @@ size_t Z_EXPORT PREFIX(gzfwrite)(void const *buf, size_t size, size_t nitems, gz
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzputc)(gzFile file, int c) {
+z_int32_t Z_EXPORT PREFIX(gzputc)(gzFile file, z_int32_t c) {
     unsigned have;
     unsigned char buf[1];
     gz_state *state;
@@ -329,7 +313,7 @@ int Z_EXPORT PREFIX(gzputc)(gzFile file, int c) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzputs)(gzFile file, const char *s) {
+z_int32_t Z_EXPORT PREFIX(gzputs)(gzFile file, const char *s) {
     size_t len, put;
     gz_state *state;
 
@@ -345,7 +329,7 @@ int Z_EXPORT PREFIX(gzputs)(gzFile file, const char *s) {
     /* write string */
     len = strlen(s);
     if ((int)len < 0 || (unsigned)len != len) {
-        gz_error(state, Z_STREAM_ERROR, "string length does not fit in int");
+        PREFIX(gz_error)(state, Z_STREAM_ERROR, "string length does not fit in int");
         return -1;
     }
     put = gz_write(state, s, len);
@@ -353,7 +337,7 @@ int Z_EXPORT PREFIX(gzputs)(gzFile file, const char *s) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORTVA PREFIX(gzvprintf)(gzFile file, const char *format, va_list va) {
+z_int32_t Z_EXPORTVA PREFIX(gzvprintf)(gzFile file, const char *format, va_list va) {
     int len;
     unsigned left;
     char *next;
@@ -371,7 +355,7 @@ int Z_EXPORTVA PREFIX(gzvprintf)(gzFile file, const char *format, va_list va) {
         return Z_STREAM_ERROR;
 
     /* make sure we have some buffer space */
-    if (state->size == 0 && gz_init(state) == -1)
+    if (state->size == 0 && gz_write_init(state) == -1)
         return state->err;
 
     /* check for seek request */
@@ -409,7 +393,7 @@ int Z_EXPORTVA PREFIX(gzvprintf)(gzFile file, const char *format, va_list va) {
     return len;
 }
 
-int Z_EXPORTVA PREFIX(gzprintf)(gzFile file, const char *format, ...) {
+z_int32_t Z_EXPORTVA PREFIX(gzprintf)(gzFile file, const char *format, ...) {
     va_list va;
     int ret;
 
@@ -420,7 +404,7 @@ int Z_EXPORTVA PREFIX(gzprintf)(gzFile file, const char *format, ...) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzflush)(gzFile file, int flush) {
+z_int32_t Z_EXPORT PREFIX(gzflush)(gzFile file, z_int32_t flush) {
     gz_state *state;
 
     /* get internal structure */
@@ -449,7 +433,7 @@ int Z_EXPORT PREFIX(gzflush)(gzFile file, int flush) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzsetparams)(gzFile file, int level, int strategy) {
+z_int32_t Z_EXPORT PREFIX(gzsetparams)(gzFile file, z_int32_t level, z_int32_t strategy) {
     gz_state *state;
     PREFIX3(stream) *strm;
 
@@ -487,7 +471,7 @@ int Z_EXPORT PREFIX(gzsetparams)(gzFile file, int level, int strategy) {
 }
 
 /* -- see zlib.h -- */
-int Z_EXPORT PREFIX(gzclose_w)(gzFile file) {
+z_int32_t Z_EXPORT PREFIX(gzclose_w)(gzFile file) {
     int ret = Z_OK;
     gz_state *state;
 
@@ -513,14 +497,13 @@ int Z_EXPORT PREFIX(gzclose_w)(gzFile file) {
     if (state->size) {
         if (!state->direct) {
             (void)PREFIX(deflateEnd)(&(state->strm));
-            zng_free(state->out);
         }
-        zng_free(state->in);
+        gz_buffer_free(state);
     }
-    gz_error(state, Z_OK, NULL);
+    PREFIX(gz_error)(state, Z_OK, NULL);
     free(state->path);
     if (close(state->fd) == -1)
         ret = Z_ERRNO;
-    zng_free(state);
+    gz_state_free(state);
     return ret;
 }
diff --git a/infback.c b/infback.c
index 307d05ca..b3b6d86d 100644
--- a/infback.c
+++ b/infback.c
@@ -53,14 +53,18 @@ int32_t ZNG_CONDEXPORT PREFIX(inflateBackInit)(PREFIX3(stream) *strm, int32_t wi
     Tracev((stderr, "inflate: allocated\n"));
 
     strm->state = (struct internal_state *)state;
-    state->dmax = 32768U;
     state->wbits = (unsigned int)windowBits;
     state->wsize = 1U << windowBits;
+    state->wbufsize = 1U << windowBits;
     state->window = window;
     state->wnext = 0;
     state->whave = 0;
+#ifdef INFLATE_STRICT
+    state->dmax = 32768U;
+#endif
+#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
     state->sane = 1;
-    state->chunksize = FUNCTABLE_CALL(chunksize)();
+#endif
     return Z_OK;
 }
 
@@ -97,7 +101,7 @@ int32_t Z_EXPORT PREFIX(inflateBackInit_)(PREFIX3(stream) *strm, int32_t windowB
     do { \
         PULL(); \
         have--; \
-        hold += ((unsigned)(*next++) << bits); \
+        hold += ((uint64_t)(*next++) << bits); \
         bits += 8; \
     } while (0)
 
@@ -149,8 +153,8 @@ int32_t Z_EXPORT PREFIX(inflateBack)(PREFIX3(stream) *strm, in_func in, void *in
     z_const unsigned char *next; /* next input */
     unsigned char *put;          /* next output */
     unsigned have, left;         /* available input and output */
-    uint32_t hold;               /* bit buffer */
-    unsigned bits;               /* bits in bit buffer */
+    uint64_t hold;               /* bit buffer */
+    bits_t bits;                 /* bits in bit buffer */
     unsigned copy;               /* number of stored or match bytes to copy */
     unsigned char *from;         /* where to copy match bytes from */
     code here;                   /* current decoding table entry */
diff --git a/inffast_tpl.h b/inffast_tpl.h
index 9ddd187d..4b1447cb 100644
--- a/inffast_tpl.h
+++ b/inffast_tpl.h
@@ -59,13 +59,10 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
     unsigned char *beg;         /* inflate()'s initial strm->next_out */
     unsigned char *end;         /* while out < end, enough space available */
     unsigned char *safe;        /* can use chunkcopy provided out < safe */
-#ifdef INFLATE_STRICT
-    unsigned dmax;              /* maximum distance from zlib header */
-#endif
+    unsigned char *window;      /* allocated sliding window, if wsize != 0 */
     unsigned wsize;             /* window size or zero if not using window */
     unsigned whave;             /* valid bytes in the window */
     unsigned wnext;             /* window write index */
-    unsigned char *window;      /* allocated sliding window, if wsize != 0 */
 
     /* hold is a local copy of strm->hold. By default, hold satisfies the same
        invariants that strm->hold does, namely that (hold >> bits) == 0. This
@@ -104,18 +101,18 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
        with (1<<bits)-1 to drop those excess bits so that, on function exit, we
        keep the invariant that (state->hold >> state->bits) == 0.
     */
+    bits_t bits;                /* local strm->bits */
     uint64_t hold;              /* local strm->hold */
-    unsigned bits;              /* local strm->bits */
-    code const *lcode;          /* local strm->lencode */
-    code const *dcode;          /* local strm->distcode */
     unsigned lmask;             /* mask for first level of length codes */
     unsigned dmask;             /* mask for first level of distance codes */
-    const code *here;           /* retrieved table entry */
+    code const *lcode;          /* local strm->lencode */
+    code const *dcode;          /* local strm->distcode */
+    code here;                  /* retrieved table entry */
     unsigned op;                /* code bits, operation, extra bits, or */
                                 /*  window position, window bytes to copy */
     unsigned len;               /* match length, unused bytes */
-    unsigned dist;              /* match distance */
     unsigned char *from;        /* where to copy match from */
+    unsigned dist;              /* match distance */
     unsigned extra_safe;        /* copy chunks safely in all cases */
 
     /* copy state to local variables */
@@ -126,15 +123,12 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
     beg = out - (start - strm->avail_out);
     end = out + (strm->avail_out - (INFLATE_FAST_MIN_LEFT - 1));
     safe = out + strm->avail_out;
-#ifdef INFLATE_STRICT
-    dmax = state->dmax;
-#endif
     wsize = state->wsize;
     whave = state->whave;
     wnext = state->wnext;
     window = state->window;
     hold = state->hold;
-    bits = state->bits;
+    bits = (bits_t)state->bits;
     lcode = state->lencode;
     dcode = state->distcode;
     lmask = (1U << state->lenbits) - 1;
@@ -143,12 +137,11 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
     /* Detect if out and window point to the same memory allocation. In this instance it is
        necessary to use safe chunk copy functions to prevent overwriting the window. If the
        window is overwritten then future matches with far distances will fail to copy correctly. */
-    extra_safe = (wsize != 0 && out >= window && out + INFLATE_FAST_MIN_LEFT <= window + wsize);
+    extra_safe = (wsize != 0 && out >= window && out + INFLATE_FAST_MIN_LEFT <= window + state->wbufsize);
 
 #define REFILL() do { \
         hold |= load_64_bits(in, bits); \
-        in += 7; \
-        in -= ((bits >> 3) & 7); \
+        in += (63 ^ bits) >> 3; \
         bits |= 56; \
     } while (0)
 
@@ -156,44 +149,48 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
        input data or output space */
     do {
         REFILL();
-        here = lcode + (hold & lmask);
-        if (here->op == 0) {
-            *out++ = (unsigned char)(here->val);
-            DROPBITS(here->bits);
-            here = lcode + (hold & lmask);
-            if (here->op == 0) {
-                *out++ = (unsigned char)(here->val);
-                DROPBITS(here->bits);
-                here = lcode + (hold & lmask);
+        here = lcode[hold & lmask];
+        Z_TOUCH(here);
+        DROPBITS(here.bits);
+        if (here.op == 0) {
+            *out++ = (unsigned char)(here.val);
+            here = lcode[hold & lmask];
+            Z_TOUCH(here);
+            DROPBITS(here.bits);
+            if (here.op == 0) {
+                *out++ = (unsigned char)(here.val);
+                here = lcode[hold & lmask];
+                Z_TOUCH(here);
+                DROPBITS(here.bits);
             }
         }
       dolen:
-        DROPBITS(here->bits);
-        op = here->op;
+        op = here.op;
         if (op == 0) {                          /* literal */
-            Tracevv((stderr, here->val >= 0x20 && here->val < 0x7f ?
+            Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?
                     "inflate:         literal '%c'\n" :
-                    "inflate:         literal 0x%02x\n", here->val));
-            *out++ = (unsigned char)(here->val);
+                    "inflate:         literal 0x%02x\n", here.val));
+            *out++ = (unsigned char)(here.val);
         } else if (op & 16) {                     /* length base */
-            len = here->val;
+            len = here.val;
             op &= MAX_BITS;                       /* number of extra bits */
             len += BITS(op);
             DROPBITS(op);
             Tracevv((stderr, "inflate:         length %u\n", len));
-            here = dcode + (hold & dmask);
+            here = dcode[hold & dmask];
+            Z_TOUCH(here);
             if (bits < MAX_BITS + MAX_DIST_EXTRA_BITS) {
                 REFILL();
             }
           dodist:
-            DROPBITS(here->bits);
-            op = here->op;
+            DROPBITS(here.bits);
+            op = here.op;
             if (op & 16) {                      /* distance base */
-                dist = here->val;
+                dist = here.val;
                 op &= MAX_BITS;                 /* number of extra bits */
                 dist += BITS(op);
 #ifdef INFLATE_STRICT
-                if (dist > dmax) {
+                if (dist > state->dmax) {
                     SET_BAD("invalid distance too far back");
                     break;
                 }
@@ -204,11 +201,11 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
                 if (dist > op) {                /* see if copy from window */
                     op = dist - op;             /* distance back in window */
                     if (op > whave) {
+#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
                         if (state->sane) {
                             SET_BAD("invalid distance too far back");
                             break;
                         }
-#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
                         if (len <= op - whave) {
                             do {
                                 *out++ = 0;
@@ -226,6 +223,9 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
                             } while (--len);
                             continue;
                         }
+#else
+                        SET_BAD("invalid distance too far back");
+                        break;
 #endif
                     }
                     from = window;
@@ -238,7 +238,7 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
                         from += wsize - op;
                         if (op < len) {         /* some from end of window */
                             len -= op;
-                            out = chunkcopy_safe(out, from, op, safe);
+                            out = CHUNKCOPY_SAFE(out, from, op, safe);
                             from = window;      /* more from start of window */
                             op = wnext;
                             /* This (rare) case can create a situation where
@@ -248,38 +248,50 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
                     }
                     if (op < len) {             /* still need some from output */
                         len -= op;
-                        out = chunkcopy_safe(out, from, op, safe);
-                        out = CHUNKUNROLL(out, &dist, &len);
-                        out = chunkcopy_safe(out, out - dist, len, safe);
+                        if (!extra_safe) {
+                            out = CHUNKCOPY_SAFE(out, from, op, safe);
+                            out = CHUNKUNROLL(out, &dist, &len);
+                            out = CHUNKCOPY_SAFE(out, out - dist, len, safe);
+                        } else {
+                            out = chunkcopy_safe(out, from, op, safe);
+                            out = chunkcopy_safe(out, out - dist, len, safe);
+                        }
                     } else {
-                        out = chunkcopy_safe(out, from, len, safe);
+#ifndef HAVE_MASKED_READWRITE
+                        if (extra_safe)
+                            out = chunkcopy_safe(out, from, len, safe);
+                        else
+#endif
+                            out = CHUNKCOPY_SAFE(out, from, len, safe);
                     }
+#ifndef HAVE_MASKED_READWRITE
                 } else if (extra_safe) {
                     /* Whole reference is in range of current output. */
-                    if (dist >= len || dist >= state->chunksize)
                         out = chunkcopy_safe(out, out - dist, len, safe);
-                    else
-                        out = CHUNKMEMSET_SAFE(out, dist, len, (unsigned)((safe - out) + 1));
+#endif
                 } else {
                     /* Whole reference is in range of current output.  No range checks are
                        necessary because we start with room for at least 258 bytes of output,
                        so unroll and roundoff operations can write beyond `out+len` so long
                        as they stay within 258 bytes of `out`.
                     */
-                    if (dist >= len || dist >= state->chunksize)
+                    if (dist >= len || dist >= CHUNKSIZE())
                         out = CHUNKCOPY(out, out - dist, len);
                     else
-                        out = CHUNKMEMSET(out, dist, len);
+                        out = CHUNKMEMSET(out, out - dist, len);
                 }
             } else if ((op & 64) == 0) {          /* 2nd level distance code */
-                here = dcode + here->val + BITS(op);
+                here = dcode[here.val + BITS(op)];
+                Z_TOUCH(here);
                 goto dodist;
             } else {
                 SET_BAD("invalid distance code");
                 break;
             }
         } else if ((op & 64) == 0) {              /* 2nd level length code */
-            here = lcode + here->val + BITS(op);
+            here = lcode[here.val + BITS(op)];
+            Z_TOUCH(here);
+            DROPBITS(here.bits);
             goto dolen;
         } else if (op & 32) {                     /* end-of-block */
             Tracevv((stderr, "inflate:         end of block\n"));
@@ -294,7 +306,7 @@ void Z_INTERNAL INFLATE_FAST(PREFIX3(stream) *strm, uint32_t start) {
     /* return unused bytes (on entry, bits < 8, so in won't go too far back) */
     len = bits >> 3;
     in -= len;
-    bits -= len << 3;
+    bits -= (bits_t)(len << 3);
     hold &= (UINT64_C(1) << bits) - 1;
 
     /* update state and return */
diff --git a/inffixed_tbl.h b/inffixed_tbl.h
index 7292fa06..02b4ee68 100644
--- a/inffixed_tbl.h
+++ b/inffixed_tbl.h
@@ -8,87 +8,87 @@
  */
 
 static const code lenfix[512] = {
-    {96,7,0},{0,8,80},{0,8,16},{20,8,115},{18,7,31},{0,8,112},{0,8,48},
-    {0,9,192},{16,7,10},{0,8,96},{0,8,32},{0,9,160},{0,8,0},{0,8,128},
-    {0,8,64},{0,9,224},{16,7,6},{0,8,88},{0,8,24},{0,9,144},{19,7,59},
-    {0,8,120},{0,8,56},{0,9,208},{17,7,17},{0,8,104},{0,8,40},{0,9,176},
-    {0,8,8},{0,8,136},{0,8,72},{0,9,240},{16,7,4},{0,8,84},{0,8,20},
-    {21,8,227},{19,7,43},{0,8,116},{0,8,52},{0,9,200},{17,7,13},{0,8,100},
-    {0,8,36},{0,9,168},{0,8,4},{0,8,132},{0,8,68},{0,9,232},{16,7,8},
-    {0,8,92},{0,8,28},{0,9,152},{20,7,83},{0,8,124},{0,8,60},{0,9,216},
-    {18,7,23},{0,8,108},{0,8,44},{0,9,184},{0,8,12},{0,8,140},{0,8,76},
-    {0,9,248},{16,7,3},{0,8,82},{0,8,18},{21,8,163},{19,7,35},{0,8,114},
-    {0,8,50},{0,9,196},{17,7,11},{0,8,98},{0,8,34},{0,9,164},{0,8,2},
-    {0,8,130},{0,8,66},{0,9,228},{16,7,7},{0,8,90},{0,8,26},{0,9,148},
-    {20,7,67},{0,8,122},{0,8,58},{0,9,212},{18,7,19},{0,8,106},{0,8,42},
-    {0,9,180},{0,8,10},{0,8,138},{0,8,74},{0,9,244},{16,7,5},{0,8,86},
-    {0,8,22},{64,8,0},{19,7,51},{0,8,118},{0,8,54},{0,9,204},{17,7,15},
-    {0,8,102},{0,8,38},{0,9,172},{0,8,6},{0,8,134},{0,8,70},{0,9,236},
-    {16,7,9},{0,8,94},{0,8,30},{0,9,156},{20,7,99},{0,8,126},{0,8,62},
-    {0,9,220},{18,7,27},{0,8,110},{0,8,46},{0,9,188},{0,8,14},{0,8,142},
-    {0,8,78},{0,9,252},{96,7,0},{0,8,81},{0,8,17},{21,8,131},{18,7,31},
-    {0,8,113},{0,8,49},{0,9,194},{16,7,10},{0,8,97},{0,8,33},{0,9,162},
-    {0,8,1},{0,8,129},{0,8,65},{0,9,226},{16,7,6},{0,8,89},{0,8,25},
-    {0,9,146},{19,7,59},{0,8,121},{0,8,57},{0,9,210},{17,7,17},{0,8,105},
-    {0,8,41},{0,9,178},{0,8,9},{0,8,137},{0,8,73},{0,9,242},{16,7,4},
-    {0,8,85},{0,8,21},{16,8,258},{19,7,43},{0,8,117},{0,8,53},{0,9,202},
-    {17,7,13},{0,8,101},{0,8,37},{0,9,170},{0,8,5},{0,8,133},{0,8,69},
-    {0,9,234},{16,7,8},{0,8,93},{0,8,29},{0,9,154},{20,7,83},{0,8,125},
-    {0,8,61},{0,9,218},{18,7,23},{0,8,109},{0,8,45},{0,9,186},{0,8,13},
-    {0,8,141},{0,8,77},{0,9,250},{16,7,3},{0,8,83},{0,8,19},{21,8,195},
-    {19,7,35},{0,8,115},{0,8,51},{0,9,198},{17,7,11},{0,8,99},{0,8,35},
-    {0,9,166},{0,8,3},{0,8,131},{0,8,67},{0,9,230},{16,7,7},{0,8,91},
-    {0,8,27},{0,9,150},{20,7,67},{0,8,123},{0,8,59},{0,9,214},{18,7,19},
-    {0,8,107},{0,8,43},{0,9,182},{0,8,11},{0,8,139},{0,8,75},{0,9,246},
-    {16,7,5},{0,8,87},{0,8,23},{64,8,0},{19,7,51},{0,8,119},{0,8,55},
-    {0,9,206},{17,7,15},{0,8,103},{0,8,39},{0,9,174},{0,8,7},{0,8,135},
-    {0,8,71},{0,9,238},{16,7,9},{0,8,95},{0,8,31},{0,9,158},{20,7,99},
-    {0,8,127},{0,8,63},{0,9,222},{18,7,27},{0,8,111},{0,8,47},{0,9,190},
-    {0,8,15},{0,8,143},{0,8,79},{0,9,254},{96,7,0},{0,8,80},{0,8,16},
-    {20,8,115},{18,7,31},{0,8,112},{0,8,48},{0,9,193},{16,7,10},{0,8,96},
-    {0,8,32},{0,9,161},{0,8,0},{0,8,128},{0,8,64},{0,9,225},{16,7,6},
-    {0,8,88},{0,8,24},{0,9,145},{19,7,59},{0,8,120},{0,8,56},{0,9,209},
-    {17,7,17},{0,8,104},{0,8,40},{0,9,177},{0,8,8},{0,8,136},{0,8,72},
-    {0,9,241},{16,7,4},{0,8,84},{0,8,20},{21,8,227},{19,7,43},{0,8,116},
-    {0,8,52},{0,9,201},{17,7,13},{0,8,100},{0,8,36},{0,9,169},{0,8,4},
-    {0,8,132},{0,8,68},{0,9,233},{16,7,8},{0,8,92},{0,8,28},{0,9,153},
-    {20,7,83},{0,8,124},{0,8,60},{0,9,217},{18,7,23},{0,8,108},{0,8,44},
-    {0,9,185},{0,8,12},{0,8,140},{0,8,76},{0,9,249},{16,7,3},{0,8,82},
-    {0,8,18},{21,8,163},{19,7,35},{0,8,114},{0,8,50},{0,9,197},{17,7,11},
-    {0,8,98},{0,8,34},{0,9,165},{0,8,2},{0,8,130},{0,8,66},{0,9,229},
-    {16,7,7},{0,8,90},{0,8,26},{0,9,149},{20,7,67},{0,8,122},{0,8,58},
-    {0,9,213},{18,7,19},{0,8,106},{0,8,42},{0,9,181},{0,8,10},{0,8,138},
-    {0,8,74},{0,9,245},{16,7,5},{0,8,86},{0,8,22},{64,8,0},{19,7,51},
-    {0,8,118},{0,8,54},{0,9,205},{17,7,15},{0,8,102},{0,8,38},{0,9,173},
-    {0,8,6},{0,8,134},{0,8,70},{0,9,237},{16,7,9},{0,8,94},{0,8,30},
-    {0,9,157},{20,7,99},{0,8,126},{0,8,62},{0,9,221},{18,7,27},{0,8,110},
-    {0,8,46},{0,9,189},{0,8,14},{0,8,142},{0,8,78},{0,9,253},{96,7,0},
-    {0,8,81},{0,8,17},{21,8,131},{18,7,31},{0,8,113},{0,8,49},{0,9,195},
-    {16,7,10},{0,8,97},{0,8,33},{0,9,163},{0,8,1},{0,8,129},{0,8,65},
-    {0,9,227},{16,7,6},{0,8,89},{0,8,25},{0,9,147},{19,7,59},{0,8,121},
-    {0,8,57},{0,9,211},{17,7,17},{0,8,105},{0,8,41},{0,9,179},{0,8,9},
-    {0,8,137},{0,8,73},{0,9,243},{16,7,4},{0,8,85},{0,8,21},{16,8,258},
-    {19,7,43},{0,8,117},{0,8,53},{0,9,203},{17,7,13},{0,8,101},{0,8,37},
-    {0,9,171},{0,8,5},{0,8,133},{0,8,69},{0,9,235},{16,7,8},{0,8,93},
-    {0,8,29},{0,9,155},{20,7,83},{0,8,125},{0,8,61},{0,9,219},{18,7,23},
-    {0,8,109},{0,8,45},{0,9,187},{0,8,13},{0,8,141},{0,8,77},{0,9,251},
-    {16,7,3},{0,8,83},{0,8,19},{21,8,195},{19,7,35},{0,8,115},{0,8,51},
-    {0,9,199},{17,7,11},{0,8,99},{0,8,35},{0,9,167},{0,8,3},{0,8,131},
-    {0,8,67},{0,9,231},{16,7,7},{0,8,91},{0,8,27},{0,9,151},{20,7,67},
-    {0,8,123},{0,8,59},{0,9,215},{18,7,19},{0,8,107},{0,8,43},{0,9,183},
-    {0,8,11},{0,8,139},{0,8,75},{0,9,247},{16,7,5},{0,8,87},{0,8,23},
-    {64,8,0},{19,7,51},{0,8,119},{0,8,55},{0,9,207},{17,7,15},{0,8,103},
-    {0,8,39},{0,9,175},{0,8,7},{0,8,135},{0,8,71},{0,9,239},{16,7,9},
-    {0,8,95},{0,8,31},{0,9,159},{20,7,99},{0,8,127},{0,8,63},{0,9,223},
-    {18,7,27},{0,8,111},{0,8,47},{0,9,191},{0,8,15},{0,8,143},{0,8,79},
-    {0,9,255}
+    {7,96,0},{8,0,80},{8,0,16},{8,20,115},{7,18,31},{8,0,112},{8,0,48},
+    {9,0,192},{7,16,10},{8,0,96},{8,0,32},{9,0,160},{8,0,0},{8,0,128},
+    {8,0,64},{9,0,224},{7,16,6},{8,0,88},{8,0,24},{9,0,144},{7,19,59},
+    {8,0,120},{8,0,56},{9,0,208},{7,17,17},{8,0,104},{8,0,40},{9,0,176},
+    {8,0,8},{8,0,136},{8,0,72},{9,0,240},{7,16,4},{8,0,84},{8,0,20},
+    {8,21,227},{7,19,43},{8,0,116},{8,0,52},{9,0,200},{7,17,13},{8,0,100},
+    {8,0,36},{9,0,168},{8,0,4},{8,0,132},{8,0,68},{9,0,232},{7,16,8},
+    {8,0,92},{8,0,28},{9,0,152},{7,20,83},{8,0,124},{8,0,60},{9,0,216},
+    {7,18,23},{8,0,108},{8,0,44},{9,0,184},{8,0,12},{8,0,140},{8,0,76},
+    {9,0,248},{7,16,3},{8,0,82},{8,0,18},{8,21,163},{7,19,35},{8,0,114},
+    {8,0,50},{9,0,196},{7,17,11},{8,0,98},{8,0,34},{9,0,164},{8,0,2},
+    {8,0,130},{8,0,66},{9,0,228},{7,16,7},{8,0,90},{8,0,26},{9,0,148},
+    {7,20,67},{8,0,122},{8,0,58},{9,0,212},{7,18,19},{8,0,106},{8,0,42},
+    {9,0,180},{8,0,10},{8,0,138},{8,0,74},{9,0,244},{7,16,5},{8,0,86},
+    {8,0,22},{8,64,0},{7,19,51},{8,0,118},{8,0,54},{9,0,204},{7,17,15},
+    {8,0,102},{8,0,38},{9,0,172},{8,0,6},{8,0,134},{8,0,70},{9,0,236},
+    {7,16,9},{8,0,94},{8,0,30},{9,0,156},{7,20,99},{8,0,126},{8,0,62},
+    {9,0,220},{7,18,27},{8,0,110},{8,0,46},{9,0,188},{8,0,14},{8,0,142},
+    {8,0,78},{9,0,252},{7,96,0},{8,0,81},{8,0,17},{8,21,131},{7,18,31},
+    {8,0,113},{8,0,49},{9,0,194},{7,16,10},{8,0,97},{8,0,33},{9,0,162},
+    {8,0,1},{8,0,129},{8,0,65},{9,0,226},{7,16,6},{8,0,89},{8,0,25},
+    {9,0,146},{7,19,59},{8,0,121},{8,0,57},{9,0,210},{7,17,17},{8,0,105},
+    {8,0,41},{9,0,178},{8,0,9},{8,0,137},{8,0,73},{9,0,242},{7,16,4},
+    {8,0,85},{8,0,21},{8,16,258},{7,19,43},{8,0,117},{8,0,53},{9,0,202},
+    {7,17,13},{8,0,101},{8,0,37},{9,0,170},{8,0,5},{8,0,133},{8,0,69},
+    {9,0,234},{7,16,8},{8,0,93},{8,0,29},{9,0,154},{7,20,83},{8,0,125},
+    {8,0,61},{9,0,218},{7,18,23},{8,0,109},{8,0,45},{9,0,186},{8,0,13},
+    {8,0,141},{8,0,77},{9,0,250},{7,16,3},{8,0,83},{8,0,19},{8,21,195},
+    {7,19,35},{8,0,115},{8,0,51},{9,0,198},{7,17,11},{8,0,99},{8,0,35},
+    {9,0,166},{8,0,3},{8,0,131},{8,0,67},{9,0,230},{7,16,7},{8,0,91},
+    {8,0,27},{9,0,150},{7,20,67},{8,0,123},{8,0,59},{9,0,214},{7,18,19},
+    {8,0,107},{8,0,43},{9,0,182},{8,0,11},{8,0,139},{8,0,75},{9,0,246},
+    {7,16,5},{8,0,87},{8,0,23},{8,64,0},{7,19,51},{8,0,119},{8,0,55},
+    {9,0,206},{7,17,15},{8,0,103},{8,0,39},{9,0,174},{8,0,7},{8,0,135},
+    {8,0,71},{9,0,238},{7,16,9},{8,0,95},{8,0,31},{9,0,158},{7,20,99},
+    {8,0,127},{8,0,63},{9,0,222},{7,18,27},{8,0,111},{8,0,47},{9,0,190},
+    {8,0,15},{8,0,143},{8,0,79},{9,0,254},{7,96,0},{8,0,80},{8,0,16},
+    {8,20,115},{7,18,31},{8,0,112},{8,0,48},{9,0,193},{7,16,10},{8,0,96},
+    {8,0,32},{9,0,161},{8,0,0},{8,0,128},{8,0,64},{9,0,225},{7,16,6},
+    {8,0,88},{8,0,24},{9,0,145},{7,19,59},{8,0,120},{8,0,56},{9,0,209},
+    {7,17,17},{8,0,104},{8,0,40},{9,0,177},{8,0,8},{8,0,136},{8,0,72},
+    {9,0,241},{7,16,4},{8,0,84},{8,0,20},{8,21,227},{7,19,43},{8,0,116},
+    {8,0,52},{9,0,201},{7,17,13},{8,0,100},{8,0,36},{9,0,169},{8,0,4},
+    {8,0,132},{8,0,68},{9,0,233},{7,16,8},{8,0,92},{8,0,28},{9,0,153},
+    {7,20,83},{8,0,124},{8,0,60},{9,0,217},{7,18,23},{8,0,108},{8,0,44},
+    {9,0,185},{8,0,12},{8,0,140},{8,0,76},{9,0,249},{7,16,3},{8,0,82},
+    {8,0,18},{8,21,163},{7,19,35},{8,0,114},{8,0,50},{9,0,197},{7,17,11},
+    {8,0,98},{8,0,34},{9,0,165},{8,0,2},{8,0,130},{8,0,66},{9,0,229},
+    {7,16,7},{8,0,90},{8,0,26},{9,0,149},{7,20,67},{8,0,122},{8,0,58},
+    {9,0,213},{7,18,19},{8,0,106},{8,0,42},{9,0,181},{8,0,10},{8,0,138},
+    {8,0,74},{9,0,245},{7,16,5},{8,0,86},{8,0,22},{8,64,0},{7,19,51},
+    {8,0,118},{8,0,54},{9,0,205},{7,17,15},{8,0,102},{8,0,38},{9,0,173},
+    {8,0,6},{8,0,134},{8,0,70},{9,0,237},{7,16,9},{8,0,94},{8,0,30},
+    {9,0,157},{7,20,99},{8,0,126},{8,0,62},{9,0,221},{7,18,27},{8,0,110},
+    {8,0,46},{9,0,189},{8,0,14},{8,0,142},{8,0,78},{9,0,253},{7,96,0},
+    {8,0,81},{8,0,17},{8,21,131},{7,18,31},{8,0,113},{8,0,49},{9,0,195},
+    {7,16,10},{8,0,97},{8,0,33},{9,0,163},{8,0,1},{8,0,129},{8,0,65},
+    {9,0,227},{7,16,6},{8,0,89},{8,0,25},{9,0,147},{7,19,59},{8,0,121},
+    {8,0,57},{9,0,211},{7,17,17},{8,0,105},{8,0,41},{9,0,179},{8,0,9},
+    {8,0,137},{8,0,73},{9,0,243},{7,16,4},{8,0,85},{8,0,21},{8,16,258},
+    {7,19,43},{8,0,117},{8,0,53},{9,0,203},{7,17,13},{8,0,101},{8,0,37},
+    {9,0,171},{8,0,5},{8,0,133},{8,0,69},{9,0,235},{7,16,8},{8,0,93},
+    {8,0,29},{9,0,155},{7,20,83},{8,0,125},{8,0,61},{9,0,219},{7,18,23},
+    {8,0,109},{8,0,45},{9,0,187},{8,0,13},{8,0,141},{8,0,77},{9,0,251},
+    {7,16,3},{8,0,83},{8,0,19},{8,21,195},{7,19,35},{8,0,115},{8,0,51},
+    {9,0,199},{7,17,11},{8,0,99},{8,0,35},{9,0,167},{8,0,3},{8,0,131},
+    {8,0,67},{9,0,231},{7,16,7},{8,0,91},{8,0,27},{9,0,151},{7,20,67},
+    {8,0,123},{8,0,59},{9,0,215},{7,18,19},{8,0,107},{8,0,43},{9,0,183},
+    {8,0,11},{8,0,139},{8,0,75},{9,0,247},{7,16,5},{8,0,87},{8,0,23},
+    {8,64,0},{7,19,51},{8,0,119},{8,0,55},{9,0,207},{7,17,15},{8,0,103},
+    {8,0,39},{9,0,175},{8,0,7},{8,0,135},{8,0,71},{9,0,239},{7,16,9},
+    {8,0,95},{8,0,31},{9,0,159},{7,20,99},{8,0,127},{8,0,63},{9,0,223},
+    {7,18,27},{8,0,111},{8,0,47},{9,0,191},{8,0,15},{8,0,143},{8,0,79},
+    {9,0,255}
 };
 
 static const code distfix[32] = {
-    {16,5,1},{23,5,257},{19,5,17},{27,5,4097},{17,5,5},{25,5,1025},
-    {21,5,65},{29,5,16385},{16,5,3},{24,5,513},{20,5,33},{28,5,8193},
-    {18,5,9},{26,5,2049},{22,5,129},{64,5,0},{16,5,2},{23,5,385},
-    {19,5,25},{27,5,6145},{17,5,7},{25,5,1537},{21,5,97},{29,5,24577},
-    {16,5,4},{24,5,769},{20,5,49},{28,5,12289},{18,5,13},{26,5,3073},
-    {22,5,193},{64,5,0}
+    {5,16,1},{5,23,257},{5,19,17},{5,27,4097},{5,17,5},{5,25,1025},
+    {5,21,65},{5,29,16385},{5,16,3},{5,24,513},{5,20,33},{5,28,8193},
+    {5,18,9},{5,26,2049},{5,22,129},{5,64,0},{5,16,2},{5,23,385},
+    {5,19,25},{5,27,6145},{5,17,7},{5,25,1537},{5,21,97},{5,29,24577},
+    {5,16,4},{5,24,769},{5,20,49},{5,28,12289},{5,18,13},{5,26,3073},
+    {5,22,193},{5,64,0}
 };
diff --git a/inflate.c b/inflate.c
index 956f37db..2339804f 100644
--- a/inflate.c
+++ b/inflate.c
@@ -28,11 +28,11 @@ static inline void inf_chksum_cpy(PREFIX3(stream) *strm, uint8_t *dst,
     struct inflate_state *state = (struct inflate_state*)strm->state;
 #ifdef GUNZIP
     if (state->flags) {
-        FUNCTABLE_CALL(crc32_fold_copy)(&state->crc_fold, dst, src, copy);
+        strm->adler = state->check = FUNCTABLE_CALL(crc32_copy)(state->check, dst, src, copy);
     } else
 #endif
     {
-        strm->adler = state->check = FUNCTABLE_CALL(adler32_fold_copy)(state->check, dst, src, copy);
+        strm->adler = state->check = FUNCTABLE_CALL(adler32_copy)(state->check, dst, src, copy);
     }
 }
 
@@ -40,7 +40,7 @@ static inline void inf_chksum(PREFIX3(stream) *strm, const uint8_t *src, uint32_
     struct inflate_state *state = (struct inflate_state*)strm->state;
 #ifdef GUNZIP
     if (state->flags) {
-        FUNCTABLE_CALL(crc32_fold)(&state->crc_fold, src, len, 0);
+        strm->adler = state->check = FUNCTABLE_CALL(crc32)(state->check, src, len);
     } else
 #endif
     {
@@ -73,13 +73,17 @@ int32_t Z_EXPORT PREFIX(inflateResetKeep)(PREFIX3(stream) *strm) {
     state->last = 0;
     state->havedict = 0;
     state->flags = -1;
-    state->dmax = 32768U;
     state->head = NULL;
     state->hold = 0;
     state->bits = 0;
     state->lencode = state->distcode = state->next = state->codes;
-    state->sane = 1;
     state->back = -1;
+#ifdef INFLATE_STRICT
+    state->dmax = 32768U;
+#endif
+#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
+    state->sane = 1;
+#endif
     INFLATE_RESET_KEEP_HOOK(strm);  /* hook for IBM Z DFLTCC */
     Tracev((stderr, "inflate: reset\n"));
     return Z_OK;
@@ -170,7 +174,7 @@ Z_INTERNAL inflate_allocs* alloc_inflate(PREFIX3(stream) *strm) {
     int total_size = PAD_64(curr_size + (WINDOW_PAD_SIZE - 1));
 
     /* Allocate buffer, align to 64-byte cacheline, and zerofill the resulting buffer */
-    char *original_buf = strm->zalloc(strm->opaque, 1, total_size);
+    char *original_buf = (char *)strm->zalloc(strm->opaque, 1, total_size);
     if (original_buf == NULL)
         return NULL;
 
@@ -179,7 +183,7 @@ Z_INTERNAL inflate_allocs* alloc_inflate(PREFIX3(stream) *strm) {
 
     /* Initialize alloc_bufs */
     inflate_allocs *alloc_bufs  = (struct inflate_allocs_s *)(buff + alloc_pos);
-    alloc_bufs->buf_start = (char *)original_buf;
+    alloc_bufs->buf_start = original_buf;
     alloc_bufs->zfree = strm->zfree;
 
     alloc_bufs->window =  (unsigned char *)HINT_ALIGNED_WINDOW((buff + window_pos));
@@ -213,8 +217,8 @@ Z_INTERNAL void free_inflate(PREFIX3(stream) *strm) {
  * This function is hidden in ZLIB_COMPAT builds.
  */
 int32_t ZNG_CONDEXPORT PREFIX(inflateInit2)(PREFIX3(stream) *strm, int32_t windowBits) {
-    int32_t ret;
     struct inflate_state *state;
+    int32_t ret;
 
     /* Initialize functable */
     FUNCTABLE_INIT;
@@ -236,12 +240,12 @@ int32_t ZNG_CONDEXPORT PREFIX(inflateInit2)(PREFIX3(stream) *strm, int32_t windo
     state = alloc_bufs->state;
     state->window = alloc_bufs->window;
     state->alloc_bufs = alloc_bufs;
+    state->wbufsize = INFLATE_ADJUST_WINDOW_SIZE((1 << MAX_WBITS) + 64);
     Tracev((stderr, "inflate: allocated\n"));
 
     strm->state = (struct internal_state *)state;
     state->strm = strm;
     state->mode = HEAD;     /* to pass state test in inflateReset2() */
-    state->chunksize = FUNCTABLE_CALL(chunksize)();
     ret = PREFIX(inflateReset2)(strm, windowBits);
     if (ret != Z_OK) {
         free_inflate(strm);
@@ -286,7 +290,7 @@ int32_t Z_EXPORT PREFIX(inflatePrime)(PREFIX3(stream) *strm, int32_t bits, int32
     if (bits > 16 || state->bits + (unsigned int)bits > 32)
         return Z_STREAM_ERROR;
     value &= (1L << bits) - 1;
-    state->hold += (unsigned)value << state->bits;
+    state->hold += (uint64_t)value << state->bits;
     state->bits += (unsigned int)bits;
     return Z_OK;
 }
@@ -382,7 +386,7 @@ static void updatewindow(PREFIX3(stream) *strm, const uint8_t *end, uint32_t len
     do { \
         if (have == 0) goto inf_leave; \
         have--; \
-        hold += ((unsigned)(*next++) << bits); \
+        hold += ((uint64_t)(*next++) << bits); \
         bits += 8; \
     } while (0)
 
@@ -472,12 +476,12 @@ int32_t Z_EXPORT PREFIX(inflate)(PREFIX3(stream) *strm, int32_t flush) {
     struct inflate_state *state;
     const unsigned char *next;  /* next input */
     unsigned char *put;         /* next output */
+    unsigned char *from;        /* where to copy match bytes from */
     unsigned have, left;        /* available input and output */
-    uint32_t hold;              /* bit buffer */
-    unsigned bits;              /* bits in bit buffer */
+    uint64_t hold;              /* bit buffer */
+    bits_t bits;                /* bits in bit buffer */
     uint32_t in, out;           /* save starting available input and output */
     unsigned copy;              /* number of stored or match bytes to copy */
-    unsigned char *from;        /* where to copy match bytes from */
     code here;                  /* current decoding table entry */
     code last;                  /* parent table entry */
     unsigned len;               /* length to copy for repeats, bits to drop */
@@ -539,7 +543,9 @@ int32_t Z_EXPORT PREFIX(inflate)(PREFIX3(stream) *strm, int32_t flush) {
                 SET_BAD("invalid window size");
                 break;
             }
+#ifdef INFLATE_STRICT
             state->dmax = 1U << len;
+#endif
             state->flags = 0;               /* indicate zlib header */
             Tracev((stderr, "inflate:   zlib header ok\n"));
             strm->adler = state->check = ADLER32_INITIAL_VALUE;
@@ -570,7 +576,7 @@ int32_t Z_EXPORT PREFIX(inflate)(PREFIX3(stream) *strm, int32_t flush) {
         case TIME:
             NEEDBITS(32);
             if (state->head != NULL)
-                state->head->time = hold;
+                state->head->time = (unsigned)(hold);
             if ((state->flags & 0x0200) && (state->wrap & 4))
                 CRC4(state->check, hold);
             INITBITS();
@@ -691,13 +697,13 @@ int32_t Z_EXPORT PREFIX(inflate)(PREFIX3(stream) *strm, int32_t flush) {
             }
             /* compute crc32 checksum if not in raw mode */
             if ((state->wrap & 4) && state->flags)
-                strm->adler = state->check = FUNCTABLE_CALL(crc32_fold_reset)(&state->crc_fold);
+                strm->adler = state->check = CRC32_INITIAL_VALUE;
             state->mode = TYPE;
             break;
 #endif
         case DICTID:
             NEEDBITS(32);
-            strm->adler = state->check = ZSWAP32(hold);
+            strm->adler = state->check = ZSWAP32((unsigned)hold);
             INITBITS();
             state->mode = DICT;
             Z_FALLTHROUGH;
@@ -1049,11 +1055,11 @@ int32_t Z_EXPORT PREFIX(inflate)(PREFIX3(stream) *strm, int32_t flush) {
             if (state->offset > copy) {         /* copy from window */
                 copy = state->offset - copy;
                 if (copy > state->whave) {
+#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
                     if (state->sane) {
                         SET_BAD("invalid distance too far back");
                         break;
                     }
-#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
                     Trace((stderr, "inflate.c too far\n"));
                     copy -= state->whave;
                     copy = MIN(copy, state->length);
@@ -1065,8 +1071,10 @@ int32_t Z_EXPORT PREFIX(inflate)(PREFIX3(stream) *strm, int32_t flush) {
                     } while (--copy);
                     if (state->length == 0)
                         state->mode = LEN;
-                    break;
+#else
+                    SET_BAD("invalid distance too far back");
 #endif
+                    break;
                 }
                 if (copy > state->wnext) {
                     copy -= state->wnext;
@@ -1081,7 +1089,7 @@ int32_t Z_EXPORT PREFIX(inflate)(PREFIX3(stream) *strm, int32_t flush) {
             } else {
                 copy = MIN(state->length, left);
 
-                put = FUNCTABLE_CALL(chunkmemset_safe)(put, state->offset, copy, left);
+                put = FUNCTABLE_CALL(chunkmemset_safe)(put, put - state->offset, copy, left);
             }
             left -= copy;
             state->length -= copy;
@@ -1109,17 +1117,13 @@ int32_t Z_EXPORT PREFIX(inflate)(PREFIX3(stream) *strm, int32_t flush) {
                     if (out) {
                         inf_chksum(strm, put - out, out);
                     }
-#ifdef GUNZIP
-                    if (state->flags)
-                        strm->adler = state->check = FUNCTABLE_CALL(crc32_fold_final)(&state->crc_fold);
-#endif
                 }
                 out = left;
                 if ((state->wrap & 4) && (
 #ifdef GUNZIP
                      state->flags ? hold :
 #endif
-                     ZSWAP32(hold)) != state->check) {
+                     ZSWAP32((unsigned)hold)) != state->check) {
                     SET_BAD("incorrect data check");
                     break;
                 }
@@ -1297,11 +1301,11 @@ static uint32_t syncsearch(uint32_t *have, const uint8_t *buf, uint32_t len) {
 }
 
 int32_t Z_EXPORT PREFIX(inflateSync)(PREFIX3(stream) *strm) {
+    struct inflate_state *state;
+    size_t in, out;             /* temporary to save total_in and total_out */
     unsigned len;               /* number of bytes to look at or looked at */
     int flags;                  /* temporary to save header status */
-    size_t in, out;             /* temporary to save total_in and total_out */
     unsigned char buf[4];       /* to restore bit buffer to byte string */
-    struct inflate_state *state;
 
     /* check parameters */
     if (inflateStateCheck(strm))
@@ -1404,17 +1408,17 @@ int32_t Z_EXPORT PREFIX(inflateCopy)(PREFIX3(stream) *dest, PREFIX3(stream) *sou
 }
 
 int32_t Z_EXPORT PREFIX(inflateUndermine)(PREFIX3(stream) *strm, int32_t subvert) {
+#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
     struct inflate_state *state;
 
     if (inflateStateCheck(strm))
         return Z_STREAM_ERROR;
     state = (struct inflate_state *)strm->state;
-#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
     state->sane = !subvert;
     return Z_OK;
 #else
+    Z_UNUSED(strm);
     Z_UNUSED(subvert);
-    state->sane = 1;
     return Z_DATA_ERROR;
 #endif
 }
diff --git a/inflate.h b/inflate.h
index 536da7d1..c2ecb780 100644
--- a/inflate.h
+++ b/inflate.h
@@ -97,7 +97,7 @@ typedef struct inflate_allocs_s {
 /* State maintained between inflate() calls -- approximately 7K bytes, not
    including the allocated sliding window, which is up to 32K bytes. */
 struct ALIGNED_(64) inflate_state {
-    PREFIX3(stream) *strm;             /* pointer back to this zlib stream */
+    PREFIX3(stream) *strm;      /* pointer back to this zlib stream */
     inflate_mode mode;          /* current inflate mode */
     int last;                   /* true if processing last block */
     int wrap;                   /* bit 0 true for zlib, bit 1 true for gzip,
@@ -105,49 +105,63 @@ struct ALIGNED_(64) inflate_state {
     int havedict;               /* true if dictionary provided */
     int flags;                  /* gzip header method and flags, 0 if zlib, or
                                    -1 if raw or no header yet */
-    unsigned dmax;              /* zlib header max distance (INFLATE_STRICT) */
+    unsigned was;               /* initial length of match, for inflateMark */
     unsigned long check;        /* protected copy of check value */
     unsigned long total;        /* protected copy of output count */
     PREFIX(gz_headerp) head;    /* where to save gzip header information */
+    int back;                   /* bits back of last unprocessed length/lit */
+
         /* sliding window */
     unsigned wbits;             /* log base 2 of requested window size */
     uint32_t wsize;             /* window size or zero if not using window */
+    uint32_t wbufsize;          /* real size of the allocated window buffer, including padding */
     uint32_t whave;             /* valid bytes in the window */
     uint32_t wnext;             /* window write index */
     unsigned char *window;      /* allocated sliding window, if needed */
 
-    struct crc32_fold_s ALIGNED_(16) crc_fold;
-
         /* bit accumulator */
-    uint32_t hold;              /* input bit accumulator */
+    uint64_t hold;              /* input bit accumulator */
     unsigned bits;              /* number of bits in "in" */
+        /* fixed and dynamic code tables */
+    unsigned lenbits;           /* index bits for lencode */
+    code const *lencode;        /* starting table for length/literal codes */
+    code const *distcode;       /* starting table for distance codes */
+    unsigned distbits;          /* index bits for distcode */
         /* for string and stored block copying */
     uint32_t length;            /* literal or length of data to copy */
     unsigned offset;            /* distance back to copy string from */
         /* for table and code decoding */
     unsigned extra;             /* extra bits needed */
-        /* fixed and dynamic code tables */
-    code const *lencode;        /* starting table for length/literal codes */
-    code const *distcode;       /* starting table for distance codes */
-    unsigned lenbits;           /* index bits for lencode */
-    unsigned distbits;          /* index bits for distcode */
         /* dynamic table building */
     unsigned ncode;             /* number of code length code lengths */
     unsigned nlen;              /* number of length code lengths */
     unsigned ndist;             /* number of distance code lengths */
     uint32_t have;              /* number of code lengths in lens[] */
     code *next;                 /* next available space in codes[] */
+
+#ifdef ARCH_32BIT
+    uint32_t padding[1];
+#endif
+    uint8_t ALIGNED_(16) padding4[68];
+
     uint16_t lens[320];         /* temporary storage for code lengths */
     uint16_t work[288];         /* work area for code table building */
     code codes[ENOUGH];         /* space for code tables */
-    int sane;                   /* if false, allow invalid distance too far */
-    int back;                   /* bits back of last unprocessed length/lit */
-    unsigned was;               /* initial length of match */
-    uint32_t chunksize;         /* size of memory copying chunk */
+
     inflate_allocs *alloc_bufs; /* struct for handling memory allocations */
+
+#ifdef INFLATE_STRICT
+    unsigned dmax;              /* zlib header max distance (INFLATE_STRICT) */
+#endif
+#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR
+    int sane;                   /* if false, allow invalid distance too far */
+#endif
 #ifdef HAVE_ARCH_INFLATE_STATE
     arch_inflate_state arch;    /* architecture-specific extensions */
 #endif
+#ifdef ARCH_32BIT
+    int padding2[8];
+#endif
 };
 
 void Z_INTERNAL PREFIX(fixedtables)(struct inflate_state *state);
diff --git a/inflate_p.h b/inflate_p.h
index c324b048..4f056414 100644
--- a/inflate_p.h
+++ b/inflate_p.h
@@ -6,6 +6,7 @@
 #define INFLATE_P_H
 
 #include <stdlib.h>
+#include "zmemory.h"
 
 /* Architecture-specific hooks. */
 #ifdef S390_DFLTCC_INFLATE
@@ -71,6 +72,13 @@
     } while (0)
 #endif
 
+/* Compiler optimization for bit accumulator on x86 architectures */
+#ifdef ARCH_X86
+typedef uint8_t bits_t;
+#else
+typedef unsigned bits_t;
+#endif
+
 /* Load registers with state in inflate() for speed */
 #define LOAD() \
     do { \
@@ -79,7 +87,7 @@
         next = strm->next_in; \
         have = strm->avail_in; \
         hold = state->hold; \
-        bits = state->bits; \
+        bits = (bits_t)state->bits; \
     } while (0)
 
 /* Restore state from registers in inflate() */
@@ -104,7 +112,7 @@
    not enough available input to do that, then return from inflate()/inflateBack(). */
 #define NEEDBITS(n) \
     do { \
-        while (bits < (unsigned)(n)) \
+        while (bits < (bits_t)(n)) \
             PULLBYTE(); \
     } while (0)
 
@@ -116,7 +124,7 @@
 #define DROPBITS(n) \
     do { \
         hold >>= (n); \
-        bits -= (unsigned)(n); \
+        bits -= (bits_t)(n); \
     } while (0)
 
 /* Remove zero to seven bits as needed to go to a byte boundary */
@@ -138,8 +146,7 @@
 
 /* Load 64 bits from IN and place the bytes at offset BITS in the result. */
 static inline uint64_t load_64_bits(const unsigned char *in, unsigned bits) {
-    uint64_t chunk;
-    memcpy(&chunk, in, sizeof(chunk));
+    uint64_t chunk = zng_memread_8(in);
 
 #if BYTE_ORDER == LITTLE_ENDIAN
     return chunk << bits;
@@ -150,7 +157,7 @@ static inline uint64_t load_64_bits(const unsigned char *in, unsigned bits) {
 
 /* Behave like chunkcopy, but avoid writing beyond of legal output. */
 static inline uint8_t* chunkcopy_safe(uint8_t *out, uint8_t *from, uint64_t len, uint8_t *safe) {
-    uint64_t safelen = (safe - out) + 1;
+    uint64_t safelen = safe - out;
     len = MIN(len, safelen);
     int32_t olap_src = from >= out && from < out + len;
     int32_t olap_dst = out >= from && out < from + len;
@@ -174,25 +181,16 @@ static inline uint8_t* chunkcopy_safe(uint8_t *out, uint8_t *from, uint64_t len,
      * behind or lookahead distance. */
     uint64_t non_olap_size = llabs(from - out); // llabs vs labs for compatibility with windows
 
-    memcpy(out, from, (size_t)non_olap_size);
-    out += non_olap_size;
-    from += non_olap_size;
-    len -= non_olap_size;
-
     /* So this doesn't give use a worst case scenario of function calls in a loop,
-     * we want to instead break this down into copy blocks of fixed lengths */
+     * we want to instead break this down into copy blocks of fixed lengths
+     *
+     * TODO: The memcpy calls aren't inlined on architectures with strict memory alignment
+     */
     while (len) {
         tocopy = MIN(non_olap_size, len);
         len -= tocopy;
 
-        while (tocopy >= 32) {
-            memcpy(out, from, 32);
-            out += 32;
-            from += 32;
-            tocopy -= 32;
-        }
-
-        if (tocopy >= 16) {
+        while (tocopy >= 16) {
             memcpy(out, from, 16);
             out += 16;
             from += 16;
@@ -213,14 +211,7 @@ static inline uint8_t* chunkcopy_safe(uint8_t *out, uint8_t *from, uint64_t len,
             tocopy -= 4;
         }
 
-        if (tocopy >= 2) {
-            memcpy(out, from, 2);
-            out += 2;
-            from += 2;
-            tocopy -= 2;
-        }
-
-        if (tocopy) {
+        while (tocopy--) {
             *out++ = *from++;
         }
     }
diff --git a/inftrees.c b/inftrees.c
index 5234fe7a..63c9b75f 100644
--- a/inftrees.c
+++ b/inftrees.c
@@ -6,6 +6,13 @@
 #include "zbuild.h"
 #include "zutil.h"
 #include "inftrees.h"
+#include "fallback_builtins.h"
+
+#if defined(__SSE2__)
+#  include "arch/x86/x86_intrins.h"
+#elif defined(__ARM_NEON) || defined(__ARM_NEON__)
+#  include "arch/arm/neon_intrins.h"
+#endif
 
 const char PREFIX(inflate_copyright)[] = " inflate 1.3.1 Copyright 1995-2024 Mark Adler ";
 /*
@@ -15,6 +22,84 @@ const char PREFIX(inflate_copyright)[] = " inflate 1.3.1 Copyright 1995-2024 Mar
   copyright string in the executable of your product.
  */
 
+/* Count number of codes for each code length. */
+static inline void count_lengths(uint16_t *lens, int codes, uint16_t *count) {
+    int sym;
+    static const ALIGNED_(16) uint8_t one[256] = {
+        1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
+        0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
+        0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
+        0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
+        0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
+        0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
+        0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
+        0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
+        0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
+        0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
+        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
+        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
+        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
+        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
+        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
+        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1
+    };
+
+#if defined(__ARM_NEON) || defined(__ARM_NEON__)
+    uint8x16_t s1 = vdupq_n_u8(0);
+    uint8x16_t s2 = vdupq_n_u8(0);
+
+    if (codes & 1) {
+        s1 = vld1q_u8(&one[16 * lens[0]]);
+    }
+    for (sym = codes & 1; sym < codes; sym += 2) {
+      s1 = vaddq_u8(s1, vld1q_u8(&one[16 * lens[sym]]));
+      s2 = vaddq_u8(s2, vld1q_u8(&one[16 * lens[sym+1]]));
+    }
+
+    vst1q_u16(&count[0], vaddl_u8(vget_low_u8(s1), vget_low_u8(s2)));
+    vst1q_u16(&count[8], vaddl_u8(vget_high_u8(s1), vget_high_u8(s2)));
+
+#elif defined(__SSE2__)
+    __m128i s1 = _mm_setzero_si128();
+    __m128i s2 = _mm_setzero_si128();
+
+    if (codes & 1) {
+        s1 = _mm_load_si128((const __m128i*)&one[16 * lens[0]]);
+    }
+    for (sym = codes & 1; sym < codes; sym += 2) {
+        s1 = _mm_add_epi8(s1, _mm_load_si128((const __m128i*)&one[16 * lens[sym]]));  // vaddq_u8
+        s2 = _mm_add_epi8(s2, _mm_load_si128((const __m128i*)&one[16 * lens[sym+1]]));
+    }
+
+#  if defined(__AVX2__)
+    __m256i w1 = _mm256_cvtepu8_epi16(s1);
+    __m256i w2 = _mm256_cvtepu8_epi16(s2);
+    __m256i sum = _mm256_add_epi16(w1, w2);
+
+    _mm256_storeu_si256((__m256i*)&count[0], sum);
+#  else
+    __m128i zero = _mm_setzero_si128();
+
+    __m128i s1_lo = _mm_unpacklo_epi8(s1, zero);
+    __m128i s2_lo = _mm_unpacklo_epi8(s2, zero);
+    __m128i sum_lo = _mm_add_epi16(s1_lo, s2_lo);
+    _mm_storeu_si128((__m128i*)&count[0], sum_lo);
+
+    __m128i s1_hi = _mm_unpackhi_epi8(s1, zero);
+    __m128i s2_hi = _mm_unpackhi_epi8(s2, zero);
+    __m128i sum_hi = _mm_add_epi16(s1_hi, s2_hi);
+    _mm_storeu_si128((__m128i*)&count[8], sum_hi);
+#  endif
+#else
+    int len;
+    for (len = 0; len <= MAX_BITS; len++)
+        count[len] = 0;
+    for (sym = 0; sym < codes; sym++)
+        count[lens[sym]]++;
+    Z_UNUSED(one);
+#endif
+}
+
 /*
    Build a set of tables to decode the provided canonical Huffman code.
    The code lengths are lens[0..codes-1].  The result starts at *table,
@@ -28,7 +113,7 @@ const char PREFIX(inflate_copyright)[] = " inflate 1.3.1 Copyright 1995-2024 Mar
    longest code or if it is less than the shortest code.
  */
 int Z_INTERNAL zng_inflate_table(codetype type, uint16_t *lens, unsigned codes,
-                                code * *table, unsigned *bits, uint16_t *work) {
+                                 code * *table, unsigned *bits, uint16_t *work) {
     unsigned len;               /* a code's length in bits */
     unsigned sym;               /* index of code symbols */
     unsigned min, max;          /* minimum and maximum code lengths */
@@ -37,6 +122,7 @@ int Z_INTERNAL zng_inflate_table(codetype type, uint16_t *lens, unsigned codes,
     unsigned drop;              /* code bits to drop for sub-table */
     int left;                   /* number of prefix codes available */
     unsigned used;              /* code entries in table used */
+    uint16_t rhuff;             /* Reversed huffman code */
     unsigned huff;              /* Huffman code */
     unsigned incr;              /* for incrementing code, index */
     unsigned fill;              /* index for replicating entries */
@@ -47,8 +133,8 @@ int Z_INTERNAL zng_inflate_table(codetype type, uint16_t *lens, unsigned codes,
     const uint16_t *base;       /* base value table to use */
     const uint16_t *extra;      /* extra bits table to use */
     unsigned match;             /* use base and extra for symbol >= match */
-    uint16_t count[MAX_BITS+1];  /* number of codes of each length */
-    uint16_t offs[MAX_BITS+1];   /* offsets in table for each length */
+    uint16_t count[MAX_BITS+1]; /* number of codes of each length */
+    uint16_t offs[MAX_BITS+1];  /* offsets in table for each length */
     static const uint16_t lbase[31] = { /* Length codes 257..285 base */
         3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31,
         35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0};
@@ -96,10 +182,7 @@ int Z_INTERNAL zng_inflate_table(codetype type, uint16_t *lens, unsigned codes,
      */
 
     /* accumulate lengths for codes (assumes lens[] all in 0..MAXBITS) */
-    for (len = 0; len <= MAX_BITS; len++)
-        count[len] = 0;
-    for (sym = 0; sym < codes; sym++)
-        count[lens[sym]]++;
+    count_lengths(lens, codes, count);
 
     /* bound code lengths, force root to be within code lengths */
     root = *bits;
@@ -187,6 +270,7 @@ int Z_INTERNAL zng_inflate_table(codetype type, uint16_t *lens, unsigned codes,
     }
 
     /* initialize state for loop */
+    rhuff = 0;                  /* starting code, reversed */
     huff = 0;                   /* starting code */
     sym = 0;                    /* starting code symbol */
     len = min;                  /* starting code length */
@@ -227,15 +311,8 @@ int Z_INTERNAL zng_inflate_table(codetype type, uint16_t *lens, unsigned codes,
         } while (fill != 0);
 
         /* backwards increment the len-bit code huff */
-        incr = 1U << (len - 1);
-        while (huff & incr)
-            incr >>= 1;
-        if (incr != 0) {
-            huff &= incr - 1;
-            huff += incr;
-        } else {
-            huff = 0;
-        }
+        rhuff += (0x8000u >> (len - 1));
+        huff = __builtin_bitreverse16(rhuff);
 
         /* go to next symbol, update count, len */
         sym++;
diff --git a/inftrees.h b/inftrees.h
index ad2be151..a3d6421f 100644
--- a/inftrees.h
+++ b/inftrees.h
@@ -25,8 +25,8 @@
    of a literal, the base length or distance, or the offset from
    the current table to the next table.  Each entry is four bytes. */
 typedef struct {
-    unsigned char op;         /* operation, extra bits, table bits */
     unsigned char bits;       /* bits in this part of the code */
+    unsigned char op;         /* operation, extra bits, table bits */
     uint16_t val;             /* offset in table or code value */
 } code;
 
diff --git a/insert_string.c b/insert_string.c
index 11a5b97f..dd1960fb 100644
--- a/insert_string.c
+++ b/insert_string.c
@@ -1,4 +1,4 @@
-/* insert_string.c -- insert_string integer hash variant
+/* insert_string.c -- make insert_string functions from static inlined functions
  *
  * Copyright (C) 1995-2024 Jean-loup Gailly and Mark Adler
  * For conditions of distribution and use, see copyright notice in zlib.h
@@ -7,15 +7,12 @@
 
 #include "zbuild.h"
 #include "deflate.h"
+#include "insert_string_p.h"
 
-#define HASH_SLIDE           16
+void insert_string(deflate_state *const s, uint32_t str, uint32_t count) {
+    insert_string_static(s, str, count);
+}
 
-#define HASH_CALC(h, val)    h = ((val * 2654435761U) >> HASH_SLIDE);
-#define HASH_CALC_VAR        h
-#define HASH_CALC_VAR_INIT   uint32_t h = 0
-
-#define UPDATE_HASH          update_hash
-#define INSERT_STRING        insert_string
-#define QUICK_INSERT_STRING  quick_insert_string
-
-#include "insert_string_tpl.h"
+void insert_string_roll(deflate_state *const s, uint32_t str, uint32_t count) {
+    insert_string_roll_static(s, str, count);
+}
diff --git a/insert_string_p.h b/insert_string_p.h
new file mode 100644
index 00000000..cd022344
--- /dev/null
+++ b/insert_string_p.h
@@ -0,0 +1,57 @@
+#ifndef INSERT_STRING_P_H_
+#define INSERT_STRING_P_H_
+
+/* insert_string_p.h -- insert_string function generator
+ *
+ * Copyright (C) 1995-2024 Jean-loup Gailly and Mark Adler
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ *
+ */
+
+// Normal insert_string, levels 1-8
+#define HASH_SLIDE           16
+
+#define HASH_CALC(h, val)    h = ((val * 2654435761U) >> HASH_SLIDE);
+#define HASH_CALC_MASK       HASH_MASK
+#define HASH_CALC_VAR        h
+#define HASH_CALC_VAR_INIT   uint32_t h
+#define HASH_CALC_OFFSET     0
+
+#define UPDATE_HASH          update_hash
+#define INSERT_STRING        insert_string_static
+#define QUICK_INSERT_STRING  quick_insert_string
+#define QUICK_INSERT_VALUE   quick_insert_value
+
+#include "insert_string_tpl.h"
+
+// Cleanup
+#undef HASH_SLIDE
+#undef HASH_CALC
+#undef HASH_CALC_READ
+#undef HASH_CALC_MASK
+#undef HASH_CALC_OFFSET
+#undef HASH_CALC_VAR
+#undef HASH_CALC_VAR_INIT
+#undef UPDATE_HASH
+#undef INSERT_STRING
+#undef QUICK_INSERT_STRING
+#undef QUICK_INSERT_VALUE
+
+// Rolling insert_string, level 9
+#define HASH_SLIDE           5
+
+#define HASH_CALC(h, val)    h = ((h << HASH_SLIDE) ^ ((uint8_t)val))
+#define HASH_CALC_VAR        s->ins_h
+#define HASH_CALC_VAR_INIT
+#define HASH_CALC_READ       val = strstart[0]
+#define HASH_CALC_MASK       (32768u - 1u)
+#define HASH_CALC_OFFSET     (STD_MIN_MATCH-1)
+
+#define UPDATE_HASH          update_hash_roll
+#define INSERT_STRING        insert_string_roll_static
+#define QUICK_INSERT_STRING  quick_insert_string_roll
+#define QUICK_INSERT_VALUE   quick_insert_value_roll
+
+#include "insert_string_tpl.h"
+
+#endif
diff --git a/insert_string_roll.c b/insert_string_roll.c
deleted file mode 100644
index 8693f96f..00000000
--- a/insert_string_roll.c
+++ /dev/null
@@ -1,24 +0,0 @@
-/* insert_string_roll.c -- insert_string rolling hash variant
- *
- * Copyright (C) 1995-2024 Jean-loup Gailly and Mark Adler
- * For conditions of distribution and use, see copyright notice in zlib.h
- *
- */
-
-#include "zbuild.h"
-#include "deflate.h"
-
-#define HASH_SLIDE           5
-
-#define HASH_CALC(h, val)    h = ((h << HASH_SLIDE) ^ ((uint8_t)val))
-#define HASH_CALC_VAR        s->ins_h
-#define HASH_CALC_VAR_INIT
-#define HASH_CALC_READ       val = strstart[0]
-#define HASH_CALC_MASK       (32768u - 1u)
-#define HASH_CALC_OFFSET     (STD_MIN_MATCH-1)
-
-#define UPDATE_HASH          update_hash_roll
-#define INSERT_STRING        insert_string_roll
-#define QUICK_INSERT_STRING  quick_insert_string_roll
-
-#include "insert_string_tpl.h"
diff --git a/insert_string_tpl.h b/insert_string_tpl.h
index 281c0134..80840548 100644
--- a/insert_string_tpl.h
+++ b/insert_string_tpl.h
@@ -1,6 +1,3 @@
-#ifndef INSERT_STRING_H_
-#define INSERT_STRING_H_
-
 /* insert_string_tpl.h -- Private insert_string functions shared with more than
  *                        one insert string implementation
  *
@@ -22,22 +19,13 @@
  *
  */
 
-#ifndef HASH_CALC_OFFSET
-#  define HASH_CALC_OFFSET 0
-#endif
-#ifndef HASH_CALC_MASK
-#  define HASH_CALC_MASK HASH_MASK
-#endif
 #ifndef HASH_CALC_READ
 #  if BYTE_ORDER == LITTLE_ENDIAN
 #    define HASH_CALC_READ \
-        memcpy(&val, strstart, sizeof(val));
+        val = zng_memread_4(strstart);
 #  else
 #    define HASH_CALC_READ \
-        val  = ((uint32_t)(strstart[0])); \
-        val |= ((uint32_t)(strstart[1]) << 8); \
-        val |= ((uint32_t)(strstart[2]) << 16); \
-        val |= ((uint32_t)(strstart[3]) << 24);
+        val = ZSWAP32(zng_memread_4(strstart));
 #  endif
 #endif
 
@@ -47,20 +35,40 @@
  *    input characters, so that a running hash key can be computed from the
  *    previous key instead of complete recalculation each time.
  */
-Z_INTERNAL uint32_t UPDATE_HASH(uint32_t h, uint32_t val) {
+Z_FORCEINLINE static uint32_t UPDATE_HASH(uint32_t h, uint32_t val) {
     HASH_CALC(h, val);
     return h & HASH_CALC_MASK;
 }
 
+/* ===========================================================================
+ * Quick insert string str in the dictionary using a pre-read value and set match_head
+ * to the previous head of the hash chain (the most recent string with same hash key).
+ * Return the previous length of the hash chain.
+ */
+Z_FORCEINLINE static uint32_t QUICK_INSERT_VALUE(deflate_state *const s, uint32_t str, uint32_t val) {
+    uint32_t hm, head;
+
+    HASH_CALC_VAR_INIT;
+    HASH_CALC(HASH_CALC_VAR, val);
+    HASH_CALC_VAR &= HASH_CALC_MASK;
+    hm = HASH_CALC_VAR;
+
+    head = s->head[hm];
+    if (LIKELY(head != str)) {
+        s->prev[str & W_MASK(s)] = (Pos)head;
+        s->head[hm] = (Pos)str;
+    }
+    return head;
+}
+
 /* ===========================================================================
  * Quick insert string str in the dictionary and set match_head to the previous head
  * of the hash chain (the most recent string with same hash key). Return
  * the previous length of the hash chain.
  */
-Z_INTERNAL Pos QUICK_INSERT_STRING(deflate_state *const s, uint32_t str) {
-    Pos head;
+Z_FORCEINLINE static uint32_t QUICK_INSERT_STRING(deflate_state *const s, uint32_t str) {
     uint8_t *strstart = s->window + str + HASH_CALC_OFFSET;
-    uint32_t val, hm;
+    uint32_t val, hm, head;
 
     HASH_CALC_VAR_INIT;
     HASH_CALC_READ;
@@ -70,7 +78,7 @@ Z_INTERNAL Pos QUICK_INSERT_STRING(deflate_state *const s, uint32_t str) {
 
     head = s->head[hm];
     if (LIKELY(head != str)) {
-        s->prev[str & s->w_mask] = head;
+        s->prev[str & W_MASK(s)] = (Pos)head;
         s->head[hm] = (Pos)str;
     }
     return head;
@@ -84,12 +92,17 @@ Z_INTERNAL Pos QUICK_INSERT_STRING(deflate_state *const s, uint32_t str) {
  *    input characters and the first STD_MIN_MATCH bytes of str are valid
  *    (except for the last STD_MIN_MATCH-1 bytes of the input file).
  */
-Z_INTERNAL void INSERT_STRING(deflate_state *const s, uint32_t str, uint32_t count) {
+Z_FORCEINLINE static void INSERT_STRING(deflate_state *const s, uint32_t str, uint32_t count) {
     uint8_t *strstart = s->window + str + HASH_CALC_OFFSET;
     uint8_t *strend = strstart + count;
 
-    for (Pos idx = (Pos)str; strstart < strend; idx++, strstart++) {
-        uint32_t val, hm;
+    /* Local pointers to avoid indirection */
+    Pos *headp = s->head;
+    Pos *prevp = s->prev;
+    const unsigned int w_mask = W_MASK(s);
+
+    for (uint32_t idx = str; strstart < strend; idx++, strstart++) {
+        uint32_t val, hm, head;
 
         HASH_CALC_VAR_INIT;
         HASH_CALC_READ;
@@ -97,11 +110,10 @@ Z_INTERNAL void INSERT_STRING(deflate_state *const s, uint32_t str, uint32_t cou
         HASH_CALC_VAR &= HASH_CALC_MASK;
         hm = HASH_CALC_VAR;
 
-        Pos head = s->head[hm];
+        head = headp[hm];
         if (LIKELY(head != idx)) {
-            s->prev[idx & s->w_mask] = head;
-            s->head[hm] = idx;
+            prevp[idx & w_mask] = (Pos)head;
+            headp[hm] = (Pos)idx;
         }
     }
 }
-#endif
diff --git a/match_tpl.h b/match_tpl.h
index 9c258242..40db4bd0 100644
--- a/match_tpl.h
+++ b/match_tpl.h
@@ -8,12 +8,14 @@
  *  https://github.com/gildor2/fast_zlib
  */
 
-#ifndef MATCH_TPL_H
-#define MATCH_TPL_H
+#include "insert_string_p.h"
 
 #define EARLY_EXIT_TRIGGER_LEVEL 5
 
-#endif
+#define GOTO_NEXT_CHAIN \
+    if (--chain_length && (cur_match = prev[cur_match & wmask]) > limit) \
+        continue; \
+    return best_len;
 
 /* Set match_start to the longest match starting at the given string and
  * return its length. Matches shorter or equal to prev_length are discarded,
@@ -22,96 +24,85 @@
  * IN assertions: cur_match is the head of the hash chain for the current
  * string (strstart) and its distance is <= MAX_DIST, and prev_length >=1
  * OUT assertion: the match length is not greater than s->lookahead
+ *
+ * The LONGEST_MATCH_SLOW variant spends more time to attempt to find longer
+ * matches once a match has already been found.
  */
-Z_INTERNAL uint32_t LONGEST_MATCH(deflate_state *const s, Pos cur_match) {
+Z_INTERNAL uint32_t LONGEST_MATCH(deflate_state *const s, uint32_t cur_match) {
+    const unsigned wmask = W_MASK(s);
     unsigned int strstart = s->strstart;
-    const unsigned wmask = s->w_mask;
-    unsigned char *window = s->window;
-    unsigned char *scan = window + strstart;
-    Z_REGISTER unsigned char *mbase_start = window;
-    Z_REGISTER unsigned char *mbase_end;
+    const unsigned char *window = s->window;
     const Pos *prev = s->prev;
-    Pos limit;
 #ifdef LONGEST_MATCH_SLOW
-    Pos limit_base;
+    const Pos *head = s->head;
+#endif
+    const unsigned char *scan;
+    const unsigned char *mbase_start = window;
+    const unsigned char *mbase_end;
+    uint32_t limit;
+#ifdef LONGEST_MATCH_SLOW
+    uint32_t limit_base;
 #else
     int32_t early_exit;
 #endif
-    uint32_t chain_length, nice_match, best_len, offset;
+    uint32_t chain_length = s->max_chain_length;
+    uint32_t nice_match = (uint32_t)s->nice_match;
+    uint32_t best_len, offset;
     uint32_t lookahead = s->lookahead;
-    Pos match_offset = 0;
-#ifdef UNALIGNED_OK
-    uint8_t scan_start[8];
-#endif
-    uint8_t scan_end[8];
-
-#define GOTO_NEXT_CHAIN \
-    if (--chain_length && (cur_match = prev[cur_match & wmask]) > limit) \
-        continue; \
-    return best_len;
+    uint32_t match_offset = 0;
+    uint64_t scan_start;
+    uint64_t scan_end;
 
     /* The code is optimized for STD_MAX_MATCH-2 multiple of 16. */
     Assert(STD_MAX_MATCH == 258, "Code too clever");
 
+    scan = window + strstart;
     best_len = s->prev_length ? s->prev_length : STD_MIN_MATCH-1;
 
     /* Calculate read offset which should only extend an extra byte
      * to find the next best match length.
      */
     offset = best_len-1;
-#ifdef UNALIGNED_OK
     if (best_len >= sizeof(uint32_t)) {
         offset -= 2;
-#ifdef UNALIGNED64_OK
         if (best_len >= sizeof(uint64_t))
             offset -= 4;
-#endif
     }
-#endif
 
-#ifdef UNALIGNED64_OK
-    memcpy(scan_start, scan, sizeof(uint64_t));
-    memcpy(scan_end, scan+offset, sizeof(uint64_t));
-#elif defined(UNALIGNED_OK)
-    memcpy(scan_start, scan, sizeof(uint32_t));
-    memcpy(scan_end, scan+offset, sizeof(uint32_t));
-#else
-    scan_end[0] = *(scan+offset);
-    scan_end[1] = *(scan+offset+1);
-#endif
+    scan_start = zng_memread_8(scan);
+    scan_end = zng_memread_8(scan+offset);
     mbase_end  = (mbase_start+offset);
 
     /* Do not waste too much time if we already have a good match */
-    chain_length = s->max_chain_length;
     if (best_len >= s->good_match)
         chain_length >>= 2;
-    nice_match = (uint32_t)s->nice_match;
 
     /* Stop when cur_match becomes <= limit. To simplify the code,
      * we prevent matches with the string of window index 0
      */
-    limit = strstart > MAX_DIST(s) ? (Pos)(strstart - MAX_DIST(s)) : 0;
+    limit = strstart > MAX_DIST(s) ? (strstart - MAX_DIST(s)) : 0;
 #ifdef LONGEST_MATCH_SLOW
     limit_base = limit;
     if (best_len >= STD_MIN_MATCH) {
         /* We're continuing search (lazy evaluation). */
-        uint32_t i, hash;
-        Pos pos;
+        uint32_t hash;
+        uint32_t pos;
 
         /* Find a most distant chain starting from scan with index=1 (index=0 corresponds
          * to cur_match). We cannot use s->prev[strstart+1,...] immediately, because
          * these strings are not yet inserted into the hash table.
          */
-        hash = s->update_hash(0, scan[1]);
-        hash = s->update_hash(hash, scan[2]);
-
-        for (i = 3; i <= best_len; i++) {
-            hash = s->update_hash(hash, scan[i]);
+        // use update_hash_roll for deflate_slow
+        hash = update_hash_roll(0, scan[1]);
+        hash = update_hash_roll(hash, scan[2]);
 
+        for (uint32_t i = 3; i <= best_len; i++) {
+            // use update_hash_roll for deflate_slow
+            hash = update_hash_roll(hash, scan[i]);
             /* If we're starting with best_len >= 3, we can use offset search. */
-            pos = s->head[hash];
+            pos = head[hash];
             if (pos < cur_match) {
-                match_offset = (Pos)(i - 2);
+                match_offset = i - 2;
                 cur_match = pos;
             }
         }
@@ -138,39 +129,28 @@ Z_INTERNAL uint32_t LONGEST_MATCH(deflate_state *const s, Pos cur_match) {
          * that depend on those values. However the length of the match is limited to the
          * lookahead, so the output of deflate is not affected by the uninitialized values.
          */
-#ifdef UNALIGNED_OK
         if (best_len < sizeof(uint32_t)) {
             for (;;) {
-                if (zng_memcmp_2(mbase_end+cur_match, scan_end) == 0 &&
-                    zng_memcmp_2(mbase_start+cur_match, scan_start) == 0)
+                if (zng_memcmp_2(mbase_end+cur_match, &scan_end) == 0 &&
+                    zng_memcmp_2(mbase_start+cur_match, &scan_start) == 0)
                     break;
                 GOTO_NEXT_CHAIN;
             }
-#  ifdef UNALIGNED64_OK
         } else if (best_len >= sizeof(uint64_t)) {
             for (;;) {
-                if (zng_memcmp_8(mbase_end+cur_match, scan_end) == 0 &&
-                    zng_memcmp_8(mbase_start+cur_match, scan_start) == 0)
+                if (zng_memcmp_8(mbase_end+cur_match, &scan_end) == 0 &&
+                    zng_memcmp_8(mbase_start+cur_match, &scan_start) == 0)
                     break;
                 GOTO_NEXT_CHAIN;
             }
-#  endif
         } else {
             for (;;) {
-                if (zng_memcmp_4(mbase_end+cur_match, scan_end) == 0 &&
-                    zng_memcmp_4(mbase_start+cur_match, scan_start) == 0)
+                if (zng_memcmp_4(mbase_end+cur_match, &scan_end) == 0 &&
+                    zng_memcmp_4(mbase_start+cur_match, &scan_start) == 0)
                     break;
                 GOTO_NEXT_CHAIN;
             }
         }
-#else
-        for (;;) {
-            if (mbase_end[cur_match] == scan_end[0] && mbase_end[cur_match+1] == scan_end[1] &&
-                mbase_start[cur_match] == scan[0] && mbase_start[cur_match+1] == scan[1])
-                break;
-            GOTO_NEXT_CHAIN;
-        }
-#endif
         uint32_t len = COMPARE256(scan+2, mbase_start+cur_match+2) + 2;
         Assert(scan+len <= window+(unsigned)(s->window_size-1), "wild scan");
 
@@ -178,52 +158,44 @@ Z_INTERNAL uint32_t LONGEST_MATCH(deflate_state *const s, Pos cur_match) {
             uint32_t match_start = cur_match - match_offset;
             s->match_start = match_start;
 
-            /* Do not look for matches beyond the end of the input. */
-            if (len > lookahead)
+            /* Do not look for better matches if the current match reaches
+             * or exceeds the end of the input.
+             */
+            if (len >= lookahead)
                 return lookahead;
+            if (len >= nice_match)
+                return len;
+
             best_len = len;
-            if (best_len >= nice_match)
-                return best_len;
 
             offset = best_len-1;
-#ifdef UNALIGNED_OK
             if (best_len >= sizeof(uint32_t)) {
                 offset -= 2;
-#ifdef UNALIGNED64_OK
                 if (best_len >= sizeof(uint64_t))
                     offset -= 4;
-#endif
             }
-#endif
 
-#ifdef UNALIGNED64_OK
-            memcpy(scan_end, scan+offset, sizeof(uint64_t));
-#elif defined(UNALIGNED_OK)
-            memcpy(scan_end, scan+offset, sizeof(uint32_t));
-#else
-            scan_end[0] = *(scan+offset);
-            scan_end[1] = *(scan+offset+1);
-#endif
+            scan_end = zng_memread_8(scan+offset);
 
 #ifdef LONGEST_MATCH_SLOW
             /* Look for a better string offset */
             if (UNLIKELY(len > STD_MIN_MATCH && match_start + len < strstart)) {
-                Pos pos, next_pos;
-                uint32_t i, hash;
-                unsigned char *scan_endstr;
+                const unsigned char *scan_endstr;
+                uint32_t hash;
+                uint32_t pos, next_pos;
 
                 /* Go back to offset 0 */
                 cur_match -= match_offset;
                 match_offset = 0;
                 next_pos = cur_match;
-                for (i = 0; i <= len - STD_MIN_MATCH; i++) {
+                for (uint32_t i = 0; i <= len - STD_MIN_MATCH; i++) {
                     pos = prev[(cur_match + i) & wmask];
                     if (pos < next_pos) {
                         /* Hash chain is more distant, use it */
                         if (pos <= limit_base + i)
                             goto break_matching;
                         next_pos = pos;
-                        match_offset = (Pos)i;
+                        match_offset = i;
                     }
                 }
                 /* Switch cur_match to next_pos chain */
@@ -236,13 +208,14 @@ Z_INTERNAL uint32_t LONGEST_MATCH(deflate_state *const s, Pos cur_match) {
                  */
                 scan_endstr = scan + len - (STD_MIN_MATCH+1);
 
-                hash = s->update_hash(0, scan_endstr[0]);
-                hash = s->update_hash(hash, scan_endstr[1]);
-                hash = s->update_hash(hash, scan_endstr[2]);
+                // use update_hash_roll for deflate_slow
+                hash = update_hash_roll(0, scan_endstr[0]);
+                hash = update_hash_roll(hash, scan_endstr[1]);
+                hash = update_hash_roll(hash, scan_endstr[2]);
 
-                pos = s->head[hash];
+                pos = head[hash];
                 if (pos < cur_match) {
-                    match_offset = (Pos)(len - (STD_MIN_MATCH+1));
+                    match_offset = len - (STD_MIN_MATCH+1);
                     if (pos <= limit_base + match_offset)
                         goto break_matching;
                     cur_match = pos;
@@ -272,13 +245,12 @@ Z_INTERNAL uint32_t LONGEST_MATCH(deflate_state *const s, Pos cur_match) {
 #ifdef LONGEST_MATCH_SLOW
 break_matching:
 
-    if (best_len < s->lookahead)
+    if (best_len < lookahead)
         return best_len;
 
-    return s->lookahead;
+    return lookahead;
 #endif
 }
 
 #undef LONGEST_MATCH_SLOW
 #undef LONGEST_MATCH
-#undef COMPARE256
diff --git a/test/CMakeLists.txt b/test/CMakeLists.txt
index 70c5b544..37c649d6 100644
--- a/test/CMakeLists.txt
+++ b/test/CMakeLists.txt
@@ -1,5 +1,3 @@
-cmake_minimum_required(VERSION 3.5.1)
-
 macro(configure_test_executable target)
     target_include_directories(${target} PRIVATE ${PROJECT_BINARY_DIR} ${PROJECT_SOURCE_DIR})
     set_target_properties(${target} PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR})
@@ -9,21 +7,21 @@ macro(configure_test_executable target)
     endif()
 endmacro()
 
-if(ZLIBNG_ENABLE_TESTS)
-    add_definitions(-DZLIBNG_ENABLE_TESTS)
+if(TEST_STOCK_ZLIB)
+    add_definitions(-DTEST_STOCK_ZLIB)
 endif()
 
 add_executable(example example.c)
 configure_test_executable(example)
-target_link_libraries(example zlib)
+target_link_libraries(example zlib-ng)
 add_test(NAME example COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:example>)
 
 add_executable(minigzip minigzip.c)
 configure_test_executable(minigzip)
 if(NOT DEFINED BUILD_SHARED_LIBS)
-    target_link_libraries(minigzip zlibstatic)
+    target_link_libraries(minigzip zlib-ng-static)
 else()
-    target_link_libraries(minigzip zlib)
+    target_link_libraries(minigzip zlib-ng)
 endif()
 if(BASEARCH_S360_FOUND)
     if(WITH_DFLTCC_DEFLATE OR WITH_DFLTCC_INFLATE)
@@ -34,7 +32,7 @@ set(MINIGZIP_COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:minigzip>)
 
 add_executable(minideflate minideflate.c)
 configure_test_executable(minideflate)
-target_link_libraries(minideflate zlib)
+target_link_libraries(minideflate zlib-ng)
 set(MINIDEFLATE_COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:minideflate>)
 
 if(INSTALL_UTILS)
@@ -46,19 +44,16 @@ endif()
 
 add_executable(switchlevels switchlevels.c)
 configure_test_executable(switchlevels)
-target_link_libraries(switchlevels zlib)
+target_link_libraries(switchlevels zlib-ng)
 set(SWITCHLEVELS_COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:switchlevels>)
 
 add_executable(infcover infcover.c)
 configure_test_executable(infcover)
-target_link_libraries(infcover zlib)
+target_link_libraries(infcover zlib-ng)
 if(NOT DEFINED BUILD_SHARED_LIBS OR BUILD_SHARED_LIBS)
     target_sources(infcover PRIVATE ${PROJECT_SOURCE_DIR}/inftrees.c)
 endif()
-# infcover references zng_inflate_table() and struct inflate_state, which are internal to zlib-ng.
-if(ZLIBNG_ENABLE_TESTS)
-    add_test(NAME infcover COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:infcover>)
-endif()
+add_test(NAME infcover COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:infcover>)
 
 add_executable(makefixed ${PROJECT_SOURCE_DIR}/tools/makefixed.c ${PROJECT_SOURCE_DIR}/inftrees.c)
 configure_test_executable(makefixed)
@@ -92,22 +87,20 @@ if(WITH_FUZZERS)
     add_subdirectory(fuzz)
 endif()
 
-if(WITH_GTEST OR WITH_BENCHMARKS)
-    if(CMAKE_VERSION VERSION_LESS 3.12)
-        message(WARNING "Minimum cmake version of 3.12 not met for Google benchmark!")
-        set(WITH_BENCHMARKS OFF)
-        set(WITH_BENCHMARKS OFF PARENT_SCOPE)
-    endif()
-    enable_language(CXX)
-endif()
-
 if(WITH_BENCHMARKS)
     add_subdirectory(benchmarks)
 endif()
 
 if(WITH_GTEST)
     # Google test requires at least C++11
-    set(CMAKE_CXX_STANDARD 11)
+    if(NOT DEFINED CMAKE_CXX_STANDARD)
+        # Use older version of Google test to support older versions of GCC
+        if (CMAKE_CXX_COMPILER_ID MATCHES "GNU" AND CMAKE_CXX_COMPILER_VERSION VERSION_LESS_EQUAL 5.3)
+            set(CMAKE_CXX_STANDARD 11)
+        else()
+            set(CMAKE_CXX_STANDARD 14)
+        endif()
+    endif()
 
     # Google test requires MSAN instrumented LLVM C++ libraries
     if(WITH_SANITIZER STREQUAL "Memory")
@@ -122,7 +115,7 @@ if(WITH_GTEST)
         find_package(GTest)
     endif()
 
-    if(NOT TARGET GTest::GTest AND NOT CMAKE_VERSION VERSION_LESS 3.11)
+    if(NOT TARGET GTest::GTest)
         include(FetchContent)
 
         # Prevent overriding the parent project's compiler/linker settings for Windows
@@ -138,7 +131,7 @@ if(WITH_GTEST)
             if (CMAKE_CXX_COMPILER_ID MATCHES "GNU" AND CMAKE_CXX_COMPILER_VERSION VERSION_LESS_EQUAL 5.3)
                 set(GTEST_TAG release-1.10.0)
             else()
-                set(GTEST_TAG release-1.12.1)
+                set(GTEST_TAG v1.16.0)
             endif()
         endif()
 
@@ -146,13 +139,10 @@ if(WITH_GTEST)
         message(STATUS "Git checking out GoogleTest ${GTEST_TAG}")
         FetchContent_Declare(googletest
             GIT_REPOSITORY ${GTEST_REPOSITORY}
-            GIT_TAG ${GTEST_TAG})
+            GIT_TAG ${GTEST_TAG}
+            ${ZNG_FetchContent_Declare_EXCLUDE_FROM_ALL})
 
-        FetchContent_GetProperties(googletest)
-        if(NOT googletest_POPULATED)
-            FetchContent_Populate(googletest)
-            add_subdirectory(${googletest_SOURCE_DIR} ${googletest_BINARY_DIR} EXCLUDE_FROM_ALL)
-        endif()
+        ZNG_FetchContent_MakeAvailable(googletest)
         add_library(GTest::GTest ALIAS gtest)
         add_library(GTest::Main ALIAS gtest_main)
     endif()
@@ -186,21 +176,32 @@ if(WITH_GTEST)
             list(APPEND TEST_SRCS test_gzio.cc)
         endif()
 
-        if(ZLIBNG_ENABLE_TESTS)
+        if(NOT TEST_STOCK_ZLIB)
             list(APPEND TEST_SRCS
-                test_adler32.cc             # adler32_neon(), etc
-                test_compare256.cc          # compare256_neon(), etc
-                test_compare256_rle.cc      # compare256_rle(), etc
-                test_crc32.cc               # crc32_acle(), etc
-                test_inflate_sync.cc        # expects a certain compressed block layout
-                test_main.cc                # cpu_check_features()
-                test_version.cc             # expects a fixed version string
+                test_adler32.cc               # adler32_neon(), etc
+                test_adler32_copy.cc          # adler32_copy implementations
+                test_compare256.cc            # compare256_neon(), etc
+                test_compare256_rle.cc        # compare256_rle(), etc
+                test_crc32.cc                 # crc32_armv8(), etc
+                test_crc32_copy.cc            # crc32_copy implementations
+                test_deflate_deterministic.cc # deterministic output after deflateReset
+                test_inflate_sync.cc          # expects a certain compressed block layout
+                test_main.cc                  # cpu_check_features()
+                test_version.cc               # expects a fixed version string
                 )
         endif()
 
         add_executable(gtest_zlib ${TEST_SRCS})
         configure_test_executable(gtest_zlib)
 
+        if(MSVC)
+            target_compile_options(gtest_zlib PRIVATE /wd4389 /EHsc)
+        endif()
+
+        if(CMAKE_SYSTEM_NAME STREQUAL "FreeBSD")
+            target_compile_options(gtest_zlib PRIVATE -D_XOPEN_SOURCE=700)
+        endif()
+
         if(WITH_SANITIZER STREQUAL "Memory")
             target_link_directories(gtest_zlib PRIVATE $ENV{LLVM_BUILD_DIR}/lib)
             target_link_options(gtest_zlib PRIVATE
@@ -232,9 +233,9 @@ if(WITH_GTEST)
 
         if(NOT DEFINED BUILD_SHARED_LIBS)
             # Link statically in order to test internal zlib-ng functions.
-            target_link_libraries(gtest_zlib zlibstatic)
+            target_link_libraries(gtest_zlib zlib-ng-static)
         else()
-            target_link_libraries(gtest_zlib zlib)
+            target_link_libraries(gtest_zlib zlib-ng)
         endif()
 
         if(BUILD_SHARED_LIBS)
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-aarch64-unknown-linux-gnu.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-aarch64-unknown-linux-gnu.abi
index c9088b86..cabe2816 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-aarch64-unknown-linux-gnu.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-aarch64-unknown-linux-gnu.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-arm-aarch64' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-arm-aarch64' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
     <dependency name='ld-linux-aarch64.so.1'/>
@@ -95,54 +95,54 @@
   </elf-function-symbols>
   <abi-instr address-size='64' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/aarch64-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-5'/>
+    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/aarch64-linux-gnu/include/bits/types.h' line='152' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-5' filepath='/usr/aarch64-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/aarch64-linux-gnu/include/sys/types.h' line='85' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc-cross/aarch64-linux-gnu/13/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-11' filepath='./zconf.h' line='399' column='1' id='type-id-12'/>
+    <typedef-decl name='uLong' type-id='type-id-9' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
     <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-3'/>
-    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-4'/>
-    <typedef-decl name='z_size_t' type-id='type-id-5' filepath='./zconf.h' line='251' column='1' id='type-id-6'/>
-    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-7'/>
-    <typedef-decl name='uInt' type-id='type-id-3' filepath='./zconf.h' line='399' column='1' id='type-id-8'/>
-    <typedef-decl name='uLong' type-id='type-id-4' filepath='./zconf.h' line='400' column='1' id='type-id-9'/>
-    <typedef-decl name='Bytef' type-id='type-id-7' filepath='./zconf.h' line='406' column='1' id='type-id-10'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/aarch64-linux-gnu/include/bits/types.h' line='152' column='1' id='type-id-11'/>
-    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/aarch64-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-12'/>
-    <typedef-decl name='off_t' type-id='type-id-11' filepath='/usr/aarch64-linux-gnu/include/sys/types.h' line='85' column='1' id='type-id-13'/>
-    <typedef-decl name='off64_t' type-id='type-id-12' filepath='/usr/aarch64-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-14'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc-cross/aarch64-linux-gnu/11/include/stddef.h' line='209' column='1' id='type-id-5'/>
-    <qualified-type-def type-id='type-id-10' const='yes' id='type-id-15'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-11'/>
+    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-9'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
     <pointer-type-def type-id='type-id-15' size-in-bits='64' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='uLongf' type-id='type-id-9' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
     <pointer-type-def type-id='type-id-17' size-in-bits='64' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compress2'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
@@ -150,131 +150,145 @@
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='z_crc_t' type-id='type-id-3' filepath='./zconf.h' line='435' column='1' id='type-id-21'/>
-    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-22'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='64' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-21' const='yes' id='type-id-24'/>
+    <typedef-decl name='z_crc_t' type-id='type-id-11' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
     <pointer-type-def type-id='type-id-24' size-in-bits='64' id='type-id-25'/>
+    <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
+    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-27'/>
     <function-decl name='get_crc_table' mangled-name='get_crc_table' filepath='src.d/crc32.c' line='595' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='get_crc_table'>
-      <return type-id='type-id-25'/>
+      <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
-      <parameter type-id='type-id-23' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
-      <parameter type-id='type-id-23' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-9' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='char' size-in-bits='8' id='type-id-26'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-27'/>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='1248' id='type-id-29'>
-      <subrange length='39' type-id='type-id-4' id='type-id-30'/>
+    <type-decl name='char' size-in-bits='8' id='type-id-28'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-31'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='18336' id='type-id-31'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='1952' id='type-id-33'>
-      <subrange length='61' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-35'/>
     </array-type-def>
     <type-decl name='int' size-in-bits='32' id='type-id-20'/>
-    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-35'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-36' size-in-bits='4584' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-38'/>
-    <array-type-def dimensions='1' type-id='type-id-39' size-in-bits='256' id='type-id-40'>
-      <subrange length='16' type-id='type-id-4' id='type-id-41'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-42'/>
-    <typedef-decl name='charf' type-id='type-id-26' filepath='./zconf.h' line='408' column='1' id='type-id-43'/>
-    <typedef-decl name='voidpf' type-id='type-id-44' filepath='./zconf.h' line='415' column='1' id='type-id-45'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-28'>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-46'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-39'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-47'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-28' filepath='src.d/deflate.h' line='77' column='1' id='type-id-48'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-27' filepath='src.d/deflate.h' line='84' column='1' id='type-id-49'/>
-    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-50'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='extra_len' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='extra_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='name_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='448'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='512'>
+        <var-decl name='comm_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='544'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='576'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-39' filepath='src.d/deflate.h' line='92' column='1' id='type-id-53'/>
-    <typedef-decl name='Posf' type-id='type-id-53' filepath='src.d/deflate.h' line='93' column='1' id='type-id-54'/>
-    <typedef-decl name='IPos' type-id='type-id-3' filepath='src.d/deflate.h' line='94' column='1' id='type-id-55'/>
-    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-56'>
+    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-40'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
         <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
@@ -283,94 +297,94 @@
         <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='pending_buf_size' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
         <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='pending' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
         <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='gzhead' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='gzindex' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='method' type-id='type-id-7' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
         <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='w_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='w_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='w_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
         <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='window_size' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='prev' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='head' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='ins_h' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='hash_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='hash_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='hash_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='hash_shift' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1216'>
         <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1280'>
-        <var-decl name='match_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1312'>
-        <var-decl name='prev_match' type-id='type-id-55' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1344'>
         <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1376'>
-        <var-decl name='strstart' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1408'>
-        <var-decl name='match_start' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1440'>
-        <var-decl name='lookahead' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1472'>
-        <var-decl name='prev_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1504'>
-        <var-decl name='max_chain_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1536'>
-        <var-decl name='max_lazy_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1568'>
         <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
@@ -379,34 +393,34 @@
         <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1632'>
-        <var-decl name='good_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1664'>
         <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1696'>
-        <var-decl name='dyn_ltree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='20032'>
-        <var-decl name='dyn_dtree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21984'>
-        <var-decl name='bl_tree' type-id='type-id-29' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23232'>
-        <var-decl name='l_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23424'>
-        <var-decl name='d_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23616'>
-        <var-decl name='bl_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23808'>
-        <var-decl name='bl_count' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='24064'>
-        <var-decl name='heap' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42400'>
         <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
@@ -415,234 +429,225 @@
         <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42464'>
-        <var-decl name='depth' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47104'>
-        <var-decl name='sym_buf' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47168'>
-        <var-decl name='lit_bufsize' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47200'>
-        <var-decl name='sym_next' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47232'>
-        <var-decl name='sym_end' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47296'>
-        <var-decl name='opt_len' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47360'>
-        <var-decl name='static_len' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47424'>
-        <var-decl name='matches' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47456'>
-        <var-decl name='insert' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47488'>
-        <var-decl name='bi_buf' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47520'>
         <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47552'>
-        <var-decl name='high_water' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='deflate_state' type-id='type-id-56' filepath='src.d/deflate.h' line='271' column='1' id='type-id-62'/>
-    <typedef-decl name='alloc_func' type-id='type-id-63' filepath='src.d/zlib.h' line='81' column='1' id='type-id-64'/>
-    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-66'/>
-    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-67'>
+    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-45'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='dyn_tree' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='stat_desc' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      </data-member>
+    </class-decl>
+    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-52'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='avail_in' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='total_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='avail_out' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='total_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
+        <var-decl name='msg' type-id='type-id-53' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='state' type-id='type-id-69' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
+        <var-decl name='state' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='zalloc' type-id='type-id-64' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='zfree' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
+        <var-decl name='zfree' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='opaque' type-id='type-id-45' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
+        <var-decl name='opaque' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
         <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='adler' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='reserved' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-67' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
-    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-57'/>
-    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-72'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='time' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='extra_len' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='extra_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='name_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+    <typedef-decl name='IPos' type-id='type-id-11' filepath='src.d/deflate.h' line='94' column='1' id='type-id-44'/>
+    <typedef-decl name='Pos' type-id='type-id-49' filepath='src.d/deflate.h' line='92' column='1' id='type-id-58'/>
+    <typedef-decl name='Posf' type-id='type-id-58' filepath='src.d/deflate.h' line='93' column='1' id='type-id-59'/>
+    <typedef-decl name='alloc_func' type-id='type-id-60' filepath='src.d/zlib.h' line='81' column='1' id='type-id-55'/>
+    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-61'/>
+    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-62'/>
+    <typedef-decl name='deflate_state' type-id='type-id-40' filepath='src.d/deflate.h' line='271' column='1' id='type-id-63'/>
+    <typedef-decl name='free_func' type-id='type-id-64' filepath='src.d/zlib.h' line='82' column='1' id='type-id-56'/>
+    <typedef-decl name='gz_header' type-id='type-id-39' filepath='src.d/zlib.h' line='129' column='1' id='type-id-65'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-66' filepath='src.d/zlib.h' line='131' column='1' id='type-id-42'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-67'/>
+    <typedef-decl name='uchf' type-id='type-id-67' filepath='src.d/zutil.h' line='40' column='1' id='type-id-68'/>
+    <typedef-decl name='ulg' type-id='type-id-9' filepath='src.d/zutil.h' line='43' column='1' id='type-id-41'/>
+    <typedef-decl name='ush' type-id='type-id-69' filepath='src.d/zutil.h' line='41' column='1' id='type-id-49'/>
+    <typedef-decl name='z_stream' type-id='type-id-52' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
+    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-67' size-in-bits='4584' id='type-id-47'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='comm_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-37'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
       </data-member>
-    </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-72' filepath='src.d/zlib.h' line='129' column='1' id='type-id-73'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-74' filepath='src.d/zlib.h' line='131' column='1' id='type-id-59'/>
-    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-36'/>
-    <typedef-decl name='uchf' type-id='type-id-36' filepath='src.d/zutil.h' line='40' column='1' id='type-id-75'/>
-    <typedef-decl name='ush' type-id='type-id-38' filepath='src.d/zutil.h' line='41' column='1' id='type-id-39'/>
-    <typedef-decl name='ulg' type-id='type-id-4' filepath='src.d/zutil.h' line='43' column='1' id='type-id-58'/>
-    <pointer-type-def type-id='type-id-10' size-in-bits='64' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-54' size-in-bits='64' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-68'/>
-    <pointer-type-def type-id='type-id-43' size-in-bits='64' id='type-id-76'/>
-    <qualified-type-def type-id='type-id-26' const='yes' id='type-id-77'/>
-    <pointer-type-def type-id='type-id-77' size-in-bits='64' id='type-id-78'/>
-    <qualified-type-def type-id='type-id-49' const='yes' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-79' size-in-bits='64' id='type-id-52'/>
-    <pointer-type-def type-id='type-id-48' size-in-bits='64' id='type-id-51'/>
-    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-80'/>
-    <pointer-type-def type-id='type-id-73' size-in-bits='64' id='type-id-74'/>
-    <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-56' size-in-bits='64' id='type-id-69'/>
-    <pointer-type-def type-id='type-id-82' size-in-bits='64' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-8' size-in-bits='64' id='type-id-83'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='64' id='type-id-61'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='64' id='type-id-84'/>
-    <pointer-type-def type-id='type-id-85' size-in-bits='64' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-42' size-in-bits='64' id='type-id-44'/>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-69'/>
+    <array-type-def dimensions='1' type-id='type-id-49' size-in-bits='256' id='type-id-46'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-72'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='64' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-59' size-in-bits='64' id='type-id-43'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='64' id='type-id-53'/>
+    <pointer-type-def type-id='type-id-61' size-in-bits='64' id='type-id-73'/>
+    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-74'/>
+    <pointer-type-def type-id='type-id-74' size-in-bits='64' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-50'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='64' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-65' size-in-bits='64' id='type-id-66'/>
+    <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-40' size-in-bits='64' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-77' size-in-bits='64' id='type-id-60'/>
+    <pointer-type-def type-id='type-id-12' size-in-bits='64' id='type-id-78'/>
+    <pointer-type-def type-id='type-id-68' size-in-bits='64' id='type-id-48'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='64' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-80' size-in-bits='64' id='type-id-64'/>
     <pointer-type-def type-id='type-id-70' size-in-bits='64' id='type-id-71'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-27'/>
+    <qualified-type-def type-id='type-id-81' const='yes' id='type-id-82'/>
+    <pointer-type-def type-id='type-id-82' size-in-bits='64' id='type-id-51'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-83'/>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-57'/>
     <function-decl name='memcpy' filepath='/usr/aarch64-linux-gnu/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='memset' filepath='/usr/aarch64-linux-gnu/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
       <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
       <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-83' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <parameter type-id='type-id-78' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-59' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-42' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-84' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-81' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-79' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-76' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
       <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
       <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
       <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
@@ -650,198 +655,203 @@
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-9'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-20'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-57' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-57' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-83' filepath='src.d/deflate.h' line='84' column='1' id='type-id-81'/>
     <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-76'/>
-      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-73'/>
+      <parameter type-id='type-id-41'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-42'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-76'/>
-      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-73'/>
+      <parameter type-id='type-id-41'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-42'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-3'/>
-      <parameter type-id='type-id-3'/>
-      <return type-id='type-id-45'/>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-57'/>
     </function-decl>
     <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-45'/>
-      <return type-id='type-id-42'/>
-    </function-decl>
-    <function-type size-in-bits='64' id='type-id-82'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-8'/>
-      <parameter type-id='type-id-8'/>
-      <return type-id='type-id-45'/>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-57'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-85'/>
+    <pointer-type-def type-id='type-id-85' id='type-id-84'/>
+    <function-type size-in-bits='64' id='type-id-80'>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-57'/>
+      <return type-id='type-id-85'/>
     </function-type>
-    <function-type size-in-bits='64' id='type-id-85'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-45'/>
-      <return type-id='type-id-42'/>
+    <function-type size-in-bits='64' id='type-id-77'>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-57'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='gzFile' type-id='type-id-86' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-87'/>
-    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-88'>
+    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-86'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-3' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='next' type-id='type-id-89' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-87' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pos' type-id='type-id-14' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-88' size-in-bits='64' id='type-id-86'/>
+    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
+    <pointer-type-def type-id='type-id-86' size-in-bits='64' id='type-id-88'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87'/>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87'/>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='variadic parameter type' id='type-id-90'/>
-    <function-decl name='open' filepath='/usr/aarch64-linux-gnu/include/fcntl.h' line='181' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-78'/>
+    <function-decl name='open' filepath='/usr/aarch64-linux-gnu/include/fcntl.h' line='209' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-22'/>
       <parameter type-id='type-id-20'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='snprintf' filepath='/usr/aarch64-linux-gnu/include/stdio.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-68'/>
-      <parameter type-id='type-id-5'/>
-      <parameter type-id='type-id-78'/>
+    <function-decl name='snprintf' filepath='/usr/aarch64-linux-gnu/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-53'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
+    <function-decl name='malloc' filepath='/usr/aarch64-linux-gnu/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/aarch64-linux-gnu/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-84'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
     <function-decl name='strlen' filepath='/usr/aarch64-linux-gnu/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-78'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='lseek64' filepath='/usr/aarch64-linux-gnu/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-5'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-12'/>
+      <return type-id='type-id-5'/>
     </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-78' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-78' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdopen'>
       <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-3' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-11' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-14' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-14'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-13' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-13'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-81' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-78'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-76' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-85'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-90'/>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidp' type-id='type-id-44' filepath='./zconf.h' line='416' column='1' id='type-id-91'/>
-    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/aarch64-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-92'/>
-    <typedef-decl name='ssize_t' type-id='type-id-92' filepath='/usr/aarch64-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-93'/>
-    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-94' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-95'>
+    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-92'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='x' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+        <var-decl name='x' type-id='type-id-86' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
@@ -850,19 +860,19 @@
         <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='path' type-id='type-id-68' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+        <var-decl name='path' type-id='type-id-53' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='size' type-id='type-id-3' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+        <var-decl name='size' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='want' type-id='type-id-3' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+        <var-decl name='want' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='in' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+        <var-decl name='in' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='out' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+        <var-decl name='out' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
         <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
@@ -871,7 +881,7 @@
         <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='start' type-id='type-id-14' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
         <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
@@ -889,7 +899,7 @@
         <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='skip' type-id='type-id-14' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
         <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
@@ -898,27 +908,30 @@
         <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+        <var-decl name='msg' type-id='type-id-53' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
         <var-decl name='strm' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_state' type-id='type-id-95' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-94'/>
-    <typedef-decl name='gz_statep' type-id='type-id-96' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-97'/>
-    <pointer-type-def type-id='type-id-94' size-in-bits='64' id='type-id-96'/>
+    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/aarch64-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-93'/>
+    <typedef-decl name='gz_state' type-id='type-id-92' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-91'/>
+    <typedef-decl name='gz_statep' type-id='type-id-94' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-95'/>
+    <typedef-decl name='ssize_t' type-id='type-id-93' filepath='/usr/aarch64-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-96'/>
+    <pointer-type-def type-id='type-id-91' size-in-bits='64' id='type-id-94'/>
+    <typedef-decl name='voidp' type-id='type-id-84' filepath='./zconf.h' line='416' column='1' id='type-id-97'/>
     <function-decl name='__errno_location' filepath='/usr/aarch64-linux-gnu/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <return type-id='type-id-81'/>
+      <return type-id='type-id-76'/>
     </function-decl>
     <function-decl name='memchr' filepath='/usr/aarch64-linux-gnu/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='strerror' filepath='/usr/aarch64-linux-gnu/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-68'/>
+      <return type-id='type-id-53'/>
     </function-decl>
     <function-decl name='close' filepath='/usr/aarch64-linux-gnu/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
@@ -926,63 +939,83 @@
     </function-decl>
     <function-decl name='read' filepath='/usr/aarch64-linux-gnu/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-93'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
     </function-decl>
     <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-97'/>
+      <parameter type-id='type-id-95'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-78'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-91' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-91' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-68' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-53' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
       <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-68'/>
+      <return type-id='type-id-53'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <class-decl name='__va_list' size-in-bits='256' is-struct='yes' visibility='default' id='type-id-98'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='__stack' type-id='type-id-44' visibility='default'/>
+        <var-decl name='__stack' type-id='type-id-84' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='__gr_top' type-id='type-id-44' visibility='default'/>
+        <var-decl name='__gr_top' type-id='type-id-84' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='__vr_top' type-id='type-id-44' visibility='default'/>
+        <var-decl name='__vr_top' type-id='type-id-84' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='__gr_offs' type-id='type-id-20' visibility='default'/>
@@ -991,78 +1024,83 @@
         <var-decl name='__vr_offs' type-id='type-id-20' visibility='default'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='voidpc' type-id='type-id-44' filepath='./zconf.h' line='414' column='1' id='type-id-99'/>
-    <typedef-decl name='__gnuc_va_list' type-id='type-id-98' filepath='/usr/lib/gcc-cross/aarch64-linux-gnu/11/include/stdarg.h' line='40' column='1' id='type-id-100'/>
-    <typedef-decl name='va_list' type-id='type-id-100' filepath='/usr/lib/gcc-cross/aarch64-linux-gnu/11/include/stdarg.h' line='99' column='1' id='type-id-101'/>
-    <function-decl name='vsnprintf' filepath='/usr/aarch64-linux-gnu/include/stdio.h' line='382' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-68'/>
-      <parameter type-id='type-id-5'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-100'/>
+    <typedef-decl name='__gnuc_va_list' type-id='type-id-98' filepath='/usr/lib/gcc-cross/aarch64-linux-gnu/13/include/stdarg.h' line='40' column='1' id='type-id-99'/>
+    <typedef-decl name='va_list' type-id='type-id-99' filepath='/usr/lib/gcc-cross/aarch64-linux-gnu/13/include/stdarg.h' line='103' column='1' id='type-id-100'/>
+    <typedef-decl name='voidpc' type-id='type-id-84' filepath='./zconf.h' line='414' column='1' id='type-id-101'/>
+    <function-decl name='vsnprintf' filepath='/usr/aarch64-linux-gnu/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-53'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-99'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='memmove' filepath='/usr/aarch64-linux-gnu/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='write' filepath='/usr/aarch64-linux-gnu/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-93'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
     </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-99' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-101' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-99' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-101' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-78' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-78' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-101' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-100' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-78' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
       <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-102'/>
-    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-103' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-104'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-102' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-103'>
+      <underlying-type type-id='type-id-104'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-105' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-106'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
       </data-member>
@@ -1070,217 +1108,186 @@
         <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='val' type-id='type-id-38' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+        <var-decl name='val' type-id='type-id-69' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='code' type-id='type-id-104' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-103'/>
-    <enum-decl name='codetype' naming-typedef-id='type-id-105' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-106'>
-      <underlying-type type-id='type-id-102'/>
-      <enumerator name='CODES' value='0'/>
-      <enumerator name='LENS' value='1'/>
-      <enumerator name='DISTS' value='2'/>
-    </enum-decl>
-    <typedef-decl name='codetype' type-id='type-id-106' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-105'/>
+    <typedef-decl name='code' type-id='type-id-106' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-105'/>
+    <typedef-decl name='codetype' type-id='type-id-103' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-102'/>
     <typedef-decl name='in_func' type-id='type-id-107' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-108'/>
     <typedef-decl name='out_func' type-id='type-id-109' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-110'/>
-    <pointer-type-def type-id='type-id-103' size-in-bits='64' id='type-id-111'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-104'/>
+    <pointer-type-def type-id='type-id-105' size-in-bits='64' id='type-id-111'/>
     <pointer-type-def type-id='type-id-111' size-in-bits='64' id='type-id-112'/>
     <pointer-type-def type-id='type-id-113' size-in-bits='64' id='type-id-109'/>
-    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-89'/>
-    <pointer-type-def type-id='type-id-89' size-in-bits='64' id='type-id-114'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-87'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='64' id='type-id-114'/>
     <pointer-type-def type-id='type-id-115' size-in-bits='64' id='type-id-107'/>
-    <pointer-type-def type-id='type-id-38' size-in-bits='64' id='type-id-116'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='64' id='type-id-116'/>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-117'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-89' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-87' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
       <parameter type-id='type-id-108' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-44' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-84' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
       <parameter type-id='type-id-110' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-44' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <parameter type-id='type-id-84' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-57'/>
-      <parameter type-id='type-id-3'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-105'/>
+      <parameter type-id='type-id-102'/>
       <parameter type-id='type-id-116'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-11'/>
       <parameter type-id='type-id-112'/>
-      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-79'/>
       <parameter type-id='type-id-116'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-type size-in-bits='64' id='type-id-113'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-89'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-87'/>
+      <parameter type-id='type-id-11'/>
       <return type-id='type-id-20'/>
     </function-type>
     <function-type size-in-bits='64' id='type-id-115'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-114'/>
-      <return type-id='type-id-3'/>
+      <return type-id='type-id-11'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-118'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-83' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <parameter type-id='type-id-78' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-59' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-42' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-57' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
       <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
       <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
       <return type-id='type-id-1'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-4'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-9'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-117' size-in-bits='2048' id='type-id-118'>
-      <subrange length='256' type-id='type-id-4' id='type-id-119'/>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='2048' id='type-id-120'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-121'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-117' size-in-bits='4096' id='type-id-120'>
-      <subrange length='512' type-id='type-id-4' id='type-id-121'/>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='4096' id='type-id-122'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-123'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-117' size-in-bits='infinite' id='type-id-122'>
-      <subrange length='infinite' id='type-id-123'/>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='unknown' id='type-id-124'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-125'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-36' const='yes' id='type-id-117'/>
-    <var-decl name='_length_code' type-id='type-id-122' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <qualified-type-def type-id='type-id-67' const='yes' id='type-id-119'/>
+    <var-decl name='_length_code' type-id='type-id-120' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
     <var-decl name='_dist_code' type-id='type-id-122' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <pointer-type-def type-id='type-id-9' size-in-bits='64' id='type-id-124'/>
+    <pointer-type-def type-id='type-id-13' size-in-bits='64' id='type-id-126'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-124' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <parameter type-id='type-id-126' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-125' size-in-bits='640' id='type-id-126'>
-      <subrange length='10' type-id='type-id-4' id='type-id-127'/>
+    <array-type-def dimensions='1' type-id='type-id-127' size-in-bits='640' id='type-id-128'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-129'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-125'/>
-    <function-decl name='malloc' filepath='/usr/aarch64-linux-gnu/include/stdlib.h' line='540' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-decl name='free' filepath='/usr/aarch64-linux-gnu/include/stdlib.h' line='555' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <return type-id='type-id-42'/>
-    </function-decl>
+    <qualified-type-def type-id='type-id-53' const='yes' id='type-id-127'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-78'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-9'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zError'>
       <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-78'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-126' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-128' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-arm-unknown-linux-gnueabi.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-arm-unknown-linux-gnueabi.abi
index 48f8fb6b..13b6e332 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-arm-unknown-linux-gnueabi.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-arm-unknown-linux-gnueabi.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-arm' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-arm' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
     <dependency name='ld-linux.so.3'/>
@@ -94,75 +94,89 @@
     <elf-symbol name='zlibVersion' type='func-type' binding='global-binding' visibility='default-visibility' is-defined='yes'/>
   </elf-function-symbols>
   <abi-instr address-size='32' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='long int' size-in-bits='32' id='type-id-1'/>
-    <type-decl name='long long int' size-in-bits='64' id='type-id-2'/>
-    <type-decl name='unsigned char' size-in-bits='8' id='type-id-3'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-4'/>
-    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-5'/>
-    <typedef-decl name='z_size_t' type-id='type-id-6' filepath='./zconf.h' line='251' column='1' id='type-id-7'/>
-    <typedef-decl name='Byte' type-id='type-id-3' filepath='./zconf.h' line='397' column='1' id='type-id-8'/>
-    <typedef-decl name='uInt' type-id='type-id-4' filepath='./zconf.h' line='399' column='1' id='type-id-9'/>
-    <typedef-decl name='uLong' type-id='type-id-5' filepath='./zconf.h' line='400' column='1' id='type-id-10'/>
-    <typedef-decl name='Bytef' type-id='type-id-8' filepath='./zconf.h' line='406' column='1' id='type-id-11'/>
-    <typedef-decl name='__int64_t' type-id='type-id-2' filepath='/usr/arm-linux-gnueabi/include/bits/types.h' line='47' column='1' id='type-id-12'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/arm-linux-gnueabi/include/bits/types.h' line='152' column='1' id='type-id-13'/>
-    <typedef-decl name='__off64_t' type-id='type-id-12' filepath='/usr/arm-linux-gnueabi/include/bits/types.h' line='153' column='1' id='type-id-14'/>
-    <typedef-decl name='off_t' type-id='type-id-13' filepath='/usr/arm-linux-gnueabi/include/sys/types.h' line='85' column='1' id='type-id-15'/>
-    <typedef-decl name='off64_t' type-id='type-id-14' filepath='/usr/arm-linux-gnueabi/include/sys/types.h' line='92' column='1' id='type-id-16'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc-cross/arm-linux-gnueabi/11/include/stddef.h' line='209' column='1' id='type-id-6'/>
-    <qualified-type-def type-id='type-id-11' const='yes' id='type-id-17'/>
-    <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
+    <type-decl name='long long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__int64_t' type-id='type-id-1' filepath='/usr/arm-linux-gnueabi/include/bits/types.h' line='47' column='1' id='type-id-5'/>
+    <typedef-decl name='__off64_t' type-id='type-id-5' filepath='/usr/arm-linux-gnueabi/include/bits/types.h' line='153' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-6' filepath='/usr/arm-linux-gnueabi/include/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/arm-linux-gnueabi/include/sys/types.h' line='87' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc-cross/arm-linux-gnueabi/13/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-9' filepath='./zconf.h' line='399' column='1' id='type-id-11'/>
+    <typedef-decl name='uLong' type-id='type-id-12' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
+    <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-9'/>
+    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-12'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
+    <pointer-type-def type-id='type-id-15' size-in-bits='32' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
-      <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
-      <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='uLongf' type-id='type-id-10' filepath='./zconf.h' line='411' column='1' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-19' size-in-bits='32' id='type-id-20'/>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+    <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress2'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/compress.c' line='27' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compress' mangled-name='compress' filepath='src.d/compress.c' line='68' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='z_crc_t' type-id='type-id-4' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-3' const='yes' id='type-id-24'/>
+    <typedef-decl name='z_crc_t' type-id='type-id-9' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
     <pointer-type-def type-id='type-id-24' size-in-bits='32' id='type-id-25'/>
     <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
     <pointer-type-def type-id='type-id-26' size-in-bits='32' id='type-id-27'/>
@@ -170,1107 +184,1093 @@
       <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-12' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
       <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-12' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
       <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-10' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='char' size-in-bits='8' id='type-id-28'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1248' id='type-id-31'>
-      <subrange length='39' type-id='type-id-4' id='type-id-32'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='18336' id='type-id-33'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-31'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1952' id='type-id-35'>
-      <subrange length='61' type-id='type-id-4' id='type-id-36'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='int' size-in-bits='32' id='type-id-22'/>
-    <array-type-def dimensions='1' type-id='type-id-22' size-in-bits='18336' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-35'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-38' size-in-bits='4584' id='type-id-39'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <type-decl name='int' size-in-bits='32' id='type-id-20'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-40'/>
-    <array-type-def dimensions='1' type-id='type-id-41' size-in-bits='256' id='type-id-42'>
-      <subrange length='16' type-id='type-id-4' id='type-id-43'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-44'/>
-    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-45'/>
-    <typedef-decl name='voidpf' type-id='type-id-46' filepath='./zconf.h' line='415' column='1' id='type-id-47'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-30'>
+    <type-decl name='long int' size-in-bits='32' id='type-id-37'/>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-48'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-40'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='32'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-49'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='96'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-30' filepath='src.d/deflate.h' line='77' column='1' id='type-id-50'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-29' filepath='src.d/deflate.h' line='84' column='1' id='type-id-51'/>
-    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-52'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-53' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='max_code' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='extra_len' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='stat_desc' type-id='type-id-54' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='224'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='name_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='comm_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='352'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-41' filepath='src.d/deflate.h' line='92' column='1' id='type-id-55'/>
-    <typedef-decl name='Posf' type-id='type-id-55' filepath='src.d/deflate.h' line='93' column='1' id='type-id-56'/>
-    <typedef-decl name='IPos' type-id='type-id-4' filepath='src.d/deflate.h' line='94' column='1' id='type-id-57'/>
-    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-58'>
+    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-41'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='status' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
+        <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pending_buf' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
+        <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='pending_buf_size' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pending_out' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
+        <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='pending' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='wrap' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
+        <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='gzhead' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='gzindex' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='method' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='last_flush' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
+        <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='w_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='w_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='w_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='window' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
+        <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='480'>
-        <var-decl name='window_size' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='prev' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='head' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='ins_h' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
-        <var-decl name='hash_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='hash_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='hash_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='hash_shift' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='736'>
-        <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
+        <var-decl name='block_start' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='match_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
-        <var-decl name='prev_match' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='match_available' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
+        <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='864'>
-        <var-decl name='strstart' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='match_start' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='928'>
-        <var-decl name='lookahead' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='prev_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='992'>
-        <var-decl name='max_chain_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='max_lazy_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='level' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='strategy' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='good_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='nice_match' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
+        <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1184'>
-        <var-decl name='dyn_ltree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='19520'>
-        <var-decl name='dyn_dtree' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21472'>
-        <var-decl name='bl_tree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22720'>
-        <var-decl name='l_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22816'>
-        <var-decl name='d_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22912'>
-        <var-decl name='bl_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23008'>
-        <var-decl name='bl_count' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23264'>
-        <var-decl name='heap' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41600'>
-        <var-decl name='heap_len' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
+        <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41632'>
-        <var-decl name='heap_max' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
+        <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41664'>
-        <var-decl name='depth' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46272'>
-        <var-decl name='sym_buf' type-id='type-id-63' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46304'>
-        <var-decl name='lit_bufsize' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46336'>
-        <var-decl name='sym_next' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46368'>
-        <var-decl name='sym_end' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46400'>
-        <var-decl name='opt_len' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46432'>
-        <var-decl name='static_len' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46464'>
-        <var-decl name='matches' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46496'>
-        <var-decl name='insert' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46528'>
-        <var-decl name='bi_buf' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46560'>
-        <var-decl name='bi_valid' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
+        <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46592'>
-        <var-decl name='high_water' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='deflate_state' type-id='type-id-58' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
-    <typedef-decl name='alloc_func' type-id='type-id-65' filepath='src.d/zlib.h' line='81' column='1' id='type-id-66'/>
-    <typedef-decl name='free_func' type-id='type-id-67' filepath='src.d/zlib.h' line='82' column='1' id='type-id-68'/>
-    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-69'>
+    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-46'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='next_in' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
+        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='avail_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='total_in' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='next_out' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='avail_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='total_out' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='msg' type-id='type-id-70' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='state' type-id='type-id-71' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='zalloc' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='zfree' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='opaque' type-id='type-id-47' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='data_type' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='adler' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='reserved' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-69' filepath='src.d/zlib.h' line='106' column='1' id='type-id-72'/>
-    <typedef-decl name='z_streamp' type-id='type-id-73' filepath='src.d/zlib.h' line='108' column='1' id='type-id-59'/>
-    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-74'>
+    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-53'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
+        <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='time' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='xflags' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='os' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
+        <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='extra' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='extra_len' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='name' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+        <var-decl name='state' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='name_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='comment' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+        <var-decl name='zfree' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='comm_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+        <var-decl name='opaque' type-id='type-id-58' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='hcrc' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+        <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='done' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='416'>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-74' filepath='src.d/zlib.h' line='129' column='1' id='type-id-75'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-76' filepath='src.d/zlib.h' line='131' column='1' id='type-id-61'/>
-    <typedef-decl name='uch' type-id='type-id-3' filepath='src.d/zutil.h' line='39' column='1' id='type-id-38'/>
-    <typedef-decl name='uchf' type-id='type-id-38' filepath='src.d/zutil.h' line='40' column='1' id='type-id-77'/>
-    <typedef-decl name='ush' type-id='type-id-40' filepath='src.d/zutil.h' line='41' column='1' id='type-id-41'/>
-    <typedef-decl name='ulg' type-id='type-id-5' filepath='src.d/zutil.h' line='43' column='1' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-21'/>
-    <pointer-type-def type-id='type-id-56' size-in-bits='32' id='type-id-62'/>
-    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-70'/>
-    <pointer-type-def type-id='type-id-45' size-in-bits='32' id='type-id-78'/>
-    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-79' size-in-bits='32' id='type-id-80'/>
-    <qualified-type-def type-id='type-id-51' const='yes' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-81' size-in-bits='32' id='type-id-54'/>
-    <pointer-type-def type-id='type-id-50' size-in-bits='32' id='type-id-53'/>
-    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-82'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-76'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='32' id='type-id-83'/>
-    <pointer-type-def type-id='type-id-58' size-in-bits='32' id='type-id-71'/>
-    <pointer-type-def type-id='type-id-84' size-in-bits='32' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-85'/>
-    <pointer-type-def type-id='type-id-77' size-in-bits='32' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-86'/>
-    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-67'/>
-    <pointer-type-def type-id='type-id-44' size-in-bits='32' id='type-id-46'/>
-    <pointer-type-def type-id='type-id-72' size-in-bits='32' id='type-id-73'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
+    <typedef-decl name='IPos' type-id='type-id-9' filepath='src.d/deflate.h' line='94' column='1' id='type-id-45'/>
+    <typedef-decl name='Pos' type-id='type-id-50' filepath='src.d/deflate.h' line='92' column='1' id='type-id-59'/>
+    <typedef-decl name='Posf' type-id='type-id-59' filepath='src.d/deflate.h' line='93' column='1' id='type-id-60'/>
+    <typedef-decl name='alloc_func' type-id='type-id-61' filepath='src.d/zlib.h' line='81' column='1' id='type-id-56'/>
+    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-62'/>
+    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-63'/>
+    <typedef-decl name='deflate_state' type-id='type-id-41' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
+    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-57'/>
+    <typedef-decl name='gz_header' type-id='type-id-40' filepath='src.d/zlib.h' line='129' column='1' id='type-id-66'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-67' filepath='src.d/zlib.h' line='131' column='1' id='type-id-43'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-68'/>
+    <typedef-decl name='uchf' type-id='type-id-68' filepath='src.d/zutil.h' line='40' column='1' id='type-id-69'/>
+    <typedef-decl name='ulg' type-id='type-id-12' filepath='src.d/zutil.h' line='43' column='1' id='type-id-42'/>
+    <typedef-decl name='ush' type-id='type-id-70' filepath='src.d/zutil.h' line='41' column='1' id='type-id-50'/>
+    <typedef-decl name='z_stream' type-id='type-id-53' filepath='src.d/zlib.h' line='106' column='1' id='type-id-71'/>
+    <typedef-decl name='z_streamp' type-id='type-id-72' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-68' size-in-bits='4584' id='type-id-48'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-39'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      </data-member>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      </data-member>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+      </data-member>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      </data-member>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-70'/>
+    <array-type-def dimensions='1' type-id='type-id-50' size-in-bits='256' id='type-id-47'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-73'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-60' size-in-bits='32' id='type-id-44'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='32' id='type-id-74'/>
+    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='32' id='type-id-51'/>
+    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-66' size-in-bits='32' id='type-id-67'/>
+    <pointer-type-def type-id='type-id-20' size-in-bits='32' id='type-id-77'/>
+    <pointer-type-def type-id='type-id-41' size-in-bits='32' id='type-id-55'/>
+    <pointer-type-def type-id='type-id-78' size-in-bits='32' id='type-id-61'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='32' id='type-id-49'/>
+    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-80'/>
+    <pointer-type-def type-id='type-id-81' size-in-bits='32' id='type-id-65'/>
+    <pointer-type-def type-id='type-id-71' size-in-bits='32' id='type-id-72'/>
+    <qualified-type-def type-id='type-id-82' const='yes' id='type-id-83'/>
+    <pointer-type-def type-id='type-id-83' size-in-bits='32' id='type-id-52'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-84'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-58'/>
     <function-decl name='memcpy' filepath='/usr/arm-linux-gnueabi/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='memset' filepath='/usr/arm-linux-gnueabi/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
-    </function-decl>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
-      <parameter type-id='type-id-22' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
-      <parameter type-id='type-id-22' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
+      <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
+      <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
-      <parameter type-id='type-id-18' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
+      <parameter type-id='type-id-11' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
-      <parameter type-id='type-id-21' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-85' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
+      <parameter type-id='type-id-79' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-61' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-86' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-83' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-80' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-77' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
-      <parameter type-id='type-id-22' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
-      <parameter type-id='type-id-22' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
+      <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
-      <parameter type-id='type-id-22' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
-      <parameter type-id='type-id-22' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
-      <parameter type-id='type-id-22' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
-      <parameter type-id='type-id-22' name='max_chain' filepath='src.d/deflate.c' line='659' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
+      <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
+      <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
+      <parameter type-id='type-id-20' name='max_chain' filepath='src.d/deflate.c' line='659' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-10'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-59' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-59' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-84' filepath='src.d/deflate.h' line='84' column='1' id='type-id-82'/>
     <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-60'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-60'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-4'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-47'/>
-    </function-decl>
-    <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-47'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-type size-in-bits='32' id='type-id-84'>
-      <parameter type-id='type-id-47'/>
+      <parameter type-id='type-id-58'/>
       <parameter type-id='type-id-9'/>
       <parameter type-id='type-id-9'/>
-      <return type-id='type-id-47'/>
+      <return type-id='type-id-58'/>
+    </function-decl>
+    <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-86'/>
+    <pointer-type-def type-id='type-id-86' id='type-id-85'/>
+    <function-type size-in-bits='32' id='type-id-81'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-86'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-87'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-47'/>
-      <return type-id='type-id-44'/>
+    <function-type size-in-bits='32' id='type-id-78'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-58'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
-    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-90'>
+    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-87'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-4' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='next' type-id='type-id-91' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-88' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pos' type-id='type-id-16' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-90' size-in-bits='32' id='type-id-88'/>
+    <typedef-decl name='gzFile' type-id='type-id-89' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-90'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-89'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-90'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-90'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='variadic parameter type' id='type-id-92'/>
-    <function-decl name='open' filepath='/usr/arm-linux-gnueabi/include/fcntl.h' line='181' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-80'/>
+    <function-decl name='snprintf' filepath='/usr/arm-linux-gnueabi/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
       <parameter type-id='type-id-22'/>
       <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='snprintf' filepath='/usr/arm-linux-gnueabi/include/stdio.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-70'/>
-      <parameter type-id='type-id-6'/>
-      <parameter type-id='type-id-80'/>
-      <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='malloc' filepath='/usr/arm-linux-gnueabi/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/arm-linux-gnueabi/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-85'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='strlen' filepath='/usr/arm-linux-gnueabi/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='lseek64' filepath='/usr/arm-linux-gnueabi/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-14'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-6'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-6'/>
     </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-80' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-80' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdopen'>
-      <parameter type-id='type-id-22' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-4' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-9' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-16' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
-      <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-15' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
-      <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-83' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-80'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-77' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-86'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-91'/>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidp' type-id='type-id-46' filepath='./zconf.h' line='416' column='1' id='type-id-93'/>
-    <typedef-decl name='__ssize_t' type-id='type-id-22' filepath='/usr/arm-linux-gnueabi/include/bits/types.h' line='194' column='1' id='type-id-94'/>
-    <typedef-decl name='ssize_t' type-id='type-id-94' filepath='/usr/arm-linux-gnueabi/include/sys/types.h' line='108' column='1' id='type-id-95'/>
-    <class-decl name='gz_state' size-in-bits='1344' is-struct='yes' naming-typedef-id='type-id-96' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-97'>
+    <class-decl name='gz_state' size-in-bits='1344' is-struct='yes' naming-typedef-id='type-id-92' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-93'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='x' type-id='type-id-90' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+        <var-decl name='x' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='mode' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
+        <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='fd' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
+        <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='path' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+        <var-decl name='path' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='size' type-id='type-id-4' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+        <var-decl name='size' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='want' type-id='type-id-4' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+        <var-decl name='want' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='in' type-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+        <var-decl name='in' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='out' type-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+        <var-decl name='out' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='direct' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
+        <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='how' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
+        <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='start' type-id='type-id-16' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='eof' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
+        <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='past' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='189' column='1'/>
+        <var-decl name='past' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='level' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='191' column='1'/>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
-        <var-decl name='strategy' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='192' column='1'/>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='192' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='reset' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
+        <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='skip' type-id='type-id-16' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='seek' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
+        <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
-        <var-decl name='err' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
+        <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='msg' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='864'>
-        <var-decl name='strm' type-id='type-id-72' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
+        <var-decl name='strm' type-id='type-id-71' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_state' type-id='type-id-97' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-96'/>
-    <typedef-decl name='gz_statep' type-id='type-id-98' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-99'/>
-    <pointer-type-def type-id='type-id-96' size-in-bits='32' id='type-id-98'/>
+    <typedef-decl name='__ssize_t' type-id='type-id-20' filepath='/usr/arm-linux-gnueabi/include/bits/types.h' line='194' column='1' id='type-id-94'/>
+    <typedef-decl name='gz_state' type-id='type-id-93' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-92'/>
+    <typedef-decl name='gz_statep' type-id='type-id-95' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-96'/>
+    <typedef-decl name='ssize_t' type-id='type-id-94' filepath='/usr/arm-linux-gnueabi/include/sys/types.h' line='108' column='1' id='type-id-97'/>
+    <pointer-type-def type-id='type-id-92' size-in-bits='32' id='type-id-95'/>
+    <typedef-decl name='voidp' type-id='type-id-85' filepath='./zconf.h' line='416' column='1' id='type-id-98'/>
     <function-decl name='__errno_location' filepath='/usr/arm-linux-gnueabi/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <return type-id='type-id-83'/>
+      <return type-id='type-id-77'/>
     </function-decl>
     <function-decl name='memchr' filepath='/usr/arm-linux-gnueabi/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='strerror' filepath='/usr/arm-linux-gnueabi/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-70'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-54'/>
     </function-decl>
     <function-decl name='close' filepath='/usr/arm-linux-gnueabi/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='read' filepath='/usr/arm-linux-gnueabi/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-95'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-97'/>
     </function-decl>
     <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-99'/>
+      <parameter type-id='type-id-96'/>
+      <parameter type-id='type-id-20'/>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-44'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-93' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-9' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-93' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-22' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-70' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
-      <parameter type-id='type-id-22' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-70'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-54' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
+      <return type-id='type-id-54'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <class-decl name='__va_list' size-in-bits='32' is-struct='yes' visibility='default' id='type-id-100'>
+    <class-decl name='__va_list' size-in-bits='32' is-struct='yes' visibility='default' id='type-id-99'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='__ap' type-id='type-id-46' visibility='default'/>
+        <var-decl name='__ap' type-id='type-id-85' visibility='default'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='voidpc' type-id='type-id-46' filepath='./zconf.h' line='414' column='1' id='type-id-101'/>
-    <typedef-decl name='__gnuc_va_list' type-id='type-id-100' filepath='/usr/lib/gcc-cross/arm-linux-gnueabi/11/include/stdarg.h' line='40' column='1' id='type-id-102'/>
-    <typedef-decl name='va_list' type-id='type-id-102' filepath='/usr/lib/gcc-cross/arm-linux-gnueabi/11/include/stdarg.h' line='99' column='1' id='type-id-103'/>
-    <function-decl name='vsnprintf' filepath='/usr/arm-linux-gnueabi/include/stdio.h' line='382' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-70'/>
-      <parameter type-id='type-id-6'/>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-102'/>
-      <return type-id='type-id-22'/>
+    <typedef-decl name='__gnuc_va_list' type-id='type-id-99' filepath='/usr/lib/gcc-cross/arm-linux-gnueabi/13/include/stdarg.h' line='40' column='1' id='type-id-100'/>
+    <typedef-decl name='va_list' type-id='type-id-100' filepath='/usr/lib/gcc-cross/arm-linux-gnueabi/13/include/stdarg.h' line='103' column='1' id='type-id-101'/>
+    <typedef-decl name='voidpc' type-id='type-id-85' filepath='./zconf.h' line='414' column='1' id='type-id-102'/>
+    <function-decl name='vsnprintf' filepath='/usr/arm-linux-gnueabi/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-100'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='memmove' filepath='/usr/arm-linux-gnueabi/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='write' filepath='/usr/arm-linux-gnueabi/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-95'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-97'/>
     </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-101' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-102' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-9' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-101' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-102' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
-      <parameter type-id='type-id-22' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-80' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-80' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-103' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-101' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-80' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-104'/>
-    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-105' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-106'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-103' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-104'>
+      <underlying-type type-id='type-id-105'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-106' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-107'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='op' type-id='type-id-3' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
+        <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='8'>
-        <var-decl name='bits' type-id='type-id-3' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
+        <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='val' type-id='type-id-40' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+        <var-decl name='val' type-id='type-id-70' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='code' type-id='type-id-106' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-105'/>
-    <enum-decl name='codetype' naming-typedef-id='type-id-107' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-108'>
-      <underlying-type type-id='type-id-104'/>
-      <enumerator name='CODES' value='0'/>
-      <enumerator name='LENS' value='1'/>
-      <enumerator name='DISTS' value='2'/>
-    </enum-decl>
-    <typedef-decl name='codetype' type-id='type-id-108' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-107'/>
-    <typedef-decl name='in_func' type-id='type-id-109' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-110'/>
-    <typedef-decl name='out_func' type-id='type-id-111' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-112'/>
-    <pointer-type-def type-id='type-id-105' size-in-bits='32' id='type-id-113'/>
-    <pointer-type-def type-id='type-id-113' size-in-bits='32' id='type-id-114'/>
-    <pointer-type-def type-id='type-id-115' size-in-bits='32' id='type-id-111'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='32' id='type-id-91'/>
-    <pointer-type-def type-id='type-id-91' size-in-bits='32' id='type-id-116'/>
-    <pointer-type-def type-id='type-id-117' size-in-bits='32' id='type-id-109'/>
-    <pointer-type-def type-id='type-id-40' size-in-bits='32' id='type-id-118'/>
+    <typedef-decl name='code' type-id='type-id-107' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-106'/>
+    <typedef-decl name='codetype' type-id='type-id-104' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-103'/>
+    <typedef-decl name='in_func' type-id='type-id-108' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-109'/>
+    <typedef-decl name='out_func' type-id='type-id-110' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-111'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-105'/>
+    <pointer-type-def type-id='type-id-106' size-in-bits='32' id='type-id-112'/>
+    <pointer-type-def type-id='type-id-112' size-in-bits='32' id='type-id-113'/>
+    <pointer-type-def type-id='type-id-114' size-in-bits='32' id='type-id-110'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='32' id='type-id-88'/>
+    <pointer-type-def type-id='type-id-88' size-in-bits='32' id='type-id-115'/>
+    <pointer-type-def type-id='type-id-116' size-in-bits='32' id='type-id-108'/>
+    <pointer-type-def type-id='type-id-70' size-in-bits='32' id='type-id-117'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-118'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-91' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/infback.c' line='32' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
+      <parameter type-id='type-id-88' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
-      <parameter type-id='type-id-110' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-46' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
-      <parameter type-id='type-id-112' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-46' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-109' name='in' filepath='src.d/infback.c' line='253' column='1'/>
+      <parameter type-id='type-id-85' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-111' name='out' filepath='src.d/infback.c' line='255' column='1'/>
+      <parameter type-id='type-id-85' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-59'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-9'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-107'/>
-      <parameter type-id='type-id-118'/>
-      <parameter type-id='type-id-4'/>
-      <parameter type-id='type-id-114'/>
-      <parameter type-id='type-id-86'/>
-      <parameter type-id='type-id-118'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-103'/>
+      <parameter type-id='type-id-117'/>
+      <parameter type-id='type-id-9'/>
+      <parameter type-id='type-id-113'/>
+      <parameter type-id='type-id-80'/>
+      <parameter type-id='type-id-117'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-type size-in-bits='32' id='type-id-115'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-91'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-22'/>
+    <function-type size-in-bits='32' id='type-id-114'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-88'/>
+      <parameter type-id='type-id-9'/>
+      <return type-id='type-id-20'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-117'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-116'/>
-      <return type-id='type-id-4'/>
+    <function-type size-in-bits='32' id='type-id-116'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-115'/>
+      <return type-id='type-id-9'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-119'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
-      <parameter type-id='type-id-22' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
-      <parameter type-id='type-id-22' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
+      <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
-      <parameter type-id='type-id-21' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-85' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
+      <parameter type-id='type-id-79' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
-      <parameter type-id='type-id-18' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
+      <parameter type-id='type-id-11' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-61' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-59' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
-      <parameter type-id='type-id-22' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
-      <parameter type-id='type-id-22' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
-      <return type-id='type-id-1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <return type-id='type-id-37'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-12'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='2048' id='type-id-120'>
-      <subrange length='256' type-id='type-id-4' id='type-id-121'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='2048' id='type-id-121'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-122'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='4096' id='type-id-122'>
-      <subrange length='512' type-id='type-id-4' id='type-id-123'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='4096' id='type-id-123'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-124'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='infinite' id='type-id-124'>
-      <subrange length='infinite' id='type-id-125'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='unknown' id='type-id-125'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-126'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-38' const='yes' id='type-id-119'/>
-    <var-decl name='_length_code' type-id='type-id-124' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
-    <var-decl name='_dist_code' type-id='type-id-124' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
+    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-120'/>
+    <var-decl name='_length_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <var-decl name='_dist_code' type-id='type-id-123' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <pointer-type-def type-id='type-id-10' size-in-bits='32' id='type-id-126'/>
+    <pointer-type-def type-id='type-id-13' size-in-bits='32' id='type-id-127'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-126' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
+      <parameter type-id='type-id-127' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-127' size-in-bits='320' id='type-id-128'>
-      <subrange length='10' type-id='type-id-4' id='type-id-129'/>
+    <array-type-def dimensions='1' type-id='type-id-128' size-in-bits='320' id='type-id-129'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-130'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-70' const='yes' id='type-id-127'/>
-    <function-decl name='malloc' filepath='/usr/arm-linux-gnueabi/include/stdlib.h' line='540' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
-    </function-decl>
-    <function-decl name='free' filepath='/usr/arm-linux-gnueabi/include/stdlib.h' line='555' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
+    <qualified-type-def type-id='type-id-54' const='yes' id='type-id-128'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-80'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-10'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zError'>
-      <parameter type-id='type-id-22' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-80'/>
+      <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-128' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-129' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-arm-unknown-linux-gnueabihf.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-arm-unknown-linux-gnueabihf.abi
index cee35ca4..620c5535 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-arm-unknown-linux-gnueabihf.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-arm-unknown-linux-gnueabihf.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-arm' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-arm' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
     <dependency name='ld-linux-armhf.so.3'/>
@@ -94,75 +94,89 @@
     <elf-symbol name='zlibVersion' type='func-type' binding='global-binding' visibility='default-visibility' is-defined='yes'/>
   </elf-function-symbols>
   <abi-instr address-size='32' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='long int' size-in-bits='32' id='type-id-1'/>
-    <type-decl name='long long int' size-in-bits='64' id='type-id-2'/>
-    <type-decl name='unsigned char' size-in-bits='8' id='type-id-3'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-4'/>
-    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-5'/>
-    <typedef-decl name='z_size_t' type-id='type-id-6' filepath='./zconf.h' line='251' column='1' id='type-id-7'/>
-    <typedef-decl name='Byte' type-id='type-id-3' filepath='./zconf.h' line='397' column='1' id='type-id-8'/>
-    <typedef-decl name='uInt' type-id='type-id-4' filepath='./zconf.h' line='399' column='1' id='type-id-9'/>
-    <typedef-decl name='uLong' type-id='type-id-5' filepath='./zconf.h' line='400' column='1' id='type-id-10'/>
-    <typedef-decl name='Bytef' type-id='type-id-8' filepath='./zconf.h' line='406' column='1' id='type-id-11'/>
-    <typedef-decl name='__int64_t' type-id='type-id-2' filepath='/usr/arm-linux-gnueabihf/include/bits/types.h' line='47' column='1' id='type-id-12'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/arm-linux-gnueabihf/include/bits/types.h' line='152' column='1' id='type-id-13'/>
-    <typedef-decl name='__off64_t' type-id='type-id-12' filepath='/usr/arm-linux-gnueabihf/include/bits/types.h' line='153' column='1' id='type-id-14'/>
-    <typedef-decl name='off_t' type-id='type-id-13' filepath='/usr/arm-linux-gnueabihf/include/sys/types.h' line='85' column='1' id='type-id-15'/>
-    <typedef-decl name='off64_t' type-id='type-id-14' filepath='/usr/arm-linux-gnueabihf/include/sys/types.h' line='92' column='1' id='type-id-16'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc-cross/arm-linux-gnueabihf/11/include/stddef.h' line='209' column='1' id='type-id-6'/>
-    <qualified-type-def type-id='type-id-11' const='yes' id='type-id-17'/>
-    <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
+    <type-decl name='long long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__int64_t' type-id='type-id-1' filepath='/usr/arm-linux-gnueabihf/include/bits/types.h' line='47' column='1' id='type-id-5'/>
+    <typedef-decl name='__off64_t' type-id='type-id-5' filepath='/usr/arm-linux-gnueabihf/include/bits/types.h' line='153' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-6' filepath='/usr/arm-linux-gnueabihf/include/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/arm-linux-gnueabihf/include/sys/types.h' line='87' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc-cross/arm-linux-gnueabihf/13/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-9' filepath='./zconf.h' line='399' column='1' id='type-id-11'/>
+    <typedef-decl name='uLong' type-id='type-id-12' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
+    <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-9'/>
+    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-12'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
+    <pointer-type-def type-id='type-id-15' size-in-bits='32' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
-      <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
-      <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='uLongf' type-id='type-id-10' filepath='./zconf.h' line='411' column='1' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-19' size-in-bits='32' id='type-id-20'/>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+    <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress2'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/compress.c' line='27' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compress' mangled-name='compress' filepath='src.d/compress.c' line='68' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='z_crc_t' type-id='type-id-4' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-3' const='yes' id='type-id-24'/>
+    <typedef-decl name='z_crc_t' type-id='type-id-9' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
     <pointer-type-def type-id='type-id-24' size-in-bits='32' id='type-id-25'/>
     <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
     <pointer-type-def type-id='type-id-26' size-in-bits='32' id='type-id-27'/>
@@ -170,1107 +184,1093 @@
       <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-12' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
       <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-12' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
       <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-10' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='char' size-in-bits='8' id='type-id-28'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1248' id='type-id-31'>
-      <subrange length='39' type-id='type-id-4' id='type-id-32'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='18336' id='type-id-33'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-31'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1952' id='type-id-35'>
-      <subrange length='61' type-id='type-id-4' id='type-id-36'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='int' size-in-bits='32' id='type-id-22'/>
-    <array-type-def dimensions='1' type-id='type-id-22' size-in-bits='18336' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-35'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-38' size-in-bits='4584' id='type-id-39'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <type-decl name='int' size-in-bits='32' id='type-id-20'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-40'/>
-    <array-type-def dimensions='1' type-id='type-id-41' size-in-bits='256' id='type-id-42'>
-      <subrange length='16' type-id='type-id-4' id='type-id-43'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-44'/>
-    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-45'/>
-    <typedef-decl name='voidpf' type-id='type-id-46' filepath='./zconf.h' line='415' column='1' id='type-id-47'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-30'>
+    <type-decl name='long int' size-in-bits='32' id='type-id-37'/>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-48'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-40'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='32'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-49'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='96'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-30' filepath='src.d/deflate.h' line='77' column='1' id='type-id-50'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-29' filepath='src.d/deflate.h' line='84' column='1' id='type-id-51'/>
-    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-52'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-53' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='max_code' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='extra_len' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='stat_desc' type-id='type-id-54' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='224'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='name_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='comm_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='352'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-41' filepath='src.d/deflate.h' line='92' column='1' id='type-id-55'/>
-    <typedef-decl name='Posf' type-id='type-id-55' filepath='src.d/deflate.h' line='93' column='1' id='type-id-56'/>
-    <typedef-decl name='IPos' type-id='type-id-4' filepath='src.d/deflate.h' line='94' column='1' id='type-id-57'/>
-    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-58'>
+    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-41'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='status' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
+        <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pending_buf' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
+        <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='pending_buf_size' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pending_out' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
+        <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='pending' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='wrap' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
+        <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='gzhead' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='gzindex' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='method' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='last_flush' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
+        <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='w_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='w_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='w_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='window' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
+        <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='480'>
-        <var-decl name='window_size' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='prev' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='head' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='ins_h' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
-        <var-decl name='hash_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='hash_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='hash_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='hash_shift' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='736'>
-        <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
+        <var-decl name='block_start' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='match_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
-        <var-decl name='prev_match' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='match_available' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
+        <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='864'>
-        <var-decl name='strstart' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='match_start' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='928'>
-        <var-decl name='lookahead' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='prev_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='992'>
-        <var-decl name='max_chain_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='max_lazy_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='level' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='strategy' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='good_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='nice_match' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
+        <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1184'>
-        <var-decl name='dyn_ltree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='19520'>
-        <var-decl name='dyn_dtree' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21472'>
-        <var-decl name='bl_tree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22720'>
-        <var-decl name='l_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22816'>
-        <var-decl name='d_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22912'>
-        <var-decl name='bl_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23008'>
-        <var-decl name='bl_count' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23264'>
-        <var-decl name='heap' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41600'>
-        <var-decl name='heap_len' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
+        <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41632'>
-        <var-decl name='heap_max' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
+        <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41664'>
-        <var-decl name='depth' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46272'>
-        <var-decl name='sym_buf' type-id='type-id-63' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46304'>
-        <var-decl name='lit_bufsize' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46336'>
-        <var-decl name='sym_next' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46368'>
-        <var-decl name='sym_end' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46400'>
-        <var-decl name='opt_len' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46432'>
-        <var-decl name='static_len' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46464'>
-        <var-decl name='matches' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46496'>
-        <var-decl name='insert' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46528'>
-        <var-decl name='bi_buf' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46560'>
-        <var-decl name='bi_valid' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
+        <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46592'>
-        <var-decl name='high_water' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='deflate_state' type-id='type-id-58' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
-    <typedef-decl name='alloc_func' type-id='type-id-65' filepath='src.d/zlib.h' line='81' column='1' id='type-id-66'/>
-    <typedef-decl name='free_func' type-id='type-id-67' filepath='src.d/zlib.h' line='82' column='1' id='type-id-68'/>
-    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-69'>
+    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-46'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='next_in' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
+        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='avail_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='total_in' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='next_out' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='avail_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='total_out' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='msg' type-id='type-id-70' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='state' type-id='type-id-71' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='zalloc' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='zfree' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='opaque' type-id='type-id-47' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='data_type' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='adler' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='reserved' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-69' filepath='src.d/zlib.h' line='106' column='1' id='type-id-72'/>
-    <typedef-decl name='z_streamp' type-id='type-id-73' filepath='src.d/zlib.h' line='108' column='1' id='type-id-59'/>
-    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-74'>
+    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-53'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
+        <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='time' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='xflags' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='os' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
+        <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='extra' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='extra_len' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='name' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+        <var-decl name='state' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='name_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='comment' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+        <var-decl name='zfree' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='comm_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+        <var-decl name='opaque' type-id='type-id-58' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='hcrc' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+        <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='done' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='416'>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-74' filepath='src.d/zlib.h' line='129' column='1' id='type-id-75'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-76' filepath='src.d/zlib.h' line='131' column='1' id='type-id-61'/>
-    <typedef-decl name='uch' type-id='type-id-3' filepath='src.d/zutil.h' line='39' column='1' id='type-id-38'/>
-    <typedef-decl name='uchf' type-id='type-id-38' filepath='src.d/zutil.h' line='40' column='1' id='type-id-77'/>
-    <typedef-decl name='ush' type-id='type-id-40' filepath='src.d/zutil.h' line='41' column='1' id='type-id-41'/>
-    <typedef-decl name='ulg' type-id='type-id-5' filepath='src.d/zutil.h' line='43' column='1' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-21'/>
-    <pointer-type-def type-id='type-id-56' size-in-bits='32' id='type-id-62'/>
-    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-70'/>
-    <pointer-type-def type-id='type-id-45' size-in-bits='32' id='type-id-78'/>
-    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-79' size-in-bits='32' id='type-id-80'/>
-    <qualified-type-def type-id='type-id-51' const='yes' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-81' size-in-bits='32' id='type-id-54'/>
-    <pointer-type-def type-id='type-id-50' size-in-bits='32' id='type-id-53'/>
-    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-82'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-76'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='32' id='type-id-83'/>
-    <pointer-type-def type-id='type-id-58' size-in-bits='32' id='type-id-71'/>
-    <pointer-type-def type-id='type-id-84' size-in-bits='32' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-85'/>
-    <pointer-type-def type-id='type-id-77' size-in-bits='32' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-86'/>
-    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-67'/>
-    <pointer-type-def type-id='type-id-44' size-in-bits='32' id='type-id-46'/>
-    <pointer-type-def type-id='type-id-72' size-in-bits='32' id='type-id-73'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
+    <typedef-decl name='IPos' type-id='type-id-9' filepath='src.d/deflate.h' line='94' column='1' id='type-id-45'/>
+    <typedef-decl name='Pos' type-id='type-id-50' filepath='src.d/deflate.h' line='92' column='1' id='type-id-59'/>
+    <typedef-decl name='Posf' type-id='type-id-59' filepath='src.d/deflate.h' line='93' column='1' id='type-id-60'/>
+    <typedef-decl name='alloc_func' type-id='type-id-61' filepath='src.d/zlib.h' line='81' column='1' id='type-id-56'/>
+    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-62'/>
+    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-63'/>
+    <typedef-decl name='deflate_state' type-id='type-id-41' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
+    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-57'/>
+    <typedef-decl name='gz_header' type-id='type-id-40' filepath='src.d/zlib.h' line='129' column='1' id='type-id-66'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-67' filepath='src.d/zlib.h' line='131' column='1' id='type-id-43'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-68'/>
+    <typedef-decl name='uchf' type-id='type-id-68' filepath='src.d/zutil.h' line='40' column='1' id='type-id-69'/>
+    <typedef-decl name='ulg' type-id='type-id-12' filepath='src.d/zutil.h' line='43' column='1' id='type-id-42'/>
+    <typedef-decl name='ush' type-id='type-id-70' filepath='src.d/zutil.h' line='41' column='1' id='type-id-50'/>
+    <typedef-decl name='z_stream' type-id='type-id-53' filepath='src.d/zlib.h' line='106' column='1' id='type-id-71'/>
+    <typedef-decl name='z_streamp' type-id='type-id-72' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-68' size-in-bits='4584' id='type-id-48'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-39'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      </data-member>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      </data-member>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+      </data-member>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      </data-member>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-70'/>
+    <array-type-def dimensions='1' type-id='type-id-50' size-in-bits='256' id='type-id-47'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-73'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-60' size-in-bits='32' id='type-id-44'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='32' id='type-id-74'/>
+    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='32' id='type-id-51'/>
+    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-66' size-in-bits='32' id='type-id-67'/>
+    <pointer-type-def type-id='type-id-20' size-in-bits='32' id='type-id-77'/>
+    <pointer-type-def type-id='type-id-41' size-in-bits='32' id='type-id-55'/>
+    <pointer-type-def type-id='type-id-78' size-in-bits='32' id='type-id-61'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='32' id='type-id-49'/>
+    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-80'/>
+    <pointer-type-def type-id='type-id-81' size-in-bits='32' id='type-id-65'/>
+    <pointer-type-def type-id='type-id-71' size-in-bits='32' id='type-id-72'/>
+    <qualified-type-def type-id='type-id-82' const='yes' id='type-id-83'/>
+    <pointer-type-def type-id='type-id-83' size-in-bits='32' id='type-id-52'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-84'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-58'/>
     <function-decl name='memcpy' filepath='/usr/arm-linux-gnueabihf/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='memset' filepath='/usr/arm-linux-gnueabihf/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
-    </function-decl>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
-      <parameter type-id='type-id-22' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
-      <parameter type-id='type-id-22' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
+      <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
+      <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
-      <parameter type-id='type-id-18' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
+      <parameter type-id='type-id-11' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
-      <parameter type-id='type-id-21' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-85' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
+      <parameter type-id='type-id-79' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-61' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-86' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-83' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-80' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-77' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
-      <parameter type-id='type-id-22' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
-      <parameter type-id='type-id-22' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
+      <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
-      <parameter type-id='type-id-22' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
-      <parameter type-id='type-id-22' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
-      <parameter type-id='type-id-22' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
-      <parameter type-id='type-id-22' name='max_chain' filepath='src.d/deflate.c' line='659' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
+      <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
+      <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
+      <parameter type-id='type-id-20' name='max_chain' filepath='src.d/deflate.c' line='659' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-10'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-59' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-59' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-84' filepath='src.d/deflate.h' line='84' column='1' id='type-id-82'/>
     <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-60'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-60'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-4'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-47'/>
-    </function-decl>
-    <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-47'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-type size-in-bits='32' id='type-id-84'>
-      <parameter type-id='type-id-47'/>
+      <parameter type-id='type-id-58'/>
       <parameter type-id='type-id-9'/>
       <parameter type-id='type-id-9'/>
-      <return type-id='type-id-47'/>
+      <return type-id='type-id-58'/>
+    </function-decl>
+    <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-86'/>
+    <pointer-type-def type-id='type-id-86' id='type-id-85'/>
+    <function-type size-in-bits='32' id='type-id-81'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-86'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-87'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-47'/>
-      <return type-id='type-id-44'/>
+    <function-type size-in-bits='32' id='type-id-78'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-58'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
-    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-90'>
+    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-87'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-4' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='next' type-id='type-id-91' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-88' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pos' type-id='type-id-16' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-90' size-in-bits='32' id='type-id-88'/>
+    <typedef-decl name='gzFile' type-id='type-id-89' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-90'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-89'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-90'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-90'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='variadic parameter type' id='type-id-92'/>
-    <function-decl name='open' filepath='/usr/arm-linux-gnueabihf/include/fcntl.h' line='181' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-80'/>
+    <function-decl name='snprintf' filepath='/usr/arm-linux-gnueabihf/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
       <parameter type-id='type-id-22'/>
       <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='snprintf' filepath='/usr/arm-linux-gnueabihf/include/stdio.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-70'/>
-      <parameter type-id='type-id-6'/>
-      <parameter type-id='type-id-80'/>
-      <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='malloc' filepath='/usr/arm-linux-gnueabihf/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/arm-linux-gnueabihf/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-85'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='strlen' filepath='/usr/arm-linux-gnueabihf/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='lseek64' filepath='/usr/arm-linux-gnueabihf/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-14'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-6'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-6'/>
     </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-80' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-80' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdopen'>
-      <parameter type-id='type-id-22' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-4' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-9' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-16' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
-      <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-15' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
-      <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-83' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-80'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-77' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-86'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-91'/>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidp' type-id='type-id-46' filepath='./zconf.h' line='416' column='1' id='type-id-93'/>
-    <typedef-decl name='__ssize_t' type-id='type-id-22' filepath='/usr/arm-linux-gnueabihf/include/bits/types.h' line='194' column='1' id='type-id-94'/>
-    <typedef-decl name='ssize_t' type-id='type-id-94' filepath='/usr/arm-linux-gnueabihf/include/sys/types.h' line='108' column='1' id='type-id-95'/>
-    <class-decl name='gz_state' size-in-bits='1344' is-struct='yes' naming-typedef-id='type-id-96' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-97'>
+    <class-decl name='gz_state' size-in-bits='1344' is-struct='yes' naming-typedef-id='type-id-92' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-93'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='x' type-id='type-id-90' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+        <var-decl name='x' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='mode' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
+        <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='fd' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
+        <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='path' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+        <var-decl name='path' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='size' type-id='type-id-4' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+        <var-decl name='size' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='want' type-id='type-id-4' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+        <var-decl name='want' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='in' type-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+        <var-decl name='in' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='out' type-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+        <var-decl name='out' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='direct' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
+        <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='how' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
+        <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='start' type-id='type-id-16' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='eof' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
+        <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='past' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='189' column='1'/>
+        <var-decl name='past' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='level' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='191' column='1'/>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
-        <var-decl name='strategy' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='192' column='1'/>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='192' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='reset' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
+        <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='skip' type-id='type-id-16' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='seek' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
+        <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
-        <var-decl name='err' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
+        <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='msg' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='864'>
-        <var-decl name='strm' type-id='type-id-72' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
+        <var-decl name='strm' type-id='type-id-71' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_state' type-id='type-id-97' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-96'/>
-    <typedef-decl name='gz_statep' type-id='type-id-98' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-99'/>
-    <pointer-type-def type-id='type-id-96' size-in-bits='32' id='type-id-98'/>
+    <typedef-decl name='__ssize_t' type-id='type-id-20' filepath='/usr/arm-linux-gnueabihf/include/bits/types.h' line='194' column='1' id='type-id-94'/>
+    <typedef-decl name='gz_state' type-id='type-id-93' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-92'/>
+    <typedef-decl name='gz_statep' type-id='type-id-95' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-96'/>
+    <typedef-decl name='ssize_t' type-id='type-id-94' filepath='/usr/arm-linux-gnueabihf/include/sys/types.h' line='108' column='1' id='type-id-97'/>
+    <pointer-type-def type-id='type-id-92' size-in-bits='32' id='type-id-95'/>
+    <typedef-decl name='voidp' type-id='type-id-85' filepath='./zconf.h' line='416' column='1' id='type-id-98'/>
     <function-decl name='__errno_location' filepath='/usr/arm-linux-gnueabihf/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <return type-id='type-id-83'/>
+      <return type-id='type-id-77'/>
     </function-decl>
     <function-decl name='memchr' filepath='/usr/arm-linux-gnueabihf/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='strerror' filepath='/usr/arm-linux-gnueabihf/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-70'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-54'/>
     </function-decl>
     <function-decl name='close' filepath='/usr/arm-linux-gnueabihf/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='read' filepath='/usr/arm-linux-gnueabihf/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-95'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-97'/>
     </function-decl>
     <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-99'/>
+      <parameter type-id='type-id-96'/>
+      <parameter type-id='type-id-20'/>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-44'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-93' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-9' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-93' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-22' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-70' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
-      <parameter type-id='type-id-22' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-70'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-54' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
+      <return type-id='type-id-54'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <class-decl name='__va_list' size-in-bits='32' is-struct='yes' visibility='default' id='type-id-100'>
+    <class-decl name='__va_list' size-in-bits='32' is-struct='yes' visibility='default' id='type-id-99'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='__ap' type-id='type-id-46' visibility='default'/>
+        <var-decl name='__ap' type-id='type-id-85' visibility='default'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='voidpc' type-id='type-id-46' filepath='./zconf.h' line='414' column='1' id='type-id-101'/>
-    <typedef-decl name='__gnuc_va_list' type-id='type-id-100' filepath='/usr/lib/gcc-cross/arm-linux-gnueabihf/11/include/stdarg.h' line='40' column='1' id='type-id-102'/>
-    <typedef-decl name='va_list' type-id='type-id-102' filepath='/usr/lib/gcc-cross/arm-linux-gnueabihf/11/include/stdarg.h' line='99' column='1' id='type-id-103'/>
-    <function-decl name='vsnprintf' filepath='/usr/arm-linux-gnueabihf/include/stdio.h' line='382' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-70'/>
-      <parameter type-id='type-id-6'/>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-102'/>
-      <return type-id='type-id-22'/>
+    <typedef-decl name='__gnuc_va_list' type-id='type-id-99' filepath='/usr/lib/gcc-cross/arm-linux-gnueabihf/13/include/stdarg.h' line='40' column='1' id='type-id-100'/>
+    <typedef-decl name='va_list' type-id='type-id-100' filepath='/usr/lib/gcc-cross/arm-linux-gnueabihf/13/include/stdarg.h' line='103' column='1' id='type-id-101'/>
+    <typedef-decl name='voidpc' type-id='type-id-85' filepath='./zconf.h' line='414' column='1' id='type-id-102'/>
+    <function-decl name='vsnprintf' filepath='/usr/arm-linux-gnueabihf/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-100'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='memmove' filepath='/usr/arm-linux-gnueabihf/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='write' filepath='/usr/arm-linux-gnueabihf/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-95'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-97'/>
     </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-101' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-102' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-9' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-101' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-102' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
-      <parameter type-id='type-id-22' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-80' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-80' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-103' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-101' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-80' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-104'/>
-    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-105' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-106'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-103' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-104'>
+      <underlying-type type-id='type-id-105'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-106' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-107'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='op' type-id='type-id-3' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
+        <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='8'>
-        <var-decl name='bits' type-id='type-id-3' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
+        <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='val' type-id='type-id-40' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+        <var-decl name='val' type-id='type-id-70' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='code' type-id='type-id-106' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-105'/>
-    <enum-decl name='codetype' naming-typedef-id='type-id-107' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-108'>
-      <underlying-type type-id='type-id-104'/>
-      <enumerator name='CODES' value='0'/>
-      <enumerator name='LENS' value='1'/>
-      <enumerator name='DISTS' value='2'/>
-    </enum-decl>
-    <typedef-decl name='codetype' type-id='type-id-108' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-107'/>
-    <typedef-decl name='in_func' type-id='type-id-109' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-110'/>
-    <typedef-decl name='out_func' type-id='type-id-111' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-112'/>
-    <pointer-type-def type-id='type-id-105' size-in-bits='32' id='type-id-113'/>
-    <pointer-type-def type-id='type-id-113' size-in-bits='32' id='type-id-114'/>
-    <pointer-type-def type-id='type-id-115' size-in-bits='32' id='type-id-111'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='32' id='type-id-91'/>
-    <pointer-type-def type-id='type-id-91' size-in-bits='32' id='type-id-116'/>
-    <pointer-type-def type-id='type-id-117' size-in-bits='32' id='type-id-109'/>
-    <pointer-type-def type-id='type-id-40' size-in-bits='32' id='type-id-118'/>
+    <typedef-decl name='code' type-id='type-id-107' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-106'/>
+    <typedef-decl name='codetype' type-id='type-id-104' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-103'/>
+    <typedef-decl name='in_func' type-id='type-id-108' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-109'/>
+    <typedef-decl name='out_func' type-id='type-id-110' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-111'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-105'/>
+    <pointer-type-def type-id='type-id-106' size-in-bits='32' id='type-id-112'/>
+    <pointer-type-def type-id='type-id-112' size-in-bits='32' id='type-id-113'/>
+    <pointer-type-def type-id='type-id-114' size-in-bits='32' id='type-id-110'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='32' id='type-id-88'/>
+    <pointer-type-def type-id='type-id-88' size-in-bits='32' id='type-id-115'/>
+    <pointer-type-def type-id='type-id-116' size-in-bits='32' id='type-id-108'/>
+    <pointer-type-def type-id='type-id-70' size-in-bits='32' id='type-id-117'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-118'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-91' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/infback.c' line='32' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
+      <parameter type-id='type-id-88' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
-      <parameter type-id='type-id-110' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-46' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
-      <parameter type-id='type-id-112' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-46' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-109' name='in' filepath='src.d/infback.c' line='253' column='1'/>
+      <parameter type-id='type-id-85' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-111' name='out' filepath='src.d/infback.c' line='255' column='1'/>
+      <parameter type-id='type-id-85' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-59'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-9'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-107'/>
-      <parameter type-id='type-id-118'/>
-      <parameter type-id='type-id-4'/>
-      <parameter type-id='type-id-114'/>
-      <parameter type-id='type-id-86'/>
-      <parameter type-id='type-id-118'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-103'/>
+      <parameter type-id='type-id-117'/>
+      <parameter type-id='type-id-9'/>
+      <parameter type-id='type-id-113'/>
+      <parameter type-id='type-id-80'/>
+      <parameter type-id='type-id-117'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-type size-in-bits='32' id='type-id-115'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-91'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-22'/>
+    <function-type size-in-bits='32' id='type-id-114'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-88'/>
+      <parameter type-id='type-id-9'/>
+      <return type-id='type-id-20'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-117'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-116'/>
-      <return type-id='type-id-4'/>
+    <function-type size-in-bits='32' id='type-id-116'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-115'/>
+      <return type-id='type-id-9'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-119'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
-      <parameter type-id='type-id-22' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
-      <parameter type-id='type-id-22' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
+      <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
-      <parameter type-id='type-id-21' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-85' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
+      <parameter type-id='type-id-79' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
-      <parameter type-id='type-id-18' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
+      <parameter type-id='type-id-11' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-61' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-59' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
-      <parameter type-id='type-id-22' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
-      <parameter type-id='type-id-22' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
-      <return type-id='type-id-1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <return type-id='type-id-37'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-12'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='2048' id='type-id-120'>
-      <subrange length='256' type-id='type-id-4' id='type-id-121'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='2048' id='type-id-121'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-122'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='4096' id='type-id-122'>
-      <subrange length='512' type-id='type-id-4' id='type-id-123'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='4096' id='type-id-123'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-124'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='infinite' id='type-id-124'>
-      <subrange length='infinite' id='type-id-125'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='unknown' id='type-id-125'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-126'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-38' const='yes' id='type-id-119'/>
-    <var-decl name='_length_code' type-id='type-id-124' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
-    <var-decl name='_dist_code' type-id='type-id-124' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
+    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-120'/>
+    <var-decl name='_length_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <var-decl name='_dist_code' type-id='type-id-123' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <pointer-type-def type-id='type-id-10' size-in-bits='32' id='type-id-126'/>
+    <pointer-type-def type-id='type-id-13' size-in-bits='32' id='type-id-127'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-126' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
+      <parameter type-id='type-id-127' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-127' size-in-bits='320' id='type-id-128'>
-      <subrange length='10' type-id='type-id-4' id='type-id-129'/>
+    <array-type-def dimensions='1' type-id='type-id-128' size-in-bits='320' id='type-id-129'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-130'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-70' const='yes' id='type-id-127'/>
-    <function-decl name='malloc' filepath='/usr/arm-linux-gnueabihf/include/stdlib.h' line='540' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
-    </function-decl>
-    <function-decl name='free' filepath='/usr/arm-linux-gnueabihf/include/stdlib.h' line='555' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
+    <qualified-type-def type-id='type-id-54' const='yes' id='type-id-128'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-80'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-10'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zError'>
-      <parameter type-id='type-id-22' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-80'/>
+      <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-128' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-129' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-mips-unknown-linux-gnu.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-mips-unknown-linux-gnu.abi
index 6a321b54..2ab253c3 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-mips-unknown-linux-gnu.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-mips-unknown-linux-gnu.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-mips-r3000-be' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-mips-r3000-be' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
     <dependency name='ld.so.1'/>
@@ -93,76 +93,90 @@
     <elf-symbol name='zlibCompileFlags' version='ZLIB_1.2.0.2' is-default-version='yes' type='func-type' binding='global-binding' visibility='default-visibility' is-defined='yes'/>
     <elf-symbol name='zlibVersion' type='func-type' binding='global-binding' visibility='default-visibility' is-defined='yes'/>
   </elf-function-symbols>
-  <abi-instr address-size='32' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <type-decl name='long int' size-in-bits='32' id='type-id-1'/>
-    <type-decl name='long long int' size-in-bits='64' id='type-id-2'/>
-    <type-decl name='unsigned char' size-in-bits='8' id='type-id-3'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-4'/>
-    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-5'/>
-    <typedef-decl name='z_size_t' type-id='type-id-6' filepath='./zconf.h' line='251' column='1' id='type-id-7'/>
-    <typedef-decl name='Byte' type-id='type-id-3' filepath='./zconf.h' line='397' column='1' id='type-id-8'/>
-    <typedef-decl name='uInt' type-id='type-id-4' filepath='./zconf.h' line='399' column='1' id='type-id-9'/>
-    <typedef-decl name='uLong' type-id='type-id-5' filepath='./zconf.h' line='400' column='1' id='type-id-10'/>
-    <typedef-decl name='Bytef' type-id='type-id-8' filepath='./zconf.h' line='406' column='1' id='type-id-11'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc-cross/mips-linux-gnu/10/include/stddef.h' line='209' column='1' id='type-id-6'/>
-    <typedef-decl name='__int64_t' type-id='type-id-2' filepath='/usr/mips-linux-gnu/include/bits/types.h' line='47' column='1' id='type-id-12'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/mips-linux-gnu/include/bits/types.h' line='152' column='1' id='type-id-13'/>
-    <typedef-decl name='__off64_t' type-id='type-id-12' filepath='/usr/mips-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-14'/>
-    <typedef-decl name='off_t' type-id='type-id-13' filepath='/usr/mips-linux-gnu/include/sys/types.h' line='85' column='1' id='type-id-15'/>
-    <typedef-decl name='off64_t' type-id='type-id-14' filepath='/usr/mips-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-16'/>
-    <qualified-type-def type-id='type-id-11' const='yes' id='type-id-17'/>
-    <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
+  <abi-instr address-size='32' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <type-decl name='long long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__int64_t' type-id='type-id-1' filepath='/usr/mips-linux-gnu/include/bits/types.h' line='47' column='1' id='type-id-5'/>
+    <typedef-decl name='__off64_t' type-id='type-id-5' filepath='/usr/mips-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-6' filepath='/usr/mips-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/mips-linux-gnu/include/sys/types.h' line='87' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc-cross/mips-linux-gnu/12/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-9' filepath='./zconf.h' line='399' column='1' id='type-id-11'/>
+    <typedef-decl name='uLong' type-id='type-id-12' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
+    <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-9'/>
+    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-12'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
+    <pointer-type-def type-id='type-id-15' size-in-bits='32' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
-      <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
-      <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='uLongf' type-id='type-id-10' filepath='./zconf.h' line='411' column='1' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-19' size-in-bits='32' id='type-id-20'/>
+  <abi-instr address-size='32' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+    <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress2'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/compress.c' line='27' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compress' mangled-name='compress' filepath='src.d/compress.c' line='68' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='z_crc_t' type-id='type-id-4' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-3' const='yes' id='type-id-24'/>
+  <abi-instr address-size='32' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='z_crc_t' type-id='type-id-9' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
     <pointer-type-def type-id='type-id-24' size-in-bits='32' id='type-id-25'/>
     <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
     <pointer-type-def type-id='type-id-26' size-in-bits='32' id='type-id-27'/>
@@ -170,863 +184,1088 @@
       <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-12' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
       <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-12' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
       <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-10' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
+  <abi-instr address-size='32' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='char' size-in-bits='8' id='type-id-28'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1248' id='type-id-31'>
-      <subrange length='39' type-id='type-id-4' id='type-id-32'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='18336' id='type-id-33'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-31'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1952' id='type-id-35'>
-      <subrange length='61' type-id='type-id-4' id='type-id-36'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='int' size-in-bits='32' id='type-id-22'/>
-    <array-type-def dimensions='1' type-id='type-id-22' size-in-bits='18336' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-35'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-38' size-in-bits='4584' id='type-id-39'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <type-decl name='int' size-in-bits='32' id='type-id-20'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-40'/>
-    <array-type-def dimensions='1' type-id='type-id-41' size-in-bits='256' id='type-id-42'>
-      <subrange length='16' type-id='type-id-4' id='type-id-43'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-44'/>
-    <typedef-decl name='voidpf' type-id='type-id-45' filepath='./zconf.h' line='415' column='1' id='type-id-46'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-30'>
+    <type-decl name='long int' size-in-bits='32' id='type-id-37'/>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-47'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-40'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='32'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-48'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='96'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-30' filepath='src.d/deflate.h' line='77' column='1' id='type-id-49'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-29' filepath='src.d/deflate.h' line='84' column='1' id='type-id-50'/>
-    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-51'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='max_code' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='extra_len' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='stat_desc' type-id='type-id-53' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='224'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='name_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='comm_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='352'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-41' filepath='src.d/deflate.h' line='92' column='1' id='type-id-54'/>
-    <typedef-decl name='Posf' type-id='type-id-54' filepath='src.d/deflate.h' line='93' column='1' id='type-id-55'/>
-    <typedef-decl name='IPos' type-id='type-id-4' filepath='src.d/deflate.h' line='94' column='1' id='type-id-56'/>
-    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-57'>
+    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-41'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='status' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
+        <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pending_buf' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
+        <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='pending_buf_size' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pending_out' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
+        <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='pending' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='wrap' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
+        <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='gzhead' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='gzindex' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='method' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='last_flush' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
+        <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='w_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='w_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='w_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='window' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
+        <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='480'>
-        <var-decl name='window_size' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='prev' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='head' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='ins_h' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
-        <var-decl name='hash_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='hash_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='hash_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='hash_shift' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='736'>
-        <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
+        <var-decl name='block_start' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='match_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
-        <var-decl name='prev_match' type-id='type-id-56' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='match_available' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
+        <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='864'>
-        <var-decl name='strstart' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='match_start' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='928'>
-        <var-decl name='lookahead' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='prev_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='992'>
-        <var-decl name='max_chain_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='max_lazy_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='level' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='strategy' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='good_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='nice_match' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
+        <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1184'>
-        <var-decl name='dyn_ltree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='19520'>
-        <var-decl name='dyn_dtree' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21472'>
-        <var-decl name='bl_tree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22720'>
-        <var-decl name='l_desc' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22816'>
-        <var-decl name='d_desc' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22912'>
-        <var-decl name='bl_desc' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23008'>
-        <var-decl name='bl_count' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23264'>
-        <var-decl name='heap' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41600'>
-        <var-decl name='heap_len' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
+        <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41632'>
-        <var-decl name='heap_max' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
+        <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41664'>
-        <var-decl name='depth' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46272'>
-        <var-decl name='sym_buf' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46304'>
-        <var-decl name='lit_bufsize' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46336'>
-        <var-decl name='sym_next' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46368'>
-        <var-decl name='sym_end' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46400'>
-        <var-decl name='opt_len' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46432'>
-        <var-decl name='static_len' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46464'>
-        <var-decl name='matches' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46496'>
-        <var-decl name='insert' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46528'>
-        <var-decl name='bi_buf' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46560'>
-        <var-decl name='bi_valid' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
+        <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46592'>
-        <var-decl name='high_water' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='alloc_func' type-id='type-id-63' filepath='src.d/zlib.h' line='81' column='1' id='type-id-64'/>
-    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-66'/>
-    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-67'>
+    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-46'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='next_in' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
+        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='avail_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='total_in' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='next_out' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='avail_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='total_out' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='state' type-id='type-id-69' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='zalloc' type-id='type-id-64' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='zfree' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='opaque' type-id='type-id-46' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='data_type' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='adler' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='reserved' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-67' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
-    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-58'/>
-    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-72'>
+    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-53'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
+        <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='time' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='xflags' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='os' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
+        <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='extra' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='extra_len' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='name' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+        <var-decl name='state' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='name_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='comment' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+        <var-decl name='zfree' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='comm_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+        <var-decl name='opaque' type-id='type-id-58' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='hcrc' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+        <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='done' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='416'>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-72' filepath='src.d/zlib.h' line='129' column='1' id='type-id-73'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-74' filepath='src.d/zlib.h' line='131' column='1' id='type-id-60'/>
-    <typedef-decl name='uch' type-id='type-id-3' filepath='src.d/zutil.h' line='39' column='1' id='type-id-38'/>
-    <typedef-decl name='uchf' type-id='type-id-38' filepath='src.d/zutil.h' line='40' column='1' id='type-id-75'/>
-    <typedef-decl name='ush' type-id='type-id-40' filepath='src.d/zutil.h' line='41' column='1' id='type-id-41'/>
-    <typedef-decl name='ulg' type-id='type-id-5' filepath='src.d/zutil.h' line='43' column='1' id='type-id-59'/>
-    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-21'/>
-    <pointer-type-def type-id='type-id-55' size-in-bits='32' id='type-id-61'/>
-    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-68'/>
-    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-76'/>
-    <pointer-type-def type-id='type-id-76' size-in-bits='32' id='type-id-77'/>
-    <qualified-type-def type-id='type-id-50' const='yes' id='type-id-78'/>
-    <pointer-type-def type-id='type-id-78' size-in-bits='32' id='type-id-53'/>
-    <pointer-type-def type-id='type-id-49' size-in-bits='32' id='type-id-52'/>
-    <pointer-type-def type-id='type-id-73' size-in-bits='32' id='type-id-74'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='32' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-57' size-in-bits='32' id='type-id-69'/>
-    <pointer-type-def type-id='type-id-80' size-in-bits='32' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-62'/>
-    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-82'/>
-    <pointer-type-def type-id='type-id-83' size-in-bits='32' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-44' size-in-bits='32' id='type-id-45'/>
-    <pointer-type-def type-id='type-id-70' size-in-bits='32' id='type-id-71'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-77' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-22'/>
+    <typedef-decl name='IPos' type-id='type-id-9' filepath='src.d/deflate.h' line='94' column='1' id='type-id-45'/>
+    <typedef-decl name='Pos' type-id='type-id-50' filepath='src.d/deflate.h' line='92' column='1' id='type-id-59'/>
+    <typedef-decl name='Posf' type-id='type-id-59' filepath='src.d/deflate.h' line='93' column='1' id='type-id-60'/>
+    <typedef-decl name='alloc_func' type-id='type-id-61' filepath='src.d/zlib.h' line='81' column='1' id='type-id-56'/>
+    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-62'/>
+    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-63'/>
+    <typedef-decl name='deflate_state' type-id='type-id-41' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
+    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-57'/>
+    <typedef-decl name='gz_header' type-id='type-id-40' filepath='src.d/zlib.h' line='129' column='1' id='type-id-66'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-67' filepath='src.d/zlib.h' line='131' column='1' id='type-id-43'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-68'/>
+    <typedef-decl name='uchf' type-id='type-id-68' filepath='src.d/zutil.h' line='40' column='1' id='type-id-69'/>
+    <typedef-decl name='ulg' type-id='type-id-12' filepath='src.d/zutil.h' line='43' column='1' id='type-id-42'/>
+    <typedef-decl name='ush' type-id='type-id-70' filepath='src.d/zutil.h' line='41' column='1' id='type-id-50'/>
+    <typedef-decl name='z_stream' type-id='type-id-53' filepath='src.d/zlib.h' line='106' column='1' id='type-id-71'/>
+    <typedef-decl name='z_streamp' type-id='type-id-72' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-68' size-in-bits='4584' id='type-id-48'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-39'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      </data-member>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      </data-member>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+      </data-member>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      </data-member>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-70'/>
+    <array-type-def dimensions='1' type-id='type-id-50' size-in-bits='256' id='type-id-47'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-73'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-60' size-in-bits='32' id='type-id-44'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='32' id='type-id-74'/>
+    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='32' id='type-id-51'/>
+    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-66' size-in-bits='32' id='type-id-67'/>
+    <pointer-type-def type-id='type-id-20' size-in-bits='32' id='type-id-77'/>
+    <pointer-type-def type-id='type-id-41' size-in-bits='32' id='type-id-55'/>
+    <pointer-type-def type-id='type-id-78' size-in-bits='32' id='type-id-61'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='32' id='type-id-49'/>
+    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-80'/>
+    <pointer-type-def type-id='type-id-81' size-in-bits='32' id='type-id-65'/>
+    <pointer-type-def type-id='type-id-71' size-in-bits='32' id='type-id-72'/>
+    <qualified-type-def type-id='type-id-82' const='yes' id='type-id-83'/>
+    <pointer-type-def type-id='type-id-83' size-in-bits='32' id='type-id-52'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-84'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-58'/>
+    <function-decl name='memcpy' filepath='/usr/mips-linux-gnu/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='memset' filepath='/usr/mips-linux-gnu/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
-      <parameter type-id='type-id-22' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
-      <parameter type-id='type-id-22' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-77' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
+      <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
+      <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
-      <parameter type-id='type-id-18' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
+      <parameter type-id='type-id-11' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
-      <parameter type-id='type-id-21' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-81' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
+      <parameter type-id='type-id-79' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-60' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-82' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-79' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-80' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-77' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
-      <parameter type-id='type-id-22' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
-      <parameter type-id='type-id-22' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
+      <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
-      <parameter type-id='type-id-22' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
-      <parameter type-id='type-id-22' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
-      <parameter type-id='type-id-22' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
-      <parameter type-id='type-id-22' name='max_chain' filepath='src.d/deflate.c' line='659' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
+      <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
+      <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
+      <parameter type-id='type-id-20' name='max_chain' filepath='src.d/deflate.c' line='659' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-10'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-58' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-58' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-type size-in-bits='32' id='type-id-80'>
-      <parameter type-id='type-id-46'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-84' filepath='src.d/deflate.h' line='84' column='1' id='type-id-82'/>
+    <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-58'/>
       <parameter type-id='type-id-9'/>
       <parameter type-id='type-id-9'/>
-      <return type-id='type-id-46'/>
+      <return type-id='type-id-58'/>
+    </function-decl>
+    <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-86'/>
+    <pointer-type-def type-id='type-id-86' id='type-id-85'/>
+    <function-type size-in-bits='32' id='type-id-81'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-86'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-83'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <return type-id='type-id-44'/>
+    <function-type size-in-bits='32' id='type-id-78'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-58'/>
     </function-type>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='gzFile' type-id='type-id-84' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-85'/>
-    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-86'>
+  <abi-instr address-size='32' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-87'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-4' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='next' type-id='type-id-87' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-88' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pos' type-id='type-id-16' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-86' size-in-bits='32' id='type-id-84'/>
+    <typedef-decl name='gzFile' type-id='type-id-89' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-90'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-89'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-90'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-90'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-77' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-77' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+  <abi-instr address-size='32' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <function-decl name='snprintf' filepath='/usr/mips-linux-gnu/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter is-variadic='yes'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='malloc' filepath='/usr/mips-linux-gnu/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-10'/>
       <return type-id='type-id-85'/>
     </function-decl>
+    <function-decl name='free' filepath='/usr/mips-linux-gnu/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-85'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='strlen' filepath='/usr/mips-linux-gnu/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
+    </function-decl>
+    <function-decl name='lseek64' filepath='/usr/mips-linux-gnu/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-6'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-6'/>
+    </function-decl>
+    <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen'>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-90'/>
+    </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-77' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-77' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-85'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdopen'>
-      <parameter type-id='type-id-22' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-77' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-85'/>
+      <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-4' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-9' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-16' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
-      <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-15' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
-      <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-79' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-77'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-77' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-86'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-91'/>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='voidp' type-id='type-id-45' filepath='./zconf.h' line='416' column='1' id='type-id-88'/>
+  <abi-instr address-size='32' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <class-decl name='gz_state' size-in-bits='1344' is-struct='yes' naming-typedef-id='type-id-92' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-93'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='x' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='path' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='224'>
+        <var-decl name='size' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='want' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='in' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='out' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='352'>
+        <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='448'>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='512'>
+        <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='544'>
+        <var-decl name='past' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='189' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='576'>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='191' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='608'>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='192' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='640'>
+        <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='704'>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='768'>
+        <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='800'>
+        <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='832'>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='864'>
+        <var-decl name='strm' type-id='type-id-71' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
+      </data-member>
+    </class-decl>
+    <typedef-decl name='__ssize_t' type-id='type-id-20' filepath='/usr/mips-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-94'/>
+    <typedef-decl name='gz_state' type-id='type-id-93' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-92'/>
+    <typedef-decl name='gz_statep' type-id='type-id-95' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-96'/>
+    <typedef-decl name='ssize_t' type-id='type-id-94' filepath='/usr/mips-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-97'/>
+    <pointer-type-def type-id='type-id-92' size-in-bits='32' id='type-id-95'/>
+    <typedef-decl name='voidp' type-id='type-id-85' filepath='./zconf.h' line='416' column='1' id='type-id-98'/>
+    <function-decl name='__errno_location' filepath='/usr/mips-linux-gnu/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <return type-id='type-id-77'/>
+    </function-decl>
+    <function-decl name='memchr' filepath='/usr/mips-linux-gnu/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='strerror' filepath='/usr/mips-linux-gnu/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-54'/>
+    </function-decl>
+    <function-decl name='close' filepath='/usr/mips-linux-gnu/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='read' filepath='/usr/mips-linux-gnu/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-97'/>
+    </function-decl>
+    <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-96'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-88' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-9' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-88' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-22' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-68' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
-      <parameter type-id='type-id-22' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-68'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-54' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
+      <return type-id='type-id-54'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/gzread.c' line='623' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzread.c' line='624' column='1'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <type-decl name='variadic parameter type' id='type-id-89'/>
-    <typedef-decl name='voidpc' type-id='type-id-45' filepath='./zconf.h' line='414' column='1' id='type-id-90'/>
-    <typedef-decl name='__gnuc_va_list' type-id='type-id-45' filepath='/usr/lib/gcc-cross/mips-linux-gnu/10/include/stdarg.h' line='40' column='1' id='type-id-91'/>
-    <typedef-decl name='va_list' type-id='type-id-91' filepath='/usr/lib/gcc-cross/mips-linux-gnu/10/include/stdarg.h' line='99' column='1' id='type-id-92'/>
+  <abi-instr address-size='32' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpc' type-id='type-id-85' filepath='./zconf.h' line='414' column='1' id='type-id-99'/>
+    <typedef-decl name='__gnuc_va_list' type-id='type-id-85' filepath='/usr/lib/gcc-cross/mips-linux-gnu/12/include/stdarg.h' line='40' column='1' id='type-id-100'/>
+    <typedef-decl name='va_list' type-id='type-id-100' filepath='/usr/lib/gcc-cross/mips-linux-gnu/12/include/stdarg.h' line='99' column='1' id='type-id-101'/>
+    <function-decl name='vsnprintf' filepath='/usr/mips-linux-gnu/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-85'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='memmove' filepath='/usr/mips-linux-gnu/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='write' filepath='/usr/mips-linux-gnu/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-97'/>
+    </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-90' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-99' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-9' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-90' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-99' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
-      <parameter type-id='type-id-22' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-77' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-77' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-92' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-101' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-77' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/gzwrite.c' line='639' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-85' name='file' filepath='src.d/gzwrite.c' line='640' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='in_func' type-id='type-id-93' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-94'/>
-    <typedef-decl name='out_func' type-id='type-id-95' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-96'/>
-    <pointer-type-def type-id='type-id-97' size-in-bits='32' id='type-id-95'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='32' id='type-id-87'/>
-    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-98'/>
-    <pointer-type-def type-id='type-id-99' size-in-bits='32' id='type-id-93'/>
+  <abi-instr address-size='32' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-102' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-103'>
+      <underlying-type type-id='type-id-104'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-105' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-106'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='8'>
+        <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='16'>
+        <var-decl name='val' type-id='type-id-70' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+      </data-member>
+    </class-decl>
+    <typedef-decl name='code' type-id='type-id-106' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-105'/>
+    <typedef-decl name='codetype' type-id='type-id-103' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-102'/>
+    <typedef-decl name='in_func' type-id='type-id-107' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-108'/>
+    <typedef-decl name='out_func' type-id='type-id-109' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-110'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-104'/>
+    <pointer-type-def type-id='type-id-105' size-in-bits='32' id='type-id-111'/>
+    <pointer-type-def type-id='type-id-111' size-in-bits='32' id='type-id-112'/>
+    <pointer-type-def type-id='type-id-113' size-in-bits='32' id='type-id-109'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='32' id='type-id-88'/>
+    <pointer-type-def type-id='type-id-88' size-in-bits='32' id='type-id-114'/>
+    <pointer-type-def type-id='type-id-115' size-in-bits='32' id='type-id-107'/>
+    <pointer-type-def type-id='type-id-70' size-in-bits='32' id='type-id-116'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-117'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-87' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-77' name='version' filepath='src.d/infback.c' line='32' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
+      <parameter type-id='type-id-88' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
-      <parameter type-id='type-id-94' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-45' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
-      <parameter type-id='type-id-96' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-45' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-108' name='in' filepath='src.d/infback.c' line='253' column='1'/>
+      <parameter type-id='type-id-85' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-110' name='out' filepath='src.d/infback.c' line='255' column='1'/>
+      <parameter type-id='type-id-85' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-type size-in-bits='32' id='type-id-97'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-87'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-9'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-102'/>
+      <parameter type-id='type-id-116'/>
+      <parameter type-id='type-id-9'/>
+      <parameter type-id='type-id-112'/>
+      <parameter type-id='type-id-80'/>
+      <parameter type-id='type-id-116'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-type size-in-bits='32' id='type-id-113'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-88'/>
+      <parameter type-id='type-id-9'/>
+      <return type-id='type-id-20'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-99'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-98'/>
-      <return type-id='type-id-4'/>
+    <function-type size-in-bits='32' id='type-id-115'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-114'/>
+      <return type-id='type-id-9'/>
     </function-type>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
+  <abi-instr address-size='32' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-118'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-77' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-77' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
-      <parameter type-id='type-id-22' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
-      <parameter type-id='type-id-22' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
+      <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
-      <parameter type-id='type-id-21' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-81' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
+      <parameter type-id='type-id-79' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
-      <parameter type-id='type-id-18' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
+      <parameter type-id='type-id-11' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-60' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-58' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-58' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
-      <parameter type-id='type-id-22' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
-      <parameter type-id='type-id-22' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
-      <return type-id='type-id-1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <return type-id='type-id-37'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-58' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-12'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <array-type-def dimensions='1' type-id='type-id-100' size-in-bits='2048' id='type-id-101'>
-      <subrange length='256' type-id='type-id-4' id='type-id-102'/>
+  <abi-instr address-size='32' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='2048' id='type-id-120'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-121'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-100' size-in-bits='4096' id='type-id-103'>
-      <subrange length='512' type-id='type-id-4' id='type-id-104'/>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='4096' id='type-id-122'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-123'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-100' size-in-bits='infinite' id='type-id-105'>
-      <subrange length='infinite' id='type-id-106'/>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='unknown' id='type-id-124'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-125'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-38' const='yes' id='type-id-100'/>
-    <var-decl name='_length_code' type-id='type-id-105' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
-    <var-decl name='_dist_code' type-id='type-id-105' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
+    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-119'/>
+    <var-decl name='_length_code' type-id='type-id-120' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <var-decl name='_dist_code' type-id='type-id-122' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <pointer-type-def type-id='type-id-10' size-in-bits='32' id='type-id-107'/>
+  <abi-instr address-size='32' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <pointer-type-def type-id='type-id-13' size-in-bits='32' id='type-id-126'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-107' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
+      <parameter type-id='type-id-126' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='32' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <array-type-def dimensions='1' type-id='type-id-108' size-in-bits='320' id='type-id-109'>
-      <subrange length='10' type-id='type-id-4' id='type-id-110'/>
+  <abi-instr address-size='32' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <array-type-def dimensions='1' type-id='type-id-127' size-in-bits='320' id='type-id-128'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-129'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-108'/>
+    <qualified-type-def type-id='type-id-54' const='yes' id='type-id-127'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-77'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-10'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zError'>
-      <parameter type-id='type-id-22' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-77'/>
+      <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-109' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-128' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-mips64-unknown-linux-gnuabi64.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-mips64-unknown-linux-gnuabi64.abi
index 81925a88..cd0d66f5 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-mips64-unknown-linux-gnuabi64.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-mips64-unknown-linux-gnuabi64.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-mips-r3000-be' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-mips-r3000-be' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
     <dependency name='ld.so.1'/>
@@ -93,56 +93,56 @@
     <elf-symbol name='zlibCompileFlags' version='ZLIB_1.2.0.2' is-default-version='yes' type='func-type' binding='global-binding' visibility='default-visibility' is-defined='yes'/>
     <elf-symbol name='zlibVersion' type='func-type' binding='global-binding' visibility='default-visibility' is-defined='yes'/>
   </elf-function-symbols>
-  <abi-instr address-size='64' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
+  <abi-instr address-size='64' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/mips64-linux-gnuabi64/include/bits/types.h' line='153' column='1' id='type-id-5'/>
+    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/mips64-linux-gnuabi64/include/bits/types.h' line='152' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-5' filepath='/usr/mips64-linux-gnuabi64/include/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/mips64-linux-gnuabi64/include/sys/types.h' line='85' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc-cross/mips64-linux-gnuabi64/12/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-11' filepath='./zconf.h' line='399' column='1' id='type-id-12'/>
+    <typedef-decl name='uLong' type-id='type-id-9' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
     <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-3'/>
-    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-4'/>
-    <typedef-decl name='z_size_t' type-id='type-id-5' filepath='./zconf.h' line='251' column='1' id='type-id-6'/>
-    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-7'/>
-    <typedef-decl name='uInt' type-id='type-id-3' filepath='./zconf.h' line='399' column='1' id='type-id-8'/>
-    <typedef-decl name='uLong' type-id='type-id-4' filepath='./zconf.h' line='400' column='1' id='type-id-9'/>
-    <typedef-decl name='Bytef' type-id='type-id-7' filepath='./zconf.h' line='406' column='1' id='type-id-10'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc-cross/mips64-linux-gnuabi64/10/include/stddef.h' line='209' column='1' id='type-id-5'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/mips64-linux-gnuabi64/include/bits/types.h' line='152' column='1' id='type-id-11'/>
-    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/mips64-linux-gnuabi64/include/bits/types.h' line='153' column='1' id='type-id-12'/>
-    <typedef-decl name='off_t' type-id='type-id-11' filepath='/usr/mips64-linux-gnuabi64/include/sys/types.h' line='85' column='1' id='type-id-13'/>
-    <typedef-decl name='off64_t' type-id='type-id-12' filepath='/usr/mips64-linux-gnuabi64/include/sys/types.h' line='92' column='1' id='type-id-14'/>
-    <qualified-type-def type-id='type-id-10' const='yes' id='type-id-15'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-11'/>
+    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-9'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
     <pointer-type-def type-id='type-id-15' size-in-bits='64' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='uLongf' type-id='type-id-9' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+  <abi-instr address-size='64' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
     <pointer-type-def type-id='type-id-17' size-in-bits='64' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compress2'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
@@ -150,130 +150,146 @@
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <type-decl name='void' id='type-id-21'/>
-    <typedef-decl name='z_crc_t' type-id='type-id-3' filepath='./zconf.h' line='435' column='1' id='type-id-22'/>
-    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-23'/>
-    <pointer-type-def type-id='type-id-23' size-in-bits='64' id='type-id-24'/>
-    <qualified-type-def type-id='type-id-22' const='yes' id='type-id-25'/>
-    <pointer-type-def type-id='type-id-25' size-in-bits='64' id='type-id-26'/>
+  <abi-instr address-size='64' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='z_crc_t' type-id='type-id-11' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
+    <pointer-type-def type-id='type-id-24' size-in-bits='64' id='type-id-25'/>
+    <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
+    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-27'/>
     <function-decl name='get_crc_table' mangled-name='get_crc_table' filepath='src.d/crc32.c' line='595' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='get_crc_table'>
-      <return type-id='type-id-26'/>
+      <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
-      <parameter type-id='type-id-24' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
-      <parameter type-id='type-id-24' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-9' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
+    <type-decl name='void' id='type-id-28'/>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <type-decl name='char' size-in-bits='8' id='type-id-27'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-28'/>
-    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
-      <subrange length='39' type-id='type-id-4' id='type-id-31'/>
+  <abi-instr address-size='64' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <type-decl name='char' size-in-bits='8' id='type-id-29'/>
+    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1248' id='type-id-31'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-32'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
-      <subrange length='573' type-id='type-id-4' id='type-id-33'/>
+    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='18336' id='type-id-33'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-34'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
-      <subrange length='61' type-id='type-id-4' id='type-id-35'/>
+    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1952' id='type-id-35'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-36'/>
     </array-type-def>
     <type-decl name='int' size-in-bits='32' id='type-id-20'/>
-    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
-      <subrange length='573' type-id='type-id-4' id='type-id-33'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-37' size-in-bits='4584' id='type-id-38'>
-      <subrange length='573' type-id='type-id-4' id='type-id-33'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-37'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-34'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-39'/>
-    <array-type-def dimensions='1' type-id='type-id-40' size-in-bits='256' id='type-id-41'>
-      <subrange length='16' type-id='type-id-4' id='type-id-42'/>
-    </array-type-def>
-    <typedef-decl name='voidpf' type-id='type-id-43' filepath='./zconf.h' line='415' column='1' id='type-id-44'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-30'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-45'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-40'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-46'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-47'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-28' filepath='src.d/deflate.h' line='84' column='1' id='type-id-48'/>
-    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-49'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='extra_len' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='stat_desc' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='extra_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='name_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='448'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='512'>
+        <var-decl name='comm_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='544'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='576'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-40' filepath='src.d/deflate.h' line='92' column='1' id='type-id-52'/>
-    <typedef-decl name='Posf' type-id='type-id-52' filepath='src.d/deflate.h' line='93' column='1' id='type-id-53'/>
-    <typedef-decl name='IPos' type-id='type-id-3' filepath='src.d/deflate.h' line='94' column='1' id='type-id-54'/>
-    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-55'>
+    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-41'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-56' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
         <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
@@ -282,94 +298,94 @@
         <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='pending_buf_size' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
         <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='pending' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
         <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='gzhead' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='gzindex' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='method' type-id='type-id-7' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
         <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='w_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='w_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='w_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
         <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='window_size' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='prev' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='head' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='ins_h' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='hash_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='hash_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='hash_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='hash_shift' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1216'>
         <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1280'>
-        <var-decl name='match_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1312'>
-        <var-decl name='prev_match' type-id='type-id-54' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1344'>
         <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1376'>
-        <var-decl name='strstart' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1408'>
-        <var-decl name='match_start' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1440'>
-        <var-decl name='lookahead' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1472'>
-        <var-decl name='prev_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1504'>
-        <var-decl name='max_chain_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1536'>
-        <var-decl name='max_lazy_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1568'>
         <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
@@ -378,34 +394,34 @@
         <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1632'>
-        <var-decl name='good_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1664'>
         <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1696'>
-        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='20032'>
-        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21984'>
-        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23232'>
-        <var-decl name='l_desc' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23424'>
-        <var-decl name='d_desc' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23616'>
-        <var-decl name='bl_desc' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23808'>
-        <var-decl name='bl_count' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='24064'>
-        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42400'>
         <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
@@ -414,219 +430,225 @@
         <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42464'>
-        <var-decl name='depth' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47104'>
-        <var-decl name='sym_buf' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47168'>
-        <var-decl name='lit_bufsize' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47200'>
-        <var-decl name='sym_next' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47232'>
-        <var-decl name='sym_end' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47296'>
-        <var-decl name='opt_len' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47360'>
-        <var-decl name='static_len' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47424'>
-        <var-decl name='matches' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47456'>
-        <var-decl name='insert' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47488'>
-        <var-decl name='bi_buf' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47520'>
         <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47552'>
-        <var-decl name='high_water' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+      </data-member>
+    </class-decl>
+    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-46'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='alloc_func' type-id='type-id-61' filepath='src.d/zlib.h' line='81' column='1' id='type-id-62'/>
-    <typedef-decl name='free_func' type-id='type-id-63' filepath='src.d/zlib.h' line='82' column='1' id='type-id-64'/>
-    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-65'>
+    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-53'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='avail_in' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='total_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='avail_out' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='total_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='msg' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='state' type-id='type-id-67' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
+        <var-decl name='state' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='zalloc' type-id='type-id-62' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='zfree' type-id='type-id-64' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
+        <var-decl name='zfree' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='opaque' type-id='type-id-44' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
+        <var-decl name='opaque' type-id='type-id-58' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
         <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='adler' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='reserved' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-65' filepath='src.d/zlib.h' line='106' column='1' id='type-id-68'/>
-    <typedef-decl name='z_streamp' type-id='type-id-69' filepath='src.d/zlib.h' line='108' column='1' id='type-id-56'/>
-    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-70'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='time' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='extra_len' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='extra_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='name_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+    <typedef-decl name='IPos' type-id='type-id-11' filepath='src.d/deflate.h' line='94' column='1' id='type-id-45'/>
+    <typedef-decl name='Pos' type-id='type-id-50' filepath='src.d/deflate.h' line='92' column='1' id='type-id-59'/>
+    <typedef-decl name='Posf' type-id='type-id-59' filepath='src.d/deflate.h' line='93' column='1' id='type-id-60'/>
+    <typedef-decl name='alloc_func' type-id='type-id-61' filepath='src.d/zlib.h' line='81' column='1' id='type-id-56'/>
+    <typedef-decl name='charf' type-id='type-id-29' filepath='./zconf.h' line='408' column='1' id='type-id-62'/>
+    <typedef-decl name='ct_data' type-id='type-id-30' filepath='src.d/deflate.h' line='77' column='1' id='type-id-63'/>
+    <typedef-decl name='deflate_state' type-id='type-id-41' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
+    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-57'/>
+    <typedef-decl name='gz_header' type-id='type-id-40' filepath='src.d/zlib.h' line='129' column='1' id='type-id-66'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-67' filepath='src.d/zlib.h' line='131' column='1' id='type-id-43'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-68'/>
+    <typedef-decl name='uchf' type-id='type-id-68' filepath='src.d/zutil.h' line='40' column='1' id='type-id-69'/>
+    <typedef-decl name='ulg' type-id='type-id-9' filepath='src.d/zutil.h' line='43' column='1' id='type-id-42'/>
+    <typedef-decl name='ush' type-id='type-id-70' filepath='src.d/zutil.h' line='41' column='1' id='type-id-50'/>
+    <typedef-decl name='z_stream' type-id='type-id-53' filepath='src.d/zlib.h' line='106' column='1' id='type-id-71'/>
+    <typedef-decl name='z_streamp' type-id='type-id-72' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-68' size-in-bits='4584' id='type-id-48'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-34'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-39'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='comm_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
       </data-member>
-    </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-70' filepath='src.d/zlib.h' line='129' column='1' id='type-id-71'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-72' filepath='src.d/zlib.h' line='131' column='1' id='type-id-58'/>
-    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-37'/>
-    <typedef-decl name='uchf' type-id='type-id-37' filepath='src.d/zutil.h' line='40' column='1' id='type-id-73'/>
-    <typedef-decl name='ush' type-id='type-id-39' filepath='src.d/zutil.h' line='41' column='1' id='type-id-40'/>
-    <typedef-decl name='ulg' type-id='type-id-4' filepath='src.d/zutil.h' line='43' column='1' id='type-id-57'/>
-    <pointer-type-def type-id='type-id-10' size-in-bits='64' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-53' size-in-bits='64' id='type-id-59'/>
-    <pointer-type-def type-id='type-id-27' size-in-bits='64' id='type-id-66'/>
-    <qualified-type-def type-id='type-id-27' const='yes' id='type-id-74'/>
-    <pointer-type-def type-id='type-id-74' size-in-bits='64' id='type-id-75'/>
-    <qualified-type-def type-id='type-id-48' const='yes' id='type-id-76'/>
-    <pointer-type-def type-id='type-id-76' size-in-bits='64' id='type-id-51'/>
-    <pointer-type-def type-id='type-id-47' size-in-bits='64' id='type-id-50'/>
-    <pointer-type-def type-id='type-id-71' size-in-bits='64' id='type-id-72'/>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-70'/>
+    <array-type-def dimensions='1' type-id='type-id-50' size-in-bits='256' id='type-id-47'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-73'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='64' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-60' size-in-bits='64' id='type-id-44'/>
+    <pointer-type-def type-id='type-id-29' size-in-bits='64' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-74'/>
+    <qualified-type-def type-id='type-id-29' const='yes' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-75' size-in-bits='64' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='64' id='type-id-51'/>
+    <pointer-type-def type-id='type-id-64' size-in-bits='64' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-66' size-in-bits='64' id='type-id-67'/>
     <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-77'/>
-    <pointer-type-def type-id='type-id-55' size-in-bits='64' id='type-id-67'/>
+    <pointer-type-def type-id='type-id-41' size-in-bits='64' id='type-id-55'/>
     <pointer-type-def type-id='type-id-78' size-in-bits='64' id='type-id-61'/>
-    <pointer-type-def type-id='type-id-8' size-in-bits='64' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-73' size-in-bits='64' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='64' id='type-id-80'/>
-    <pointer-type-def type-id='type-id-81' size-in-bits='64' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-21' size-in-bits='64' id='type-id-43'/>
-    <pointer-type-def type-id='type-id-68' size-in-bits='64' id='type-id-69'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-28'/>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-75' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-20'/>
+    <pointer-type-def type-id='type-id-12' size-in-bits='64' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='64' id='type-id-49'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='64' id='type-id-80'/>
+    <pointer-type-def type-id='type-id-81' size-in-bits='64' id='type-id-65'/>
+    <pointer-type-def type-id='type-id-71' size-in-bits='64' id='type-id-72'/>
+    <qualified-type-def type-id='type-id-82' const='yes' id='type-id-83'/>
+    <pointer-type-def type-id='type-id-83' size-in-bits='64' id='type-id-52'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-84'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-58'/>
+    <function-decl name='memcpy' filepath='/usr/mips64-linux-gnuabi64/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='memset' filepath='/usr/mips64-linux-gnuabi64/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
       <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
       <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-75' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
       <parameter type-id='type-id-79' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-58' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
       <parameter type-id='type-id-80' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
       <parameter type-id='type-id-77' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
       <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
       <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
       <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
@@ -634,397 +656,621 @@
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
+    <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateCopy'>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-20'/>
+    <typedef-decl name='static_tree_desc' type-id='type-id-84' filepath='src.d/deflate.h' line='84' column='1' id='type-id-82'/>
+    <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
+    <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
+    <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
+    <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
+    <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-13'/>
     </function-decl>
-    <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-56' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-56' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
-      <return type-id='type-id-20'/>
+    <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-58'/>
     </function-decl>
-    <function-type size-in-bits='64' id='type-id-78'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-8'/>
-      <parameter type-id='type-id-8'/>
-      <return type-id='type-id-44'/>
-    </function-type>
+    <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
+    <pointer-type-def type-id='type-id-28' id='type-id-85'/>
     <function-type size-in-bits='64' id='type-id-81'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <return type-id='type-id-21'/>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-28'/>
+    </function-type>
+    <function-type size-in-bits='64' id='type-id-78'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-58'/>
     </function-type>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='gzFile' type-id='type-id-82' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-83'/>
-    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-84'>
+  <abi-instr address-size='64' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-86'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-3' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='next' type-id='type-id-85' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-87' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pos' type-id='type-id-14' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-84' size-in-bits='64' id='type-id-82'/>
+    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
+    <pointer-type-def type-id='type-id-86' size-in-bits='64' id='type-id-88'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
+  <abi-instr address-size='64' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <function-decl name='open' filepath='/usr/mips64-linux-gnuabi64/include/fcntl.h' line='209' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <parameter is-variadic='yes'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='snprintf' filepath='/usr/mips64-linux-gnuabi64/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter is-variadic='yes'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='malloc' filepath='/usr/mips64-linux-gnuabi64/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/mips64-linux-gnuabi64/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-85'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
+    <function-decl name='strlen' filepath='/usr/mips64-linux-gnuabi64/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
+    </function-decl>
+    <function-decl name='lseek64' filepath='/usr/mips64-linux-gnuabi64/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-5'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-5'/>
+    </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-75' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-75' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-83'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-75' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-75' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-83'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdopen'>
       <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-75' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-83'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-3' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-11' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-14' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-14'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-13' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-13'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
       <parameter type-id='type-id-77' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-75'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-21'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-28'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-90'/>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='voidp' type-id='type-id-43' filepath='./zconf.h' line='416' column='1' id='type-id-86'/>
+  <abi-instr address-size='64' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-92'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='x' type-id='type-id-86' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='224'>
+        <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='path' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='size' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='352'>
+        <var-decl name='want' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='in' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='448'>
+        <var-decl name='out' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='512'>
+        <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='544'>
+        <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='576'>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='640'>
+        <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='672'>
+        <var-decl name='past' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='189' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='704'>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='191' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='736'>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='192' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='768'>
+        <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='832'>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='896'>
+        <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='928'>
+        <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='960'>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='1024'>
+        <var-decl name='strm' type-id='type-id-71' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
+      </data-member>
+    </class-decl>
+    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/mips64-linux-gnuabi64/include/bits/types.h' line='194' column='1' id='type-id-93'/>
+    <typedef-decl name='gz_state' type-id='type-id-92' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-91'/>
+    <typedef-decl name='gz_statep' type-id='type-id-94' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-95'/>
+    <typedef-decl name='ssize_t' type-id='type-id-93' filepath='/usr/mips64-linux-gnuabi64/include/sys/types.h' line='108' column='1' id='type-id-96'/>
+    <pointer-type-def type-id='type-id-91' size-in-bits='64' id='type-id-94'/>
+    <typedef-decl name='voidp' type-id='type-id-85' filepath='./zconf.h' line='416' column='1' id='type-id-97'/>
+    <function-decl name='__errno_location' filepath='/usr/mips64-linux-gnuabi64/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <return type-id='type-id-77'/>
+    </function-decl>
+    <function-decl name='memchr' filepath='/usr/mips64-linux-gnuabi64/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='strerror' filepath='/usr/mips64-linux-gnuabi64/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-54'/>
+    </function-decl>
+    <function-decl name='close' filepath='/usr/mips64-linux-gnuabi64/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='read' filepath='/usr/mips64-linux-gnuabi64/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
+    </function-decl>
+    <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-95'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-86' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-86' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-66' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-54' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
       <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-66'/>
+      <return type-id='type-id-54'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/gzread.c' line='623' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzread.c' line='624' column='1'/>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <type-decl name='variadic parameter type' id='type-id-87'/>
-    <typedef-decl name='voidpc' type-id='type-id-43' filepath='./zconf.h' line='414' column='1' id='type-id-88'/>
-    <typedef-decl name='__gnuc_va_list' type-id='type-id-43' filepath='/usr/lib/gcc-cross/mips64-linux-gnuabi64/10/include/stdarg.h' line='40' column='1' id='type-id-89'/>
-    <typedef-decl name='va_list' type-id='type-id-89' filepath='/usr/lib/gcc-cross/mips64-linux-gnuabi64/10/include/stdarg.h' line='99' column='1' id='type-id-90'/>
+  <abi-instr address-size='64' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpc' type-id='type-id-85' filepath='./zconf.h' line='414' column='1' id='type-id-98'/>
+    <typedef-decl name='__gnuc_va_list' type-id='type-id-85' filepath='/usr/lib/gcc-cross/mips64-linux-gnuabi64/12/include/stdarg.h' line='40' column='1' id='type-id-99'/>
+    <typedef-decl name='va_list' type-id='type-id-99' filepath='/usr/lib/gcc-cross/mips64-linux-gnuabi64/12/include/stdarg.h' line='99' column='1' id='type-id-100'/>
+    <function-decl name='vsnprintf' filepath='/usr/mips64-linux-gnuabi64/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-85'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='memmove' filepath='/usr/mips64-linux-gnuabi64/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='write' filepath='/usr/mips64-linux-gnuabi64/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
+    </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-88' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-88' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-75' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-75' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-90' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-100' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-75' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
       <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/gzwrite.c' line='639' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-83' name='file' filepath='src.d/gzwrite.c' line='640' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <typedef-decl name='in_func' type-id='type-id-91' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-92'/>
-    <typedef-decl name='out_func' type-id='type-id-93' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-94'/>
-    <pointer-type-def type-id='type-id-95' size-in-bits='64' id='type-id-93'/>
-    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-85'/>
-    <pointer-type-def type-id='type-id-85' size-in-bits='64' id='type-id-96'/>
-    <pointer-type-def type-id='type-id-97' size-in-bits='64' id='type-id-91'/>
+  <abi-instr address-size='64' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-101' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-102'>
+      <underlying-type type-id='type-id-103'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-104' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-105'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='8'>
+        <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='16'>
+        <var-decl name='val' type-id='type-id-70' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+      </data-member>
+    </class-decl>
+    <typedef-decl name='code' type-id='type-id-105' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-104'/>
+    <typedef-decl name='codetype' type-id='type-id-102' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-101'/>
+    <typedef-decl name='in_func' type-id='type-id-106' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-107'/>
+    <typedef-decl name='out_func' type-id='type-id-108' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-109'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-103'/>
+    <pointer-type-def type-id='type-id-104' size-in-bits='64' id='type-id-110'/>
+    <pointer-type-def type-id='type-id-110' size-in-bits='64' id='type-id-111'/>
+    <pointer-type-def type-id='type-id-112' size-in-bits='64' id='type-id-108'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-87'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='64' id='type-id-113'/>
+    <pointer-type-def type-id='type-id-114' size-in-bits='64' id='type-id-106'/>
+    <pointer-type-def type-id='type-id-70' size-in-bits='64' id='type-id-115'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-116'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-85' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-75' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-87' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
-      <parameter type-id='type-id-92' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-43' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
-      <parameter type-id='type-id-94' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-43' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-107' name='in' filepath='src.d/infback.c' line='253' column='1'/>
+      <parameter type-id='type-id-85' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-109' name='out' filepath='src.d/infback.c' line='255' column='1'/>
+      <parameter type-id='type-id-85' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-28'/>
+    </function-decl>
+    <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-101'/>
+      <parameter type-id='type-id-115'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-111'/>
+      <parameter type-id='type-id-80'/>
+      <parameter type-id='type-id-115'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-type size-in-bits='64' id='type-id-95'>
-      <parameter type-id='type-id-43'/>
+    <function-type size-in-bits='64' id='type-id-112'>
       <parameter type-id='type-id-85'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-87'/>
+      <parameter type-id='type-id-11'/>
       <return type-id='type-id-20'/>
     </function-type>
-    <function-type size-in-bits='64' id='type-id-97'>
-      <parameter type-id='type-id-43'/>
-      <parameter type-id='type-id-96'/>
-      <return type-id='type-id-3'/>
+    <function-type size-in-bits='64' id='type-id-114'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-113'/>
+      <return type-id='type-id-11'/>
     </function-type>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
+  <abi-instr address-size='64' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-117'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-75' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-75' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
       <parameter type-id='type-id-79' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-58' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-56' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-56' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
       <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
       <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
       <return type-id='type-id-1'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-56' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-4'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-9'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <array-type-def dimensions='1' type-id='type-id-98' size-in-bits='2048' id='type-id-99'>
-      <subrange length='256' type-id='type-id-4' id='type-id-100'/>
+  <abi-instr address-size='64' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='2048' id='type-id-119'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-120'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-98' size-in-bits='4096' id='type-id-101'>
-      <subrange length='512' type-id='type-id-4' id='type-id-102'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='4096' id='type-id-121'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-122'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-98' size-in-bits='infinite' id='type-id-103'>
-      <subrange length='infinite' id='type-id-104'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='unknown' id='type-id-123'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-124'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-37' const='yes' id='type-id-98'/>
-    <var-decl name='_length_code' type-id='type-id-103' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
-    <var-decl name='_dist_code' type-id='type-id-103' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
+    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-118'/>
+    <var-decl name='_length_code' type-id='type-id-119' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <var-decl name='_dist_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <pointer-type-def type-id='type-id-9' size-in-bits='64' id='type-id-105'/>
+  <abi-instr address-size='64' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <pointer-type-def type-id='type-id-13' size-in-bits='64' id='type-id-125'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-105' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <parameter type-id='type-id-125' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
-  <abi-instr address-size='64' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C99'>
-    <array-type-def dimensions='1' type-id='type-id-106' size-in-bits='640' id='type-id-107'>
-      <subrange length='10' type-id='type-id-4' id='type-id-108'/>
+  <abi-instr address-size='64' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <array-type-def dimensions='1' type-id='type-id-126' size-in-bits='640' id='type-id-127'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-128'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-66' const='yes' id='type-id-106'/>
+    <qualified-type-def type-id='type-id-54' const='yes' id='type-id-126'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-75'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-9'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zError'>
       <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-75'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-107' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-127' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc-unknown-linux-gnu.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc-unknown-linux-gnu.abi
index 3d7ca82c..3eefc764 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc-unknown-linux-gnu.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc-unknown-linux-gnu.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-powerpc' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-powerpc' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
   </elf-needed>
@@ -93,75 +93,89 @@
     <elf-symbol name='zlibVersion' type='func-type' binding='global-binding' visibility='default-visibility' is-defined='yes'/>
   </elf-function-symbols>
   <abi-instr address-size='32' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='long int' size-in-bits='32' id='type-id-1'/>
-    <type-decl name='long long int' size-in-bits='64' id='type-id-2'/>
-    <type-decl name='unsigned char' size-in-bits='8' id='type-id-3'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-4'/>
-    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-5'/>
-    <typedef-decl name='z_size_t' type-id='type-id-6' filepath='./zconf.h' line='251' column='1' id='type-id-7'/>
-    <typedef-decl name='Byte' type-id='type-id-3' filepath='./zconf.h' line='397' column='1' id='type-id-8'/>
-    <typedef-decl name='uInt' type-id='type-id-4' filepath='./zconf.h' line='399' column='1' id='type-id-9'/>
-    <typedef-decl name='uLong' type-id='type-id-5' filepath='./zconf.h' line='400' column='1' id='type-id-10'/>
-    <typedef-decl name='Bytef' type-id='type-id-8' filepath='./zconf.h' line='406' column='1' id='type-id-11'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc-cross/powerpc-linux-gnu/11/include/stddef.h' line='209' column='1' id='type-id-6'/>
-    <typedef-decl name='__int64_t' type-id='type-id-2' filepath='/usr/powerpc-linux-gnu/include/bits/types.h' line='47' column='1' id='type-id-12'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/powerpc-linux-gnu/include/bits/types.h' line='152' column='1' id='type-id-13'/>
-    <typedef-decl name='__off64_t' type-id='type-id-12' filepath='/usr/powerpc-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-14'/>
-    <typedef-decl name='off_t' type-id='type-id-13' filepath='/usr/powerpc-linux-gnu/include/sys/types.h' line='85' column='1' id='type-id-15'/>
-    <typedef-decl name='off64_t' type-id='type-id-14' filepath='/usr/powerpc-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-16'/>
-    <qualified-type-def type-id='type-id-11' const='yes' id='type-id-17'/>
-    <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
+    <type-decl name='long long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__int64_t' type-id='type-id-1' filepath='/usr/powerpc-linux-gnu/include/bits/types.h' line='47' column='1' id='type-id-5'/>
+    <typedef-decl name='__off64_t' type-id='type-id-5' filepath='/usr/powerpc-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-6' filepath='/usr/powerpc-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/powerpc-linux-gnu/include/sys/types.h' line='87' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc-cross/powerpc-linux-gnu/13/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-9' filepath='./zconf.h' line='399' column='1' id='type-id-11'/>
+    <typedef-decl name='uLong' type-id='type-id-12' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
+    <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-9'/>
+    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-12'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
+    <pointer-type-def type-id='type-id-15' size-in-bits='32' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
-      <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
-      <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='uLongf' type-id='type-id-10' filepath='./zconf.h' line='411' column='1' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-19' size-in-bits='32' id='type-id-20'/>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+    <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress2'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/compress.c' line='27' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compress' mangled-name='compress' filepath='src.d/compress.c' line='68' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='z_crc_t' type-id='type-id-4' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-3' const='yes' id='type-id-24'/>
+    <typedef-decl name='z_crc_t' type-id='type-id-9' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
     <pointer-type-def type-id='type-id-24' size-in-bits='32' id='type-id-25'/>
     <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
     <pointer-type-def type-id='type-id-26' size-in-bits='32' id='type-id-27'/>
@@ -169,1118 +183,1104 @@
       <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-12' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
       <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-12' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
       <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-10' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='char' size-in-bits='8' id='type-id-28'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1248' id='type-id-31'>
-      <subrange length='39' type-id='type-id-4' id='type-id-32'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='18336' id='type-id-33'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-31'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1952' id='type-id-35'>
-      <subrange length='61' type-id='type-id-4' id='type-id-36'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='int' size-in-bits='32' id='type-id-22'/>
-    <array-type-def dimensions='1' type-id='type-id-22' size-in-bits='18336' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-35'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-38' size-in-bits='4584' id='type-id-39'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <type-decl name='int' size-in-bits='32' id='type-id-20'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-40'/>
-    <array-type-def dimensions='1' type-id='type-id-41' size-in-bits='256' id='type-id-42'>
-      <subrange length='16' type-id='type-id-4' id='type-id-43'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-44'/>
-    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-45'/>
-    <typedef-decl name='voidpf' type-id='type-id-46' filepath='./zconf.h' line='415' column='1' id='type-id-47'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-30'>
+    <type-decl name='long int' size-in-bits='32' id='type-id-37'/>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-48'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-40'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='32'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-49'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='96'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-30' filepath='src.d/deflate.h' line='77' column='1' id='type-id-50'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-29' filepath='src.d/deflate.h' line='84' column='1' id='type-id-51'/>
-    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-52'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-53' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='max_code' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='extra_len' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='stat_desc' type-id='type-id-54' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='224'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='name_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='comm_max' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='352'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-41' filepath='src.d/deflate.h' line='92' column='1' id='type-id-55'/>
-    <typedef-decl name='Posf' type-id='type-id-55' filepath='src.d/deflate.h' line='93' column='1' id='type-id-56'/>
-    <typedef-decl name='IPos' type-id='type-id-4' filepath='src.d/deflate.h' line='94' column='1' id='type-id-57'/>
-    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-58'>
+    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-41'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='status' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
+        <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pending_buf' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
+        <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='pending_buf_size' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pending_out' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
+        <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='pending' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='wrap' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
+        <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='gzhead' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='gzindex' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='method' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='last_flush' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
+        <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='w_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='w_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='w_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='window' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
+        <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='480'>
-        <var-decl name='window_size' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='prev' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='head' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='ins_h' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
-        <var-decl name='hash_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='hash_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='hash_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='hash_shift' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='736'>
-        <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
+        <var-decl name='block_start' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='match_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
-        <var-decl name='prev_match' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='match_available' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
+        <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='864'>
-        <var-decl name='strstart' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='match_start' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='928'>
-        <var-decl name='lookahead' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='prev_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='992'>
-        <var-decl name='max_chain_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='max_lazy_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='level' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='strategy' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='good_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='nice_match' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
+        <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1184'>
-        <var-decl name='dyn_ltree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='19520'>
-        <var-decl name='dyn_dtree' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21472'>
-        <var-decl name='bl_tree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22720'>
-        <var-decl name='l_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22816'>
-        <var-decl name='d_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22912'>
-        <var-decl name='bl_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23008'>
-        <var-decl name='bl_count' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23264'>
-        <var-decl name='heap' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41600'>
-        <var-decl name='heap_len' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
+        <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41632'>
-        <var-decl name='heap_max' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
+        <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41664'>
-        <var-decl name='depth' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46272'>
-        <var-decl name='sym_buf' type-id='type-id-63' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46304'>
-        <var-decl name='lit_bufsize' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46336'>
-        <var-decl name='sym_next' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46368'>
-        <var-decl name='sym_end' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46400'>
-        <var-decl name='opt_len' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46432'>
-        <var-decl name='static_len' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46464'>
-        <var-decl name='matches' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46496'>
-        <var-decl name='insert' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-11' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46528'>
-        <var-decl name='bi_buf' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46560'>
-        <var-decl name='bi_valid' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
+        <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46592'>
-        <var-decl name='high_water' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='deflate_state' type-id='type-id-58' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
-    <typedef-decl name='alloc_func' type-id='type-id-65' filepath='src.d/zlib.h' line='81' column='1' id='type-id-66'/>
-    <typedef-decl name='free_func' type-id='type-id-67' filepath='src.d/zlib.h' line='82' column='1' id='type-id-68'/>
-    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-69'>
+    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-46'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='next_in' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
+        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='avail_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='total_in' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='next_out' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='avail_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='total_out' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='msg' type-id='type-id-70' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='state' type-id='type-id-71' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='zalloc' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='zfree' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='opaque' type-id='type-id-47' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='data_type' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='adler' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='reserved' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-69' filepath='src.d/zlib.h' line='106' column='1' id='type-id-72'/>
-    <typedef-decl name='z_streamp' type-id='type-id-73' filepath='src.d/zlib.h' line='108' column='1' id='type-id-59'/>
-    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-74'>
+    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-53'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
+        <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='time' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='xflags' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='os' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
+        <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='extra' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='extra_len' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='name' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+        <var-decl name='state' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='name_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='comment' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+        <var-decl name='zfree' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='comm_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+        <var-decl name='opaque' type-id='type-id-58' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='hcrc' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+        <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='done' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='416'>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-74' filepath='src.d/zlib.h' line='129' column='1' id='type-id-75'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-76' filepath='src.d/zlib.h' line='131' column='1' id='type-id-61'/>
-    <typedef-decl name='uch' type-id='type-id-3' filepath='src.d/zutil.h' line='39' column='1' id='type-id-38'/>
-    <typedef-decl name='uchf' type-id='type-id-38' filepath='src.d/zutil.h' line='40' column='1' id='type-id-77'/>
-    <typedef-decl name='ush' type-id='type-id-40' filepath='src.d/zutil.h' line='41' column='1' id='type-id-41'/>
-    <typedef-decl name='ulg' type-id='type-id-5' filepath='src.d/zutil.h' line='43' column='1' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-21'/>
-    <pointer-type-def type-id='type-id-56' size-in-bits='32' id='type-id-62'/>
-    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-70'/>
-    <pointer-type-def type-id='type-id-45' size-in-bits='32' id='type-id-78'/>
-    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-79' size-in-bits='32' id='type-id-80'/>
-    <qualified-type-def type-id='type-id-51' const='yes' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-81' size-in-bits='32' id='type-id-54'/>
-    <pointer-type-def type-id='type-id-50' size-in-bits='32' id='type-id-53'/>
-    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-82'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-76'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='32' id='type-id-83'/>
-    <pointer-type-def type-id='type-id-58' size-in-bits='32' id='type-id-71'/>
-    <pointer-type-def type-id='type-id-84' size-in-bits='32' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-85'/>
-    <pointer-type-def type-id='type-id-77' size-in-bits='32' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-86'/>
-    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-67'/>
-    <pointer-type-def type-id='type-id-44' size-in-bits='32' id='type-id-46'/>
-    <pointer-type-def type-id='type-id-72' size-in-bits='32' id='type-id-73'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
+    <typedef-decl name='IPos' type-id='type-id-9' filepath='src.d/deflate.h' line='94' column='1' id='type-id-45'/>
+    <typedef-decl name='Pos' type-id='type-id-50' filepath='src.d/deflate.h' line='92' column='1' id='type-id-59'/>
+    <typedef-decl name='Posf' type-id='type-id-59' filepath='src.d/deflate.h' line='93' column='1' id='type-id-60'/>
+    <typedef-decl name='alloc_func' type-id='type-id-61' filepath='src.d/zlib.h' line='81' column='1' id='type-id-56'/>
+    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-62'/>
+    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-63'/>
+    <typedef-decl name='deflate_state' type-id='type-id-41' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
+    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-57'/>
+    <typedef-decl name='gz_header' type-id='type-id-40' filepath='src.d/zlib.h' line='129' column='1' id='type-id-66'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-67' filepath='src.d/zlib.h' line='131' column='1' id='type-id-43'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-68'/>
+    <typedef-decl name='uchf' type-id='type-id-68' filepath='src.d/zutil.h' line='40' column='1' id='type-id-69'/>
+    <typedef-decl name='ulg' type-id='type-id-12' filepath='src.d/zutil.h' line='43' column='1' id='type-id-42'/>
+    <typedef-decl name='ush' type-id='type-id-70' filepath='src.d/zutil.h' line='41' column='1' id='type-id-50'/>
+    <typedef-decl name='z_stream' type-id='type-id-53' filepath='src.d/zlib.h' line='106' column='1' id='type-id-71'/>
+    <typedef-decl name='z_streamp' type-id='type-id-72' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-68' size-in-bits='4584' id='type-id-48'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-39'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      </data-member>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      </data-member>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+      </data-member>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      </data-member>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-70'/>
+    <array-type-def dimensions='1' type-id='type-id-50' size-in-bits='256' id='type-id-47'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-73'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-60' size-in-bits='32' id='type-id-44'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='32' id='type-id-74'/>
+    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='32' id='type-id-51'/>
+    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-66' size-in-bits='32' id='type-id-67'/>
+    <pointer-type-def type-id='type-id-20' size-in-bits='32' id='type-id-77'/>
+    <pointer-type-def type-id='type-id-41' size-in-bits='32' id='type-id-55'/>
+    <pointer-type-def type-id='type-id-78' size-in-bits='32' id='type-id-61'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='32' id='type-id-49'/>
+    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-80'/>
+    <pointer-type-def type-id='type-id-81' size-in-bits='32' id='type-id-65'/>
+    <pointer-type-def type-id='type-id-71' size-in-bits='32' id='type-id-72'/>
+    <qualified-type-def type-id='type-id-82' const='yes' id='type-id-83'/>
+    <pointer-type-def type-id='type-id-83' size-in-bits='32' id='type-id-52'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-84'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-58'/>
     <function-decl name='memcpy' filepath='/usr/powerpc-linux-gnu/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='memset' filepath='/usr/powerpc-linux-gnu/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
-    </function-decl>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
-      <parameter type-id='type-id-22' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
-      <parameter type-id='type-id-22' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
+      <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
+      <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
-      <parameter type-id='type-id-18' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
+      <parameter type-id='type-id-11' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
-      <parameter type-id='type-id-21' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-85' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
+      <parameter type-id='type-id-79' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-61' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-86' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-83' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-80' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-77' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
-      <parameter type-id='type-id-22' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
-      <parameter type-id='type-id-22' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
+      <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
-      <parameter type-id='type-id-22' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
-      <parameter type-id='type-id-22' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
-      <parameter type-id='type-id-22' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
-      <parameter type-id='type-id-22' name='max_chain' filepath='src.d/deflate.c' line='659' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
+      <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
+      <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
+      <parameter type-id='type-id-20' name='max_chain' filepath='src.d/deflate.c' line='659' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-10'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-59' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-59' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-84' filepath='src.d/deflate.h' line='84' column='1' id='type-id-82'/>
     <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-60'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-60'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-76'/>
+      <parameter type-id='type-id-74'/>
+      <parameter type-id='type-id-42'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-4'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-47'/>
-    </function-decl>
-    <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-47'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-type size-in-bits='32' id='type-id-84'>
-      <parameter type-id='type-id-47'/>
+      <parameter type-id='type-id-58'/>
       <parameter type-id='type-id-9'/>
       <parameter type-id='type-id-9'/>
-      <return type-id='type-id-47'/>
+      <return type-id='type-id-58'/>
+    </function-decl>
+    <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-86'/>
+    <pointer-type-def type-id='type-id-86' id='type-id-85'/>
+    <function-type size-in-bits='32' id='type-id-81'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-58'/>
+      <return type-id='type-id-86'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-87'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-47'/>
-      <return type-id='type-id-44'/>
+    <function-type size-in-bits='32' id='type-id-78'>
+      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-58'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
-    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-90'>
+    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-87'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-4' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='next' type-id='type-id-91' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-88' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pos' type-id='type-id-16' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-90' size-in-bits='32' id='type-id-88'/>
+    <typedef-decl name='gzFile' type-id='type-id-89' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-90'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-89'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-90'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-90'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='variadic parameter type' id='type-id-92'/>
-    <function-decl name='open' filepath='/usr/powerpc-linux-gnu/include/fcntl.h' line='181' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-80'/>
+    <function-decl name='snprintf' filepath='/usr/powerpc-linux-gnu/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
       <parameter type-id='type-id-22'/>
       <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='snprintf' filepath='/usr/powerpc-linux-gnu/include/stdio.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-70'/>
-      <parameter type-id='type-id-6'/>
-      <parameter type-id='type-id-80'/>
-      <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+    <function-decl name='malloc' filepath='/usr/powerpc-linux-gnu/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/powerpc-linux-gnu/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-85'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='strlen' filepath='/usr/powerpc-linux-gnu/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='lseek64' filepath='/usr/powerpc-linux-gnu/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-14'/>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-6'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-6'/>
     </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-80' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-80' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdopen'>
-      <parameter type-id='type-id-22' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-90'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-4' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-9' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-16' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
-      <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-15' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
-      <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-83' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-80'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-77' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-86'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-91'/>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidp' type-id='type-id-46' filepath='./zconf.h' line='416' column='1' id='type-id-93'/>
-    <typedef-decl name='__ssize_t' type-id='type-id-22' filepath='/usr/powerpc-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-94'/>
-    <typedef-decl name='ssize_t' type-id='type-id-94' filepath='/usr/powerpc-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-95'/>
-    <class-decl name='gz_state' size-in-bits='1344' is-struct='yes' naming-typedef-id='type-id-96' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-97'>
+    <class-decl name='gz_state' size-in-bits='1344' is-struct='yes' naming-typedef-id='type-id-92' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-93'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='x' type-id='type-id-90' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+        <var-decl name='x' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='mode' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
+        <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='fd' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
+        <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='path' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+        <var-decl name='path' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='size' type-id='type-id-4' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+        <var-decl name='size' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='want' type-id='type-id-4' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+        <var-decl name='want' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='in' type-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+        <var-decl name='in' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='out' type-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+        <var-decl name='out' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='direct' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
+        <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='how' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
+        <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='start' type-id='type-id-16' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='eof' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
+        <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='past' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='189' column='1'/>
+        <var-decl name='past' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='level' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='191' column='1'/>
+        <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
-        <var-decl name='strategy' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='192' column='1'/>
+        <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='192' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='reset' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
+        <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='skip' type-id='type-id-16' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='seek' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
+        <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
-        <var-decl name='err' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
+        <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='msg' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+        <var-decl name='msg' type-id='type-id-54' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='864'>
-        <var-decl name='strm' type-id='type-id-72' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
+        <var-decl name='strm' type-id='type-id-71' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_state' type-id='type-id-97' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-96'/>
-    <typedef-decl name='gz_statep' type-id='type-id-98' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-99'/>
-    <pointer-type-def type-id='type-id-96' size-in-bits='32' id='type-id-98'/>
+    <typedef-decl name='__ssize_t' type-id='type-id-20' filepath='/usr/powerpc-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-94'/>
+    <typedef-decl name='gz_state' type-id='type-id-93' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-92'/>
+    <typedef-decl name='gz_statep' type-id='type-id-95' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-96'/>
+    <typedef-decl name='ssize_t' type-id='type-id-94' filepath='/usr/powerpc-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-97'/>
+    <pointer-type-def type-id='type-id-92' size-in-bits='32' id='type-id-95'/>
+    <typedef-decl name='voidp' type-id='type-id-85' filepath='./zconf.h' line='416' column='1' id='type-id-98'/>
     <function-decl name='__errno_location' filepath='/usr/powerpc-linux-gnu/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <return type-id='type-id-83'/>
+      <return type-id='type-id-77'/>
     </function-decl>
     <function-decl name='memchr' filepath='/usr/powerpc-linux-gnu/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='strerror' filepath='/usr/powerpc-linux-gnu/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-70'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-54'/>
     </function-decl>
     <function-decl name='close' filepath='/usr/powerpc-linux-gnu/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='read' filepath='/usr/powerpc-linux-gnu/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-95'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-97'/>
     </function-decl>
     <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-99'/>
+      <parameter type-id='type-id-96'/>
+      <parameter type-id='type-id-20'/>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-44'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-93' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-9' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-93' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-22' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-70' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
-      <parameter type-id='type-id-22' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-70'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-54' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
+      <return type-id='type-id-54'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <class-decl name='__va_list_tag' size-in-bits='96' is-struct='yes' visibility='default' id='type-id-100'>
+    <class-decl name='__va_list_tag' size-in-bits='96' is-struct='yes' visibility='default' id='type-id-99'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='gpr' type-id='type-id-3' visibility='default'/>
+        <var-decl name='gpr' type-id='type-id-2' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='8'>
-        <var-decl name='fpr' type-id='type-id-3' visibility='default'/>
+        <var-decl name='fpr' type-id='type-id-2' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='reserved' type-id='type-id-40' visibility='default'/>
+        <var-decl name='reserved' type-id='type-id-70' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='overflow_arg_area' type-id='type-id-46' visibility='default'/>
+        <var-decl name='overflow_arg_area' type-id='type-id-85' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='reg_save_area' type-id='type-id-46' visibility='default'/>
+        <var-decl name='reg_save_area' type-id='type-id-85' visibility='default'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='voidpc' type-id='type-id-46' filepath='./zconf.h' line='414' column='1' id='type-id-101'/>
-    <pointer-type-def type-id='type-id-100' size-in-bits='32' id='type-id-102'/>
-    <function-decl name='vsnprintf' filepath='/usr/powerpc-linux-gnu/include/stdio.h' line='382' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-70'/>
-      <parameter type-id='type-id-6'/>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-102'/>
-      <return type-id='type-id-22'/>
+    <pointer-type-def type-id='type-id-99' size-in-bits='32' id='type-id-100'/>
+    <typedef-decl name='voidpc' type-id='type-id-85' filepath='./zconf.h' line='414' column='1' id='type-id-101'/>
+    <function-decl name='vsnprintf' filepath='/usr/powerpc-linux-gnu/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-54'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-100'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='memmove' filepath='/usr/powerpc-linux-gnu/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='write' filepath='/usr/powerpc-linux-gnu/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-95'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-97'/>
     </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
       <parameter type-id='type-id-101' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-9' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
       <parameter type-id='type-id-101' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
-      <parameter type-id='type-id-22' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-80' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-80' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-102' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-100' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-80' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
-      <return type-id='type-id-22'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
-      <parameter type-id='type-id-22' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-90' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
+      <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-103'/>
-    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-104' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-105'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-102' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-103'>
+      <underlying-type type-id='type-id-104'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-105' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-106'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='op' type-id='type-id-3' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
+        <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='8'>
-        <var-decl name='bits' type-id='type-id-3' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
+        <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='val' type-id='type-id-40' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+        <var-decl name='val' type-id='type-id-70' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='code' type-id='type-id-105' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-104'/>
-    <enum-decl name='codetype' naming-typedef-id='type-id-106' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-107'>
-      <underlying-type type-id='type-id-103'/>
-      <enumerator name='CODES' value='0'/>
-      <enumerator name='LENS' value='1'/>
-      <enumerator name='DISTS' value='2'/>
-    </enum-decl>
-    <typedef-decl name='codetype' type-id='type-id-107' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-106'/>
-    <typedef-decl name='in_func' type-id='type-id-108' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-109'/>
-    <typedef-decl name='out_func' type-id='type-id-110' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-111'/>
-    <pointer-type-def type-id='type-id-104' size-in-bits='32' id='type-id-112'/>
-    <pointer-type-def type-id='type-id-112' size-in-bits='32' id='type-id-113'/>
-    <pointer-type-def type-id='type-id-114' size-in-bits='32' id='type-id-110'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='32' id='type-id-91'/>
-    <pointer-type-def type-id='type-id-91' size-in-bits='32' id='type-id-115'/>
-    <pointer-type-def type-id='type-id-116' size-in-bits='32' id='type-id-108'/>
-    <pointer-type-def type-id='type-id-40' size-in-bits='32' id='type-id-117'/>
+    <typedef-decl name='code' type-id='type-id-106' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-105'/>
+    <typedef-decl name='codetype' type-id='type-id-103' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-102'/>
+    <typedef-decl name='in_func' type-id='type-id-107' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-108'/>
+    <typedef-decl name='out_func' type-id='type-id-109' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-110'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-104'/>
+    <pointer-type-def type-id='type-id-105' size-in-bits='32' id='type-id-111'/>
+    <pointer-type-def type-id='type-id-111' size-in-bits='32' id='type-id-112'/>
+    <pointer-type-def type-id='type-id-113' size-in-bits='32' id='type-id-109'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='32' id='type-id-88'/>
+    <pointer-type-def type-id='type-id-88' size-in-bits='32' id='type-id-114'/>
+    <pointer-type-def type-id='type-id-115' size-in-bits='32' id='type-id-107'/>
+    <pointer-type-def type-id='type-id-70' size-in-bits='32' id='type-id-116'/>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-117'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-91' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/infback.c' line='32' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
+      <parameter type-id='type-id-88' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
-      <parameter type-id='type-id-109' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-46' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
-      <parameter type-id='type-id-111' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-46' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-108' name='in' filepath='src.d/infback.c' line='253' column='1'/>
+      <parameter type-id='type-id-85' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-110' name='out' filepath='src.d/infback.c' line='255' column='1'/>
+      <parameter type-id='type-id-85' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-59'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-9'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-106'/>
-      <parameter type-id='type-id-117'/>
-      <parameter type-id='type-id-4'/>
-      <parameter type-id='type-id-113'/>
-      <parameter type-id='type-id-86'/>
-      <parameter type-id='type-id-117'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-102'/>
+      <parameter type-id='type-id-116'/>
+      <parameter type-id='type-id-9'/>
+      <parameter type-id='type-id-112'/>
+      <parameter type-id='type-id-80'/>
+      <parameter type-id='type-id-116'/>
+      <return type-id='type-id-20'/>
     </function-decl>
-    <function-type size-in-bits='32' id='type-id-114'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-91'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-22'/>
+    <function-type size-in-bits='32' id='type-id-113'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-88'/>
+      <parameter type-id='type-id-9'/>
+      <return type-id='type-id-20'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-116'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-115'/>
-      <return type-id='type-id-4'/>
+    <function-type size-in-bits='32' id='type-id-115'>
+      <parameter type-id='type-id-85'/>
+      <parameter type-id='type-id-114'/>
+      <return type-id='type-id-9'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-85' filepath='./zconf.h' line='415' column='1' id='type-id-118'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
-      <parameter type-id='type-id-22' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
-      <parameter type-id='type-id-22' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
+      <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
-      <parameter type-id='type-id-21' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-85' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
+      <parameter type-id='type-id-79' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
-      <parameter type-id='type-id-18' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
+      <parameter type-id='type-id-11' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-61' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-43' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-59' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
-      <parameter type-id='type-id-22' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
-      <parameter type-id='type-id-22' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
-      <return type-id='type-id-1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <return type-id='type-id-37'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-12'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='2048' id='type-id-119'>
-      <subrange length='256' type-id='type-id-4' id='type-id-120'/>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='2048' id='type-id-120'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-121'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='4096' id='type-id-121'>
-      <subrange length='512' type-id='type-id-4' id='type-id-122'/>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='4096' id='type-id-122'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-123'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='infinite' id='type-id-123'>
-      <subrange length='infinite' id='type-id-124'/>
+    <array-type-def dimensions='1' type-id='type-id-119' size-in-bits='unknown' id='type-id-124'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-125'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-38' const='yes' id='type-id-118'/>
-    <var-decl name='_length_code' type-id='type-id-123' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
-    <var-decl name='_dist_code' type-id='type-id-123' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
+    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-119'/>
+    <var-decl name='_length_code' type-id='type-id-120' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <var-decl name='_dist_code' type-id='type-id-122' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <pointer-type-def type-id='type-id-10' size-in-bits='32' id='type-id-125'/>
+    <pointer-type-def type-id='type-id-13' size-in-bits='32' id='type-id-126'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-125' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
+      <parameter type-id='type-id-126' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress'>
-      <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
-      <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
-      <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
+      <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
+      <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-126' size-in-bits='320' id='type-id-127'>
-      <subrange length='10' type-id='type-id-4' id='type-id-128'/>
+    <array-type-def dimensions='1' type-id='type-id-127' size-in-bits='320' id='type-id-128'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-129'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-70' const='yes' id='type-id-126'/>
-    <function-decl name='malloc' filepath='/usr/powerpc-linux-gnu/include/stdlib.h' line='540' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
-    </function-decl>
-    <function-decl name='free' filepath='/usr/powerpc-linux-gnu/include/stdlib.h' line='555' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
+    <qualified-type-def type-id='type-id-54' const='yes' id='type-id-127'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-80'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-10'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zError'>
-      <parameter type-id='type-id-22' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-80'/>
+      <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-127' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-128' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc64-unknown-linux-gnu.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc64-unknown-linux-gnu.abi
index ad037fd6..34cbcdc5 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc64-unknown-linux-gnu.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc64-unknown-linux-gnu.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-powerpc-64' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-powerpc-64' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
   </elf-needed>
@@ -94,54 +94,54 @@
   </elf-function-symbols>
   <abi-instr address-size='64' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/powerpc64-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-5'/>
+    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/powerpc64-linux-gnu/include/bits/types.h' line='152' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-5' filepath='/usr/powerpc64-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/powerpc64-linux-gnu/include/sys/types.h' line='85' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc-cross/powerpc64-linux-gnu/13/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-11' filepath='./zconf.h' line='399' column='1' id='type-id-12'/>
+    <typedef-decl name='uLong' type-id='type-id-9' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
     <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-3'/>
-    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-4'/>
-    <typedef-decl name='z_size_t' type-id='type-id-5' filepath='./zconf.h' line='251' column='1' id='type-id-6'/>
-    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-7'/>
-    <typedef-decl name='uInt' type-id='type-id-3' filepath='./zconf.h' line='399' column='1' id='type-id-8'/>
-    <typedef-decl name='uLong' type-id='type-id-4' filepath='./zconf.h' line='400' column='1' id='type-id-9'/>
-    <typedef-decl name='Bytef' type-id='type-id-7' filepath='./zconf.h' line='406' column='1' id='type-id-10'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc-cross/powerpc64-linux-gnu/11/include/stddef.h' line='209' column='1' id='type-id-5'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/powerpc64-linux-gnu/include/bits/types.h' line='152' column='1' id='type-id-11'/>
-    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/powerpc64-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-12'/>
-    <typedef-decl name='off_t' type-id='type-id-11' filepath='/usr/powerpc64-linux-gnu/include/sys/types.h' line='85' column='1' id='type-id-13'/>
-    <typedef-decl name='off64_t' type-id='type-id-12' filepath='/usr/powerpc64-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-14'/>
-    <qualified-type-def type-id='type-id-10' const='yes' id='type-id-15'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-11'/>
+    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-9'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
     <pointer-type-def type-id='type-id-15' size-in-bits='64' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='uLongf' type-id='type-id-9' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
     <pointer-type-def type-id='type-id-17' size-in-bits='64' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compress2'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
@@ -149,131 +149,145 @@
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='z_crc_t' type-id='type-id-3' filepath='./zconf.h' line='435' column='1' id='type-id-21'/>
-    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-22'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='64' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-21' const='yes' id='type-id-24'/>
+    <typedef-decl name='z_crc_t' type-id='type-id-11' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
     <pointer-type-def type-id='type-id-24' size-in-bits='64' id='type-id-25'/>
+    <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
+    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-27'/>
     <function-decl name='get_crc_table' mangled-name='get_crc_table' filepath='src.d/crc32.c' line='595' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='get_crc_table'>
-      <return type-id='type-id-25'/>
+      <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
-      <parameter type-id='type-id-23' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
-      <parameter type-id='type-id-23' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-9' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='char' size-in-bits='8' id='type-id-26'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-27'/>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='1248' id='type-id-29'>
-      <subrange length='39' type-id='type-id-4' id='type-id-30'/>
+    <type-decl name='char' size-in-bits='8' id='type-id-28'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-31'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='18336' id='type-id-31'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='1952' id='type-id-33'>
-      <subrange length='61' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-35'/>
     </array-type-def>
     <type-decl name='int' size-in-bits='32' id='type-id-20'/>
-    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-35'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-36' size-in-bits='4584' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-38'/>
-    <array-type-def dimensions='1' type-id='type-id-39' size-in-bits='256' id='type-id-40'>
-      <subrange length='16' type-id='type-id-4' id='type-id-41'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-42'/>
-    <typedef-decl name='charf' type-id='type-id-26' filepath='./zconf.h' line='408' column='1' id='type-id-43'/>
-    <typedef-decl name='voidpf' type-id='type-id-44' filepath='./zconf.h' line='415' column='1' id='type-id-45'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-28'>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-46'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-39'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-47'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-28' filepath='src.d/deflate.h' line='77' column='1' id='type-id-48'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-27' filepath='src.d/deflate.h' line='84' column='1' id='type-id-49'/>
-    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-50'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='extra_len' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='extra_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='name_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='448'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='512'>
+        <var-decl name='comm_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='544'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='576'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-39' filepath='src.d/deflate.h' line='92' column='1' id='type-id-53'/>
-    <typedef-decl name='Posf' type-id='type-id-53' filepath='src.d/deflate.h' line='93' column='1' id='type-id-54'/>
-    <typedef-decl name='IPos' type-id='type-id-3' filepath='src.d/deflate.h' line='94' column='1' id='type-id-55'/>
-    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-56'>
+    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-40'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
         <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
@@ -282,94 +296,94 @@
         <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='pending_buf_size' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
         <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='pending' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
         <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='gzhead' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='gzindex' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='method' type-id='type-id-7' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
         <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='w_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='w_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='w_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
         <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='window_size' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='prev' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='head' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='ins_h' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='hash_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='hash_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='hash_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='hash_shift' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1216'>
         <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1280'>
-        <var-decl name='match_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1312'>
-        <var-decl name='prev_match' type-id='type-id-55' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1344'>
         <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1376'>
-        <var-decl name='strstart' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1408'>
-        <var-decl name='match_start' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1440'>
-        <var-decl name='lookahead' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1472'>
-        <var-decl name='prev_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1504'>
-        <var-decl name='max_chain_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1536'>
-        <var-decl name='max_lazy_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1568'>
         <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
@@ -378,34 +392,34 @@
         <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1632'>
-        <var-decl name='good_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1664'>
         <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1696'>
-        <var-decl name='dyn_ltree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='20032'>
-        <var-decl name='dyn_dtree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21984'>
-        <var-decl name='bl_tree' type-id='type-id-29' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23232'>
-        <var-decl name='l_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23424'>
-        <var-decl name='d_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23616'>
-        <var-decl name='bl_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23808'>
-        <var-decl name='bl_count' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='24064'>
-        <var-decl name='heap' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42400'>
         <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
@@ -414,234 +428,225 @@
         <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42464'>
-        <var-decl name='depth' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47104'>
-        <var-decl name='sym_buf' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47168'>
-        <var-decl name='lit_bufsize' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47200'>
-        <var-decl name='sym_next' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47232'>
-        <var-decl name='sym_end' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47296'>
-        <var-decl name='opt_len' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47360'>
-        <var-decl name='static_len' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47424'>
-        <var-decl name='matches' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47456'>
-        <var-decl name='insert' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47488'>
-        <var-decl name='bi_buf' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47520'>
         <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47552'>
-        <var-decl name='high_water' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='deflate_state' type-id='type-id-56' filepath='src.d/deflate.h' line='271' column='1' id='type-id-62'/>
-    <typedef-decl name='alloc_func' type-id='type-id-63' filepath='src.d/zlib.h' line='81' column='1' id='type-id-64'/>
-    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-66'/>
-    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-67'>
+    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-45'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='dyn_tree' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='stat_desc' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      </data-member>
+    </class-decl>
+    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-52'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='avail_in' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='total_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='avail_out' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='total_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
+        <var-decl name='msg' type-id='type-id-53' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='state' type-id='type-id-69' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
+        <var-decl name='state' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='zalloc' type-id='type-id-64' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='zfree' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
+        <var-decl name='zfree' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='opaque' type-id='type-id-45' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
+        <var-decl name='opaque' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
         <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='adler' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='reserved' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-67' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
-    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-57'/>
-    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-72'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='time' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='extra_len' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='extra_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='name_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+    <typedef-decl name='IPos' type-id='type-id-11' filepath='src.d/deflate.h' line='94' column='1' id='type-id-44'/>
+    <typedef-decl name='Pos' type-id='type-id-49' filepath='src.d/deflate.h' line='92' column='1' id='type-id-58'/>
+    <typedef-decl name='Posf' type-id='type-id-58' filepath='src.d/deflate.h' line='93' column='1' id='type-id-59'/>
+    <typedef-decl name='alloc_func' type-id='type-id-60' filepath='src.d/zlib.h' line='81' column='1' id='type-id-55'/>
+    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-61'/>
+    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-62'/>
+    <typedef-decl name='deflate_state' type-id='type-id-40' filepath='src.d/deflate.h' line='271' column='1' id='type-id-63'/>
+    <typedef-decl name='free_func' type-id='type-id-64' filepath='src.d/zlib.h' line='82' column='1' id='type-id-56'/>
+    <typedef-decl name='gz_header' type-id='type-id-39' filepath='src.d/zlib.h' line='129' column='1' id='type-id-65'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-66' filepath='src.d/zlib.h' line='131' column='1' id='type-id-42'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-67'/>
+    <typedef-decl name='uchf' type-id='type-id-67' filepath='src.d/zutil.h' line='40' column='1' id='type-id-68'/>
+    <typedef-decl name='ulg' type-id='type-id-9' filepath='src.d/zutil.h' line='43' column='1' id='type-id-41'/>
+    <typedef-decl name='ush' type-id='type-id-69' filepath='src.d/zutil.h' line='41' column='1' id='type-id-49'/>
+    <typedef-decl name='z_stream' type-id='type-id-52' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
+    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-67' size-in-bits='4584' id='type-id-47'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='comm_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-37'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
       </data-member>
-    </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-72' filepath='src.d/zlib.h' line='129' column='1' id='type-id-73'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-74' filepath='src.d/zlib.h' line='131' column='1' id='type-id-59'/>
-    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-36'/>
-    <typedef-decl name='uchf' type-id='type-id-36' filepath='src.d/zutil.h' line='40' column='1' id='type-id-75'/>
-    <typedef-decl name='ush' type-id='type-id-38' filepath='src.d/zutil.h' line='41' column='1' id='type-id-39'/>
-    <typedef-decl name='ulg' type-id='type-id-4' filepath='src.d/zutil.h' line='43' column='1' id='type-id-58'/>
-    <pointer-type-def type-id='type-id-10' size-in-bits='64' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-54' size-in-bits='64' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-68'/>
-    <pointer-type-def type-id='type-id-43' size-in-bits='64' id='type-id-76'/>
-    <qualified-type-def type-id='type-id-26' const='yes' id='type-id-77'/>
-    <pointer-type-def type-id='type-id-77' size-in-bits='64' id='type-id-78'/>
-    <qualified-type-def type-id='type-id-49' const='yes' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-79' size-in-bits='64' id='type-id-52'/>
-    <pointer-type-def type-id='type-id-48' size-in-bits='64' id='type-id-51'/>
-    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-80'/>
-    <pointer-type-def type-id='type-id-73' size-in-bits='64' id='type-id-74'/>
-    <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-56' size-in-bits='64' id='type-id-69'/>
-    <pointer-type-def type-id='type-id-82' size-in-bits='64' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-8' size-in-bits='64' id='type-id-83'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='64' id='type-id-61'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='64' id='type-id-84'/>
-    <pointer-type-def type-id='type-id-85' size-in-bits='64' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-42' size-in-bits='64' id='type-id-44'/>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-69'/>
+    <array-type-def dimensions='1' type-id='type-id-49' size-in-bits='256' id='type-id-46'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-72'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='64' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-59' size-in-bits='64' id='type-id-43'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='64' id='type-id-53'/>
+    <pointer-type-def type-id='type-id-61' size-in-bits='64' id='type-id-73'/>
+    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-74'/>
+    <pointer-type-def type-id='type-id-74' size-in-bits='64' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-50'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='64' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-65' size-in-bits='64' id='type-id-66'/>
+    <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-40' size-in-bits='64' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-77' size-in-bits='64' id='type-id-60'/>
+    <pointer-type-def type-id='type-id-12' size-in-bits='64' id='type-id-78'/>
+    <pointer-type-def type-id='type-id-68' size-in-bits='64' id='type-id-48'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='64' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-80' size-in-bits='64' id='type-id-64'/>
     <pointer-type-def type-id='type-id-70' size-in-bits='64' id='type-id-71'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-27'/>
+    <qualified-type-def type-id='type-id-81' const='yes' id='type-id-82'/>
+    <pointer-type-def type-id='type-id-82' size-in-bits='64' id='type-id-51'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-83'/>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-57'/>
     <function-decl name='memcpy' filepath='/usr/powerpc64-linux-gnu/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='memset' filepath='/usr/powerpc64-linux-gnu/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
       <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
       <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-83' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <parameter type-id='type-id-78' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-59' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-42' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-84' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-81' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-79' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-76' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
       <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
       <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
       <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
@@ -649,198 +654,203 @@
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-9'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-20'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-57' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-57' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-83' filepath='src.d/deflate.h' line='84' column='1' id='type-id-81'/>
     <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-76'/>
-      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-73'/>
+      <parameter type-id='type-id-41'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-42'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-76'/>
-      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-73'/>
+      <parameter type-id='type-id-41'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-42'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-3'/>
-      <parameter type-id='type-id-3'/>
-      <return type-id='type-id-45'/>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-57'/>
     </function-decl>
     <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-45'/>
-      <return type-id='type-id-42'/>
-    </function-decl>
-    <function-type size-in-bits='64' id='type-id-82'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-8'/>
-      <parameter type-id='type-id-8'/>
-      <return type-id='type-id-45'/>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-57'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-85'/>
+    <pointer-type-def type-id='type-id-85' id='type-id-84'/>
+    <function-type size-in-bits='64' id='type-id-80'>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-57'/>
+      <return type-id='type-id-85'/>
     </function-type>
-    <function-type size-in-bits='64' id='type-id-85'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-45'/>
-      <return type-id='type-id-42'/>
+    <function-type size-in-bits='64' id='type-id-77'>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-57'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='gzFile' type-id='type-id-86' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-87'/>
-    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-88'>
+    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-86'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-3' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='next' type-id='type-id-89' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-87' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pos' type-id='type-id-14' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-88' size-in-bits='64' id='type-id-86'/>
+    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
+    <pointer-type-def type-id='type-id-86' size-in-bits='64' id='type-id-88'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87'/>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87'/>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='variadic parameter type' id='type-id-90'/>
-    <function-decl name='open' filepath='/usr/powerpc64-linux-gnu/include/fcntl.h' line='181' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-78'/>
+    <function-decl name='open' filepath='/usr/powerpc64-linux-gnu/include/fcntl.h' line='209' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-22'/>
       <parameter type-id='type-id-20'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='snprintf' filepath='/usr/powerpc64-linux-gnu/include/stdio.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-68'/>
-      <parameter type-id='type-id-5'/>
-      <parameter type-id='type-id-78'/>
+    <function-decl name='snprintf' filepath='/usr/powerpc64-linux-gnu/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-53'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
+    <function-decl name='malloc' filepath='/usr/powerpc64-linux-gnu/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/powerpc64-linux-gnu/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-84'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
     <function-decl name='strlen' filepath='/usr/powerpc64-linux-gnu/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-78'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='lseek64' filepath='/usr/powerpc64-linux-gnu/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-5'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-12'/>
+      <return type-id='type-id-5'/>
     </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-78' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-78' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdopen'>
       <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-3' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-11' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-14' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-14'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-13' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-13'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-81' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-78'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-76' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-85'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-90'/>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidp' type-id='type-id-44' filepath='./zconf.h' line='416' column='1' id='type-id-91'/>
-    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/powerpc64-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-92'/>
-    <typedef-decl name='ssize_t' type-id='type-id-92' filepath='/usr/powerpc64-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-93'/>
-    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-94' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-95'>
+    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-92'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='x' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+        <var-decl name='x' type-id='type-id-86' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
@@ -849,19 +859,19 @@
         <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='path' type-id='type-id-68' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+        <var-decl name='path' type-id='type-id-53' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='size' type-id='type-id-3' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+        <var-decl name='size' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='want' type-id='type-id-3' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+        <var-decl name='want' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='in' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+        <var-decl name='in' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='out' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+        <var-decl name='out' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
         <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
@@ -870,7 +880,7 @@
         <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='start' type-id='type-id-14' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
         <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
@@ -888,7 +898,7 @@
         <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='skip' type-id='type-id-14' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
         <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
@@ -897,27 +907,30 @@
         <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+        <var-decl name='msg' type-id='type-id-53' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
         <var-decl name='strm' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_state' type-id='type-id-95' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-94'/>
-    <typedef-decl name='gz_statep' type-id='type-id-96' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-97'/>
-    <pointer-type-def type-id='type-id-94' size-in-bits='64' id='type-id-96'/>
+    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/powerpc64-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-93'/>
+    <typedef-decl name='gz_state' type-id='type-id-92' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-91'/>
+    <typedef-decl name='gz_statep' type-id='type-id-94' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-95'/>
+    <typedef-decl name='ssize_t' type-id='type-id-93' filepath='/usr/powerpc64-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-96'/>
+    <pointer-type-def type-id='type-id-91' size-in-bits='64' id='type-id-94'/>
+    <typedef-decl name='voidp' type-id='type-id-84' filepath='./zconf.h' line='416' column='1' id='type-id-97'/>
     <function-decl name='__errno_location' filepath='/usr/powerpc64-linux-gnu/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <return type-id='type-id-81'/>
+      <return type-id='type-id-76'/>
     </function-decl>
     <function-decl name='memchr' filepath='/usr/powerpc64-linux-gnu/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='strerror' filepath='/usr/powerpc64-linux-gnu/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-68'/>
+      <return type-id='type-id-53'/>
     </function-decl>
     <function-decl name='close' filepath='/usr/powerpc64-linux-gnu/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
@@ -925,126 +938,151 @@
     </function-decl>
     <function-decl name='read' filepath='/usr/powerpc64-linux-gnu/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-93'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
     </function-decl>
     <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-97'/>
+      <parameter type-id='type-id-95'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-78'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-91' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-91' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-68' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-53' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
       <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-68'/>
+      <return type-id='type-id-53'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidpc' type-id='type-id-44' filepath='./zconf.h' line='414' column='1' id='type-id-98'/>
-    <typedef-decl name='__gnuc_va_list' type-id='type-id-68' filepath='/usr/lib/gcc-cross/powerpc64-linux-gnu/11/include/stdarg.h' line='40' column='1' id='type-id-99'/>
-    <typedef-decl name='va_list' type-id='type-id-99' filepath='/usr/lib/gcc-cross/powerpc64-linux-gnu/11/include/stdarg.h' line='99' column='1' id='type-id-100'/>
-    <function-decl name='vsnprintf' filepath='/usr/powerpc64-linux-gnu/include/stdio.h' line='382' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-68'/>
-      <parameter type-id='type-id-5'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-68'/>
+    <typedef-decl name='__gnuc_va_list' type-id='type-id-53' filepath='/usr/lib/gcc-cross/powerpc64-linux-gnu/13/include/stdarg.h' line='40' column='1' id='type-id-98'/>
+    <typedef-decl name='va_list' type-id='type-id-98' filepath='/usr/lib/gcc-cross/powerpc64-linux-gnu/13/include/stdarg.h' line='103' column='1' id='type-id-99'/>
+    <typedef-decl name='voidpc' type-id='type-id-84' filepath='./zconf.h' line='414' column='1' id='type-id-100'/>
+    <function-decl name='vsnprintf' filepath='/usr/powerpc64-linux-gnu/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-53'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-53'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='memmove' filepath='/usr/powerpc64-linux-gnu/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='write' filepath='/usr/powerpc64-linux-gnu/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-93'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
     </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-100' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-100' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-78' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-78' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-100' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-99' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-78' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
       <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-101'/>
-    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-102' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-103'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-101' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-102'>
+      <underlying-type type-id='type-id-103'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-104' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-105'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
       </data-member>
@@ -1052,217 +1090,186 @@
         <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='val' type-id='type-id-38' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+        <var-decl name='val' type-id='type-id-69' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='code' type-id='type-id-103' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-102'/>
-    <enum-decl name='codetype' naming-typedef-id='type-id-104' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-105'>
-      <underlying-type type-id='type-id-101'/>
-      <enumerator name='CODES' value='0'/>
-      <enumerator name='LENS' value='1'/>
-      <enumerator name='DISTS' value='2'/>
-    </enum-decl>
-    <typedef-decl name='codetype' type-id='type-id-105' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-104'/>
+    <typedef-decl name='code' type-id='type-id-105' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-104'/>
+    <typedef-decl name='codetype' type-id='type-id-102' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-101'/>
     <typedef-decl name='in_func' type-id='type-id-106' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-107'/>
     <typedef-decl name='out_func' type-id='type-id-108' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-109'/>
-    <pointer-type-def type-id='type-id-102' size-in-bits='64' id='type-id-110'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-103'/>
+    <pointer-type-def type-id='type-id-104' size-in-bits='64' id='type-id-110'/>
     <pointer-type-def type-id='type-id-110' size-in-bits='64' id='type-id-111'/>
     <pointer-type-def type-id='type-id-112' size-in-bits='64' id='type-id-108'/>
-    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-89'/>
-    <pointer-type-def type-id='type-id-89' size-in-bits='64' id='type-id-113'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-87'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='64' id='type-id-113'/>
     <pointer-type-def type-id='type-id-114' size-in-bits='64' id='type-id-106'/>
-    <pointer-type-def type-id='type-id-38' size-in-bits='64' id='type-id-115'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='64' id='type-id-115'/>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-116'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-89' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-87' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
       <parameter type-id='type-id-107' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-44' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-84' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
       <parameter type-id='type-id-109' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-44' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <parameter type-id='type-id-84' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-57'/>
-      <parameter type-id='type-id-3'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-104'/>
+      <parameter type-id='type-id-101'/>
       <parameter type-id='type-id-115'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-11'/>
       <parameter type-id='type-id-111'/>
-      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-79'/>
       <parameter type-id='type-id-115'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-type size-in-bits='64' id='type-id-112'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-89'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-87'/>
+      <parameter type-id='type-id-11'/>
       <return type-id='type-id-20'/>
     </function-type>
     <function-type size-in-bits='64' id='type-id-114'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-113'/>
-      <return type-id='type-id-3'/>
+      <return type-id='type-id-11'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-117'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-83' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <parameter type-id='type-id-78' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-59' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-42' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-57' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
       <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
       <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
       <return type-id='type-id-1'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-4'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-9'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='2048' id='type-id-117'>
-      <subrange length='256' type-id='type-id-4' id='type-id-118'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='2048' id='type-id-119'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-120'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='4096' id='type-id-119'>
-      <subrange length='512' type-id='type-id-4' id='type-id-120'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='4096' id='type-id-121'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-122'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='infinite' id='type-id-121'>
-      <subrange length='infinite' id='type-id-122'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='unknown' id='type-id-123'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-124'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-36' const='yes' id='type-id-116'/>
-    <var-decl name='_length_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <qualified-type-def type-id='type-id-67' const='yes' id='type-id-118'/>
+    <var-decl name='_length_code' type-id='type-id-119' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
     <var-decl name='_dist_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <pointer-type-def type-id='type-id-9' size-in-bits='64' id='type-id-123'/>
+    <pointer-type-def type-id='type-id-13' size-in-bits='64' id='type-id-125'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-123' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <parameter type-id='type-id-125' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-124' size-in-bits='640' id='type-id-125'>
-      <subrange length='10' type-id='type-id-4' id='type-id-126'/>
+    <array-type-def dimensions='1' type-id='type-id-126' size-in-bits='640' id='type-id-127'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-128'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-124'/>
-    <function-decl name='malloc' filepath='/usr/powerpc64-linux-gnu/include/stdlib.h' line='540' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-decl name='free' filepath='/usr/powerpc64-linux-gnu/include/stdlib.h' line='555' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <return type-id='type-id-42'/>
-    </function-decl>
+    <qualified-type-def type-id='type-id-53' const='yes' id='type-id-126'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-78'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-9'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zError'>
       <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-78'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-125' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-127' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc64le-unknown-linux-gnu.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc64le-unknown-linux-gnu.abi
index 5ef350b4..e78d9831 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc64le-unknown-linux-gnu.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-powerpc64le-unknown-linux-gnu.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-powerpc-64' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-powerpc-64' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
   </elf-needed>
@@ -94,54 +94,54 @@
   </elf-function-symbols>
   <abi-instr address-size='64' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/powerpc64le-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-5'/>
+    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/powerpc64le-linux-gnu/include/bits/types.h' line='152' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-5' filepath='/usr/powerpc64le-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/powerpc64le-linux-gnu/include/sys/types.h' line='85' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc-cross/powerpc64le-linux-gnu/13/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-11' filepath='./zconf.h' line='399' column='1' id='type-id-12'/>
+    <typedef-decl name='uLong' type-id='type-id-9' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
     <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-3'/>
-    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-4'/>
-    <typedef-decl name='z_size_t' type-id='type-id-5' filepath='./zconf.h' line='251' column='1' id='type-id-6'/>
-    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-7'/>
-    <typedef-decl name='uInt' type-id='type-id-3' filepath='./zconf.h' line='399' column='1' id='type-id-8'/>
-    <typedef-decl name='uLong' type-id='type-id-4' filepath='./zconf.h' line='400' column='1' id='type-id-9'/>
-    <typedef-decl name='Bytef' type-id='type-id-7' filepath='./zconf.h' line='406' column='1' id='type-id-10'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc-cross/powerpc64le-linux-gnu/11/include/stddef.h' line='209' column='1' id='type-id-5'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/powerpc64le-linux-gnu/include/bits/types.h' line='152' column='1' id='type-id-11'/>
-    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/powerpc64le-linux-gnu/include/bits/types.h' line='153' column='1' id='type-id-12'/>
-    <typedef-decl name='off_t' type-id='type-id-11' filepath='/usr/powerpc64le-linux-gnu/include/sys/types.h' line='85' column='1' id='type-id-13'/>
-    <typedef-decl name='off64_t' type-id='type-id-12' filepath='/usr/powerpc64le-linux-gnu/include/sys/types.h' line='92' column='1' id='type-id-14'/>
-    <qualified-type-def type-id='type-id-10' const='yes' id='type-id-15'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-11'/>
+    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-9'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
     <pointer-type-def type-id='type-id-15' size-in-bits='64' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='uLongf' type-id='type-id-9' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
     <pointer-type-def type-id='type-id-17' size-in-bits='64' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compress2'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
@@ -149,131 +149,145 @@
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='z_crc_t' type-id='type-id-3' filepath='./zconf.h' line='435' column='1' id='type-id-21'/>
-    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-22'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='64' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-21' const='yes' id='type-id-24'/>
+    <typedef-decl name='z_crc_t' type-id='type-id-11' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
     <pointer-type-def type-id='type-id-24' size-in-bits='64' id='type-id-25'/>
+    <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
+    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-27'/>
     <function-decl name='get_crc_table' mangled-name='get_crc_table' filepath='src.d/crc32.c' line='595' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='get_crc_table'>
-      <return type-id='type-id-25'/>
+      <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
-      <parameter type-id='type-id-23' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
-      <parameter type-id='type-id-23' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-9' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='char' size-in-bits='8' id='type-id-26'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-27'/>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='1248' id='type-id-29'>
-      <subrange length='39' type-id='type-id-4' id='type-id-30'/>
+    <type-decl name='char' size-in-bits='8' id='type-id-28'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-31'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='18336' id='type-id-31'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='1952' id='type-id-33'>
-      <subrange length='61' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-35'/>
     </array-type-def>
     <type-decl name='int' size-in-bits='32' id='type-id-20'/>
-    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-35'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-36' size-in-bits='4584' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-38'/>
-    <array-type-def dimensions='1' type-id='type-id-39' size-in-bits='256' id='type-id-40'>
-      <subrange length='16' type-id='type-id-4' id='type-id-41'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-42'/>
-    <typedef-decl name='charf' type-id='type-id-26' filepath='./zconf.h' line='408' column='1' id='type-id-43'/>
-    <typedef-decl name='voidpf' type-id='type-id-44' filepath='./zconf.h' line='415' column='1' id='type-id-45'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-28'>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-46'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-39'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-47'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-28' filepath='src.d/deflate.h' line='77' column='1' id='type-id-48'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-27' filepath='src.d/deflate.h' line='84' column='1' id='type-id-49'/>
-    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-50'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='extra_len' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='extra_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='name_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='448'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='512'>
+        <var-decl name='comm_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='544'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='576'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-39' filepath='src.d/deflate.h' line='92' column='1' id='type-id-53'/>
-    <typedef-decl name='Posf' type-id='type-id-53' filepath='src.d/deflate.h' line='93' column='1' id='type-id-54'/>
-    <typedef-decl name='IPos' type-id='type-id-3' filepath='src.d/deflate.h' line='94' column='1' id='type-id-55'/>
-    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-56'>
+    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-40'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
         <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
@@ -282,94 +296,94 @@
         <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='pending_buf_size' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
         <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='pending' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
         <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='gzhead' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='gzindex' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='method' type-id='type-id-7' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
         <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='w_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='w_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='w_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
         <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='window_size' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='prev' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='head' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='ins_h' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='hash_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='hash_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='hash_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='hash_shift' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1216'>
         <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1280'>
-        <var-decl name='match_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1312'>
-        <var-decl name='prev_match' type-id='type-id-55' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1344'>
         <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1376'>
-        <var-decl name='strstart' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1408'>
-        <var-decl name='match_start' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1440'>
-        <var-decl name='lookahead' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1472'>
-        <var-decl name='prev_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1504'>
-        <var-decl name='max_chain_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1536'>
-        <var-decl name='max_lazy_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1568'>
         <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
@@ -378,34 +392,34 @@
         <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1632'>
-        <var-decl name='good_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1664'>
         <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1696'>
-        <var-decl name='dyn_ltree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='20032'>
-        <var-decl name='dyn_dtree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21984'>
-        <var-decl name='bl_tree' type-id='type-id-29' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23232'>
-        <var-decl name='l_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23424'>
-        <var-decl name='d_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23616'>
-        <var-decl name='bl_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23808'>
-        <var-decl name='bl_count' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='24064'>
-        <var-decl name='heap' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42400'>
         <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
@@ -414,234 +428,225 @@
         <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42464'>
-        <var-decl name='depth' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47104'>
-        <var-decl name='sym_buf' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47168'>
-        <var-decl name='lit_bufsize' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47200'>
-        <var-decl name='sym_next' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47232'>
-        <var-decl name='sym_end' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47296'>
-        <var-decl name='opt_len' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47360'>
-        <var-decl name='static_len' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47424'>
-        <var-decl name='matches' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47456'>
-        <var-decl name='insert' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47488'>
-        <var-decl name='bi_buf' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47520'>
         <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47552'>
-        <var-decl name='high_water' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='deflate_state' type-id='type-id-56' filepath='src.d/deflate.h' line='271' column='1' id='type-id-62'/>
-    <typedef-decl name='alloc_func' type-id='type-id-63' filepath='src.d/zlib.h' line='81' column='1' id='type-id-64'/>
-    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-66'/>
-    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-67'>
+    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-45'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='dyn_tree' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='stat_desc' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      </data-member>
+    </class-decl>
+    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-52'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='avail_in' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='total_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='avail_out' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='total_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
+        <var-decl name='msg' type-id='type-id-53' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='state' type-id='type-id-69' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
+        <var-decl name='state' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='zalloc' type-id='type-id-64' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='zfree' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
+        <var-decl name='zfree' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='opaque' type-id='type-id-45' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
+        <var-decl name='opaque' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
         <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='adler' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='reserved' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-67' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
-    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-57'/>
-    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-72'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='time' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='extra_len' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='extra_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='name_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+    <typedef-decl name='IPos' type-id='type-id-11' filepath='src.d/deflate.h' line='94' column='1' id='type-id-44'/>
+    <typedef-decl name='Pos' type-id='type-id-49' filepath='src.d/deflate.h' line='92' column='1' id='type-id-58'/>
+    <typedef-decl name='Posf' type-id='type-id-58' filepath='src.d/deflate.h' line='93' column='1' id='type-id-59'/>
+    <typedef-decl name='alloc_func' type-id='type-id-60' filepath='src.d/zlib.h' line='81' column='1' id='type-id-55'/>
+    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-61'/>
+    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-62'/>
+    <typedef-decl name='deflate_state' type-id='type-id-40' filepath='src.d/deflate.h' line='271' column='1' id='type-id-63'/>
+    <typedef-decl name='free_func' type-id='type-id-64' filepath='src.d/zlib.h' line='82' column='1' id='type-id-56'/>
+    <typedef-decl name='gz_header' type-id='type-id-39' filepath='src.d/zlib.h' line='129' column='1' id='type-id-65'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-66' filepath='src.d/zlib.h' line='131' column='1' id='type-id-42'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-67'/>
+    <typedef-decl name='uchf' type-id='type-id-67' filepath='src.d/zutil.h' line='40' column='1' id='type-id-68'/>
+    <typedef-decl name='ulg' type-id='type-id-9' filepath='src.d/zutil.h' line='43' column='1' id='type-id-41'/>
+    <typedef-decl name='ush' type-id='type-id-69' filepath='src.d/zutil.h' line='41' column='1' id='type-id-49'/>
+    <typedef-decl name='z_stream' type-id='type-id-52' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
+    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-67' size-in-bits='4584' id='type-id-47'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='comm_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-37'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
       </data-member>
-    </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-72' filepath='src.d/zlib.h' line='129' column='1' id='type-id-73'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-74' filepath='src.d/zlib.h' line='131' column='1' id='type-id-59'/>
-    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-36'/>
-    <typedef-decl name='uchf' type-id='type-id-36' filepath='src.d/zutil.h' line='40' column='1' id='type-id-75'/>
-    <typedef-decl name='ush' type-id='type-id-38' filepath='src.d/zutil.h' line='41' column='1' id='type-id-39'/>
-    <typedef-decl name='ulg' type-id='type-id-4' filepath='src.d/zutil.h' line='43' column='1' id='type-id-58'/>
-    <pointer-type-def type-id='type-id-10' size-in-bits='64' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-54' size-in-bits='64' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-68'/>
-    <pointer-type-def type-id='type-id-43' size-in-bits='64' id='type-id-76'/>
-    <qualified-type-def type-id='type-id-26' const='yes' id='type-id-77'/>
-    <pointer-type-def type-id='type-id-77' size-in-bits='64' id='type-id-78'/>
-    <qualified-type-def type-id='type-id-49' const='yes' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-79' size-in-bits='64' id='type-id-52'/>
-    <pointer-type-def type-id='type-id-48' size-in-bits='64' id='type-id-51'/>
-    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-80'/>
-    <pointer-type-def type-id='type-id-73' size-in-bits='64' id='type-id-74'/>
-    <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-56' size-in-bits='64' id='type-id-69'/>
-    <pointer-type-def type-id='type-id-82' size-in-bits='64' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-8' size-in-bits='64' id='type-id-83'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='64' id='type-id-61'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='64' id='type-id-84'/>
-    <pointer-type-def type-id='type-id-85' size-in-bits='64' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-42' size-in-bits='64' id='type-id-44'/>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-69'/>
+    <array-type-def dimensions='1' type-id='type-id-49' size-in-bits='256' id='type-id-46'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-72'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='64' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-59' size-in-bits='64' id='type-id-43'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='64' id='type-id-53'/>
+    <pointer-type-def type-id='type-id-61' size-in-bits='64' id='type-id-73'/>
+    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-74'/>
+    <pointer-type-def type-id='type-id-74' size-in-bits='64' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-50'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='64' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-65' size-in-bits='64' id='type-id-66'/>
+    <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-40' size-in-bits='64' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-77' size-in-bits='64' id='type-id-60'/>
+    <pointer-type-def type-id='type-id-12' size-in-bits='64' id='type-id-78'/>
+    <pointer-type-def type-id='type-id-68' size-in-bits='64' id='type-id-48'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='64' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-80' size-in-bits='64' id='type-id-64'/>
     <pointer-type-def type-id='type-id-70' size-in-bits='64' id='type-id-71'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-27'/>
+    <qualified-type-def type-id='type-id-81' const='yes' id='type-id-82'/>
+    <pointer-type-def type-id='type-id-82' size-in-bits='64' id='type-id-51'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-83'/>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-57'/>
     <function-decl name='memcpy' filepath='/usr/powerpc64le-linux-gnu/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='memset' filepath='/usr/powerpc64le-linux-gnu/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
       <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
       <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-83' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <parameter type-id='type-id-78' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-59' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-42' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-84' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-81' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-79' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-76' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
       <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
       <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
       <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
@@ -649,198 +654,203 @@
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-9'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-20'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-57' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-57' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-83' filepath='src.d/deflate.h' line='84' column='1' id='type-id-81'/>
     <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-76'/>
-      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-73'/>
+      <parameter type-id='type-id-41'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-42'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-76'/>
-      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-73'/>
+      <parameter type-id='type-id-41'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-42'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-3'/>
-      <parameter type-id='type-id-3'/>
-      <return type-id='type-id-45'/>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-57'/>
     </function-decl>
     <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-45'/>
-      <return type-id='type-id-42'/>
-    </function-decl>
-    <function-type size-in-bits='64' id='type-id-82'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-8'/>
-      <parameter type-id='type-id-8'/>
-      <return type-id='type-id-45'/>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-57'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-85'/>
+    <pointer-type-def type-id='type-id-85' id='type-id-84'/>
+    <function-type size-in-bits='64' id='type-id-80'>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-57'/>
+      <return type-id='type-id-85'/>
     </function-type>
-    <function-type size-in-bits='64' id='type-id-85'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-45'/>
-      <return type-id='type-id-42'/>
+    <function-type size-in-bits='64' id='type-id-77'>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-57'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='gzFile' type-id='type-id-86' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-87'/>
-    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-88'>
+    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-86'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-3' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='next' type-id='type-id-89' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-87' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pos' type-id='type-id-14' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-88' size-in-bits='64' id='type-id-86'/>
+    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
+    <pointer-type-def type-id='type-id-86' size-in-bits='64' id='type-id-88'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87'/>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87'/>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='variadic parameter type' id='type-id-90'/>
-    <function-decl name='open' filepath='/usr/powerpc64le-linux-gnu/include/fcntl.h' line='181' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-78'/>
+    <function-decl name='open' filepath='/usr/powerpc64le-linux-gnu/include/fcntl.h' line='209' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-22'/>
       <parameter type-id='type-id-20'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='snprintf' filepath='/usr/powerpc64le-linux-gnu/include/stdio.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-68'/>
-      <parameter type-id='type-id-5'/>
-      <parameter type-id='type-id-78'/>
+    <function-decl name='snprintf' filepath='/usr/powerpc64le-linux-gnu/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-53'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
+    <function-decl name='malloc' filepath='/usr/powerpc64le-linux-gnu/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/powerpc64le-linux-gnu/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-84'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
     <function-decl name='strlen' filepath='/usr/powerpc64le-linux-gnu/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-78'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='lseek64' filepath='/usr/powerpc64le-linux-gnu/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-5'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-12'/>
+      <return type-id='type-id-5'/>
     </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-78' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-78' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdopen'>
       <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-3' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-11' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-14' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-14'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-13' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-13'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-81' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-78'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-76' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-85'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-90'/>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidp' type-id='type-id-44' filepath='./zconf.h' line='416' column='1' id='type-id-91'/>
-    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/powerpc64le-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-92'/>
-    <typedef-decl name='ssize_t' type-id='type-id-92' filepath='/usr/powerpc64le-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-93'/>
-    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-94' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-95'>
+    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-92'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='x' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+        <var-decl name='x' type-id='type-id-86' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
@@ -849,19 +859,19 @@
         <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='path' type-id='type-id-68' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+        <var-decl name='path' type-id='type-id-53' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='size' type-id='type-id-3' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+        <var-decl name='size' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='want' type-id='type-id-3' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+        <var-decl name='want' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='in' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+        <var-decl name='in' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='out' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+        <var-decl name='out' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
         <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
@@ -870,7 +880,7 @@
         <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='start' type-id='type-id-14' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
         <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
@@ -888,7 +898,7 @@
         <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='skip' type-id='type-id-14' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
         <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
@@ -897,27 +907,30 @@
         <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+        <var-decl name='msg' type-id='type-id-53' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
         <var-decl name='strm' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_state' type-id='type-id-95' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-94'/>
-    <typedef-decl name='gz_statep' type-id='type-id-96' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-97'/>
-    <pointer-type-def type-id='type-id-94' size-in-bits='64' id='type-id-96'/>
+    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/powerpc64le-linux-gnu/include/bits/types.h' line='194' column='1' id='type-id-93'/>
+    <typedef-decl name='gz_state' type-id='type-id-92' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-91'/>
+    <typedef-decl name='gz_statep' type-id='type-id-94' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-95'/>
+    <typedef-decl name='ssize_t' type-id='type-id-93' filepath='/usr/powerpc64le-linux-gnu/include/sys/types.h' line='108' column='1' id='type-id-96'/>
+    <pointer-type-def type-id='type-id-91' size-in-bits='64' id='type-id-94'/>
+    <typedef-decl name='voidp' type-id='type-id-84' filepath='./zconf.h' line='416' column='1' id='type-id-97'/>
     <function-decl name='__errno_location' filepath='/usr/powerpc64le-linux-gnu/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <return type-id='type-id-81'/>
+      <return type-id='type-id-76'/>
     </function-decl>
     <function-decl name='memchr' filepath='/usr/powerpc64le-linux-gnu/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='strerror' filepath='/usr/powerpc64le-linux-gnu/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-68'/>
+      <return type-id='type-id-53'/>
     </function-decl>
     <function-decl name='close' filepath='/usr/powerpc64le-linux-gnu/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
@@ -925,126 +938,151 @@
     </function-decl>
     <function-decl name='read' filepath='/usr/powerpc64le-linux-gnu/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-93'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
     </function-decl>
     <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-97'/>
+      <parameter type-id='type-id-95'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-78'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-91' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-91' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-68' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-53' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
       <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-68'/>
+      <return type-id='type-id-53'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidpc' type-id='type-id-44' filepath='./zconf.h' line='414' column='1' id='type-id-98'/>
-    <typedef-decl name='__gnuc_va_list' type-id='type-id-68' filepath='/usr/lib/gcc-cross/powerpc64le-linux-gnu/11/include/stdarg.h' line='40' column='1' id='type-id-99'/>
-    <typedef-decl name='va_list' type-id='type-id-99' filepath='/usr/lib/gcc-cross/powerpc64le-linux-gnu/11/include/stdarg.h' line='99' column='1' id='type-id-100'/>
-    <function-decl name='vsnprintf' filepath='/usr/powerpc64le-linux-gnu/include/stdio.h' line='382' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-68'/>
-      <parameter type-id='type-id-5'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-68'/>
+    <typedef-decl name='__gnuc_va_list' type-id='type-id-53' filepath='/usr/lib/gcc-cross/powerpc64le-linux-gnu/13/include/stdarg.h' line='40' column='1' id='type-id-98'/>
+    <typedef-decl name='va_list' type-id='type-id-98' filepath='/usr/lib/gcc-cross/powerpc64le-linux-gnu/13/include/stdarg.h' line='103' column='1' id='type-id-99'/>
+    <typedef-decl name='voidpc' type-id='type-id-84' filepath='./zconf.h' line='414' column='1' id='type-id-100'/>
+    <function-decl name='vsnprintf' filepath='/usr/powerpc64le-linux-gnu/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-53'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-53'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='memmove' filepath='/usr/powerpc64le-linux-gnu/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='write' filepath='/usr/powerpc64le-linux-gnu/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-93'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
     </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-100' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-98' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-100' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-78' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-78' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-100' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-99' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-78' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
       <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-101'/>
-    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-102' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-103'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-101' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-102'>
+      <underlying-type type-id='type-id-103'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-104' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-105'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
       </data-member>
@@ -1052,217 +1090,186 @@
         <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='val' type-id='type-id-38' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+        <var-decl name='val' type-id='type-id-69' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='code' type-id='type-id-103' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-102'/>
-    <enum-decl name='codetype' naming-typedef-id='type-id-104' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-105'>
-      <underlying-type type-id='type-id-101'/>
-      <enumerator name='CODES' value='0'/>
-      <enumerator name='LENS' value='1'/>
-      <enumerator name='DISTS' value='2'/>
-    </enum-decl>
-    <typedef-decl name='codetype' type-id='type-id-105' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-104'/>
+    <typedef-decl name='code' type-id='type-id-105' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-104'/>
+    <typedef-decl name='codetype' type-id='type-id-102' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-101'/>
     <typedef-decl name='in_func' type-id='type-id-106' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-107'/>
     <typedef-decl name='out_func' type-id='type-id-108' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-109'/>
-    <pointer-type-def type-id='type-id-102' size-in-bits='64' id='type-id-110'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-103'/>
+    <pointer-type-def type-id='type-id-104' size-in-bits='64' id='type-id-110'/>
     <pointer-type-def type-id='type-id-110' size-in-bits='64' id='type-id-111'/>
     <pointer-type-def type-id='type-id-112' size-in-bits='64' id='type-id-108'/>
-    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-89'/>
-    <pointer-type-def type-id='type-id-89' size-in-bits='64' id='type-id-113'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-87'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='64' id='type-id-113'/>
     <pointer-type-def type-id='type-id-114' size-in-bits='64' id='type-id-106'/>
-    <pointer-type-def type-id='type-id-38' size-in-bits='64' id='type-id-115'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='64' id='type-id-115'/>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-116'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-89' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-87' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
       <parameter type-id='type-id-107' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-44' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-84' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
       <parameter type-id='type-id-109' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-44' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <parameter type-id='type-id-84' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-57'/>
-      <parameter type-id='type-id-3'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-104'/>
+      <parameter type-id='type-id-101'/>
       <parameter type-id='type-id-115'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-11'/>
       <parameter type-id='type-id-111'/>
-      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-79'/>
       <parameter type-id='type-id-115'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-type size-in-bits='64' id='type-id-112'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-89'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-87'/>
+      <parameter type-id='type-id-11'/>
       <return type-id='type-id-20'/>
     </function-type>
     <function-type size-in-bits='64' id='type-id-114'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-113'/>
-      <return type-id='type-id-3'/>
+      <return type-id='type-id-11'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-117'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-83' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <parameter type-id='type-id-78' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-59' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-42' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-57' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
       <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
       <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
       <return type-id='type-id-1'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-4'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-9'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='2048' id='type-id-117'>
-      <subrange length='256' type-id='type-id-4' id='type-id-118'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='2048' id='type-id-119'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-120'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='4096' id='type-id-119'>
-      <subrange length='512' type-id='type-id-4' id='type-id-120'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='4096' id='type-id-121'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-122'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='infinite' id='type-id-121'>
-      <subrange length='infinite' id='type-id-122'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='unknown' id='type-id-123'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-124'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-36' const='yes' id='type-id-116'/>
-    <var-decl name='_length_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <qualified-type-def type-id='type-id-67' const='yes' id='type-id-118'/>
+    <var-decl name='_length_code' type-id='type-id-119' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
     <var-decl name='_dist_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <pointer-type-def type-id='type-id-9' size-in-bits='64' id='type-id-123'/>
+    <pointer-type-def type-id='type-id-13' size-in-bits='64' id='type-id-125'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-123' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <parameter type-id='type-id-125' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-124' size-in-bits='640' id='type-id-125'>
-      <subrange length='10' type-id='type-id-4' id='type-id-126'/>
+    <array-type-def dimensions='1' type-id='type-id-126' size-in-bits='640' id='type-id-127'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-128'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-124'/>
-    <function-decl name='malloc' filepath='/usr/powerpc64le-linux-gnu/include/stdlib.h' line='540' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-decl name='free' filepath='/usr/powerpc64le-linux-gnu/include/stdlib.h' line='555' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <return type-id='type-id-42'/>
-    </function-decl>
+    <qualified-type-def type-id='type-id-53' const='yes' id='type-id-126'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-78'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-9'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zError'>
       <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-78'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-125' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-127' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-x86_64-pc-linux-gnu-m32.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-x86_64-pc-linux-gnu-m32.abi
index 569d084b..5b55fc60 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-x86_64-pc-linux-gnu-m32.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-x86_64-pc-linux-gnu-m32.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-intel-80386' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-intel-80386' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
   </elf-needed>
@@ -95,55 +95,55 @@
   <abi-instr address-size='32' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='long int' size-in-bits='32' id='type-id-1'/>
     <type-decl name='long long int' size-in-bits='64' id='type-id-2'/>
+    <typedef-decl name='Byte' type-id='type-id-3' filepath='./zconf.h' line='397' column='1' id='type-id-4'/>
+    <typedef-decl name='Bytef' type-id='type-id-4' filepath='./zconf.h' line='406' column='1' id='type-id-5'/>
+    <typedef-decl name='__int64_t' type-id='type-id-2' filepath='/usr/include/bits/types.h' line='47' column='1' id='type-id-6'/>
+    <typedef-decl name='__off64_t' type-id='type-id-6' filepath='/usr/include/bits/types.h' line='153' column='1' id='type-id-7'/>
+    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/include/bits/types.h' line='152' column='1' id='type-id-8'/>
+    <typedef-decl name='off64_t' type-id='type-id-7' filepath='/usr/include/sys/types.h' line='92' column='1' id='type-id-9'/>
+    <typedef-decl name='off_t' type-id='type-id-8' filepath='/usr/include/sys/types.h' line='85' column='1' id='type-id-10'/>
+    <typedef-decl name='size_t' type-id='type-id-11' filepath='/usr/lib/gcc/x86_64-linux-gnu/13/include/stddef.h' line='214' column='1' id='type-id-12'/>
+    <typedef-decl name='uInt' type-id='type-id-11' filepath='./zconf.h' line='399' column='1' id='type-id-13'/>
+    <typedef-decl name='uLong' type-id='type-id-14' filepath='./zconf.h' line='400' column='1' id='type-id-15'/>
+    <typedef-decl name='z_size_t' type-id='type-id-12' filepath='./zconf.h' line='251' column='1' id='type-id-16'/>
     <type-decl name='unsigned char' size-in-bits='8' id='type-id-3'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-4'/>
-    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-5'/>
-    <typedef-decl name='z_size_t' type-id='type-id-6' filepath='./zconf.h' line='251' column='1' id='type-id-7'/>
-    <typedef-decl name='Byte' type-id='type-id-3' filepath='./zconf.h' line='397' column='1' id='type-id-8'/>
-    <typedef-decl name='uInt' type-id='type-id-4' filepath='./zconf.h' line='399' column='1' id='type-id-9'/>
-    <typedef-decl name='uLong' type-id='type-id-5' filepath='./zconf.h' line='400' column='1' id='type-id-10'/>
-    <typedef-decl name='Bytef' type-id='type-id-8' filepath='./zconf.h' line='406' column='1' id='type-id-11'/>
-    <typedef-decl name='__int64_t' type-id='type-id-2' filepath='/usr/include/bits/types.h' line='47' column='1' id='type-id-12'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/include/bits/types.h' line='152' column='1' id='type-id-13'/>
-    <typedef-decl name='__off64_t' type-id='type-id-12' filepath='/usr/include/bits/types.h' line='153' column='1' id='type-id-14'/>
-    <typedef-decl name='off_t' type-id='type-id-13' filepath='/usr/include/sys/types.h' line='85' column='1' id='type-id-15'/>
-    <typedef-decl name='off64_t' type-id='type-id-14' filepath='/usr/include/sys/types.h' line='92' column='1' id='type-id-16'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc/x86_64-linux-gnu/11/include/stddef.h' line='209' column='1' id='type-id-6'/>
-    <qualified-type-def type-id='type-id-11' const='yes' id='type-id-17'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-11'/>
+    <type-decl name='unsigned long int' size-in-bits='32' id='type-id-14'/>
+    <qualified-type-def type-id='type-id-5' const='yes' id='type-id-17'/>
     <pointer-type-def type-id='type-id-17' size-in-bits='32' id='type-id-18'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-15' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
       <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-16' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-10' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-15' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
       <parameter type-id='type-id-18' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-13' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-15' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-15' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-10' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-10' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-15' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-15' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-9' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='uLongf' type-id='type-id-10' filepath='./zconf.h' line='411' column='1' id='type-id-19'/>
+    <typedef-decl name='uLongf' type-id='type-id-15' filepath='./zconf.h' line='411' column='1' id='type-id-19'/>
     <pointer-type-def type-id='type-id-19' size-in-bits='32' id='type-id-20'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compress2'>
       <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
       <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
       <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-15' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
       <parameter type-id='type-id-22' name='level' filepath='src.d/compress.c' line='27' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
@@ -151,131 +151,145 @@
       <parameter type-id='type-id-21' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
       <parameter type-id='type-id-20' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
       <parameter type-id='type-id-18' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <parameter type-id='type-id-15' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-15' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-15'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-23'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-22'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-23'/>
+      <return type-id='type-id-22'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-23'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-24'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-22'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='z_crc_t' type-id='type-id-4' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-3' const='yes' id='type-id-24'/>
-    <pointer-type-def type-id='type-id-24' size-in-bits='32' id='type-id-25'/>
-    <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
+    <typedef-decl name='z_crc_t' type-id='type-id-11' filepath='./zconf.h' line='435' column='1' id='type-id-25'/>
+    <qualified-type-def type-id='type-id-3' const='yes' id='type-id-26'/>
     <pointer-type-def type-id='type-id-26' size-in-bits='32' id='type-id-27'/>
+    <qualified-type-def type-id='type-id-25' const='yes' id='type-id-28'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-29'/>
     <function-decl name='get_crc_table' mangled-name='get_crc_table' filepath='src.d/crc32.c' line='595' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='get_crc_table'>
-      <return type-id='type-id-27'/>
+      <return type-id='type-id-29'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
-      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-7' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-14' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-27' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
+      <parameter type-id='type-id-16' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-5' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
-      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-9' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-14' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-27' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
+      <parameter type-id='type-id-13' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-15' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-15' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-9' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-15' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-15' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-10' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-16' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-9' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-15' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-10' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-10' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-10' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-10' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-10'/>
+      <parameter type-id='type-id-15' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-15' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-15' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='char' size-in-bits='8' id='type-id-28'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1248' id='type-id-31'>
-      <subrange length='39' type-id='type-id-4' id='type-id-32'/>
+    <type-decl name='char' size-in-bits='8' id='type-id-30'/>
+    <array-type-def dimensions='1' type-id='type-id-31' size-in-bits='1248' id='type-id-32'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-11' id='type-id-33'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='18336' id='type-id-33'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-31' size-in-bits='18336' id='type-id-34'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-11' id='type-id-35'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-30' size-in-bits='1952' id='type-id-35'>
-      <subrange length='61' type-id='type-id-4' id='type-id-36'/>
+    <array-type-def dimensions='1' type-id='type-id-31' size-in-bits='1952' id='type-id-36'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-11' id='type-id-37'/>
     </array-type-def>
     <type-decl name='int' size-in-bits='32' id='type-id-22'/>
-    <array-type-def dimensions='1' type-id='type-id-22' size-in-bits='18336' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-22' size-in-bits='18336' id='type-id-38'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-11' id='type-id-35'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-38' size-in-bits='4584' id='type-id-39'>
-      <subrange length='573' type-id='type-id-4' id='type-id-34'/>
-    </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-40'/>
-    <array-type-def dimensions='1' type-id='type-id-41' size-in-bits='256' id='type-id-42'>
-      <subrange length='16' type-id='type-id-4' id='type-id-43'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-44'/>
-    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-45'/>
-    <typedef-decl name='voidpf' type-id='type-id-46' filepath='./zconf.h' line='415' column='1' id='type-id-47'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-30'>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-31'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-48'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-41'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='32'>
+        <var-decl name='time' type-id='type-id-15' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-49'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='xflags' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='96'>
+        <var-decl name='os' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-30' filepath='src.d/deflate.h' line='77' column='1' id='type-id-50'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-29' filepath='src.d/deflate.h' line='84' column='1' id='type-id-51'/>
-    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-52'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-53' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='extra' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='max_code' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='extra_len' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='stat_desc' type-id='type-id-54' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra_max' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='224'>
+        <var-decl name='name' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='name_max' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='comment' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='comm_max' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='352'>
+        <var-decl name='hcrc' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='done' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-41' filepath='src.d/deflate.h' line='92' column='1' id='type-id-55'/>
-    <typedef-decl name='Posf' type-id='type-id-55' filepath='src.d/deflate.h' line='93' column='1' id='type-id-56'/>
-    <typedef-decl name='IPos' type-id='type-id-4' filepath='src.d/deflate.h' line='94' column='1' id='type-id-57'/>
-    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-58'>
+    <class-decl name='internal_state' size-in-bits='46624' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-42'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-23' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
         <var-decl name='status' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
@@ -284,94 +298,94 @@
         <var-decl name='pending_buf' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='pending_buf_size' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
         <var-decl name='pending_out' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='pending' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='wrap' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='gzhead' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='gzindex' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='method' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-4' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
         <var-decl name='last_flush' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='w_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='w_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='w_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
         <var-decl name='window' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='480'>
-        <var-decl name='window_size' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='prev' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='head' type-id='type-id-62' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='ins_h' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
-        <var-decl name='hash_size' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='hash_bits' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='hash_mask' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='hash_shift' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='736'>
         <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='match_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
-        <var-decl name='prev_match' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
         <var-decl name='match_available' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='864'>
-        <var-decl name='strstart' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='match_start' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='928'>
-        <var-decl name='lookahead' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='prev_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='992'>
-        <var-decl name='max_chain_length' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='max_lazy_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
         <var-decl name='level' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
@@ -380,34 +394,34 @@
         <var-decl name='strategy' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='good_match' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
         <var-decl name='nice_match' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1184'>
-        <var-decl name='dyn_ltree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='19520'>
-        <var-decl name='dyn_dtree' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21472'>
-        <var-decl name='bl_tree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22720'>
-        <var-decl name='l_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22816'>
-        <var-decl name='d_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='22912'>
-        <var-decl name='bl_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23008'>
-        <var-decl name='bl_count' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23264'>
-        <var-decl name='heap' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41600'>
         <var-decl name='heap_len' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
@@ -416,234 +430,225 @@
         <var-decl name='heap_max' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='41664'>
-        <var-decl name='depth' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46272'>
-        <var-decl name='sym_buf' type-id='type-id-63' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46304'>
-        <var-decl name='lit_bufsize' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46336'>
-        <var-decl name='sym_next' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46368'>
-        <var-decl name='sym_end' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46400'>
-        <var-decl name='opt_len' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46432'>
-        <var-decl name='static_len' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46464'>
-        <var-decl name='matches' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46496'>
-        <var-decl name='insert' type-id='type-id-9' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-13' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46528'>
-        <var-decl name='bi_buf' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46560'>
         <var-decl name='bi_valid' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='46592'>
-        <var-decl name='high_water' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='deflate_state' type-id='type-id-58' filepath='src.d/deflate.h' line='271' column='1' id='type-id-64'/>
-    <typedef-decl name='alloc_func' type-id='type-id-65' filepath='src.d/zlib.h' line='81' column='1' id='type-id-66'/>
-    <typedef-decl name='free_func' type-id='type-id-67' filepath='src.d/zlib.h' line='82' column='1' id='type-id-68'/>
-    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-69'>
+    <class-decl name='tree_desc_s' size-in-bits='96' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-47'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='dyn_tree' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='32'>
+        <var-decl name='max_code' type-id='type-id-22' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='stat_desc' type-id='type-id-53' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      </data-member>
+    </class-decl>
+    <class-decl name='z_stream_s' size-in-bits='448' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-54'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='next_in' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='avail_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='total_in' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
+        <var-decl name='total_in' type-id='type-id-15' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='96'>
         <var-decl name='next_out' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='avail_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='total_out' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
+        <var-decl name='total_out' type-id='type-id-15' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='msg' type-id='type-id-70' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
+        <var-decl name='msg' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='state' type-id='type-id-71' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
+        <var-decl name='state' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='zalloc' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='zfree' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
+        <var-decl name='zfree' type-id='type-id-58' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='opaque' type-id='type-id-47' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
+        <var-decl name='opaque' type-id='type-id-59' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
         <var-decl name='data_type' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='adler' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+        <var-decl name='adler' type-id='type-id-15' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='reserved' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='reserved' type-id='type-id-15' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-69' filepath='src.d/zlib.h' line='106' column='1' id='type-id-72'/>
-    <typedef-decl name='z_streamp' type-id='type-id-73' filepath='src.d/zlib.h' line='108' column='1' id='type-id-59'/>
-    <class-decl name='gz_header_s' size-in-bits='416' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-74'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='time' type-id='type-id-10' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='xflags' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='96'>
-        <var-decl name='os' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='extra' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='extra_len' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='name' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='name_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='comment' type-id='type-id-21' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+    <typedef-decl name='IPos' type-id='type-id-11' filepath='src.d/deflate.h' line='94' column='1' id='type-id-46'/>
+    <typedef-decl name='Pos' type-id='type-id-51' filepath='src.d/deflate.h' line='92' column='1' id='type-id-60'/>
+    <typedef-decl name='Posf' type-id='type-id-60' filepath='src.d/deflate.h' line='93' column='1' id='type-id-61'/>
+    <typedef-decl name='alloc_func' type-id='type-id-62' filepath='src.d/zlib.h' line='81' column='1' id='type-id-57'/>
+    <typedef-decl name='charf' type-id='type-id-30' filepath='./zconf.h' line='408' column='1' id='type-id-63'/>
+    <typedef-decl name='ct_data' type-id='type-id-31' filepath='src.d/deflate.h' line='77' column='1' id='type-id-64'/>
+    <typedef-decl name='deflate_state' type-id='type-id-42' filepath='src.d/deflate.h' line='271' column='1' id='type-id-65'/>
+    <typedef-decl name='free_func' type-id='type-id-66' filepath='src.d/zlib.h' line='82' column='1' id='type-id-58'/>
+    <typedef-decl name='gz_header' type-id='type-id-41' filepath='src.d/zlib.h' line='129' column='1' id='type-id-67'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-68' filepath='src.d/zlib.h' line='131' column='1' id='type-id-44'/>
+    <typedef-decl name='uch' type-id='type-id-3' filepath='src.d/zutil.h' line='39' column='1' id='type-id-69'/>
+    <typedef-decl name='uchf' type-id='type-id-69' filepath='src.d/zutil.h' line='40' column='1' id='type-id-70'/>
+    <typedef-decl name='ulg' type-id='type-id-14' filepath='src.d/zutil.h' line='43' column='1' id='type-id-43'/>
+    <typedef-decl name='ush' type-id='type-id-71' filepath='src.d/zutil.h' line='41' column='1' id='type-id-51'/>
+    <typedef-decl name='z_stream' type-id='type-id-54' filepath='src.d/zlib.h' line='106' column='1' id='type-id-72'/>
+    <typedef-decl name='z_streamp' type-id='type-id-73' filepath='src.d/zlib.h' line='108' column='1' id='type-id-23'/>
+    <array-type-def dimensions='1' type-id='type-id-69' size-in-bits='4584' id='type-id-49'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-11' id='type-id-35'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-40'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='comm_max' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='hcrc' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-39'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='done' type-id='type-id-22' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
       </data-member>
-    </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-74' filepath='src.d/zlib.h' line='129' column='1' id='type-id-75'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-76' filepath='src.d/zlib.h' line='131' column='1' id='type-id-61'/>
-    <typedef-decl name='uch' type-id='type-id-3' filepath='src.d/zutil.h' line='39' column='1' id='type-id-38'/>
-    <typedef-decl name='uchf' type-id='type-id-38' filepath='src.d/zutil.h' line='40' column='1' id='type-id-77'/>
-    <typedef-decl name='ush' type-id='type-id-40' filepath='src.d/zutil.h' line='41' column='1' id='type-id-41'/>
-    <typedef-decl name='ulg' type-id='type-id-5' filepath='src.d/zutil.h' line='43' column='1' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-21'/>
-    <pointer-type-def type-id='type-id-56' size-in-bits='32' id='type-id-62'/>
-    <pointer-type-def type-id='type-id-28' size-in-bits='32' id='type-id-70'/>
-    <pointer-type-def type-id='type-id-45' size-in-bits='32' id='type-id-78'/>
-    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-79' size-in-bits='32' id='type-id-80'/>
-    <qualified-type-def type-id='type-id-51' const='yes' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-81' size-in-bits='32' id='type-id-54'/>
-    <pointer-type-def type-id='type-id-50' size-in-bits='32' id='type-id-53'/>
-    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-82'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='32' id='type-id-76'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='32' id='type-id-83'/>
-    <pointer-type-def type-id='type-id-58' size-in-bits='32' id='type-id-71'/>
-    <pointer-type-def type-id='type-id-84' size-in-bits='32' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-9' size-in-bits='32' id='type-id-85'/>
-    <pointer-type-def type-id='type-id-77' size-in-bits='32' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-4' size-in-bits='32' id='type-id-86'/>
-    <pointer-type-def type-id='type-id-87' size-in-bits='32' id='type-id-67'/>
-    <pointer-type-def type-id='type-id-44' size-in-bits='32' id='type-id-46'/>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-71'/>
+    <array-type-def dimensions='1' type-id='type-id-51' size-in-bits='256' id='type-id-48'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-11' id='type-id-74'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-5' size-in-bits='32' id='type-id-21'/>
+    <pointer-type-def type-id='type-id-61' size-in-bits='32' id='type-id-45'/>
+    <pointer-type-def type-id='type-id-30' size-in-bits='32' id='type-id-55'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='32' id='type-id-75'/>
+    <qualified-type-def type-id='type-id-30' const='yes' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-76' size-in-bits='32' id='type-id-24'/>
+    <pointer-type-def type-id='type-id-64' size-in-bits='32' id='type-id-52'/>
+    <pointer-type-def type-id='type-id-65' size-in-bits='32' id='type-id-77'/>
+    <pointer-type-def type-id='type-id-67' size-in-bits='32' id='type-id-68'/>
+    <pointer-type-def type-id='type-id-22' size-in-bits='32' id='type-id-78'/>
+    <pointer-type-def type-id='type-id-42' size-in-bits='32' id='type-id-56'/>
+    <pointer-type-def type-id='type-id-79' size-in-bits='32' id='type-id-62'/>
+    <pointer-type-def type-id='type-id-13' size-in-bits='32' id='type-id-80'/>
+    <pointer-type-def type-id='type-id-70' size-in-bits='32' id='type-id-50'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='32' id='type-id-81'/>
+    <pointer-type-def type-id='type-id-82' size-in-bits='32' id='type-id-66'/>
     <pointer-type-def type-id='type-id-72' size-in-bits='32' id='type-id-73'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-29'/>
+    <qualified-type-def type-id='type-id-83' const='yes' id='type-id-84'/>
+    <pointer-type-def type-id='type-id-84' size-in-bits='32' id='type-id-53'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-85'/>
+    <typedef-decl name='voidpf' type-id='type-id-86' filepath='./zconf.h' line='415' column='1' id='type-id-59'/>
     <function-decl name='memcpy' filepath='/usr/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-86'/>
+      <parameter type-id='type-id-86'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='memset' filepath='/usr/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
+      <parameter type-id='type-id-86'/>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
-    </function-decl>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
       <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
       <parameter type-id='type-id-22' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
       <parameter type-id='type-id-22' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
       <parameter type-id='type-id-22' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
       <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-24' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
       <parameter type-id='type-id-22' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
       <parameter type-id='type-id-18' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <parameter type-id='type-id-13' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
       <parameter type-id='type-id-21' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-85' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <parameter type-id='type-id-80' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-61' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-44' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-86' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-83' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-81' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-78' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
       <parameter type-id='type-id-22' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
       <parameter type-id='type-id-22' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
       <parameter type-id='type-id-22' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
       <parameter type-id='type-id-22' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
       <parameter type-id='type-id-22' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
       <parameter type-id='type-id-22' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
       <parameter type-id='type-id-22' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
@@ -651,198 +656,203 @@
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-10'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-22'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-15' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-59' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-59' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <parameter type-id='type-id-23' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-23' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-85' filepath='src.d/deflate.h' line='84' column='1' id='type-id-83'/>
     <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-77'/>
+      <return type-id='type-id-87'/>
     </function-decl>
     <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-60'/>
+      <parameter type-id='type-id-77'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-43'/>
       <parameter type-id='type-id-22'/>
-      <return type-id='type-id-44'/>
+      <return type-id='type-id-87'/>
     </function-decl>
     <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-77'/>
+      <return type-id='type-id-87'/>
     </function-decl>
     <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-77'/>
+      <return type-id='type-id-87'/>
     </function-decl>
     <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-82'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-60'/>
+      <parameter type-id='type-id-77'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-43'/>
       <parameter type-id='type-id-22'/>
-      <return type-id='type-id-44'/>
+      <return type-id='type-id-87'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-15'/>
+      <parameter type-id='type-id-18'/>
+      <parameter type-id='type-id-13'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-4'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-47'/>
+      <parameter type-id='type-id-59'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-59'/>
     </function-decl>
     <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-47'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-type size-in-bits='32' id='type-id-84'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-9'/>
-      <parameter type-id='type-id-9'/>
-      <return type-id='type-id-47'/>
+      <parameter type-id='type-id-59'/>
+      <parameter type-id='type-id-59'/>
+      <return type-id='type-id-87'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-87'/>
+    <pointer-type-def type-id='type-id-87' id='type-id-86'/>
+    <function-type size-in-bits='32' id='type-id-82'>
+      <parameter type-id='type-id-59'/>
+      <parameter type-id='type-id-59'/>
+      <return type-id='type-id-87'/>
     </function-type>
-    <function-type size-in-bits='32' id='type-id-87'>
-      <parameter type-id='type-id-47'/>
-      <parameter type-id='type-id-47'/>
-      <return type-id='type-id-44'/>
+    <function-type size-in-bits='32' id='type-id-79'>
+      <parameter type-id='type-id-59'/>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-13'/>
+      <return type-id='type-id-59'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
-    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-90'>
+    <class-decl name='gzFile_s' size-in-bits='128' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-88'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-4' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='next' type-id='type-id-91' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-89' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='pos' type-id='type-id-16' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-90' size-in-bits='32' id='type-id-88'/>
+    <typedef-decl name='gzFile' type-id='type-id-90' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-91'/>
+    <pointer-type-def type-id='type-id-88' size-in-bits='32' id='type-id-90'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89'/>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-91'/>
       <return type-id='type-id-22'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89'/>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-91'/>
       <return type-id='type-id-22'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='variadic parameter type' id='type-id-92'/>
-    <function-decl name='open' filepath='/usr/include/fcntl.h' line='181' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-80'/>
+    <function-decl name='open' filepath='/usr/include/fcntl.h' line='209' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-24'/>
       <parameter type-id='type-id-22'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-22'/>
     </function-decl>
-    <function-decl name='snprintf' filepath='/usr/include/stdio.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-70'/>
-      <parameter type-id='type-id-6'/>
-      <parameter type-id='type-id-80'/>
+    <function-decl name='snprintf' filepath='/usr/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-55'/>
+      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-24'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-22'/>
     </function-decl>
+    <function-decl name='malloc' filepath='/usr/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-86'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-86'/>
+      <return type-id='type-id-87'/>
+    </function-decl>
     <function-decl name='strlen' filepath='/usr/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-24'/>
+      <return type-id='type-id-12'/>
     </function-decl>
     <function-decl name='lseek64' filepath='/usr/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='32'>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-14'/>
+      <parameter type-id='type-id-7'/>
       <parameter type-id='type-id-22'/>
-      <return type-id='type-id-14'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-80' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-24' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-24' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-91'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-80' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-24' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-24' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-91'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdopen'>
       <parameter type-id='type-id-22' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-80' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-89'/>
+      <parameter type-id='type-id-24' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-91'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-4' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-11' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-16' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-9' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
       <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-16'/>
+      <return type-id='type-id-9'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-15' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-10' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
       <parameter type-id='type-id-22' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-15'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-9'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-16'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-9'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-15'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-83' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-80'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-78' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-24'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-87'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-92'/>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidp' type-id='type-id-46' filepath='./zconf.h' line='416' column='1' id='type-id-93'/>
-    <typedef-decl name='__ssize_t' type-id='type-id-22' filepath='/usr/include/bits/types.h' line='194' column='1' id='type-id-94'/>
-    <typedef-decl name='ssize_t' type-id='type-id-94' filepath='/usr/include/sys/types.h' line='108' column='1' id='type-id-95'/>
-    <class-decl name='gz_state' size-in-bits='1248' is-struct='yes' naming-typedef-id='type-id-96' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-97'>
+    <class-decl name='gz_state' size-in-bits='1248' is-struct='yes' naming-typedef-id='type-id-93' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-94'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='x' type-id='type-id-90' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+        <var-decl name='x' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
         <var-decl name='mode' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
@@ -851,19 +861,19 @@
         <var-decl name='fd' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='path' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+        <var-decl name='path' type-id='type-id-55' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='224'>
-        <var-decl name='size' type-id='type-id-4' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+        <var-decl name='size' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='want' type-id='type-id-4' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+        <var-decl name='want' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='in' type-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+        <var-decl name='in' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='out' type-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+        <var-decl name='out' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
         <var-decl name='direct' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
@@ -872,7 +882,7 @@
         <var-decl name='how' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='416'>
-        <var-decl name='start' type-id='type-id-16' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+        <var-decl name='start' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='480'>
         <var-decl name='eof' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
@@ -890,7 +900,7 @@
         <var-decl name='reset' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='skip' type-id='type-id-16' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+        <var-decl name='skip' type-id='type-id-9' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
         <var-decl name='seek' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
@@ -899,20 +909,23 @@
         <var-decl name='err' type-id='type-id-22' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='msg' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+        <var-decl name='msg' type-id='type-id-55' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='800'>
         <var-decl name='strm' type-id='type-id-72' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_state' type-id='type-id-97' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-96'/>
-    <typedef-decl name='gz_statep' type-id='type-id-98' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-99'/>
-    <pointer-type-def type-id='type-id-96' size-in-bits='32' id='type-id-98'/>
+    <typedef-decl name='__ssize_t' type-id='type-id-22' filepath='/usr/include/bits/types.h' line='194' column='1' id='type-id-95'/>
+    <typedef-decl name='gz_state' type-id='type-id-94' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-93'/>
+    <typedef-decl name='gz_statep' type-id='type-id-96' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-97'/>
+    <typedef-decl name='ssize_t' type-id='type-id-95' filepath='/usr/include/sys/types.h' line='108' column='1' id='type-id-98'/>
+    <pointer-type-def type-id='type-id-93' size-in-bits='32' id='type-id-96'/>
+    <typedef-decl name='voidp' type-id='type-id-86' filepath='./zconf.h' line='416' column='1' id='type-id-99'/>
     <function-decl name='memchr' filepath='/usr/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
+      <parameter type-id='type-id-86'/>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='close' filepath='/usr/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='32'>
       <parameter type-id='type-id-22'/>
@@ -920,126 +933,151 @@
     </function-decl>
     <function-decl name='read' filepath='/usr/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='32'>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-95'/>
+      <parameter type-id='type-id-86'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-98'/>
     </function-decl>
     <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-99'/>
+      <parameter type-id='type-id-97'/>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-24'/>
+      <return type-id='type-id-87'/>
     </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-93' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-99' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-93' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-99' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-16' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-16' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-16'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
       <parameter type-id='type-id-22' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-70' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-55' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
       <parameter type-id='type-id-22' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-70'/>
+      <return type-id='type-id-55'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-22'/>
+    </function-decl>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-23'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-22'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-23'/>
+      <return type-id='type-id-22'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-23'/>
+      <return type-id='type-id-22'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-23'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-24'/>
+      <parameter type-id='type-id-22'/>
       <return type-id='type-id-22'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidpc' type-id='type-id-46' filepath='./zconf.h' line='414' column='1' id='type-id-100'/>
-    <typedef-decl name='__gnuc_va_list' type-id='type-id-70' filepath='/usr/lib/gcc/x86_64-linux-gnu/11/include/stdarg.h' line='40' column='1' id='type-id-101'/>
-    <typedef-decl name='va_list' type-id='type-id-101' filepath='/usr/lib/gcc/x86_64-linux-gnu/11/include/stdarg.h' line='99' column='1' id='type-id-102'/>
-    <function-decl name='vsnprintf' filepath='/usr/include/stdio.h' line='382' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-70'/>
-      <parameter type-id='type-id-6'/>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-70'/>
+    <typedef-decl name='__gnuc_va_list' type-id='type-id-55' filepath='/usr/lib/gcc/x86_64-linux-gnu/13/include/stdarg.h' line='40' column='1' id='type-id-100'/>
+    <typedef-decl name='va_list' type-id='type-id-100' filepath='/usr/lib/gcc/x86_64-linux-gnu/13/include/stdarg.h' line='103' column='1' id='type-id-101'/>
+    <typedef-decl name='voidpc' type-id='type-id-86' filepath='./zconf.h' line='414' column='1' id='type-id-102'/>
+    <function-decl name='vsnprintf' filepath='/usr/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='32'>
+      <parameter type-id='type-id-55'/>
+      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-24'/>
+      <parameter type-id='type-id-55'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='memmove' filepath='/usr/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
+      <parameter type-id='type-id-86'/>
+      <parameter type-id='type-id-86'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-86'/>
     </function-decl>
     <function-decl name='write' filepath='/usr/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='32'>
       <parameter type-id='type-id-22'/>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-95'/>
+      <parameter type-id='type-id-86'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-98'/>
     </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-100' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-4' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-102' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-100' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-7' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-7' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-7'/>
+      <parameter type-id='type-id-102' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-16' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-16' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-16'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
       <parameter type-id='type-id-22' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-80' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-24' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-80' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-102' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-24' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-101' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-80' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-24' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
       <parameter type-id='type-id-22' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-91' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
       <parameter type-id='type-id-22' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
       <parameter type-id='type-id-22' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-103'/>
-    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-104' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-105'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-103' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-104'>
+      <underlying-type type-id='type-id-105'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-106' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-107'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='op' type-id='type-id-3' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
       </data-member>
@@ -1047,217 +1085,186 @@
         <var-decl name='bits' type-id='type-id-3' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='val' type-id='type-id-40' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+        <var-decl name='val' type-id='type-id-71' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='code' type-id='type-id-105' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-104'/>
-    <enum-decl name='codetype' naming-typedef-id='type-id-106' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-107'>
-      <underlying-type type-id='type-id-103'/>
-      <enumerator name='CODES' value='0'/>
-      <enumerator name='LENS' value='1'/>
-      <enumerator name='DISTS' value='2'/>
-    </enum-decl>
-    <typedef-decl name='codetype' type-id='type-id-107' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-106'/>
+    <typedef-decl name='code' type-id='type-id-107' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-106'/>
+    <typedef-decl name='codetype' type-id='type-id-104' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-103'/>
     <typedef-decl name='in_func' type-id='type-id-108' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-109'/>
     <typedef-decl name='out_func' type-id='type-id-110' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-111'/>
-    <pointer-type-def type-id='type-id-104' size-in-bits='32' id='type-id-112'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-105'/>
+    <pointer-type-def type-id='type-id-106' size-in-bits='32' id='type-id-112'/>
     <pointer-type-def type-id='type-id-112' size-in-bits='32' id='type-id-113'/>
     <pointer-type-def type-id='type-id-114' size-in-bits='32' id='type-id-110'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='32' id='type-id-91'/>
-    <pointer-type-def type-id='type-id-91' size-in-bits='32' id='type-id-115'/>
+    <pointer-type-def type-id='type-id-3' size-in-bits='32' id='type-id-89'/>
+    <pointer-type-def type-id='type-id-89' size-in-bits='32' id='type-id-115'/>
     <pointer-type-def type-id='type-id-116' size-in-bits='32' id='type-id-108'/>
-    <pointer-type-def type-id='type-id-40' size-in-bits='32' id='type-id-117'/>
+    <pointer-type-def type-id='type-id-71' size-in-bits='32' id='type-id-117'/>
+    <typedef-decl name='voidpf' type-id='type-id-86' filepath='./zconf.h' line='415' column='1' id='type-id-118'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
       <parameter type-id='type-id-22' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-91' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-89' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-24' name='version' filepath='src.d/infback.c' line='32' column='1'/>
       <parameter type-id='type-id-22' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
       <parameter type-id='type-id-109' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-46' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-86' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
       <parameter type-id='type-id-111' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-46' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <parameter type-id='type-id-86' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-59'/>
-      <parameter type-id='type-id-4'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-23'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-87'/>
     </function-decl>
     <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-106'/>
+      <parameter type-id='type-id-103'/>
       <parameter type-id='type-id-117'/>
-      <parameter type-id='type-id-4'/>
+      <parameter type-id='type-id-11'/>
       <parameter type-id='type-id-113'/>
-      <parameter type-id='type-id-86'/>
+      <parameter type-id='type-id-81'/>
       <parameter type-id='type-id-117'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-type size-in-bits='32' id='type-id-114'>
-      <parameter type-id='type-id-46'/>
-      <parameter type-id='type-id-91'/>
-      <parameter type-id='type-id-4'/>
+      <parameter type-id='type-id-86'/>
+      <parameter type-id='type-id-89'/>
+      <parameter type-id='type-id-11'/>
       <return type-id='type-id-22'/>
     </function-type>
     <function-type size-in-bits='32' id='type-id-116'>
-      <parameter type-id='type-id-46'/>
+      <parameter type-id='type-id-86'/>
       <parameter type-id='type-id-115'/>
-      <return type-id='type-id-4'/>
+      <return type-id='type-id-11'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-86' filepath='./zconf.h' line='415' column='1' id='type-id-119'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
       <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-22' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-80' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-24' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
       <parameter type-id='type-id-22' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
       <parameter type-id='type-id-22' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
       <parameter type-id='type-id-22' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-22' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-22'/>
-    </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
       <parameter type-id='type-id-21' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-85' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <parameter type-id='type-id-80' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
       <parameter type-id='type-id-18' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-9' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <parameter type-id='type-id-13' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-61' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-44' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-59' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-59' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <parameter type-id='type-id-23' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-23' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
       <parameter type-id='type-id-22' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
       <parameter type-id='type-id-22' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
       <return type-id='type-id-1'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-59' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-23' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='2048' id='type-id-119'>
-      <subrange length='256' type-id='type-id-4' id='type-id-120'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='2048' id='type-id-121'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-11' id='type-id-122'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='4096' id='type-id-121'>
-      <subrange length='512' type-id='type-id-4' id='type-id-122'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='4096' id='type-id-123'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-11' id='type-id-124'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='infinite' id='type-id-123'>
-      <subrange length='infinite' id='type-id-124'/>
+    <array-type-def dimensions='1' type-id='type-id-120' size-in-bits='unknown' id='type-id-125'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-126'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-38' const='yes' id='type-id-118'/>
-    <var-decl name='_length_code' type-id='type-id-123' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <qualified-type-def type-id='type-id-69' const='yes' id='type-id-120'/>
+    <var-decl name='_length_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
     <var-decl name='_dist_code' type-id='type-id-123' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <pointer-type-def type-id='type-id-10' size-in-bits='32' id='type-id-125'/>
+    <pointer-type-def type-id='type-id-15' size-in-bits='32' id='type-id-127'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
       <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
       <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
       <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-125' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <parameter type-id='type-id-127' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='uncompress'>
       <parameter type-id='type-id-21' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
       <parameter type-id='type-id-20' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
       <parameter type-id='type-id-18' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-10' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <parameter type-id='type-id-15' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
       <return type-id='type-id-22'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='32' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-126' size-in-bits='320' id='type-id-127'>
-      <subrange length='10' type-id='type-id-4' id='type-id-128'/>
+    <array-type-def dimensions='1' type-id='type-id-128' size-in-bits='320' id='type-id-129'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-11' id='type-id-130'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-70' const='yes' id='type-id-126'/>
-    <function-decl name='malloc' filepath='/usr/include/stdlib.h' line='540' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-6'/>
-      <return type-id='type-id-46'/>
-    </function-decl>
-    <function-decl name='free' filepath='/usr/include/stdlib.h' line='555' column='1' visibility='default' binding='global' size-in-bits='32'>
-      <parameter type-id='type-id-46'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
+    <qualified-type-def type-id='type-id-55' const='yes' id='type-id-128'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-80'/>
+      <return type-id='type-id-24'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-10'/>
+      <return type-id='type-id-15'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='32' elf-symbol-id='zError'>
       <parameter type-id='type-id-22' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-80'/>
+      <return type-id='type-id-24'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-127' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-129' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-x86_64-pc-linux-gnu.abi b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-x86_64-pc-linux-gnu.abi
index b2a63a4b..8152352c 100644
--- a/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-x86_64-pc-linux-gnu.abi
+++ b/test/abi/zlib-04f42ceca40f73e2978b50e93806c2a18c1281fc-x86_64-pc-linux-gnu.abi
@@ -1,4 +1,4 @@
-<abi-corpus version='2.0' path='btmp1/libz.so.1.2.13' architecture='elf-amd-x86_64' soname='libz.so.1'>
+<abi-corpus version='2.2' path='btmp1/libz.so.1.2.13' architecture='elf-amd-x86_64' soname='libz.so.1'>
   <elf-needed>
     <dependency name='libc.so.6'/>
   </elf-needed>
@@ -94,54 +94,54 @@
   </elf-function-symbols>
   <abi-instr address-size='64' path='src.d/adler32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <type-decl name='long int' size-in-bits='64' id='type-id-1'/>
+    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-3'/>
+    <typedef-decl name='Bytef' type-id='type-id-3' filepath='./zconf.h' line='406' column='1' id='type-id-4'/>
+    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/include/x86_64-linux-gnu/bits/types.h' line='153' column='1' id='type-id-5'/>
+    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/include/x86_64-linux-gnu/bits/types.h' line='152' column='1' id='type-id-6'/>
+    <typedef-decl name='off64_t' type-id='type-id-5' filepath='/usr/include/x86_64-linux-gnu/sys/types.h' line='92' column='1' id='type-id-7'/>
+    <typedef-decl name='off_t' type-id='type-id-6' filepath='/usr/include/x86_64-linux-gnu/sys/types.h' line='85' column='1' id='type-id-8'/>
+    <typedef-decl name='size_t' type-id='type-id-9' filepath='/usr/lib/gcc/x86_64-linux-gnu/13/include/stddef.h' line='214' column='1' id='type-id-10'/>
+    <typedef-decl name='uInt' type-id='type-id-11' filepath='./zconf.h' line='399' column='1' id='type-id-12'/>
+    <typedef-decl name='uLong' type-id='type-id-9' filepath='./zconf.h' line='400' column='1' id='type-id-13'/>
+    <typedef-decl name='z_size_t' type-id='type-id-10' filepath='./zconf.h' line='251' column='1' id='type-id-14'/>
     <type-decl name='unsigned char' size-in-bits='8' id='type-id-2'/>
-    <type-decl name='unsigned int' size-in-bits='32' id='type-id-3'/>
-    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-4'/>
-    <typedef-decl name='z_size_t' type-id='type-id-5' filepath='./zconf.h' line='251' column='1' id='type-id-6'/>
-    <typedef-decl name='Byte' type-id='type-id-2' filepath='./zconf.h' line='397' column='1' id='type-id-7'/>
-    <typedef-decl name='uInt' type-id='type-id-3' filepath='./zconf.h' line='399' column='1' id='type-id-8'/>
-    <typedef-decl name='uLong' type-id='type-id-4' filepath='./zconf.h' line='400' column='1' id='type-id-9'/>
-    <typedef-decl name='Bytef' type-id='type-id-7' filepath='./zconf.h' line='406' column='1' id='type-id-10'/>
-    <typedef-decl name='__off_t' type-id='type-id-1' filepath='/usr/include/x86_64-linux-gnu/bits/types.h' line='152' column='1' id='type-id-11'/>
-    <typedef-decl name='__off64_t' type-id='type-id-1' filepath='/usr/include/x86_64-linux-gnu/bits/types.h' line='153' column='1' id='type-id-12'/>
-    <typedef-decl name='off_t' type-id='type-id-11' filepath='/usr/include/x86_64-linux-gnu/sys/types.h' line='85' column='1' id='type-id-13'/>
-    <typedef-decl name='off64_t' type-id='type-id-12' filepath='/usr/include/x86_64-linux-gnu/sys/types.h' line='92' column='1' id='type-id-14'/>
-    <typedef-decl name='size_t' type-id='type-id-4' filepath='/usr/lib/gcc/x86_64-linux-gnu/11/include/stddef.h' line='209' column='1' id='type-id-5'/>
-    <qualified-type-def type-id='type-id-10' const='yes' id='type-id-15'/>
+    <type-decl name='unsigned int' size-in-bits='32' id='type-id-11'/>
+    <type-decl name='unsigned long int' size-in-bits='64' id='type-id-9'/>
+    <qualified-type-def type-id='type-id-4' const='yes' id='type-id-15'/>
     <pointer-type-def type-id='type-id-15' size-in-bits='64' id='type-id-16'/>
     <function-decl name='adler32_z' mangled-name='adler32_z' filepath='src.d/adler32.c' line='63' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='64' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='65' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/adler32.c' line='66' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32' mangled-name='adler32' filepath='src.d/adler32.c' line='134' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32'>
-      <parameter type-id='type-id-9' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
+      <parameter type-id='type-id-13' name='adler' filepath='src.d/adler32.c' line='135' column='1'/>
       <parameter type-id='type-id-16' name='buf' filepath='src.d/adler32.c' line='136' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/adler32.c' line='137' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine' mangled-name='adler32_combine' filepath='src.d/adler32.c' line='172' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='173' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='174' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/adler32.c' line='175' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='adler32_combine64' mangled-name='adler32_combine64' filepath='src.d/adler32.c' line='180' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='adler32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
-      <parameter type-id='type-id-9' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='adler1' filepath='src.d/adler32.c' line='181' column='1'/>
+      <parameter type-id='type-id-13' name='adler2' filepath='src.d/adler32.c' line='182' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/adler32.c' line='183' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/compress.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='uLongf' type-id='type-id-9' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
+    <typedef-decl name='uLongf' type-id='type-id-13' filepath='./zconf.h' line='411' column='1' id='type-id-17'/>
     <pointer-type-def type-id='type-id-17' size-in-bits='64' id='type-id-18'/>
     <function-decl name='compress2' mangled-name='compress2' filepath='src.d/compress.c' line='22' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compress2'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='23' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='24' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='25' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='26' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/compress.c' line='27' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
@@ -149,131 +149,145 @@
       <parameter type-id='type-id-19' name='dest' filepath='src.d/compress.c' line='69' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/compress.c' line='70' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/compress.c' line='71' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='72' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='compressBound' mangled-name='compressBound' filepath='src.d/compress.c' line='81' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='compressBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/compress.c' line='82' column='1'/>
+      <return type-id='type-id-13'/>
+    </function-decl>
+    <function-decl name='deflate' filepath='src.d/zlib.h' line='250' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateEnd' filepath='src.d/zlib.h' line='363' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='deflateInit_' filepath='src.d/zlib.h' line='1781' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/crc32.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='z_crc_t' type-id='type-id-3' filepath='./zconf.h' line='435' column='1' id='type-id-21'/>
-    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-22'/>
-    <pointer-type-def type-id='type-id-22' size-in-bits='64' id='type-id-23'/>
-    <qualified-type-def type-id='type-id-21' const='yes' id='type-id-24'/>
+    <typedef-decl name='z_crc_t' type-id='type-id-11' filepath='./zconf.h' line='435' column='1' id='type-id-23'/>
+    <qualified-type-def type-id='type-id-2' const='yes' id='type-id-24'/>
     <pointer-type-def type-id='type-id-24' size-in-bits='64' id='type-id-25'/>
+    <qualified-type-def type-id='type-id-23' const='yes' id='type-id-26'/>
+    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-27'/>
     <function-decl name='get_crc_table' mangled-name='get_crc_table' filepath='src.d/crc32.c' line='595' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='get_crc_table'>
-      <return type-id='type-id-25'/>
+      <return type-id='type-id-27'/>
     </function-decl>
     <function-decl name='crc32_z' mangled-name='crc32_z' filepath='src.d/crc32.c' line='748' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_z@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
-      <parameter type-id='type-id-23' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
-      <parameter type-id='type-id-6' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='749' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='750' column='1'/>
+      <parameter type-id='type-id-14' name='len' filepath='src.d/crc32.c' line='751' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32' mangled-name='crc32' filepath='src.d/crc32.c' line='1072' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32'>
-      <parameter type-id='type-id-4' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
-      <parameter type-id='type-id-23' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
-      <parameter type-id='type-id-8' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-9' name='crc' filepath='src.d/crc32.c' line='1073' column='1'/>
+      <parameter type-id='type-id-25' name='buf' filepath='src.d/crc32.c' line='1074' column='1'/>
+      <parameter type-id='type-id-12' name='len' filepath='src.d/crc32.c' line='1075' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine64' mangled-name='crc32_combine64' filepath='src.d/crc32.c' line='1081' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1082' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1083' column='1'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1084' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine' mangled-name='crc32_combine' filepath='src.d/crc32.c' line='1093' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1094' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1095' column='1'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1096' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen64' mangled-name='crc32_combine_gen64' filepath='src.d/crc32.c' line='1102' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen64@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-14' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-7' name='len2' filepath='src.d/crc32.c' line='1103' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_gen' mangled-name='crc32_combine_gen' filepath='src.d/crc32.c' line='1112' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_gen@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-13' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-8' name='len2' filepath='src.d/crc32.c' line='1113' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='crc32_combine_op' mangled-name='crc32_combine_op' filepath='src.d/crc32.c' line='1119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='crc32_combine_op@@ZLIB_1.2.12'>
-      <parameter type-id='type-id-9' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
-      <parameter type-id='type-id-9' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
-      <parameter type-id='type-id-9' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
-      <return type-id='type-id-9'/>
+      <parameter type-id='type-id-13' name='crc1' filepath='src.d/crc32.c' line='1120' column='1'/>
+      <parameter type-id='type-id-13' name='crc2' filepath='src.d/crc32.c' line='1121' column='1'/>
+      <parameter type-id='type-id-13' name='op' filepath='src.d/crc32.c' line='1122' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/deflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='char' size-in-bits='8' id='type-id-26'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-27'/>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='1248' id='type-id-29'>
-      <subrange length='39' type-id='type-id-4' id='type-id-30'/>
+    <type-decl name='char' size-in-bits='8' id='type-id-28'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1248' id='type-id-30'>
+      <subrange length='39' lower-bound='0' upper-bound='38' type-id='type-id-9' id='type-id-31'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='18336' id='type-id-31'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='18336' id='type-id-32'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-28' size-in-bits='1952' id='type-id-33'>
-      <subrange length='61' type-id='type-id-4' id='type-id-34'/>
+    <array-type-def dimensions='1' type-id='type-id-29' size-in-bits='1952' id='type-id-34'>
+      <subrange length='61' lower-bound='0' upper-bound='60' type-id='type-id-9' id='type-id-35'/>
     </array-type-def>
     <type-decl name='int' size-in-bits='32' id='type-id-20'/>
-    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-35'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
-    </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-36' size-in-bits='4584' id='type-id-37'>
-      <subrange length='573' type-id='type-id-4' id='type-id-32'/>
+    <array-type-def dimensions='1' type-id='type-id-20' size-in-bits='18336' id='type-id-36'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
     </array-type-def>
-    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-38'/>
-    <array-type-def dimensions='1' type-id='type-id-39' size-in-bits='256' id='type-id-40'>
-      <subrange length='16' type-id='type-id-4' id='type-id-41'/>
-    </array-type-def>
-    <type-decl name='void' id='type-id-42'/>
-    <typedef-decl name='charf' type-id='type-id-26' filepath='./zconf.h' line='408' column='1' id='type-id-43'/>
-    <typedef-decl name='voidpf' type-id='type-id-44' filepath='./zconf.h' line='415' column='1' id='type-id-45'/>
-    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-28'>
+    <class-decl name='ct_data_s' size-in-bits='32' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='68' column='1' id='type-id-29'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='fc' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
+        <var-decl name='fc' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='72' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='dl' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
+        <var-decl name='dl' type-id='type-id-38' visibility='default' filepath='src.d/deflate.h' line='76' column='1'/>
       </data-member>
     </class-decl>
-    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-46'>
-      <data-member access='public'>
-        <var-decl name='freq' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
+    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-39'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='code' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='time' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
       </data-member>
-    </union-decl>
-    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-47'>
-      <data-member access='public'>
-        <var-decl name='dad' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
       </data-member>
-      <data-member access='public'>
-        <var-decl name='len' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
+      <data-member access='public' layout-offset-in-bits='160'>
+        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
       </data-member>
-    </union-decl>
-    <typedef-decl name='ct_data' type-id='type-id-28' filepath='src.d/deflate.h' line='77' column='1' id='type-id-48'/>
-    <typedef-decl name='static_tree_desc' type-id='type-id-27' filepath='src.d/deflate.h' line='84' column='1' id='type-id-49'/>
-    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-50'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='dyn_tree' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      <data-member access='public' layout-offset-in-bits='192'>
+        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      <data-member access='public' layout-offset-in-bits='256'>
+        <var-decl name='extra_len' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='stat_desc' type-id='type-id-52' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      <data-member access='public' layout-offset-in-bits='288'>
+        <var-decl name='extra_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='320'>
+        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='384'>
+        <var-decl name='name_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='448'>
+        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='512'>
+        <var-decl name='comm_max' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='544'>
+        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='576'>
+        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='Pos' type-id='type-id-39' filepath='src.d/deflate.h' line='92' column='1' id='type-id-53'/>
-    <typedef-decl name='Posf' type-id='type-id-53' filepath='src.d/deflate.h' line='93' column='1' id='type-id-54'/>
-    <typedef-decl name='IPos' type-id='type-id-3' filepath='src.d/deflate.h' line='94' column='1' id='type-id-55'/>
-    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-56'>
+    <class-decl name='internal_state' size-in-bits='47616' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='100' column='1' id='type-id-40'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='strm' type-id='type-id-57' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
+        <var-decl name='strm' type-id='type-id-21' visibility='default' filepath='src.d/deflate.h' line='101' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
         <var-decl name='status' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='102' column='1'/>
@@ -282,94 +296,94 @@
         <var-decl name='pending_buf' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='103' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='pending_buf_size' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
+        <var-decl name='pending_buf_size' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
         <var-decl name='pending_out' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='105' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='pending' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
+        <var-decl name='pending' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='106' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
         <var-decl name='wrap' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='107' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='gzhead' type-id='type-id-59' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
+        <var-decl name='gzhead' type-id='type-id-42' visibility='default' filepath='src.d/deflate.h' line='108' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='gzindex' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
+        <var-decl name='gzindex' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='109' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='method' type-id='type-id-7' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
+        <var-decl name='method' type-id='type-id-3' visibility='default' filepath='src.d/deflate.h' line='110' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='608'>
         <var-decl name='last_flush' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='111' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='w_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
+        <var-decl name='w_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='115' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='672'>
-        <var-decl name='w_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
+        <var-decl name='w_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='116' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
-        <var-decl name='w_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
+        <var-decl name='w_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='117' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
         <var-decl name='window' type-id='type-id-19' visibility='default' filepath='src.d/deflate.h' line='119' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='window_size' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
+        <var-decl name='window_size' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='129' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
-        <var-decl name='prev' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
+        <var-decl name='prev' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='134' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='head' type-id='type-id-60' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
+        <var-decl name='head' type-id='type-id-43' visibility='default' filepath='src.d/deflate.h' line='140' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
-        <var-decl name='ins_h' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
+        <var-decl name='ins_h' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='142' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1056'>
-        <var-decl name='hash_size' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
+        <var-decl name='hash_size' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='143' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1088'>
-        <var-decl name='hash_bits' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
+        <var-decl name='hash_bits' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='144' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1120'>
-        <var-decl name='hash_mask' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
+        <var-decl name='hash_mask' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='145' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1152'>
-        <var-decl name='hash_shift' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
+        <var-decl name='hash_shift' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='147' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1216'>
         <var-decl name='block_start' type-id='type-id-1' visibility='default' filepath='src.d/deflate.h' line='154' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1280'>
-        <var-decl name='match_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
+        <var-decl name='match_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='159' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1312'>
-        <var-decl name='prev_match' type-id='type-id-55' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
+        <var-decl name='prev_match' type-id='type-id-44' visibility='default' filepath='src.d/deflate.h' line='160' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1344'>
         <var-decl name='match_available' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='161' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1376'>
-        <var-decl name='strstart' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
+        <var-decl name='strstart' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='162' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1408'>
-        <var-decl name='match_start' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
+        <var-decl name='match_start' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='163' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1440'>
-        <var-decl name='lookahead' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
+        <var-decl name='lookahead' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='164' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1472'>
-        <var-decl name='prev_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
+        <var-decl name='prev_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='166' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1504'>
-        <var-decl name='max_chain_length' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
+        <var-decl name='max_chain_length' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='171' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1536'>
-        <var-decl name='max_lazy_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
+        <var-decl name='max_lazy_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='177' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1568'>
         <var-decl name='level' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='188' column='1'/>
@@ -378,34 +392,34 @@
         <var-decl name='strategy' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='189' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1632'>
-        <var-decl name='good_match' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
+        <var-decl name='good_match' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='191' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1664'>
         <var-decl name='nice_match' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='194' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1696'>
-        <var-decl name='dyn_ltree' type-id='type-id-31' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
+        <var-decl name='dyn_ltree' type-id='type-id-32' visibility='default' filepath='src.d/deflate.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='20032'>
-        <var-decl name='dyn_dtree' type-id='type-id-33' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
+        <var-decl name='dyn_dtree' type-id='type-id-34' visibility='default' filepath='src.d/deflate.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='21984'>
-        <var-decl name='bl_tree' type-id='type-id-29' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
+        <var-decl name='bl_tree' type-id='type-id-30' visibility='default' filepath='src.d/deflate.h' line='200' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23232'>
-        <var-decl name='l_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
+        <var-decl name='l_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='202' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23424'>
-        <var-decl name='d_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
+        <var-decl name='d_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='203' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23616'>
-        <var-decl name='bl_desc' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
+        <var-decl name='bl_desc' type-id='type-id-45' visibility='default' filepath='src.d/deflate.h' line='204' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='23808'>
-        <var-decl name='bl_count' type-id='type-id-40' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
+        <var-decl name='bl_count' type-id='type-id-46' visibility='default' filepath='src.d/deflate.h' line='206' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='24064'>
-        <var-decl name='heap' type-id='type-id-35' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
+        <var-decl name='heap' type-id='type-id-36' visibility='default' filepath='src.d/deflate.h' line='209' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42400'>
         <var-decl name='heap_len' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='210' column='1'/>
@@ -414,234 +428,225 @@
         <var-decl name='heap_max' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='211' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='42464'>
-        <var-decl name='depth' type-id='type-id-37' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
+        <var-decl name='depth' type-id='type-id-47' visibility='default' filepath='src.d/deflate.h' line='216' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47104'>
-        <var-decl name='sym_buf' type-id='type-id-61' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
+        <var-decl name='sym_buf' type-id='type-id-48' visibility='default' filepath='src.d/deflate.h' line='220' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47168'>
-        <var-decl name='lit_bufsize' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
+        <var-decl name='lit_bufsize' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='222' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47200'>
-        <var-decl name='sym_next' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
+        <var-decl name='sym_next' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='242' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47232'>
-        <var-decl name='sym_end' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
+        <var-decl name='sym_end' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='243' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47296'>
-        <var-decl name='opt_len' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
+        <var-decl name='opt_len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='245' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47360'>
-        <var-decl name='static_len' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
+        <var-decl name='static_len' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='246' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47424'>
-        <var-decl name='matches' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
+        <var-decl name='matches' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='247' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47456'>
-        <var-decl name='insert' type-id='type-id-8' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
+        <var-decl name='insert' type-id='type-id-12' visibility='default' filepath='src.d/deflate.h' line='248' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47488'>
-        <var-decl name='bi_buf' type-id='type-id-39' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
+        <var-decl name='bi_buf' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='255' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47520'>
         <var-decl name='bi_valid' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='259' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='47552'>
-        <var-decl name='high_water' type-id='type-id-58' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
+        <var-decl name='high_water' type-id='type-id-41' visibility='default' filepath='src.d/deflate.h' line='264' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='deflate_state' type-id='type-id-56' filepath='src.d/deflate.h' line='271' column='1' id='type-id-62'/>
-    <typedef-decl name='alloc_func' type-id='type-id-63' filepath='src.d/zlib.h' line='81' column='1' id='type-id-64'/>
-    <typedef-decl name='free_func' type-id='type-id-65' filepath='src.d/zlib.h' line='82' column='1' id='type-id-66'/>
-    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-67'>
+    <class-decl name='tree_desc_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/deflate.h' line='86' column='1' id='type-id-45'>
+      <data-member access='public' layout-offset-in-bits='0'>
+        <var-decl name='dyn_tree' type-id='type-id-50' visibility='default' filepath='src.d/deflate.h' line='87' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='64'>
+        <var-decl name='max_code' type-id='type-id-20' visibility='default' filepath='src.d/deflate.h' line='88' column='1'/>
+      </data-member>
+      <data-member access='public' layout-offset-in-bits='128'>
+        <var-decl name='stat_desc' type-id='type-id-51' visibility='default' filepath='src.d/deflate.h' line='89' column='1'/>
+      </data-member>
+    </class-decl>
+    <class-decl name='z_stream_s' size-in-bits='896' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='86' column='1' id='type-id-52'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='next_in' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='87' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='avail_in' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
+        <var-decl name='avail_in' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='88' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='total_in' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
+        <var-decl name='total_in' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='89' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='next_out' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='91' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='avail_out' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
+        <var-decl name='avail_out' type-id='type-id-12' visibility='default' filepath='src.d/zlib.h' line='92' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='total_out' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
+        <var-decl name='total_out' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='93' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
+        <var-decl name='msg' type-id='type-id-53' visibility='default' filepath='src.d/zlib.h' line='95' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='state' type-id='type-id-69' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
+        <var-decl name='state' type-id='type-id-54' visibility='default' filepath='src.d/zlib.h' line='96' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='zalloc' type-id='type-id-64' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
+        <var-decl name='zalloc' type-id='type-id-55' visibility='default' filepath='src.d/zlib.h' line='98' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='zfree' type-id='type-id-66' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
+        <var-decl name='zfree' type-id='type-id-56' visibility='default' filepath='src.d/zlib.h' line='99' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
-        <var-decl name='opaque' type-id='type-id-45' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
+        <var-decl name='opaque' type-id='type-id-57' visibility='default' filepath='src.d/zlib.h' line='100' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='704'>
         <var-decl name='data_type' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='102' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='768'>
-        <var-decl name='adler' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
+        <var-decl name='adler' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='104' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='reserved' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
+        <var-decl name='reserved' type-id='type-id-13' visibility='default' filepath='src.d/zlib.h' line='105' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='z_stream' type-id='type-id-67' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
-    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-57'/>
-    <class-decl name='gz_header_s' size-in-bits='640' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='114' column='1' id='type-id-72'>
-      <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='text' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='115' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='time' type-id='type-id-9' visibility='default' filepath='src.d/zlib.h' line='116' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='xflags' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='117' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='160'>
-        <var-decl name='os' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='118' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='192'>
-        <var-decl name='extra' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='119' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='extra_len' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='120' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='288'>
-        <var-decl name='extra_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='121' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='name' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='122' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='name_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='123' column='1'/>
-      </data-member>
-      <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='comment' type-id='type-id-19' visibility='default' filepath='src.d/zlib.h' line='124' column='1'/>
+    <typedef-decl name='IPos' type-id='type-id-11' filepath='src.d/deflate.h' line='94' column='1' id='type-id-44'/>
+    <typedef-decl name='Pos' type-id='type-id-49' filepath='src.d/deflate.h' line='92' column='1' id='type-id-58'/>
+    <typedef-decl name='Posf' type-id='type-id-58' filepath='src.d/deflate.h' line='93' column='1' id='type-id-59'/>
+    <typedef-decl name='alloc_func' type-id='type-id-60' filepath='src.d/zlib.h' line='81' column='1' id='type-id-55'/>
+    <typedef-decl name='charf' type-id='type-id-28' filepath='./zconf.h' line='408' column='1' id='type-id-61'/>
+    <typedef-decl name='ct_data' type-id='type-id-29' filepath='src.d/deflate.h' line='77' column='1' id='type-id-62'/>
+    <typedef-decl name='deflate_state' type-id='type-id-40' filepath='src.d/deflate.h' line='271' column='1' id='type-id-63'/>
+    <typedef-decl name='free_func' type-id='type-id-64' filepath='src.d/zlib.h' line='82' column='1' id='type-id-56'/>
+    <typedef-decl name='gz_header' type-id='type-id-39' filepath='src.d/zlib.h' line='129' column='1' id='type-id-65'/>
+    <typedef-decl name='gz_headerp' type-id='type-id-66' filepath='src.d/zlib.h' line='131' column='1' id='type-id-42'/>
+    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-67'/>
+    <typedef-decl name='uchf' type-id='type-id-67' filepath='src.d/zutil.h' line='40' column='1' id='type-id-68'/>
+    <typedef-decl name='ulg' type-id='type-id-9' filepath='src.d/zutil.h' line='43' column='1' id='type-id-41'/>
+    <typedef-decl name='ush' type-id='type-id-69' filepath='src.d/zutil.h' line='41' column='1' id='type-id-49'/>
+    <typedef-decl name='z_stream' type-id='type-id-52' filepath='src.d/zlib.h' line='106' column='1' id='type-id-70'/>
+    <typedef-decl name='z_streamp' type-id='type-id-71' filepath='src.d/zlib.h' line='108' column='1' id='type-id-21'/>
+    <array-type-def dimensions='1' type-id='type-id-67' size-in-bits='4584' id='type-id-47'>
+      <subrange length='573' lower-bound='0' upper-bound='572' type-id='type-id-9' id='type-id-33'/>
+    </array-type-def>
+    <union-decl name='__anonymous_union__1' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='73' column='1' id='type-id-38'>
+      <data-member access='public'>
+        <var-decl name='dad' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='74' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='512'>
-        <var-decl name='comm_max' type-id='type-id-8' visibility='default' filepath='src.d/zlib.h' line='125' column='1'/>
+      <data-member access='public'>
+        <var-decl name='len' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='75' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='544'>
-        <var-decl name='hcrc' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='126' column='1'/>
+    </union-decl>
+    <union-decl name='__anonymous_union__' size-in-bits='16' is-anonymous='yes' visibility='default' filepath='src.d/deflate.h' line='69' column='1' id='type-id-37'>
+      <data-member access='public'>
+        <var-decl name='freq' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='70' column='1'/>
       </data-member>
-      <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='done' type-id='type-id-20' visibility='default' filepath='src.d/zlib.h' line='127' column='1'/>
+      <data-member access='public'>
+        <var-decl name='code' type-id='type-id-49' visibility='default' filepath='src.d/deflate.h' line='71' column='1'/>
       </data-member>
-    </class-decl>
-    <typedef-decl name='gz_header' type-id='type-id-72' filepath='src.d/zlib.h' line='129' column='1' id='type-id-73'/>
-    <typedef-decl name='gz_headerp' type-id='type-id-74' filepath='src.d/zlib.h' line='131' column='1' id='type-id-59'/>
-    <typedef-decl name='uch' type-id='type-id-2' filepath='src.d/zutil.h' line='39' column='1' id='type-id-36'/>
-    <typedef-decl name='uchf' type-id='type-id-36' filepath='src.d/zutil.h' line='40' column='1' id='type-id-75'/>
-    <typedef-decl name='ush' type-id='type-id-38' filepath='src.d/zutil.h' line='41' column='1' id='type-id-39'/>
-    <typedef-decl name='ulg' type-id='type-id-4' filepath='src.d/zutil.h' line='43' column='1' id='type-id-58'/>
-    <pointer-type-def type-id='type-id-10' size-in-bits='64' id='type-id-19'/>
-    <pointer-type-def type-id='type-id-54' size-in-bits='64' id='type-id-60'/>
-    <pointer-type-def type-id='type-id-26' size-in-bits='64' id='type-id-68'/>
-    <pointer-type-def type-id='type-id-43' size-in-bits='64' id='type-id-76'/>
-    <qualified-type-def type-id='type-id-26' const='yes' id='type-id-77'/>
-    <pointer-type-def type-id='type-id-77' size-in-bits='64' id='type-id-78'/>
-    <qualified-type-def type-id='type-id-49' const='yes' id='type-id-79'/>
-    <pointer-type-def type-id='type-id-79' size-in-bits='64' id='type-id-52'/>
-    <pointer-type-def type-id='type-id-48' size-in-bits='64' id='type-id-51'/>
-    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-80'/>
-    <pointer-type-def type-id='type-id-73' size-in-bits='64' id='type-id-74'/>
-    <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-81'/>
-    <pointer-type-def type-id='type-id-56' size-in-bits='64' id='type-id-69'/>
-    <pointer-type-def type-id='type-id-82' size-in-bits='64' id='type-id-63'/>
-    <pointer-type-def type-id='type-id-8' size-in-bits='64' id='type-id-83'/>
-    <pointer-type-def type-id='type-id-75' size-in-bits='64' id='type-id-61'/>
-    <pointer-type-def type-id='type-id-3' size-in-bits='64' id='type-id-84'/>
-    <pointer-type-def type-id='type-id-85' size-in-bits='64' id='type-id-65'/>
-    <pointer-type-def type-id='type-id-42' size-in-bits='64' id='type-id-44'/>
+    </union-decl>
+    <type-decl name='unsigned short int' size-in-bits='16' id='type-id-69'/>
+    <array-type-def dimensions='1' type-id='type-id-49' size-in-bits='256' id='type-id-46'>
+      <subrange length='16' lower-bound='0' upper-bound='15' type-id='type-id-9' id='type-id-72'/>
+    </array-type-def>
+    <pointer-type-def type-id='type-id-4' size-in-bits='64' id='type-id-19'/>
+    <pointer-type-def type-id='type-id-59' size-in-bits='64' id='type-id-43'/>
+    <pointer-type-def type-id='type-id-28' size-in-bits='64' id='type-id-53'/>
+    <pointer-type-def type-id='type-id-61' size-in-bits='64' id='type-id-73'/>
+    <qualified-type-def type-id='type-id-28' const='yes' id='type-id-74'/>
+    <pointer-type-def type-id='type-id-74' size-in-bits='64' id='type-id-22'/>
+    <pointer-type-def type-id='type-id-62' size-in-bits='64' id='type-id-50'/>
+    <pointer-type-def type-id='type-id-63' size-in-bits='64' id='type-id-75'/>
+    <pointer-type-def type-id='type-id-65' size-in-bits='64' id='type-id-66'/>
+    <pointer-type-def type-id='type-id-20' size-in-bits='64' id='type-id-76'/>
+    <pointer-type-def type-id='type-id-40' size-in-bits='64' id='type-id-54'/>
+    <pointer-type-def type-id='type-id-77' size-in-bits='64' id='type-id-60'/>
+    <pointer-type-def type-id='type-id-12' size-in-bits='64' id='type-id-78'/>
+    <pointer-type-def type-id='type-id-68' size-in-bits='64' id='type-id-48'/>
+    <pointer-type-def type-id='type-id-11' size-in-bits='64' id='type-id-79'/>
+    <pointer-type-def type-id='type-id-80' size-in-bits='64' id='type-id-64'/>
     <pointer-type-def type-id='type-id-70' size-in-bits='64' id='type-id-71'/>
-    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-27'/>
+    <qualified-type-def type-id='type-id-81' const='yes' id='type-id-82'/>
+    <pointer-type-def type-id='type-id-82' size-in-bits='64' id='type-id-51'/>
+    <class-decl name='static_tree_desc_s' is-struct='yes' visibility='default' is-declaration-only='yes' id='type-id-83'/>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-57'/>
     <function-decl name='memcpy' filepath='/usr/include/string.h' line='43' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='memset' filepath='/usr/include/string.h' line='61' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-decl name='deflateInit_' mangled-name='deflateInit_' filepath='src.d/deflate.c' line='225' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='226' column='1'/>
-      <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='227' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/deflate.c' line='228' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='229' column='1'/>
-      <return type-id='type-id-20'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='deflateInit2_' mangled-name='deflateInit2_' filepath='src.d/deflate.c' line='237' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateInit2_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='239' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='240' column='1'/>
       <parameter type-id='type-id-20' name='method' filepath='src.d/deflate.c' line='241' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/deflate.c' line='242' column='1'/>
       <parameter type-id='type-id-20' name='memLevel' filepath='src.d/deflate.c' line='243' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='244' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/deflate.c' line='245' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/deflate.c' line='246' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetDictionary' mangled-name='deflateSetDictionary' filepath='src.d/deflate.c' line='412' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetDictionary'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='413' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/deflate.c' line='414' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/deflate.c' line='415' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateGetDictionary' mangled-name='deflateGetDictionary' filepath='src.d/deflate.c' line='481' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateGetDictionary@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='482' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/deflate.c' line='483' column='1'/>
-      <parameter type-id='type-id-83' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
+      <parameter type-id='type-id-78' name='dictLength' filepath='src.d/deflate.c' line='484' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateResetKeep' mangled-name='deflateResetKeep' filepath='src.d/deflate.c' line='503' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='504' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateReset' mangled-name='deflateReset' filepath='src.d/deflate.c' line='541' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateReset'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='542' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateSetHeader' mangled-name='deflateSetHeader' filepath='src.d/deflate.c' line='553' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateSetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
-      <parameter type-id='type-id-59' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='554' column='1'/>
+      <parameter type-id='type-id-42' name='head' filepath='src.d/deflate.c' line='555' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePending' mangled-name='deflatePending' filepath='src.d/deflate.c' line='564' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePending@@ZLIB_1.2.5.1'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
-      <parameter type-id='type-id-84' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
-      <parameter type-id='type-id-81' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='567' column='1'/>
+      <parameter type-id='type-id-79' name='pending' filepath='src.d/deflate.c' line='565' column='1'/>
+      <parameter type-id='type-id-76' name='bits' filepath='src.d/deflate.c' line='566' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflatePrime' mangled-name='deflatePrime' filepath='src.d/deflate.c' line='578' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflatePrime@@ZLIB_1.2.0.8'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='579' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/deflate.c' line='580' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/deflate.c' line='581' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateParams' mangled-name='deflateParams' filepath='src.d/deflate.c' line='605' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateParams'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='606' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/deflate.c' line='607' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/deflate.c' line='608' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateTune' mangled-name='deflateTune' filepath='src.d/deflate.c' line='654' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateTune@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='655' column='1'/>
       <parameter type-id='type-id-20' name='good_length' filepath='src.d/deflate.c' line='656' column='1'/>
       <parameter type-id='type-id-20' name='max_lazy' filepath='src.d/deflate.c' line='657' column='1'/>
       <parameter type-id='type-id-20' name='nice_length' filepath='src.d/deflate.c' line='658' column='1'/>
@@ -649,198 +654,203 @@
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='deflateBound' mangled-name='deflateBound' filepath='src.d/deflate.c' line='696' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateBound@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
-      <return type-id='type-id-9'/>
-    </function-decl>
-    <function-decl name='deflate' mangled-name='deflate' filepath='src.d/deflate.c' line='815' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflate'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='816' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/deflate.c' line='817' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='deflateEnd' mangled-name='deflateEnd' filepath='src.d/deflate.c' line='1130' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateEnd'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/deflate.c' line='1131' column='1'/>
-      <return type-id='type-id-20'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/deflate.c' line='697' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/deflate.c' line='698' column='1'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='deflateCopy' mangled-name='deflateCopy' filepath='src.d/deflate.c' line='1156' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='deflateCopy'>
-      <parameter type-id='type-id-57' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
-      <parameter type-id='type-id-57' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/deflate.c' line='1157' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/deflate.c' line='1158' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
+    <typedef-decl name='static_tree_desc' type-id='type-id-83' filepath='src.d/deflate.h' line='84' column='1' id='type-id-81'/>
     <function-decl name='_tr_init' filepath='src.d/deflate.h' line='294' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_flush_block' filepath='src.d/deflate.h' line='296' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-76'/>
-      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-73'/>
+      <parameter type-id='type-id-41'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-42'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_flush_bits' filepath='src.d/deflate.h' line='298' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_align' filepath='src.d/deflate.h' line='299' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-75'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='_tr_stored_block' filepath='src.d/deflate.h' line='300' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-80'/>
-      <parameter type-id='type-id-76'/>
-      <parameter type-id='type-id-58'/>
+      <parameter type-id='type-id-75'/>
+      <parameter type-id='type-id-73'/>
+      <parameter type-id='type-id-41'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-42'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <function-decl name='crc32' filepath='src.d/zlib.h' line='1727' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-13'/>
+      <parameter type-id='type-id-16'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zcalloc' filepath='src.d/zutil.h' line='261' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-3'/>
-      <parameter type-id='type-id-3'/>
-      <return type-id='type-id-45'/>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-11'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-57'/>
     </function-decl>
     <function-decl name='zcfree' filepath='src.d/zutil.h' line='263' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-45'/>
-      <return type-id='type-id-42'/>
-    </function-decl>
-    <function-type size-in-bits='64' id='type-id-82'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-8'/>
-      <parameter type-id='type-id-8'/>
-      <return type-id='type-id-45'/>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-57'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
+    <type-decl name='void' id='type-id-85'/>
+    <pointer-type-def type-id='type-id-85' id='type-id-84'/>
+    <function-type size-in-bits='64' id='type-id-80'>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-57'/>
+      <return type-id='type-id-85'/>
     </function-type>
-    <function-type size-in-bits='64' id='type-id-85'>
-      <parameter type-id='type-id-45'/>
-      <parameter type-id='type-id-45'/>
-      <return type-id='type-id-42'/>
+    <function-type size-in-bits='64' id='type-id-77'>
+      <parameter type-id='type-id-57'/>
+      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-12'/>
+      <return type-id='type-id-57'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzclose.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='gzFile' type-id='type-id-86' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-87'/>
-    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-88'>
+    <class-decl name='gzFile_s' size-in-bits='192' is-struct='yes' visibility='default' filepath='src.d/zlib.h' line='1834' column='1' id='type-id-86'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='have' type-id='type-id-3' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
+        <var-decl name='have' type-id='type-id-11' visibility='default' filepath='src.d/zlib.h' line='1835' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='next' type-id='type-id-89' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
+        <var-decl name='next' type-id='type-id-87' visibility='default' filepath='src.d/zlib.h' line='1836' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='pos' type-id='type-id-14' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
+        <var-decl name='pos' type-id='type-id-7' visibility='default' filepath='src.d/zlib.h' line='1837' column='1'/>
       </data-member>
     </class-decl>
-    <pointer-type-def type-id='type-id-88' size-in-bits='64' id='type-id-86'/>
+    <typedef-decl name='gzFile' type-id='type-id-88' filepath='src.d/zlib.h' line='1302' column='1' id='type-id-89'/>
+    <pointer-type-def type-id='type-id-86' size-in-bits='64' id='type-id-88'/>
     <function-decl name='gzclose' mangled-name='gzclose' filepath='src.d/gzclose.c' line='11' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzclose.c' line='12' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_r' mangled-name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_r@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87'/>
+    <function-decl name='gzclose_r' filepath='src.d/zlib.h' line='1644' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='gzclose_w' mangled-name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclose_w@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87'/>
+    <function-decl name='gzclose_w' filepath='src.d/zlib.h' line='1645' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-89'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzlib.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='variadic parameter type' id='type-id-90'/>
-    <function-decl name='open' filepath='/usr/include/fcntl.h' line='181' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-78'/>
+    <function-decl name='open' filepath='/usr/include/fcntl.h' line='209' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-22'/>
       <parameter type-id='type-id-20'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='snprintf' filepath='/usr/include/stdio.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-68'/>
-      <parameter type-id='type-id-5'/>
-      <parameter type-id='type-id-78'/>
+    <function-decl name='snprintf' filepath='/usr/include/stdio.h' line='385' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-53'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
+    <function-decl name='malloc' filepath='/usr/include/stdlib.h' line='672' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
+    </function-decl>
+    <function-decl name='free' filepath='/usr/include/stdlib.h' line='687' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-84'/>
+      <return type-id='type-id-85'/>
+    </function-decl>
     <function-decl name='strlen' filepath='/usr/include/string.h' line='407' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-78'/>
-      <return type-id='type-id-5'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-10'/>
     </function-decl>
     <function-decl name='lseek64' filepath='/usr/include/unistd.h' line='350' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-12'/>
+      <parameter type-id='type-id-5'/>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-12'/>
+      <return type-id='type-id-5'/>
     </function-decl>
     <function-decl name='gzopen' mangled-name='gzopen' filepath='src.d/gzlib.c' line='272' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen'>
-      <parameter type-id='type-id-78' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='273' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='274' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzopen64' mangled-name='gzopen64' filepath='src.d/gzlib.c' line='280' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzopen64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-78' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='path' filepath='src.d/gzlib.c' line='281' column='1'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='282' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzdopen' mangled-name='gzdopen' filepath='src.d/gzlib.c' line='288' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdopen'>
       <parameter type-id='type-id-20' name='fd' filepath='src.d/gzlib.c' line='289' column='1'/>
-      <parameter type-id='type-id-78' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
-      <return type-id='type-id-87'/>
+      <parameter type-id='type-id-22' name='mode' filepath='src.d/gzlib.c' line='290' column='1'/>
+      <return type-id='type-id-89'/>
     </function-decl>
     <function-decl name='gzbuffer' mangled-name='gzbuffer' filepath='src.d/gzlib.c' line='318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzbuffer@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
-      <parameter type-id='type-id-3' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='319' column='1'/>
+      <parameter type-id='type-id-11' name='size' filepath='src.d/gzlib.c' line='320' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzrewind' mangled-name='gzrewind' filepath='src.d/gzlib.c' line='345' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzrewind'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='346' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzseek64' mangled-name='gzseek64' filepath='src.d/gzlib.c' line='368' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
-      <parameter type-id='type-id-14' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='369' column='1'/>
+      <parameter type-id='type-id-7' name='offset' filepath='src.d/gzlib.c' line='370' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='371' column='1'/>
-      <return type-id='type-id-14'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzseek' mangled-name='gzseek' filepath='src.d/gzlib.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzseek'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
-      <parameter type-id='type-id-13' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='446' column='1'/>
+      <parameter type-id='type-id-8' name='offset' filepath='src.d/gzlib.c' line='447' column='1'/>
       <parameter type-id='type-id-20' name='whence' filepath='src.d/gzlib.c' line='448' column='1'/>
-      <return type-id='type-id-13'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gztell64' mangled-name='gztell64' filepath='src.d/gzlib.c' line='457' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell64@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='458' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gztell' mangled-name='gztell' filepath='src.d/gzlib.c' line='474' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gztell'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='475' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzoffset64' mangled-name='gzoffset64' filepath='src.d/gzlib.c' line='484' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset64@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
-      <return type-id='type-id-14'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='485' column='1'/>
+      <return type-id='type-id-7'/>
     </function-decl>
     <function-decl name='gzoffset' mangled-name='gzoffset' filepath='src.d/gzlib.c' line='507' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzoffset@@ZLIB_1.2.3.5'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
-      <return type-id='type-id-13'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='508' column='1'/>
+      <return type-id='type-id-8'/>
     </function-decl>
     <function-decl name='gzeof' mangled-name='gzeof' filepath='src.d/gzlib.c' line='517' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzeof'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='518' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzerror' mangled-name='gzerror' filepath='src.d/gzlib.c' line='534' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzerror'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
-      <parameter type-id='type-id-81' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
-      <return type-id='type-id-78'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='535' column='1'/>
+      <parameter type-id='type-id-76' name='errnum' filepath='src.d/gzlib.c' line='536' column='1'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='gzclearerr' mangled-name='gzclearerr' filepath='src.d/gzlib.c' line='555' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzclearerr@@ZLIB_1.2.0.2'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzlib.c' line='556' column='1'/>
+      <return type-id='type-id-85'/>
     </function-decl>
+    <type-decl name='variadic parameter type' id='type-id-90'/>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzread.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <typedef-decl name='voidp' type-id='type-id-44' filepath='./zconf.h' line='416' column='1' id='type-id-91'/>
-    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/include/x86_64-linux-gnu/bits/types.h' line='194' column='1' id='type-id-92'/>
-    <typedef-decl name='ssize_t' type-id='type-id-92' filepath='/usr/include/x86_64-linux-gnu/sys/types.h' line='108' column='1' id='type-id-93'/>
-    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-94' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-95'>
+    <class-decl name='gz_state' size-in-bits='1920' is-struct='yes' naming-typedef-id='type-id-91' visibility='default' filepath='src.d/gzguts.h' line='170' column='1' id='type-id-92'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='x' type-id='type-id-88' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
+        <var-decl name='x' type-id='type-id-86' visibility='default' filepath='src.d/gzguts.h' line='172' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='192'>
         <var-decl name='mode' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='177' column='1'/>
@@ -849,19 +859,19 @@
         <var-decl name='fd' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='178' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='256'>
-        <var-decl name='path' type-id='type-id-68' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
+        <var-decl name='path' type-id='type-id-53' visibility='default' filepath='src.d/gzguts.h' line='179' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='320'>
-        <var-decl name='size' type-id='type-id-3' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
+        <var-decl name='size' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='180' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='352'>
-        <var-decl name='want' type-id='type-id-3' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
+        <var-decl name='want' type-id='type-id-11' visibility='default' filepath='src.d/gzguts.h' line='181' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='384'>
-        <var-decl name='in' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
+        <var-decl name='in' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='182' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='448'>
-        <var-decl name='out' type-id='type-id-89' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
+        <var-decl name='out' type-id='type-id-87' visibility='default' filepath='src.d/gzguts.h' line='183' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='512'>
         <var-decl name='direct' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='184' column='1'/>
@@ -870,7 +880,7 @@
         <var-decl name='how' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='186' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='576'>
-        <var-decl name='start' type-id='type-id-14' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
+        <var-decl name='start' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='187' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='640'>
         <var-decl name='eof' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='188' column='1'/>
@@ -888,7 +898,7 @@
         <var-decl name='reset' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='193' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='832'>
-        <var-decl name='skip' type-id='type-id-14' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
+        <var-decl name='skip' type-id='type-id-7' visibility='default' filepath='src.d/gzguts.h' line='195' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='896'>
         <var-decl name='seek' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='196' column='1'/>
@@ -897,27 +907,30 @@
         <var-decl name='err' type-id='type-id-20' visibility='default' filepath='src.d/gzguts.h' line='198' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='960'>
-        <var-decl name='msg' type-id='type-id-68' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
+        <var-decl name='msg' type-id='type-id-53' visibility='default' filepath='src.d/gzguts.h' line='199' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='1024'>
         <var-decl name='strm' type-id='type-id-70' visibility='default' filepath='src.d/gzguts.h' line='201' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='gz_state' type-id='type-id-95' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-94'/>
-    <typedef-decl name='gz_statep' type-id='type-id-96' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-97'/>
-    <pointer-type-def type-id='type-id-94' size-in-bits='64' id='type-id-96'/>
+    <typedef-decl name='__ssize_t' type-id='type-id-1' filepath='/usr/include/x86_64-linux-gnu/bits/types.h' line='194' column='1' id='type-id-93'/>
+    <typedef-decl name='gz_state' type-id='type-id-92' filepath='src.d/gzguts.h' line='202' column='1' id='type-id-91'/>
+    <typedef-decl name='gz_statep' type-id='type-id-94' filepath='src.d/gzguts.h' line='203' column='1' id='type-id-95'/>
+    <typedef-decl name='ssize_t' type-id='type-id-93' filepath='/usr/include/x86_64-linux-gnu/sys/types.h' line='108' column='1' id='type-id-96'/>
+    <pointer-type-def type-id='type-id-91' size-in-bits='64' id='type-id-94'/>
+    <typedef-decl name='voidp' type-id='type-id-84' filepath='./zconf.h' line='416' column='1' id='type-id-97'/>
     <function-decl name='__errno_location' filepath='/usr/include/errno.h' line='37' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <return type-id='type-id-81'/>
+      <return type-id='type-id-76'/>
     </function-decl>
     <function-decl name='memchr' filepath='/usr/include/string.h' line='107' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='strerror' filepath='/usr/include/string.h' line='419' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <return type-id='type-id-68'/>
+      <return type-id='type-id-53'/>
     </function-decl>
     <function-decl name='close' filepath='/usr/include/unistd.h' line='358' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
@@ -925,139 +938,164 @@
     </function-decl>
     <function-decl name='read' filepath='/usr/include/unistd.h' line='371' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-93'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
     </function-decl>
     <function-decl name='gz_error' filepath='src.d/gzguts.h' line='206' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-97'/>
+      <parameter type-id='type-id-95'/>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-78'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-22'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='gzread' mangled-name='gzread' filepath='src.d/gzread.c' line='373' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzread'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
-      <parameter type-id='type-id-91' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='374' column='1'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='375' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzread.c' line='376' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfread' mangled-name='gzfread' filepath='src.d/gzread.c' line='409' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfread@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-91' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-97' name='buf' filepath='src.d/gzread.c' line='410' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzread.c' line='411' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzread.c' line='412' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='413' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzgetc' mangled-name='gzgetc' filepath='src.d/gzread.c' line='445' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='446' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgetc_' mangled-name='gzgetc_' filepath='src.d/gzread.c' line='472' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgetc_@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='473' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzungetc' mangled-name='gzungetc' filepath='src.d/gzread.c' line='479' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzungetc@@ZLIB_1.2.0.2'>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzread.c' line='480' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='481' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzgets' mangled-name='gzgets' filepath='src.d/gzread.c' line='539' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzgets'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
-      <parameter type-id='type-id-68' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='540' column='1'/>
+      <parameter type-id='type-id-53' name='buf' filepath='src.d/gzread.c' line='541' column='1'/>
       <parameter type-id='type-id-20' name='len' filepath='src.d/gzread.c' line='542' column='1'/>
-      <return type-id='type-id-68'/>
+      <return type-id='type-id-53'/>
     </function-decl>
     <function-decl name='gzdirect' mangled-name='gzdirect' filepath='src.d/gzread.c' line='603' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzdirect@@ZLIB_1.2.2.3'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzread.c' line='604' column='1'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflate' filepath='src.d/zlib.h' line='400' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateEnd' filepath='src.d/zlib.h' line='520' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateReset' filepath='src.d/zlib.h' line='959' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <return type-id='type-id-20'/>
+    </function-decl>
+    <function-decl name='inflateInit2_' filepath='src.d/zlib.h' line='1789' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-20'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-20'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/gzwrite.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
     <class-decl name='__va_list_tag' size-in-bits='192' is-struct='yes' visibility='default' id='type-id-98'>
       <data-member access='public' layout-offset-in-bits='0'>
-        <var-decl name='gp_offset' type-id='type-id-3' visibility='default'/>
+        <var-decl name='gp_offset' type-id='type-id-11' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='32'>
-        <var-decl name='fp_offset' type-id='type-id-3' visibility='default'/>
+        <var-decl name='fp_offset' type-id='type-id-11' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='64'>
-        <var-decl name='overflow_arg_area' type-id='type-id-44' visibility='default'/>
+        <var-decl name='overflow_arg_area' type-id='type-id-84' visibility='default'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='128'>
-        <var-decl name='reg_save_area' type-id='type-id-44' visibility='default'/>
+        <var-decl name='reg_save_area' type-id='type-id-84' visibility='default'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='voidpc' type-id='type-id-44' filepath='./zconf.h' line='414' column='1' id='type-id-99'/>
-    <pointer-type-def type-id='type-id-98' size-in-bits='64' id='type-id-100'/>
-    <function-decl name='vsnprintf' filepath='/usr/include/stdio.h' line='382' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-68'/>
-      <parameter type-id='type-id-5'/>
-      <parameter type-id='type-id-78'/>
-      <parameter type-id='type-id-100'/>
+    <pointer-type-def type-id='type-id-98' size-in-bits='64' id='type-id-99'/>
+    <typedef-decl name='voidpc' type-id='type-id-84' filepath='./zconf.h' line='414' column='1' id='type-id-100'/>
+    <function-decl name='vsnprintf' filepath='/usr/include/stdio.h' line='389' column='1' visibility='default' binding='global' size-in-bits='64'>
+      <parameter type-id='type-id-53'/>
+      <parameter type-id='type-id-10'/>
+      <parameter type-id='type-id-22'/>
+      <parameter type-id='type-id-99'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='memmove' filepath='/usr/include/string.h' line='47' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-84'/>
     </function-decl>
     <function-decl name='write' filepath='/usr/include/unistd.h' line='378' column='1' visibility='default' binding='global' size-in-bits='64'>
       <parameter type-id='type-id-20'/>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-93'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-10'/>
+      <return type-id='type-id-96'/>
     </function-decl>
     <function-decl name='gzwrite' mangled-name='gzwrite' filepath='src.d/gzwrite.c' line='255' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzwrite'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
-      <parameter type-id='type-id-99' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
-      <parameter type-id='type-id-3' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='256' column='1'/>
+      <parameter type-id='type-id-100' name='buf' filepath='src.d/gzwrite.c' line='257' column='1'/>
+      <parameter type-id='type-id-11' name='len' filepath='src.d/gzwrite.c' line='258' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzfwrite' mangled-name='gzfwrite' filepath='src.d/gzwrite.c' line='283' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzfwrite@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-99' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
-      <parameter type-id='type-id-6' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
-      <parameter type-id='type-id-6' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
-      <return type-id='type-id-6'/>
+      <parameter type-id='type-id-100' name='buf' filepath='src.d/gzwrite.c' line='284' column='1'/>
+      <parameter type-id='type-id-14' name='size' filepath='src.d/gzwrite.c' line='285' column='1'/>
+      <parameter type-id='type-id-14' name='nitems' filepath='src.d/gzwrite.c' line='286' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='287' column='1'/>
+      <return type-id='type-id-14'/>
     </function-decl>
     <function-decl name='gzputc' mangled-name='gzputc' filepath='src.d/gzwrite.c' line='313' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputc'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='314' column='1'/>
       <parameter type-id='type-id-20' name='c' filepath='src.d/gzwrite.c' line='315' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzputs' mangled-name='gzputs' filepath='src.d/gzwrite.c' line='361' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzputs'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
-      <parameter type-id='type-id-78' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='362' column='1'/>
+      <parameter type-id='type-id-22' name='s' filepath='src.d/gzwrite.c' line='363' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzvprintf' mangled-name='gzvprintf' filepath='src.d/gzwrite.c' line='391' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzvprintf@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-78' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
-      <parameter type-id='type-id-100' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='391' column='1'/>
+      <parameter type-id='type-id-99' name='va' filepath='src.d/gzwrite.c' line='391' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzprintf' mangled-name='gzprintf' filepath='src.d/gzwrite.c' line='463' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzprintf'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
-      <parameter type-id='type-id-78' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='463' column='1'/>
+      <parameter type-id='type-id-22' name='format' filepath='src.d/gzwrite.c' line='463' column='1'/>
       <parameter is-variadic='yes'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzflush' mangled-name='gzflush' filepath='src.d/gzwrite.c' line='565' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzflush'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='566' column='1'/>
       <parameter type-id='type-id-20' name='flush' filepath='src.d/gzwrite.c' line='567' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='gzsetparams' mangled-name='gzsetparams' filepath='src.d/gzwrite.c' line='597' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='gzsetparams'>
-      <parameter type-id='type-id-87' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
+      <parameter type-id='type-id-89' name='file' filepath='src.d/gzwrite.c' line='598' column='1'/>
       <parameter type-id='type-id-20' name='level' filepath='src.d/gzwrite.c' line='599' column='1'/>
       <parameter type-id='type-id-20' name='strategy' filepath='src.d/gzwrite.c' line='600' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/infback.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-101'/>
-    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-102' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-103'>
+    <enum-decl name='codetype' naming-typedef-id='type-id-101' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-102'>
+      <underlying-type type-id='type-id-103'/>
+      <enumerator name='CODES' value='0'/>
+      <enumerator name='LENS' value='1'/>
+      <enumerator name='DISTS' value='2'/>
+    </enum-decl>
+    <class-decl name='code' size-in-bits='32' is-struct='yes' naming-typedef-id='type-id-104' visibility='default' filepath='src.d/inftrees.h' line='24' column='1' id='type-id-105'>
       <data-member access='public' layout-offset-in-bits='0'>
         <var-decl name='op' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='25' column='1'/>
       </data-member>
@@ -1065,217 +1103,186 @@
         <var-decl name='bits' type-id='type-id-2' visibility='default' filepath='src.d/inftrees.h' line='26' column='1'/>
       </data-member>
       <data-member access='public' layout-offset-in-bits='16'>
-        <var-decl name='val' type-id='type-id-38' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
+        <var-decl name='val' type-id='type-id-69' visibility='default' filepath='src.d/inftrees.h' line='27' column='1'/>
       </data-member>
     </class-decl>
-    <typedef-decl name='code' type-id='type-id-103' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-102'/>
-    <enum-decl name='codetype' naming-typedef-id='type-id-104' filepath='src.d/inftrees.h' line='54' column='1' id='type-id-105'>
-      <underlying-type type-id='type-id-101'/>
-      <enumerator name='CODES' value='0'/>
-      <enumerator name='LENS' value='1'/>
-      <enumerator name='DISTS' value='2'/>
-    </enum-decl>
-    <typedef-decl name='codetype' type-id='type-id-105' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-104'/>
+    <typedef-decl name='code' type-id='type-id-105' filepath='src.d/inftrees.h' line='28' column='1' id='type-id-104'/>
+    <typedef-decl name='codetype' type-id='type-id-102' filepath='src.d/inftrees.h' line='58' column='1' id='type-id-101'/>
     <typedef-decl name='in_func' type-id='type-id-106' filepath='src.d/zlib.h' line='1094' column='1' id='type-id-107'/>
     <typedef-decl name='out_func' type-id='type-id-108' filepath='src.d/zlib.h' line='1096' column='1' id='type-id-109'/>
-    <pointer-type-def type-id='type-id-102' size-in-bits='64' id='type-id-110'/>
+    <type-decl name='unnamed-enum-underlying-type-32' is-anonymous='yes' size-in-bits='32' alignment-in-bits='32' id='type-id-103'/>
+    <pointer-type-def type-id='type-id-104' size-in-bits='64' id='type-id-110'/>
     <pointer-type-def type-id='type-id-110' size-in-bits='64' id='type-id-111'/>
     <pointer-type-def type-id='type-id-112' size-in-bits='64' id='type-id-108'/>
-    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-89'/>
-    <pointer-type-def type-id='type-id-89' size-in-bits='64' id='type-id-113'/>
+    <pointer-type-def type-id='type-id-2' size-in-bits='64' id='type-id-87'/>
+    <pointer-type-def type-id='type-id-87' size-in-bits='64' id='type-id-113'/>
     <pointer-type-def type-id='type-id-114' size-in-bits='64' id='type-id-106'/>
-    <pointer-type-def type-id='type-id-38' size-in-bits='64' id='type-id-115'/>
+    <pointer-type-def type-id='type-id-69' size-in-bits='64' id='type-id-115'/>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-116'/>
     <function-decl name='inflateBackInit_' mangled-name='inflateBackInit_' filepath='src.d/infback.c' line='28' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackInit_@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='29' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/infback.c' line='30' column='1'/>
-      <parameter type-id='type-id-89' name='window' filepath='src.d/infback.c' line='31' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/infback.c' line='32' column='1'/>
+      <parameter type-id='type-id-87' name='window' filepath='src.d/infback.c' line='31' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/infback.c' line='32' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/infback.c' line='33' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBack' mangled-name='inflateBack' filepath='src.d/infback.c' line='251' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBack@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='252' column='1'/>
       <parameter type-id='type-id-107' name='in' filepath='src.d/infback.c' line='253' column='1'/>
-      <parameter type-id='type-id-44' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
+      <parameter type-id='type-id-84' name='in_desc' filepath='src.d/infback.c' line='254' column='1'/>
       <parameter type-id='type-id-109' name='out' filepath='src.d/infback.c' line='255' column='1'/>
-      <parameter type-id='type-id-44' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
+      <parameter type-id='type-id-84' name='out_desc' filepath='src.d/infback.c' line='256' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateBackEnd' mangled-name='inflateBackEnd' filepath='src.d/infback.c' line='635' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateBackEnd@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/infback.c' line='636' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflate_fast' filepath='src.d/inffast.h' line='11' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-57'/>
-      <parameter type-id='type-id-3'/>
-      <return type-id='type-id-42'/>
+      <parameter type-id='type-id-21'/>
+      <parameter type-id='type-id-11'/>
+      <return type-id='type-id-85'/>
     </function-decl>
     <function-decl name='inflate_table' filepath='src.d/inftrees.h' line='60' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-104'/>
+      <parameter type-id='type-id-101'/>
       <parameter type-id='type-id-115'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-11'/>
       <parameter type-id='type-id-111'/>
-      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-79'/>
       <parameter type-id='type-id-115'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-type size-in-bits='64' id='type-id-112'>
-      <parameter type-id='type-id-44'/>
-      <parameter type-id='type-id-89'/>
-      <parameter type-id='type-id-3'/>
+      <parameter type-id='type-id-84'/>
+      <parameter type-id='type-id-87'/>
+      <parameter type-id='type-id-11'/>
       <return type-id='type-id-20'/>
     </function-type>
     <function-type size-in-bits='64' id='type-id-114'>
-      <parameter type-id='type-id-44'/>
+      <parameter type-id='type-id-84'/>
       <parameter type-id='type-id-113'/>
-      <return type-id='type-id-3'/>
+      <return type-id='type-id-11'/>
     </function-type>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/inflate.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
+    <typedef-decl name='voidpf' type-id='type-id-84' filepath='./zconf.h' line='415' column='1' id='type-id-117'/>
     <function-decl name='inflateResetKeep' mangled-name='inflateResetKeep' filepath='src.d/inflate.c' line='119' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateResetKeep@@ZLIB_1.2.5.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateReset' mangled-name='inflateReset' filepath='src.d/inflate.c' line='145' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='146' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='120' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateReset2' mangled-name='inflateReset2' filepath='src.d/inflate.c' line='158' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateReset2@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='159' column='1'/>
       <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='160' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflateInit2_' mangled-name='inflateInit2_' filepath='src.d/inflate.c' line='198' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit2_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='199' column='1'/>
-      <parameter type-id='type-id-20' name='windowBits' filepath='src.d/inflate.c' line='200' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/inflate.c' line='201' column='1'/>
-      <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='202' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateInit_' mangled-name='inflateInit_' filepath='src.d/inflate.c' line='242' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateInit_'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
-      <parameter type-id='type-id-78' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='243' column='1'/>
+      <parameter type-id='type-id-22' name='version' filepath='src.d/inflate.c' line='244' column='1'/>
       <parameter type-id='type-id-20' name='stream_size' filepath='src.d/inflate.c' line='245' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflatePrime' mangled-name='inflatePrime' filepath='src.d/inflate.c' line='250' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflatePrime@@ZLIB_1.2.2.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='251' column='1'/>
       <parameter type-id='type-id-20' name='bits' filepath='src.d/inflate.c' line='252' column='1'/>
       <parameter type-id='type-id-20' name='value' filepath='src.d/inflate.c' line='253' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
-    <function-decl name='inflate' mangled-name='inflate' filepath='src.d/inflate.c' line='625' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflate'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='626' column='1'/>
-      <parameter type-id='type-id-20' name='flush' filepath='src.d/inflate.c' line='627' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
-    <function-decl name='inflateEnd' mangled-name='inflateEnd' filepath='src.d/inflate.c' line='1304' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateEnd'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1305' column='1'/>
-      <return type-id='type-id-20'/>
-    </function-decl>
     <function-decl name='inflateGetDictionary' mangled-name='inflateGetDictionary' filepath='src.d/inflate.c' line='1318' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetDictionary@@ZLIB_1.2.7.1'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1319' column='1'/>
       <parameter type-id='type-id-19' name='dictionary' filepath='src.d/inflate.c' line='1320' column='1'/>
-      <parameter type-id='type-id-83' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
+      <parameter type-id='type-id-78' name='dictLength' filepath='src.d/inflate.c' line='1321' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSetDictionary' mangled-name='inflateSetDictionary' filepath='src.d/inflate.c' line='1341' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSetDictionary'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1342' column='1'/>
       <parameter type-id='type-id-16' name='dictionary' filepath='src.d/inflate.c' line='1343' column='1'/>
-      <parameter type-id='type-id-8' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
+      <parameter type-id='type-id-12' name='dictLength' filepath='src.d/inflate.c' line='1344' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateGetHeader' mangled-name='inflateGetHeader' filepath='src.d/inflate.c' line='1376' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateGetHeader@@ZLIB_1.2.2'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
-      <parameter type-id='type-id-59' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1377' column='1'/>
+      <parameter type-id='type-id-42' name='head' filepath='src.d/inflate.c' line='1378' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSync' mangled-name='inflateSync' filepath='src.d/inflate.c' line='1427' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSync'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1428' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateSyncPoint' mangled-name='inflateSyncPoint' filepath='src.d/inflate.c' line='1485' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateSyncPoint'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1486' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateCopy' mangled-name='inflateCopy' filepath='src.d/inflate.c' line='1495' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCopy@@ZLIB_1.2.0'>
-      <parameter type-id='type-id-57' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
-      <parameter type-id='type-id-57' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
+      <parameter type-id='type-id-21' name='dest' filepath='src.d/inflate.c' line='1496' column='1'/>
+      <parameter type-id='type-id-21' name='source' filepath='src.d/inflate.c' line='1497' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateUndermine' mangled-name='inflateUndermine' filepath='src.d/inflate.c' line='1542' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateUndermine@@ZLIB_1.2.3.3'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1543' column='1'/>
       <parameter type-id='type-id-20' name='subvert' filepath='src.d/inflate.c' line='1544' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateValidate' mangled-name='inflateValidate' filepath='src.d/inflate.c' line='1560' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateValidate@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1561' column='1'/>
       <parameter type-id='type-id-20' name='check' filepath='src.d/inflate.c' line='1562' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='inflateMark' mangled-name='inflateMark' filepath='src.d/inflate.c' line='1575' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateMark@@ZLIB_1.2.3.4'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1576' column='1'/>
       <return type-id='type-id-1'/>
     </function-decl>
     <function-decl name='inflateCodesUsed' mangled-name='inflateCodesUsed' filepath='src.d/inflate.c' line='1588' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='inflateCodesUsed@@ZLIB_1.2.9'>
-      <parameter type-id='type-id-57' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
-      <return type-id='type-id-4'/>
+      <parameter type-id='type-id-21' name='strm' filepath='src.d/inflate.c' line='1589' column='1'/>
+      <return type-id='type-id-9'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/trees.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='2048' id='type-id-117'>
-      <subrange length='256' type-id='type-id-4' id='type-id-118'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='2048' id='type-id-119'>
+      <subrange length='256' lower-bound='0' upper-bound='255' type-id='type-id-9' id='type-id-120'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='4096' id='type-id-119'>
-      <subrange length='512' type-id='type-id-4' id='type-id-120'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='4096' id='type-id-121'>
+      <subrange length='512' lower-bound='0' upper-bound='511' type-id='type-id-9' id='type-id-122'/>
     </array-type-def>
-    <array-type-def dimensions='1' type-id='type-id-116' size-in-bits='infinite' id='type-id-121'>
-      <subrange length='infinite' id='type-id-122'/>
+    <array-type-def dimensions='1' type-id='type-id-118' size-in-bits='unknown' id='type-id-123'>
+      <subrange length='unknown' lower-bound='0' upper-bound='0' id='type-id-124'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-36' const='yes' id='type-id-116'/>
-    <var-decl name='_length_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
+    <qualified-type-def type-id='type-id-67' const='yes' id='type-id-118'/>
+    <var-decl name='_length_code' type-id='type-id-119' visibility='default' filepath='src.d/deflate.h' line='317' column='1'/>
     <var-decl name='_dist_code' type-id='type-id-121' visibility='default' filepath='src.d/deflate.h' line='318' column='1'/>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/uncompr.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <pointer-type-def type-id='type-id-9' size-in-bits='64' id='type-id-123'/>
+    <pointer-type-def type-id='type-id-13' size-in-bits='64' id='type-id-125'/>
     <function-decl name='uncompress2' mangled-name='uncompress2' filepath='src.d/uncompr.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress2@@ZLIB_1.2.9'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='28' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='29' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='30' column='1'/>
-      <parameter type-id='type-id-123' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
+      <parameter type-id='type-id-125' name='sourceLen' filepath='src.d/uncompr.c' line='31' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
     <function-decl name='uncompress' mangled-name='uncompress' filepath='src.d/uncompr.c' line='86' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='uncompress'>
       <parameter type-id='type-id-19' name='dest' filepath='src.d/uncompr.c' line='87' column='1'/>
       <parameter type-id='type-id-18' name='destLen' filepath='src.d/uncompr.c' line='88' column='1'/>
       <parameter type-id='type-id-16' name='source' filepath='src.d/uncompr.c' line='89' column='1'/>
-      <parameter type-id='type-id-9' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
+      <parameter type-id='type-id-13' name='sourceLen' filepath='src.d/uncompr.c' line='90' column='1'/>
       <return type-id='type-id-20'/>
     </function-decl>
   </abi-instr>
   <abi-instr address-size='64' path='src.d/zutil.c' comp-dir-path='/mnt/c/build/git/zlib-ng/btmp1' language='LANG_C11'>
-    <array-type-def dimensions='1' type-id='type-id-124' size-in-bits='640' id='type-id-125'>
-      <subrange length='10' type-id='type-id-4' id='type-id-126'/>
+    <array-type-def dimensions='1' type-id='type-id-126' size-in-bits='640' id='type-id-127'>
+      <subrange length='10' lower-bound='0' upper-bound='9' type-id='type-id-9' id='type-id-128'/>
     </array-type-def>
-    <qualified-type-def type-id='type-id-68' const='yes' id='type-id-124'/>
-    <function-decl name='malloc' filepath='/usr/include/stdlib.h' line='540' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-5'/>
-      <return type-id='type-id-44'/>
-    </function-decl>
-    <function-decl name='free' filepath='/usr/include/stdlib.h' line='555' column='1' visibility='default' binding='global' size-in-bits='64'>
-      <parameter type-id='type-id-44'/>
-      <return type-id='type-id-42'/>
-    </function-decl>
+    <qualified-type-def type-id='type-id-53' const='yes' id='type-id-126'/>
     <function-decl name='zlibVersion' mangled-name='zlibVersion' filepath='src.d/zutil.c' line='27' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibVersion'>
-      <return type-id='type-id-78'/>
+      <return type-id='type-id-22'/>
     </function-decl>
     <function-decl name='zlibCompileFlags' mangled-name='zlibCompileFlags' filepath='src.d/zutil.c' line='32' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zlibCompileFlags@@ZLIB_1.2.0.2'>
-      <return type-id='type-id-9'/>
+      <return type-id='type-id-13'/>
     </function-decl>
     <function-decl name='zError' mangled-name='zError' filepath='src.d/zutil.c' line='135' column='1' visibility='default' binding='global' size-in-bits='64' elf-symbol-id='zError'>
       <parameter type-id='type-id-20' name='err' filepath='src.d/zutil.c' line='136' column='1'/>
-      <return type-id='type-id-78'/>
+      <return type-id='type-id-22'/>
     </function-decl>
-    <var-decl name='z_errmsg' type-id='type-id-125' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
+    <var-decl name='z_errmsg' type-id='type-id-127' visibility='default' filepath='src.d/zutil.h' line='56' column='1'/>
   </abi-instr>
 </abi-corpus>
diff --git a/test/add-subdirectory-project/CMakeLists.txt b/test/add-subdirectory-project/CMakeLists.txt
index 1b87005f..a8da4521 100644
--- a/test/add-subdirectory-project/CMakeLists.txt
+++ b/test/add-subdirectory-project/CMakeLists.txt
@@ -1,13 +1,13 @@
-cmake_minimum_required(VERSION 3.5.1)
+cmake_minimum_required(VERSION 3.14...4.2.1)
 
 project(zlib-ng-add-subdirecory-test C)
 
 include(CTest)
 
 set(BUILD_SHARED_LIBS OFF)
-set(ZLIB_ENABLE_TESTS ON CACHE BOOL "Build test binaries" FORCE)
+set(BUILD_TESTING ON CACHE BOOL "Build test binaries" FORCE)
 
 add_subdirectory(../.. zlib-ng)
 
 add_executable(app main.c)
-target_link_libraries(app zlibstatic)
+target_link_libraries(app zlib-ng-static)
diff --git a/test/benchmarks/CMakeLists.txt b/test/benchmarks/CMakeLists.txt
index 0f812498..62585da7 100644
--- a/test/benchmarks/CMakeLists.txt
+++ b/test/benchmarks/CMakeLists.txt
@@ -1,12 +1,16 @@
-cmake_minimum_required(VERSION 3.12)
+cmake_minimum_required(VERSION 3.14...4.2.1)
 
 include(FetchContent)
 
-set(CMAKE_CXX_STANDARD 11)
-set(CMAKE_CXX_STANDARD_REQUIRED ON)
-set(CMAKE_CXX_EXTENSIONS ON)
-
-enable_language(CXX)
+if(NOT DEFINED CMAKE_CXX_STANDARD)
+    set(CMAKE_CXX_STANDARD 11)
+endif()
+if(NOT DEFINED CMAKE_CXX_STANDARD_REQUIRED)
+    set(CMAKE_CXX_STANDARD_REQUIRED ON)
+endif()
+if(NOT DEFINED CMAKE_CXX_EXTENSIONS)
+    set(CMAKE_CXX_EXTENSIONS ON)
+endif()
 
 # Search for Google benchmark package
 find_package(benchmark QUIET)
@@ -19,18 +23,15 @@ if(NOT benchmark_FOUND)
         set(GBENCHMARK_REPOSITORY https://github.com/google/benchmark.git)
     endif()
     if(NOT DEFINED GBENCHMARK_TAG)
-        set(GBENCHMARK_TAG v1.7.1)
+        set(GBENCHMARK_TAG v1.9.4)
     endif()
 
     FetchContent_Declare(benchmark
         GIT_REPOSITORY ${GBENCHMARK_REPOSITORY}
-        GIT_TAG ${GBENCHMARK_TAG})
+        GIT_TAG ${GBENCHMARK_TAG}
+        ${ZNG_FetchContent_Declare_EXCLUDE_FROM_ALL})
 
-    FetchContent_GetProperties(benchmark)
-    if(NOT benchmark_POPULATED)
-        FetchContent_Populate(benchmark)
-        add_subdirectory(${benchmark_SOURCE_DIR} ${benchmark_BINARY_DIR} EXCLUDE_FROM_ALL)
-    endif()
+    ZNG_FetchContent_MakeAvailable(benchmark)
 endif()
 
 add_executable(benchmark_zlib
@@ -40,8 +41,12 @@ add_executable(benchmark_zlib
     benchmark_compare256_rle.cc
     benchmark_compress.cc
     benchmark_crc32.cc
+    benchmark_crc32_copy.cc
+    benchmark_insert_string.cc
+    benchmark_inflate.cc
     benchmark_main.cc
     benchmark_slidehash.cc
+    benchmark_uncompress.cc
     )
 
 target_compile_definitions(benchmark_zlib PRIVATE -DBENCHMARK_STATIC_DEFINE)
@@ -50,13 +55,13 @@ target_include_directories(benchmark_zlib PRIVATE
     ${PROJECT_BINARY_DIR}
     ${benchmark_SOURCE_DIR}/benchmark/include)
 
-target_link_libraries(benchmark_zlib zlibstatic benchmark::benchmark)
+target_link_libraries(benchmark_zlib zlib-ng-static benchmark::benchmark)
 if(WIN32)
     target_link_libraries(benchmark_zlib shlwapi)
 endif()
 
 add_test(NAME benchmark_zlib
-    COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:benchmark_zlib>)
+    COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:benchmark_zlib> "--benchmark_min_time=0")
 
 if(WITH_BENCHMARK_APPS)
     option(BUILD_ALT_BENCH "Link against alternative zlib implementation" OFF)
@@ -66,14 +71,11 @@ if(WITH_BENCHMARK_APPS)
 
     if(NOT PNG_FOUND)
         FetchContent_Declare(PNG
-            GIT_REPOSITORY https://github.com/glennrp/libpng.git)
-
-        FetchContent_GetProperties(PNG)
-        if(NOT PNG_POPULATED)
-            FetchContent_Populate(PNG)
-            set(PNG_INCLUDE_DIR ${png_SOURCE_DIR})
-            add_subdirectory(${png_SOURCE_DIR} ${png_BINARY_DIR})
-        endif()
+            GIT_REPOSITORY https://github.com/glennrp/libpng.git
+            ${ZNG_FetchContent_Declare_EXCLUDE_FROM_ALL})
+
+        ZNG_FetchContent_MakeAvailable(PNG)
+        set(PNG_INCLUDE_DIR ${png_SOURCE_DIR})
     endif()
 
     set(BENCH_APP_SRCS
@@ -105,5 +107,5 @@ if(WITH_BENCHMARK_APPS)
     # We need the static png library if we're statically linking to zlib,
     # otherwise it will resolve these things in the system provided dynamic
     # libraries (likely linked to stock zlib)
-    target_link_libraries(benchmark_zlib_apps libpng.a zlibstatic benchmark::benchmark)
+    target_link_libraries(benchmark_zlib_apps libpng.a zlib-ng-static benchmark::benchmark)
 endif()
diff --git a/test/benchmarks/benchmark_adler32.cc b/test/benchmarks/benchmark_adler32.cc
index b1278950..8fb21300 100644
--- a/test/benchmarks/benchmark_adler32.cc
+++ b/test/benchmarks/benchmark_adler32.cc
@@ -3,65 +3,79 @@
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 
-#include <stdio.h>
-#include <assert.h>
-
 #include <benchmark/benchmark.h>
 
 extern "C" {
 #  include "zbuild.h"
-#  include "zutil_p.h"
 #  include "arch_functions.h"
 #  include "../test_cpu_features.h"
 }
 
-#define MAX_RANDOM_INTS (1024 * 1024)
-#define MAX_RANDOM_INTS_SIZE (MAX_RANDOM_INTS * sizeof(uint32_t))
+#define BUFSIZE ((4 * 1024 * 1024) + 64)
 
 class adler32: public benchmark::Fixture {
 private:
-    uint32_t *random_ints;
+    uint32_t *testdata;
 
 public:
-    void SetUp(const ::benchmark::State& state) {
-        /* Control the alignment so that we have the best case scenario for loads. With
-         * AVX512, unaligned loads can mean we're crossing a cacheline boundary at every load.
-         * And while this is a realistic scenario, it makes it difficult to compare benchmark
-         * to benchmark because one allocation could have been aligned perfectly for the loads
-         * while the subsequent one happened to not be. This is not to be advantageous to AVX512
-         * (indeed, all lesser SIMD implementations benefit from this aligned allocation), but to
-         * control the _consistency_ of the results */
-        random_ints = (uint32_t *)zng_alloc(MAX_RANDOM_INTS_SIZE);
-        assert(random_ints != NULL);
-
-        for (int32_t i = 0; i < MAX_RANDOM_INTS; i++) {
-            random_ints[i] = rand();
+    void SetUp(::benchmark::State& state) {
+        testdata = (uint32_t *)zng_alloc_aligned(BUFSIZE, 64);
+        if (testdata == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
+
+        for (uint32_t i = 0; i < BUFSIZE/sizeof(uint32_t); i++) {
+            testdata[i] = rand();
         }
     }
 
-    void Bench(benchmark::State& state, adler32_func adler32) {
+    // Benchmark Adler32, with rolling buffer misalignment for consistent results
+    void Bench(benchmark::State& state, adler32_func adler32, const int DO_ALIGNED) {
+        int misalign = 0;
         uint32_t hash = 0;
 
         for (auto _ : state) {
-            hash = adler32(hash, (const unsigned char *)random_ints, (size_t)state.range(0));
+            hash = adler32(hash, (const unsigned char*)testdata + misalign, (size_t)state.range(0));
+            if (misalign >= 63)
+                misalign = 0;
+            else
+                misalign += (DO_ALIGNED) ? 16 : 1;
         }
 
+        // Prevent the result from being optimized away
         benchmark::DoNotOptimize(hash);
     }
 
-    void TearDown(const ::benchmark::State& state) {
-        zng_free(random_ints);
+    void TearDown(const ::benchmark::State&) {
+        zng_free_aligned(testdata);
     }
 };
 
-#define BENCHMARK_ADLER32(name, fptr, support_flag) \
+#define BENCHMARK_ADLER32_MISALIGNED(name, hashfunc, support_flag) \
     BENCHMARK_DEFINE_F(adler32, name)(benchmark::State& state) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             state.SkipWithError("CPU does not support " #name); \
         } \
-        Bench(state, fptr); \
+        Bench(state, hashfunc, 0); \
     } \
-    BENCHMARK_REGISTER_F(adler32, name)->Arg(1)->Arg(8)->Arg(12)->Arg(16)->Arg(32)->Arg(64)->Arg(512)->Arg(4<<10)->Arg(32<<10)->Arg(256<<10)->Arg(4096<<10)
+    BENCHMARK_REGISTER_F(adler32, name)->Arg(1)->Arg(8)->Arg(12)->Arg(16)->Arg(32)->Arg(64)->Arg(512)->Arg(4<<10)->Arg(32<<10)->Arg(256<<10)->Arg(4096<<10);
+
+// Aligned
+#define ALIGNED_NAME(name) name##_aligned
+#define BENCHMARK_ADLER32_ALIGNED(name, hashfunc, support_flag) \
+    BENCHMARK_DEFINE_F(adler32, ALIGNED_NAME(name))(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("CPU does not support " #name); \
+        } \
+        Bench(state, hashfunc, 1); \
+    } \
+    BENCHMARK_REGISTER_F(adler32, ALIGNED_NAME(name))->Arg(8)->Arg(12)->Arg(16)->Arg(32)->Arg(64)->Arg(512)->Arg(4<<10)->Arg(32<<10)->Arg(256<<10)->Arg(4096<<10);
+
+// Queue both misaligned and aligned for each benchmark
+#define BENCHMARK_ADLER32(name, hashfunc, support_flag) \
+    BENCHMARK_ADLER32_MISALIGNED(name, hashfunc, support_flag); \
+    BENCHMARK_ADLER32_ALIGNED(name, hashfunc, support_flag);
 
 BENCHMARK_ADLER32(c, adler32_c, 1);
 
@@ -97,4 +111,11 @@ BENCHMARK_ADLER32(avx512, adler32_avx512, test_cpu_features.x86.has_avx512_commo
 BENCHMARK_ADLER32(avx512_vnni, adler32_avx512_vnni, test_cpu_features.x86.has_avx512vnni);
 #endif
 
+#ifdef LOONGARCH_LSX
+BENCHMARK_ADLER32(lsx, adler32_lsx, test_cpu_features.loongarch.has_lsx);
+#endif
+#ifdef LOONGARCH_LASX
+BENCHMARK_ADLER32(lasx, adler32_lasx, test_cpu_features.loongarch.has_lasx);
+#endif
+
 #endif
diff --git a/test/benchmarks/benchmark_adler32_copy.cc b/test/benchmarks/benchmark_adler32_copy.cc
index 50e6333c..9d2994f4 100644
--- a/test/benchmarks/benchmark_adler32_copy.cc
+++ b/test/benchmarks/benchmark_adler32_copy.cc
@@ -3,128 +3,174 @@
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 
-#include <stdio.h>
-#include <assert.h>
-#include <string.h>
-
 #include <benchmark/benchmark.h>
 
 extern "C" {
 #  include "zbuild.h"
-#  include "zutil_p.h"
 #  include "arch_functions.h"
 #  include "../test_cpu_features.h"
 }
 
-#define MAX_RANDOM_INTS (1024 * 1024)
-#define MAX_RANDOM_INTS_SIZE (MAX_RANDOM_INTS * sizeof(uint32_t))
-
-typedef uint32_t (*adler32_cpy_func)(uint32_t adler, unsigned char *dst, const uint8_t *buf, size_t len);
+// Hash copy functions are used on strm->next_in buffers, we process
+// 512-32k sizes (x2 for initial fill) at a time if enough data is available.
+#define BUFSIZE (65536 + 64)
 
 class adler32_copy: public benchmark::Fixture {
 private:
-    uint32_t *random_ints_src;
-    uint32_t *random_ints_dst;
+    uint32_t *testdata;
+    uint8_t *dstbuf;
 
 public:
-    void SetUp(const ::benchmark::State& state) {
-        /* Control the alignment so that we have the best case scenario for loads. With
-         * AVX512, unaligned loads can mean we're crossing a cacheline boundary at every load.
-         * And while this is a realistic scenario, it makes it difficult to compare benchmark
-         * to benchmark because one allocation could have been aligned perfectly for the loads
-         * while the subsequent one happened to not be. This is not to be advantageous to AVX512
-         * (indeed, all lesser SIMD implementations benefit from this aligned allocation), but to
-         * control the _consistency_ of the results */
-        random_ints_src = (uint32_t *)zng_alloc(MAX_RANDOM_INTS_SIZE);
-        random_ints_dst = (uint32_t *)zng_alloc(MAX_RANDOM_INTS_SIZE);
-        assert(random_ints_src != NULL);
-        assert(random_ints_dst != NULL);
-
-        for (int32_t i = 0; i < MAX_RANDOM_INTS; i++) {
-            random_ints_src[i] = rand();
+    void SetUp(::benchmark::State& state) {
+        testdata = (uint32_t *)zng_alloc_aligned(BUFSIZE, 64);
+        dstbuf = (uint8_t *)zng_alloc_aligned(BUFSIZE, 64);
+        if (testdata == NULL || dstbuf == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
+
+        for (uint32_t i = 0; i < BUFSIZE/sizeof(uint32_t); i++) {
+            testdata[i] = rand();
         }
     }
 
-    void Bench(benchmark::State& state, adler32_cpy_func adler32_func) {
+    // Benchmark Adler32_copy, with rolling buffer misalignment for consistent results
+    void Bench(benchmark::State& state, adler32_copy_func adler32_copy, const int DO_ALIGNED) {
+        int misalign = 0;
         uint32_t hash = 0;
 
         for (auto _ : state) {
-            hash = adler32_func(hash, (unsigned char *)random_ints_dst,
-                                (const unsigned char*)random_ints_src, (size_t)state.range(0));
+            hash = adler32_copy(hash, dstbuf + misalign, (const unsigned char*)testdata + misalign, (size_t)state.range(0));
+            if (misalign >= 63)
+                misalign = 0;
+            else
+                misalign += (DO_ALIGNED) ? 16 : 1;
         }
 
+        // Prevent the result from being optimized away
         benchmark::DoNotOptimize(hash);
     }
 
-    void TearDown(const ::benchmark::State& state) {
-        zng_free(random_ints_src);
-        zng_free(random_ints_dst);
+    void TearDown(const ::benchmark::State&) {
+        zng_free_aligned(testdata);
+        zng_free_aligned(dstbuf);
     }
 };
 
-#define BENCHMARK_ADLER32_COPY(name, fptr, support_flag) \
+// Misaligned
+#define BENCHMARK_ADLER32_COPY_MISALIGNED(name, copyfunc, support_flag) \
     BENCHMARK_DEFINE_F(adler32_copy, name)(benchmark::State& state) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             state.SkipWithError("CPU does not support " #name); \
         } \
-        Bench(state, fptr); \
+        Bench(state, copyfunc, 0); \
     } \
-    BENCHMARK_REGISTER_F(adler32_copy, name)->Range(8192, MAX_RANDOM_INTS_SIZE);
+    BENCHMARK_REGISTER_F(adler32_copy, name)->Arg(32)->Arg(512)->Arg(8<<10)->Arg(32<<10)->Arg(64<<10);
 
-#define BENCHMARK_ADLER32_BASELINE_COPY(name, fptr, support_flag) \
-    BENCHMARK_DEFINE_F(adler32_copy, name)(benchmark::State& state) { \
-        if (!support_flag) { \
+// Aligned
+#define ALIGNED_NAME(name) name##_aligned
+#define BENCHMARK_ADLER32_COPY_ALIGNED(name, copyfunc, support_flag) \
+    BENCHMARK_DEFINE_F(adler32_copy, ALIGNED_NAME(name))(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("CPU does not support " #name); \
+        } \
+        Bench(state, copyfunc, 1); \
+    } \
+    BENCHMARK_REGISTER_F(adler32_copy, ALIGNED_NAME(name))->Arg(32)->Arg(512)->Arg(8<<10)->Arg(32<<10)->Arg(64<<10);
+
+
+// Adler32 + memcpy benchmarks for reference
+#ifdef HASH_BASELINE
+#define MEMCPY_NAME(name) name##_memcpy
+#define BENCHMARK_ADLER32_MEMCPY_MISALIGNED(name, hashfunc, support_flag) \
+    BENCHMARK_DEFINE_F(adler32_copy, MEMCPY_NAME(name))(benchmark::State& state) { \
+        if (!(support_flag)) { \
             state.SkipWithError("CPU does not support " #name); \
         } \
         Bench(state, [](uint32_t init_sum, unsigned char *dst, \
                         const uint8_t *buf, size_t len) -> uint32_t { \
             memcpy(dst, buf, (size_t)len); \
-            return fptr(init_sum, buf, len); \
-        }); \
+            return hashfunc(init_sum, buf, len); \
+        }, 0); \
     } \
-    BENCHMARK_REGISTER_F(adler32_copy, name)->Range(8192, MAX_RANDOM_INTS_SIZE);
+    BENCHMARK_REGISTER_F(adler32_copy, MEMCPY_NAME(name))->Arg(32)->Arg(512)->Arg(8<<10)->Arg(32<<10)->Arg(64<<10);
+
+#define MEMCPY_ALIGNED_NAME(name) name##_memcpy_aligned
+#define BENCHMARK_ADLER32_MEMCPY_ALIGNED(name, hashfunc, support_flag) \
+    BENCHMARK_DEFINE_F(adler32_copy, MEMCPY_ALIGNED_NAME(name))(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("CPU does not support " #name); \
+        } \
+        Bench(state, [](uint32_t init_sum, unsigned char *dst, \
+                        const uint8_t *buf, size_t len) -> uint32_t { \
+            memcpy(dst, buf, (size_t)len); \
+            return hashfunc(init_sum, buf, len); \
+        }, 1); \
+    } \
+    BENCHMARK_REGISTER_F(adler32_copy, MEMCPY_ALIGNED_NAME(name))->Arg(32)->Arg(512)->Arg(8<<10)->Arg(32<<10)->Arg(64<<10);
+#endif
 
-BENCHMARK_ADLER32_BASELINE_COPY(c, adler32_c, 1);
+
+// Queue both misaligned and aligned for each benchmark
+#define BENCHMARK_ADLER32_COPY_ONLY(name, copyfunc, support_flag) \
+    BENCHMARK_ADLER32_COPY_MISALIGNED(name, copyfunc, support_flag); \
+    BENCHMARK_ADLER32_COPY_ALIGNED(name, copyfunc, support_flag);
+
+// Optionally also benchmark using memcpy with normal hash function for baseline
+#ifdef HASH_BASELINE
+#define BENCHMARK_ADLER32_COPY(name, hashfunc, copyfunc, support_flag) \
+    BENCHMARK_ADLER32_COPY_MISALIGNED(name, copyfunc, support_flag); \
+    BENCHMARK_ADLER32_COPY_ALIGNED(name, copyfunc, support_flag); \
+    BENCHMARK_ADLER32_MEMCPY_MISALIGNED(name, copyfunc, support_flag); \
+    BENCHMARK_ADLER32_MEMCPY_ALIGNED(name, copyfunc, support_flag);
+#else
+#define BENCHMARK_ADLER32_COPY(name, hashfunc, copyfunc, support_flag) \
+    BENCHMARK_ADLER32_COPY_ONLY(name, copyfunc, support_flag)
+#endif
+
+BENCHMARK_ADLER32_COPY(c, adler32_c, adler32_copy_c, 1);
 
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
-BENCHMARK_ADLER32_BASELINE_COPY(native, native_adler32, 1);
+BENCHMARK_ADLER32_COPY(native, native_adler32, native_adler32_copy, 1);
 #else
 
 #ifdef ARM_NEON
-/* If we inline this copy for neon, the function would go here */
-//BENCHMARK_ADLER32_COPY(neon, adler32_neon, test_cpu_features.arm.has_neon);
-BENCHMARK_ADLER32_BASELINE_COPY(neon_copy_baseline, adler32_neon, test_cpu_features.arm.has_neon);
+BENCHMARK_ADLER32_COPY(neon, adler32_neon, adler32_copy_neon, test_cpu_features.arm.has_neon);
 #endif
 
 #ifdef PPC_VMX
-//BENCHMARK_ADLER32_COPY(vmx_inline_copy, adler32_fold_copy_vmx, test_cpu_features.power.has_altivec);
-BENCHMARK_ADLER32_BASELINE_COPY(vmx_copy_baseline, adler32_vmx, test_cpu_features.power.has_altivec);
+BENCHMARK_ADLER32_COPY(vmx, adler32_vmx, adler32_copy_vmx, test_cpu_features.power.has_altivec);
 #endif
 #ifdef POWER8_VSX
-//BENCHMARK_ADLER32_COPY(power8_inline_copy, adler32_fold_copy_power8, test_cpu_features.power.has_arch_2_07);
-BENCHMARK_ADLER32_BASELINE_COPY(power8, adler32_power8, test_cpu_features.power.has_arch_2_07);
+BENCHMARK_ADLER32_COPY(power8, adler32_power8, adler32_copy_power8, test_cpu_features.power.has_arch_2_07);
 #endif
 
 #ifdef RISCV_RVV
-//BENCHMARK_ADLER32_COPY(rvv, adler32_rvv, test_cpu_features.riscv.has_rvv);
-BENCHMARK_ADLER32_BASELINE_COPY(rvv, adler32_rvv, test_cpu_features.riscv.has_rvv);
+BENCHMARK_ADLER32_COPY(rvv, adler32_rvv, adler32_copy_rvv, test_cpu_features.riscv.has_rvv);
 #endif
 
+#ifdef X86_SSSE3
+BENCHMARK_ADLER32_COPY(ssse3, adler32_ssse3, adler32_copy_ssse3, test_cpu_features.x86.has_ssse3);
+#endif
 #ifdef X86_SSE42
-BENCHMARK_ADLER32_BASELINE_COPY(sse42_baseline, adler32_ssse3, test_cpu_features.x86.has_ssse3);
-BENCHMARK_ADLER32_COPY(sse42, adler32_fold_copy_sse42, test_cpu_features.x86.has_sse42);
+// There is no adler32_sse42, so only test the copy variant
+BENCHMARK_ADLER32_COPY_ONLY(sse42, adler32_copy_sse42, test_cpu_features.x86.has_sse42);
 #endif
 #ifdef X86_AVX2
-BENCHMARK_ADLER32_BASELINE_COPY(avx2_baseline, adler32_avx2, test_cpu_features.x86.has_avx2);
-BENCHMARK_ADLER32_COPY(avx2, adler32_fold_copy_avx2, test_cpu_features.x86.has_avx2);
+BENCHMARK_ADLER32_COPY(avx2, adler32_avx, adler32_copy_avx2, test_cpu_features.x86.has_avx2);
 #endif
 #ifdef X86_AVX512
-BENCHMARK_ADLER32_BASELINE_COPY(avx512_baseline, adler32_avx512, test_cpu_features.x86.has_avx512_common);
-BENCHMARK_ADLER32_COPY(avx512, adler32_fold_copy_avx512, test_cpu_features.x86.has_avx512_common);
+BENCHMARK_ADLER32_COPY(avx512, adler32_avx512, adler32_copy_avx512, test_cpu_features.x86.has_avx512_common);
 #endif
 #ifdef X86_AVX512VNNI
-BENCHMARK_ADLER32_BASELINE_COPY(avx512_vnni_baseline, adler32_avx512_vnni, test_cpu_features.x86.has_avx512vnni);
-BENCHMARK_ADLER32_COPY(avx512_vnni, adler32_fold_copy_avx512_vnni, test_cpu_features.x86.has_avx512vnni);
+BENCHMARK_ADLER32_COPY(avx512_vnni, adler32_avx512_vnni, adler32_copy_avx512_vnni, test_cpu_features.x86.has_avx512vnni);
+#endif
+
+#ifdef LOONGARCH_LSX
+BENCHMARK_ADLER32_COPY(lsx, adler32_lsx, adler32_copy_lsx, test_cpu_features.loongarch.has_lsx);
+#endif
+#ifdef LOONGARCH_LASX
+BENCHMARK_ADLER32_COPY(lasx, adler32_lasx, adler32_copy_lasx, test_cpu_features.loongarch.has_lasx);
 #endif
 
 #endif
diff --git a/test/benchmarks/benchmark_compare256.cc b/test/benchmarks/benchmark_compare256.cc
index efdbbacc..4b616f5a 100644
--- a/test/benchmarks/benchmark_compare256.cc
+++ b/test/benchmarks/benchmark_compare256.cc
@@ -3,18 +3,16 @@
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 
-#include <stdio.h>
-
 #include <benchmark/benchmark.h>
 
 extern "C" {
 #  include "zbuild.h"
-#  include "zutil_p.h"
 #  include "arch_functions.h"
 #  include "../test_cpu_features.h"
+#  include "arch/generic/compare256_p.h"
 }
 
-#define MAX_COMPARE_SIZE (256)
+#define MAX_COMPARE_SIZE (256 + 64)
 
 class compare256: public benchmark::Fixture {
 private:
@@ -22,65 +20,78 @@ private:
     uint8_t *str2;
 
 public:
-    void SetUp(const ::benchmark::State& state) {
-        str1 = (uint8_t *)zng_alloc(MAX_COMPARE_SIZE);
-        assert(str1 != NULL);
-        memset(str1, 'a', MAX_COMPARE_SIZE);
+    void SetUp(::benchmark::State& state) {
+        str1 = (uint8_t *)malloc(MAX_COMPARE_SIZE);
+        str2 = (uint8_t *)malloc(MAX_COMPARE_SIZE);
+        if (str1 == NULL || str2 == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
 
-        str2 = (uint8_t *)zng_alloc(MAX_COMPARE_SIZE);
-        assert(str2 != NULL);
+        memset(str1, 'a', MAX_COMPARE_SIZE);
         memset(str2, 'a', MAX_COMPARE_SIZE);
     }
 
+    // Benchmark compare256, with rolling buffer misalignment for consistent results
     void Bench(benchmark::State& state, compare256_func compare256) {
+        int misalign = 0;
         int32_t match_len = (int32_t)state.range(0) - 1;
         uint32_t len = 0;
 
-        str2[match_len] = 0;
         for (auto _ : state) {
-            len = compare256((const uint8_t *)str1, (const uint8_t *)str2);
+            str2[match_len + misalign] = 0;   // Set new match limit
+
+            len = compare256((const uint8_t *)str1 + misalign, (const uint8_t *)str2 + misalign);
+
+            str2[match_len + misalign] = 'a'; // Reset match limit
+
+            if (misalign >= 63)
+                misalign = 0;
+            else
+                misalign++;
         }
-        str2[match_len] = 'a';
 
+        // Prevent the result from being optimized away
         benchmark::DoNotOptimize(len);
     }
 
-    void TearDown(const ::benchmark::State& state) {
-        zng_free(str1);
-        zng_free(str2);
+    void TearDown(const ::benchmark::State&) {
+        free(str1);
+        free(str2);
     }
 };
 
-#define BENCHMARK_COMPARE256(name, fptr, support_flag) \
+#define BENCHMARK_COMPARE256(name, comparefunc, support_flag) \
     BENCHMARK_DEFINE_F(compare256, name)(benchmark::State& state) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             state.SkipWithError("CPU does not support " #name); \
         } \
-        Bench(state, fptr); \
+        Bench(state, comparefunc); \
     } \
-    BENCHMARK_REGISTER_F(compare256, name)->Range(1, MAX_COMPARE_SIZE);
-
-BENCHMARK_COMPARE256(c, compare256_c, 1);
+    BENCHMARK_REGISTER_F(compare256, name)->Arg(1)->Arg(10)->Arg(40)->Arg(80)->Arg(100)->Arg(175)->Arg(256);
 
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 BENCHMARK_COMPARE256(native, native_compare256, 1);
 #else
 
-#if defined(UNALIGNED_OK) && BYTE_ORDER == LITTLE_ENDIAN
-BENCHMARK_COMPARE256(unaligned_16, compare256_unaligned_16, 1);
-#ifdef HAVE_BUILTIN_CTZ
-BENCHMARK_COMPARE256(unaligned_32, compare256_unaligned_32, 1);
-#endif
-#if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-BENCHMARK_COMPARE256(unaligned_64, compare256_unaligned_64, 1);
+BENCHMARK_COMPARE256(8, compare256_8, 1);
+BENCHMARK_COMPARE256(16, compare256_16, 1);
+#if defined(HAVE_BUILTIN_CTZ)
+BENCHMARK_COMPARE256(32, compare256_32, 1);
 #endif
+#if defined(HAVE_BUILTIN_CTZLL)
+BENCHMARK_COMPARE256(64, compare256_64, 1);
 #endif
+
 #if defined(X86_SSE2) && defined(HAVE_BUILTIN_CTZ)
 BENCHMARK_COMPARE256(sse2, compare256_sse2, test_cpu_features.x86.has_sse2);
 #endif
 #if defined(X86_AVX2) && defined(HAVE_BUILTIN_CTZ)
 BENCHMARK_COMPARE256(avx2, compare256_avx2, test_cpu_features.x86.has_avx2);
 #endif
+#if defined(X86_AVX512) && defined(HAVE_BUILTIN_CTZLL)
+BENCHMARK_COMPARE256(avx512, compare256_avx512, test_cpu_features.x86.has_avx512_common);
+#endif
 #if defined(ARM_NEON) && defined(HAVE_BUILTIN_CTZLL)
 BENCHMARK_COMPARE256(neon, compare256_neon, test_cpu_features.arm.has_neon);
 #endif
@@ -90,5 +101,11 @@ BENCHMARK_COMPARE256(power9, compare256_power9, test_cpu_features.power.has_arch
 #ifdef RISCV_RVV
 BENCHMARK_COMPARE256(rvv, compare256_rvv, test_cpu_features.riscv.has_rvv);
 #endif
+#if defined(LOONGARCH_LSX) && defined(HAVE_BUILTIN_CTZ)
+BENCHMARK_COMPARE256(lsx, compare256_lsx, test_cpu_features.loongarch.has_lsx);
+#endif
+#if defined(LOONGARCH_LASX) && defined(HAVE_BUILTIN_CTZ)
+BENCHMARK_COMPARE256(lasx, compare256_lasx, test_cpu_features.loongarch.has_lasx);
+#endif
 
 #endif
diff --git a/test/benchmarks/benchmark_compare256_rle.cc b/test/benchmarks/benchmark_compare256_rle.cc
index 3b1eced4..7e6551db 100644
--- a/test/benchmarks/benchmark_compare256_rle.cc
+++ b/test/benchmarks/benchmark_compare256_rle.cc
@@ -3,17 +3,14 @@
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 
-#include <stdio.h>
-
 #include <benchmark/benchmark.h>
 
 extern "C" {
 #  include "zbuild.h"
-#  include "zutil_p.h"
 #  include "compare256_rle.h"
 }
 
-#define MAX_COMPARE_SIZE (256)
+#define MAX_COMPARE_SIZE (256 + 64)
 
 class compare256_rle: public benchmark::Fixture {
 private:
@@ -21,52 +18,61 @@ private:
     uint8_t *str2;
 
 public:
-    void SetUp(const ::benchmark::State& state) {
-        str1 = (uint8_t *)zng_alloc(MAX_COMPARE_SIZE);
-        assert(str1 != NULL);
-        memset(str1, 'a', MAX_COMPARE_SIZE);
+    void SetUp(::benchmark::State& state) {
+        str1 = (uint8_t *)malloc(MAX_COMPARE_SIZE);
+        str2 = (uint8_t *)malloc(MAX_COMPARE_SIZE);
+        if (str1 == NULL || str2 == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
 
-        str2 = (uint8_t *)zng_alloc(MAX_COMPARE_SIZE);
-        assert(str2 != NULL);
+        memset(str1, 'a', MAX_COMPARE_SIZE);
         memset(str2, 'a', MAX_COMPARE_SIZE);
     }
 
+    // Benchmark compare256_rle, with rolling buffer misalignment for consistent results
     void Bench(benchmark::State& state, compare256_rle_func compare256_rle) {
+        int misalign = 0;
         int32_t match_len = (int32_t)state.range(0) - 1;
-        uint32_t len;
+        uint32_t len = 0;
 
-        str2[match_len] = 0;
         for (auto _ : state) {
-            len = compare256_rle((const uint8_t *)str1, (const uint8_t *)str2);
+            str2[match_len + misalign] = 0;   // Set new match limit
+
+            len = compare256_rle((const uint8_t *)str1 + misalign, (const uint8_t *)str2 + misalign);
+
+            str2[match_len + misalign] = 'a'; // Reset match limit
+
+            if (misalign >= 63)
+                misalign = 0;
+            else
+                misalign++;
         }
-        str2[match_len] = 'a';
 
+        // Prevent the result from being optimized away
         benchmark::DoNotOptimize(len);
     }
 
-    void TearDown(const ::benchmark::State& state) {
-        zng_free(str1);
-        zng_free(str2);
+    void TearDown(const ::benchmark::State&) {
+        free(str1);
+        free(str2);
     }
 };
 
-#define BENCHMARK_COMPARE256_RLE(name, fptr, support_flag) \
+#define BENCHMARK_COMPARE256_RLE(name, comparefunc, support_flag) \
     BENCHMARK_DEFINE_F(compare256_rle, name)(benchmark::State& state) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             state.SkipWithError("CPU does not support " #name); \
         } \
-        Bench(state, fptr); \
+        Bench(state, comparefunc); \
     } \
-    BENCHMARK_REGISTER_F(compare256_rle, name)->Range(1, MAX_COMPARE_SIZE);
+    BENCHMARK_REGISTER_F(compare256_rle, name)->Arg(1)->Arg(10)->Arg(40)->Arg(80)->Arg(100)->Arg(175)->Arg(256);;
 
-BENCHMARK_COMPARE256_RLE(c, compare256_rle_c, 1);
-
-#ifdef UNALIGNED_OK
-BENCHMARK_COMPARE256_RLE(unaligned_16, compare256_rle_unaligned_16, 1);
-#ifdef HAVE_BUILTIN_CTZ
-BENCHMARK_COMPARE256_RLE(unaligned_32, compare256_rle_unaligned_32, 1);
-#endif
-#if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-BENCHMARK_COMPARE256_RLE(unaligned_64, compare256_rle_unaligned_64, 1);
+BENCHMARK_COMPARE256_RLE(8, compare256_rle_8, 1);
+BENCHMARK_COMPARE256_RLE(16, compare256_rle_16, 1);
+#if defined(HAVE_BUILTIN_CTZ)
+BENCHMARK_COMPARE256_RLE(32, compare256_rle_32, 1);
 #endif
+#if defined(HAVE_BUILTIN_CTZLL)
+BENCHMARK_COMPARE256_RLE(64, compare256_rle_64, 1);
 #endif
diff --git a/test/benchmarks/benchmark_compress.cc b/test/benchmarks/benchmark_compress.cc
index 3d63a441..b1a082da 100644
--- a/test/benchmarks/benchmark_compress.cc
+++ b/test/benchmarks/benchmark_compress.cc
@@ -1,5 +1,5 @@
 /* benchmark_compress.cc -- benchmark compress()
- * Copyright (C) 2024 Hans Kristian Rosbach
+ * Copyright (C) 2024-2025 Hans Kristian Rosbach
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 
@@ -15,46 +15,53 @@ extern "C" {
 #  else
 #    include "zlib-ng.h"
 #  endif
+#  include "compressible_data_p.h"
 }
 
-#define MAX_SIZE (32 * 1024)
+#define MAX_SIZE (64 * 1024)
 
 class compress_bench: public benchmark::Fixture {
 private:
-    size_t maxlen;
     uint8_t *inbuff;
     uint8_t *outbuff;
 
 public:
-    void SetUp(const ::benchmark::State& state) {
-        const char teststr[42] = "Hello hello World broken Test tast mello.";
-        maxlen = MAX_SIZE;
-
-        inbuff = (uint8_t *)zng_alloc(MAX_SIZE + 1);
-        assert(inbuff != NULL);
-
-        outbuff = (uint8_t *)zng_alloc(MAX_SIZE + 1);
-        assert(outbuff != NULL);
+    void SetUp(::benchmark::State& state) {
+        outbuff = (uint8_t *)malloc(MAX_SIZE + 16);
+        if (outbuff == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
 
-        int pos = 0;
-        for (int32_t i = 0; i < MAX_SIZE - 42 ; i+=42){
-           pos += sprintf((char *)inbuff+pos, "%s", teststr);
+        // Initialize input buffer with highly compressible data, interspersed
+        // with small amounts of random data and 3-byte matches.
+        inbuff = gen_compressible_data(MAX_SIZE);
+        if (inbuff == NULL) {
+            free(outbuff);
+            outbuff = NULL;
+            state.SkipWithError("gen_compressible_data() failed");
+            return;
         }
     }
 
     void Bench(benchmark::State& state) {
-        int err;
+        int err = 0;
 
         for (auto _ : state) {
-            err = PREFIX(compress)(outbuff, &maxlen, inbuff, (size_t)state.range(0));
+            z_uintmax_t compressed_size = MAX_SIZE + 16;
+            err = PREFIX(compress)(outbuff, &compressed_size, inbuff, (size_t)state.range(0));
+            if (err != Z_OK) {
+                fprintf(stderr, "compress() failed with error %d\n", err);
+                abort();
+            }
         }
 
         benchmark::DoNotOptimize(err);
     }
 
-    void TearDown(const ::benchmark::State& state) {
-        zng_free(inbuff);
-        zng_free(outbuff);
+    void TearDown(const ::benchmark::State&) {
+        free(inbuff);
+        free(outbuff);
     }
 };
 
@@ -62,6 +69,6 @@ public:
     BENCHMARK_DEFINE_F(compress_bench, name)(benchmark::State& state) { \
         Bench(state); \
     } \
-    BENCHMARK_REGISTER_F(compress_bench, name)->Arg(1)->Arg(8)->Arg(16)->Arg(32)->Arg(64)->Arg(512)->Arg(4<<10)->Arg(32<<10);
+    BENCHMARK_REGISTER_F(compress_bench, name)->Arg(1)->Arg(16)->Arg(48)->Arg(256)->Arg(1<<10)->Arg(4<<10)->Arg(16<<10)->Arg(64<<10);
 
 BENCHMARK_COMPRESS(compress_bench);
diff --git a/test/benchmarks/benchmark_crc32.cc b/test/benchmarks/benchmark_crc32.cc
index 7aba7c33..df7eaec3 100644
--- a/test/benchmarks/benchmark_crc32.cc
+++ b/test/benchmarks/benchmark_crc32.cc
@@ -3,67 +3,105 @@
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 
-#include <stdio.h>
-#include <assert.h>
-
 #include <benchmark/benchmark.h>
 
 extern "C" {
 #  include "zbuild.h"
-#  include "zutil_p.h"
 #  include "arch_functions.h"
 #  include "../test_cpu_features.h"
 }
 
-#define MAX_RANDOM_INTS (1024 * 1024)
-#define MAX_RANDOM_INTS_SIZE (MAX_RANDOM_INTS * sizeof(uint32_t))
+#define BUFSIZE ((4 * 1024 * 1024) + 64)
 
 class crc32: public benchmark::Fixture {
 private:
-    uint32_t *random_ints;
+    uint32_t *testdata;
 
 public:
-    void SetUp(const ::benchmark::State& state) {
-        random_ints = (uint32_t *)zng_alloc(MAX_RANDOM_INTS_SIZE);
-        assert(random_ints != NULL);
+    void SetUp(::benchmark::State& state) {
+        testdata = (uint32_t *)zng_alloc_aligned(BUFSIZE, 64);
+        if (testdata == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
 
-        for (int32_t i = 0; i < MAX_RANDOM_INTS; i++) {
-            random_ints[i] = rand();
+        for (uint32_t i = 0; i < BUFSIZE/sizeof(uint32_t); i++) {
+            testdata[i] = rand();
         }
     }
 
-    void Bench(benchmark::State& state, crc32_func crc32) {
+    // Benchmark CRC32, with rolling buffer misalignment for consistent results
+    void Bench(benchmark::State& state, crc32_func crc32, const int DO_ALIGNED) {
+        int misalign = 0;
         uint32_t hash = 0;
 
         for (auto _ : state) {
-            hash = crc32(hash, (const unsigned char *)random_ints, (size_t)state.range(0));
+            hash = crc32(hash, (const unsigned char *)testdata + misalign, (size_t)state.range(0));
+            if (misalign >= 63)
+                misalign = 0;
+            else
+                misalign += (DO_ALIGNED) ? 16 : 1;
         }
 
+        // Prevent the result from being optimized away
         benchmark::DoNotOptimize(hash);
     }
 
-    void TearDown(const ::benchmark::State& state) {
-        zng_free(random_ints);
+    void TearDown(const ::benchmark::State&) {
+        zng_free_aligned(testdata);
     }
 };
 
-#define BENCHMARK_CRC32(name, fptr, support_flag) \
+#define BENCHMARK_CRC32_MISALIGNED(name, hashfunc, support_flag) \
     BENCHMARK_DEFINE_F(crc32, name)(benchmark::State& state) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             state.SkipWithError("CPU does not support " #name); \
         } \
-        Bench(state, fptr); \
+        Bench(state, hashfunc, 0); \
     } \
     BENCHMARK_REGISTER_F(crc32, name)->Arg(1)->Arg(8)->Arg(12)->Arg(16)->Arg(32)->Arg(64)->Arg(512)->Arg(4<<10)->Arg(32<<10)->Arg(256<<10)->Arg(4096<<10);
 
-BENCHMARK_CRC32(braid, PREFIX(crc32_braid), 1);
+// Aligned
+#define ALIGNED_NAME(name) name##_aligned
+#define BENCHMARK_CRC32_ALIGNED(name, hashfunc, support_flag) \
+    BENCHMARK_DEFINE_F(crc32, ALIGNED_NAME(name))(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("CPU does not support " #name); \
+        } \
+        Bench(state, hashfunc, 1); \
+    } \
+    BENCHMARK_REGISTER_F(crc32, ALIGNED_NAME(name))->Arg(8)->Arg(12)->Arg(16)->Arg(32)->Arg(64)->Arg(512)->Arg(4<<10)->Arg(32<<10)->Arg(256<<10)->Arg(4096<<10);
+
+// Queue both misaligned and aligned for each benchmark
+#define BENCHMARK_CRC32(name, hashfunc, support_flag) \
+    BENCHMARK_CRC32_MISALIGNED(name, hashfunc, support_flag); \
+    BENCHMARK_CRC32_ALIGNED(name, hashfunc, support_flag);
+
+BENCHMARK_CRC32(braid, crc32_braid, 1);
 
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 BENCHMARK_CRC32(native, native_crc32, 1);
 #else
 
-#ifdef ARM_ACLE
-BENCHMARK_CRC32(acle, crc32_acle, test_cpu_features.arm.has_crc32);
+#ifndef WITHOUT_CHORBA
+BENCHMARK_CRC32(chorba_c, crc32_chorba, 1);
+#endif
+#ifndef WITHOUT_CHORBA_SSE
+#   ifdef X86_SSE2
+    BENCHMARK_CRC32(chorba_sse2, crc32_chorba_sse2, test_cpu_features.x86.has_sse2);
+#   endif
+#   ifdef X86_SSE41
+    BENCHMARK_CRC32(chorba_sse41, crc32_chorba_sse41, test_cpu_features.x86.has_sse41);
+#   endif
+#endif
+#ifdef ARM_CRC32
+BENCHMARK_CRC32(armv8, crc32_armv8, test_cpu_features.arm.has_crc32);
+#endif
+#ifdef ARM_PMULL_EOR3
+BENCHMARK_CRC32(armv8_pmull_eor3, crc32_armv8_pmull_eor3, test_cpu_features.arm.has_crc32 && test_cpu_features.arm.has_pmull && test_cpu_features.arm.has_eor3);
+#endif
+#ifdef RISCV_CRC32_ZBC
+BENCHMARK_CRC32(riscv, crc32_riscv64_zbc, test_cpu_features.riscv.has_zbc);
 #endif
 #ifdef POWER8_VSX_CRC32
 BENCHMARK_CRC32(power8, crc32_power8, test_cpu_features.power.has_arch_2_07);
@@ -72,12 +110,13 @@ BENCHMARK_CRC32(power8, crc32_power8, test_cpu_features.power.has_arch_2_07);
 BENCHMARK_CRC32(vx, crc32_s390_vx, test_cpu_features.s390.has_vx);
 #endif
 #ifdef X86_PCLMULQDQ_CRC
-/* CRC32 fold does a memory copy while hashing */
 BENCHMARK_CRC32(pclmulqdq, crc32_pclmulqdq, test_cpu_features.x86.has_pclmulqdq);
 #endif
 #ifdef X86_VPCLMULQDQ_CRC
-/* CRC32 fold does a memory copy while hashing */
 BENCHMARK_CRC32(vpclmulqdq, crc32_vpclmulqdq, (test_cpu_features.x86.has_pclmulqdq && test_cpu_features.x86.has_avx512_common && test_cpu_features.x86.has_vpclmulqdq));
 #endif
+#ifdef LOONGARCH_CRC
+BENCHMARK_CRC32(loongarch64, crc32_loongarch64, test_cpu_features.loongarch.has_crc);
+#endif
 
 #endif
diff --git a/test/benchmarks/benchmark_crc32_copy.cc b/test/benchmarks/benchmark_crc32_copy.cc
new file mode 100644
index 00000000..aa5c3f9e
--- /dev/null
+++ b/test/benchmarks/benchmark_crc32_copy.cc
@@ -0,0 +1,174 @@
+/* benchmark_crc32_copy.cc -- benchmark for crc32 implementations with copying
+ * Copyright (C) 2025 Hans Kristian Rosbach
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include <benchmark/benchmark.h>
+
+extern "C" {
+#  include "zbuild.h"
+#  include "arch_functions.h"
+#  include "../test_cpu_features.h"
+}
+
+// Hash copy functions are used on strm->next_in buffers, we process
+// 512-32k sizes (x2 for initial fill) at a time if enough data is available.
+#define BUFSIZE (65536 + 64)
+
+class crc32_copy: public benchmark::Fixture {
+protected:
+    uint32_t *testdata;
+    uint8_t *dstbuf;
+
+public:
+    void SetUp(::benchmark::State& state) {
+        testdata = (uint32_t *)zng_alloc_aligned(BUFSIZE, 64);
+        dstbuf = (uint8_t *)zng_alloc_aligned(BUFSIZE, 64);
+        if (testdata == NULL || dstbuf == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
+
+        for (uint32_t i = 0; i < BUFSIZE/sizeof(uint32_t); i++) {
+            testdata[i] = rand();
+        }
+    }
+
+    // Benchmark CRC32_copy, with rolling buffer misalignment for consistent results
+    void Bench(benchmark::State& state, crc32_copy_func crc32_copy, const int DO_ALIGNED) {
+        int misalign = 0;
+        uint32_t hash = 0;
+
+        for (auto _ : state) {
+            hash = crc32_copy(hash, dstbuf + misalign, (const unsigned char*)testdata + misalign, (size_t)state.range(0));
+            if (misalign >= 63)
+                misalign = 0;
+            else
+                misalign += (DO_ALIGNED) ? 16 : 1;
+        }
+
+        // Prevent the result from being optimized away
+        benchmark::DoNotOptimize(hash);
+    }
+
+    void TearDown(const ::benchmark::State&) {
+        zng_free_aligned(testdata);
+        zng_free_aligned(dstbuf);
+    }
+};
+
+// Misaligned
+#define BENCHMARK_CRC32_COPY_MISALIGNED(name, copyfunc, support_flag) \
+    BENCHMARK_DEFINE_F(crc32_copy, name)(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("CPU does not support " #name); \
+        } \
+        Bench(state, copyfunc, 0); \
+    } \
+    BENCHMARK_REGISTER_F(crc32_copy, name)->Arg(32)->Arg(512)->Arg(8<<10)->Arg(32<<10)->Arg(64<<10);
+
+// Aligned
+#define ALIGNED_NAME(name) name##_aligned
+#define BENCHMARK_CRC32_COPY_ALIGNED(name, copyfunc, support_flag) \
+    BENCHMARK_DEFINE_F(crc32_copy, ALIGNED_NAME(name))(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("CPU does not support " #name); \
+        } \
+        Bench(state, copyfunc, 1); \
+    } \
+    BENCHMARK_REGISTER_F(crc32_copy, ALIGNED_NAME(name))->Arg(32)->Arg(512)->Arg(8<<10)->Arg(32<<10)->Arg(64<<10);
+
+// CRC32 + memcpy benchmarks for reference
+#ifdef HASH_BASELINE
+#define MEMCPY_NAME(name) name##_memcpy
+#define BENCHMARK_CRC32_MEMCPY_MISALIGNED(name, hashfunc, support_flag) \
+    BENCHMARK_DEFINE_F(crc32_copy, MEMCPY_NAME(name))(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("CPU does not support " #name); \
+        } \
+	Bench(state, [](uint32_t init_sum, unsigned char *dst, \
+                        const uint8_t *buf, size_t len) -> uint32_t { \
+            memcpy(dst, buf, (size_t)len); \
+            return hashfunc(init_sum, buf, len); \
+        }, 0); \
+    } \
+    BENCHMARK_REGISTER_F(crc32_copy, MEMCPY_NAME(name))->Arg(32)->Arg(512)->Arg(8<<10)->Arg(32<<10)->Arg(64<<10);
+
+#define MEMCPY_ALIGNED_NAME(name) name##_memcpy_aligned
+#define BENCHMARK_CRC32_MEMCPY_ALIGNED(name, hashfunc, support_flag) \
+    BENCHMARK_DEFINE_F(crc32_copy, MEMCPY_ALIGNED_NAME(name))(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("CPU does not support " #name); \
+        } \
+	Bench(state, [](uint32_t init_sum, unsigned char *dst, \
+                        const uint8_t *buf, size_t len) -> uint32_t { \
+            memcpy(dst, buf, (size_t)len); \
+            return hashfunc(init_sum, buf, len); \
+        }, 1); \
+    } \
+    BENCHMARK_REGISTER_F(crc32_copy, MEMCPY_ALIGNED_NAME(name))->Arg(32)->Arg(512)->Arg(8<<10)->Arg(32<<10)->Arg(64<<10);
+#endif
+
+
+// Queue both misaligned and aligned for each benchmark
+#define BENCHMARK_CRC32_COPY_ONLY(name, copyfunc, support_flag) \
+    BENCHMARK_CRC32_COPY_MISALIGNED(name, copyfunc, support_flag); \
+    BENCHMARK_CRC32_COPY_ALIGNED(name, copyfunc, support_flag);
+
+// Optionally also benchmark using memcpy with normal hash function for baseline
+#ifdef HASH_BASELINE
+#define BENCHMARK_CRC32_COPY(name, hashfunc, copyfunc, support_flag) \
+    BENCHMARK_CRC32_COPY_MISALIGNED(name, copyfunc, support_flag); \
+    BENCHMARK_CRC32_COPY_ALIGNED(name, copyfunc, support_flag); \
+    BENCHMARK_CRC32_MEMCPY_MISALIGNED(name, copyfunc, support_flag); \
+    BENCHMARK_CRC32_MEMCPY_ALIGNED(name, copyfunc, support_flag);
+#else
+#define BENCHMARK_CRC32_COPY(name, hashfunc, copyfunc, support_flag) \
+    BENCHMARK_CRC32_COPY_ONLY(name, copyfunc, support_flag)
+#endif
+
+// Base test
+BENCHMARK_CRC32_COPY(braid, crc32_braid, crc32_copy_braid, 1);
+
+#ifdef DISABLE_RUNTIME_CPU_DETECTION
+    // Native
+    BENCHMARK_CRC32_COPY(native, native_crc32, native_crc32_copy, 1)
+#else
+    // Optimized functions
+#  ifndef WITHOUT_CHORBA
+    BENCHMARK_CRC32_COPY(chorba, crc32_chorba, crc32_copy_chorba, 1)
+#  endif
+#  ifndef WITHOUT_CHORBA_SSE
+#    ifdef X86_SSE2
+    BENCHMARK_CRC32_COPY(chorba_sse2, crc32_chorba_sse2, crc32_copy_chorba_sse2, test_cpu_features.x86.has_sse2);
+#    endif
+#    ifdef X86_SSE41
+    BENCHMARK_CRC32_COPY(chorba_sse41, crc32_chorba_sse41, crc32_copy_chorba_sse41, test_cpu_features.x86.has_sse41);
+#    endif
+#  endif
+#  ifdef ARM_CRC32
+    BENCHMARK_CRC32_COPY(armv8, crc32_armv8, crc32_copy_armv8, test_cpu_features.arm.has_crc32)
+#  endif
+#  ifdef ARM_PMULL_EOR3
+    BENCHMARK_CRC32_COPY(armv8_pmull_eor3, crc32_armv8_pmull_eor3, crc32_copy_armv8_pmull_eor3, test_cpu_features.arm.has_crc32 && test_cpu_features.arm.has_pmull && test_cpu_features.arm.has_eor3)
+#  endif
+#  ifdef LOONGARCH_CRC
+    BENCHMARK_CRC32_COPY(loongarch, crc32_loongarch64, crc32_copy_loongarch64, test_cpu_features.loongarch.has_crc)
+#  endif
+#  ifdef POWER8_VSX_CRC32
+    BENCHMARK_CRC32_COPY(power8, crc32_power8, crc32_copy_power8, test_cpu_features.power.has_arch_2_07)
+#  endif
+#  ifdef RISCV_CRC32_ZBC
+    BENCHMARK_CRC32_COPY(riscv, crc32_riscv, crc32_copy_riscv64_zbc, test_cpu_features.riscv.has_zbc)
+#  endif
+#  ifdef S390_CRC32_VX
+    BENCHMARK_CRC32_COPY(vx, crc32_s390_vx, crc32_copy_s390_vx, test_cpu_features.s390.has_vx)
+#  endif
+#  ifdef X86_PCLMULQDQ_CRC
+    BENCHMARK_CRC32_COPY(pclmulqdq, crc32_pclmulqdq, crc32_copy_pclmulqdq, test_cpu_features.x86.has_pclmulqdq)
+#  endif
+#  ifdef X86_VPCLMULQDQ_CRC
+    BENCHMARK_CRC32_COPY(vpclmulqdq, crc32_vpclmulqdq, crc32_copy_vpclmulqdq, (test_cpu_features.x86.has_pclmulqdq && test_cpu_features.x86.has_avx512_common && test_cpu_features.x86.has_vpclmulqdq))
+#  endif
+
+#endif
diff --git a/test/benchmarks/benchmark_inflate.cc b/test/benchmarks/benchmark_inflate.cc
new file mode 100644
index 00000000..ef3457b1
--- /dev/null
+++ b/test/benchmarks/benchmark_inflate.cc
@@ -0,0 +1,169 @@
+/* benchmark_inflate.cc -- benchmark inflate() without crc32/adler32
+ * Copyright (C) 2024-2025 Hans Kristian Rosbach
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include <stdio.h>
+#include <assert.h>
+#include <benchmark/benchmark.h>
+
+extern "C" {
+#  include "zbuild.h"
+#  include "zutil_p.h"
+#  if defined(ZLIB_COMPAT)
+#    include "zlib.h"
+#  else
+#    include "zlib-ng.h"
+#  endif
+#  include "compressible_data_p.h"
+}
+
+#define MAX_SIZE (1024 * 1024)
+#define NUM_TESTS 6
+
+class inflate_bench: public benchmark::Fixture {
+private:
+    uint8_t *inbuff;
+    uint8_t *outbuff;
+    uint8_t *compressed_buff[NUM_TESTS];
+    z_uintmax_t compressed_sizes[NUM_TESTS];
+    uint32_t sizes[NUM_TESTS] = {1, 64, 1024, 16384, 128*1024, 1024*1024};
+
+public:
+    void SetUp(::benchmark::State& state) {
+        int err;
+        outbuff = (uint8_t *)malloc(MAX_SIZE + 16);
+        if (outbuff == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
+
+        // Initialize input buffer with highly compressible data, interspersed
+        // with small amounts of random data and 3-byte matches.
+        inbuff = gen_compressible_data(MAX_SIZE);
+        if (inbuff == NULL) {
+            free(outbuff);
+            outbuff = NULL;
+            state.SkipWithError("gen_compressible_data() failed");
+            return;
+        }
+
+        // Initialize Deflate state
+        PREFIX3(stream) strm;
+        strm.zalloc = NULL;
+        strm.zfree = NULL;
+        strm.opaque = NULL;
+        strm.total_in = 0;
+        strm.total_out = 0;
+        strm.next_out = NULL;
+        strm.avail_out = 0;
+
+        err = PREFIX(deflateInit2)(&strm, Z_BEST_COMPRESSION, Z_DEFLATED, -15, MAX_MEM_LEVEL, Z_DEFAULT_STRATEGY);
+        if (err != Z_OK) {
+            state.SkipWithError("deflateInit2 did not return Z_OK");
+            return;
+        }
+
+
+        // Compress data into different buffers
+        for (int i = 0; i < NUM_TESTS; ++i) {
+            compressed_buff[i] = (uint8_t *)malloc(sizes[i] + 64);
+            if (compressed_buff[i] == NULL) {
+                state.SkipWithError("malloc failed");
+                return;
+            }
+
+            strm.avail_in = sizes[i];                   // Size of the input buffer
+            strm.next_in = (z_const uint8_t *)inbuff;   // Pointer to the input buffer
+            strm.next_out = compressed_buff[i];         // Pointer to the output buffer
+            strm.avail_out = sizes[i] + 64;             // Maximum size of the output buffer
+
+            err = PREFIX(deflate)(&strm, Z_FINISH);     // Perform compression
+            if (err != Z_STREAM_END ) {
+                state.SkipWithError("deflate did not return Z_STREAM_END");
+                PREFIX(deflateEnd)(&strm);
+                return;
+            }
+
+            compressed_sizes[i] = strm.total_out;       // Total compressed size
+
+            err = PREFIX(deflateReset)(&strm);                // Reset Deflate state
+            if (err != Z_OK) {
+                state.SkipWithError("deflateReset did not return Z_OK");
+                return;
+            }
+        }
+
+        err = PREFIX(deflateEnd)(&strm);                // Clean up the deflate stream
+        if (err != Z_OK) {
+            state.SkipWithError("deflateEnd did not return Z_OK");
+            return;
+        }
+    }
+
+    void Bench(benchmark::State& state) {
+        int err;
+        int index = 0;
+        while (sizes[index] != (uint32_t)state.range(0)) ++index;
+
+        // Initialize the inflate stream
+        PREFIX3(stream) strm;
+        strm.zalloc = NULL;
+        strm.zfree = NULL;
+        strm.opaque = NULL;
+        strm.next_in = NULL;
+        strm.avail_in = 0;
+
+        err = PREFIX(inflateInit2)(&strm, -15);  // Initialize the inflate state, no crc/adler
+        if (err != Z_OK) {
+            state.SkipWithError("inflateInit did not return Z_OK");
+            return;
+        }
+
+        for (auto _ : state) {
+            // Perform reset, avoids benchmarking inflateInit and inflateEnd
+            err = PREFIX(inflateReset)(&strm);
+            if (err != Z_OK) {
+                state.SkipWithError("inflateReset did not return Z_OK");
+                return;
+            }
+
+            strm.avail_in = (uint32_t)compressed_sizes[index];  // Size of the input
+            strm.next_in = compressed_buff[index];              // Pointer to the compressed data
+            strm.avail_out = MAX_SIZE;                          // Max size for output
+            strm.next_out = outbuff;                            // Output buffer
+
+            // Perform decompression
+            err = PREFIX(inflate)(&strm, Z_FINISH);
+            if (err != Z_STREAM_END) {
+                state.SkipWithError("inflate did not return Z_STREAM_END");
+                PREFIX(inflateEnd)(&strm);
+                return;
+            }
+        }
+
+        // Finalize the inflation process
+        err = PREFIX(inflateEnd)(&strm);
+        if (err != Z_OK) {
+            state.SkipWithError("inflateEnd did not return Z_OK");
+            return;
+        }
+    }
+
+    void TearDown(const ::benchmark::State&) {
+        free(inbuff);
+        free(outbuff);
+
+        for (int i = 0; i < NUM_TESTS; ++i) {
+            free(compressed_buff[i]);
+        }
+    }
+};
+
+#define BENCHMARK_INFLATE(name) \
+    BENCHMARK_DEFINE_F(inflate_bench, name)(benchmark::State& state) { \
+        Bench(state); \
+    } \
+    BENCHMARK_REGISTER_F(inflate_bench, name)->Arg(1)->Arg(64)->Arg(1024)->Arg(16<<10)->Arg(128<<10)->Arg(1024<<10);
+
+BENCHMARK_INFLATE(inflate_nocrc);
diff --git a/test/benchmarks/benchmark_insert_string.cc b/test/benchmarks/benchmark_insert_string.cc
new file mode 100644
index 00000000..fafba3c4
--- /dev/null
+++ b/test/benchmarks/benchmark_insert_string.cc
@@ -0,0 +1,164 @@
+/* benchmark_insert_string.cc -- benchmark insert_string variants
+ * Copyright (C) 2025 Nathan Moinvaziri
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include <limits.h>
+#include <cstring>
+
+#include <benchmark/benchmark.h>
+
+extern "C" {
+#  include "zbuild.h"
+#  include "deflate.h"
+#  include "arch_functions.h"
+#  include "../test_cpu_features.h"
+#  include "insert_string_p.h"
+}
+
+#define MAX_WSIZE 32768
+#define TEST_WINDOW_SIZE (MAX_WSIZE * 2)
+
+typedef uint32_t (* quick_insert_string_cb)(deflate_state *const s, uint32_t str);
+
+// Base class with common setup/teardown for both insert_string benchmarks
+class insert_string_base: public benchmark::Fixture {
+protected:
+    deflate_state *s;
+
+public:
+    void SetUp(const ::benchmark::State&) {
+        s = (deflate_state*)zng_alloc_aligned(sizeof(deflate_state), 64);
+        memset(s, 0, sizeof(deflate_state));
+
+        // Set up window parameters
+        s->w_size = MAX_WSIZE;
+        s->window_size = TEST_WINDOW_SIZE;
+
+        // Allocate window
+        s->window = (uint8_t*)zng_alloc_aligned(TEST_WINDOW_SIZE, 64);
+
+        // Allocate hash tables
+        s->head = (Pos*)zng_alloc_aligned(HASH_SIZE * sizeof(Pos), 64);
+        s->prev = (Pos*)zng_alloc_aligned(MAX_WSIZE * sizeof(Pos), 64);
+
+        // Initialize hash tables
+        memset(s->head, 0, HASH_SIZE * sizeof(Pos));
+        memset(s->prev, 0, MAX_WSIZE * sizeof(Pos));
+
+        // Initialize rolling hash state for rolling variant
+        s->ins_h = 0;
+
+        // Fill window with deterministic data patterns
+        for (size_t i = 0; i < TEST_WINDOW_SIZE; i++) {
+            // Create patterns that will exercise the hash function well
+            s->window[i] = (uint8_t)((i * 17 + (i >> 4) * 31 + (i >> 8) * 13) & 0xFF);
+        }
+    }
+
+    void TearDown(const ::benchmark::State&) {
+        zng_free_aligned(s->window);
+        zng_free_aligned(s->head);
+        zng_free_aligned(s->prev);
+        zng_free_aligned(s);
+    }
+};
+
+class insert_string_bench: public insert_string_base {
+public:
+    void Bench(benchmark::State& state, insert_string_cb insert_func) {
+        uint32_t str_pos = (uint32_t)state.range(0);  // Starting position
+        uint32_t count = (uint32_t)state.range(1);    // Number of strings to insert
+
+        // Ensure we don't go beyond window bounds
+        if (str_pos + count >= TEST_WINDOW_SIZE - 4) {
+            state.SkipWithError("Parameters exceed window size");
+            return;
+        }
+
+        for (auto _ : state) {
+            state.PauseTiming();
+
+            // Reset hash tables to ensure consistent starting state
+            memset(s->head, 0, HASH_SIZE * sizeof(Pos));
+            memset(s->prev, 0, MAX_WSIZE * sizeof(Pos));
+            s->ins_h = 0;
+
+            state.ResumeTiming();
+
+            // Benchmark the insert_string function
+            insert_func(s, str_pos, count);
+        }
+    }
+};
+
+#define BENCHMARK_INSERT_STRING(name, fptr, support_flag) \
+    BENCHMARK_DEFINE_F(insert_string_bench, name)(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("Function " #name " not supported"); \
+        } \
+        Bench(state, fptr); \
+    } \
+    BENCHMARK_REGISTER_F(insert_string_bench, name) \
+        ->Args({100, 3})        /* Most common case */ \
+        ->Args({100, 4})        \
+        ->Args({100, 5})        \
+        ->Args({100, 7})        \
+        ->Args({100, 14})       /* Mid-range cluster */ \
+        ->Args({100, 32})       /* Transition point */ \
+        ->Args({100, 127})      /* Large cluster around powers of 2 */ \
+        ->Args({100, 255})      /* Near maximum observed values */ \
+        ->Unit(benchmark::kNanosecond);
+
+// Benchmark the standard integer hash variant
+BENCHMARK_INSERT_STRING(integer_hash, ::insert_string, 1);
+
+// Benchmark the rolling hash variant
+BENCHMARK_INSERT_STRING(rolling_hash, ::insert_string_roll, 1);
+
+// Additional benchmark class for quick_insert_string functions
+class quick_insert_string_bench: public insert_string_base {
+public:
+    void Bench(benchmark::State& state, quick_insert_string_cb quick_insert_func) {
+        uint32_t start_pos = (uint32_t)state.range(0);  // Starting position
+        uint32_t count = (uint32_t)state.range(1);      // Number of insertions
+
+        if (start_pos + count >= TEST_WINDOW_SIZE - 4) {
+            state.SkipWithError("Parameters exceed window size");
+            return;
+        }
+
+        for (auto _ : state) {
+            state.PauseTiming();
+
+            // Reset hash tables
+            memset(s->head, 0, HASH_SIZE * sizeof(Pos));
+            memset(s->prev, 0, MAX_WSIZE * sizeof(Pos));
+            s->ins_h = 0;
+
+            state.ResumeTiming();
+
+            // Benchmark quick_insert_string (single insertions)
+            for (uint32_t i = 0; i < count; i++) {
+                uint32_t result = quick_insert_func(s, start_pos + i);
+                benchmark::DoNotOptimize(result);
+            }
+        }
+    }
+};
+
+#define BENCHMARK_QUICK_INSERT_STRING(name, fptr, support_flag) \
+    BENCHMARK_DEFINE_F(quick_insert_string_bench, name)(benchmark::State& state) { \
+        if (!(support_flag)) { \
+            state.SkipWithError("Function " #name " not supported"); \
+        } \
+        Bench(state, fptr); \
+    } \
+    BENCHMARK_REGISTER_F(quick_insert_string_bench, name) \
+        ->Args({100, 1})        /* Single insertion (baseline) */ \
+        ->Args({100, 100})      /* 100 insertions (measure amortized cost) */ \
+        ->Args({16000, 100})    /* 100 insertions at mid window (different hash distribution) */ \
+        ->Unit(benchmark::kNanosecond);
+
+BENCHMARK_QUICK_INSERT_STRING(quick_integer_hash, ::quick_insert_string, 1);
+BENCHMARK_QUICK_INSERT_STRING(quick_rolling_hash, ::quick_insert_string_roll, 1);
diff --git a/test/benchmarks/benchmark_png_decode.cc b/test/benchmarks/benchmark_png_decode.cc
index c037976c..ce7c8f93 100644
--- a/test/benchmarks/benchmark_png_decode.cc
+++ b/test/benchmarks/benchmark_png_decode.cc
@@ -16,7 +16,7 @@ public:
         init_compressible(img_bytes, width*height);
     }
 
-    void SetUp(const ::benchmark::State& state) {
+    void SetUp(const ::benchmark::State&) {
         output_img_buf = (uint8_t*)malloc(IMWIDTH * IMHEIGHT * 3);
         assert(output_img_buf != NULL);
         init_img(output_img_buf, IMWIDTH, IMHEIGHT);
@@ -38,7 +38,7 @@ public:
         }
     }
 
-    void TearDown(const ::benchmark::State &state) {
+    void TearDown(const ::benchmark::State &) {
         free(output_img_buf);
         for (int i = 0; i < 10; ++i) {
             free(inpng[i].buf);
@@ -51,7 +51,7 @@ private:
     bool test_files_found = false;
 
 public:
-    void SetUp(const ::benchmark::State &state) {
+    void SetUp(const ::benchmark::State &) {
         output_img_buf = NULL;
         output_img_buf = (uint8_t*)malloc(IMWIDTH * IMHEIGHT * 3);
         /* Let's take all the images at different compression levels and jam their bytes into buffers */
diff --git a/test/benchmarks/benchmark_png_encode.cc b/test/benchmarks/benchmark_png_encode.cc
index f1c597d3..d5e25cbc 100644
--- a/test/benchmarks/benchmark_png_encode.cc
+++ b/test/benchmarks/benchmark_png_encode.cc
@@ -19,7 +19,7 @@ public:
         init_compressible(img_bytes, width * height);
     }
 
-    void SetUp(const ::benchmark::State& state) {
+    void SetUp(const ::benchmark::State&) {
         input_img_buf = (uint8_t*)malloc(IMWIDTH * IMHEIGHT * 3);
         outpng.buf = (uint8_t*)malloc(IMWIDTH * IMHEIGHT * 3);
         /* Using malloc rather than zng_alloc so that we can call realloc.
@@ -42,7 +42,7 @@ public:
         }
     }
 
-    void TearDown(const ::benchmark::State &state) {
+    void TearDown(const ::benchmark::State &) {
         free(input_img_buf);
         free(outpng.buf);
     }
diff --git a/test/benchmarks/benchmark_slidehash.cc b/test/benchmarks/benchmark_slidehash.cc
index e51aa685..e74c06e8 100644
--- a/test/benchmarks/benchmark_slidehash.cc
+++ b/test/benchmarks/benchmark_slidehash.cc
@@ -24,17 +24,26 @@ private:
     deflate_state *s_g;
 
 public:
-    void SetUp(const ::benchmark::State& state) {
-        l0 = (uint16_t *)zng_alloc(HASH_SIZE * sizeof(uint16_t));
+    /**
+     * @brief Prepare the benchmark fixture by allocating and initializing working data.
+     *
+     * Allocates two 64-byte-aligned arrays of `uint16_t` (one of size HASH_SIZE, one of size MAX_RANDOM_INTS),
+     * fills them with pseudorandom `uint16_t` values, allocates a `deflate_state` structure, and sets
+     * its `head` and `prev` pointers to the allocated arrays.
+     *
+     * @param state Benchmark-provided state object from Google Benchmark (supplied by the framework).
+     */
+    void SetUp(const ::benchmark::State&) {
+        l0 = (uint16_t *)zng_alloc_aligned(HASH_SIZE * sizeof(uint16_t), 64);
 
         for (uint32_t i = 0; i < HASH_SIZE; i++) {
-            l0[i] = rand();
+            l0[i] = (uint16_t)rand();
         }
 
-        l1 = (uint16_t *)zng_alloc(MAX_RANDOM_INTS * sizeof(uint16_t));
+        l1 = (uint16_t *)zng_alloc_aligned(MAX_RANDOM_INTS * sizeof(uint16_t), 64);
 
         for (int32_t i = 0; i < MAX_RANDOM_INTS; i++) {
-            l1[i] = rand();
+            l1[i] = (uint16_t)rand();
         }
 
         deflate_state *s = (deflate_state*)malloc(sizeof(deflate_state));
@@ -52,22 +61,25 @@ public:
         }
     }
 
-    void TearDown(const ::benchmark::State& state) {
-        zng_free(l0);
-        zng_free(l1);
+    void TearDown(const ::benchmark::State&) {
+        zng_free_aligned(l0);
+        zng_free_aligned(l1);
+        free(s_g);
     }
 };
 
 #define BENCHMARK_SLIDEHASH(name, fptr, support_flag) \
     BENCHMARK_DEFINE_F(slide_hash, name)(benchmark::State& state) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             state.SkipWithError("CPU does not support " #name); \
         } \
         Bench(state, fptr); \
     } \
-    BENCHMARK_REGISTER_F(slide_hash, name)->RangeMultiplier(2)->Range(1024, MAX_RANDOM_INTS);
+    BENCHMARK_REGISTER_F(slide_hash, name)->RangeMultiplier(2)->Range(512, MAX_RANDOM_INTS);
 
+#if defined(WITH_ALL_FALLBACKS) || !(defined(__x86_64__) || defined(_M_X64))
 BENCHMARK_SLIDEHASH(c, slide_hash_c, 1);
+#endif
 
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 BENCHMARK_SLIDEHASH(native, native_slide_hash, 1);
@@ -94,5 +106,11 @@ BENCHMARK_SLIDEHASH(sse2, slide_hash_sse2, test_cpu_features.x86.has_sse2);
 #ifdef X86_AVX2
 BENCHMARK_SLIDEHASH(avx2, slide_hash_avx2, test_cpu_features.x86.has_avx2);
 #endif
-
+#ifdef LOONGARCH_LSX
+BENCHMARK_SLIDEHASH(lsx, slide_hash_lsx, test_cpu_features.loongarch.has_lsx);
 #endif
+#ifdef LOONGARCH_LASX
+BENCHMARK_SLIDEHASH(lasx, slide_hash_lasx, test_cpu_features.loongarch.has_lasx);
+#endif
+
+#endif
\ No newline at end of file
diff --git a/test/benchmarks/benchmark_uncompress.cc b/test/benchmarks/benchmark_uncompress.cc
new file mode 100644
index 00000000..d6f31bc6
--- /dev/null
+++ b/test/benchmarks/benchmark_uncompress.cc
@@ -0,0 +1,97 @@
+/* benchmark_uncompress.cc -- benchmark uncompress()
+ * Copyright (C) 2024-2025 Hans Kristian Rosbach
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include <stdio.h>
+#include <assert.h>
+#include <benchmark/benchmark.h>
+
+extern "C" {
+#  include "zbuild.h"
+#  include "zutil_p.h"
+#  if defined(ZLIB_COMPAT)
+#    include "zlib.h"
+#  else
+#    include "zlib-ng.h"
+#  endif
+#  include "compressible_data_p.h"
+}
+
+#define MAX_SIZE (1024 * 1024)
+#define NUM_TESTS 6
+
+class uncompress_bench: public benchmark::Fixture {
+private:
+    uint8_t *inbuff;
+    uint8_t *outbuff;
+    uint8_t *compressed_buff[NUM_TESTS];
+    z_uintmax_t compressed_sizes[NUM_TESTS];
+    uint32_t sizes[NUM_TESTS] = {1, 64, 1024, 16384, 128*1024, 1024*1024};
+
+public:
+    void SetUp(::benchmark::State& state) {
+        outbuff = (uint8_t *)malloc(MAX_SIZE + 16);
+        if (outbuff == NULL) {
+            state.SkipWithError("malloc failed");
+            return;
+        }
+
+        // Initialize input buffer with highly compressible data, interspersed
+        // with small amounts of random data and 3-byte matches.
+        inbuff = gen_compressible_data(MAX_SIZE);
+        if (inbuff == NULL) {
+            free(outbuff);
+            outbuff = NULL;
+            state.SkipWithError("gen_compressible_data() failed");
+            return;
+        }
+
+        // Compress data into different buffers
+        for (int i = 0; i < NUM_TESTS; ++i) {
+            compressed_buff[i] = (uint8_t *)zng_alloc(sizes[i] + 64);
+            assert(compressed_buff[i] != NULL);
+
+            z_uintmax_t compressed_size = sizes[i] + 64;
+            int err = PREFIX(compress2)(compressed_buff[i], &compressed_size, inbuff, sizes[i], Z_BEST_COMPRESSION);
+            if (err != Z_OK) {
+                fprintf(stderr, "compress() failed with error %d\n", err);
+                abort();
+            }
+            compressed_sizes[i] = compressed_size;
+        }
+    }
+
+    void Bench(benchmark::State& state) {
+        int err;
+
+        for (auto _ : state) {
+            int index = 0;
+            while (sizes[index] != (uint32_t)state.range(0)) ++index;
+
+            z_uintmax_t out_size = MAX_SIZE;
+            err = PREFIX(uncompress)(outbuff, &out_size, compressed_buff[index], compressed_sizes[index]);
+            if (err != Z_OK) {
+                fprintf(stderr, "uncompress() failed with error %d\n", err);
+                abort();
+            }
+        }
+    }
+
+    void TearDown(const ::benchmark::State&) {
+        free(inbuff);
+        free(outbuff);
+
+        for (int i = 0; i < NUM_TESTS; ++i) {
+            zng_free(compressed_buff[i]);
+        }
+    }
+};
+
+#define BENCHMARK_UNCOMPRESS(name) \
+    BENCHMARK_DEFINE_F(uncompress_bench, name)(benchmark::State& state) { \
+        Bench(state); \
+    } \
+    BENCHMARK_REGISTER_F(uncompress_bench, name)->Arg(1)->Arg(64)->Arg(1024)->Arg(16<<10)->Arg(128<<10)->Arg(1024<<10);
+
+BENCHMARK_UNCOMPRESS(uncompress_bench);
diff --git a/test/benchmarks/compressible_data_p.h b/test/benchmarks/compressible_data_p.h
new file mode 100644
index 00000000..e345bb9c
--- /dev/null
+++ b/test/benchmarks/compressible_data_p.h
@@ -0,0 +1,54 @@
+/* compressible_data_p.h -- generate compressible data
+ * Copyright (C) 2025 Hans Kristian Rosbach
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#ifndef COMPRESSIBLE_DATA_P_H
+#define COMPRESSIBLE_DATA_P_H
+
+
+static inline size_t append_raw(uint8_t *dest, size_t size, const void *src, size_t len) {
+    if (len > size) len = size;
+    if (len == 0) return 0;
+    memcpy(dest, src, len);
+    return len;
+}
+static inline size_t append_str(uint8_t *dest, size_t size, const char *src) {
+    return append_raw(dest, size, src, strlen(src));
+}
+static inline size_t append_uint8_t(uint8_t *dest, size_t size, uint8_t src) {
+    return append_raw(dest, size, &src, 1);
+}
+
+// Alloc and initialize buffer with highly compressible data,
+// interspersed with small amounts of random data and 3-byte matches.
+static uint8_t *gen_compressible_data(size_t bufsize) {
+    const char teststr1[42] = "Hello hello World broken Test tast mello.";
+    const char teststr2[32] = "llollollollollo He Te me orld";
+    const char teststr3[4] = "bro";
+    int loops = 0;
+
+    uint8_t *buffer = (uint8_t *)malloc(bufsize);
+    if (buffer == NULL) {
+        return NULL;
+    }
+
+    for (size_t pos = 0; pos < bufsize; ) {
+        pos += append_str(buffer+pos, bufsize-pos, teststr1);
+        pos += append_uint8_t(buffer+pos, bufsize-pos, (uint8_t)(rand() & 0xFF));
+        // Every so often, add a few other little bits to break the pattern
+        if (loops % 13 == 0) {
+            pos += append_str(buffer+pos, bufsize-pos, teststr3);
+            pos += append_uint8_t(buffer+pos, bufsize-pos, (uint8_t)(rand() & 0xFF));
+        }
+        if (loops % 300 == 0) { // Only found once or twice per window
+            pos += append_str(buffer+pos, bufsize-pos, teststr2);
+        }
+        loops++;
+    }
+    if (bufsize > 0) {
+        buffer[bufsize-1] = 0;
+    }
+    return buffer;
+}
+#endif
diff --git a/test/example.c b/test/example.c
index f52cad42..fd62bd5d 100644
--- a/test/example.c
+++ b/test/example.c
@@ -74,7 +74,7 @@ static void test_gzio(const char *fname, unsigned char *uncompr, z_size_t uncomp
 #ifdef NO_GZCOMPRESS
     fprintf(stderr, "NO_GZCOMPRESS -- gz* functions cannot compress\n");
 #else
-    int err;
+    z_int32_t err;
     size_t read;
     size_t len = strlen(hello)+1;
     gzFile file;
@@ -420,7 +420,7 @@ static void test_flush(unsigned char *compr, z_uintmax_t *comprLen) {
     *comprLen = (z_size_t)c_stream.total_out;
 }
 
-#ifdef ZLIBNG_ENABLE_TESTS
+#ifndef TEST_STOCK_ZLIB
 /* ===========================================================================
  * Test inflateSync()
  * We expect a certain compressed block layout, so skip this with the original zlib.
@@ -653,7 +653,7 @@ static void test_deflate_get_dict(unsigned char *compr, size_t comprLen) {
     PREFIX3(stream) c_stream; /* compression stream */
     int err;
     unsigned char *dictNew = NULL;
-    unsigned int *dictLen;
+    z_uint32_t *dictLen;
 
     c_stream.zalloc = zalloc;
     c_stream.zfree = zfree;
@@ -674,7 +674,7 @@ static void test_deflate_get_dict(unsigned char *compr, size_t comprLen) {
         error("deflate should report Z_STREAM_END\n");
 
     dictNew = calloc(256, 1);
-    dictLen = (unsigned int *)calloc(4, 1);
+    dictLen = (z_uint32_t *)calloc(4, 1);
     err = PREFIX(deflateGetDictionary)(&c_stream, dictNew, dictLen);
 
     CHECK_ERR(err, "deflateGetDictionary");
@@ -695,8 +695,8 @@ static void test_deflate_get_dict(unsigned char *compr, size_t comprLen) {
 static void test_deflate_pending(unsigned char *compr, size_t comprLen) {
     PREFIX3(stream) c_stream; /* compression stream */
     int err;
-    int *bits = calloc(256, 1);
-    unsigned *ped = calloc(256, 1);
+    z_int32_t *bits = calloc(256, 1);
+    z_uint32_t *ped = calloc(256, 1);
     size_t len = strlen(hello)+1;
 
 
@@ -979,7 +979,7 @@ int main(int argc, char *argv[]) {
 #endif
 
     test_flush(compr, &comprLen);
-#ifdef ZLIBNG_ENABLE_TESTS
+#ifndef TEST_STOCK_ZLIB
     test_sync(compr, comprLen, uncompr, uncomprLen);
 #endif
     comprLen = uncomprLen;
diff --git a/test/fuzz/CMakeLists.txt b/test/fuzz/CMakeLists.txt
index 27a04c0e..a02f57d2 100644
--- a/test/fuzz/CMakeLists.txt
+++ b/test/fuzz/CMakeLists.txt
@@ -1,8 +1,6 @@
-cmake_minimum_required(VERSION 3.5.1)
+cmake_minimum_required(VERSION 3.14...4.2.1)
 
 if(CMAKE_C_COMPILER_ID MATCHES "Clang")
-    enable_language(CXX)
-
     if(DEFINED ENV{LIB_FUZZING_ENGINE})
         set(FUZZING_ENGINE $ENV{LIB_FUZZING_ENGINE})
         set(FUZZING_ENGINE_FOUND ON)
@@ -32,18 +30,16 @@ foreach(FUZZER ${FUZZERS})
     endif()
 
     if(NOT DEFINED BUILD_SHARED_LIBS)
-        target_link_libraries(${FUZZER} zlibstatic)
+        target_link_libraries(${FUZZER} zlib-ng-static)
     else()
-        target_link_libraries(${FUZZER} zlib)
+        target_link_libraries(${FUZZER} zlib-ng)
     endif()
 
     if(FUZZING_ENGINE_FOUND)
         target_link_libraries(${FUZZER} ${FUZZING_ENGINE})
     endif()
 
-    if(ZLIB_ENABLE_TESTS)
-        file(GLOB FUZZER_TEST_FILES ${PROJECT_SOURCE_DIR}/*)
-        set(FUZZER_COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:${FUZZER}> ${FUZZER_TEST_FILES})
-        add_test(NAME ${FUZZER} COMMAND ${FUZZER_COMMAND})
-    endif()
+    file(GLOB FUZZER_TEST_FILES ${PROJECT_SOURCE_DIR}/*)
+    set(FUZZER_COMMAND ${CMAKE_CROSSCOMPILING_EMULATOR} $<TARGET_FILE:${FUZZER}> ${FUZZER_TEST_FILES})
+    add_test(NAME ${FUZZER} COMMAND ${FUZZER_COMMAND})
 endforeach()
diff --git a/test/fuzz/fuzzer_compress.c b/test/fuzz/fuzzer_compress.c
index 71cdf99e..2eca0382 100644
--- a/test/fuzz/fuzzer_compress.c
+++ b/test/fuzz/fuzzer_compress.c
@@ -11,8 +11,8 @@
 static const uint8_t *data;
 static size_t dataLen;
 
-static void check_compress_level(uint8_t *compr, z_size_t comprLen,
-                                 uint8_t *uncompr, z_size_t uncomprLen,
+static void check_compress_level(uint8_t *compr, z_uintmax_t comprLen,
+                                 uint8_t *uncompr, z_uintmax_t uncomprLen,
                                  int level) {
     PREFIX(compress2)(compr, &comprLen, data, dataLen, level);
     PREFIX(uncompress)(uncompr, &uncomprLen, compr, comprLen);
@@ -37,7 +37,7 @@ static void write_zlib_header(uint8_t *s) {
     put_byte(s, 1, (header & 0xff));
 }
 
-static void check_decompress(uint8_t *compr, size_t comprLen) {
+static void check_decompress(uint8_t *compr, z_uintmax_t comprLen) {
     /* We need to write a valid zlib header of size two bytes. Copy the input data
        in a larger buffer. Do not modify the input data to avoid libFuzzer error:
        fuzz target overwrites its const input. */
@@ -46,7 +46,7 @@ static void check_decompress(uint8_t *compr, size_t comprLen) {
     memcpy(copy + 2, data, dataLen);
     write_zlib_header(copy);
 
-    PREFIX(uncompress)(compr, &comprLen, copy, copyLen);
+    PREFIX(uncompress)(compr, &comprLen, copy, (z_uintmax_t)copyLen);
     free(copy);
 }
 
diff --git a/test/fuzz/fuzzer_minigzip.c b/test/fuzz/fuzzer_minigzip.c
index fbbe19c3..6e388819 100644
--- a/test/fuzz/fuzzer_minigzip.c
+++ b/test/fuzz/fuzzer_minigzip.c
@@ -302,7 +302,9 @@ int LLVMFuzzerTestOneInput(const uint8_t *data, size_t dataLen) {
         }
         if (len == 0)
             break;
-        assert(0 == memcmp(data + offset, buf, len));
+        int c = memcmp(data + offset, buf, len);
+        assert(0 == c);
+        Z_UNUSED(c); // in Release build, assert() is a no-op.
         offset += len;
     }
 
diff --git a/test/hash_test_strings_p.h b/test/hash_test_strings_p.h
new file mode 100644
index 00000000..447d1a64
--- /dev/null
+++ b/test/hash_test_strings_p.h
@@ -0,0 +1,375 @@
+#ifndef HASH_TEST_STRINGS_P_H
+#define HASH_TEST_STRINGS_P_H
+
+#define HASH_TEST_MAX_LENGTH 615336U
+
+ALIGNED_(16) static uint8_t hash_fullwin_buf[HASH_TEST_MAX_LENGTH];
+
+static uint8_t* hash_setup_big_buf() {
+    for (size_t i = 0; i < HASH_TEST_MAX_LENGTH; ++i) {
+        uint8_t ic = (uint8_t)(i % 256);
+        hash_fullwin_buf[i] = ic;
+    }
+
+    return hash_fullwin_buf;
+}
+
+static uint8_t *big_test = hash_setup_big_buf();
+
+static const uint8_t long_string[5552] = {
+    'q','j','d','w','q','4','8','m','B','u','k','J','V','U','z','V','V','f','M','j','i','q','S','W','L','5','G','n','F','S','P','Q',
+    'Q','D','i','6','m','E','9','Z','a','A','P','h','9','d','r','b','5','t','X','U','U','L','w','q','e','k','E','H','6','W','7','k',
+    'A','x','N','Q','R','k','d','V','5','y','n','U','N','W','Q','Y','i','W','5','9','R','p','D','C','x','p','u','h','C','a','m','r',
+    'z','n','z','A','d','J','6','u','N','e','r','x','7','Q','3','v','V','h','H','S','H','S','f','K','f','e','E','T','9','J','f','K',
+    'w','t','x','J','2','y','7','B','x','X','X','p','G','b','T','g','3','k','U','6','E','Z','M','t','J','q','v','n','S','T','6','x',
+    '5','x','4','P','z','p','M','F','V','b','d','m','f','G','n','J','m','w','z','K','8','a','q','E','D','e','b','3','h','B','V','g',
+    'y','3','P','L','5','8','r','z','X','b','Q','g','H','7','L','c','Z','B','3','C','4','y','t','u','k','z','h','v','C','Y','p','p',
+    '8','H','v','5','X','w','4','L','R','V','V','4','U','C','8','4','T','E','a','N','Z','S','7','U','u','z','f','H','p','P','J','u',
+    'Y','Z','h','T','6','e','v','z','V','F','h','u','y','H','b','k','J','M','f','3','6','g','y','L','E','W','t','B','B','d','d','9',
+    'u','M','Z','k','F','G','f','h','q','k','5','k','f','r','M','7','c','M','7','y','n','u','8','b','d','7','Q','f','E','m','F','K',
+    'x','W','f','B','2','F','8','5','q','z','y','3','R','i','U','m','X','k','h','N','J','y','B','C','h','u','x','4','f','k','J','5',
+    '6','X','T','W','h','8','J','4','m','K','p','N','3','g','C','g','A','E','e','Z','x','A','P','2','E','4','t','Q','5','X','Y','j',
+    '6','m','b','h','G','a','v','6','t','v','6','C','M','G','P','u','B','C','A','V','b','2','9','d','2','c','5','a','b','X','w','V',
+    'G','6','a','7','c','8','G','6','K','U','Q','m','w','P','V','5','N','x','b','v','x','E','N','C','A','N','t','v','N','B','z','X',
+    'B','R','q','U','n','i','A','Q','d','m','a','D','7','Y','f','3','J','8','Y','m','w','Z','b','w','r','H','q','E','j','c','u','E',
+    'i','i','S','b','n','G','P','a','F','j','c','R','D','D','G','F','v','i','a','i','M','7','B','e','w','m','L','E','F','2','Y','4',
+    '4','7','Y','C','t','y','q','7','2','V','G','m','m','E','e','V','u','m','L','p','R','X','W','z','V','K','E','k','p','V','r','J',
+    'd','N','3','t','i','u','S','V','w','2','w','U','Q','3','F','q','4','h','q','k','B','7','R','X','B','F','Q','Z','b','b','4','E',
+    'K','v','T','B','w','k','V','C','x','d','K','g','N','S','u','k','p','9','z','w','c','y','U','M','V','E','2','Y','P','F','h','9',
+    'T','y','h','w','b','9','P','w','G','c','W','W','k','j','J','Q','N','B','U','G','6','9','U','b','v','a','N','9','N','C','G','n',
+    'x','R','6','9','Q','C','h','e','j','P','U','h','U','R','i','4','T','B','W','5','w','m','J','p','e','7','r','9','t','c','9','Z',
+    'j','p','r','F','C','e','U','P','x','T','A','N','7','6','a','i','y','e','w','F','C','X','H','Y','G','C','q','q','m','A','t','7',
+    'z','u','D','S','L','U','C','f','7','e','t','G','V','F','u','c','x','5','M','7','N','i','M','6','h','2','n','H','S','h','K','M',
+    'd','T','z','X','d','x','x','4','q','z','d','D','a','2','X','r','p','r','R','m','U','U','y','S','H','c','a','F','e','Z','a','U',
+    'P','9','V','J','e','q','j','Y','M','x','e','v','K','7','M','P','N','2','b','6','f','P','h','H','4','U','X','k','n','f','Q','M',
+    '9','9','a','J','N','e','w','y','f','F','P','p','a','F','Y','a','M','L','W','i','T','M','B','3','U','v','X','v','G','p','7','a',
+    'f','u','4','S','y','X','9','g','g','b','B','G','c','i','M','U','n','m','a','7','q','f','9','n','Q','2','V','L','6','e','T','R',
+    '2','4','9','d','6','Q','B','Y','q','2','4','9','G','Q','E','b','Y','5','u','2','T','Q','G','L','5','n','4','Y','2','y','G','F',
+    'j','c','8','M','G','L','e','3','a','N','v','A','A','W','t','R','S','2','i','D','R','8','j','d','Q','3','6','C','V','M','e','w',
+    'j','U','Z','w','M','4','b','m','8','J','P','Q','L','P','R','c','r','b','V','C','3','N','8','K','4','d','W','D','N','U','A','A',
+    '2','J','p','b','D','d','p','j','N','C','k','A','j','B','a','c','u','v','L','X','U','B','4','U','X','W','e','C','b','C','u','d',
+    'A','v','U','z','P','t','D','e','5','y','Y','c','x','K','4','7','j','e','e','D','M','5','K','B','Q','6','d','p','T','T','R','j',
+    'M','E','E','M','r','N','6','8','7','q','x','F','S','x','E','U','4','d','B','6','5','W','C','e','m','J','e','5','j','w','V','J',
+    'w','v','d','7','v','f','K','u','m','8','h','W','T','e','Q','j','M','8','R','Y','d','B','R','2','r','F','j','7','d','E','q','V',
+    'k','e','j','P','9','3','X','R','p','R','b','A','v','7','4','A','M','2','k','r','E','7','X','3','7','k','5','c','B','7','W','5',
+    'u','J','B','Q','R','2','V','7','h','Q','h','9','g','G','y','c','c','x','M','z','7','G','2','J','w','v','j','5','9','E','b','k',
+    'z','W','T','C','b','4','K','R','X','T','k','V','S','G','2','j','d','6','y','E','4','P','H','K','w','a','m','F','Z','x','9','j',
+    'i','2','d','X','u','a','4','a','M','z','8','p','p','z','g','t','H','5','Y','L','Q','c','R','F','m','E','n','G','X','d','f','7',
+    'x','8','j','g','J','z','D','S','a','S','h','y','5','h','Y','N','p','w','Y','W','h','E','N','v','8','Q','D','W','Z','k','f','e',
+    'r','Z','D','7','R','D','T','2','H','X','z','G','X','f','v','E','z','P','v','U','H','e','4','R','W','U','x','t','t','4','w','p',
+    'r','z','K','9','f','g','h','P','r','f','v','k','h','c','e','5','8','a','L','F','J','M','G','R','a','N','q','S','g','W','e','7',
+    'R','K','R','A','B','z','6','v','S','p','w','n','e','x','k','E','r','j','f','Y','x','8','9','z','e','T','6','E','G','v','9','f',
+    'D','A','N','v','y','U','7','D','M','2','E','5','W','G','6','b','9','q','g','Y','F','f','k','q','Q','E','x','Y','C','R','G','6',
+    'R','h','4','J','d','U','D','b','9','b','8','r','f','V','d','g','b','2','z','Z','d','m','X','v','j','Y','d','w','K','8','G','r',
+    'v','j','N','y','c','h','u','5','z','g','J','H','a','Z','b','z','G','C','r','P','f','y','P','6','F','P','h','7','9','w','7','y',
+    'R','3','n','E','h','G','D','4','m','Y','E','q','k','a','f','a','R','B','q','t','W','E','T','p','H','7','k','X','2','d','X','6',
+    'W','n','H','m','w','M','i','Y','M','E','F','5','R','p','p','y','c','b','q','R','9','Y','t','T','7','w','u','K','M','Q','z','n',
+    'P','7','g','x','6','R','4','x','N','v','w','M','6','j','K','v','7','a','Y','4','a','M','6','n','z','3','E','2','V','N','4','i',
+    'E','f','u','W','J','W','e','8','3','Q','e','a','F','P','c','3','P','k','i','z','d','q','m','q','M','a','d','8','D','3','F','M',
+    'e','d','E','j','z','V','e','d','z','H','D','J','8','X','g','E','i','u','c','7','A','w','S','J','2','A','e','8','r','q','C','m',
+    '9','9','a','g','2','y','y','P','M','e','8','3','T','r','m','8','j','v','r','p','M','Z','Y','g','a','9','2','d','H','B','m','9',
+    '4','6','a','Z','V','u','S','H','g','3','X','h','i','N','3','B','S','E','k','9','k','2','9','R','A','i','3','L','X','M','B','S',
+    '4','S','F','F','F','w','u','d','M','T','9','K','B','7','R','U','R','8','D','8','T','5','U','t','E','R','x','n','x','h','v','k',
+    'B','N','k','E','U','T','t','p','r','u','Z','h','t','E','4','i','P','z','f','z','q','M','p','f','A','K','2','D','t','j','f','c',
+    'Y','E','N','M','x','k','g','7','T','U','2','c','d','V','g','2','z','L','i','j','Y','q','b','T','A','y','v','a','t','N','5','t',
+    'Z','5','n','D','a','y','G','n','P','x','V','k','M','8','t','J','Z','G','g','5','9','R','h','P','P','J','N','X','p','G','J','p',
+    '2','y','A','v','d','G','U','z','3','V','M','y','q','U','N','M','Y','p','B','Z','U','h','j','q','z','q','x','w','7','d','J','Q',
+    'u','F','q','3','m','9','c','Q','W','d','6','7','b','V','M','7','P','j','r','k','9','h','R','z','m','b','i','B','u','E','L','9',
+    'k','v','h','h','W','2','K','e','M','U','Q','p','A','Q','Y','J','G','E','T','U','L','f','q','G','4','z','K','K','y','a','U','W',
+    'K','D','P','c','N','D','V','S','Y','6','T','p','R','y','y','J','a','T','J','W','Q','9','p','F','P','X','y','k','9','z','z','4',
+    'G','d','a','z','X','n','h','4','J','P','W','V','D','r','U','m','a','8','a','b','X','F','J','X','L','4','S','X','5','W','p','W',
+    'h','y','x','B','f','d','C','X','w','7','r','g','V','T','H','a','i','4','N','v','c','w','n','2','3','A','i','A','J','9','N','c',
+    'z','7','n','n','3','n','h','n','i','R','i','b','E','h','k','U','c','c','U','6','f','x','q','N','y','H','M','e','J','B','U','B',
+    'r','g','a','8','V','a','G','V','y','u','c','c','v','C','H','W','y','g','z','Q','2','4','k','S','m','f','e','G','H','v','Q','3',
+    'P','e','f','S','V','P','c','U','e','3','P','x','d','c','7','c','f','g','D','w','2','t','q','y','g','2','Q','V','4','K','a','Q',
+    'g','B','b','L','x','9','m','a','K','4','i','x','g','Q','M','9','W','N','2','w','p','v','2','k','B','y','9','k','A','c','f','Z',
+    'D','R','A','S','d','v','w','f','f','q','t','K','3','j','x','D','G','P','n','u','r','v','U','k','A','2','d','R','N','T','G','4',
+    'B','g','k','t','h','7','J','k','F','A','C','g','W','g','J','F','z','S','Q','c','v','M','b','D','e','H','Q','S','j','v','G','E',
+    'R','k','f','i','P','E','F','N','6','y','p','b','t','M','c','Q','B','7','g','w','J','7','3','d','V','E','m','z','6','6','P','P',
+    'd','i','r','J','H','D','H','J','r','b','n','v','z','W','e','u','g','B','u','Z','2','m','D','5','h','F','X','B','2','r','6','w',
+    'u','Y','4','N','X','K','a','v','V','3','j','B','r','r','C','c','w','R','g','S','8','V','b','F','2','N','M','c','K','8','Y','E',
+    'E','N','K','X','K','V','B','x','n','Q','p','a','q','f','k','t','z','Y','E','P','Z','y','n','a','c','B','V','a','x','b','d','X',
+    'r','d','8','P','H','F','v','r','V','5','g','J','w','6','i','h','d','d','p','J','c','c','Y','S','q','W','m','U','5','G','b','H',
+    'N','z','E','Z','K','E','y','M','c','G','i','d','w','Z','D','N','N','w','S','t','g','y','a','Y','b','H','e','M','N','f','Y','Y',
+    '7','a','9','b','M','U','k','a','V','k','C','n','a','k','U','H','A','M','i','v','k','t','a','d','i','3','F','d','5','2','A','p',
+    'U','c','J','U','R','h','G','d','A','Y','v','q','X','c','w','r','x','4','j','3','4','b','F','d','a','L','N','J','3','Z','g','6',
+    'W','Q','R','u','P','t','M','A','3','F','6','y','K','Y','G','2','t','v','u','p','w','b','G','S','K','5','p','4','d','E','w','6',
+    'g','t','V','4','b','2','n','b','Z','3','3','f','m','d','2','c','a','m','j','X','U','E','D','6','6','F','w','H','9','7','Z','Y',
+    'd','X','C','K','i','g','p','F','Y','n','2','b','F','4','R','u','V','k','f','d','J','i','a','b','X','H','7','v','K','a','Q','i',
+    'W','M','j','M','i','a','i','n','F','h','r','q','4','w','x','m','4','q','y','F','8','w','i','4','D','B','A','L','B','U','u','K',
+    'v','K','n','a','Q','i','e','k','v','Q','U','5','w','Q','c','r','A','6','M','w','y','g','n','e','v','K','7','W','u','2','y','f',
+    'Q','u','e','r','y','a','w','V','p','f','Q','z','C','u','i','i','9','S','P','q','L','r','C','H','S','3','E','p','8','S','m','Q',
+    'S','K','r','V','b','J','R','m','w','c','n','Q','N','Q','4','M','u','f','X','S','f','U','Z','x','U','4','j','K','4','G','z','X',
+    '7','Q','j','R','h','i','G','m','q','c','V','T','x','U','a','E','b','Q','q','E','i','F','K','7','K','i','R','J','5','Y','F','V',
+    'B','7','R','8','M','i','f','j','Z','w','j','b','B','u','p','N','Y','r','S','r','f','h','E','J','T','B','P','R','D','V','K','A',
+    'Z','A','R','j','z','f','B','i','Y','L','F','G','V','Y','w','R','C','P','G','m','9','7','C','5','e','y','w','N','K','N','a','Q',
+    'j','a','W','3','2','f','G','w','n','M','6','F','u','K','8','g','8','M','G','r','e','9','Z','z','y','2','G','U','k','G','6','m',
+    'A','D','4','n','b','8','a','q','S','m','S','6','5','R','5','D','5','S','B','g','X','T','8','Q','V','d','A','n','g','y','8','a',
+    'h','7','K','9','H','D','J','F','w','G','4','w','T','J','F','f','i','8','X','e','B','J','K','H','7','V','y','X','7','E','8','S',
+    'A','d','b','w','S','8','Y','a','J','d','j','E','V','J','T','E','U','R','5','7','V','M','E','v','D','3','z','5','r','k','z','v',
+    'e','m','A','7','P','8','j','X','E','f','Q','q','8','D','g','y','8','j','A','e','B','c','c','M','z','k','2','c','q','v','v','y',
+    'Q','y','h','g','p','v','M','m','m','C','G','D','k','8','u','T','n','Q','H','G','H','f','b','J','j','5','X','c','i','7','7','q',
+    'b','R','8','b','b','z','f','f','h','Y','Q','7','u','B','X','e','i','j','M','q','C','T','M','v','t','J','J','w','b','F','v','J',
+    'm','e','2','u','e','8','L','V','G','q','A','j','m','7','m','g','m','5','i','r','p','p','U','y','F','6','f','b','u','6','q','L',
+    'M','E','t','V','W','C','t','e','p','w','a','n','w','y','X','h','8','e','G','C','H','q','r','X','G','9','c','h','7','k','8','M',
+    'G','b','a','m','Y','Q','w','8','J','z','a','F','r','4','W','M','j','P','q','a','z','U','y','u','3','b','Z','f','Y','5','7','g',
+    'N','M','h','M','a','3','C','K','6','6','f','a','p','i','f','q','k','T','i','z','w','f','Z','c','H','L','X','g','6','m','g','r',
+    'w','Y','u','K','8','L','p','8','P','R','A','R','A','b','Z','V','a','x','V','c','G','A','H','t','Y','6','P','T','L','W','N','z',
+    'g','z','k','d','E','v','C','t','Z','M','Z','K','4','w','9','5','D','W','f','U','8','5','u','6','b','5','B','8','g','y','C','E',
+    'Q','z','e','9','p','N','S','P','D','D','f','x','k','Z','4','R','v','X','V','k','p','b','n','t','c','F','R','e','x','9','C','D',
+    'J','2','6','f','Z','D','w','J','R','j','j','9','b','w','N','N','p','R','f','Z','z','j','F','r','Q','e','F','x','f','t','V','V',
+    'A','y','J','G','W','Z','H','r','D','5','M','u','H','V','L','N','U','V','X','z','j','9','r','v','e','d','R','c','u','V','x','r',
+    'c','6','k','L','h','q','w','U','W','Q','g','G','F','C','t','E','a','D','h','x','9','5','P','R','Z','E','M','5','f','4','2','t',
+    'A','6','f','r','X','G','X','Y','B','8','G','E','n','B','v','x','f','M','R','f','B','z','Y','3','2','q','z','G','t','P','C','6',
+    '6','r','z','J','r','c','n','d','6','h','e','w','D','D','h','V','L','u','i','b','5','K','d','S','y','9','N','p','E','r','D','k',
+    'B','z','u','v','d','Q','p','K','5','m','J','r','b','Y','Z','7','p','M','J','F','E','q','x','f','E','K','U','U','4','f','a','6',
+    'g','5','a','q','D','U','8','F','y','R','a','P','5','5','x','z','6','V','T','P','D','m','y','7','U','5','C','A','7','Q','h','w',
+    'r','6','x','g','Q','i','b','K','F','p','B','X','Q','h','i','E','r','C','z','v','x','W','Q','6','p','6','b','M','K','V','x','u',
+    'k','d','R','S','k','Q','p','n','h','d','Q','Y','x','n','x','5','K','t','5','w','A','5','p','k','F','z','W','p','j','U','y','V',
+    'x','G','m','y','L','A','X','H','G','A','a','J','5','E','P','q','E','U','7','p','6','A','9','n','d','G','D','g','i','h','t','W',
+    'b','c','E','2','P','d','y','J','M','u','4','g','P','S','X','J','v','w','3','v','D','q','U','i','U','T','q','E','Y','5','2','t',
+    'b','j','P','2','j','D','9','y','i','B','5','Y','3','X','L','w','m','V','X','z','X','r','Z','d','H','L','A','H','k','R','X','5',
+    'i','L','m','q','3','p','a','G','P','j','g','h','R','P','Y','U','z','M','5','R','M','A','E','Q','V','c','w','r','4','M','S','k',
+    'N','D','i','R','R','x','t','q','T','i','u','N','K','R','x','Z','K','a','g','G','y','9','c','j','J','S','9','3','H','T','f','F',
+    'q','6','D','W','F','K','h','e','p','p','b','q','N','k','A','C','m','y','u','B','J','v','q','D','e','j','e','b','2','w','R','t',
+    'J','N','j','F','T','A','8','L','m','X','i','T','g','j','c','V','4','V','h','2','h','R','p','2','9','k','c','c','G','D','h','z',
+    't','i','h','t','W','R','n','Y','i','8','u','6','G','9','T','P','9','9','J','P','Y','R','h','X','K','z','h','L','W','r','C','U',
+    '2','L','T','k','2','m','6','W','L','P','T','Z','z','t','i','H','5','G','w','t','E','v','z','k','b','H','b','b','W','W','u','b',
+    'i','h','C','Q','n','H','N','u','5','u','K','X','r','M','W','U','3','Y','k','P','2','k','x','f','x','C','w','z','z','b','G','8',
+    'y','W','e','j','v','2','v','r','t','q','z','p','Y','d','w','6','Z','D','J','L','9','F','z','G','U','4','a','8','H','6','U','a',
+    'q','7','y','Q','J','v','m','D','P','S','j','q','v','t','n','t','g','j','3','t','8','f','K','K','7','b','W','d','F','i','N','K',
+    'a','R','V','V','V','v','m','A','Q','2','y','j','c','t','f','k','j','7','X','y','j','b','U','F','w','W','3','9','6','A','S','J',
+    'p','q','2','Z','7','L','p','b','7','b','5','i','p','r','r','h','P','M','h','j','c','y','e','u','h','B','d','9','9','u','f','d',
+    'g','u','p','w','u','9','S','c','L','U','g','A','y','V','F','V','6','D','D','X','i','V','m','u','Y','P','J','v','L','T','A','F',
+    'M','Q','H','Z','6','v','8','p','A','L','P','z','C','V','a','C','h','X','j','W','8','G','z','j','d','M','4','u','x','w','H','g',
+    'V','q','K','z','b','g','2','3','D','N','y','G','X','F','T','v','T','L','y','v','L','9','g','c','C','R','8','L','A','7','Y','N',
+    't','n','R','6','b','n','m','9','i','h','t','T','F','a','V','N','J','J','3','J','q','p','W','7','b','T','G','r','M','k','a','7',
+    'D','H','v','y','T','A','C','U','P','u','q','L','R','Y','4','q','h','y','f','F','J','x','K','7','N','B','v','3','a','Z','M','t',
+    'U','x','8','9','V','E','t','j','K','r','u','Y','Y','A','u','w','Y','2','y','Q','z','S','n','J','B','2','t','X','x','K','z','g',
+    '6','d','n','i','7','Z','N','F','Q','6','w','N','r','b','k','d','W','X','S','t','c','U','m','6','4','2','e','w','6','x','Z','a',
+    'Q','A','7','4','h','H','z','r','e','J','q','j','w','4','q','c','i','R','4','x','n','r','j','r','P','g','E','7','t','k','b','Z',
+    'r','A','b','d','g','i','G','V','D','E','U','L','b','J','U','q','2','S','K','m','A','U','L','k','Q','4','N','p','k','G','C','6',
+    'R','Z','B','y','B','B','j','y','x','L','d','h','L','G','6','x','H','z','T','5','d','Y','4','2','m','q','Q','y','H','6','c','N',
+    'u','m','U','v','i','Y','Z','7','4','L','K','F','b','v','2','Y','h','x','8','a','R','w','q','x','E','a','T','y','m','C','2','Q',
+    'U','T','D','Q','v','u','M','9','D','8','r','8','b','m','p','E','7','C','T','9','B','A','G','k','b','G','z','Z','G','L','N','k',
+    'h','3','k','J','e','f','d','x','F','8','W','K','7','T','6','h','H','V','C','h','P','u','H','e','v','w','z','P','K','r','D','G',
+    'X','Z','B','X','f','H','Q','4','e','D','y','W','Z','6','4','K','A','e','a','F','S','N','h','x','S','W','J','c','E','P','g','j',
+    'a','w','T','m','Z','X','E','P','Y','R','M','2','R','2','X','N','F','X','Y','W','x','z','p','J','g','n','D','4','i','p','6','N',
+    'r','9','G','k','E','h','T','h','U','h','x','B','Q','9','H','7','w','U','P','Q','d','G','6','q','p','j','j','v','C','a','X','J',
+    'N','G','Y','w','f','H','C','x','F','k','z','3','9','r','h','8','7','5','V','i','V','C','R','q','x','N','2','2','i','W','F','U',
+    '7','T','H','f','z','E','a','n','u','Q','t','U','Y','G','t','3','A','m','r','6','d','f','e','n','e','z','F','u','U','N','8','m',
+    'h','p','R','N','S','H','6','6','V','M','S','t','q','P','E','i','u','y','g','8','L','Q','Y','Y','G','e','W','W','C','G','y','b',
+    'y','t','u','P','R','P','5','m','N','K','B','Z','w','f','t','k','x','3','L','b','q','d','w','S','G','E','h','R','F','4','q','e',
+    '5','6','F','2','n','q','T','R','y','f','n','Y','h','2','F','u','x','M','i','i','h','w','G','C','Z','v','i','C','a','X','U','C',
+    'Y','8','d','h','R','x','V','n','v','G','i','D','a','U','p','U','a','e','b','F','w','P','d','X','n','K','h','9','H','r','b','g',
+    '2','f','m','X','k','m','q','6','n','5','b','G','H','d','R','9','D','U','c','r','Z','Y','W','S','Z','x','p','t','x','y','4','k',
+    'j','F','U','t','C','i','e','i','b','p','e','4','C','z','h','3','3','5','Q','P','n','G','i','A','8','c','Q','z','B','a','V','4',
+    '2','B','2','z','u','u','3','i','L','w','y','g','K','H','k','y','2','B','b','e','5','e','4','e','U','4','z','n','P','z','a','c',
+    'E','f','u','M','G','C','g','z','j','4','E','7','R','t','D','K','c','t','p','g','W','H','C','H','J','Q','J','c','F','5','4','W',
+    'K','7','j','h','A','T','K','z','t','S','f','f','j','C','c','8','n','7','c','T','U','R','Q','E','7','A','W','Z','z','K','5','j',
+    '2','H','k','a','j','g','g','W','w','4','T','A','9','J','U','e','S','N','P','K','d','k','L','Q','G','Z','e','W','i','H','u','j',
+    'C','z','4','E','2','v','5','L','u','9','Z','a','9','A','b','C','M','G','X','B','C','2','Y','Z','e','U','n','E','5','Y','n','y',
+    'F','h','H','p','9','j','Y','F','V','w','Y','r','8','Q','f','C','J','4','T','t','z','Q','N','M','e','7','4','3','y','E','M','m',
+    'b','S','c','h','w','a','X','E','d','E','z','t','h','9','k','p','A','k','K','H','x','q','K','Z','B','u','a','9','3','U','U','u',
+    '8','E','D','v','y','k','W','Y','X','k','r','R','D','X','n','Q','V','d','e','D','g','x','E','V','Y','w','k','m','K','r','H','D',
+    't','2','6','N','U','g','3','t','B','9','t','u','M','D','z','Y','K','z','K','r','V','5','i','e','p','M','d','t','w','6','a','f',
+    'f','W','k','L','i','g','M','V','M','Y','b','x','e','4','h','h','Y','g','w','Z','m','e','e','6','R','W','M','x','G','y','V','n',
+    '6','e','g','A','g','K','a','N','7','p','a','u','E','4','6','M','t','X','h','g','b','j','p','5','x','x','B','P','3','J','M','7',
+    'j','Z','P','y','e','Q','Z','e','t','j','3','t','F','V','x','m','b','b','B','y','J','L','L','9','3','R','a','5','j','S','V','t',
+    'e','2','6','m','H','w','r','w','r','6','Q','3','x','z','m','A','d','x','t','E','H','c','Z','x','c','P','j','r','u','U','W','k',
+    '6','g','X','g','n','f','n','7','H','M','B','t','v','6','v','x','g','M','f','e','2','w','m','y','d','H','S','q','c','K','U','H',
+    '2','X','h','d','p','Q','7','J','X','i','X','f','a','z','V','A','F','2','8','z','v','h','C','h','e','4','g','z','w','z','h','q',
+    'p','6','B','n','m','8','h','W','U','7','z','h','T','6','J','f','4','Z','n','Q','W','z','2','N','4','t','g','7','u','4','X','2',
+    'C','F','L','n','J','n','m','j','3','P','3','Y','e','J','R','A','H','e','R','D','z','7','u','X','Y','y','D','w','J','m','G','U',
+    'P','H','5','S','d','a','F','F','Y','c','M','f','3','3','L','v','V','B','U','C','A','d','N','H','Q','h','7','8','4','r','p','G',
+    'v','M','D','H','7','e','E','r','i','K','Q','i','B','D','M','Z','p','c','R','G','u','c','H','a','N','k','E','f','9','R','7','x',
+    '6','3','5','u','x','3','h','v','p','6','q','r','j','u','f','W','T','q','P','n','Y','L','B','6','U','w','P','2','T','W','R','g',
+    '2','3','3','e','N','V','a','j','b','e','4','T','u','J','u','u','F','B','D','G','H','x','x','k','5','G','e','3','4','B','m','L',
+    'S','b','i','t','T','p','M','D','Z','A','A','i','r','J','p','4','H','U','A','G','y','d','Q','5','U','R','F','8','q','a','S','H',
+    'n','5','z','9','g','3','u','R','H','m','G','m','b','p','c','L','Z','Y','u','m','i','K','A','Q','R','T','X','G','t','b','8','7',
+    '7','6','w','M','N','f','R','G','r','L','m','q','n','7','5','k','X','8','g','u','K','7','Y','w','K','q','U','e','W','A','r','i',
+    'Z','a','p','q','L','5','P','u','n','t','y','G','x','C','N','X','q','P','r','U','v','A','r','r','q','e','f','c','z','M','7','N',
+    '6','a','z','Z','a','t','f','p','4','v','J','Y','j','h','M','D','t','k','A','B','p','Q','A','y','x','X','7','p','S','8','m','M',
+    'y','K','B','A','5','2','7','b','y','R','K','q','A','u','3','J'};
+
+typedef struct {
+    uint32_t len;
+    const uint8_t *buf;
+    uint32_t initial_adler;
+    uint32_t expect_adler;
+    uint32_t initial_crc;
+    uint32_t expect_crc;
+} hash_test;
+
+static const hash_test hash_tests[] = {
+  {0, (const uint8_t *)"", 0x1, 0x1, 0x0, 0x0},
+  {1, (const uint8_t *)"", 0x1, 0x10001, 0x0, 0xd202ef8d},
+  {0, (const uint8_t *)"", 0xffffffff, 0x000e000e, 0xffffffff, 0xffffffff},
+  {1, (const uint8_t *)"a", 0x1, 0x00620062, 0x0, 0xe8b7be43},
+  {6, (const uint8_t *)"abacus", 0x1, 0x8400270, 0x0, 0xc3d7115b},
+  {7, (const uint8_t *)"backlog", 0x1, 0xb1f02d4, 0x0, 0x269205},
+  {8, (const uint8_t *)"campfire", 0x1, 0xea10348, 0x0, 0x22a515f8},
+  {5, (const uint8_t *)"delta", 0x1, 0x61a020b, 0x0, 0x9643fed9},
+  {10, (const uint8_t *)"executable", 0x1, 0x16fa0423, 0x0, 0xd68eda01},
+  {4, (const uint8_t *)"file", 0x1, 0x41401a1, 0x0, 0x8c9f3610},
+  {8, (const uint8_t *)"greatest", 0x1, 0xefa0360, 0x0, 0xc1abd6cd},
+  {5, (const uint8_t *)"hello", 0x1, 0x062c0215, 0x0, 0x3610a686},
+  {8, (const uint8_t *)"inverter", 0x1, 0xf6f0370, 0x0, 0xc9e962c9},
+  {6, (const uint8_t *)"jigsaw", 0x1, 0x8bd0286, 0x0, 0xce4e3f69},
+  {6, (const uint8_t *)"karate", 0x1, 0x8a50279, 0x0, 0x890be0e2},
+  {9, (const uint8_t *)"landscape", 0x1, 0x126a03ac, 0x0, 0xc4e0330b},
+  {7, (const uint8_t *)"machine", 0x1, 0xb5302d6, 0x0, 0x1505df84},
+  {9, (const uint8_t *)"nanometer", 0x1, 0x12d803ca, 0x0, 0xd4e19f39},
+  {8, (const uint8_t *)"oblivion", 0x1, 0xf220363, 0x0, 0xdae9de77},
+  {6, (const uint8_t *)"panama", 0x1, 0x8a1026f, 0x0, 0x66b8979c},
+  {5, (const uint8_t *)"quest", 0x1, 0x6970233, 0x0, 0x4317f817},
+  {8, (const uint8_t *)"resource", 0x1, 0xf8d0369, 0x0, 0xbc91f416},
+  {6, (const uint8_t *)"secret", 0x1, 0x8d10287, 0x0, 0x5ca2e8e5},
+  {4, (const uint8_t *)"test", 0x1, 0x045d01c1, 0x0, 0xd87f7e0c},
+  {8, (const uint8_t *)"ultimate", 0x1, 0xf8d0366, 0x0, 0x3fc79b0b},
+  {6, (const uint8_t *)"vector", 0x1, 0x8fb0294, 0x0, 0x1b6e485b},
+  {6, (const uint8_t *)"walrus", 0x1, 0x918029f, 0x0, 0xbe769b97},
+  {4, (const uint8_t *)"xeno", 0x1, 0x45e01bb, 0x0, 0xe7a06444},
+  {7, (const uint8_t *)"yelling", 0x1, 0xbfe02f5, 0x0, 0xfe3944e5},
+  {4, (const uint8_t *)"zero", 0x1, 0x046e01c1, 0x0, 0xabdef192},
+  {4, (const uint8_t *)"zlib", 0x1, 0x046401b2, 0x0, 0x73887d3a},
+  {20, (const uint8_t *)"4BJD7PocN1VqX0jXVpWB", 0x1, 0x3eef064d, 0x0, 0xd487a5a1},
+  {20, (const uint8_t *)"F1rPWI7XvDs6nAIRx41l", 0x1, 0x425d065f, 0x0, 0x61a0132e},
+  {20, (const uint8_t *)"ldhKlsVkPFOveXgkGtC2", 0x1, 0x4f1a073e, 0x0, 0xdf02f76},
+  {20, (const uint8_t *)"5KKnGOOrs8BvJ35iKTOS", 0x1, 0x42290650, 0x0, 0x579b2b0a},
+  {20, (const uint8_t *)"0l1tw7GOcem06Ddu7yn4", 0x1, 0x43fd0690, 0x0, 0xf7d16e2d},
+  {20, (const uint8_t *)"MCr47CjPIn9R1IvE1Tm5", 0x1, 0x3f770609, 0x0, 0x731788f5},
+  {20, (const uint8_t *)"UcixbzPKTIv0SvILHVdO", 0x1, 0x4c7c0703, 0x0, 0x7112bb11},
+  {20, (const uint8_t *)"dGnAyAhRQDsWw0ESou24", 0x1, 0x48ac06b7, 0x0, 0xf32a0dac},
+  {20, (const uint8_t *)"di0nvmY9UYMYDh0r45XT", 0x1, 0x489a0698, 0x0, 0x625437bb},
+  {20, (const uint8_t *)"2XKDwHfAhFsV0RhbqtvH", 0x1, 0x44a906e6, 0x0, 0x896930f9},
+  {20, (const uint8_t *)"ZhrANFIiIvRnqClIVyeD", 0x1, 0x4a29071c, 0x0, 0x8579a37},
+  {20, (const uint8_t *)"v7Q9ehzioTOVeDIZioT1", 0x1, 0x4a7706f9, 0x0, 0x632aa8e0},
+  {20, (const uint8_t *)"Yod5hEeKcYqyhfXbhxj2", 0x1, 0x4ce60769, 0x0, 0xc829af29},
+  {20, (const uint8_t *)"GehSWY2ay4uUKhehXYb0", 0x1, 0x48ae06e5, 0x0, 0x1b08b7e8},
+  {20, (const uint8_t *)"kwytJmq6UqpflV8Y8GoE", 0x1, 0x51d60750, 0x0, 0x4e33b192},
+  {20, (const uint8_t *)"70684206568419061514", 0x1, 0x2b100414, 0x0, 0x59a179f0},
+  {20, (const uint8_t *)"42015093765128581010", 0x1, 0x2a550405, 0x0, 0xcd1013d7},
+  {20, (const uint8_t *)"88214814356148806939", 0x1, 0x2b450423, 0x0, 0xab927546},
+  {20, (const uint8_t *)"43472694284527343838", 0x1, 0x2b460421, 0x0, 0x11f3b20c},
+  {20, (const uint8_t *)"49769333513942933689", 0x1, 0x2bc1042b, 0x0, 0xd562d4ca},
+  {20, (const uint8_t *)"54979784887993251199", 0x1, 0x2ccd043d, 0x0, 0x233395f7},
+  {20, (const uint8_t *)"58360544869206793220", 0x1, 0x2b68041a, 0x0, 0x2d167fd5},
+  {20, (const uint8_t *)"27347953487840714234", 0x1, 0x2b84041d, 0x0, 0x8b5108ba},
+  {20, (const uint8_t *)"07650690295365319082", 0x1, 0x2afa0417, 0x0, 0xc46b3cd8},
+  {20, (const uint8_t *)"42655507906821911703", 0x1, 0x2aff0412, 0x0, 0xc10b2662},
+  {20, (const uint8_t *)"29977409200786225655", 0x1, 0x2b8d0420, 0x0, 0xc9a0f9d2},
+  {20, (const uint8_t *)"85181542907229116674", 0x1, 0x2b140419, 0x0, 0x9341357b},
+  {20, (const uint8_t *)"87963594337989416799", 0x1, 0x2c8e043f, 0x0, 0xf0424937},
+  {20, (const uint8_t *)"21395988329504168551", 0x1, 0x2b68041f, 0x0, 0xd7c4c31f},
+  {20, (const uint8_t *)"51991013580943379423", 0x1, 0x2af10417, 0x0, 0xf11edcc4},
+  {30, (const uint8_t *)"*]+@!);({_$;}[_},?{?;(_?,=-][@", 0x1, 0x7c9d0841, 0x0, 0x40795df4},
+  {30, (const uint8_t *)"_@:_).&(#.[:[{[:)$++-($_;@[)}+", 0x1, 0x71060751, 0x0, 0xdd61a631},
+  {30, (const uint8_t *)"&[!,[$_==}+.]@!;*(+},[;:)$;)-@", 0x1, 0x7095070a, 0x0, 0xca907a99},
+  {30, (const uint8_t *)"]{.[.+?+[[=;[?}_#&;[=)__$$:+=_", 0x1, 0x82530815, 0x0, 0xf652deac},
+  {30, (const uint8_t *)"-%.)=/[@].:.(:,()$;=%@-$?]{%+%", 0x1, 0x61250661, 0x0, 0xaf39a5a9},
+  {30, (const uint8_t *)"+]#$(@&.=:,*];/.!]%/{:){:@(;)$", 0x1, 0x642006a3, 0x0, 0x6bebb4cf},
+  {30, (const uint8_t *)")-._.:?[&:.=+}(*$/=!.${;(=$@!}", 0x1, 0x674206cb, 0x0, 0x76430bac},
+  {30, (const uint8_t *)":(_*&%/[[}+,?#$&*+#[([*-/#;%(]", 0x1, 0x67670680, 0x0, 0x6c80c388},
+  {30, (const uint8_t *)"{[#-;:$/{)(+[}#]/{&!%(@)%:@-$:", 0x1, 0x7547070f, 0x0, 0xd54d977d},
+  {30, (const uint8_t *)"_{$*,}(&,@.)):=!/%(&(,,-?$}}}!", 0x1, 0x69ea06ee, 0x0, 0xe3966ad5},
+  {100, (const uint8_t *)"e$98KNzqaV)Y:2X?]77].{gKRD4G5{mHZk,Z)SpU%L3FSgv!Wb8MLAFdi{+fp)c,@8m6v)yXg@]HBDFk?.4&}g5_udE*JHCiH=aL", 0x1, 0x1b01e92, 0x0, 0xe7c71db9},
+  {100, (const uint8_t *)"r*Fd}ef+5RJQ;+W=4jTR9)R*p!B;]Ed7tkrLi;88U7g@3v!5pk2X6D)vt,.@N8c]@yyEcKi[vwUu@.Ppm@C6%Mv*3Nw}Y,58_aH)", 0x1, 0xfbdb1e96, 0x0, 0xeaa52777},
+  {100, (const uint8_t *)"h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&", 0x1, 0x47a61ec8, 0x0, 0xcd472048},
+  {5552, (const uint8_t *)long_string, 0x1, 0x8b81718f, 0x0, 0x426fa73b},
+  {6, (const uint8_t *)"abacus", 0x1, 0x8400270, 0x7a30360d, 0xf8655a84},
+  {1, (const uint8_t *)"", 0x6fd767ee, 0xd7c567ee, 0x6fd767ee, 0x95dff795},
+  {1, (const uint8_t *)"a", 0xefeb7589, 0x65e475ea, 0x0, 0xe8b7be43},
+  {6, (const uint8_t *)"abacus", 0x61cf7e6b, 0x60b880da, 0x0, 0xc3d7115b},
+  {7, (const uint8_t *)"backlog", 0x1, 0xb1f02d4, 0x6fd767ee, 0x1ed834b1},
+  {7, (const uint8_t *)"backlog", 0xdc712e2, 0x9d0d15b5, 0xefeb7589, 0x975f06f6},
+  {8, (const uint8_t *)"campfire", 0xad23c7fd, 0xfbfecb44, 0x0, 0x22a515f8},
+  {8, (const uint8_t *)"campfire", 0x1, 0xea10348, 0xefeb7589, 0x686cfca},
+  {5, (const uint8_t *)"delta", 0x85cb2317, 0x3b622521, 0x61cf7e6b, 0x1554e4b1},
+  {10, (const uint8_t *)"executable", 0x9eed31b0, 0xa6db35d2, 0xdc712e2, 0x761b4254},
+  {4, (const uint8_t *)"file", 0xb94f34ca, 0x9096366a, 0xad23c7fd, 0x7abdd09b},
+  {8, (const uint8_t *)"greatest", 0xab058a2, 0xded05c01, 0x85cb2317, 0x4ba91c6b},
+  {8, (const uint8_t *)"inverter", 0x5bff2b7a, 0xc7452ee9, 0x9eed31b0, 0xd5e78ba5},
+  {6, (const uint8_t *)"jigsaw", 0x605c9a5f, 0x7899ce4, 0xb94f34ca, 0x23649109},
+  {6, (const uint8_t *)"karate", 0x51bdeea5, 0xf285f11d, 0xab058a2, 0xc5591f41},
+  {9, (const uint8_t *)"landscape", 0x85c21c79, 0x98732024, 0x5bff2b7a, 0xf10eb644},
+  {7, (const uint8_t *)"machine", 0x97216f56, 0xadf4722b, 0x605c9a5f, 0xbaa0a636},
+  {9, (const uint8_t *)"nanometer", 0x18444af2, 0xcdb34ebb, 0x51bdeea5, 0x6af89afb},
+  {8, (const uint8_t *)"oblivion", 0xbe6ce359, 0xe8b7e6bb, 0x85c21c79, 0xecae222b},
+  {6, (const uint8_t *)"panama", 0x843071f1, 0x389e745f, 0x97216f56, 0x47dffac4},
+  {5, (const uint8_t *)"quest", 0xf2480c60, 0x36c90e92, 0x18444af2, 0x70c2fe36},
+  {8, (const uint8_t *)"resource", 0x2d2feb3d, 0x9705eea5, 0xbe6ce359, 0x1471d925},
+  {6, (const uint8_t *)"secret", 0x7490310a, 0xa3a63390, 0x843071f1, 0x50c9a0db},
+  {8, (const uint8_t *)"ultimate", 0x97d247d4, 0xe6154b39, 0xf2480c60, 0xf973daf8},
+  {6, (const uint8_t *)"vector", 0x93cf7599, 0x5e87782c, 0x2d2feb3d, 0x344ac03d},
+  {6, (const uint8_t *)"walrus", 0x73c84278, 0xbc84516, 0x7490310a, 0x6d1408ef},
+  {4, (const uint8_t *)"xeno", 0x228a87d1, 0x4646898b, 0x97d247d4, 0xe62670b5},
+  {7, (const uint8_t *)"yelling", 0xa7a048d0, 0xb1654bc4, 0x93cf7599, 0x1b36da38},
+  {4, (const uint8_t *)"zlib", 0x1f0ded40, 0xd89aeef1, 0x73c84278, 0x6432d127},
+  {20, (const uint8_t *)"4BJD7PocN1VqX0jXVpWB", 0xa804a62f, 0xe34eac7b, 0x228a87d1, 0x997107d0},
+  {20, (const uint8_t *)"F1rPWI7XvDs6nAIRx41l", 0x508fae6a, 0x33f2b4c8, 0xa7a048d0, 0xdc567274},
+  {20, (const uint8_t *)"ldhKlsVkPFOveXgkGtC2", 0xe5adaf4f, 0xe7b1b68c, 0x1f0ded40, 0xdcc63870},
+  {20, (const uint8_t *)"5KKnGOOrs8BvJ35iKTOS", 0x67136a40, 0xf6a0708f, 0xa804a62f, 0x6926cffd},
+  {20, (const uint8_t *)"0l1tw7GOcem06Ddu7yn4", 0xb00c4a10, 0xbd8f509f, 0x508fae6a, 0xb52b38bc},
+  {20, (const uint8_t *)"MCr47CjPIn9R1IvE1Tm5", 0x2e0c84b5, 0xcc298abd, 0xe5adaf4f, 0xf83b8178},
+  {20, (const uint8_t *)"UcixbzPKTIv0SvILHVdO", 0x81238d44, 0xd7809446, 0x67136a40, 0xc5213070},
+  {20, (const uint8_t *)"dGnAyAhRQDsWw0ESou24", 0xf853aa92, 0x9525b148, 0xb00c4a10, 0xbc7648b0},
+  {20, (const uint8_t *)"di0nvmY9UYMYDh0r45XT", 0x5a692325, 0x620029bc, 0x2e0c84b5, 0xd8123a72},
+  {20, (const uint8_t *)"2XKDwHfAhFsV0RhbqtvH", 0x3275b9f, 0x70916284, 0x81238d44, 0xd5ac5620},
+  {20, (const uint8_t *)"ZhrANFIiIvRnqClIVyeD", 0x38371feb, 0xd52706, 0xf853aa92, 0xceae099d},
+  {20, (const uint8_t *)"v7Q9ehzioTOVeDIZioT1", 0xafc8bf62, 0xeeb4c65a, 0x5a692325, 0xb07d2b24},
+  {20, (const uint8_t *)"Yod5hEeKcYqyhfXbhxj2", 0x9b07db73, 0xde3e2db, 0x3275b9f, 0x24ce91df},
+  {20, (const uint8_t *)"GehSWY2ay4uUKhehXYb0", 0xe75b214, 0x4171b8f8, 0x38371feb, 0x707b3b30},
+  {20, (const uint8_t *)"kwytJmq6UqpflV8Y8GoE", 0x72d0fe6f, 0xa66a05cd, 0xafc8bf62, 0x16abc6a9},
+  {20, (const uint8_t *)"70684206568419061514", 0xf857a4b1, 0x1f9a8c4, 0x9b07db73, 0xae1fb7b7},
+  {20, (const uint8_t *)"42015093765128581010", 0x54b8e14, 0x49c19218, 0xe75b214, 0xd4eecd2d},
+  {20, (const uint8_t *)"88214814356148806939", 0xd6aa5616, 0xbbfc5a38, 0x72d0fe6f, 0x4660ec7},
+  {20, (const uint8_t *)"43472694284527343838", 0x11e63098, 0x93434b8, 0xf857a4b1, 0xfd8afdf7},
+  {20, (const uint8_t *)"49769333513942933689", 0xbe92385, 0xfe1827af, 0x54b8e14, 0xc6d1b5f2},
+  {20, (const uint8_t *)"54979784887993251199", 0x49511de0, 0xcba8221c, 0xd6aa5616, 0x32476461},
+  {20, (const uint8_t *)"58360544869206793220", 0x3db13bc1, 0x14643fda, 0x11e63098, 0xd917cf1a},
+  {20, (const uint8_t *)"27347953487840714234", 0xbb899bea, 0x1604a006, 0xbe92385, 0x4ad14a12},
+  {20, (const uint8_t *)"07650690295365319082", 0xf6cd9436, 0xb69f984c, 0x49511de0, 0xe37b5c6c},
+  {20, (const uint8_t *)"42655507906821911703", 0x9109e6c3, 0xc43eead4, 0x3db13bc1, 0x7cc497f1},
+  {20, (const uint8_t *)"29977409200786225655", 0x75770fc, 0x707751b, 0xbb899bea, 0x99781bb2},
+  {20, (const uint8_t *)"85181542907229116674", 0x69b1d19b, 0xf5bdd5b3, 0xf6cd9436, 0x132256a1},
+  {20, (const uint8_t *)"87963594337989416799", 0xc6132975, 0x2fed2db3, 0x9109e6c3, 0xbfdb2c83},
+  {20, (const uint8_t *)"21395988329504168551", 0xd58cb00c, 0xc2a2b42a, 0x75770fc, 0x8d9d1e81},
+  {20, (const uint8_t *)"51991013580943379423", 0xb63b8caa, 0xdf0590c0, 0x69b1d19b, 0x7b6d4404},
+  {30, (const uint8_t *)"*]+@!);({_$;}[_},?{?;(_?,=-][@", 0x8a45a2b8, 0x1980aaf8, 0xc6132975, 0x8619f010},
+  {30, (const uint8_t *)"_@:_).&(#.[:[{[:)$++-($_;@[)}+", 0xcbe95b78, 0xf58662c8, 0xd58cb00c, 0x15746ac3},
+  {30, (const uint8_t *)"&[!,[$_==}+.]@!;*(+},[;:)$;)-@", 0x4ef8a54b, 0x1f65ac54, 0xb63b8caa, 0xaccf812f},
+  {30, (const uint8_t *)"]{.[.+?+[[=;[?}_#&;[=)__$$:+=_", 0x76ad267a, 0x7b792e8e, 0x8a45a2b8, 0x78af45de},
+  {30, (const uint8_t *)"-%.)=/[@].:.(:,()$;=%@-$?]{%+%", 0x569e613c, 0x1d61679c, 0xcbe95b78, 0x25b06b59},
+  {30, (const uint8_t *)"+]#$(@&.=:,*];/.!]%/{:){:@(;)$", 0x36aa61da, 0x12ec687c, 0x4ef8a54b, 0x4ba0d08f},
+  {30, (const uint8_t *)")-._.:?[&:.=+}(*$/=!.${;(=$@!}", 0xf67222df, 0x740329a9, 0x76ad267a, 0xe26b6aac},
+  {30, (const uint8_t *)":(_*&%/[[}+,?#$&*+#[([*-/#;%(]", 0x74b34fd3, 0x374c5652, 0x569e613c, 0x7e2b0a66},
+  {30, (const uint8_t *)"{[#-;:$/{)(+[}#]/{&!%(@)%:@-$:", 0x351fd770, 0xeadfde7e, 0x36aa61da, 0xb3430dc7},
+  {30, (const uint8_t *)"_{$*,}(&,@.)):=!/%(&(,,-?$}}}!", 0xc45aef77, 0x3fcbf664, 0xf67222df, 0x626c17a},
+  {100, (const uint8_t *)"e$98KNzqaV)Y:2X?]77].{gKRD4G5{mHZk,Z)SpU%L3FSgv!Wb8MLAFdi{+fp)c,@8m6v)yXg@]HBDFk?.4&}g5_udE*JHCiH=aL", 0xd034ea71, 0x6b080911, 0x74b34fd3, 0xccf98060},
+  {100, (const uint8_t *)"r*Fd}ef+5RJQ;+W=4jTR9)R*p!B;]Ed7tkrLi;88U7g@3v!5pk2X6D)vt,.@N8c]@yyEcKi[vwUu@.Ppm@C6%Mv*3Nw}Y,58_aH)", 0xdeadc0de, 0x355fdf73, 0x351fd770, 0xd8b95312},
+  {100, (const uint8_t *)"h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&", 0xba5eba11, 0xb48bd8d8, 0xc45aef77, 0xbb1c9912},
+  {600, (const uint8_t *)
+    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
+    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
+    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
+    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
+    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
+    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&", 0x0, 0xc3ab8aa, 0xc45aef77, 0x888afa5b},
+  {5552, (const uint8_t *)long_string, 0x7712aa45, 0x7dc51be2, 0x0, 0x426fa73b},
+  {32768, big_test, 0x0, 0xbfcdc3b1, 0x0, 0x217726b2},
+  {16384, big_test, 0x0, 0x186ae1d1, 0x0, 0xe81722f0},
+  {118960+512, big_test, 0x0, 0xf0d560c0, 0x0, 0xf0d2c66f},
+  {615078, big_test, 0x0, 0xd153ca93, 0x0, 0x6a023677},
+  {615142, big_test, 0x0, 0x68cafbf3, 0x0, 0x8a1b2fc5},
+  {615270, big_test, 0x0, 0x343e28c2, 0x0, 0xaf836355},
+  {615302, big_test, 0x0, 0x34883772, 0x0, 0x42e83c6c},
+  {615318, big_test, 0x0, 0xf5ad404a, 0x0, 0x563bcb26},
+  {615326, big_test, 0x0, 0x0d964516, 0x0, 0xd39dea79},
+  {615330, big_test, 0x0, 0x28334794, 0x0, 0xec355488},
+  {615334, big_test, 0x0, 0x4cf04a22, 0x0, 0x391ab77c},
+  {615335, big_test, 0x0, 0x97b84ac8, 0x0, 0xb43dcef0},
+  {615336, big_test, 0x0, 0xe3274b6f, 0x0, 0x27b91614},
+};
+
+#endif  /* HASH_TEST_STRINGS_P_H */
diff --git a/test/infcover.c b/test/infcover.c
index 6a9999e0..ba922dfc 100644
--- a/test/infcover.c
+++ b/test/infcover.c
@@ -442,7 +442,7 @@ static void cover_wrap(void) {
 }
 
 /* input and output functions for inflateBack() */
-static unsigned pull(void *desc, z_const unsigned char **buf) {
+static z_uint32_t pull(void *desc, z_const unsigned char **buf) {
     static unsigned int next = 0;
     static unsigned char dat[] = {0x63, 0, 2, 0};
     struct inflate_state *state;
@@ -457,7 +457,7 @@ static unsigned pull(void *desc, z_const unsigned char **buf) {
     return next < sizeof(dat) ? (*buf = dat + next++, 1) : 0;
 }
 
-static int push(void *desc, unsigned char *buf, unsigned len) {
+static z_int32_t push(void *desc, unsigned char *buf, z_uint32_t len) {
     buf += len;
     Z_UNUSED(buf);
     return desc != NULL;        /* force error if desc not null */
@@ -618,6 +618,7 @@ static void cover_inflate(void) {
     inf("63 18 5 40 c 0", "window wrap", 3, -8, 300, Z_OK);
 }
 
+#ifndef TEST_STOCK_ZLIB
 /* cover remaining lines in inftrees.c */
 static void cover_trees(void) {
     int ret;
@@ -626,7 +627,7 @@ static void cover_trees(void) {
     code *next, table[ENOUGH_DISTS];
 
     /* we need to call inflate_table() directly in order to manifest not-
-       enough errors, since zlib insures that enough is always enough */
+       enough errors, since zlib ensures that enough is always enough */
     for (bits = 0; bits < 15; bits++)
         lens[bits] = (uint16_t)(bits + 1);
     lens[15] = 15;
@@ -641,6 +642,7 @@ static void cover_trees(void) {
     fputs("inflate_table not enough errors\n", stderr);
     Z_UNUSED(ret);
 }
+#endif
 
 /* cover remaining inffast.c decoding and window copying */
 static void cover_fast(void) {
@@ -672,7 +674,9 @@ int main(void) {
     cover_wrap();
     cover_back();
     cover_inflate();
+#ifndef TEST_STOCK_ZLIB
     cover_trees();
+#endif
     cover_fast();
     cover_cve_2022_37434();
     return 0;
diff --git a/test/minideflate.c b/test/minideflate.c
index 9190d77b..ab8dc531 100644
--- a/test/minideflate.c
+++ b/test/minideflate.c
@@ -5,6 +5,7 @@
 
 #include "zbuild.h"
 
+#include <inttypes.h>
 #include <stdio.h>
 #include <assert.h>
 
@@ -48,12 +49,12 @@ static void deflate_params(FILE *fin, FILE *fout, int32_t read_buf_size, int32_t
 
     read_buf = (uint8_t *)malloc(read_buf_size);
     if (read_buf == NULL) {
-        fprintf(stderr, "failed to create read buffer (%d)\n", read_buf_size);
+        fprintf(stderr, "failed to create read buffer (%" PRId32 ")\n", read_buf_size);
         return;
     }
     write_buf = (uint8_t *)malloc(write_buf_size);
     if (write_buf == NULL) {
-        fprintf(stderr, "failed to create write buffer (%d)\n", write_buf_size);
+        fprintf(stderr, "failed to create write buffer (%" PRId32 ")\n", write_buf_size);
         free(read_buf);
         return;
     }
@@ -134,12 +135,12 @@ static void inflate_params(FILE *fin, FILE *fout, int32_t read_buf_size, int32_t
 
     read_buf = (uint8_t *)malloc(read_buf_size);
     if (read_buf == NULL) {
-        fprintf(stderr, "failed to create read buffer (%d)\n", read_buf_size);
+        fprintf(stderr, "failed to create read buffer (%" PRId32 ")\n", read_buf_size);
         return;
     }
     write_buf = (uint8_t *)malloc(write_buf_size);
     if (write_buf == NULL) {
-        fprintf(stderr, "failed to create write buffer (%d)\n", write_buf_size);
+        fprintf(stderr, "failed to create write buffer (%" PRId32 ")\n", write_buf_size);
         free(read_buf);
         return;
     }
diff --git a/test/minigzip.c b/test/minigzip.c
index e26364dd..446b12e6 100644
--- a/test/minigzip.c
+++ b/test/minigzip.c
@@ -73,7 +73,7 @@ static void error(const char *msg) {
  */
 
 static void gz_fatal(gzFile file) {
-    int err;
+    z_int32_t err;
     fprintf(stderr, "%s: %s\n", prog, PREFIX(gzerror)(file, &err));
     PREFIX(gzclose)(file);
     exit(1);
diff --git a/test/pigz/CMakeLists.txt b/test/pigz/CMakeLists.txt
index bc6830ae..42f1f43d 100644
--- a/test/pigz/CMakeLists.txt
+++ b/test/pigz/CMakeLists.txt
@@ -18,7 +18,7 @@
 #   PTHREADS4W_ROOT     - Path to pthreads4w source directory on Windows.
 #                         If not specified then threading will be disabled.
 
-cmake_minimum_required(VERSION 3.11)
+cmake_minimum_required(VERSION 3.14...4.2.1)
 
 include(CheckCCompilerFlag)
 include(FeatureSummary)
@@ -65,10 +65,7 @@ FetchContent_Declare(pigz
     GIT_REPOSITORY https://github.com/madler/pigz.git
     GIT_TAG ${PIGZ_TAG})
 
-FetchContent_GetProperties(pigz)
-if(NOT pigz_POPULATED)
-    FetchContent_Populate(pigz)
-endif()
+FetchContent_MakeAvailable(pigz)
 
 set(PIGZ_SRCS
     ${pigz_SOURCE_DIR}/pigz.c
@@ -120,6 +117,7 @@ if(NOT DEFINED ZLIB_ROOT)
     find_package(Zlib REQUIRED)
 endif()
 
+set(ZLIB_ALIASES ON)
 set(ZLIB_COMPAT ON)
 set(ZLIB_ENABLE_TESTS OFF)
 
diff --git a/test/pkgcheck.sh b/test/pkgcheck.sh
index 94214017..29668a9f 100644
--- a/test/pkgcheck.sh
+++ b/test/pkgcheck.sh
@@ -79,8 +79,11 @@ Darwin)
   # What CPU are we running on, exactly?
   sysctl -n machdep.cpu.brand_string
   sysctl -n machdep.cpu.features
-  sysctl -n machdep.cpu.leaf7_features
-  sysctl -n machdep.cpu.extfeatures
+  if test "$(uname -m)" = "x86_64"
+  then
+    sysctl -n machdep.cpu.leaf7_features
+    sysctl -n machdep.cpu.extfeatures
+  fi
   ;;
 esac
 
diff --git a/test/switchlevels.c b/test/switchlevels.c
index b31bc0f9..2d6ca0e6 100644
--- a/test/switchlevels.c
+++ b/test/switchlevels.c
@@ -9,6 +9,7 @@
 #  include "zlib-ng.h"
 #endif
 
+#include <inttypes.h>
 #include <stdio.h>
 
 #if defined(_WIN32) || defined(__CYGWIN__)
@@ -95,7 +96,7 @@ static int compress_chunk(PREFIX3(stream) *strm, int level, int size, int last)
         goto free_buf;
     }
     if (strm->avail_in != 0) {
-        fprintf(stderr, "deflate() did not consume %d bytes of input\n", strm->avail_in);
+        fprintf(stderr, "deflate() did not consume %" PRIu32 " bytes of input\n", strm->avail_in);
         goto free_buf;
     }
     if (write_all(buf + size, compsize - strm->avail_out) != 0) {
diff --git a/test/test_adler32.cc b/test/test_adler32.cc
index b3d03021..c461f939 100644
--- a/test/test_adler32.cc
+++ b/test/test_adler32.cc
@@ -12,351 +12,24 @@ extern "C" {
 #  include "zbuild.h"
 #  include "arch_functions.h"
 #  include "test_cpu_features.h"
+#  include "hash_test_strings_p.h"
 }
 
 #include <gtest/gtest.h>
 
-typedef struct {
-    uint32_t adler;
-    const uint8_t *buf;
-    uint32_t len;
-    uint32_t expect;
-} adler32_test;
-
-static const uint8_t long_string[5552] = {
-    'q','j','d','w','q','4','8','m','B','u','k','J','V','U','z','V','V','f','M','j','i','q','S','W','L','5','G','n','F','S','P','Q',
-    'Q','D','i','6','m','E','9','Z','a','A','P','h','9','d','r','b','5','t','X','U','U','L','w','q','e','k','E','H','6','W','7','k',
-    'A','x','N','Q','R','k','d','V','5','y','n','U','N','W','Q','Y','i','W','5','9','R','p','D','C','x','p','u','h','C','a','m','r',
-    'z','n','z','A','d','J','6','u','N','e','r','x','7','Q','3','v','V','h','H','S','H','S','f','K','f','e','E','T','9','J','f','K',
-    'w','t','x','J','2','y','7','B','x','X','X','p','G','b','T','g','3','k','U','6','E','Z','M','t','J','q','v','n','S','T','6','x',
-    '5','x','4','P','z','p','M','F','V','b','d','m','f','G','n','J','m','w','z','K','8','a','q','E','D','e','b','3','h','B','V','g',
-    'y','3','P','L','5','8','r','z','X','b','Q','g','H','7','L','c','Z','B','3','C','4','y','t','u','k','z','h','v','C','Y','p','p',
-    '8','H','v','5','X','w','4','L','R','V','V','4','U','C','8','4','T','E','a','N','Z','S','7','U','u','z','f','H','p','P','J','u',
-    'Y','Z','h','T','6','e','v','z','V','F','h','u','y','H','b','k','J','M','f','3','6','g','y','L','E','W','t','B','B','d','d','9',
-    'u','M','Z','k','F','G','f','h','q','k','5','k','f','r','M','7','c','M','7','y','n','u','8','b','d','7','Q','f','E','m','F','K',
-    'x','W','f','B','2','F','8','5','q','z','y','3','R','i','U','m','X','k','h','N','J','y','B','C','h','u','x','4','f','k','J','5',
-    '6','X','T','W','h','8','J','4','m','K','p','N','3','g','C','g','A','E','e','Z','x','A','P','2','E','4','t','Q','5','X','Y','j',
-    '6','m','b','h','G','a','v','6','t','v','6','C','M','G','P','u','B','C','A','V','b','2','9','d','2','c','5','a','b','X','w','V',
-    'G','6','a','7','c','8','G','6','K','U','Q','m','w','P','V','5','N','x','b','v','x','E','N','C','A','N','t','v','N','B','z','X',
-    'B','R','q','U','n','i','A','Q','d','m','a','D','7','Y','f','3','J','8','Y','m','w','Z','b','w','r','H','q','E','j','c','u','E',
-    'i','i','S','b','n','G','P','a','F','j','c','R','D','D','G','F','v','i','a','i','M','7','B','e','w','m','L','E','F','2','Y','4',
-    '4','7','Y','C','t','y','q','7','2','V','G','m','m','E','e','V','u','m','L','p','R','X','W','z','V','K','E','k','p','V','r','J',
-    'd','N','3','t','i','u','S','V','w','2','w','U','Q','3','F','q','4','h','q','k','B','7','R','X','B','F','Q','Z','b','b','4','E',
-    'K','v','T','B','w','k','V','C','x','d','K','g','N','S','u','k','p','9','z','w','c','y','U','M','V','E','2','Y','P','F','h','9',
-    'T','y','h','w','b','9','P','w','G','c','W','W','k','j','J','Q','N','B','U','G','6','9','U','b','v','a','N','9','N','C','G','n',
-    'x','R','6','9','Q','C','h','e','j','P','U','h','U','R','i','4','T','B','W','5','w','m','J','p','e','7','r','9','t','c','9','Z',
-    'j','p','r','F','C','e','U','P','x','T','A','N','7','6','a','i','y','e','w','F','C','X','H','Y','G','C','q','q','m','A','t','7',
-    'z','u','D','S','L','U','C','f','7','e','t','G','V','F','u','c','x','5','M','7','N','i','M','6','h','2','n','H','S','h','K','M',
-    'd','T','z','X','d','x','x','4','q','z','d','D','a','2','X','r','p','r','R','m','U','U','y','S','H','c','a','F','e','Z','a','U',
-    'P','9','V','J','e','q','j','Y','M','x','e','v','K','7','M','P','N','2','b','6','f','P','h','H','4','U','X','k','n','f','Q','M',
-    '9','9','a','J','N','e','w','y','f','F','P','p','a','F','Y','a','M','L','W','i','T','M','B','3','U','v','X','v','G','p','7','a',
-    'f','u','4','S','y','X','9','g','g','b','B','G','c','i','M','U','n','m','a','7','q','f','9','n','Q','2','V','L','6','e','T','R',
-    '2','4','9','d','6','Q','B','Y','q','2','4','9','G','Q','E','b','Y','5','u','2','T','Q','G','L','5','n','4','Y','2','y','G','F',
-    'j','c','8','M','G','L','e','3','a','N','v','A','A','W','t','R','S','2','i','D','R','8','j','d','Q','3','6','C','V','M','e','w',
-    'j','U','Z','w','M','4','b','m','8','J','P','Q','L','P','R','c','r','b','V','C','3','N','8','K','4','d','W','D','N','U','A','A',
-    '2','J','p','b','D','d','p','j','N','C','k','A','j','B','a','c','u','v','L','X','U','B','4','U','X','W','e','C','b','C','u','d',
-    'A','v','U','z','P','t','D','e','5','y','Y','c','x','K','4','7','j','e','e','D','M','5','K','B','Q','6','d','p','T','T','R','j',
-    'M','E','E','M','r','N','6','8','7','q','x','F','S','x','E','U','4','d','B','6','5','W','C','e','m','J','e','5','j','w','V','J',
-    'w','v','d','7','v','f','K','u','m','8','h','W','T','e','Q','j','M','8','R','Y','d','B','R','2','r','F','j','7','d','E','q','V',
-    'k','e','j','P','9','3','X','R','p','R','b','A','v','7','4','A','M','2','k','r','E','7','X','3','7','k','5','c','B','7','W','5',
-    'u','J','B','Q','R','2','V','7','h','Q','h','9','g','G','y','c','c','x','M','z','7','G','2','J','w','v','j','5','9','E','b','k',
-    'z','W','T','C','b','4','K','R','X','T','k','V','S','G','2','j','d','6','y','E','4','P','H','K','w','a','m','F','Z','x','9','j',
-    'i','2','d','X','u','a','4','a','M','z','8','p','p','z','g','t','H','5','Y','L','Q','c','R','F','m','E','n','G','X','d','f','7',
-    'x','8','j','g','J','z','D','S','a','S','h','y','5','h','Y','N','p','w','Y','W','h','E','N','v','8','Q','D','W','Z','k','f','e',
-    'r','Z','D','7','R','D','T','2','H','X','z','G','X','f','v','E','z','P','v','U','H','e','4','R','W','U','x','t','t','4','w','p',
-    'r','z','K','9','f','g','h','P','r','f','v','k','h','c','e','5','8','a','L','F','J','M','G','R','a','N','q','S','g','W','e','7',
-    'R','K','R','A','B','z','6','v','S','p','w','n','e','x','k','E','r','j','f','Y','x','8','9','z','e','T','6','E','G','v','9','f',
-    'D','A','N','v','y','U','7','D','M','2','E','5','W','G','6','b','9','q','g','Y','F','f','k','q','Q','E','x','Y','C','R','G','6',
-    'R','h','4','J','d','U','D','b','9','b','8','r','f','V','d','g','b','2','z','Z','d','m','X','v','j','Y','d','w','K','8','G','r',
-    'v','j','N','y','c','h','u','5','z','g','J','H','a','Z','b','z','G','C','r','P','f','y','P','6','F','P','h','7','9','w','7','y',
-    'R','3','n','E','h','G','D','4','m','Y','E','q','k','a','f','a','R','B','q','t','W','E','T','p','H','7','k','X','2','d','X','6',
-    'W','n','H','m','w','M','i','Y','M','E','F','5','R','p','p','y','c','b','q','R','9','Y','t','T','7','w','u','K','M','Q','z','n',
-    'P','7','g','x','6','R','4','x','N','v','w','M','6','j','K','v','7','a','Y','4','a','M','6','n','z','3','E','2','V','N','4','i',
-    'E','f','u','W','J','W','e','8','3','Q','e','a','F','P','c','3','P','k','i','z','d','q','m','q','M','a','d','8','D','3','F','M',
-    'e','d','E','j','z','V','e','d','z','H','D','J','8','X','g','E','i','u','c','7','A','w','S','J','2','A','e','8','r','q','C','m',
-    '9','9','a','g','2','y','y','P','M','e','8','3','T','r','m','8','j','v','r','p','M','Z','Y','g','a','9','2','d','H','B','m','9',
-    '4','6','a','Z','V','u','S','H','g','3','X','h','i','N','3','B','S','E','k','9','k','2','9','R','A','i','3','L','X','M','B','S',
-    '4','S','F','F','F','w','u','d','M','T','9','K','B','7','R','U','R','8','D','8','T','5','U','t','E','R','x','n','x','h','v','k',
-    'B','N','k','E','U','T','t','p','r','u','Z','h','t','E','4','i','P','z','f','z','q','M','p','f','A','K','2','D','t','j','f','c',
-    'Y','E','N','M','x','k','g','7','T','U','2','c','d','V','g','2','z','L','i','j','Y','q','b','T','A','y','v','a','t','N','5','t',
-    'Z','5','n','D','a','y','G','n','P','x','V','k','M','8','t','J','Z','G','g','5','9','R','h','P','P','J','N','X','p','G','J','p',
-    '2','y','A','v','d','G','U','z','3','V','M','y','q','U','N','M','Y','p','B','Z','U','h','j','q','z','q','x','w','7','d','J','Q',
-    'u','F','q','3','m','9','c','Q','W','d','6','7','b','V','M','7','P','j','r','k','9','h','R','z','m','b','i','B','u','E','L','9',
-    'k','v','h','h','W','2','K','e','M','U','Q','p','A','Q','Y','J','G','E','T','U','L','f','q','G','4','z','K','K','y','a','U','W',
-    'K','D','P','c','N','D','V','S','Y','6','T','p','R','y','y','J','a','T','J','W','Q','9','p','F','P','X','y','k','9','z','z','4',
-    'G','d','a','z','X','n','h','4','J','P','W','V','D','r','U','m','a','8','a','b','X','F','J','X','L','4','S','X','5','W','p','W',
-    'h','y','x','B','f','d','C','X','w','7','r','g','V','T','H','a','i','4','N','v','c','w','n','2','3','A','i','A','J','9','N','c',
-    'z','7','n','n','3','n','h','n','i','R','i','b','E','h','k','U','c','c','U','6','f','x','q','N','y','H','M','e','J','B','U','B',
-    'r','g','a','8','V','a','G','V','y','u','c','c','v','C','H','W','y','g','z','Q','2','4','k','S','m','f','e','G','H','v','Q','3',
-    'P','e','f','S','V','P','c','U','e','3','P','x','d','c','7','c','f','g','D','w','2','t','q','y','g','2','Q','V','4','K','a','Q',
-    'g','B','b','L','x','9','m','a','K','4','i','x','g','Q','M','9','W','N','2','w','p','v','2','k','B','y','9','k','A','c','f','Z',
-    'D','R','A','S','d','v','w','f','f','q','t','K','3','j','x','D','G','P','n','u','r','v','U','k','A','2','d','R','N','T','G','4',
-    'B','g','k','t','h','7','J','k','F','A','C','g','W','g','J','F','z','S','Q','c','v','M','b','D','e','H','Q','S','j','v','G','E',
-    'R','k','f','i','P','E','F','N','6','y','p','b','t','M','c','Q','B','7','g','w','J','7','3','d','V','E','m','z','6','6','P','P',
-    'd','i','r','J','H','D','H','J','r','b','n','v','z','W','e','u','g','B','u','Z','2','m','D','5','h','F','X','B','2','r','6','w',
-    'u','Y','4','N','X','K','a','v','V','3','j','B','r','r','C','c','w','R','g','S','8','V','b','F','2','N','M','c','K','8','Y','E',
-    'E','N','K','X','K','V','B','x','n','Q','p','a','q','f','k','t','z','Y','E','P','Z','y','n','a','c','B','V','a','x','b','d','X',
-    'r','d','8','P','H','F','v','r','V','5','g','J','w','6','i','h','d','d','p','J','c','c','Y','S','q','W','m','U','5','G','b','H',
-    'N','z','E','Z','K','E','y','M','c','G','i','d','w','Z','D','N','N','w','S','t','g','y','a','Y','b','H','e','M','N','f','Y','Y',
-    '7','a','9','b','M','U','k','a','V','k','C','n','a','k','U','H','A','M','i','v','k','t','a','d','i','3','F','d','5','2','A','p',
-    'U','c','J','U','R','h','G','d','A','Y','v','q','X','c','w','r','x','4','j','3','4','b','F','d','a','L','N','J','3','Z','g','6',
-    'W','Q','R','u','P','t','M','A','3','F','6','y','K','Y','G','2','t','v','u','p','w','b','G','S','K','5','p','4','d','E','w','6',
-    'g','t','V','4','b','2','n','b','Z','3','3','f','m','d','2','c','a','m','j','X','U','E','D','6','6','F','w','H','9','7','Z','Y',
-    'd','X','C','K','i','g','p','F','Y','n','2','b','F','4','R','u','V','k','f','d','J','i','a','b','X','H','7','v','K','a','Q','i',
-    'W','M','j','M','i','a','i','n','F','h','r','q','4','w','x','m','4','q','y','F','8','w','i','4','D','B','A','L','B','U','u','K',
-    'v','K','n','a','Q','i','e','k','v','Q','U','5','w','Q','c','r','A','6','M','w','y','g','n','e','v','K','7','W','u','2','y','f',
-    'Q','u','e','r','y','a','w','V','p','f','Q','z','C','u','i','i','9','S','P','q','L','r','C','H','S','3','E','p','8','S','m','Q',
-    'S','K','r','V','b','J','R','m','w','c','n','Q','N','Q','4','M','u','f','X','S','f','U','Z','x','U','4','j','K','4','G','z','X',
-    '7','Q','j','R','h','i','G','m','q','c','V','T','x','U','a','E','b','Q','q','E','i','F','K','7','K','i','R','J','5','Y','F','V',
-    'B','7','R','8','M','i','f','j','Z','w','j','b','B','u','p','N','Y','r','S','r','f','h','E','J','T','B','P','R','D','V','K','A',
-    'Z','A','R','j','z','f','B','i','Y','L','F','G','V','Y','w','R','C','P','G','m','9','7','C','5','e','y','w','N','K','N','a','Q',
-    'j','a','W','3','2','f','G','w','n','M','6','F','u','K','8','g','8','M','G','r','e','9','Z','z','y','2','G','U','k','G','6','m',
-    'A','D','4','n','b','8','a','q','S','m','S','6','5','R','5','D','5','S','B','g','X','T','8','Q','V','d','A','n','g','y','8','a',
-    'h','7','K','9','H','D','J','F','w','G','4','w','T','J','F','f','i','8','X','e','B','J','K','H','7','V','y','X','7','E','8','S',
-    'A','d','b','w','S','8','Y','a','J','d','j','E','V','J','T','E','U','R','5','7','V','M','E','v','D','3','z','5','r','k','z','v',
-    'e','m','A','7','P','8','j','X','E','f','Q','q','8','D','g','y','8','j','A','e','B','c','c','M','z','k','2','c','q','v','v','y',
-    'Q','y','h','g','p','v','M','m','m','C','G','D','k','8','u','T','n','Q','H','G','H','f','b','J','j','5','X','c','i','7','7','q',
-    'b','R','8','b','b','z','f','f','h','Y','Q','7','u','B','X','e','i','j','M','q','C','T','M','v','t','J','J','w','b','F','v','J',
-    'm','e','2','u','e','8','L','V','G','q','A','j','m','7','m','g','m','5','i','r','p','p','U','y','F','6','f','b','u','6','q','L',
-    'M','E','t','V','W','C','t','e','p','w','a','n','w','y','X','h','8','e','G','C','H','q','r','X','G','9','c','h','7','k','8','M',
-    'G','b','a','m','Y','Q','w','8','J','z','a','F','r','4','W','M','j','P','q','a','z','U','y','u','3','b','Z','f','Y','5','7','g',
-    'N','M','h','M','a','3','C','K','6','6','f','a','p','i','f','q','k','T','i','z','w','f','Z','c','H','L','X','g','6','m','g','r',
-    'w','Y','u','K','8','L','p','8','P','R','A','R','A','b','Z','V','a','x','V','c','G','A','H','t','Y','6','P','T','L','W','N','z',
-    'g','z','k','d','E','v','C','t','Z','M','Z','K','4','w','9','5','D','W','f','U','8','5','u','6','b','5','B','8','g','y','C','E',
-    'Q','z','e','9','p','N','S','P','D','D','f','x','k','Z','4','R','v','X','V','k','p','b','n','t','c','F','R','e','x','9','C','D',
-    'J','2','6','f','Z','D','w','J','R','j','j','9','b','w','N','N','p','R','f','Z','z','j','F','r','Q','e','F','x','f','t','V','V',
-    'A','y','J','G','W','Z','H','r','D','5','M','u','H','V','L','N','U','V','X','z','j','9','r','v','e','d','R','c','u','V','x','r',
-    'c','6','k','L','h','q','w','U','W','Q','g','G','F','C','t','E','a','D','h','x','9','5','P','R','Z','E','M','5','f','4','2','t',
-    'A','6','f','r','X','G','X','Y','B','8','G','E','n','B','v','x','f','M','R','f','B','z','Y','3','2','q','z','G','t','P','C','6',
-    '6','r','z','J','r','c','n','d','6','h','e','w','D','D','h','V','L','u','i','b','5','K','d','S','y','9','N','p','E','r','D','k',
-    'B','z','u','v','d','Q','p','K','5','m','J','r','b','Y','Z','7','p','M','J','F','E','q','x','f','E','K','U','U','4','f','a','6',
-    'g','5','a','q','D','U','8','F','y','R','a','P','5','5','x','z','6','V','T','P','D','m','y','7','U','5','C','A','7','Q','h','w',
-    'r','6','x','g','Q','i','b','K','F','p','B','X','Q','h','i','E','r','C','z','v','x','W','Q','6','p','6','b','M','K','V','x','u',
-    'k','d','R','S','k','Q','p','n','h','d','Q','Y','x','n','x','5','K','t','5','w','A','5','p','k','F','z','W','p','j','U','y','V',
-    'x','G','m','y','L','A','X','H','G','A','a','J','5','E','P','q','E','U','7','p','6','A','9','n','d','G','D','g','i','h','t','W',
-    'b','c','E','2','P','d','y','J','M','u','4','g','P','S','X','J','v','w','3','v','D','q','U','i','U','T','q','E','Y','5','2','t',
-    'b','j','P','2','j','D','9','y','i','B','5','Y','3','X','L','w','m','V','X','z','X','r','Z','d','H','L','A','H','k','R','X','5',
-    'i','L','m','q','3','p','a','G','P','j','g','h','R','P','Y','U','z','M','5','R','M','A','E','Q','V','c','w','r','4','M','S','k',
-    'N','D','i','R','R','x','t','q','T','i','u','N','K','R','x','Z','K','a','g','G','y','9','c','j','J','S','9','3','H','T','f','F',
-    'q','6','D','W','F','K','h','e','p','p','b','q','N','k','A','C','m','y','u','B','J','v','q','D','e','j','e','b','2','w','R','t',
-    'J','N','j','F','T','A','8','L','m','X','i','T','g','j','c','V','4','V','h','2','h','R','p','2','9','k','c','c','G','D','h','z',
-    't','i','h','t','W','R','n','Y','i','8','u','6','G','9','T','P','9','9','J','P','Y','R','h','X','K','z','h','L','W','r','C','U',
-    '2','L','T','k','2','m','6','W','L','P','T','Z','z','t','i','H','5','G','w','t','E','v','z','k','b','H','b','b','W','W','u','b',
-    'i','h','C','Q','n','H','N','u','5','u','K','X','r','M','W','U','3','Y','k','P','2','k','x','f','x','C','w','z','z','b','G','8',
-    'y','W','e','j','v','2','v','r','t','q','z','p','Y','d','w','6','Z','D','J','L','9','F','z','G','U','4','a','8','H','6','U','a',
-    'q','7','y','Q','J','v','m','D','P','S','j','q','v','t','n','t','g','j','3','t','8','f','K','K','7','b','W','d','F','i','N','K',
-    'a','R','V','V','V','v','m','A','Q','2','y','j','c','t','f','k','j','7','X','y','j','b','U','F','w','W','3','9','6','A','S','J',
-    'p','q','2','Z','7','L','p','b','7','b','5','i','p','r','r','h','P','M','h','j','c','y','e','u','h','B','d','9','9','u','f','d',
-    'g','u','p','w','u','9','S','c','L','U','g','A','y','V','F','V','6','D','D','X','i','V','m','u','Y','P','J','v','L','T','A','F',
-    'M','Q','H','Z','6','v','8','p','A','L','P','z','C','V','a','C','h','X','j','W','8','G','z','j','d','M','4','u','x','w','H','g',
-    'V','q','K','z','b','g','2','3','D','N','y','G','X','F','T','v','T','L','y','v','L','9','g','c','C','R','8','L','A','7','Y','N',
-    't','n','R','6','b','n','m','9','i','h','t','T','F','a','V','N','J','J','3','J','q','p','W','7','b','T','G','r','M','k','a','7',
-    'D','H','v','y','T','A','C','U','P','u','q','L','R','Y','4','q','h','y','f','F','J','x','K','7','N','B','v','3','a','Z','M','t',
-    'U','x','8','9','V','E','t','j','K','r','u','Y','Y','A','u','w','Y','2','y','Q','z','S','n','J','B','2','t','X','x','K','z','g',
-    '6','d','n','i','7','Z','N','F','Q','6','w','N','r','b','k','d','W','X','S','t','c','U','m','6','4','2','e','w','6','x','Z','a',
-    'Q','A','7','4','h','H','z','r','e','J','q','j','w','4','q','c','i','R','4','x','n','r','j','r','P','g','E','7','t','k','b','Z',
-    'r','A','b','d','g','i','G','V','D','E','U','L','b','J','U','q','2','S','K','m','A','U','L','k','Q','4','N','p','k','G','C','6',
-    'R','Z','B','y','B','B','j','y','x','L','d','h','L','G','6','x','H','z','T','5','d','Y','4','2','m','q','Q','y','H','6','c','N',
-    'u','m','U','v','i','Y','Z','7','4','L','K','F','b','v','2','Y','h','x','8','a','R','w','q','x','E','a','T','y','m','C','2','Q',
-    'U','T','D','Q','v','u','M','9','D','8','r','8','b','m','p','E','7','C','T','9','B','A','G','k','b','G','z','Z','G','L','N','k',
-    'h','3','k','J','e','f','d','x','F','8','W','K','7','T','6','h','H','V','C','h','P','u','H','e','v','w','z','P','K','r','D','G',
-    'X','Z','B','X','f','H','Q','4','e','D','y','W','Z','6','4','K','A','e','a','F','S','N','h','x','S','W','J','c','E','P','g','j',
-    'a','w','T','m','Z','X','E','P','Y','R','M','2','R','2','X','N','F','X','Y','W','x','z','p','J','g','n','D','4','i','p','6','N',
-    'r','9','G','k','E','h','T','h','U','h','x','B','Q','9','H','7','w','U','P','Q','d','G','6','q','p','j','j','v','C','a','X','J',
-    'N','G','Y','w','f','H','C','x','F','k','z','3','9','r','h','8','7','5','V','i','V','C','R','q','x','N','2','2','i','W','F','U',
-    '7','T','H','f','z','E','a','n','u','Q','t','U','Y','G','t','3','A','m','r','6','d','f','e','n','e','z','F','u','U','N','8','m',
-    'h','p','R','N','S','H','6','6','V','M','S','t','q','P','E','i','u','y','g','8','L','Q','Y','Y','G','e','W','W','C','G','y','b',
-    'y','t','u','P','R','P','5','m','N','K','B','Z','w','f','t','k','x','3','L','b','q','d','w','S','G','E','h','R','F','4','q','e',
-    '5','6','F','2','n','q','T','R','y','f','n','Y','h','2','F','u','x','M','i','i','h','w','G','C','Z','v','i','C','a','X','U','C',
-    'Y','8','d','h','R','x','V','n','v','G','i','D','a','U','p','U','a','e','b','F','w','P','d','X','n','K','h','9','H','r','b','g',
-    '2','f','m','X','k','m','q','6','n','5','b','G','H','d','R','9','D','U','c','r','Z','Y','W','S','Z','x','p','t','x','y','4','k',
-    'j','F','U','t','C','i','e','i','b','p','e','4','C','z','h','3','3','5','Q','P','n','G','i','A','8','c','Q','z','B','a','V','4',
-    '2','B','2','z','u','u','3','i','L','w','y','g','K','H','k','y','2','B','b','e','5','e','4','e','U','4','z','n','P','z','a','c',
-    'E','f','u','M','G','C','g','z','j','4','E','7','R','t','D','K','c','t','p','g','W','H','C','H','J','Q','J','c','F','5','4','W',
-    'K','7','j','h','A','T','K','z','t','S','f','f','j','C','c','8','n','7','c','T','U','R','Q','E','7','A','W','Z','z','K','5','j',
-    '2','H','k','a','j','g','g','W','w','4','T','A','9','J','U','e','S','N','P','K','d','k','L','Q','G','Z','e','W','i','H','u','j',
-    'C','z','4','E','2','v','5','L','u','9','Z','a','9','A','b','C','M','G','X','B','C','2','Y','Z','e','U','n','E','5','Y','n','y',
-    'F','h','H','p','9','j','Y','F','V','w','Y','r','8','Q','f','C','J','4','T','t','z','Q','N','M','e','7','4','3','y','E','M','m',
-    'b','S','c','h','w','a','X','E','d','E','z','t','h','9','k','p','A','k','K','H','x','q','K','Z','B','u','a','9','3','U','U','u',
-    '8','E','D','v','y','k','W','Y','X','k','r','R','D','X','n','Q','V','d','e','D','g','x','E','V','Y','w','k','m','K','r','H','D',
-    't','2','6','N','U','g','3','t','B','9','t','u','M','D','z','Y','K','z','K','r','V','5','i','e','p','M','d','t','w','6','a','f',
-    'f','W','k','L','i','g','M','V','M','Y','b','x','e','4','h','h','Y','g','w','Z','m','e','e','6','R','W','M','x','G','y','V','n',
-    '6','e','g','A','g','K','a','N','7','p','a','u','E','4','6','M','t','X','h','g','b','j','p','5','x','x','B','P','3','J','M','7',
-    'j','Z','P','y','e','Q','Z','e','t','j','3','t','F','V','x','m','b','b','B','y','J','L','L','9','3','R','a','5','j','S','V','t',
-    'e','2','6','m','H','w','r','w','r','6','Q','3','x','z','m','A','d','x','t','E','H','c','Z','x','c','P','j','r','u','U','W','k',
-    '6','g','X','g','n','f','n','7','H','M','B','t','v','6','v','x','g','M','f','e','2','w','m','y','d','H','S','q','c','K','U','H',
-    '2','X','h','d','p','Q','7','J','X','i','X','f','a','z','V','A','F','2','8','z','v','h','C','h','e','4','g','z','w','z','h','q',
-    'p','6','B','n','m','8','h','W','U','7','z','h','T','6','J','f','4','Z','n','Q','W','z','2','N','4','t','g','7','u','4','X','2',
-    'C','F','L','n','J','n','m','j','3','P','3','Y','e','J','R','A','H','e','R','D','z','7','u','X','Y','y','D','w','J','m','G','U',
-    'P','H','5','S','d','a','F','F','Y','c','M','f','3','3','L','v','V','B','U','C','A','d','N','H','Q','h','7','8','4','r','p','G',
-    'v','M','D','H','7','e','E','r','i','K','Q','i','B','D','M','Z','p','c','R','G','u','c','H','a','N','k','E','f','9','R','7','x',
-    '6','3','5','u','x','3','h','v','p','6','q','r','j','u','f','W','T','q','P','n','Y','L','B','6','U','w','P','2','T','W','R','g',
-    '2','3','3','e','N','V','a','j','b','e','4','T','u','J','u','u','F','B','D','G','H','x','x','k','5','G','e','3','4','B','m','L',
-    'S','b','i','t','T','p','M','D','Z','A','A','i','r','J','p','4','H','U','A','G','y','d','Q','5','U','R','F','8','q','a','S','H',
-    'n','5','z','9','g','3','u','R','H','m','G','m','b','p','c','L','Z','Y','u','m','i','K','A','Q','R','T','X','G','t','b','8','7',
-    '7','6','w','M','N','f','R','G','r','L','m','q','n','7','5','k','X','8','g','u','K','7','Y','w','K','q','U','e','W','A','r','i',
-    'Z','a','p','q','L','5','P','u','n','t','y','G','x','C','N','X','q','P','r','U','v','A','r','r','q','e','f','c','z','M','7','N',
-    '6','a','z','Z','a','t','f','p','4','v','J','Y','j','h','M','D','t','k','A','B','p','Q','A','y','x','X','7','p','S','8','m','M',
-    'y','K','B','A','5','2','7','b','y','R','K','q','A','u','3','J'};
-
-static const adler32_test tests[] = {
-   {0x1, (const uint8_t *)0x0, 0, 0x1},
-   {0x1, (const uint8_t *)"", 1, 0x10001},
-   {0x1, (const uint8_t *)"a", 1, 0x620062},
-   {0x1, (const uint8_t *)"abacus", 6, 0x8400270},
-   {0x1, (const uint8_t *)"backlog", 7, 0xb1f02d4},
-   {0x1, (const uint8_t *)"campfire", 8, 0xea10348},
-   {0x1, (const uint8_t *)"delta", 5, 0x61a020b},
-   {0x1, (const uint8_t *)"executable", 10, 0x16fa0423},
-   {0x1, (const uint8_t *)"file", 4, 0x41401a1},
-   {0x1, (const uint8_t *)"greatest", 8, 0xefa0360},
-   {0x1, (const uint8_t *)"inverter", 8, 0xf6f0370},
-   {0x1, (const uint8_t *)"jigsaw", 6, 0x8bd0286},
-   {0x1, (const uint8_t *)"karate", 6, 0x8a50279},
-   {0x1, (const uint8_t *)"landscape", 9, 0x126a03ac},
-   {0x1, (const uint8_t *)"machine", 7, 0xb5302d6},
-   {0x1, (const uint8_t *)"nanometer", 9, 0x12d803ca},
-   {0x1, (const uint8_t *)"oblivion", 8, 0xf220363},
-   {0x1, (const uint8_t *)"panama", 6, 0x8a1026f},
-   {0x1, (const uint8_t *)"quest", 5, 0x6970233},
-   {0x1, (const uint8_t *)"resource", 8, 0xf8d0369},
-   {0x1, (const uint8_t *)"secret", 6, 0x8d10287},
-   {0x1, (const uint8_t *)"ultimate", 8, 0xf8d0366},
-   {0x1, (const uint8_t *)"vector", 6, 0x8fb0294},
-   {0x1, (const uint8_t *)"walrus", 6, 0x918029f},
-   {0x1, (const uint8_t *)"xeno", 4, 0x45e01bb},
-   {0x1, (const uint8_t *)"yelling", 7, 0xbfe02f5},
-   {0x1, (const uint8_t *)"zero", 4, 0x46e01c1},
-   {0x1, (const uint8_t *)"4BJD7PocN1VqX0jXVpWB", 20, 0x3eef064d},
-   {0x1, (const uint8_t *)"F1rPWI7XvDs6nAIRx41l", 20, 0x425d065f},
-   {0x1, (const uint8_t *)"ldhKlsVkPFOveXgkGtC2", 20, 0x4f1a073e},
-   {0x1, (const uint8_t *)"5KKnGOOrs8BvJ35iKTOS", 20, 0x42290650},
-   {0x1, (const uint8_t *)"0l1tw7GOcem06Ddu7yn4", 20, 0x43fd0690},
-   {0x1, (const uint8_t *)"MCr47CjPIn9R1IvE1Tm5", 20, 0x3f770609},
-   {0x1, (const uint8_t *)"UcixbzPKTIv0SvILHVdO", 20, 0x4c7c0703},
-   {0x1, (const uint8_t *)"dGnAyAhRQDsWw0ESou24", 20, 0x48ac06b7},
-   {0x1, (const uint8_t *)"di0nvmY9UYMYDh0r45XT", 20, 0x489a0698},
-   {0x1, (const uint8_t *)"2XKDwHfAhFsV0RhbqtvH", 20, 0x44a906e6},
-   {0x1, (const uint8_t *)"ZhrANFIiIvRnqClIVyeD", 20, 0x4a29071c},
-   {0x1, (const uint8_t *)"v7Q9ehzioTOVeDIZioT1", 20, 0x4a7706f9},
-   {0x1, (const uint8_t *)"Yod5hEeKcYqyhfXbhxj2", 20, 0x4ce60769},
-   {0x1, (const uint8_t *)"GehSWY2ay4uUKhehXYb0", 20, 0x48ae06e5},
-   {0x1, (const uint8_t *)"kwytJmq6UqpflV8Y8GoE", 20, 0x51d60750},
-   {0x1, (const uint8_t *)"70684206568419061514", 20, 0x2b100414},
-   {0x1, (const uint8_t *)"42015093765128581010", 20, 0x2a550405},
-   {0x1, (const uint8_t *)"88214814356148806939", 20, 0x2b450423},
-   {0x1, (const uint8_t *)"43472694284527343838", 20, 0x2b460421},
-   {0x1, (const uint8_t *)"49769333513942933689", 20, 0x2bc1042b},
-   {0x1, (const uint8_t *)"54979784887993251199", 20, 0x2ccd043d},
-   {0x1, (const uint8_t *)"58360544869206793220", 20, 0x2b68041a},
-   {0x1, (const uint8_t *)"27347953487840714234", 20, 0x2b84041d},
-   {0x1, (const uint8_t *)"07650690295365319082", 20, 0x2afa0417},
-   {0x1, (const uint8_t *)"42655507906821911703", 20, 0x2aff0412},
-   {0x1, (const uint8_t *)"29977409200786225655", 20, 0x2b8d0420},
-   {0x1, (const uint8_t *)"85181542907229116674", 20, 0x2b140419},
-   {0x1, (const uint8_t *)"87963594337989416799", 20, 0x2c8e043f},
-   {0x1, (const uint8_t *)"21395988329504168551", 20, 0x2b68041f},
-   {0x1, (const uint8_t *)"51991013580943379423", 20, 0x2af10417},
-   {0x1, (const uint8_t *)"*]+@!);({_$;}[_},?{?;(_?,=-][@", 30, 0x7c9d0841},
-   {0x1, (const uint8_t *)"_@:_).&(#.[:[{[:)$++-($_;@[)}+", 30, 0x71060751},
-   {0x1, (const uint8_t *)"&[!,[$_==}+.]@!;*(+},[;:)$;)-@", 30, 0x7095070a},
-   {0x1, (const uint8_t *)"]{.[.+?+[[=;[?}_#&;[=)__$$:+=_", 30, 0x82530815},
-   {0x1, (const uint8_t *)"-%.)=/[@].:.(:,()$;=%@-$?]{%+%", 30, 0x61250661},
-   {0x1, (const uint8_t *)"+]#$(@&.=:,*];/.!]%/{:){:@(;)$", 30, 0x642006a3},
-   {0x1, (const uint8_t *)")-._.:?[&:.=+}(*$/=!.${;(=$@!}", 30, 0x674206cb},
-   {0x1, (const uint8_t *)":(_*&%/[[}+,?#$&*+#[([*-/#;%(]", 30, 0x67670680},
-   {0x1, (const uint8_t *)"{[#-;:$/{)(+[}#]/{&!%(@)%:@-$:", 30, 0x7547070f},
-   {0x1, (const uint8_t *)"_{$*,}(&,@.)):=!/%(&(,,-?$}}}!", 30, 0x69ea06ee},
-   {0x1, (const uint8_t *)"e$98KNzqaV)Y:2X?]77].{gKRD4G5{mHZk,Z)SpU%L3FSgv!Wb8MLAFdi{+fp)c,@8m6v)yXg@]HBDFk?.4&}g5_udE*JHCiH=aL", 100, 0x1b01e92},
-   {0x1, (const uint8_t *)"r*Fd}ef+5RJQ;+W=4jTR9)R*p!B;]Ed7tkrLi;88U7g@3v!5pk2X6D)vt,.@N8c]@yyEcKi[vwUu@.Ppm@C6%Mv*3Nw}Y,58_aH)", 100, 0xfbdb1e96},
-   {0x1, (const uint8_t *)"h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&", 100, 0x47a61ec8},
-   {0x1, (const uint8_t *)long_string, 5552, 0x8b81718f},
-   {0x7a30360d, (const uint8_t *)0x0, 0, 0x1},
-   {0x6fd767ee, (const uint8_t *)"", 1, 0xd7c567ee},
-   {0xefeb7589, (const uint8_t *)"a", 1, 0x65e475ea},
-   {0x61cf7e6b, (const uint8_t *)"abacus", 6, 0x60b880da},
-   {0xdc712e2,  (const uint8_t *)"backlog", 7, 0x9d0d15b5},
-   {0xad23c7fd, (const uint8_t *)"campfire", 8, 0xfbfecb44},
-   {0x85cb2317, (const uint8_t *)"delta", 5, 0x3b622521},
-   {0x9eed31b0, (const uint8_t *)"executable", 10, 0xa6db35d2},
-   {0xb94f34ca, (const uint8_t *)"file", 4, 0x9096366a},
-   {0xab058a2,  (const uint8_t *)"greatest", 8, 0xded05c01},
-   {0x5bff2b7a, (const uint8_t *)"inverter", 8, 0xc7452ee9},
-   {0x605c9a5f, (const uint8_t *)"jigsaw", 6, 0x7899ce4},
-   {0x51bdeea5, (const uint8_t *)"karate", 6, 0xf285f11d},
-   {0x85c21c79, (const uint8_t *)"landscape", 9, 0x98732024},
-   {0x97216f56, (const uint8_t *)"machine", 7, 0xadf4722b},
-   {0x18444af2, (const uint8_t *)"nanometer", 9, 0xcdb34ebb},
-   {0xbe6ce359, (const uint8_t *)"oblivion", 8, 0xe8b7e6bb},
-   {0x843071f1, (const uint8_t *)"panama", 6, 0x389e745f},
-   {0xf2480c60, (const uint8_t *)"quest", 5, 0x36c90e92},
-   {0x2d2feb3d, (const uint8_t *)"resource", 8, 0x9705eea5},
-   {0x7490310a, (const uint8_t *)"secret", 6, 0xa3a63390},
-   {0x97d247d4, (const uint8_t *)"ultimate", 8, 0xe6154b39},
-   {0x93cf7599, (const uint8_t *)"vector", 6, 0x5e87782c},
-   {0x73c84278, (const uint8_t *)"walrus", 6, 0xbc84516},
-   {0x228a87d1, (const uint8_t *)"xeno", 4, 0x4646898b},
-   {0xa7a048d0, (const uint8_t *)"yelling", 7, 0xb1654bc4},
-   {0x1f0ded40, (const uint8_t *)"zero", 4, 0xd8a4ef00},
-   {0xa804a62f, (const uint8_t *)"4BJD7PocN1VqX0jXVpWB", 20, 0xe34eac7b},
-   {0x508fae6a, (const uint8_t *)"F1rPWI7XvDs6nAIRx41l", 20, 0x33f2b4c8},
-   {0xe5adaf4f, (const uint8_t *)"ldhKlsVkPFOveXgkGtC2", 20, 0xe7b1b68c},
-   {0x67136a40, (const uint8_t *)"5KKnGOOrs8BvJ35iKTOS", 20, 0xf6a0708f},
-   {0xb00c4a10, (const uint8_t *)"0l1tw7GOcem06Ddu7yn4", 20, 0xbd8f509f},
-   {0x2e0c84b5, (const uint8_t *)"MCr47CjPIn9R1IvE1Tm5", 20, 0xcc298abd},
-   {0x81238d44, (const uint8_t *)"UcixbzPKTIv0SvILHVdO", 20, 0xd7809446},
-   {0xf853aa92, (const uint8_t *)"dGnAyAhRQDsWw0ESou24", 20, 0x9525b148},
-   {0x5a692325, (const uint8_t *)"di0nvmY9UYMYDh0r45XT", 20, 0x620029bc},
-   {0x3275b9f,  (const uint8_t *)"2XKDwHfAhFsV0RhbqtvH", 20, 0x70916284},
-   {0x38371feb, (const uint8_t *)"ZhrANFIiIvRnqClIVyeD", 20, 0xd52706},
-   {0xafc8bf62, (const uint8_t *)"v7Q9ehzioTOVeDIZioT1", 20, 0xeeb4c65a},
-   {0x9b07db73, (const uint8_t *)"Yod5hEeKcYqyhfXbhxj2", 20, 0xde3e2db},
-   {0xe75b214,  (const uint8_t *)"GehSWY2ay4uUKhehXYb0", 20, 0x4171b8f8},
-   {0x72d0fe6f, (const uint8_t *)"kwytJmq6UqpflV8Y8GoE", 20, 0xa66a05cd},
-   {0xf857a4b1, (const uint8_t *)"70684206568419061514", 20, 0x1f9a8c4},
-   {0x54b8e14,  (const uint8_t *)"42015093765128581010", 20, 0x49c19218},
-   {0xd6aa5616, (const uint8_t *)"88214814356148806939", 20, 0xbbfc5a38},
-   {0x11e63098, (const uint8_t *)"43472694284527343838", 20, 0x93434b8},
-   {0xbe92385,  (const uint8_t *)"49769333513942933689", 20, 0xfe1827af},
-   {0x49511de0, (const uint8_t *)"54979784887993251199", 20, 0xcba8221c},
-   {0x3db13bc1, (const uint8_t *)"58360544869206793220", 20, 0x14643fda},
-   {0xbb899bea, (const uint8_t *)"27347953487840714234", 20, 0x1604a006},
-   {0xf6cd9436, (const uint8_t *)"07650690295365319082", 20, 0xb69f984c},
-   {0x9109e6c3, (const uint8_t *)"42655507906821911703", 20, 0xc43eead4},
-   {0x75770fc,  (const uint8_t *)"29977409200786225655", 20, 0x707751b},
-   {0x69b1d19b, (const uint8_t *)"85181542907229116674", 20, 0xf5bdd5b3},
-   {0xc6132975, (const uint8_t *)"87963594337989416799", 20, 0x2fed2db3},
-   {0xd58cb00c, (const uint8_t *)"21395988329504168551", 20, 0xc2a2b42a},
-   {0xb63b8caa, (const uint8_t *)"51991013580943379423", 20, 0xdf0590c0},
-   {0x8a45a2b8, (const uint8_t *)"*]+@!);({_$;}[_},?{?;(_?,=-][@", 30, 0x1980aaf8},
-   {0xcbe95b78, (const uint8_t *)"_@:_).&(#.[:[{[:)$++-($_;@[)}+", 30, 0xf58662c8},
-   {0x4ef8a54b, (const uint8_t *)"&[!,[$_==}+.]@!;*(+},[;:)$;)-@", 30, 0x1f65ac54},
-   {0x76ad267a, (const uint8_t *)"]{.[.+?+[[=;[?}_#&;[=)__$$:+=_", 30, 0x7b792e8e},
-   {0x569e613c, (const uint8_t *)"-%.)=/[@].:.(:,()$;=%@-$?]{%+%", 30, 0x1d61679c},
-   {0x36aa61da, (const uint8_t *)"+]#$(@&.=:,*];/.!]%/{:){:@(;)$", 30, 0x12ec687c},
-   {0xf67222df, (const uint8_t *)")-._.:?[&:.=+}(*$/=!.${;(=$@!}", 30, 0x740329a9},
-   {0x74b34fd3, (const uint8_t *)":(_*&%/[[}+,?#$&*+#[([*-/#;%(]", 30, 0x374c5652},
-   {0x351fd770, (const uint8_t *)"{[#-;:$/{)(+[}#]/{&!%(@)%:@-$:", 30, 0xeadfde7e},
-   {0xc45aef77, (const uint8_t *)"_{$*,}(&,@.)):=!/%(&(,,-?$}}}!", 30, 0x3fcbf664},
-   {0xd034ea71, (const uint8_t *)"e$98KNzqaV)Y:2X?]77].{gKRD4G5{mHZk,Z)SpU%L3FSgv!Wb8MLAFdi{+fp)c,@8m6v)yXg@]HBDFk?.4&}g5_udE*JHCiH=aL", 100, 0x6b080911},
-   {0xdeadc0de, (const uint8_t *)"r*Fd}ef+5RJQ;+W=4jTR9)R*p!B;]Ed7tkrLi;88U7g@3v!5pk2X6D)vt,.@N8c]@yyEcKi[vwUu@.Ppm@C6%Mv*3Nw}Y,58_aH)", 100, 0x355fdf73},
-   {0xba5eba11, (const uint8_t *)"h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&", 100, 0xb48bd8d8},
-   {0x7712aa45, (const uint8_t *)long_string, 5552, 0x7dc51be2},
-};
-
-class adler32_variant : public ::testing::TestWithParam<adler32_test> {
+class adler32_variant : public ::testing::TestWithParam<hash_test> {
 public:
-    void hash(adler32_test param, adler32_func adler32) {
-        uint32_t adler = adler32((uint32_t)param.adler, param.buf, param.len);
-        EXPECT_EQ(adler, param.expect);
+    void hash(hash_test param, adler32_func adler32) {
+        uint32_t adler = adler32((uint32_t)param.initial_adler, param.buf, param.len);
+        EXPECT_EQ(adler, param.expect_adler);
     }
 };
 
-INSTANTIATE_TEST_SUITE_P(adler32, adler32_variant, testing::ValuesIn(tests));
+INSTANTIATE_TEST_SUITE_P(adler32, adler32_variant, testing::ValuesIn(hash_tests));
 
 #define TEST_ADLER32(name, func, support_flag) \
     TEST_P(adler32_variant, name) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             GTEST_SKIP(); \
             return; \
         } \
@@ -392,4 +65,11 @@ TEST_ADLER32(avx512, adler32_avx512, test_cpu_features.x86.has_avx512_common)
 TEST_ADLER32(avx512_vnni, adler32_avx512_vnni, test_cpu_features.x86.has_avx512vnni)
 #endif
 
+#ifdef LOONGARCH_LSX
+TEST_ADLER32(lsx, adler32_lsx, test_cpu_features.loongarch.has_lsx)
+#endif
+#ifdef LOONGARCH_LASX
+TEST_ADLER32(lasx, adler32_lasx, test_cpu_features.loongarch.has_lasx)
+#endif
+
 #endif
diff --git a/test/test_adler32_copy.cc b/test/test_adler32_copy.cc
new file mode 100644
index 00000000..725d86aa
--- /dev/null
+++ b/test/test_adler32_copy.cc
@@ -0,0 +1,83 @@
+/* test_adler32_copy.cc -- test for adler32 implementations while copying
+ * Copyright (C) 2025 Hans Kristian Rosbach
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include <gtest/gtest.h>
+
+extern "C" {
+#  include "zbuild.h"
+#  include "arch_functions.h"
+#  include "test_cpu_features.h"
+#  include "hash_test_strings_p.h"
+}
+
+class adler32_copy_variant : public ::testing::TestWithParam<hash_test> {
+protected:
+    uint8_t dstbuf[HASH_TEST_MAX_LENGTH];
+
+public:
+    /* Ensure that adler32 copy functions returns the correct adler and copies the data */
+    void adler32_copy_test(adler32_copy_func copyfunc, hash_test params) {
+        ASSERT_LE(params.len, HASH_TEST_MAX_LENGTH);
+
+        uint32_t adler = copyfunc(params.initial_adler, dstbuf, params.buf, params.len);
+
+        EXPECT_EQ(adler, params.expect_adler);
+        EXPECT_EQ(0, memcmp(params.buf, dstbuf, params.len));
+    }
+};
+
+INSTANTIATE_TEST_SUITE_P(adler32_copy, adler32_copy_variant, testing::ValuesIn(hash_tests));
+
+#define TEST_ADLER32_COPY(name, copyfunc, support_flag) \
+    TEST_P(adler32_copy_variant, name) { \
+        if (!(support_flag)) { \
+            GTEST_SKIP(); \
+            return; \
+        } \
+        adler32_copy_test(copyfunc, GetParam()); \
+    }
+
+// Base test
+TEST_ADLER32_COPY(c, adler32_copy_c, 1)
+
+#ifdef DISABLE_RUNTIME_CPU_DETECTION
+    // Native test
+    TEST_ADLER32_COPY(native, native_adler32_copy, 1)
+#else
+
+#ifdef ARM_NEON
+TEST_ADLER32_COPY(neon, adler32_copy_neon, test_cpu_features.arm.has_neon)
+#elif defined(POWER8_VSX)
+TEST_ADLER32_COPY(power8, adler32_copy_power8, test_cpu_features.power.has_arch_2_07)
+#elif defined(PPC_VMX)
+TEST_ADLER32_COPY(vmx, adler32_copy_vmx, test_cpu_features.power.has_altivec)
+#elif defined(RISCV_RVV)
+TEST_ADLER32_COPY(rvv, adler32_copy_rvv, test_cpu_features.riscv.has_rvv)
+#endif
+
+#ifdef X86_SSSE3
+TEST_ADLER32_COPY(ssse3, adler32_copy_ssse3, test_cpu_features.x86.has_ssse3)
+#endif
+#ifdef X86_SSE42
+TEST_ADLER32_COPY(sse42, adler32_copy_sse42, test_cpu_features.x86.has_sse42)
+#endif
+#ifdef X86_AVX2
+TEST_ADLER32_COPY(avx2, adler32_copy_avx2, test_cpu_features.x86.has_avx2)
+#endif
+#ifdef X86_AVX512
+TEST_ADLER32_COPY(avx512, adler32_copy_avx512, test_cpu_features.x86.has_avx512_common)
+#endif
+#ifdef X86_AVX512VNNI
+TEST_ADLER32_COPY(avx512_vnni, adler32_copy_avx512_vnni, test_cpu_features.x86.has_avx512vnni)
+#endif
+
+#ifdef LOONGARCH_LSX
+TEST_ADLER32_COPY(lsx, adler32_copy_lsx, test_cpu_features.loongarch.has_lsx)
+#endif
+#ifdef LOONGARCH_LASX
+TEST_ADLER32_COPY(lasx, adler32_copy_lasx, test_cpu_features.loongarch.has_lasx)
+#endif
+
+#endif
diff --git a/test/test_compare256.cc b/test/test_compare256.cc
index e1662cdf..c689023a 100644
--- a/test/test_compare256.cc
+++ b/test/test_compare256.cc
@@ -12,6 +12,7 @@ extern "C" {
 #  include "zutil.h"
 #  include "arch_functions.h"
 #  include "test_cpu_features.h"
+#  include "arch/generic/compare256_p.h"
 }
 
 #include <gtest/gtest.h>
@@ -52,34 +53,35 @@ static inline void compare256_match_check(compare256_func compare256) {
 
 #define TEST_COMPARE256(name, func, support_flag) \
     TEST(compare256, name) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             GTEST_SKIP(); \
             return; \
         } \
         compare256_match_check(func); \
     }
 
-TEST_COMPARE256(c, compare256_c, 1)
-
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 TEST_COMPARE256(native, native_compare256, 1)
 #else
 
-#if defined(UNALIGNED_OK) && BYTE_ORDER == LITTLE_ENDIAN
-TEST_COMPARE256(unaligned_16, compare256_unaligned_16, 1)
-#ifdef HAVE_BUILTIN_CTZ
-TEST_COMPARE256(unaligned_32, compare256_unaligned_32, 1)
-#endif
-#if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-TEST_COMPARE256(unaligned_64, compare256_unaligned_64, 1)
+TEST_COMPARE256(8, compare256_8, 1)
+TEST_COMPARE256(16, compare256_16, 1)
+#if defined(HAVE_BUILTIN_CTZ)
+TEST_COMPARE256(32, compare256_32, 1)
 #endif
+#if defined(HAVE_BUILTIN_CTZLL)
+TEST_COMPARE256(64, compare256_64, 1)
 #endif
+
 #if defined(X86_SSE2) && defined(HAVE_BUILTIN_CTZ)
 TEST_COMPARE256(sse2, compare256_sse2, test_cpu_features.x86.has_sse2)
 #endif
 #if defined(X86_AVX2) && defined(HAVE_BUILTIN_CTZ)
 TEST_COMPARE256(avx2, compare256_avx2, test_cpu_features.x86.has_avx2)
 #endif
+#if defined(X86_AVX512) && defined(HAVE_BUILTIN_CTZLL)
+TEST_COMPARE256(avx512, compare256_avx512, test_cpu_features.x86.has_avx512_common)
+#endif
 #if defined(ARM_NEON) && defined(HAVE_BUILTIN_CTZLL)
 TEST_COMPARE256(neon, compare256_neon, test_cpu_features.arm.has_neon)
 #endif
@@ -89,5 +91,11 @@ TEST_COMPARE256(power9, compare256_power9, test_cpu_features.power.has_arch_3_00
 #ifdef RISCV_RVV
 TEST_COMPARE256(rvv, compare256_rvv, test_cpu_features.riscv.has_rvv)
 #endif
+#if defined(LOONGARCH_LSX) && defined(HAVE_BUILTIN_CTZ)
+TEST_COMPARE256(lsx, compare256_lsx, test_cpu_features.loongarch.has_lsx)
+#endif
+#if defined(LOONGARCH_LASX) && defined(HAVE_BUILTIN_CTZ)
+TEST_COMPARE256(lasx, compare256_lasx, test_cpu_features.loongarch.has_lasx)
+#endif
 
 #endif
diff --git a/test/test_compare256_rle.cc b/test/test_compare256_rle.cc
index 5333ce76..2ed85083 100644
--- a/test/test_compare256_rle.cc
+++ b/test/test_compare256_rle.cc
@@ -43,21 +43,18 @@ static inline void compare256_rle_match_check(compare256_rle_func compare256_rle
 
 #define TEST_COMPARE256_RLE(name, func, support_flag) \
     TEST(compare256_rle, name) { \
-        if (!support_flag) { \
+        if (!(support_flag)) { \
             GTEST_SKIP(); \
             return; \
         } \
         compare256_rle_match_check(func); \
     }
 
-TEST_COMPARE256_RLE(c, compare256_rle_c, 1)
-
-#ifdef UNALIGNED_OK
-TEST_COMPARE256_RLE(unaligned_16, compare256_rle_unaligned_16, 1)
-#ifdef HAVE_BUILTIN_CTZ
-TEST_COMPARE256_RLE(unaligned_32, compare256_rle_unaligned_32, 1)
-#endif
-#if defined(UNALIGNED64_OK) && defined(HAVE_BUILTIN_CTZLL)
-TEST_COMPARE256_RLE(unaligned_64, compare256_rle_unaligned_64, 1)
+TEST_COMPARE256_RLE(8, compare256_rle_8, 1)
+TEST_COMPARE256_RLE(16, compare256_rle_16, 1)
+#if defined(HAVE_BUILTIN_CTZ)
+TEST_COMPARE256_RLE(32, compare256_rle_32, 1)
 #endif
+#if defined(HAVE_BUILTIN_CTZLL)
+TEST_COMPARE256_RLE(64, compare256_rle_64, 1)
 #endif
diff --git a/test/test_compress_bound.cc b/test/test_compress_bound.cc
index b83b59f4..1acda02f 100644
--- a/test/test_compress_bound.cc
+++ b/test/test_compress_bound.cc
@@ -34,7 +34,7 @@ public:
             uncompressed[j] = (uint8_t)j;
         }
 
-        for (z_size_t i = 0; i < MAX_LENGTH; i++) {
+        for (z_uintmax_t i = 0; i < MAX_LENGTH; i++) {
             z_uintmax_t dest_len = sizeof(dest);
 
             /* calculate actual output length */
diff --git a/test/test_crc32.cc b/test/test_crc32.cc
index 245a92fb..73752fe7 100644
--- a/test/test_crc32.cc
+++ b/test/test_crc32.cc
@@ -5,197 +5,60 @@
  * For conditions of distribution and use, see copyright notice in zlib.h
  */
 
-#include <stdio.h>
-#include <string.h>
-#include <stdlib.h>
+#include <gtest/gtest.h>
 
 extern "C" {
+#  include "zutil_p.h"
 #  include "zbuild.h"
 #  include "arch_functions.h"
 #  include "test_cpu_features.h"
+#  include "hash_test_strings_p.h"
 }
 
-#include <gtest/gtest.h>
+class crc32_variant : public ::testing::TestWithParam<hash_test> {
+public:
+    void hash(hash_test param, crc32_func crc32) {
+        uint32_t crc = crc32(param.initial_crc, param.buf, param.len);
+        EXPECT_EQ(crc, param.expect_crc);
+    }
+};
 
-typedef struct {
-    unsigned long crc;
-    const uint8_t *buf;
-    size_t len;
-    unsigned long expect;
-} crc32_test;
-
-static const crc32_test tests[] = {
-  {0x0, (const uint8_t *)0x0, 0, 0x0},
-  {0xffffffff, (const uint8_t *)0x0, 0, 0x0},
-  {0x0, (const uint8_t *)0x0, 255, 0x0}, /*  BZ 174799.  */
-  {0x0, (const uint8_t *)0x0, 256, 0x0},
-  {0x0, (const uint8_t *)0x0, 257, 0x0},
-  {0x0, (const uint8_t *)0x0, 32767, 0x0},
-  {0x0, (const uint8_t *)0x0, 32768, 0x0},
-  {0x0, (const uint8_t *)0x0, 32769, 0x0},
-  {0x0, (const uint8_t *)"", 0, 0x0},
-  {0xffffffff, (const uint8_t *)"", 0, 0xffffffff},
-  {0x0, (const uint8_t *)"abacus", 6, 0xc3d7115b},
-  {0x0, (const uint8_t *)"backlog", 7, 0x269205},
-  {0x0, (const uint8_t *)"campfire", 8, 0x22a515f8},
-  {0x0, (const uint8_t *)"delta", 5, 0x9643fed9},
-  {0x0, (const uint8_t *)"executable", 10, 0xd68eda01},
-  {0x0, (const uint8_t *)"file", 4, 0x8c9f3610},
-  {0x0, (const uint8_t *)"greatest", 8, 0xc1abd6cd},
-  {0x0, (const uint8_t *)"hello", 5, 0x3610a686},
-  {0x0, (const uint8_t *)"inverter", 8, 0xc9e962c9},
-  {0x0, (const uint8_t *)"jigsaw", 6, 0xce4e3f69},
-  {0x0, (const uint8_t *)"karate", 6, 0x890be0e2},
-  {0x0, (const uint8_t *)"landscape", 9, 0xc4e0330b},
-  {0x0, (const uint8_t *)"machine", 7, 0x1505df84},
-  {0x0, (const uint8_t *)"nanometer", 9, 0xd4e19f39},
-  {0x0, (const uint8_t *)"oblivion", 8, 0xdae9de77},
-  {0x0, (const uint8_t *)"panama", 6, 0x66b8979c},
-  {0x0, (const uint8_t *)"quest", 5, 0x4317f817},
-  {0x0, (const uint8_t *)"resource", 8, 0xbc91f416},
-  {0x0, (const uint8_t *)"secret", 6, 0x5ca2e8e5},
-  {0x0, (const uint8_t *)"test", 4, 0xd87f7e0c},
-  {0x0, (const uint8_t *)"ultimate", 8, 0x3fc79b0b},
-  {0x0, (const uint8_t *)"vector", 6, 0x1b6e485b},
-  {0x0, (const uint8_t *)"walrus", 6, 0xbe769b97},
-  {0x0, (const uint8_t *)"xeno", 4, 0xe7a06444},
-  {0x0, (const uint8_t *)"yelling", 7, 0xfe3944e5},
-  {0x0, (const uint8_t *)"zlib", 4, 0x73887d3a},
-  {0x0, (const uint8_t *)"4BJD7PocN1VqX0jXVpWB", 20, 0xd487a5a1},
-  {0x0, (const uint8_t *)"F1rPWI7XvDs6nAIRx41l", 20, 0x61a0132e},
-  {0x0, (const uint8_t *)"ldhKlsVkPFOveXgkGtC2", 20, 0xdf02f76},
-  {0x0, (const uint8_t *)"5KKnGOOrs8BvJ35iKTOS", 20, 0x579b2b0a},
-  {0x0, (const uint8_t *)"0l1tw7GOcem06Ddu7yn4", 20, 0xf7d16e2d},
-  {0x0, (const uint8_t *)"MCr47CjPIn9R1IvE1Tm5", 20, 0x731788f5},
-  {0x0, (const uint8_t *)"UcixbzPKTIv0SvILHVdO", 20, 0x7112bb11},
-  {0x0, (const uint8_t *)"dGnAyAhRQDsWw0ESou24", 20, 0xf32a0dac},
-  {0x0, (const uint8_t *)"di0nvmY9UYMYDh0r45XT", 20, 0x625437bb},
-  {0x0, (const uint8_t *)"2XKDwHfAhFsV0RhbqtvH", 20, 0x896930f9},
-  {0x0, (const uint8_t *)"ZhrANFIiIvRnqClIVyeD", 20, 0x8579a37},
-  {0x0, (const uint8_t *)"v7Q9ehzioTOVeDIZioT1", 20, 0x632aa8e0},
-  {0x0, (const uint8_t *)"Yod5hEeKcYqyhfXbhxj2", 20, 0xc829af29},
-  {0x0, (const uint8_t *)"GehSWY2ay4uUKhehXYb0", 20, 0x1b08b7e8},
-  {0x0, (const uint8_t *)"kwytJmq6UqpflV8Y8GoE", 20, 0x4e33b192},
-  {0x0, (const uint8_t *)"70684206568419061514", 20, 0x59a179f0},
-  {0x0, (const uint8_t *)"42015093765128581010", 20, 0xcd1013d7},
-  {0x0, (const uint8_t *)"88214814356148806939", 20, 0xab927546},
-  {0x0, (const uint8_t *)"43472694284527343838", 20, 0x11f3b20c},
-  {0x0, (const uint8_t *)"49769333513942933689", 20, 0xd562d4ca},
-  {0x0, (const uint8_t *)"54979784887993251199", 20, 0x233395f7},
-  {0x0, (const uint8_t *)"58360544869206793220", 20, 0x2d167fd5},
-  {0x0, (const uint8_t *)"27347953487840714234", 20, 0x8b5108ba},
-  {0x0, (const uint8_t *)"07650690295365319082", 20, 0xc46b3cd8},
-  {0x0, (const uint8_t *)"42655507906821911703", 20, 0xc10b2662},
-  {0x0, (const uint8_t *)"29977409200786225655", 20, 0xc9a0f9d2},
-  {0x0, (const uint8_t *)"85181542907229116674", 20, 0x9341357b},
-  {0x0, (const uint8_t *)"87963594337989416799", 20, 0xf0424937},
-  {0x0, (const uint8_t *)"21395988329504168551", 20, 0xd7c4c31f},
-  {0x0, (const uint8_t *)"51991013580943379423", 20, 0xf11edcc4},
-  {0x0, (const uint8_t *)"*]+@!);({_$;}[_},?{?;(_?,=-][@", 30, 0x40795df4},
-  {0x0, (const uint8_t *)"_@:_).&(#.[:[{[:)$++-($_;@[)}+", 30, 0xdd61a631},
-  {0x0, (const uint8_t *)"&[!,[$_==}+.]@!;*(+},[;:)$;)-@", 30, 0xca907a99},
-  {0x0, (const uint8_t *)"]{.[.+?+[[=;[?}_#&;[=)__$$:+=_", 30, 0xf652deac},
-  {0x0, (const uint8_t *)"-%.)=/[@].:.(:,()$;=%@-$?]{%+%", 30, 0xaf39a5a9},
-  {0x0, (const uint8_t *)"+]#$(@&.=:,*];/.!]%/{:){:@(;)$", 30, 0x6bebb4cf},
-  {0x0, (const uint8_t *)")-._.:?[&:.=+}(*$/=!.${;(=$@!}", 30, 0x76430bac},
-  {0x0, (const uint8_t *)":(_*&%/[[}+,?#$&*+#[([*-/#;%(]", 30, 0x6c80c388},
-  {0x0, (const uint8_t *)"{[#-;:$/{)(+[}#]/{&!%(@)%:@-$:", 30, 0xd54d977d},
-  {0x0, (const uint8_t *)"_{$*,}(&,@.)):=!/%(&(,,-?$}}}!", 30, 0xe3966ad5},
-  {0x0, (const uint8_t *)"e$98KNzqaV)Y:2X?]77].{gKRD4G5{mHZk,Z)SpU%L3FSgv!Wb8MLAFdi{+fp)c,@8m6v)yXg@]HBDFk?.4&}g5_udE*JHCiH=aL", 100, 0xe7c71db9},
-  {0x0, (const uint8_t *)"r*Fd}ef+5RJQ;+W=4jTR9)R*p!B;]Ed7tkrLi;88U7g@3v!5pk2X6D)vt,.@N8c]@yyEcKi[vwUu@.Ppm@C6%Mv*3Nw}Y,58_aH)", 100, 0xeaa52777},
-  {0x0, (const uint8_t *)"h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&", 100, 0xcd472048},
-  {0x7a30360d, (const uint8_t *)"abacus", 6, 0xf8655a84},
-  {0x6fd767ee, (const uint8_t *)"backlog", 7, 0x1ed834b1},
-  {0xefeb7589, (const uint8_t *)"campfire", 8, 0x686cfca},
-  {0x61cf7e6b, (const uint8_t *)"delta", 5, 0x1554e4b1},
-  {0xdc712e2,  (const uint8_t *)"executable", 10, 0x761b4254},
-  {0xad23c7fd, (const uint8_t *)"file", 4, 0x7abdd09b},
-  {0x85cb2317, (const uint8_t *)"greatest", 8, 0x4ba91c6b},
-  {0x9eed31b0, (const uint8_t *)"inverter", 8, 0xd5e78ba5},
-  {0xb94f34ca, (const uint8_t *)"jigsaw", 6, 0x23649109},
-  {0xab058a2,  (const uint8_t *)"karate", 6, 0xc5591f41},
-  {0x5bff2b7a, (const uint8_t *)"landscape", 9, 0xf10eb644},
-  {0x605c9a5f, (const uint8_t *)"machine", 7, 0xbaa0a636},
-  {0x51bdeea5, (const uint8_t *)"nanometer", 9, 0x6af89afb},
-  {0x85c21c79, (const uint8_t *)"oblivion", 8, 0xecae222b},
-  {0x97216f56, (const uint8_t *)"panama", 6, 0x47dffac4},
-  {0x18444af2, (const uint8_t *)"quest", 5, 0x70c2fe36},
-  {0xbe6ce359, (const uint8_t *)"resource", 8, 0x1471d925},
-  {0x843071f1, (const uint8_t *)"secret", 6, 0x50c9a0db},
-  {0xf2480c60, (const uint8_t *)"ultimate", 8, 0xf973daf8},
-  {0x2d2feb3d, (const uint8_t *)"vector", 6, 0x344ac03d},
-  {0x7490310a, (const uint8_t *)"walrus", 6, 0x6d1408ef},
-  {0x97d247d4, (const uint8_t *)"xeno", 4, 0xe62670b5},
-  {0x93cf7599, (const uint8_t *)"yelling", 7, 0x1b36da38},
-  {0x73c84278, (const uint8_t *)"zlib", 4, 0x6432d127},
-  {0x228a87d1, (const uint8_t *)"4BJD7PocN1VqX0jXVpWB", 20, 0x997107d0},
-  {0xa7a048d0, (const uint8_t *)"F1rPWI7XvDs6nAIRx41l", 20, 0xdc567274},
-  {0x1f0ded40, (const uint8_t *)"ldhKlsVkPFOveXgkGtC2", 20, 0xdcc63870},
-  {0xa804a62f, (const uint8_t *)"5KKnGOOrs8BvJ35iKTOS", 20, 0x6926cffd},
-  {0x508fae6a, (const uint8_t *)"0l1tw7GOcem06Ddu7yn4", 20, 0xb52b38bc},
-  {0xe5adaf4f, (const uint8_t *)"MCr47CjPIn9R1IvE1Tm5", 20, 0xf83b8178},
-  {0x67136a40, (const uint8_t *)"UcixbzPKTIv0SvILHVdO", 20, 0xc5213070},
-  {0xb00c4a10, (const uint8_t *)"dGnAyAhRQDsWw0ESou24", 20, 0xbc7648b0},
-  {0x2e0c84b5, (const uint8_t *)"di0nvmY9UYMYDh0r45XT", 20, 0xd8123a72},
-  {0x81238d44, (const uint8_t *)"2XKDwHfAhFsV0RhbqtvH", 20, 0xd5ac5620},
-  {0xf853aa92, (const uint8_t *)"ZhrANFIiIvRnqClIVyeD", 20, 0xceae099d},
-  {0x5a692325, (const uint8_t *)"v7Q9ehzioTOVeDIZioT1", 20, 0xb07d2b24},
-  {0x3275b9f,  (const uint8_t *)"Yod5hEeKcYqyhfXbhxj2", 20, 0x24ce91df},
-  {0x38371feb, (const uint8_t *)"GehSWY2ay4uUKhehXYb0", 20, 0x707b3b30},
-  {0xafc8bf62, (const uint8_t *)"kwytJmq6UqpflV8Y8GoE", 20, 0x16abc6a9},
-  {0x9b07db73, (const uint8_t *)"70684206568419061514", 20, 0xae1fb7b7},
-  {0xe75b214,  (const uint8_t *)"42015093765128581010", 20, 0xd4eecd2d},
-  {0x72d0fe6f, (const uint8_t *)"88214814356148806939", 20, 0x4660ec7},
-  {0xf857a4b1, (const uint8_t *)"43472694284527343838", 20, 0xfd8afdf7},
-  {0x54b8e14,  (const uint8_t *)"49769333513942933689", 20, 0xc6d1b5f2},
-  {0xd6aa5616, (const uint8_t *)"54979784887993251199", 20, 0x32476461},
-  {0x11e63098, (const uint8_t *)"58360544869206793220", 20, 0xd917cf1a},
-  {0xbe92385,  (const uint8_t *)"27347953487840714234", 20, 0x4ad14a12},
-  {0x49511de0, (const uint8_t *)"07650690295365319082", 20, 0xe37b5c6c},
-  {0x3db13bc1, (const uint8_t *)"42655507906821911703", 20, 0x7cc497f1},
-  {0xbb899bea, (const uint8_t *)"29977409200786225655", 20, 0x99781bb2},
-  {0xf6cd9436, (const uint8_t *)"85181542907229116674", 20, 0x132256a1},
-  {0x9109e6c3, (const uint8_t *)"87963594337989416799", 20, 0xbfdb2c83},
-  {0x75770fc,  (const uint8_t *)"21395988329504168551", 20, 0x8d9d1e81},
-  {0x69b1d19b, (const uint8_t *)"51991013580943379423", 20, 0x7b6d4404},
-  {0xc6132975, (const uint8_t *)"*]+@!);({_$;}[_},?{?;(_?,=-][@", 30, 0x8619f010},
-  {0xd58cb00c, (const uint8_t *)"_@:_).&(#.[:[{[:)$++-($_;@[)}+", 30, 0x15746ac3},
-  {0xb63b8caa, (const uint8_t *)"&[!,[$_==}+.]@!;*(+},[;:)$;)-@", 30, 0xaccf812f},
-  {0x8a45a2b8, (const uint8_t *)"]{.[.+?+[[=;[?}_#&;[=)__$$:+=_", 30, 0x78af45de},
-  {0xcbe95b78, (const uint8_t *)"-%.)=/[@].:.(:,()$;=%@-$?]{%+%", 30, 0x25b06b59},
-  {0x4ef8a54b, (const uint8_t *)"+]#$(@&.=:,*];/.!]%/{:){:@(;)$", 30, 0x4ba0d08f},
-  {0x76ad267a, (const uint8_t *)")-._.:?[&:.=+}(*$/=!.${;(=$@!}", 30, 0xe26b6aac},
-  {0x569e613c, (const uint8_t *)":(_*&%/[[}+,?#$&*+#[([*-/#;%(]", 30, 0x7e2b0a66},
-  {0x36aa61da, (const uint8_t *)"{[#-;:$/{)(+[}#]/{&!%(@)%:@-$:", 30, 0xb3430dc7},
-  {0xf67222df, (const uint8_t *)"_{$*,}(&,@.)):=!/%(&(,,-?$}}}!", 30, 0x626c17a},
-  {0x74b34fd3, (const uint8_t *)"e$98KNzqaV)Y:2X?]77].{gKRD4G5{mHZk,Z)SpU%L3FSgv!Wb8MLAFdi{+fp)c,@8m6v)yXg@]HBDFk?.4&}g5_udE*JHCiH=aL", 100, 0xccf98060},
-  {0x351fd770, (const uint8_t *)"r*Fd}ef+5RJQ;+W=4jTR9)R*p!B;]Ed7tkrLi;88U7g@3v!5pk2X6D)vt,.@N8c]@yyEcKi[vwUu@.Ppm@C6%Mv*3Nw}Y,58_aH)", 100, 0xd8b95312},
-  {0xc45aef77, (const uint8_t *)"h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&", 100, 0xbb1c9912},
-  {0xc45aef77, (const uint8_t *)
-    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
-    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
-    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
-    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
-    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&"
-    "h{bcmdC+a;t+Cf{6Y_dFq-{X4Yu&7uNfVDh?q&_u.UWJU],-GiH7ADzb7-V.Q%4=+v!$L9W+T=bP]$_:]Vyg}A.ygD.r;h-D]m%&", 600, 0x888AFA5B}
+/* Specifically to test where we had dodgy alignment in the ARMv8 CRC32
+ * function. All others are either byte level access or use intrinsics
+ * that work with unaligned access */
+class crc32_align : public ::testing::TestWithParam<int> {
+public:
+    void hash(int param, crc32_func crc32) {
+        uint8_t *buf = (uint8_t*)zng_alloc(sizeof(uint8_t) * (128 + param));
+        (void)crc32(0, buf + param, 128);
+        zng_free(buf);
+    }
 };
 
-class crc32_variant : public ::testing::TestWithParam<crc32_test> {
+/* Test large 1MB buffer with known CRC32 */
+class crc32_large_buf : public ::testing::Test {
+protected:
+    static uint8_t *buffer;
+    static const size_t buffer_size = 1024 * 1024;
+
+    static void SetUpTestSuite() {
+        buffer = (uint8_t*)zng_alloc(buffer_size);
+        memset(buffer, 0x55, buffer_size);
+    }
+
+    static void TearDownTestSuite() {
+        zng_free(buffer);
+    }
+
 public:
-    void hash(crc32_test param, crc32_func crc32) {
-        uint32_t crc = 0;
-        if (param.buf != NULL) {
-            if (param.len) {
-                crc = crc32(param.crc, param.buf, param.len);
-            } else {
-                crc = param.crc;
-            }
-        }
-        EXPECT_EQ(crc, param.expect);
+    void hash(crc32_func crc32) {
+        EXPECT_EQ(crc32(0, buffer, buffer_size), 0x0026D5FB);
     }
 };
 
-INSTANTIATE_TEST_SUITE_P(crc32, crc32_variant, testing::ValuesIn(tests));
+uint8_t *crc32_large_buf::buffer = nullptr;
+
+INSTANTIATE_TEST_SUITE_P(crc32, crc32_variant, testing::ValuesIn(hash_tests));
 
 #define TEST_CRC32(name, func, support_flag) \
     TEST_P(crc32_variant, name) { \
@@ -204,16 +67,51 @@ INSTANTIATE_TEST_SUITE_P(crc32, crc32_variant, testing::ValuesIn(tests));
             return; \
         } \
         hash(GetParam(), func); \
+    } \
+    TEST_F(crc32_large_buf, name) { \
+        if (!(support_flag)) { \
+            GTEST_SKIP(); \
+            return; \
+        } \
+        hash(func); \
     }
 
-TEST_CRC32(braid, PREFIX(crc32_braid), 1)
+TEST_CRC32(braid, crc32_braid, 1)
 
 #ifdef DISABLE_RUNTIME_CPU_DETECTION
 TEST_CRC32(native, native_crc32, 1)
+
 #else
 
-#ifdef ARM_ACLE
-TEST_CRC32(acle, crc32_acle, test_cpu_features.arm.has_crc32)
+#if defined(ARM_CRC32) || defined(LOONGARCH_CRC)
+static const int align_offsets[] = {
+    1, 2, 3, 4, 5, 6, 7
+};
+
+#define TEST_CRC32_ALIGN(name, func, support_flag) \
+    TEST_P(crc32_align, name) { \
+        if (!(support_flag)) { \
+            GTEST_SKIP(); \
+            return; \
+        } \
+        hash(GetParam(), func); \
+    }
+#endif
+
+#ifndef WITHOUT_CHORBA
+TEST_CRC32(chorba_c, crc32_chorba, 1)
+#endif
+#ifdef ARM_CRC32
+INSTANTIATE_TEST_SUITE_P(crc32_alignment, crc32_align, testing::ValuesIn(align_offsets));
+TEST_CRC32(armv8, crc32_armv8, test_cpu_features.arm.has_crc32)
+TEST_CRC32_ALIGN(armv8_align, crc32_armv8, test_cpu_features.arm.has_crc32)
+#endif
+#ifdef ARM_PMULL_EOR3
+TEST_CRC32(armv8_pmull_eor3, crc32_armv8_pmull_eor3, test_cpu_features.arm.has_crc32 && test_cpu_features.arm.has_pmull && test_cpu_features.arm.has_eor3)
+TEST_CRC32_ALIGN(armv8_pmull_eor3_align, crc32_armv8_pmull_eor3, test_cpu_features.arm.has_crc32 && test_cpu_features.arm.has_pmull && test_cpu_features.arm.has_eor3)
+#endif
+#ifdef RISCV_CRC32_ZBC
+TEST_CRC32(riscv, crc32_riscv64_zbc, test_cpu_features.riscv.has_zbc)
 #endif
 #ifdef POWER8_VSX_CRC32
 TEST_CRC32(power8, crc32_power8, test_cpu_features.power.has_arch_2_07)
@@ -227,5 +125,18 @@ TEST_CRC32(pclmulqdq, crc32_pclmulqdq, test_cpu_features.x86.has_pclmulqdq)
 #ifdef X86_VPCLMULQDQ_CRC
 TEST_CRC32(vpclmulqdq, crc32_vpclmulqdq, (test_cpu_features.x86.has_pclmulqdq && test_cpu_features.x86.has_avx512_common && test_cpu_features.x86.has_vpclmulqdq))
 #endif
+#ifndef WITHOUT_CHORBA_SSE
+#   ifdef X86_SSE2
+    TEST_CRC32(chorba_sse2, crc32_chorba_sse2, test_cpu_features.x86.has_sse2)
+#   endif
+#   ifdef X86_SSE41
+    TEST_CRC32(chorba_sse41, crc32_chorba_sse41, test_cpu_features.x86.has_sse41)
+#   endif
+#endif
+#ifdef LOONGARCH_CRC
+INSTANTIATE_TEST_SUITE_P(crc32_alignment, crc32_align, testing::ValuesIn(align_offsets));
+TEST_CRC32(loongarch64, crc32_loongarch64, test_cpu_features.loongarch.has_crc)
+TEST_CRC32_ALIGN(loongarch64_align, crc32_loongarch64, test_cpu_features.loongarch.has_crc)
+#endif
 
 #endif
diff --git a/test/test_crc32_copy.cc b/test/test_crc32_copy.cc
new file mode 100644
index 00000000..b7288432
--- /dev/null
+++ b/test/test_crc32_copy.cc
@@ -0,0 +1,80 @@
+/* test_crc32_copy.cc -- test for crc32 implementations while copying
+ * Copyright (C) 2025 Hans Kristian Rosbach
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#include <gtest/gtest.h>
+
+extern "C" {
+#  include "zbuild.h"
+#  include "arch_functions.h"
+#  include "test_cpu_features.h"
+#  include "hash_test_strings_p.h"
+}
+
+class crc32_copy_variant : public ::testing::TestWithParam<hash_test> {
+protected:
+    uint8_t dstbuf[HASH_TEST_MAX_LENGTH];
+
+public:
+    /* Ensure that crc32 copy functions returns the correct crc and copies the data */
+    void crc32_copy_test(crc32_copy_func copyfunc, hash_test params) {
+        ASSERT_LE(params.len, HASH_TEST_MAX_LENGTH);
+
+        uint32_t crc = copyfunc(params.initial_crc, dstbuf, params.buf, params.len);
+
+        EXPECT_EQ(crc, params.expect_crc);
+        EXPECT_EQ(0, memcmp(params.buf, dstbuf, params.len));
+    }
+};
+
+INSTANTIATE_TEST_SUITE_P(crc32_copy, crc32_copy_variant, testing::ValuesIn(hash_tests));
+
+#define TEST_CRC32_COPY(name, copyfunc, support_flag) \
+    TEST_P(crc32_copy_variant, name) { \
+        if (!(support_flag)) { \
+            GTEST_SKIP(); \
+            return; \
+        } \
+        crc32_copy_test(copyfunc, GetParam()); \
+    }
+
+// Base test
+TEST_CRC32_COPY(braid, crc32_copy_braid, 1)
+
+#ifdef DISABLE_RUNTIME_CPU_DETECTION
+    // Native test
+    TEST_CRC32_COPY(native, native_crc32_copy, 1)
+#else
+    // Optimized functions
+#  ifndef WITHOUT_CHORBA
+    TEST_CRC32_COPY(chorba, crc32_copy_chorba, 1)
+#  endif
+#  ifndef WITHOUT_CHORBA_SSE
+#    ifdef X86_SSE2
+    TEST_CRC32_COPY(chorba_sse2, crc32_copy_chorba_sse2, test_cpu_features.x86.has_sse2)
+#    endif
+#    ifdef X86_SSE41
+    TEST_CRC32_COPY(chorba_sse41, crc32_copy_chorba_sse41, test_cpu_features.x86.has_sse41)
+#    endif
+#  endif
+#  ifdef ARM_CRC32
+    TEST_CRC32_COPY(armv8, crc32_copy_armv8, test_cpu_features.arm.has_crc32)
+#  endif
+#  ifdef ARM_PMULL_EOR3
+    TEST_CRC32_COPY(armv8_pmull_eor3, crc32_copy_armv8_pmull_eor3, test_cpu_features.arm.has_crc32 && test_cpu_features.arm.has_pmull && test_cpu_features.arm.has_eor3)
+#  endif
+#  ifdef LOONGARCH_CRC
+    TEST_CRC32_COPY(loongarch, crc32_copy_loongarch64, test_cpu_features.loongarch.has_crc)
+#  endif
+#  ifdef RISCV_CRC32_ZBC
+    TEST_CRC32_COPY(riscv, crc32_copy_riscv64_zbc, test_cpu_features.riscv.has_zbc)
+#  endif
+#  ifdef X86_PCLMULQDQ_CRC
+    TEST_CRC32_COPY(pclmulqdq, crc32_copy_pclmulqdq, test_cpu_features.x86.has_pclmulqdq)
+#  endif
+#  ifdef X86_VPCLMULQDQ_CRC
+    TEST_CRC32_COPY(vpclmulqdq, crc32_copy_vpclmulqdq, (test_cpu_features.x86.has_pclmulqdq && test_cpu_features.x86.has_avx512_common && test_cpu_features.x86.has_vpclmulqdq))
+#  endif
+
+#endif
diff --git a/test/test_deflate_deterministic.cc b/test/test_deflate_deterministic.cc
new file mode 100644
index 00000000..5cb5cb4f
--- /dev/null
+++ b/test/test_deflate_deterministic.cc
@@ -0,0 +1,71 @@
+/* test_deflate_deterministic.cc - Test deterministic output after deflateReset */
+
+#include "zbuild.h"
+#ifdef ZLIB_COMPAT
+#  include "zlib.h"
+#else
+#  include "zlib-ng.h"
+#endif
+
+#include <string>
+#include <gtest/gtest.h>
+
+#include "deflate.h"
+#include "test_shared.h"
+
+
+
+/* Issue: https://github.com/zlib-ng/zlib-ng/issues/2100 */
+
+/* len(data_b) must be greater len(data_a) */
+static const uint8_t data_a[] = {  0 , 'A', 'A', 'A', 'A',  0 , 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A' };
+static const uint8_t data_b[] = { 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B' };
+
+static std::string compress_data(const uint8_t *src, size_t len, PREFIX3(stream)* z_stream) {
+    const uint32_t buffer_size = 1024;
+    uint8_t buffer[buffer_size];
+    int err;
+
+    z_stream->next_in = (z_const uint8_t *)src;
+    z_stream->avail_in = (uint32_t)len;
+    z_stream->next_out = buffer;
+    z_stream->avail_out = buffer_size;
+    err = PREFIX(deflate)(z_stream, Z_FINISH);
+    EXPECT_EQ(err, Z_STREAM_END);
+    return std::string((const char *)buffer, (size_t)(z_stream->next_out - buffer));
+}
+
+TEST(deflate, deterministic) {
+    const int compression_level = 6;
+    const int window_bits = 15;
+    int err;
+
+    PREFIX3(stream) a_stream;
+    memset(&a_stream, 0, sizeof(a_stream));
+
+    /* Compress a with newly created z_stream. */
+    err = PREFIX(deflateInit2)(&a_stream, compression_level, Z_DEFLATED, window_bits, 8, Z_DEFAULT_STRATEGY);
+    EXPECT_EQ(err, Z_OK);
+
+    const std::string a_compressed = compress_data(data_a, sizeof(data_a), &a_stream);
+    err = PREFIX(deflateEnd)(&a_stream);
+    EXPECT_EQ(err, Z_OK);
+
+    /* Compress b with newly created z_stream. */
+    PREFIX3(stream) b_stream;
+    memset(&b_stream, 0, sizeof(b_stream));
+
+    err = PREFIX(deflateInit2)(&b_stream, compression_level, Z_DEFLATED, window_bits, 8, Z_DEFAULT_STRATEGY);
+    EXPECT_EQ(err, Z_OK);
+    const std::string b_compressed = compress_data(data_b, sizeof(data_b), &b_stream);
+
+    /* Reset the stream. */
+    err = PREFIX(deflateReset)(&b_stream);
+    EXPECT_EQ(err, Z_OK);
+
+    const std::string a_compressed2 = compress_data(data_a, sizeof(data_a), &b_stream);
+    err = PREFIX(deflateEnd)(&b_stream);
+    EXPECT_EQ(err, Z_OK);
+
+    EXPECT_EQ(a_compressed, a_compressed2);
+}
diff --git a/test/test_gzio.cc b/test/test_gzio.cc
index 3cab1dbe..032e3e1c 100644
--- a/test/test_gzio.cc
+++ b/test/test_gzio.cc
@@ -30,6 +30,7 @@ TEST(gzip, readwrite) {
     gzFile file;
     int err;
 
+    Z_UNUSED(compr);
     /* Write gz file with test data */
     file = PREFIX(gzopen)(TESTFILE, "wb");
     ASSERT_TRUE(file != NULL);
diff --git a/test/test_shared_ng.h b/test/test_shared_ng.h
index 81e45199..f87ef027 100644
--- a/test/test_shared_ng.h
+++ b/test/test_shared_ng.h
@@ -8,7 +8,7 @@
 static inline int deflate_prime_32(PREFIX3(stream) *stream, uint32_t value) {
     int err;
 
-#ifdef ZLIBNG_ENABLE_TESTS
+#ifndef TEST_STOCK_ZLIB
     err = PREFIX(deflatePrime)(stream, 32, value);
 #else
     /* zlib's deflatePrime() takes at most 16 bits */
diff --git a/tools/makecrct.c b/tools/makecrct.c
index 9e65d249..812954ac 100644
--- a/tools/makecrct.c
+++ b/tools/makecrct.c
@@ -15,9 +15,9 @@
     and writes out the tables for the case that z_word_t is 32 bits.
 */
 
-#define W 8 /* Need a 64-bit integer type in order to generate crc32 tables. */
-
-#include "crc32_braid_p.h"
+#define POLY 0xedb88320         /* p(x) reflected, with x^32 implied */
+#define BRAID_W 8 /* Need a 64-bit integer type in order to generate crc32 tables. */
+typedef uint64_t z_word_t;
 
 static uint32_t crc_table[256];
 static z_word_t crc_big_table[256];
@@ -156,32 +156,31 @@ static void print_crc_table(void) {
     printf("};\n\n");
 
     /* print big-endian CRC table for 64-bit z_word_t */
-    printf("#ifdef W\n\n");
-    printf("#if W == 8\n\n");
+    printf("#ifdef BRAID_W\n");
+    printf("#  if BRAID_W == 8\n\n");
     printf("static const z_word_t crc_big_table[] = {\n");
     printf("    ");
     write_table64(crc_big_table, 256);
     printf("};\n\n");
 
     /* print big-endian CRC table for 32-bit z_word_t */
-    printf("#else /* W == 4 */\n\n");
+    printf("#  else /* BRAID_W == 4 */\n\n");
     printf("static const z_word_t crc_big_table[] = {\n");
     printf("    ");
     write_table32hi(crc_big_table, 256);
     printf("};\n\n");
-    printf("#endif\n\n");
-    printf("#endif /* W */\n\n");
+    printf("#  endif\n");
+    printf("#endif /* BRAID_W */\n\n");
 
     /* write out braid tables for each value of N */
     for (n = 1; n <= 6; n++) {
-        printf("#if N == %d\n", n);
+        printf("#if BRAID_N == %d\n", n);
 
         /* compute braid tables for this N and 64-bit word_t */
         braid(ltl, big, n, 8);
 
         /* write out braid tables for 64-bit z_word_t */
-        printf("\n");
-        printf("#if W == 8\n\n");
+        printf("#  if BRAID_W == 8\n\n");
         printf("static const uint32_t crc_braid_table[][256] = {\n");
         for (k = 0; k < 8; k++) {
             printf("   {");
@@ -202,7 +201,7 @@ static void print_crc_table(void) {
 
         /* write out braid tables for 32-bit z_word_t */
         printf("\n");
-        printf("#else /* W == 4 */\n\n");
+        printf("#  else /* BRAID_W == 4 */\n\n");
         printf("static const uint32_t crc_braid_table[][256] = {\n");
         for (k = 0; k < 4; k++) {
             printf("   {");
@@ -217,9 +216,8 @@ static void print_crc_table(void) {
             printf("}%s", k < 3 ? ",\n" : "");
         }
         printf("};\n\n");
-        printf("#endif /* W */\n\n");
-
-        printf("#endif /* N == %d */\n", n);
+        printf("#  endif /* BRAID_W */\n");
+        printf("#endif /* BRAID_N == %d */\n", n);
     }
     printf("\n");
 
diff --git a/tools/makefixed.c b/tools/makefixed.c
index 7fe71e75..13d4fa70 100644
--- a/tools/makefixed.c
+++ b/tools/makefixed.c
@@ -61,8 +61,8 @@ void makefixed(void) {
     for (;;) {
         if ((low % 7) == 0)
             printf("\n    ");
-        printf("{%u,%u,%d}", (low & 127) == 99 ? 64 : state.lencode[low].op,
-            state.lencode[low].bits, state.lencode[low].val);
+        printf("{%u,%u,%d}", state.lencode[low].bits, (low & 127) == 99 ? 64 : state.lencode[low].op,
+            state.lencode[low].val);
         if (++low == size)
             break;
         putchar(',');
@@ -74,7 +74,7 @@ void makefixed(void) {
     for (;;) {
         if ((low % 6) == 0)
             printf("\n    ");
-        printf("{%u,%u,%d}", state.distcode[low].op, state.distcode[low].bits, state.distcode[low].val);
+        printf("{%u,%u,%d}", state.distcode[low].bits, state.distcode[low].op, state.distcode[low].val);
         if (++low == size)
             break;
         putchar(',');
diff --git a/tools/maketrees.c b/tools/maketrees.c
index 2c32ccae..54c1d929 100644
--- a/tools/maketrees.c
+++ b/tools/maketrees.c
@@ -6,6 +6,7 @@
 #include <stdio.h>
 #include "zbuild.h"
 #include "deflate.h"
+#include "deflate_p.h"
 #include "trees.h"
 
 static ct_data static_ltree[L_CODES+2];
@@ -90,7 +91,7 @@ static void tr_static_init(void) {
     /* The static distance tree is trivial: */
     for (n = 0; n < D_CODES; n++) {
         static_dtree[n].Len = 5;
-        static_dtree[n].Code = PREFIX(bi_reverse)((unsigned)n, 5);
+        static_dtree[n].Code = bi_reverse((uint16_t)n, 5);
     }
 }
 
diff --git a/trees.c b/trees.c
index 9f2f4913..709a677e 100644
--- a/trees.c
+++ b/trees.c
@@ -32,6 +32,7 @@
 
 #include "zbuild.h"
 #include "deflate.h"
+#include "deflate_p.h"
 #include "trees.h"
 #include "trees_emit.h"
 #include "trees_tbl.h"
@@ -66,9 +67,9 @@ static const static_tree_desc  static_bl_desc =
  */
 
 static void init_block       (deflate_state *s);
-static void pqdownheap       (deflate_state *s, ct_data *tree, int k);
-static void gen_bitlen       (deflate_state *s, tree_desc *desc);
+static inline void pqdownheap       (unsigned char *depth, int *heap, const int heap_len, ct_data *tree, int k);
 static void build_tree       (deflate_state *s, tree_desc *desc);
+static void gen_bitlen       (deflate_state *s, tree_desc *desc);
 static void scan_tree        (deflate_state *s, ct_data *tree, int max_code);
 static void send_tree        (deflate_state *s, ct_data *tree, int max_code);
 static int  build_bl_tree    (deflate_state *s);
@@ -115,7 +116,7 @@ static void init_block(deflate_state *s) {
         s->bl_tree[n].Freq = 0;
 
     s->dyn_ltree[END_BLOCK].Freq = 1;
-    s->opt_len = s->static_len = 0L;
+    s->opt_len = s->static_len = 0;
     s->sym_next = s->matches = 0;
 }
 
@@ -123,17 +124,6 @@ static void init_block(deflate_state *s) {
 /* Index within the heap array of least frequent node in the Huffman tree */
 
 
-/* ===========================================================================
- * Remove the smallest element from the heap and recreate the heap with
- * one less element. Updates heap and heap_len.
- */
-#define pqremove(s, tree, top) \
-{\
-    top = s->heap[SMALLEST]; \
-    s->heap[SMALLEST] = s->heap[s->heap_len--]; \
-    pqdownheap(s, tree, SMALLEST); \
-}
-
 /* ===========================================================================
  * Compares to subtrees, using the tree depth as tie breaker when
  * the subtrees have equal frequency. This minimizes the worst case length.
@@ -142,34 +132,140 @@ static void init_block(deflate_state *s) {
     (tree[n].Freq < tree[m].Freq || \
     (tree[n].Freq == tree[m].Freq && depth[n] <= depth[m]))
 
+/* ===========================================================================
+ * Remove the smallest element from the heap and recreate the heap with
+ * one less element. Updates heap and heap_len. Used by build_tree().
+ */
+#define pqremove(s, depth, heap, tree, top) { \
+    top = heap[SMALLEST]; \
+    heap[SMALLEST] = heap[s->heap_len--]; \
+    pqdownheap(depth, heap, s->heap_len, tree, SMALLEST); \
+}
+
 /* ===========================================================================
  * Restore the heap property by moving down the tree starting at node k,
  * exchanging a node with the smallest of its two sons if necessary, stopping
  * when the heap property is re-established (each father smaller than its
- * two sons).
+ * two sons). Used by build_tree().
  */
-static void pqdownheap(deflate_state *s, ct_data *tree, int k) {
+static inline void pqdownheap(unsigned char *depth, int *heap, const int heap_len, ct_data *tree, int k) {
     /* tree: the tree to restore */
     /* k: node to move down */
-    int v = s->heap[k];
     int j = k << 1;  /* left son of k */
-    while (j <= s->heap_len) {
+    const int v = heap[k];
+
+    while (j <= heap_len) {
         /* Set j to the smallest of the two sons: */
-        if (j < s->heap_len && smaller(tree, s->heap[j+1], s->heap[j], s->depth)) {
+        if (j < heap_len && smaller(tree, heap[j+1], heap[j], depth)) {
             j++;
         }
         /* Exit if v is smaller than both sons */
-        if (smaller(tree, v, s->heap[j], s->depth))
+        if (smaller(tree, v, heap[j], depth))
             break;
 
         /* Exchange v with the smallest son */
-        s->heap[k] = s->heap[j];
+        heap[k] = heap[j];
         k = j;
 
         /* And continue down the tree, setting j to the left son of k */
         j <<= 1;
     }
-    s->heap[k] = v;
+    heap[k] = v;
+}
+
+/* ===========================================================================
+ * Construct one Huffman tree and assigns the code bit strings and lengths.
+ * Update the total bit length for the current block.
+ * IN assertion: the field freq is set for all tree elements.
+ * OUT assertions: the fields len and code are set to the optimal bit length
+ *     and corresponding code. The length opt_len is updated; static_len is
+ *     also updated if stree is not null. The field max_code is set.
+ */
+static void build_tree(deflate_state *s, tree_desc *desc) {
+    /* desc: the tree descriptor */
+    unsigned char *depth  = s->depth;
+    int *heap             = s->heap;
+    ct_data *tree         = desc->dyn_tree;
+    const ct_data *stree  = desc->stat_desc->static_tree;
+    int elems             = desc->stat_desc->elems;
+    int n, m;          /* iterate over heap elements */
+    int max_code = -1; /* largest code with non zero frequency */
+    int node;          /* new node being created */
+
+    /* Construct the initial heap, with least frequent element in
+     * heap[SMALLEST]. The sons of heap[n] are heap[2*n] and heap[2*n+1].
+     * heap[0] is not used.
+     */
+    s->heap_len = 0;
+    s->heap_max = HEAP_SIZE;
+
+    for (n = 0; n < elems; n++) {
+        if (tree[n].Freq != 0) {
+            heap[++(s->heap_len)] = max_code = n;
+            depth[n] = 0;
+        } else {
+            tree[n].Len = 0;
+        }
+    }
+
+    /* The pkzip format requires that at least one distance code exists,
+     * and that at least one bit should be sent even if there is only one
+     * possible code. So to avoid special checks later on we force at least
+     * two codes of non zero frequency.
+     */
+    while (s->heap_len < 2) {
+        node = heap[++(s->heap_len)] = (max_code < 2 ? ++max_code : 0);
+        tree[node].Freq = 1;
+        depth[node] = 0;
+        s->opt_len--;
+        if (stree)
+            s->static_len -= stree[node].Len;
+        /* node is 0 or 1 so it does not have extra bits */
+    }
+    desc->max_code = max_code;
+
+    /* The elements heap[heap_len/2+1 .. heap_len] are leaves of the tree,
+     * establish sub-heaps of increasing lengths:
+     */
+    for (n = s->heap_len/2; n >= 1; n--)
+        pqdownheap(depth, heap, s->heap_len, tree, n);
+
+    /* Construct the Huffman tree by repeatedly combining the least two
+     * frequent nodes.
+     */
+    node = elems;              /* next internal node of the tree */
+    do {
+        pqremove(s, depth, heap, tree, n);  /* n = node of least frequency */
+        m = heap[SMALLEST]; /* m = node of next least frequency */
+
+        heap[--(s->heap_max)] = n; /* keep the nodes sorted by frequency */
+        heap[--(s->heap_max)] = m;
+
+        /* Create a new node father of n and m */
+        tree[node].Freq = tree[n].Freq + tree[m].Freq;
+        depth[node] = (unsigned char)((depth[n] >= depth[m] ?
+                                          depth[n] : depth[m]) + 1);
+        tree[n].Dad = tree[m].Dad = (uint16_t)node;
+#ifdef DUMP_BL_TREE
+        if (tree == s->bl_tree) {
+            fprintf(stderr, "\nnode %d(%d), sons %d(%d) %d(%d)",
+                    node, tree[node].Freq, n, tree[n].Freq, m, tree[m].Freq);
+        }
+#endif
+        /* and insert the new node in the heap */
+        heap[SMALLEST] = node++;
+        pqdownheap(depth, heap, s->heap_len, tree, SMALLEST);
+    } while (s->heap_len >= 2);
+
+    heap[--(s->heap_max)] = heap[SMALLEST];
+
+    /* At this point, the fields freq and dad are set. We can now
+     * generate the bit lengths.
+     */
+    gen_bitlen(s, (tree_desc *)desc);
+
+    /* The field len is now set, we can generate the bit codes */
+    gen_codes((ct_data *)tree, max_code, s->bl_count);
 }
 
 /* ===========================================================================
@@ -180,7 +276,7 @@ static void pqdownheap(deflate_state *s, ct_data *tree, int k) {
  * OUT assertions: the field len is set to the optimal bit length, the
  *     array bl_count contains the frequencies for each bit length.
  *     The length opt_len is updated; static_len is also updated if stree is
- *     not null.
+ *     not null. Used by build_tree().
  */
 static void gen_bitlen(deflate_state *s, tree_desc *desc) {
     /* desc: the tree descriptor */
@@ -223,9 +319,9 @@ static void gen_bitlen(deflate_state *s, tree_desc *desc) {
         if (n >= base)
             xbits = extra[n-base];
         f = tree[n].Freq;
-        s->opt_len += (unsigned long)f * (unsigned int)(bits + xbits);
+        s->opt_len += (unsigned int)f * (unsigned int)(bits + xbits);
         if (stree)
-            s->static_len += (unsigned long)f * (unsigned int)(stree[n].Len + xbits);
+            s->static_len += (unsigned int)f * (unsigned int)(stree[n].Len + xbits);
     }
     if (overflow == 0)
         return;
@@ -260,8 +356,8 @@ static void gen_bitlen(deflate_state *s, tree_desc *desc) {
                 continue;
             if (tree[m].Len != bits) {
                 Tracev((stderr, "code %d bits %d->%u\n", m, tree[m].Len, bits));
-                s->opt_len += (unsigned long)(bits * tree[m].Freq);
-                s->opt_len -= (unsigned long)(tree[m].Len * tree[m].Freq);
+                s->opt_len += (unsigned int)(bits * tree[m].Freq);
+                s->opt_len -= (unsigned int)(tree[m].Len * tree[m].Freq);
                 tree[m].Len = (uint16_t)bits;
             }
             n--;
@@ -275,14 +371,14 @@ static void gen_bitlen(deflate_state *s, tree_desc *desc) {
  * IN assertion: the array bl_count contains the bit length statistics for
  * the given tree and the field len is set for all tree elements.
  * OUT assertion: the field code is set for all tree elements of non
- *     zero code length.
+ *     zero code length. Used by build_tree().
  */
 Z_INTERNAL void gen_codes(ct_data *tree, int max_code, uint16_t *bl_count) {
     /* tree: the tree to decorate */
     /* max_code: largest code with non zero frequency */
     /* bl_count: number of codes at each bit length */
     uint16_t next_code[MAX_BITS+1];  /* next code value for each bit length */
-    unsigned int code = 0;           /* running code value */
+    uint16_t code = 0;               /* running code value */
     int bits;                        /* bit index */
     int n;                           /* code index */
 
@@ -291,7 +387,7 @@ Z_INTERNAL void gen_codes(ct_data *tree, int max_code, uint16_t *bl_count) {
      */
     for (bits = 1; bits <= MAX_BITS; bits++) {
         code = (code + bl_count[bits-1]) << 1;
-        next_code[bits] = (uint16_t)code;
+        next_code[bits] = code;
     }
     /* Check that the bit counts in bl_count are consistent. The last code
      * must be all ones.
@@ -304,106 +400,13 @@ Z_INTERNAL void gen_codes(ct_data *tree, int max_code, uint16_t *bl_count) {
         if (len == 0)
             continue;
         /* Now reverse the bits */
-        tree[n].Code = PREFIX(bi_reverse)(next_code[len]++, len);
+        tree[n].Code = bi_reverse(next_code[len]++, len);
 
         Tracecv(tree != static_ltree, (stderr, "\nn %3d %c l %2d c %4x (%x) ",
              n, (isgraph(n & 0xff) ? n : ' '), len, tree[n].Code, next_code[len]-1));
     }
 }
 
-/* ===========================================================================
- * Construct one Huffman tree and assigns the code bit strings and lengths.
- * Update the total bit length for the current block.
- * IN assertion: the field freq is set for all tree elements.
- * OUT assertions: the fields len and code are set to the optimal bit length
- *     and corresponding code. The length opt_len is updated; static_len is
- *     also updated if stree is not null. The field max_code is set.
- */
-static void build_tree(deflate_state *s, tree_desc *desc) {
-    /* desc: the tree descriptor */
-    ct_data *tree         = desc->dyn_tree;
-    const ct_data *stree  = desc->stat_desc->static_tree;
-    int elems             = desc->stat_desc->elems;
-    int n, m;          /* iterate over heap elements */
-    int max_code = -1; /* largest code with non zero frequency */
-    int node;          /* new node being created */
-
-    /* Construct the initial heap, with least frequent element in
-     * heap[SMALLEST]. The sons of heap[n] are heap[2*n] and heap[2*n+1].
-     * heap[0] is not used.
-     */
-    s->heap_len = 0;
-    s->heap_max = HEAP_SIZE;
-
-    for (n = 0; n < elems; n++) {
-        if (tree[n].Freq != 0) {
-            s->heap[++(s->heap_len)] = max_code = n;
-            s->depth[n] = 0;
-        } else {
-            tree[n].Len = 0;
-        }
-    }
-
-    /* The pkzip format requires that at least one distance code exists,
-     * and that at least one bit should be sent even if there is only one
-     * possible code. So to avoid special checks later on we force at least
-     * two codes of non zero frequency.
-     */
-    while (s->heap_len < 2) {
-        node = s->heap[++(s->heap_len)] = (max_code < 2 ? ++max_code : 0);
-        tree[node].Freq = 1;
-        s->depth[node] = 0;
-        s->opt_len--;
-        if (stree)
-            s->static_len -= stree[node].Len;
-        /* node is 0 or 1 so it does not have extra bits */
-    }
-    desc->max_code = max_code;
-
-    /* The elements heap[heap_len/2+1 .. heap_len] are leaves of the tree,
-     * establish sub-heaps of increasing lengths:
-     */
-    for (n = s->heap_len/2; n >= 1; n--)
-        pqdownheap(s, tree, n);
-
-    /* Construct the Huffman tree by repeatedly combining the least two
-     * frequent nodes.
-     */
-    node = elems;              /* next internal node of the tree */
-    do {
-        pqremove(s, tree, n);  /* n = node of least frequency */
-        m = s->heap[SMALLEST]; /* m = node of next least frequency */
-
-        s->heap[--(s->heap_max)] = n; /* keep the nodes sorted by frequency */
-        s->heap[--(s->heap_max)] = m;
-
-        /* Create a new node father of n and m */
-        tree[node].Freq = tree[n].Freq + tree[m].Freq;
-        s->depth[node] = (unsigned char)((s->depth[n] >= s->depth[m] ?
-                                          s->depth[n] : s->depth[m]) + 1);
-        tree[n].Dad = tree[m].Dad = (uint16_t)node;
-#ifdef DUMP_BL_TREE
-        if (tree == s->bl_tree) {
-            fprintf(stderr, "\nnode %d(%d), sons %d(%d) %d(%d)",
-                    node, tree[node].Freq, n, tree[n].Freq, m, tree[m].Freq);
-        }
-#endif
-        /* and insert the new node in the heap */
-        s->heap[SMALLEST] = node++;
-        pqdownheap(s, tree, SMALLEST);
-    } while (s->heap_len >= 2);
-
-    s->heap[--(s->heap_max)] = s->heap[SMALLEST];
-
-    /* At this point, the fields freq and dad are set. We can now
-     * generate the bit lengths.
-     */
-    gen_bitlen(s, (tree_desc *)desc);
-
-    /* The field len is now set, we can generate the bit codes */
-    gen_codes((ct_data *)tree, max_code, s->bl_count);
-}
-
 /* ===========================================================================
  * Scan a literal or distance tree to determine the frequencies of the codes
  * in the bit length tree.
@@ -544,8 +547,8 @@ static int build_bl_tree(deflate_state *s) {
             break;
     }
     /* Update opt_len to include the bit length tree and counts */
-    s->opt_len += 3*((unsigned long)max_blindex+1) + 5+5+4;
-    Tracev((stderr, "\ndyn trees: dyn %lu, stat %lu", s->opt_len, s->static_len));
+    s->opt_len += 3*((unsigned int)max_blindex+1) + 5+5+4;
+    Tracev((stderr, "\ndyn trees: dyn %u, stat %u", s->opt_len, s->static_len));
 
     return max_blindex;
 }
@@ -626,7 +629,7 @@ void Z_INTERNAL zng_tr_flush_block(deflate_state *s, char *buf, uint32_t stored_
     /* buf: input block, or NULL if too old */
     /* stored_len: length of input block */
     /* last: one if this is the last block for a file */
-    unsigned long opt_lenb, static_lenb; /* opt_len and static_len in bytes */
+    unsigned int opt_lenb, static_lenb; /* opt_len and static_len in bytes */
     int max_blindex = 0;  /* index of last bit length code of non zero freq */
 
     /* Build the Huffman trees unless a stored block is forced */
@@ -641,10 +644,10 @@ void Z_INTERNAL zng_tr_flush_block(deflate_state *s, char *buf, uint32_t stored_
 
         /* Construct the literal and distance trees */
         build_tree(s, (tree_desc *)(&(s->l_desc)));
-        Tracev((stderr, "\nlit data: dyn %lu, stat %lu", s->opt_len, s->static_len));
+        Tracev((stderr, "\nlit data: dyn %u, stat %u", s->opt_len, s->static_len));
 
         build_tree(s, (tree_desc *)(&(s->d_desc)));
-        Tracev((stderr, "\ndist data: dyn %lu, stat %lu", s->opt_len, s->static_len));
+        Tracev((stderr, "\ndist data: dyn %u, stat %u", s->opt_len, s->static_len));
         /* At this point, opt_len and static_len are the total bit lengths of
          * the compressed block data, excluding the tree representations.
          */
@@ -655,10 +658,10 @@ void Z_INTERNAL zng_tr_flush_block(deflate_state *s, char *buf, uint32_t stored_
         max_blindex = build_bl_tree(s);
 
         /* Determine the best encoding. Compute the block lengths in bytes. */
-        opt_lenb = (s->opt_len+3+7) >> 3;
-        static_lenb = (s->static_len+3+7) >> 3;
+        opt_lenb = (s->opt_len + 3 + 7) >> 3;
+        static_lenb = (s->static_len + 3 + 7) >> 3;
 
-        Tracev((stderr, "\nopt %lu(%lu) stat %lu(%lu) stored %u lit %u ",
+        Tracev((stderr, "\nopt %u(%u) stat %u(%u) stored %u lit %u ",
                 opt_lenb, s->opt_len, static_lenb, s->static_len, stored_len,
                 s->sym_next / 3));
 
@@ -712,15 +715,24 @@ static void compress_block(deflate_state *s, const ct_data *ltree, const ct_data
     int lc;             /* match length or unmatched char (if dist == 0) */
     unsigned sx = 0;    /* running index in symbol buffers */
 
-    if (s->sym_next != 0) {
+    /* Local pointers to avoid indirection */
+    const unsigned int sym_next = s->sym_next;
+#ifdef LIT_MEM
+    uint16_t *d_buf = s->d_buf;
+    unsigned char *l_buf = s->l_buf;
+#else
+    unsigned char *sym_buf = s->sym_buf;
+#endif
+
+    if (sym_next != 0) {
         do {
 #ifdef LIT_MEM
-            dist = s->d_buf[sx];
-            lc = s->l_buf[sx++];
+            dist = d_buf[sx];
+            lc = l_buf[sx++];
 #else
-            dist = s->sym_buf[sx++] & 0xff;
-            dist += (unsigned)(s->sym_buf[sx++] & 0xff) << 8;
-            lc = s->sym_buf[sx++];
+            dist = sym_buf[sx++] & 0xff;
+            dist += (unsigned)(sym_buf[sx++] & 0xff) << 8;
+            lc = sym_buf[sx++];
 #endif
             if (dist == 0) {
                 zng_emit_lit(s, ltree, lc);
@@ -734,7 +746,7 @@ static void compress_block(deflate_state *s, const ct_data *ltree, const ct_data
 #else
             Assert(s->pending < s->lit_bufsize + sx, "pending_buf overflow");
 #endif
-        } while (sx < s->sym_next);
+        } while (sx < sym_next);
     }
 
     zng_emit_end_block(s, ltree, 0);
@@ -744,9 +756,9 @@ static void compress_block(deflate_state *s, const ct_data *ltree, const ct_data
  * Check if the data type is TEXT or BINARY, using the following algorithm:
  * - TEXT if the two conditions below are satisfied:
  *    a) There are no non-portable control characters belonging to the
- *       "black list" (0..6, 14..25, 28..31).
+ *       "block list" (0..6, 14..25, 28..31).
  *    b) There is at least one printable character belonging to the
- *       "white list" (9 {TAB}, 10 {LF}, 13 {CR}, 32..255).
+ *       "allow list" (9 {TAB}, 10 {LF}, 13 {CR}, 32..255).
  * - BINARY otherwise.
  * - The following partially-portable control characters form a
  *   "gray list" that is ignored in this detection algorithm:
@@ -754,26 +766,26 @@ static void compress_block(deflate_state *s, const ct_data *ltree, const ct_data
  * IN assertion: the fields Freq of dyn_ltree are set.
  */
 static int detect_data_type(deflate_state *s) {
-    /* black_mask is the bit mask of black-listed bytes
+    /* block_mask is the bit mask of block-listed bytes
      * set bits 0..6, 14..25, and 28..31
      * 0xf3ffc07f = binary 11110011111111111100000001111111
      */
-    unsigned long black_mask = 0xf3ffc07fUL;
+    unsigned long block_mask = 0xf3ffc07fUL;
     int n;
 
-    /* Check for non-textual ("black-listed") bytes. */
-    for (n = 0; n <= 31; n++, black_mask >>= 1)
-        if ((black_mask & 1) && (s->dyn_ltree[n].Freq != 0))
+    /* Check for non-textual ("block-listed") bytes. */
+    for (n = 0; n <= 31; n++, block_mask >>= 1)
+        if ((block_mask & 1) && (s->dyn_ltree[n].Freq != 0))
             return Z_BINARY;
 
-    /* Check for textual ("white-listed") bytes. */
+    /* Check for textual ("allow-listed") bytes. */
     if (s->dyn_ltree[9].Freq != 0 || s->dyn_ltree[10].Freq != 0 || s->dyn_ltree[13].Freq != 0)
         return Z_TEXT;
     for (n = 32; n < LITERALS; n++)
         if (s->dyn_ltree[n].Freq != 0)
             return Z_TEXT;
 
-    /* There are no "black-listed" or "white-listed" bytes:
+    /* There are no "block-listed" or "allow-listed" bytes:
      * this stream either is empty or has tolerated ("gray-listed") bytes only.
      */
     return Z_BINARY;
@@ -804,15 +816,3 @@ void Z_INTERNAL zng_tr_flush_bits(deflate_state *s) {
         s->bi_valid -= 8;
     }
 }
-
-/* ===========================================================================
- * Reverse the first len bits of a code using bit manipulation
- */
-Z_INTERNAL uint16_t PREFIX(bi_reverse)(unsigned code, int len) {
-    /* code: the value to invert */
-    /* len: its bit length */
-    Assert(len >= 1 && len <= 15, "code length must be 1-15");
-#define bitrev8(b) \
-    (uint8_t)((((uint8_t)(b) * 0x80200802ULL) & 0x0884422110ULL) * 0x0101010101ULL >> 32)
-    return (bitrev8(code >> 8) | (uint16_t)bitrev8(code) << 8) >> (16 - len);
-}
diff --git a/trees_emit.h b/trees_emit.h
index 922daae5..1585dbd7 100644
--- a/trees_emit.h
+++ b/trees_emit.h
@@ -38,6 +38,10 @@ extern Z_INTERNAL const int base_dist[D_CODES];
 /* If not enough room in bi_buf, use (valid) bits from bi_buf and
  * (64 - bi_valid) bits from value, leaving (width - (64-bi_valid))
  * unused bits in value.
+ *
+ * NOTE: Static analyzers can't evaluate value of total_bits, so we
+ *       also need to make sure bi_valid is within acceptable range,
+ *       otherwise the shifts will overflow.
  */
 #define send_bits(s, t_val, t_len, bi_buf, bi_valid) {\
     uint64_t val = (uint64_t)t_val;\
@@ -45,10 +49,10 @@ extern Z_INTERNAL const int base_dist[D_CODES];
     uint32_t total_bits = bi_valid + len;\
     send_bits_trace(s, val, len);\
     sent_bits_add(s, len);\
-    if (total_bits < BIT_BUF_SIZE) {\
+    if (total_bits < BIT_BUF_SIZE && bi_valid < BIT_BUF_SIZE) {\
         bi_buf |= val << bi_valid;\
         bi_valid = total_bits;\
-    } else if (bi_valid == BIT_BUF_SIZE) {\
+    } else if (bi_valid >= BIT_BUF_SIZE) {\
         put_uint64(s, bi_buf);\
         bi_buf = val;\
         bi_valid = len;\
@@ -74,7 +78,7 @@ extern Z_INTERNAL const int base_dist[D_CODES];
 /* ===========================================================================
  * Flush the bit buffer and align the output on a byte boundary
  */
-static void bi_windup(deflate_state *s) {
+static inline void bi_windup(deflate_state *s) {
     if (s->bi_valid > 56) {
         put_uint64(s, s->bi_buf);
     } else {
@@ -116,7 +120,7 @@ static inline uint32_t zng_emit_lit(deflate_state *s, const ct_data *ltree, unsi
 /* ===========================================================================
  * Emit match distance/length code
  */
-static inline uint32_t zng_emit_dist(deflate_state *s, const ct_data *ltree, const ct_data *dtree,
+static uint32_t zng_emit_dist(deflate_state *s, const ct_data *ltree, const ct_data *dtree,
     uint32_t lc, uint32_t dist) {
     uint32_t c, extra;
     uint8_t code;
diff --git a/uncompr.c b/uncompr.c
index 311eca2b..1db4d26a 100644
--- a/uncompr.c
+++ b/uncompr.c
@@ -22,7 +22,7 @@
    Z_DATA_ERROR if the input data was corrupted, including if the input data is
    an incomplete zlib stream.
 */
-int Z_EXPORT PREFIX(uncompress2)(unsigned char *dest, z_uintmax_t *destLen, const unsigned char *source, z_uintmax_t *sourceLen) {
+z_int32_t Z_EXPORT PREFIX(uncompress2)(unsigned char *dest, z_uintmax_t *destLen, const unsigned char *source, z_uintmax_t *sourceLen) {
     PREFIX3(stream) stream;
     int err;
     const unsigned int max = (unsigned int)-1;
@@ -75,6 +75,6 @@ int Z_EXPORT PREFIX(uncompress2)(unsigned char *dest, z_uintmax_t *destLen, cons
            err;
 }
 
-int Z_EXPORT PREFIX(uncompress)(unsigned char *dest, z_uintmax_t *destLen, const unsigned char *source, z_uintmax_t sourceLen) {
+z_int32_t Z_EXPORT PREFIX(uncompress)(unsigned char *dest, z_uintmax_t *destLen, const unsigned char *source, z_uintmax_t sourceLen) {
     return PREFIX(uncompress2)(dest, destLen, source, &sourceLen);
 }
diff --git a/win32/Makefile.a64 b/win32/Makefile.a64
deleted file mode 100644
index 9f8d6fb7..00000000
--- a/win32/Makefile.a64
+++ /dev/null
@@ -1,252 +0,0 @@
-# Makefile for zlib using Microsoft (Visual) C
-# zlib is copyright (C) 1995-2024 Jean-loup Gailly and Mark Adler
-#
-# Usage:
-#   nmake -f win32/Makefile.a64                          (standard build)
-#   nmake -f win32/Makefile.a64 LOC=-DFOO                (nonstandard build)
-
-# The toplevel directory of the source tree.
-#
-TOP = .
-
-# optional build flags
-LOC =
-
-# variables
-STATICLIB = zlib.lib
-SHAREDLIB = zlib1.dll
-IMPLIB    = zdll.lib
-SYMBOL_PREFIX =
-
-CC = cl
-LD = link
-AR = lib
-RC = rc
-CP = copy /y
-INCLUDES = -I$(TOP) -I$(TOP)/arch/arm -I$(TOP)/arch/generic
-CFLAGS  = -nologo -MD -W3 -O2 -Oy- -Zi -Fd"zlib" $(LOC) $(INCLUDES)
-WFLAGS  = \
-	-D_ARM64_WINAPI_PARTITION_DESKTOP_SDK_AVAILABLE=1 \
-	-D_CRT_SECURE_NO_DEPRECATE \
-	-D_CRT_NONSTDC_NO_DEPRECATE \
-	-DARM_FEATURES \
-	-DARM_NEON_HASLD4 \
-	#
-LDFLAGS = -nologo -debug -incremental:no -opt:ref -manifest
-ARFLAGS = -nologo
-RCFLAGS = /dARM64 /r
-DEFFILE = zlib.def
-RCFILE = zlib1.rc
-RESFILE = zlib1.res
-WITH_GZFILEOP = yes
-ZLIB_COMPAT =
-SUFFIX =
-
-OBJS = \
-	adler32.obj \
-	adler32_c.obj \
-	adler32_fold_c.obj \
-	arm_features.obj \
-	chunkset_c.obj \
-	compare256_c.obj \
-	compress.obj \
-	cpu_features.obj \
-	crc32.obj \
-	crc32_braid_c.obj \
-	crc32_braid_comb.obj \
-	crc32_fold_c.obj \
-	deflate.obj \
-	deflate_fast.obj \
-	deflate_huff.obj \
-	deflate_medium.obj \
-	deflate_quick.obj \
-	deflate_rle.obj \
-	deflate_slow.obj \
-	deflate_stored.obj \
-	functable.obj \
-	infback.obj \
-	inflate.obj \
-	inftrees.obj \
-	insert_string.obj \
-	insert_string_roll.obj \
-	slide_hash_c.obj \
-	trees.obj \
-	uncompr.obj \
-	zutil.obj \
-	#
-!if "$(ZLIB_COMPAT)" != ""
-WITH_GZFILEOP = yes
-WFLAGS = $(WFLAGS) -DZLIB_COMPAT
-DEFFILE = zlibcompat.def
-!else
-STATICLIB = zlib-ng.lib
-SHAREDLIB = zlib-ng1.dll
-IMPLIB = zngdll.lib
-DEFFILE = zlib-ng.def
-RCFILE = zlib-ng1.rc
-RESFILE = zlib-ng1.res
-SUFFIX = -ng
-!endif
-
-!if "$(WITH_GZFILEOP)" != ""
-WFLAGS = $(WFLAGS) -DWITH_GZFILEOP
-OBJS = $(OBJS) gzlib.obj gzread.obj gzwrite.obj
-!endif
-
-WFLAGS = $(WFLAGS) \
-	-DARM_ACLE \
-	-D__ARM_NEON__=1 \
-	-DARM_NEON \
-	-DARM_NOCHECK_NEON \
-	#
-OBJS = $(OBJS) crc32_acle.obj adler32_neon.obj chunkset_neon.obj compare256_neon.obj slide_hash_neon.obj
-
-# targets
-all: $(STATICLIB) $(SHAREDLIB) $(IMPLIB) \
-     example.exe minigzip.exe example_d.exe minigzip_d.exe
-
-!if "$(SYMBOL_PREFIX)" != ""
-zlib_name_mangling$(SUFFIX).h: zlib_name_mangling$(SUFFIX).h.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\zlib_name_mangling$(SUFFIX).h.in zlib_name_mangling$(SUFFIX).h "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-!else
-zlib_name_mangling$(SUFFIX).h: zlib_name_mangling.h.empty
-	$(CP) $(TOP)\zlib_name_mangling.h.empty zlib_name_mangling$(SUFFIX).h
-!endif
-
-zlib$(SUFFIX).h: zlib$(SUFFIX).h.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\zlib$(SUFFIX).h.in zlib$(SUFFIX).h "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-gzread.c: gzread.c.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\gzread.c.in gzread.c "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-zconf: $(TOP)/zconf$(SUFFIX).h.in $(TOP)/zlib$(SUFFIX).h $(TOP)/zlib_name_mangling$(SUFFIX).h
-	$(CP) $(TOP)\zconf$(SUFFIX).h.in $(TOP)\zconf$(SUFFIX).h
-
-$(TOP)/win32/$(DEFFILE): $(TOP)/win32/$(DEFFILE).in
-	cscript $(TOP)\win32\replace.vbs $(TOP)/win32/$(DEFFILE).in $(TOP)/win32/$(DEFFILE) "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-$(STATICLIB): zconf $(OBJS)
-	$(AR) $(ARFLAGS) -out:$@ $(OBJS)
-
-$(IMPLIB): $(SHAREDLIB)
-
-$(SHAREDLIB): zconf $(TOP)/win32/$(DEFFILE) $(OBJS) $(RESFILE)
-	$(LD) $(LDFLAGS) -def:$(TOP)/win32/$(DEFFILE) -dll -implib:$(IMPLIB) \
-	  -out:$@ -base:0x55A4C0000 $(OBJS) $(RESFILE)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;2
-
-example.exe: example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	$(LD) $(LDFLAGS) example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-minigzip.exe: minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	$(LD) $(LDFLAGS) minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-example_d.exe: example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	$(LD) $(LDFLAGS) -out:$@ example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-minigzip_d.exe: minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	$(LD) $(LDFLAGS) -out:$@ minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-{$(TOP)}.c.obj:
-	$(CC) -c $(WFLAGS) $(CFLAGS) $<
-
-gzlib2.obj: gzlib.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzlib2.obj gzlib.c
-
-gzread2.obj: gzread.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzread2.obj gzread.c
-
-gzwrite2.obj: gzwrite.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzwrite2.obj gzwrite.c
-
-{$(TOP)/arch/arm}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) $<
-
-{$(TOP)/arch/generic}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) $<
-
-{$(TOP)/test}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP $<
-
-$(TOP)/zconf$(SUFFIX).h: zconf
-
-adler32.obj: $(TOP)/adler32.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/adler32_p.h
-adler32_c.obj: $(TOP)/arch/generic/adler32_c.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/adler32_p.h
-adler32_fold_c.obj: $(TOP)/arch/generic/adler32_fold_c.c $(TOP)/zbuild.h $(TOP)/functable.h
-chunkset_c.obj: $(TOP)/arch/generic/chunkset_c.c $(TOP)/zbuild.h $(TOP)/chunkset_tpl.h $(TOP)/inffast_tpl.h
-compare256_c.obj: $(TOP)/arch/generic/compare256_c.c $(TOP)/zbuild.h $(TOP)/zutil_p.h $(TOP)/deflate.h $(TOP)/fallback_builtins.h $(TOP)/match_tpl.h
-compress.obj: $(TOP)/compress.c $(TOP)/zbuild.h $(TOP)/zutil.h
-cpu_features.obj: $(TOP)/cpu_features.c $(TOP)/cpu_features.h $(TOP)/zbuild.h
-crc32.obj: $(TOP)/crc32.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/crc32_braid_tbl.h
-crc32_braid_c.obj: $(TOP)/arch/generic/crc32_braid_c.c $(TOP)/zbuild.h $(TOP)/crc32_braid_p.h $(TOP)/crc32_braid_tbl.h
-crc32_braid_comb.obj: $(TOP)/crc32_braid_comb.c $(TOP)/zutil.h $(TOP)/crc32_braid_p.h $(TOP)/crc32_braid_tbl.h $(TOP)/crc32_braid_comb_p.h
-crc32_fold_c.obj: $(TOP)/arch/generic/crc32_fold_c.c $(TOP)/zbuild.h $(TOP)/crc32.h $(TOP)/functable.h $(TOP)/zutil.h
-deflate.obj: $(TOP)/deflate.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_fast.obj: $(TOP)/deflate_fast.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_huff.obj: $(TOP)/deflate_huff.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_medium.obj: $(TOP)/deflate_medium.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_quick.obj: $(TOP)/deflate_quick.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h $(TOP)/trees_emit.h $(TOP)/zutil_p.h
-deflate_rle.obj: $(TOP)/deflate_rle.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h $(TOP)/compare256_rle.h
-deflate_slow.obj: $(TOP)/deflate_slow.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_stored.obj: $(TOP)/deflate_stored.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-functable.obj: $(TOP)/functable.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/cpu_features.h $(TOP)/arch/arm/arm_features.h $(TOP)/arch_functions.h
-gzlib.obj: $(TOP)/gzlib.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-gzread.obj: $(TOP)/gzread.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-gzwrite.obj: $(TOP)/gzwrite.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-infback.obj: $(TOP)/infback.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h $(TOP)/inflate.h $(TOP)/inflate_p.h $(TOP)/functable.h
-inflate.obj: $(TOP)/inflate.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h $(TOP)/inflate.h $(TOP)/inflate_p.h $(TOP)/functable.h $(TOP)/inffixed_tbl.h
-inftrees.obj: $(TOP)/inftrees.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h
-insert_string.obj: $(TOP)/insert_string.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/insert_string_tpl.h
-insert_string_roll.obj: $(TOP)/insert_string_roll.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/insert_string_tpl.h
-slide_hash_c.obj: $(TOP)/arch/generic/slide_hash_c.c $(TOP)/zbuild.h $(TOP)/deflate.h
-slide_hash_neon.obj: $(TOP)/arch/arm/slide_hash_neon.c $(TOP)/arch/arm/neon_intrins.h $(TOP)/zbuild.h $(TOP)/deflate.h
-trees.obj: $(TOP)/trees.c $(TOP)/trees.h $(TOP)/trees_emit.h $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/trees_tbl.h
-uncompr.obj: $(TOP)/uncompr.c $(TOP)/zbuild.h $(TOP)/zutil.h
-zutil.obj: $(TOP)/zutil.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/zutil_p.h
-
-$(RESFILE): $(TOP)/win32/$(RCFILE)
-	$(RC) $(RCFLAGS) /fo$@ $(TOP)/win32/$(RCFILE)
-
-# testing
-test: example.exe minigzip.exe
-	example
-	echo hello world | minigzip | minigzip -d
-
-testdll: example_d.exe minigzip_d.exe
-	example_d
-	echo hello world | minigzip_d | minigzip_d -d
-
-example.obj: $(TOP)/test/example.c $(TOP)/zbuild.h $(TOP)/zlib$(SUFFIX).h $(TOP)/deflate.h $(TOP)/test/test_shared_ng.h
-
-minigzip.obj: $(TOP)/test/minigzip.c $(TOP)/zbuild.h $(TOP)/zlib$(SUFFIX).h
-
-
-# cleanup
-clean:
-	-del $(STATICLIB)
-	-del $(SHAREDLIB)
-	-del $(IMPLIB)
-	-del *.obj
-	-del *.res
-	-del *.exp
-	-del *.exe
-	-del *.pdb
-	-del *.manifest
-
-distclean: clean
-	-del zconf$(SUFFIX).h
-	-del zlib$(SUFFIX).h
-	-del zlib_name_mangling$(SUFFIX).h
-	-del $(TOP)\win32\zlib.def
-	-del $(TOP)\win32\zlibcompat.def
-	-del $(TOP)\win32\zlib-ng.def
-	-del gzread.c
diff --git a/win32/Makefile.arm b/win32/Makefile.arm
deleted file mode 100644
index cab999df..00000000
--- a/win32/Makefile.arm
+++ /dev/null
@@ -1,272 +0,0 @@
-# Makefile for zlib using Microsoft (Visual) C
-# zlib is copyright (C) 1995-2024 Jean-loup Gailly and Mark Adler
-#
-# Usage:
-#   nmake -f win32/Makefile.arm                          (standard build)
-#   nmake -f win32/Makefile.arm LOC=-DFOO                (nonstandard build)
-
-# The toplevel directory of the source tree.
-#
-TOP = .
-
-# optional build flags
-LOC =
-
-# variables
-STATICLIB = zlib.lib
-SHAREDLIB = zlib1.dll
-IMPLIB    = zdll.lib
-SYMBOL_PREFIX =
-
-CC = cl
-LD = link
-AR = lib
-RC = rc
-CP = copy /y
-INCLUDES = -I$(TOP) -I$(TOP)/arch/arm -I$(TOP)/arch/generic
-CFLAGS  = -nologo -MD -W3 -O2 -Oy- -Zi -Fd"zlib" $(LOC) $(INCLUDES)
-WFLAGS  = \
-	-D_ARM_WINAPI_PARTITION_DESKTOP_SDK_AVAILABLE=1 \
-	-D_CRT_SECURE_NO_DEPRECATE \
-	-D_CRT_NONSTDC_NO_DEPRECATE \
-	-DARM_FEATURES \
-	-DARM_NEON_HASLD4 \
-	#
-LDFLAGS = -nologo -debug -incremental:no -opt:ref -manifest
-ARFLAGS = -nologo
-RCFLAGS = /dARM /r
-DEFFILE = zlib.def
-RCFILE = zlib1.rc
-RESFILE = zlib1.res
-WITH_GZFILEOP = yes
-ZLIB_COMPAT =
-WITH_ACLE =
-WITH_NEON =
-WITH_ARMV6 =
-WITH_VFPV3 =
-NEON_ARCH = /arch:VFPv4
-SUFFIX =
-
-OBJS = \
-	adler32.obj \
-	adler32_c.obj \
-	adler32_fold_c.obj \
-	arm_features.obj \
-	chunkset_c.obj \
-	compare256_c.obj \
-	compress.obj \
-	cpu_features.obj \
-	crc32.obj \
-	crc32_braid_c.obj \
-	crc32_braid_comb.obj \
-	crc32_fold_c.obj \
-	deflate.obj \
-	deflate_fast.obj \
-	deflate_huff.obj \
-	deflate_medium.obj \
-	deflate_quick.obj \
-	deflate_rle.obj \
-	deflate_slow.obj \
-	deflate_stored.obj \
-	functable.obj \
-	infback.obj \
-	inflate.obj \
-	inftrees.obj \
-	insert_string.obj \
-	insert_string_roll.obj \
-	slide_hash_c.obj \
-	trees.obj \
-	uncompr.obj \
-	zutil.obj \
-	#
-!if "$(ZLIB_COMPAT)" != ""
-WITH_GZFILEOP = yes
-WFLAGS = $(WFLAGS) -DZLIB_COMPAT
-DEFFILE = zlibcompat.def
-!else
-STATICLIB = zlib-ng.lib
-SHAREDLIB = zlib-ng1.dll
-IMPLIB = zngdll.lib
-DEFFILE = zlib-ng.def
-RCFILE = zlib-ng1.rc
-RESFILE = zlib-ng1.res
-SUFFIX = -ng
-!endif
-
-!if "$(WITH_GZFILEOP)" != ""
-WFLAGS = $(WFLAGS) -DWITH_GZFILEOP
-OBJS = $(OBJS) gzlib.obj gzread.obj gzwrite.obj
-!endif
-
-!if "$(WITH_ACLE)" != ""
-WFLAGS = $(WFLAGS) -DARM_ACLE
-OBJS = $(OBJS) crc32_acle.obj
-!endif
-!if "$(WITH_VFPV3)" != ""
-NEON_ARCH = /arch:VFPv3
-!endif
-!if "$(WITH_NEON)" != ""
-CFLAGS = $(CFLAGS) $(NEON_ARCH)
-WFLAGS = $(WFLAGS) \
-	-D__ARM_NEON__=1 \
-	-DARM_NEON \
-	-DARM_NOCHECK_NEON \
-	#
-OBJS = $(OBJS) adler32_neon.obj chunkset_neon.obj compare256_neon.obj slide_hash_neon.obj
-!endif
-!if "$(WITH_ARMV6)" != ""
-WFLAGS = $(WFLAGS) \
-	-DARM_SIMD \
-	-DARM_NOCHECK_SIMD \
-	#
-OBJS = $(OBJS) slide_hash_armv6.obj
-!endif
-
-# targets
-all: $(STATICLIB) $(SHAREDLIB) $(IMPLIB) \
-     example.exe minigzip.exe example_d.exe minigzip_d.exe
-
-!if "$(SYMBOL_PREFIX)" != ""
-zlib_name_mangling$(SUFFIX).h: zlib_name_mangling$(SUFFIX).h.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\zlib_name_mangling$(SUFFIX).h.in zlib_name_mangling$(SUFFIX).h "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-!else
-zlib_name_mangling$(SUFFIX).h: zlib_name_mangling.h.empty
-	$(CP) $(TOP)\zlib_name_mangling.h.empty zlib_name_mangling$(SUFFIX).h
-!endif
-
-zlib$(SUFFIX).h: zlib$(SUFFIX).h.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\zlib$(SUFFIX).h.in zlib$(SUFFIX).h "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-gzread.c: gzread.c.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\gzread.c.in gzread.c "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-zconf: $(TOP)/zconf$(SUFFIX).h.in $(TOP)/zlib$(SUFFIX).h $(TOP)/zlib_name_mangling$(SUFFIX).h
-	$(CP) $(TOP)\zconf$(SUFFIX).h.in $(TOP)\zconf$(SUFFIX).h
-
-$(TOP)/win32/$(DEFFILE): $(TOP)/win32/$(DEFFILE).in
-	cscript $(TOP)\win32\replace.vbs $(TOP)/win32/$(DEFFILE).in $(TOP)/win32/$(DEFFILE) "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-$(STATICLIB): zconf $(OBJS)
-	$(AR) $(ARFLAGS) -out:$@ $(OBJS)
-
-$(IMPLIB): $(SHAREDLIB)
-
-$(SHAREDLIB): zconf $(TOP)/win32/$(DEFFILE) $(OBJS) $(RESFILE)
-	$(LD) $(LDFLAGS) -def:$(TOP)/win32/$(DEFFILE) -dll -implib:$(IMPLIB) \
-	  -out:$@ -base:0x5A4C0000 $(OBJS) $(RESFILE)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;2
-
-example.exe: example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	$(LD) $(LDFLAGS) example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-minigzip.exe: minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	$(LD) $(LDFLAGS) minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-example_d.exe: example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	$(LD) $(LDFLAGS) -out:$@ example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-minigzip_d.exe: minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	$(LD) $(LDFLAGS) -out:$@ minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-{$(TOP)}.c.obj:
-	$(CC) -c $(WFLAGS) $(CFLAGS) $<
-
-gzlib2.obj: gzlib.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzlib2.obj gzlib.c
-
-gzread2.obj: gzread.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzread2.obj gzread.c
-
-gzwrite2.obj: gzwrite.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzwrite2.obj gzwrite.c
-
-{$(TOP)/arch/arm}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) $<
-
-{$(TOP)/arch/generic}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) $<
-
-{$(TOP)/test}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP $<
-
-$(TOP)/zconf$(SUFFIX).h: zconf
-
-adler32.obj: $(TOP)/adler32.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/adler32_p.h
-adler32_c.obj: $(TOP)/arch/generic/adler32_c.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/adler32_p.h
-adler32_fold_c.obj: $(TOP)/arch/generic/adler32_fold_c.c $(TOP)/zbuild.h $(TOP)/functable.h
-chunkset_c.obj: $(TOP)/arch/generic/chunkset_c.c $(TOP)/zbuild.h $(TOP)/chunkset_tpl.h $(TOP)/inffast_tpl.h
-compare256_c.obj: $(TOP)/arch/generic/compare256_c.c $(TOP)/zbuild.h $(TOP)/zutil_p.h $(TOP)/deflate.h $(TOP)/fallback_builtins.h $(TOP)/match_tpl.h
-compress.obj: $(TOP)/compress.c $(TOP)/zbuild.h $(TOP)/zutil.h
-cpu_features.obj: $(TOP)/cpu_features.c $(TOP)/cpu_features.h $(TOP)/zbuild.h
-crc32.obj: $(TOP)/crc32.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/crc32_braid_tbl.h
-crc32_braid_c.obj: $(TOP)/arch/generic/crc32_braid_c.c $(TOP)/zbuild.h $(TOP)/crc32_braid_p.h $(TOP)/crc32_braid_tbl.h
-crc32_braid_comb.obj: $(TOP)/crc32_braid_comb.c $(TOP)/zutil.h $(TOP)/crc32_braid_p.h $(TOP)/crc32_braid_tbl.h $(TOP)/crc32_braid_comb_p.h
-crc32_fold_c.obj: $(TOP)/arch/generic/crc32_fold_c.c $(TOP)/zbuild.h $(TOP)/crc32.h $(TOP)/functable.h $(TOP)/zutil.h
-deflate.obj: $(TOP)/deflate.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_fast.obj: $(TOP)/deflate_fast.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_huff.obj: $(TOP)/deflate_huff.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_medium.obj: $(TOP)/deflate_medium.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_quick.obj: $(TOP)/deflate_quick.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h $(TOP)/trees_emit.h $(TOP)/zutil_p.h
-deflate_rle.obj: $(TOP)/deflate_rle.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h $(TOP)/compare256_rle.h
-deflate_slow.obj: $(TOP)/deflate_slow.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_stored.obj: $(TOP)/deflate_stored.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-functable.obj: $(TOP)/functable.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/cpu_features.h $(TOP)/arch/arm/arm_features.h $(TOP)/arch_functions.h
-gzlib.obj: $(TOP)/gzlib.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-gzread.obj: $(TOP)/gzread.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-gzwrite.obj: $(TOP)/gzwrite.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-infback.obj: $(TOP)/infback.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h $(TOP)/inflate.h $(TOP)/inflate_p.h $(TOP)/functable.h
-inflate.obj: $(TOP)/inflate.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h $(TOP)/inflate.h $(TOP)/inflate_p.h $(TOP)/functable.h $(TOP)/inffixed_tbl.h
-inftrees.obj: $(TOP)/inftrees.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h
-insert_string.obj: $(TOP)/insert_string.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/insert_string_tpl.h
-insert_string_roll.obj: $(TOP)/insert_string_roll.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/insert_string_tpl.h
-slide_hash_c.obj: $(TOP)/arch/generic/slide_hash_c.c $(TOP)/zbuild.h $(TOP)/deflate.h
-trees.obj: $(TOP)/trees.c $(TOP)/trees.h $(TOP)/trees_emit.h $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/trees_tbl.h
-uncompr.obj: $(TOP)/uncompr.c $(TOP)/zbuild.h $(TOP)/zutil.h
-zutil.obj: $(TOP)/zutil.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/zutil_p.h
-
-$(RESFILE): $(TOP)/win32/$(RCFILE)
-	$(RC) $(RCFLAGS) /fo$@ $(TOP)/win32/$(RCFILE)
-
-# testing
-test: example.exe minigzip.exe
-	example
-	echo hello world | minigzip | minigzip -d
-
-testdll: example_d.exe minigzip_d.exe
-	example_d
-	echo hello world | minigzip_d | minigzip_d -d
-
-example.obj: $(TOP)/test/example.c $(TOP)/zbuild.h $(TOP)/zlib$(SUFFIX).h $(TOP)/deflate.h $(TOP)/test/test_shared_ng.h
-
-minigzip.obj: $(TOP)/test/minigzip.c $(TOP)/zbuild.h $(TOP)/zlib$(SUFFIX).h
-
-
-# cleanup
-clean:
-	-del $(STATICLIB)
-	-del $(SHAREDLIB)
-	-del $(IMPLIB)
-	-del *.obj
-	-del *.res
-	-del *.exp
-	-del *.exe
-	-del *.pdb
-	-del *.manifest
-
-distclean: clean
-	-del zconf$(SUFFIX).h
-	-del zlib$(SUFFIX).h
-	-del zlib_name_mangling$(SUFFIX).h
-	-del $(TOP)\win32\zlib.def
-	-del $(TOP)\win32\zlibcompat.def
-	-del $(TOP)\win32\zlib-ng.def
-	-del gzread.c
diff --git a/win32/Makefile.msc b/win32/Makefile.msc
deleted file mode 100644
index 8392fe46..00000000
--- a/win32/Makefile.msc
+++ /dev/null
@@ -1,292 +0,0 @@
-# Makefile for zlib using Microsoft (Visual) C
-# zlib is copyright (C) 1995-2024 Jean-loup Gailly and Mark Adler
-#
-# Usage:
-#   nmake -f win32/Makefile.msc                          (standard build)
-#   nmake -f win32/Makefile.msc LOC=-DFOO                (nonstandard build)
-
-# The toplevel directory of the source tree.
-#
-TOP = .
-
-# optional build flags
-LOC =
-
-# variables
-STATICLIB = zlib.lib
-SHAREDLIB = zlib1.dll
-IMPLIB    = zdll.lib
-SYMBOL_PREFIX =
-
-CC = cl
-CXX = cl
-LD = link
-AR = lib
-RC = rc
-CP = copy /y
-INCLUDES = -I$(TOP) -I$(TOP)/arch/x86 -I$(TOP)/arch/generic
-CFLAGS  = -nologo -MD -W3 -O2 -Oy- -Zi -Fd"zlib" $(LOC) $(INCLUDES)
-CXXFLAGS  = -nologo -EHsc -MD -W3 -O2 -Oy- -Zi -Fd"zlib" $(LOC) $(INCLUDES)
-WFLAGS  = \
-	-D_CRT_SECURE_NO_DEPRECATE \
-	-D_CRT_NONSTDC_NO_DEPRECATE \
-	-DX86_FEATURES \
-	-DX86_PCLMULQDQ_CRC \
-	-DX86_SSE2 \
-	-DX86_SSE42 \
-	-DX86_SSSE3 \
-	-DX86_AVX2
-
-LDFLAGS = -nologo -debug -incremental:no -opt:ref -manifest
-ARFLAGS = -nologo
-RCFLAGS = /dWIN32 /r
-DEFFILE = zlib.def
-RCFILE = zlib1.rc
-RESFILE = zlib1.res
-WITH_GZFILEOP = yes
-ZLIB_COMPAT =
-SUFFIX =
-
-OBJS = \
-	adler32.obj \
-	adler32_c.obj \
-	adler32_avx2.obj \
-	adler32_avx512.obj \
-	adler32_avx512_vnni.obj \
-	adler32_sse42.obj \
-	adler32_ssse3.obj \
-	adler32_fold_c.obj \
-	chunkset_c.obj \
-	chunkset_avx2.obj \
-	chunkset_sse2.obj \
-	chunkset_ssse3.obj \
-	compare256_c.obj \
-	compare256_avx2.obj \
-	compare256_sse2.obj \
-	compress.obj \
-	cpu_features.obj \
-	crc32.obj \
-	crc32_braid_c.obj \
-	crc32_braid_comb.obj \
-	crc32_fold_c.obj \
-	crc32_pclmulqdq.obj \
-	deflate.obj \
-	deflate_fast.obj \
-	deflate_huff.obj \
-	deflate_medium.obj \
-	deflate_quick.obj \
-	deflate_rle.obj \
-	deflate_slow.obj \
-	deflate_stored.obj \
-	functable.obj \
-	infback.obj \
-	inflate.obj \
-	inftrees.obj \
-	insert_string.obj \
-	insert_string_roll.obj \
-	slide_hash_c.obj \
-	slide_hash_avx2.obj \
-	slide_hash_sse2.obj \
-	trees.obj \
-	uncompr.obj \
-	zutil.obj \
-	x86_features.obj \
-	#
-!if "$(ZLIB_COMPAT)" != ""
-WITH_GZFILEOP = yes
-WFLAGS = $(WFLAGS) -DZLIB_COMPAT
-DEFFILE = zlibcompat.def
-!else
-STATICLIB = zlib-ng.lib
-SHAREDLIB = zlib-ng1.dll
-IMPLIB = zngdll.lib
-DEFFILE = zlib-ng.def
-RCFILE = zlib-ng1.rc
-RESFILE = zlib-ng1.res
-SUFFIX = -ng
-!endif
-
-!if "$(WITH_GZFILEOP)" != ""
-WFLAGS = $(WFLAGS) -DWITH_GZFILEOP
-OBJS = $(OBJS) gzlib.obj gzread.obj gzwrite.obj
-!endif
-
-# targets
-all: $(STATICLIB) $(SHAREDLIB) $(IMPLIB) \
-     example.exe minigzip.exe example_d.exe minigzip_d.exe
-
-!if "$(SYMBOL_PREFIX)" != ""
-zlib_name_mangling$(SUFFIX).h: zlib_name_mangling$(SUFFIX).h.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\zlib_name_mangling$(SUFFIX).h.in zlib_name_mangling$(SUFFIX).h "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-!else
-zlib_name_mangling$(SUFFIX).h: zlib_name_mangling.h.empty
-	$(CP) $(TOP)\zlib_name_mangling.h.empty zlib_name_mangling$(SUFFIX).h
-!endif
-
-zlib$(SUFFIX).h: zlib$(SUFFIX).h.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\zlib$(SUFFIX).h.in zlib$(SUFFIX).h "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-gzread.c: gzread.c.in
-	cscript $(TOP)\win32\replace.vbs $(TOP)\gzread.c.in gzread.c "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-zconf: $(TOP)/zconf$(SUFFIX).h.in $(TOP)/zlib$(SUFFIX).h $(TOP)/zlib_name_mangling$(SUFFIX).h
-	$(CP) $(TOP)\zconf$(SUFFIX).h.in $(TOP)\zconf$(SUFFIX).h
-
-$(TOP)/win32/$(DEFFILE): $(TOP)/win32/$(DEFFILE).in
-	cscript $(TOP)\win32\replace.vbs $(TOP)/win32/$(DEFFILE).in $(TOP)/win32/$(DEFFILE) "@ZLIB_SYMBOL_PREFIX@" "$(SYMBOL_PREFIX)"
-
-$(STATICLIB): zconf $(OBJS)
-	$(AR) $(ARFLAGS) -out:$@ $(OBJS)
-
-$(IMPLIB): $(SHAREDLIB)
-
-$(SHAREDLIB): zconf $(TOP)/win32/$(DEFFILE) $(OBJS) $(RESFILE)
-	$(LD) $(LDFLAGS) -def:$(TOP)/win32/$(DEFFILE) -dll -implib:$(IMPLIB) \
-	  -out:$@ $(OBJS) $(RESFILE)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;2
-
-depcheck.exe: depcheck.obj
-	$(LD) $(LDFLAGS) depcheck.obj
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-example.exe: example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	$(LD) $(LDFLAGS) example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-minigzip.exe: minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	$(LD) $(LDFLAGS) minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(STATICLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-example_d.exe: example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	$(LD) $(LDFLAGS) -out:$@ example.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-minigzip_d.exe: minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	$(LD) $(LDFLAGS) -out:$@ minigzip.obj gzlib2.obj gzread2.obj gzwrite2.obj $(IMPLIB)
-	if exist $@.manifest \
-	  mt -nologo -manifest $@.manifest -outputresource:$@;1
-
-{$(TOP)}.c.obj:
-	$(CC) -c $(WFLAGS) $(CFLAGS) $<
-
-gzlib2.obj: gzlib.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzlib2.obj gzlib.c
-
-gzread2.obj: gzread.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzread2.obj gzread.c
-
-gzwrite2.obj: gzwrite.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-	$(CC) -c $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP -Fogzwrite2.obj gzwrite.c
-
-{$(TOP)/arch/x86}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) $<
-
-{$(TOP)/arch/generic}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) $<
-
-{$(TOP)/test}.c.obj:
-	$(CC) -c -I$(TOP) $(WFLAGS) $(CFLAGS) -DWITH_GZFILEOP $<
-
-$(TOP)/zconf$(SUFFIX).h: zconf
-
-{$(TOP)/win32}.cpp.obj:
-	$(CXX) -c -I$(TOP) $(WFLAGS) $(CXXFLAGS) $<
-
-adler32.obj: $(TOP)/adler32.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/adler32_p.h
-adler32_c.obj: $(TOP)/arch/generic/adler32_c.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/adler32_p.h
-adler32_avx2.obj: $(TOP)/arch/x86/adler32_avx2.c $(TOP)/zbuild.h $(TOP)/adler32_p.h $(TOP)/arch/x86/adler32_avx2_p.h $(TOP)/arch/x86/x86_intrins.h
-adler32_avx512.obj: $(TOP)/arch/x86/adler32_avx512.c $(TOP)/zbuild.h $(TOP)/arch_functions.h $(TOP)/adler32_p.h $(TOP)/arch/x86/adler32_avx512_p.h $(TOP)/arch/x86/x86_intrins.h
-adler32_avx512_vnni.obj: $(TOP)/arch/x86/adler32_avx512_vnni.c $(TOP)/zbuild.h $(TOP)/arch_functions.h $(TOP)/adler32_p.h $(TOP)/arch/x86/adler32_avx512_p.h \
-                  $(TOP)/arch/x86/adler32_avx2_p.h $(TOP)/arch/x86/x86_intrins.h
-adler32_sse42.obj: $(TOP)/arch/x86/adler32_sse42.c $(TOP)/zbuild.h $(TOP)/adler32_p.h \
-                   $(TOP)/arch/x86/adler32_ssse3_p.h
-adler32_ssse3.obj: $(TOP)/arch/x86/adler32_ssse3.c $(TOP)/zbuild.h $(TOP)/adler32_p.h \
-                   $(TOP)/arch/x86/adler32_ssse3_p.h
-adler32_fold_c.obj: $(TOP)/arch/generic/adler32_fold_c.c $(TOP)/zbuild.h $(TOP)/functable.h
-chunkset_c.obj: $(TOP)/arch/generic/chunkset_c.c $(TOP)/zbuild.h $(TOP)/chunkset_tpl.h $(TOP)/inffast_tpl.h
-chunkset_avx2.obj: $(TOP)/arch/x86/chunkset_avx2.c $(TOP)/zbuild.h $(TOP)/chunkset_tpl.h $(TOP)/inffast_tpl.h $(TOP)/arch/generic/chunk_permute_table.h
-chunkset_sse2.obj: $(TOP)/arch/x86/chunkset_sse2.c $(TOP)/zbuild.h $(TOP)/chunkset_tpl.h $(TOP)/inffast_tpl.h
-chunkset_ssse3.obj: $(TOP)/arch/x86/chunkset_ssse3.c $(TOP)/zbuild.h $(TOP)/chunkset_tpl.h $(TOP)/inffast_tpl.h $(TOP)/arch/generic/chunk_permute_table.h
-compare256_c.obj: $(TOP)/arch/generic/compare256_c.c $(TOP)/zbuild.h $(TOP)/zutil_p.h $(TOP)/deflate.h $(TOP)/fallback_builtins.h $(TOP)/match_tpl.h
-compare256_avx2.obj: $(TOP)/arch/x86/compare256_avx2.c $(TOP)/zbuild.h $(TOP)/zutil_p.h $(TOP)/deflate.h $(TOP)/fallback_builtins.h $(TOP)/match_tpl.h
-compare256_sse2.obj: $(TOP)/arch/x86/compare256_sse2.c $(TOP)/zbuild.h $(TOP)/zutil_p.h $(TOP)/deflate.h $(TOP)/fallback_builtins.h $(TOP)/match_tpl.h
-compress.obj: $(TOP)/compress.c $(TOP)/zbuild.h $(TOP)/zutil.h
-cpu_features.obj: $(TOP)/cpu_features.c $(TOP)/cpu_features.h $(TOP)/zbuild.h
-crc32.obj: $(TOP)/crc32.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/crc32_braid_tbl.h
-crc32_braid_c.obj: $(TOP)/arch/generic/crc32_braid_c.c $(TOP)/zbuild.h $(TOP)/crc32_braid_p.h $(TOP)/crc32_braid_tbl.h
-crc32_braid_comb.obj: $(TOP)/crc32_braid_comb.c $(TOP)/zutil.h $(TOP)/crc32_braid_p.h $(TOP)/crc32_braid_tbl.h $(TOP)/crc32_braid_comb_p.h
-crc32_fold_c.obj: $(TOP)/arch/generic/crc32_fold_c.c $(TOP)/zbuild.h $(TOP)/crc32.h $(TOP)/functable.h $(TOP)/zutil.h
-crc32_pclmulqdq.obj: $(TOP)/arch/x86/crc32_pclmulqdq.c $(TOP)/arch/x86/crc32_pclmulqdq_tpl.h
-deflate.obj: $(TOP)/deflate.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_fast.obj: $(TOP)/deflate_fast.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_huff.obj: $(TOP)/deflate_huff.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_medium.obj: $(TOP)/deflate_medium.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_quick.obj: $(TOP)/deflate_quick.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h $(TOP)/trees_emit.h $(TOP)/zutil_p.h
-deflate_rle.obj: $(TOP)/deflate_rle.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h $(TOP)/compare256_rle.h
-deflate_slow.obj: $(TOP)/deflate_slow.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-deflate_stored.obj: $(TOP)/deflate_stored.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/deflate_p.h $(TOP)/functable.h
-functable.obj: $(TOP)/functable.c $(TOP)/zbuild.h $(TOP)/functable.h $(TOP)/cpu_features.h $(TOP)/arch/x86/x86_features.h $(TOP)/arch_functions.h
-gzlib.obj: $(TOP)/gzlib.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-gzread.obj: $(TOP)/gzread.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-gzwrite.obj: $(TOP)/gzwrite.c $(TOP)/zbuild.h $(TOP)/gzguts.h $(TOP)/zutil_p.h
-infback.obj: $(TOP)/infback.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h $(TOP)/inflate.h $(TOP)/inflate_p.h $(TOP)/functable.h
-inflate.obj: $(TOP)/inflate.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h $(TOP)/inflate.h $(TOP)/inflate_p.h $(TOP)/functable.h $(TOP)/inffixed_tbl.h
-inftrees.obj: $(TOP)/inftrees.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/inftrees.h
-insert_string.obj: $(TOP)/insert_string.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/insert_string_tpl.h
-insert_string_roll.obj: $(TOP)/insert_string_roll.c $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/insert_string_tpl.h
-slide_hash_c.obj: $(TOP)/arch/generic/slide_hash_c.c $(TOP)/zbuild.h $(TOP)/deflate.h
-slide_hash_avx2.obj: $(TOP)/arch/x86/slide_hash_avx2.c $(TOP)/zbuild.h $(TOP)/deflate.h
-slide_hash_sse2.obj: $(TOP)/arch/x86/slide_hash_sse2.c $(TOP)/zbuild.h $(TOP)/deflate.h
-trees.obj: $(TOP)/trees.c $(TOP)/trees.h $(TOP)/trees_emit.h $(TOP)/zbuild.h $(TOP)/deflate.h $(TOP)/trees_tbl.h
-uncompr.obj: $(TOP)/uncompr.c $(TOP)/zbuild.h $(TOP)/zutil.h
-zutil.obj: $(TOP)/zutil.c $(TOP)/zbuild.h $(TOP)/zutil.h $(TOP)/zutil_p.h
-
-$(RESFILE): $(TOP)/win32/$(RCFILE)
-	$(RC) $(RCFLAGS) /fo$@ $(TOP)/win32/$(RCFILE)
-
-# testing
-depcheck: depcheck.exe
-        depcheck win32\Makefile.msc .
-        depcheck win32\Makefile.arm .
-        depcheck win32\Makefile.a64 .
-
-test: example.exe minigzip.exe depcheck
-	example
-	echo hello world | minigzip | minigzip -d
-
-testdll: example_d.exe minigzip_d.exe
-	example_d
-	echo hello world | minigzip_d | minigzip_d -d
-
-depcheck.obj: $(TOP)/win32/depcheck.cpp
-
-example.obj: $(TOP)/test/example.c $(TOP)/zbuild.h $(TOP)/zlib$(SUFFIX).h $(TOP)/deflate.h $(TOP)/test/test_shared_ng.h
-
-minigzip.obj: $(TOP)/test/minigzip.c $(TOP)/zbuild.h $(TOP)/zlib$(SUFFIX).h
-
-
-# cleanup
-clean:
-	-del $(STATICLIB)
-	-del $(SHAREDLIB)
-	-del $(IMPLIB)
-	-del *.obj
-	-del *.res
-	-del *.exp
-	-del *.exe
-	-del *.pdb
-	-del *.manifest
-
-distclean: clean
-	-del zconf$(SUFFIX).h
-	-del zlib$(SUFFIX).h
-	-del zlib_name_mangling$(SUFFIX).h
-	-del $(TOP)\win32\zlib.def
-	-del $(TOP)\win32\zlibcompat.def
-	-del $(TOP)\win32\zlib-ng.def
-	-del gzread.c
diff --git a/win32/depcheck.cpp b/win32/depcheck.cpp
deleted file mode 100644
index f83bdd68..00000000
--- a/win32/depcheck.cpp
+++ /dev/null
@@ -1,321 +0,0 @@
-/* depcheck.cpp - Dependency checker for NMake Makefiles
- * Copyright (c) 2024 Mika T. Lindqvist
- */
-
-#include <fstream>
-#include <iostream>
-#include <sstream>
-#include <string>
-#include <vector>
-
-int main(int argc, char* argv[]) {
-  if (argc != 3) {
-    printf("Usage: depcheck Makefile <top_directory>\n");
-    return -1;
-  }
-  std::filebuf fb;
-  if (fb.open (argv[1],std::ios::in)) {
-    std::istream is(&fb);
-    std::string makefile = argv[1];
-    std::string l, tmp, tmp2;
-    while (is) {
-      std::getline(is, l);
-      while (l.back() == '\\') {
-        std::getline(is, tmp);
-        l.replace(l.length() - 1, 1, tmp);
-      }
-      size_t pos = l.find("obj:");
-      if (pos != std::string::npos) {
-         std::string objfile = l.substr(0, pos+3);
-         printf("File: %s\n", objfile.c_str());
-         std::vector<std::string> files;
-         std::stringstream ss(l.substr(pos+4));
-         while(getline(ss, tmp, ' ')){
-           if (tmp != "" && tmp != "/") {
-             files.push_back(tmp);
-           }
-         }
-         for (auto it = files.begin(); it != files.end(); ++it) {
-           printf("Dependency: %s\n", (*it).c_str());
-         }
-         if (!files.empty()) {
-           std::filebuf fb2;
-           std::string src = files[0];
-           size_t pos2 = src.find("$(TOP)");
-           if (pos2 != std::string::npos) {
-             src.replace(pos2, 6, argv[2]);
-           }
-           printf("Source: %s\n", src.c_str());
-           if (fb2.open(src.c_str(),std::ios::in)) {
-             std::istream is2(&fb2);
-             std::vector<std::string> includes;
-             while (is2) {
-               std::getline(is2, l);
-               pos = l.find("#");
-               if (pos != std::string::npos) {
-                 pos2 = l.find("include");
-                 size_t pos3 = l.find("\"");
-                 if (pos2 != std::string::npos && pos3 != std::string::npos && pos2 > pos && pos3 > pos2) {
-                   tmp = l.substr(pos3 + 1);
-                   pos2 = tmp.find("\"");
-                   if (pos2 != std::string::npos) {
-                     tmp = tmp.substr(0, pos2);
-                   }
-                   pos2 = tmp.find("../");
-                   if (pos2 != std::string::npos) {
-                     tmp = tmp.substr(3);
-                   }
-                   printf("Line: %s\n", tmp.c_str());
-                   int found = 0;
-                   for (size_t i = 1; i < files.size(); i++) {
-                     pos3 = files[i].find("$(SUFFIX)");
-                     if (pos3 != std::string::npos) {
-                       tmp2 = files[i].substr(0, pos3).append(files[i].substr(pos3 + 9));
-                       printf("Comparing dependency \"%s\" and \"%s\"\n", tmp2.c_str(), tmp.c_str());
-                       if (tmp2 == tmp) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                       printf("Comparing dependency \"%s\" and \"$(TOP)/%s\"\n", tmp2.c_str(), tmp.c_str());
-                       if (tmp2 == std::string("$(TOP)/").append(tmp)) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-
-                       tmp2 = files[i].substr(0, pos3).append("-ng").append(files[i].substr(pos3 + 9));
-                       printf("Comparing dependency \"%s\" and \"%s\"\n", tmp2.c_str(), tmp.c_str());
-                       if (tmp2 == tmp) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                       printf("Comparing dependency \"%s\" and \"$(TOP)/%s\"\n", tmp2.c_str(), tmp.c_str());
-                       if (tmp2 == std::string("$(TOP)/").append(tmp)) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                     } else {
-                       printf("Comparing dependency \"%s\" and \"%s\"\n", files[i].c_str(), tmp.c_str());
-                       if (files[i] == tmp) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                       printf("Comparing dependency \"%s\" and \"$(TOP)/%s\"\n", files[i].c_str(), tmp.c_str());
-                       if (files[i] == std::string("$(TOP)/").append(tmp)) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                       printf("Comparing dependency \"%s\" and \"$(TOP)/arch/%s\"\n", files[i].c_str(), tmp.c_str());
-                       if (files[i] == std::string("$(TOP)/arch/").append(tmp)) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                       printf("Comparing dependency \"%s\" and \"$(TOP)/arch/generic/%s\"\n", files[i].c_str(), tmp.c_str());
-                       if (files[i] == std::string("$(TOP)/arch/generic/").append(tmp)) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                       printf("Comparing dependency \"%s\" and \"$(TOP)/arch/arm/%s\"\n", files[i].c_str(), tmp.c_str());
-                       if (files[i] == std::string("$(TOP)/arch/arm/").append(tmp)) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                       printf("Comparing dependency \"%s\" and \"$(TOP)/arch/x86/%s\"\n", files[i].c_str(), tmp.c_str());
-                       if (files[i] == std::string("$(TOP)/arch/x86/").append(tmp)) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                       printf("Comparing dependency \"%s\" and \"$(TOP)/test/%s\"\n", files[i].c_str(), tmp.c_str());
-                       if (files[i] == std::string("$(TOP)/test/").append(tmp)) {
-                         printf("Dependency %s OK\n", tmp.c_str());
-                         found = 1;
-                         includes.push_back(tmp);
-                         break;
-                       }
-                     }
-                   }
-                   // Skip irrelevant dependencies
-                   if (tmp.substr(0, 9) == "arch/s390") found = 1;
-                   if (tmp == "zlib-ng.h" && std::find(includes.begin(), includes.end(), "zlib.h") != includes.end()) found = 1;
-                   if (found == 0) {
-                     printf("%s: Dependency %s missing for %s!\n", makefile.c_str(), tmp.c_str(), objfile.c_str());
-                     return -1;
-                   }
-                 }
-               }
-             }
-             for (size_t i = 1; i < files.size(); i++) {
-               int found = 0;
-               tmp = files[i];
-               printf("Dependency: %s\n", tmp.c_str());
-               pos2 = tmp.find("$(TOP)");
-               if (pos2 != std::string::npos) {
-                 tmp = tmp.substr(7);
-               }
-               for (size_t j = 0; j < includes.size(); j++) {
-                 pos2 = tmp.find("$(SUFFIX)");
-                 if (pos2 != std::string::npos) {
-                   std::string tmp1 = tmp.substr(0, pos2).append(tmp.substr(pos2 + 9));
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == includes[j]) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("arch/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/generic/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("arch/generic/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/arm/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("arch/arm/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/x86/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("arch/x86/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"test/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("test/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   tmp1 = tmp.substr(0, pos2).append("-ng").append(tmp.substr(pos2 + 9));
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == includes[j]) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("arch/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/generic/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("arch/generic/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/arm/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("arch/arm/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/x86/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("arch/x86/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"test/%s\"\n", j, includes.size(), tmp1.c_str(), includes[j].c_str());
-                   if (tmp1 == std::string("test/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                 } else {
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"%s\"\n", j, includes.size(), tmp.c_str(), includes[j].c_str());
-                   if (tmp == includes[j]) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/%s\"\n", j, includes.size(), tmp.c_str(), includes[j].c_str());
-                   if (tmp == std::string("arch/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/generic/%s\"\n", j, includes.size(), tmp.c_str(), includes[j].c_str());
-                   if (tmp == std::string("arch/generic/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/arm/%s\"\n", j, includes.size(), tmp.c_str(), includes[j].c_str());
-                   if (tmp == std::string("arch/arm/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"arch/x86/%s\"\n", j, includes.size(), tmp.c_str(), includes[j].c_str());
-                   if (tmp == std::string("arch/x86/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                   printf("[%zd/%zd] Comparing dependency \"%s\" and \"test/%s\"\n", j, includes.size(), tmp.c_str(), includes[j].c_str());
-                   if (tmp == std::string("test/").append(includes[j])) {
-                     printf("Dependency %s OK\n", files[i].c_str());
-                     found = 1;
-                     break;
-                   }
-                 }
-               }
-               // Skip indirect dependencies
-               if (tmp.find("arm_features.h") != std::string::npos
-                   && std::find(includes.begin(), includes.end(), "cpu_features.h") != includes.end()
-                   && (makefile.find(".arm") != std::string::npos
-                      || makefile.find(".a64") != std::string::npos)) found = 1;
-               if (tmp.find("x86_features.h") != std::string::npos
-                   && std::find(includes.begin(), includes.end(), "cpu_features.h") != includes.end()
-                   && makefile.find(".msc") != std::string::npos) found = 1;
-               //
-               if (tmp.find("generic_functions.h") != std::string::npos
-                   && std::find(includes.begin(), includes.end(), "arch_functions.h") != includes.end()) found = 1;
-               if (tmp.find("arm_functions.h") != std::string::npos
-                   && std::find(includes.begin(), includes.end(), "arch_functions.h") != includes.end()
-                   && (makefile.find(".arm") != std::string::npos
-                      || makefile.find(".a64") != std::string::npos)) found = 1;
-               if (tmp.find("x86_functions.h") != std::string::npos
-                   && std::find(includes.begin(), includes.end(), "arch_functions.h") != includes.end()
-                   && makefile.find(".msc") != std::string::npos) found = 1;
-               if (found == 0) {
-                 printf("%s: Dependency %s not needed for %s\n", makefile.c_str(), files[i].c_str(), objfile.c_str());
-                 return -1;
-               }
-             }
-             fb2.close();
-           }
-         }
-      }
-    }
-    fb.close();
-  }
-  return 0;
-}
diff --git a/win32/replace.vbs b/win32/replace.vbs
deleted file mode 100644
index 6779971d..00000000
--- a/win32/replace.vbs
+++ /dev/null
@@ -1,15 +0,0 @@
-strInputFileName = Wscript.Arguments(0)
-strOutputFileName = Wscript.Arguments(1)
-strOldText = Wscript.Arguments(2)
-strNewText = Wscript.Arguments(3)
-
-Set objFSO = CreateObject("Scripting.FileSystemObject")
-Set objFile = objFSO.OpenTextFile(strInputFileName, 1)
-
-strText = objFile.ReadAll
-objFile.Close
-strNewText = Replace(strText, strOldText, strNewText)
-
-Set objFile = objFSO.OpenTextFile(strOutputFileName, 2, True)
-objFile.Write strNewText
-objFile.Close
diff --git a/zbuild.h b/zbuild.h
index 9157eef9..b1736276 100644
--- a/zbuild.h
+++ b/zbuild.h
@@ -16,6 +16,7 @@
 #include <string.h>
 #include <stdlib.h>
 #include <stdint.h>
+#include <stdio.h>
 
 /* Determine compiler version of C Standard */
 #ifdef __STDC_VERSION__
@@ -47,6 +48,17 @@
 #  endif
 #endif
 
+/* Hint to compiler that a block of code is unreachable, typically in a switch default condition */
+#ifndef Z_UNREACHABLE
+#  if defined(__STDC_VERSION__) && __STDC_VERSION__ >= 202311L
+#    define Z_UNREACHABLE() unreachable()           // C23 approach
+#  elif (defined(__GNUC__) && (__GNUC__ >= 5)) || defined(__clang__)
+#    define Z_UNREACHABLE() __builtin_unreachable()
+#  else
+#    define Z_UNREACHABLE()
+#  endif
+#endif
+
 #ifndef Z_TARGET
 #  if Z_HAS_ATTRIBUTE(__target__)
 #    define Z_TARGET(x) __attribute__((__target__(x)))
@@ -70,6 +82,16 @@
 #  endif
 #endif
 
+/* A forced inline decorator */
+#if defined(_MSC_VER)
+#  define Z_FORCEINLINE __forceinline
+#elif defined(__GNUC__)
+#  define Z_FORCEINLINE inline __attribute__((always_inline))
+#else
+    /* It won't actually force inlining but it will suggest it */
+#  define Z_FORCEINLINE inline
+#endif
+
 /* MS Visual Studio does not allow inline in C, only C++.
    But it provides __inline instead, so use that. */
 #if defined(_MSC_VER) && !defined(inline) && !defined(__cplusplus)
@@ -98,6 +120,17 @@
 #  define z_uintmax_t size_t
 #endif
 
+/* In zlib-compat headers some function return values and parameter types use int or unsigned, but zlib-ng headers use
+   int32_t and uint32_t, which will cause type mismatch when compiling zlib-ng if int32_t is long and uint32_t is
+   unsigned long */
+#if defined(ZLIB_COMPAT)
+#  define z_int32_t int
+#  define z_uint32_t unsigned int
+#else
+#  define z_int32_t int32_t
+#  define z_uint32_t uint32_t
+#endif
+
 /* Minimum of a and b. */
 #define MIN(a, b) ((a) > (b) ? (b) : (a))
 /* Maximum of a and b. */
@@ -105,6 +138,16 @@
 /* Ignore unused variable warning */
 #define Z_UNUSED(var) (void)(var)
 
+/* Force the compiler to treat variable as modified. Empty asm statement with a "+r" constraint prevents
+   the compiler from reordering or eliminating loads into the variable. This can help keep critical latency
+   chains in the hot path from being shortened or optimized away. */
+#if (defined(__GNUC__) || defined(__clang__)) && \
+        (defined(ARCH_X86) || (defined(ARCH_ARM) && defined(ARCH_64BIT)))
+#  define Z_TOUCH(var) __asm__ ("" : "+r"(var))
+#else
+#  define Z_TOUCH(var) (void)(var)
+#endif
+
 #if defined(HAVE_VISIBILITY_INTERNAL)
 #  define Z_INTERNAL __attribute__((visibility ("internal")))
 #elif defined(HAVE_VISIBILITY_HIDDEN)
@@ -200,6 +243,9 @@
 #  define ALIGNED_(x) __attribute__ ((aligned(x)))
 #elif defined(_MSC_VER)
 #  define ALIGNED_(x) __declspec(align(x))
+#else
+/* TODO: Define ALIGNED_ for your compiler */
+#  define ALIGNED_(x)
 #endif
 
 #ifdef HAVE_BUILTIN_ASSUME_ALIGNED
@@ -211,6 +257,10 @@
 #define HINT_ALIGNED_64(p) HINT_ALIGNED((p),64)
 #define HINT_ALIGNED_4096(p) HINT_ALIGNED((p),4096)
 
+/* Number of bytes needed to align ptr to the next alignment boundary */
+#define ALIGN_DIFF(ptr, align) \
+    (((uintptr_t)(align) - ((uintptr_t)(ptr) & ((align) - 1))) & ((align) - 1))
+
 /* PADSZ returns needed bytes to pad bpos to pad size
  * PAD_NN calculates pad size and adds it to bpos, returning the result.
  * All take an integer or a pointer as bpos input.
@@ -222,10 +272,9 @@
 
 /* Diagnostic functions */
 #ifdef ZLIB_DEBUG
-#  include <stdio.h>
    extern int Z_INTERNAL z_verbose;
    extern void Z_INTERNAL z_error(const char *m);
-#  define Assert(cond, msg) {if (!(cond)) z_error(msg);}
+#  define Assert(cond, msg) {int _cond = (cond); if (!(_cond)) z_error(msg);}
 #  define Trace(x) {if (z_verbose >= 0) fprintf x;}
 #  define Tracev(x) {if (z_verbose > 0) fprintf x;}
 #  define Tracevv(x) {if (z_verbose > 1) fprintf x;}
@@ -240,29 +289,41 @@
 #  define Tracecv(c, x)
 #endif
 
-#ifndef NO_UNALIGNED
-#  if defined(__x86_64__) || defined(_M_X64) || defined(__amd64__) || defined(_M_AMD64)
-#    define UNALIGNED_OK
-#    define UNALIGNED64_OK
-#  elif defined(__i386__) || defined(__i486__) || defined(__i586__) || \
-        defined(__i686__) || defined(_X86_) || defined(_M_IX86)
-#    define UNALIGNED_OK
-#  elif defined(__aarch64__) || defined(_M_ARM64) || defined(_M_ARM64EC)
-#    if (defined(__GNUC__) && defined(__ARM_FEATURE_UNALIGNED)) || !defined(__GNUC__)
-#      define UNALIGNED_OK
-#      define UNALIGNED64_OK
-#    endif
-#  elif defined(__arm__) || (_M_ARM >= 7)
-#    if (defined(__GNUC__) && defined(__ARM_FEATURE_UNALIGNED)) || !defined(__GNUC__)
-#      define UNALIGNED_OK
+/* OPTIMAL_CMP values determine the comparison width:
+ * 64: Best for 64-bit architectures with unaligned access
+ * 32: Best for 32-bit architectures with unaligned access
+ * 16: Safe default for unknown architectures
+ * 8:  Safe fallback for architectures without unaligned access
+ * Note: The unaligned access mentioned is cpu-support, this allows compiler or
+ *       separate unaligned intrinsics to utilize safe unaligned access, without
+ *       utilizing unaligned C pointers that are known to have undefined behavior.
+ */
+#if !defined(OPTIMAL_CMP)
+#  ifdef ARCH_64BIT
+#    ifdef ARCH_ARM
+#      if defined(__ARM_FEATURE_UNALIGNED) || defined(_WIN32)
+#        define OPTIMAL_CMP 64
+#      else
+#        define OPTIMAL_CMP 8
+#      endif
+#    else
+#      define OPTIMAL_CMP 64
 #    endif
-#  elif defined(__powerpc64__) || defined(__ppc64__)
-#    if __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__
-#      define UNALIGNED_OK
-#      define UNALIGNED64_OK
+#  elif defined(ARCH_32BIT)
+#    ifdef ARCH_ARM
+#      if defined(__ARM_FEATURE_UNALIGNED) || defined(_WIN32)
+#        define OPTIMAL_CMP 32
+#      else
+#        define OPTIMAL_CMP 8
+#      endif
+#    else
+#      define OPTIMAL_CMP 32
 #    endif
 #  endif
 #endif
+#if !defined(OPTIMAL_CMP)
+#  define OPTIMAL_CMP 16
+#endif
 
 #if defined(__has_feature)
 #  if __has_feature(address_sanitizer)
@@ -275,8 +336,8 @@
 /*
  * __asan_loadN() and __asan_storeN() calls are inserted by compilers in order to check memory accesses.
  * They can be called manually too, with the following caveats:
- * gcc says: "warning: implicit declaration of function ..."
- * g++ says: "error: new declaration ... ambiguates built-in declaration ..."
+ * gcc says: "warning: implicit declaration of function '...'"
+ * g++ says: "error: new declaration '...' ambiguates built-in declaration '...'"
  * Accommodate both.
  */
 #ifdef Z_ADDRESS_SANITIZER
diff --git a/zendian.h b/zendian.h
index 28177a60..bdf4e91d 100644
--- a/zendian.h
+++ b/zendian.h
@@ -27,7 +27,7 @@
 #elif defined(_WIN32)
 #  define LITTLE_ENDIAN 1234
 #  define BIG_ENDIAN 4321
-#  if defined(_M_IX86) || defined(_M_AMD64) || defined(_M_IA64) || defined (_M_ARM) || defined (_M_ARM64) || defined (_M_ARM64EC)
+#  if defined(ARCH_X86) || defined(ARCH_IA64) || defined(ARCH_ARM)
 #    define BYTE_ORDER LITTLE_ENDIAN
 #  else
 #    error Unknown endianness!
diff --git a/zlib-config.cmake.in b/zlib-config.cmake.in
index 2e4ba4f2..57868b1b 100644
--- a/zlib-config.cmake.in
+++ b/zlib-config.cmake.in
@@ -7,6 +7,6 @@ set(ZLIB_INCLUDE_DIRS "${ZLIB_INCLUDE_DIR}")
 set_and_check(ZLIB_LIB_DIR "@PACKAGE_LIB_INSTALL_DIR@")
 set(ZLIB_LIBRARIES ZLIB::ZLIB)
 
-include("${CMAKE_CURRENT_LIST_DIR}/ZLIB.cmake")
+include("${CMAKE_CURRENT_LIST_DIR}/ZLIB-targets.cmake")
 
 check_required_components(ZLIB)
diff --git a/zlib-ng-config.cmake.in b/zlib-ng-config.cmake.in
index f7564a90..941a1e08 100644
--- a/zlib-ng-config.cmake.in
+++ b/zlib-ng-config.cmake.in
@@ -5,6 +5,6 @@ set(zlib-ng_VERSION @ZLIBNG_HEADER_VERSION@)
 set_and_check(zlib-ng_INCLUDE_DIR "@PACKAGE_INCLUDE_INSTALL_DIR@")
 set_and_check(zlib-ng_LIB_DIR "@PACKAGE_LIB_INSTALL_DIR@")
 
-include("${CMAKE_CURRENT_LIST_DIR}/zlib-ng.cmake")
+include("${CMAKE_CURRENT_LIST_DIR}/zlib-ng-targets.cmake")
 
 check_required_components(zlib-ng)
diff --git a/zlib-ng.h.in b/zlib-ng.h.in
index 7f7f03ee..10628186 100644
--- a/zlib-ng.h.in
+++ b/zlib-ng.h.in
@@ -48,13 +48,13 @@
 extern "C" {
 #endif
 
-#define ZLIBNG_VERSION "2.2.1"
-#define ZLIBNG_VERNUM 0x020201F0L   /* MMNNRRSM: major minor revision status modified */
+#define ZLIBNG_VERSION "2.3.1"
+#define ZLIBNG_VERNUM 0x020301F0L   /* MMNNRRSM: major minor revision status modified */
 #define ZLIBNG_VER_MAJOR 2
-#define ZLIBNG_VER_MINOR 2
+#define ZLIBNG_VER_MINOR 3
 #define ZLIBNG_VER_REVISION 1
 #define ZLIBNG_VER_STATUS F         /* 0=devel, 1-E=beta, F=Release (DEPRECATED) */
-#define ZLIBNG_VER_STATUSH 0xF      /* Hex values: 0=devel, 1-E=beta, F=Release */
+#define ZLIBNG_VER_STATUSH 0xF      /* Hex values: 0=devel, 1-9=beta, A-E=Release Candidate, F=Release */
 #define ZLIBNG_VER_MODIFIED 0       /* non-zero if modified externally from zlib-ng */
 
 /*
@@ -880,7 +880,7 @@ int32_t zng_inflateSetDictionary(zng_stream *strm, const uint8_t *dictionary, ui
    deflateSetDictionary).  For raw inflate, this function can be called at any
    time to set the dictionary.  If the provided dictionary is smaller than the
    window and there is already data in the window, then the provided dictionary
-   will amend what's there.  The application must insure that the dictionary
+   will amend what's there.  The application must ensure that the dictionary
    that was used for compression is provided.
 
      inflateSetDictionary returns Z_OK if success, Z_STREAM_ERROR if a
diff --git a/zlib-ng.map b/zlib-ng.map
deleted file mode 100644
index 64411ab1..00000000
--- a/zlib-ng.map
+++ /dev/null
@@ -1,111 +0,0 @@
-ZLIB_NG_2.1.0 {
-  global:
-    zng_deflateInit;
-    zng_deflateInit2;
-    zng_inflateBackInit;
-    zng_inflateInit;
-    zng_inflateInit2;
-    zlibng_version;
-};
-
-ZLIB_NG_2.0.0 {
-  global:
-    zng_adler32;
-    zng_adler32_combine;
-    zng_adler32_z;
-    zng_compress;
-    zng_compress2;
-    zng_compressBound;
-    zng_crc32;
-    zng_crc32_combine;
-    zng_crc32_combine_gen;
-    zng_crc32_combine_op;
-    zng_crc32_z;
-    zng_deflate;
-    zng_deflateBound;
-    zng_deflateCopy;
-    zng_deflateEnd;
-    zng_deflateGetDictionary;
-    zng_deflateGetParams;
-    zng_deflateInit_;
-    zng_deflateInit2_;
-    zng_deflateParams;
-    zng_deflatePending;
-    zng_deflatePrime;
-    zng_deflateReset;
-    zng_deflateResetKeep;
-    zng_deflateSetDictionary;
-    zng_deflateSetHeader;
-    zng_deflateSetParams;
-    zng_deflateTune;
-    zng_get_crc_table;
-    zng_inflate;
-    zng_inflateBack;
-    zng_inflateBackEnd;
-    zng_inflateBackInit_;
-    zng_inflateCodesUsed;
-    zng_inflateCopy;
-    zng_inflateEnd;
-    zng_inflateGetDictionary;
-    zng_inflateGetHeader;
-    zng_inflateInit_;
-    zng_inflateInit2_;
-    zng_inflateMark;
-    zng_inflatePrime;
-    zng_inflateReset;
-    zng_inflateReset2;
-    zng_inflateResetKeep;
-    zng_inflateSetDictionary;
-    zng_inflateSync;
-    zng_inflateSyncPoint;
-    zng_inflateUndermine;
-    zng_inflateValidate;
-    zng_uncompress;
-    zng_uncompress2;
-    zng_zError;
-    zng_zlibCompileFlags;
-    zng_vstring;
-  local:
-    zng_deflate_copyright;
-    zng_inflate_copyright;
-    zng_zcalloc;
-    zng_zcfree;
-    zng_z_errmsg;
-    gz_error;
-    _*;
-};
-
-ZLIB_NG_GZ_2.0.0 {
-  global:
-    zng_gzbuffer;
-    zng_gzclearerr;
-    zng_gzclose;
-    zng_gzclose_r;
-    zng_gzclose_w;
-    zng_gzdirect;
-    zng_gzdopen;
-    zng_gzeof;
-    zng_gzerror;
-    zng_gzflush;
-    zng_gzfread;
-    zng_gzfwrite;
-    zng_gzgetc;
-    zng_gzgets;
-    zng_gzoffset;
-    zng_gzopen;
-    zng_gzprintf;
-    zng_gzputc;
-    zng_gzputs;
-    zng_gzread;
-    zng_gzrewind;
-    zng_gzseek;
-    zng_gzsetparams;
-    zng_gztell;
-    zng_gzungetc;
-    zng_gzvprintf;
-    zng_gzwrite;
-};
-
-FAIL {
-  local: *;
-};
diff --git a/zlib-ng.map.in b/zlib-ng.map.in
new file mode 100644
index 00000000..eed2aa66
--- /dev/null
+++ b/zlib-ng.map.in
@@ -0,0 +1,110 @@
+ZLIB_NG_2.1.0 {
+  global:
+    @ZLIB_SYMBOL_PREFIX@zng_deflateInit;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateInit2;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateBackInit;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateInit;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateInit2;
+    @ZLIB_SYMBOL_PREFIX@zlibng_version;
+};
+
+ZLIB_NG_2.0.0 {
+  global:
+    @ZLIB_SYMBOL_PREFIX@zng_adler32;
+    @ZLIB_SYMBOL_PREFIX@zng_adler32_combine;
+    @ZLIB_SYMBOL_PREFIX@zng_adler32_z;
+    @ZLIB_SYMBOL_PREFIX@zng_compress;
+    @ZLIB_SYMBOL_PREFIX@zng_compress2;
+    @ZLIB_SYMBOL_PREFIX@zng_compressBound;
+    @ZLIB_SYMBOL_PREFIX@zng_crc32;
+    @ZLIB_SYMBOL_PREFIX@zng_crc32_combine;
+    @ZLIB_SYMBOL_PREFIX@zng_crc32_combine_gen;
+    @ZLIB_SYMBOL_PREFIX@zng_crc32_combine_op;
+    @ZLIB_SYMBOL_PREFIX@zng_crc32_z;
+    @ZLIB_SYMBOL_PREFIX@zng_deflate;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateBound;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateCopy;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateEnd;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateGetDictionary;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateGetParams;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateInit_;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateInit2_;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateParams;
+    @ZLIB_SYMBOL_PREFIX@zng_deflatePending;
+    @ZLIB_SYMBOL_PREFIX@zng_deflatePrime;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateReset;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateResetKeep;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateSetDictionary;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateSetHeader;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateSetParams;
+    @ZLIB_SYMBOL_PREFIX@zng_deflateTune;
+    @ZLIB_SYMBOL_PREFIX@zng_get_crc_table;
+    @ZLIB_SYMBOL_PREFIX@zng_inflate;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateBack;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateBackEnd;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateBackInit_;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateCodesUsed;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateCopy;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateEnd;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateGetDictionary;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateGetHeader;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateInit_;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateInit2_;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateMark;
+    @ZLIB_SYMBOL_PREFIX@zng_inflatePrime;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateReset;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateReset2;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateResetKeep;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateSetDictionary;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateSync;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateSyncPoint;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateUndermine;
+    @ZLIB_SYMBOL_PREFIX@zng_inflateValidate;
+    @ZLIB_SYMBOL_PREFIX@zng_uncompress;
+    @ZLIB_SYMBOL_PREFIX@zng_uncompress2;
+    @ZLIB_SYMBOL_PREFIX@zng_zError;
+    @ZLIB_SYMBOL_PREFIX@zng_zlibCompileFlags;
+    @ZLIB_SYMBOL_PREFIX@zng_vstring;
+  local:
+    @ZLIB_SYMBOL_PREFIX@zng_deflate_copyright;
+    @ZLIB_SYMBOL_PREFIX@zng_inflate_copyright;
+    @ZLIB_SYMBOL_PREFIX@zng_zcalloc;
+    @ZLIB_SYMBOL_PREFIX@zng_zcfree;
+    @ZLIB_SYMBOL_PREFIX@zng_z_errmsg;
+    _*;
+};
+
+ZLIB_NG_GZ_2.0.0 {
+  global:
+    @ZLIB_SYMBOL_PREFIX@zng_gzbuffer;
+    @ZLIB_SYMBOL_PREFIX@zng_gzclearerr;
+    @ZLIB_SYMBOL_PREFIX@zng_gzclose;
+    @ZLIB_SYMBOL_PREFIX@zng_gzclose_r;
+    @ZLIB_SYMBOL_PREFIX@zng_gzclose_w;
+    @ZLIB_SYMBOL_PREFIX@zng_gzdirect;
+    @ZLIB_SYMBOL_PREFIX@zng_gzdopen;
+    @ZLIB_SYMBOL_PREFIX@zng_gzeof;
+    @ZLIB_SYMBOL_PREFIX@zng_gzerror;
+    @ZLIB_SYMBOL_PREFIX@zng_gzflush;
+    @ZLIB_SYMBOL_PREFIX@zng_gzfread;
+    @ZLIB_SYMBOL_PREFIX@zng_gzfwrite;
+    @ZLIB_SYMBOL_PREFIX@zng_gzgetc;
+    @ZLIB_SYMBOL_PREFIX@zng_gzgets;
+    @ZLIB_SYMBOL_PREFIX@zng_gzoffset;
+    @ZLIB_SYMBOL_PREFIX@zng_gzopen;
+    @ZLIB_SYMBOL_PREFIX@zng_gzprintf;
+    @ZLIB_SYMBOL_PREFIX@zng_gzputc;
+    @ZLIB_SYMBOL_PREFIX@zng_gzputs;
+    @ZLIB_SYMBOL_PREFIX@zng_gzread;
+    @ZLIB_SYMBOL_PREFIX@zng_gzrewind;
+    @ZLIB_SYMBOL_PREFIX@zng_gzseek;
+    @ZLIB_SYMBOL_PREFIX@zng_gzsetparams;
+    @ZLIB_SYMBOL_PREFIX@zng_gztell;
+    @ZLIB_SYMBOL_PREFIX@zng_gzungetc;
+    @ZLIB_SYMBOL_PREFIX@zng_gzvprintf;
+    @ZLIB_SYMBOL_PREFIX@zng_gzwrite;
+};
+
+FAIL {
+  local: *;
+};
diff --git a/zlib.h.in b/zlib.h.in
index 3dceaa33..dae663b2 100644
--- a/zlib.h.in
+++ b/zlib.h.in
@@ -49,13 +49,13 @@
 extern "C" {
 #endif
 
-#define ZLIBNG_VERSION "2.2.1"
-#define ZLIBNG_VERNUM 0x020201F0L   /* MMNNRRSM: major minor revision status modified */
+#define ZLIBNG_VERSION "2.3.1"
+#define ZLIBNG_VERNUM 0x020301F0L   /* MMNNRRSM: major minor revision status modified */
 #define ZLIBNG_VER_MAJOR 2
-#define ZLIBNG_VER_MINOR 2
+#define ZLIBNG_VER_MINOR 3
 #define ZLIBNG_VER_REVISION 1
 #define ZLIBNG_VER_STATUS F         /* 0=devel, 1-E=beta, F=Release (DEPRECATED) */
-#define ZLIBNG_VER_STATUSH 0xF      /* Hex values: 0=devel, 1-E=beta, F=Release */
+#define ZLIBNG_VER_STATUSH 0xF      /* Hex values: 0=devel, 1-9=beta, A-E=Release Candidate, F=Release */
 #define ZLIBNG_VER_MODIFIED 0       /* non-zero if modified externally from zlib-ng */
 
 #define ZLIB_VERSION "1.3.1.zlib-ng"
@@ -890,7 +890,7 @@ Z_EXTERN int Z_EXPORT inflateSetDictionary(z_stream *strm, const unsigned char *
    deflateSetDictionary).  For raw inflate, this function can be called at any
    time to set the dictionary.  If the provided dictionary is smaller than the
    window and there is already data in the window, then the provided dictionary
-   will amend what's there.  The application must insure that the dictionary
+   will amend what's there.  The application must ensure that the dictionary
    that was used for compression is provided.
 
      inflateSetDictionary returns Z_OK if success, Z_STREAM_ERROR if a
diff --git a/zlib.map b/zlib.map
deleted file mode 100644
index 293e8037..00000000
--- a/zlib.map
+++ /dev/null
@@ -1,98 +0,0 @@
-ZLIB_1.2.0 {
-  global:
-    compressBound;
-    deflateBound;
-    inflateBack;
-    inflateBackEnd;
-    inflateBackInit_;
-    inflateCopy;
-  local:
-    deflate_copyright;
-    inflate_copyright;
-    zcalloc;
-    zcfree;
-    z_errmsg;
-    gz_error;
-    gz_intmax;
-    _*;
-};
-
-ZLIB_1.2.0.2 {
-    gzclearerr;
-    gzungetc;
-    zlibCompileFlags;
-} ZLIB_1.2.0;
-
-ZLIB_1.2.0.8 {
-    deflatePrime;
-} ZLIB_1.2.0.2;
-
-ZLIB_1.2.2 {
-    adler32_combine;
-    crc32_combine;
-    deflateSetHeader;
-    inflateGetHeader;
-} ZLIB_1.2.0.8;
-
-ZLIB_1.2.2.3 {
-    deflateTune;
-    gzdirect;
-} ZLIB_1.2.2;
-
-ZLIB_1.2.2.4 {
-    inflatePrime;
-} ZLIB_1.2.2.3;
-
-ZLIB_1.2.3.3 {
-    adler32_combine64;
-    crc32_combine64;
-    gzopen64;
-    gzseek64;
-    gztell64;
-    inflateUndermine;
-} ZLIB_1.2.2.4;
-
-ZLIB_1.2.3.4 {
-    inflateReset2;
-    inflateMark;
-} ZLIB_1.2.3.3;
-
-ZLIB_1.2.3.5 {
-    gzbuffer;
-    gzoffset;
-    gzoffset64;
-    gzclose_r;
-    gzclose_w;
-} ZLIB_1.2.3.4;
-
-ZLIB_1.2.5.1 {
-    deflatePending;
-} ZLIB_1.2.3.5;
-
-ZLIB_1.2.5.2 {
-    deflateResetKeep;
-    gzgetc_;
-    inflateResetKeep;
-} ZLIB_1.2.5.1;
-
-ZLIB_1.2.7.1 {
-    inflateGetDictionary;
-    gzvprintf;
-} ZLIB_1.2.5.2;
-
-ZLIB_1.2.9 {
-    inflateCodesUsed;
-    inflateValidate;
-    uncompress2;
-    gzfread;
-    gzfwrite;
-    deflateGetDictionary;
-    adler32_z;
-    crc32_z;
-} ZLIB_1.2.7.1;
-
-ZLIB_1.2.12 {
-    crc32_combine_gen;
-    crc32_combine_gen64;
-    crc32_combine_op;
-} ZLIB_1.2.9;
diff --git a/zlib.map.in b/zlib.map.in
new file mode 100644
index 00000000..f4cda497
--- /dev/null
+++ b/zlib.map.in
@@ -0,0 +1,98 @@
+ZLIB_1.2.0 {
+  global:
+    @ZLIB_SYMBOL_PREFIX@compressBound;
+    @ZLIB_SYMBOL_PREFIX@deflateBound;
+    @ZLIB_SYMBOL_PREFIX@inflateBack;
+    @ZLIB_SYMBOL_PREFIX@inflateBackEnd;
+    @ZLIB_SYMBOL_PREFIX@inflateBackInit_;
+    @ZLIB_SYMBOL_PREFIX@inflateCopy;
+  local:
+    @ZLIB_SYMBOL_PREFIX@deflate_copyright;
+    @ZLIB_SYMBOL_PREFIX@inflate_copyright;
+    @ZLIB_SYMBOL_PREFIX@zcalloc;
+    @ZLIB_SYMBOL_PREFIX@zcfree;
+    @ZLIB_SYMBOL_PREFIX@z_errmsg;
+    @ZLIB_SYMBOL_PREFIX@gz_error;
+    @ZLIB_SYMBOL_PREFIX@gz_intmax;
+    _*;
+};
+
+ZLIB_1.2.0.2 {
+    @ZLIB_SYMBOL_PREFIX@gzclearerr;
+    @ZLIB_SYMBOL_PREFIX@gzungetc;
+    @ZLIB_SYMBOL_PREFIX@zlibCompileFlags;
+} ZLIB_1.2.0;
+
+ZLIB_1.2.0.8 {
+    @ZLIB_SYMBOL_PREFIX@deflatePrime;
+} ZLIB_1.2.0.2;
+
+ZLIB_1.2.2 {
+    @ZLIB_SYMBOL_PREFIX@adler32_combine;
+    @ZLIB_SYMBOL_PREFIX@crc32_combine;
+    @ZLIB_SYMBOL_PREFIX@deflateSetHeader;
+    @ZLIB_SYMBOL_PREFIX@inflateGetHeader;
+} ZLIB_1.2.0.8;
+
+ZLIB_1.2.2.3 {
+    @ZLIB_SYMBOL_PREFIX@deflateTune;
+    @ZLIB_SYMBOL_PREFIX@gzdirect;
+} ZLIB_1.2.2;
+
+ZLIB_1.2.2.4 {
+    @ZLIB_SYMBOL_PREFIX@inflatePrime;
+} ZLIB_1.2.2.3;
+
+ZLIB_1.2.3.3 {
+    @ZLIB_SYMBOL_PREFIX@adler32_combine64;
+    @ZLIB_SYMBOL_PREFIX@crc32_combine64;
+    @ZLIB_SYMBOL_PREFIX@gzopen64;
+    @ZLIB_SYMBOL_PREFIX@gzseek64;
+    @ZLIB_SYMBOL_PREFIX@gztell64;
+    @ZLIB_SYMBOL_PREFIX@inflateUndermine;
+} ZLIB_1.2.2.4;
+
+ZLIB_1.2.3.4 {
+    @ZLIB_SYMBOL_PREFIX@inflateReset2;
+    @ZLIB_SYMBOL_PREFIX@inflateMark;
+} ZLIB_1.2.3.3;
+
+ZLIB_1.2.3.5 {
+    @ZLIB_SYMBOL_PREFIX@gzbuffer;
+    @ZLIB_SYMBOL_PREFIX@gzoffset;
+    @ZLIB_SYMBOL_PREFIX@gzoffset64;
+    @ZLIB_SYMBOL_PREFIX@gzclose_r;
+    @ZLIB_SYMBOL_PREFIX@gzclose_w;
+} ZLIB_1.2.3.4;
+
+ZLIB_1.2.5.1 {
+    @ZLIB_SYMBOL_PREFIX@deflatePending;
+} ZLIB_1.2.3.5;
+
+ZLIB_1.2.5.2 {
+    @ZLIB_SYMBOL_PREFIX@deflateResetKeep;
+    @ZLIB_SYMBOL_PREFIX@gzgetc_;
+    @ZLIB_SYMBOL_PREFIX@inflateResetKeep;
+} ZLIB_1.2.5.1;
+
+ZLIB_1.2.7.1 {
+    @ZLIB_SYMBOL_PREFIX@inflateGetDictionary;
+    @ZLIB_SYMBOL_PREFIX@gzvprintf;
+} ZLIB_1.2.5.2;
+
+ZLIB_1.2.9 {
+    @ZLIB_SYMBOL_PREFIX@inflateCodesUsed;
+    @ZLIB_SYMBOL_PREFIX@inflateValidate;
+    @ZLIB_SYMBOL_PREFIX@uncompress2;
+    @ZLIB_SYMBOL_PREFIX@gzfread;
+    @ZLIB_SYMBOL_PREFIX@gzfwrite;
+    @ZLIB_SYMBOL_PREFIX@deflateGetDictionary;
+    @ZLIB_SYMBOL_PREFIX@adler32_z;
+    @ZLIB_SYMBOL_PREFIX@crc32_z;
+} ZLIB_1.2.7.1;
+
+ZLIB_1.2.12 {
+    @ZLIB_SYMBOL_PREFIX@crc32_combine_gen;
+    @ZLIB_SYMBOL_PREFIX@crc32_combine_gen64;
+    @ZLIB_SYMBOL_PREFIX@crc32_combine_op;
+} ZLIB_1.2.9;
diff --git a/zlib.pc.cmakein b/zlib.pc.cmakein
index df8bf9f0..a5ff63ce 100644
--- a/zlib.pc.cmakein
+++ b/zlib.pc.cmakein
@@ -1,6 +1,7 @@
 prefix=@CMAKE_INSTALL_PREFIX@
 exec_prefix=${prefix}
 symbol_prefix=@ZLIB_SYMBOL_PREFIX@
+bindir=@PC_BIN_INSTALL_DIR@
 libdir=@PC_LIB_INSTALL_DIR@
 sharedlibdir=${libdir}
 includedir=@PC_INC_INSTALL_DIR@
diff --git a/zlib.pc.in b/zlib.pc.in
index 45b35989..25cc923e 100644
--- a/zlib.pc.in
+++ b/zlib.pc.in
@@ -1,6 +1,7 @@
 prefix=@prefix@
 exec_prefix=@exec_prefix@
 symbol_prefix=@symbol_prefix@
+bindir=@bindir@
 libdir=@libdir@
 sharedlibdir=@sharedlibdir@
 includedir=@includedir@
diff --git a/zmemory.h b/zmemory.h
new file mode 100644
index 00000000..fc850a72
--- /dev/null
+++ b/zmemory.h
@@ -0,0 +1,99 @@
+/* zmemory.h -- Private inline functions used internally in zlib-ng
+ * For conditions of distribution and use, see copyright notice in zlib.h
+ */
+
+#ifndef _ZMEMORY_H
+#define _ZMEMORY_H
+
+#if defined(__GNUC__) && (__GNUC__ >= 4)
+#  define HAVE_MAY_ALIAS
+#endif
+
+static inline uint16_t zng_memread_2(const void *ptr) {
+#if defined(HAVE_MAY_ALIAS)
+    typedef struct { uint16_t val; } __attribute__ ((__packed__, __may_alias__)) unaligned_uint16_t;
+    return ((const unaligned_uint16_t *)ptr)->val;
+#else
+    uint16_t val;
+    memcpy(&val, ptr, sizeof(val));
+    return val;
+#endif
+}
+
+static inline uint32_t zng_memread_4(const void *ptr) {
+#if defined(HAVE_MAY_ALIAS)
+    typedef struct { uint32_t val; } __attribute__ ((__packed__, __may_alias__)) unaligned_uint32_t;
+    return ((const unaligned_uint32_t *)ptr)->val;
+#else
+    uint32_t val;
+    memcpy(&val, ptr, sizeof(val));
+    return val;
+#endif
+}
+
+static inline uint64_t zng_memread_8(const void *ptr) {
+#if defined(HAVE_MAY_ALIAS)
+    typedef struct { uint64_t val; } __attribute__ ((__packed__, __may_alias__)) unaligned_uint64_t;
+    return ((const unaligned_uint64_t *)ptr)->val;
+#else
+    uint64_t val;
+    memcpy(&val, ptr, sizeof(val));
+    return val;
+#endif
+}
+
+static inline void zng_memwrite_2(void *ptr, uint16_t val) {
+#if defined(HAVE_MAY_ALIAS)
+    typedef struct { uint16_t val; } __attribute__ ((__packed__, __may_alias__)) unaligned_uint16_t;
+    ((unaligned_uint16_t *)ptr)->val = val;
+#else
+    memcpy(ptr, &val, sizeof(val));
+#endif
+}
+
+static inline void zng_memwrite_4(void *ptr, uint32_t val) {
+#if defined(HAVE_MAY_ALIAS)
+    typedef struct { uint32_t val; } __attribute__ ((__packed__, __may_alias__)) unaligned_uint32_t;
+    ((unaligned_uint32_t *)ptr)->val = val;
+#else
+    memcpy(ptr, &val, sizeof(val));
+#endif
+}
+
+static inline void zng_memwrite_8(void *ptr, uint64_t val) {
+#if defined(HAVE_MAY_ALIAS)
+    typedef struct { uint64_t val; } __attribute__ ((__packed__, __may_alias__)) unaligned_uint64_t;
+    ((unaligned_uint64_t *)ptr)->val = val;
+#else
+    memcpy(ptr, &val, sizeof(val));
+#endif
+}
+
+/* Use zng_memread_* instead of memcmp to avoid older compilers not converting memcmp
+   calls to unaligned comparisons when unaligned access is supported. Use memcmp only when
+   unaligned support is not available to avoid an extra call to memcpy. */
+static inline int32_t zng_memcmp_2(const void *src0, const void *src1) {
+#if defined(HAVE_MAY_ALIAS)
+    return zng_memread_2(src0) != zng_memread_2(src1);
+#else
+    return memcmp(src0, src1, 2);
+#endif
+}
+
+static inline int32_t zng_memcmp_4(const void *src0, const void *src1) {
+#if defined(HAVE_MAY_ALIAS)
+    return zng_memread_4(src0) != zng_memread_4(src1);
+#else
+    return memcmp(src0, src1, 4);
+#endif
+}
+
+static inline int32_t zng_memcmp_8(const void *src0, const void *src1) {
+#if defined(HAVE_MAY_ALIAS)
+    return zng_memread_8(src0) != zng_memread_8(src1);
+#else
+    return memcmp(src0, src1, 8);
+#endif
+}
+
+#endif
diff --git a/zutil.c b/zutil.c
index 39fbceb4..937c83da 100644
--- a/zutil.c
+++ b/zutil.c
@@ -21,7 +21,7 @@ z_const char * const PREFIX(z_errmsg)[10] = {
 };
 
 const char PREFIX3(vstring)[] =
-    " zlib-ng 2.2.1";
+    " zlib-ng 2.3.1";
 
 #ifdef ZLIB_COMPAT
 const char * Z_EXPORT zlibVersion(void) {
@@ -96,10 +96,12 @@ void Z_INTERNAL z_error(const char *m) {
 /* exported to allow conversion of error code to string for compress() and
  * uncompress()
  */
-const char * Z_EXPORT PREFIX(zError)(int err) {
+const char * Z_EXPORT PREFIX(zError)(z_int32_t err) {
     return ERR_MSG(err);
 }
 
+// Zlib-ng's default alloc/free implementation, used unless
+// application supplies its own alloc/free functions.
 void Z_INTERNAL *PREFIX(zcalloc)(void *opaque, unsigned items, unsigned size) {
     Z_UNUSED(opaque);
     return zng_alloc((size_t)items * (size_t)size);
@@ -109,3 +111,41 @@ void Z_INTERNAL PREFIX(zcfree)(void *opaque, void *ptr) {
     Z_UNUSED(opaque);
     zng_free(ptr);
 }
+
+/* Provide aligned allocations, only used by gz* code */
+void Z_INTERNAL *zng_alloc_aligned(unsigned size, unsigned align) {
+    uintptr_t return_ptr, original_ptr, align_diff;
+    uint32_t alloc_size;
+    void *ptr;
+
+    /* Allocate enough memory for proper alignment and to store the original memory pointer */
+    alloc_size = sizeof(void *) + size + align;
+    ptr = zng_alloc(alloc_size);
+    if (!ptr)
+        return NULL;
+
+    /* Calculate return pointer address with space enough to store original pointer */
+    align_diff = ALIGN_DIFF(ptr, align);
+    return_ptr = (uintptr_t)ptr + align_diff;
+    if (align_diff < sizeof(void *))
+        return_ptr += align;
+
+    /* Store the original pointer for free() */
+    original_ptr = return_ptr - sizeof(void *);
+    memcpy((void *)original_ptr, &ptr, sizeof(void *));
+
+    /* Return properly aligned pointer in allocation */
+    return (void *)return_ptr;
+}
+
+void Z_INTERNAL zng_free_aligned(void *ptr) {
+    if (!ptr)
+        return;
+
+    /* Calculate offset to original memory allocation pointer */
+    void *original_ptr = (void *)((uintptr_t)ptr - sizeof(void *));
+    void *free_ptr = *(void **)original_ptr;
+
+    /* Free original memory allocation */
+    zng_free(free_ptr);
+}
diff --git a/zutil.h b/zutil.h
index a6284502..9017c687 100644
--- a/zutil.h
+++ b/zutil.h
@@ -133,6 +133,8 @@ extern z_const char * const PREFIX(z_errmsg)[10]; /* indexed by 2-zlib_error */
 
 void Z_INTERNAL *PREFIX(zcalloc)(void *opaque, unsigned items, unsigned size);
 void Z_INTERNAL  PREFIX(zcfree)(void *opaque, void *ptr);
+void Z_INTERNAL *zng_alloc_aligned(unsigned size, unsigned align);
+void Z_INTERNAL zng_free_aligned(void *ptr);
 
 typedef void *zng_calloc_func(void *opaque, unsigned items, unsigned size);
 typedef void  zng_cfree_func(void *opaque, void *ptr);
diff --git a/zutil_p.h b/zutil_p.h
index 97799f0c..866a52f6 100644
--- a/zutil_p.h
+++ b/zutil_p.h
@@ -5,71 +5,16 @@
 #ifndef ZUTIL_P_H
 #define ZUTIL_P_H
 
-#if defined(__APPLE__) || defined(HAVE_POSIX_MEMALIGN) || defined(HAVE_ALIGNED_ALLOC)
-#  include <stdlib.h>
-#elif defined(__FreeBSD__)
-#  include <stdlib.h>
-#  include <malloc_np.h>
-#else
-#  include <malloc.h>
-#endif
+#include <stdlib.h>
 
-/* Function to allocate 16 or 64-byte aligned memory */
+// Zlib-ng's default alloc/free implementation, used unless
+// application supplies its own alloc/free functions.
 static inline void *zng_alloc(size_t size) {
-#ifdef HAVE_ALIGNED_ALLOC
-    /* Size must be a multiple of alignment */
-    size = (size + (64 - 1)) & ~(64 - 1);
-    return (void *)aligned_alloc(64, size);  /* Defined in C11 */
-#elif defined(HAVE_POSIX_MEMALIGN)
-    void *ptr;
-    return posix_memalign(&ptr, 64, size) ? NULL : ptr;
-#elif defined(_WIN32)
-    return (void *)_aligned_malloc(size, 64);
-#elif defined(__APPLE__)
-    /* Fallback for when posix_memalign and aligned_alloc are not available.
-     * On macOS, it always aligns to 16 bytes. */
     return (void *)malloc(size);
-#else
-    return (void *)memalign(64, size);
-#endif
 }
 
-/* Function that can free aligned memory */
 static inline void zng_free(void *ptr) {
-#if defined(_WIN32)
-    _aligned_free(ptr);
-#else
     free(ptr);
-#endif
-}
-
-/* Use memcpy instead of memcmp to avoid older compilers not converting memcmp calls to
-   unaligned comparisons when unaligned access is supported. */
-static inline int32_t zng_memcmp_2(const void *src0, const void *src1) {
-    uint16_t src0_cmp, src1_cmp;
-
-    memcpy(&src0_cmp, src0, sizeof(src0_cmp));
-    memcpy(&src1_cmp, src1, sizeof(src1_cmp));
-
-    return src0_cmp != src1_cmp;
-}
-
-static inline int32_t zng_memcmp_4(const void *src0, const void *src1) {
-    uint32_t src0_cmp, src1_cmp;
-
-    memcpy(&src0_cmp, src0, sizeof(src0_cmp));
-    memcpy(&src1_cmp, src1, sizeof(src1_cmp));
-
-    return src0_cmp != src1_cmp;
-}
-
-static inline int32_t zng_memcmp_8(const void *src0, const void *src1) {
-    uint64_t src0_cmp, src1_cmp;
-
-    memcpy(&src0_cmp, src0, sizeof(src0_cmp));
-    memcpy(&src1_cmp, src1, sizeof(src1_cmp));
-
-    return src0_cmp != src1_cmp;
 }
 
 #endif
